[05:09:08] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 21674458 edges into 8 parts and get 3479938 edge cuts
main start at this time 1651554525.433457
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.027788162231445312
global_2_local spend time (sec) 0.03509926795959473
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004070758819580078
A = g.adjacency_matrix() spent  0.007889509201049805
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08118748664855957
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.291496992111206
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1806118488311768

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 11680458, 2.0: 2009204, 3.0: 503973, 4.0: 152362, 5.0: 55000, 6.0: 23754, 7.0: 11121, 8.0: 5689, 9.0: 3141, 10.0: 1718, 11.0: 1012, 12.0: 561, 13.0: 341, 14.0: 224, 15.0: 154, 16.0: 98, 17.0: 78, 18.0: 41, 19.0: 29, 20.0: 8, 21.0: 4})
Convert a graph into a bidirected graph: 0.873 seconds
Metis partitioning: 4.526 seconds
Split the graph: 1.006 seconds
Construct subgraphs: 0.104 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  6.520531892776489
11545
11592
11535
11585
11035
11245
11369
11035
total k batches seeds list generation spend  20.065218210220337
after graph partition
graph partition algorithm spend time 20.162594079971313
11545
11592
11535
11585
11035
11245
11369
11035
partition_len_list
[22141, 24548, 21127, 19889, 35351, 25847, 41815, 49073]
shared_neighbor_graph_partition_s0 selection method  spend 20.249448776245117
time for parepare:  0.016592979431152344
local_output_nid generation:  0.002122640609741211
local_in_edges_tensor generation:  0.002354860305786133
mini_batch_src_global generation:  0.0029189586639404297
r_  generation:  0.02796316146850586
local_output_nid generation:  0.0025107860565185547
local_in_edges_tensor generation:  0.002445220947265625
mini_batch_src_global generation:  0.0033981800079345703
r_  generation:  0.029457569122314453
local_output_nid generation:  0.0026099681854248047
local_in_edges_tensor generation:  0.003223896026611328
mini_batch_src_global generation:  0.0030364990234375
r_  generation:  0.031265974044799805
local_output_nid generation:  0.0026459693908691406
local_in_edges_tensor generation:  0.0022270679473876953
mini_batch_src_global generation:  0.002830028533935547
r_  generation:  0.031185150146484375
local_output_nid generation:  0.0025568008422851562
local_in_edges_tensor generation:  0.0026671886444091797
mini_batch_src_global generation:  0.0026292800903320312
r_  generation:  0.02911663055419922
local_output_nid generation:  0.0028290748596191406
local_in_edges_tensor generation:  0.0025587081909179688
mini_batch_src_global generation:  0.002595186233520508
r_  generation:  0.026056289672851562
local_output_nid generation:  0.002745389938354492
local_in_edges_tensor generation:  0.0031011104583740234
mini_batch_src_global generation:  0.005150556564331055
r_  generation:  0.04410886764526367
local_output_nid generation:  0.0028591156005859375
local_in_edges_tensor generation:  0.0033483505249023438
mini_batch_src_global generation:  0.004399538040161133
r_  generation:  0.043077945709228516
----------------------check_connections_block total spend ----------------------------- 0.41635727882385254
generate_one_block  0.04382133483886719
generate_one_block  0.03806710243225098
generate_one_block  0.04003763198852539
generate_one_block  0.04034161567687988
generate_one_block  0.03821277618408203
generate_one_block  0.031244516372680664
generate_one_block  0.06173825263977051
generate_one_block  0.061797380447387695
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03242611885070801
gen group dst list time:  0.007286548614501953
time for parepare:  0.02425241470336914
local_output_nid generation:  0.0038678646087646484
local_in_edges_tensor generation:  0.013864278793334961
mini_batch_src_global generation:  0.004198312759399414
r_  generation:  0.04630470275878906
local_output_nid generation:  0.0063931941986083984
local_in_edges_tensor generation:  0.005854606628417969
mini_batch_src_global generation:  0.009590864181518555
r_  generation:  0.05537152290344238
local_output_nid generation:  0.005364179611206055
local_in_edges_tensor generation:  0.007597923278808594
mini_batch_src_global generation:  0.007731914520263672
r_  generation:  0.04798269271850586
local_output_nid generation:  0.0061817169189453125
local_in_edges_tensor generation:  0.003828287124633789
mini_batch_src_global generation:  0.00399327278137207
r_  generation:  0.04288768768310547
local_output_nid generation:  0.008660554885864258
local_in_edges_tensor generation:  0.007799863815307617
mini_batch_src_global generation:  0.00947713851928711
r_  generation:  0.08900308609008789
local_output_nid generation:  0.006819009780883789
local_in_edges_tensor generation:  0.005323886871337891
mini_batch_src_global generation:  0.0068280696868896484
r_  generation:  0.058490753173828125
local_output_nid generation:  0.009511470794677734
local_in_edges_tensor generation:  0.008766651153564453
mini_batch_src_global generation:  0.012265205383300781
r_  generation:  0.11942243576049805
local_output_nid generation:  0.011590957641601562
local_in_edges_tensor generation:  0.014778375625610352
mini_batch_src_global generation:  0.0177154541015625
r_  generation:  0.14035725593566895
----------------------check_connections_block total spend ----------------------------- 0.9833228588104248
generate_one_block  0.07415151596069336
generate_one_block  0.07069635391235352
generate_one_block  0.08250308036804199
generate_one_block  0.05245471000671387
generate_one_block  0.12253856658935547
generate_one_block  0.0756380558013916
generate_one_block  0.157318115234375
generate_one_block  0.1797478199005127
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  0.9833228588104248
block generation total time  0.8150482177734375
average batch blocks generation time:  0.10188102722167969
pseudo mini batch 0 input nodes size: 37625
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.02071857452392578  GigaBytes
Max Memory Allocated: 0.02071857452392578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.020804882049560547  GigaBytes
Max Memory Allocated: 0.020804882049560547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.020804882049560547  GigaBytes
Max Memory Allocated: 0.020804882049560547  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1053466796875 GB
    Memory Allocated: 0.022403240203857422  GigaBytes
Max Memory Allocated: 0.022403240203857422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1053466796875 GB
    Memory Allocated: 0.022403240203857422  GigaBytes
Max Memory Allocated: 0.022403240203857422  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1053466796875 GB
    Memory Allocated: 0.022403240203857422  GigaBytes
Max Memory Allocated: 0.022403240203857422  GigaBytes

torch.Size([37625, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1053466796875 GB
    Memory Allocated: 0.022403240203857422  GigaBytes
Max Memory Allocated: 0.022403240203857422  GigaBytes

m.shape torch.Size([2426, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.08829879760742188  GigaBytes
Max Memory Allocated: 0.08856201171875  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.08829879760742188  GigaBytes
Max Memory Allocated: 0.08856201171875  GigaBytes

 h.shape torch.Size([1, 2426, 128]), torch.Size([1, 2426, 128])
----------------------------------------3
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.09061241149902344  GigaBytes
Max Memory Allocated: 0.09061241149902344  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.10912132263183594  GigaBytes
Max Memory Allocated: 0.11027812957763672  GigaBytes

rst.shape  torch.Size([1, 2426, 128])
m.shape torch.Size([2492, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.11034107208251953  GigaBytes
Max Memory Allocated: 0.1103968620300293  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.11034107208251953  GigaBytes
Max Memory Allocated: 0.1103968620300293  GigaBytes

 h.shape torch.Size([1, 2492, 128]), torch.Size([1, 2492, 128])
----------------------------------------3
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.1127176284790039  GigaBytes
Max Memory Allocated: 0.1127176284790039  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.14949798583984375  GigaBytes
Max Memory Allocated: 0.15187454223632812  GigaBytes

rst.shape  torch.Size([1, 2492, 128])
m.shape torch.Size([2268, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.15187454223632812  GigaBytes
Max Memory Allocated: 0.15195131301879883  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.15187454223632812  GigaBytes
Max Memory Allocated: 0.15195131301879883  GigaBytes

 h.shape torch.Size([1, 2268, 128]), torch.Size([1, 2268, 128])
----------------------------------------3
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.1540813446044922  GigaBytes
Max Memory Allocated: 0.1540813446044922  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.202301025390625  GigaBytes
Max Memory Allocated: 0.20554542541503906  GigaBytes

rst.shape  torch.Size([1, 2268, 128])
m.shape torch.Size([2002, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.20554542541503906  GigaBytes
Max Memory Allocated: 0.20563554763793945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.20554542541503906  GigaBytes
Max Memory Allocated: 0.20563554763793945  GigaBytes

 h.shape torch.Size([1, 2002, 128]), torch.Size([1, 2002, 128])
----------------------------------------3
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.20745468139648438  GigaBytes
Max Memory Allocated: 0.20745468139648438  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.2632617950439453  GigaBytes
Max Memory Allocated: 0.26708030700683594  GigaBytes

rst.shape  torch.Size([1, 2002, 128])
m.shape torch.Size([1706, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.2663745880126953  GigaBytes
Max Memory Allocated: 0.26708030700683594  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.2663745880126953  GigaBytes
Max Memory Allocated: 0.26708030700683594  GigaBytes

 h.shape torch.Size([1, 1706, 128]), torch.Size([1, 1706, 128])
----------------------------------------3
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.2680015563964844  GigaBytes
Max Memory Allocated: 0.2680015563964844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5291748046875 GB
    Memory Allocated: 0.32734203338623047  GigaBytes
Max Memory Allocated: 0.3314094543457031  GigaBytes

rst.shape  torch.Size([1, 1706, 128])
m.shape torch.Size([1404, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5291748046875 GB
    Memory Allocated: 0.33054542541503906  GigaBytes
Max Memory Allocated: 0.3314094543457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5291748046875 GB
    Memory Allocated: 0.33054542541503906  GigaBytes
Max Memory Allocated: 0.3314094543457031  GigaBytes

 h.shape torch.Size([1, 1404, 128]), torch.Size([1, 1404, 128])
----------------------------------------3
 Nvidia-smi: 1.5311279296875 GB
    Memory Allocated: 0.33188438415527344  GigaBytes
Max Memory Allocated: 0.33188438415527344  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.3925018310546875  GigaBytes
Max Memory Allocated: 0.3965187072753906  GigaBytes

rst.shape  torch.Size([1, 1404, 128])
m.shape torch.Size([1203, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.39584779739379883  GigaBytes
Max Memory Allocated: 0.3965187072753906  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.39584779739379883  GigaBytes
Max Memory Allocated: 0.3965187072753906  GigaBytes

 h.shape torch.Size([1, 1203, 128]), torch.Size([1, 1203, 128])
----------------------------------------3
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.39699506759643555  GigaBytes
Max Memory Allocated: 0.39699506759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6678466796875 GB
    Memory Allocated: 0.4543585777282715  GigaBytes
Max Memory Allocated: 0.4583740234375  GigaBytes

rst.shape  torch.Size([1, 1203, 128])
m.shape torch.Size([1118, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.6678466796875 GB
    Memory Allocated: 0.4580497741699219  GigaBytes
Max Memory Allocated: 0.4583740234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6678466796875 GB
    Memory Allocated: 0.4580497741699219  GigaBytes
Max Memory Allocated: 0.4583740234375  GigaBytes

 h.shape torch.Size([1, 1118, 128]), torch.Size([1, 1118, 128])
----------------------------------------3
 Nvidia-smi: 1.6678466796875 GB
    Memory Allocated: 0.45911598205566406  GigaBytes
Max Memory Allocated: 0.45911598205566406  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7186279296875 GB
    Memory Allocated: 0.52056884765625  GigaBytes
Max Memory Allocated: 0.5251731872558594  GigaBytes

rst.shape  torch.Size([1, 1118, 128])
m.shape torch.Size([969, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.7186279296875 GB
    Memory Allocated: 0.5246400833129883  GigaBytes
Max Memory Allocated: 0.5251731872558594  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7186279296875 GB
    Memory Allocated: 0.5246400833129883  GigaBytes
Max Memory Allocated: 0.5251731872558594  GigaBytes

 h.shape torch.Size([1, 969, 128]), torch.Size([1, 969, 128])
----------------------------------------3
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.5255641937255859  GigaBytes
Max Memory Allocated: 0.5255641937255859  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.5847072601318359  GigaBytes
Max Memory Allocated: 0.5888657569885254  GigaBytes

rst.shape  torch.Size([1, 969, 128])
m.shape torch.Size([6553, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.8201904296875 GB
    Memory Allocated: 0.6154952049255371  GigaBytes
Max Memory Allocated: 0.6162276268005371  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8201904296875 GB
    Memory Allocated: 0.6154952049255371  GigaBytes
Max Memory Allocated: 0.6162276268005371  GigaBytes

 h.shape torch.Size([1, 6553, 128]), torch.Size([1, 6553, 128])
----------------------------------------3
 Nvidia-smi: 1.8201904296875 GB
    Memory Allocated: 0.6220889091491699  GigaBytes
Max Memory Allocated: 0.6220889091491699  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 1.0728449821472168  GigaBytes
Max Memory Allocated: 1.1040949821472168  GigaBytes

rst.shape  torch.Size([1, 6553, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.3455810546875 GB
    Memory Allocated: 1.017359733581543  GigaBytes
Max Memory Allocated: 1.1040949821472168  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.3455810546875 GB
    Memory Allocated: 1.0384750366210938  GigaBytes
Max Memory Allocated: 1.1040949821472168  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.3670654296875 GB
    Memory Allocated: 1.0599594116210938  GigaBytes
Max Memory Allocated: 1.1040949821472168  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.3670654296875 GB
    Memory Allocated: 1.0386791229248047  GigaBytes
Max Memory Allocated: 1.1040949821472168  GigaBytes

torch.Size([22141, 256])
first layer input nodes number: 37625
first layer output nodes number: 22141
edges number: 130792
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.3670654296875 GB
    Memory Allocated: 1.06024169921875  GigaBytes
Max Memory Allocated: 1.1040949821472168  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.3670654296875 GB
    Memory Allocated: 1.0813570022583008  GigaBytes
Max Memory Allocated: 1.1040949821472168  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.3885498046875 GB
    Memory Allocated: 1.0870051383972168  GigaBytes
Max Memory Allocated: 1.1081204414367676  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.3885498046875 GB
    Memory Allocated: 1.0870051383972168  GigaBytes
Max Memory Allocated: 1.1081204414367676  GigaBytes

m.shape torch.Size([1657, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.4686279296875 GB
    Memory Allocated: 1.1699156761169434  GigaBytes
Max Memory Allocated: 1.169921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4686279296875 GB
    Memory Allocated: 1.1699156761169434  GigaBytes
Max Memory Allocated: 1.169921875  GigaBytes

 h.shape torch.Size([1, 1657, 256]), torch.Size([1, 1657, 256])
----------------------------------------3
 Nvidia-smi: 2.4686279296875 GB
    Memory Allocated: 1.1730761528015137  GigaBytes
Max Memory Allocated: 1.1730761528015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4686279296875 GB
    Memory Allocated: 1.198610782623291  GigaBytes
Max Memory Allocated: 1.2001910209655762  GigaBytes

rst.shape  torch.Size([1, 1657, 256])
m.shape torch.Size([1492, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.4686279296875 GB
    Memory Allocated: 1.2002134323120117  GigaBytes
Max Memory Allocated: 1.2002248764038086  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4686279296875 GB
    Memory Allocated: 1.2002134323120117  GigaBytes
Max Memory Allocated: 1.2002248764038086  GigaBytes

 h.shape torch.Size([1, 1492, 256]), torch.Size([1, 1492, 256])
----------------------------------------3
 Nvidia-smi: 2.4686279296875 GB
    Memory Allocated: 1.203059196472168  GigaBytes
Max Memory Allocated: 1.203059196472168  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4881591796875 GB
    Memory Allocated: 1.2457456588745117  GigaBytes
Max Memory Allocated: 1.248591423034668  GigaBytes

rst.shape  torch.Size([1, 1492, 256])
m.shape torch.Size([1250, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.4881591796875 GB
    Memory Allocated: 1.247927188873291  GigaBytes
Max Memory Allocated: 1.248591423034668  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4881591796875 GB
    Memory Allocated: 1.247927188873291  GigaBytes
Max Memory Allocated: 1.248591423034668  GigaBytes

 h.shape torch.Size([1, 1250, 256]), torch.Size([1, 1250, 256])
----------------------------------------3
 Nvidia-smi: 2.4881591796875 GB
    Memory Allocated: 1.2504563331604004  GigaBytes
Max Memory Allocated: 1.2504563331604004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5467529296875 GB
    Memory Allocated: 1.3047451972961426  GigaBytes
Max Memory Allocated: 1.308321475982666  GigaBytes

rst.shape  torch.Size([1, 1250, 256])
m.shape torch.Size([1048, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.5467529296875 GB
    Memory Allocated: 1.3083529472351074  GigaBytes
Max Memory Allocated: 1.3083686828613281  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5467529296875 GB
    Memory Allocated: 1.3083529472351074  GigaBytes
Max Memory Allocated: 1.3083686828613281  GigaBytes

 h.shape torch.Size([1, 1048, 256]), torch.Size([1, 1048, 256])
----------------------------------------3
 Nvidia-smi: 2.5467529296875 GB
    Memory Allocated: 1.3104243278503418  GigaBytes
Max Memory Allocated: 1.3104243278503418  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6053466796875 GB
    Memory Allocated: 1.3698844909667969  GigaBytes
Max Memory Allocated: 1.3738822937011719  GigaBytes

rst.shape  torch.Size([1, 1048, 256])
m.shape torch.Size([857, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.6053466796875 GB
    Memory Allocated: 1.3728299140930176  GigaBytes
Max Memory Allocated: 1.3738822937011719  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6053466796875 GB
    Memory Allocated: 1.3728299140930176  GigaBytes
Max Memory Allocated: 1.3738822937011719  GigaBytes

 h.shape torch.Size([1, 857, 256]), torch.Size([1, 857, 256])
----------------------------------------3
 Nvidia-smi: 2.6053466796875 GB
    Memory Allocated: 1.374464511871338  GigaBytes
Max Memory Allocated: 1.374464511871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 1.4347624778747559  GigaBytes
Max Memory Allocated: 1.4388489723205566  GigaBytes

rst.shape  torch.Size([1, 857, 256])
m.shape torch.Size([683, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 1.4378843307495117  GigaBytes
Max Memory Allocated: 1.4388489723205566  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 1.4378843307495117  GigaBytes
Max Memory Allocated: 1.4388489723205566  GigaBytes

 h.shape torch.Size([1, 683, 256]), torch.Size([1, 683, 256])
----------------------------------------3
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 1.4391870498657227  GigaBytes
Max Memory Allocated: 1.4391870498657227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7244873046875 GB
    Memory Allocated: 1.4969491958618164  GigaBytes
Max Memory Allocated: 1.5008573532104492  GigaBytes

rst.shape  torch.Size([1, 683, 256])
m.shape torch.Size([586, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.7244873046875 GB
    Memory Allocated: 1.5002408027648926  GigaBytes
Max Memory Allocated: 1.5008573532104492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7244873046875 GB
    Memory Allocated: 1.5002408027648926  GigaBytes
Max Memory Allocated: 1.5008573532104492  GigaBytes

 h.shape torch.Size([1, 586, 256]), torch.Size([1, 586, 256])
----------------------------------------3
 Nvidia-smi: 2.7244873046875 GB
    Memory Allocated: 1.5013585090637207  GigaBytes
Max Memory Allocated: 1.5013585090637207  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7889404296875 GB
    Memory Allocated: 1.5579705238342285  GigaBytes
Max Memory Allocated: 1.561882495880127  GigaBytes

rst.shape  torch.Size([1, 586, 256])
m.shape torch.Size([533, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.7889404296875 GB
    Memory Allocated: 1.5615100860595703  GigaBytes
Max Memory Allocated: 1.561882495880127  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7889404296875 GB
    Memory Allocated: 1.5615100860595703  GigaBytes
Max Memory Allocated: 1.561882495880127  GigaBytes

 h.shape torch.Size([1, 533, 256]), torch.Size([1, 533, 256])
----------------------------------------3
 Nvidia-smi: 2.7889404296875 GB
    Memory Allocated: 1.5625267028808594  GigaBytes
Max Memory Allocated: 1.5625267028808594  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8592529296875 GB
    Memory Allocated: 1.6210994720458984  GigaBytes
Max Memory Allocated: 1.6251659393310547  GigaBytes

rst.shape  torch.Size([1, 533, 256])
m.shape torch.Size([447, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.8592529296875 GB
    Memory Allocated: 1.624457836151123  GigaBytes
Max Memory Allocated: 1.6251659393310547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8592529296875 GB
    Memory Allocated: 1.624457836151123  GigaBytes
Max Memory Allocated: 1.6251659393310547  GigaBytes

 h.shape torch.Size([1, 447, 256]), torch.Size([1, 447, 256])
----------------------------------------3
 Nvidia-smi: 2.8592529296875 GB
    Memory Allocated: 1.6253104209899902  GigaBytes
Max Memory Allocated: 1.6253104209899902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9061279296875 GB
    Memory Allocated: 1.6808772087097168  GigaBytes
Max Memory Allocated: 1.6850619316101074  GigaBytes

rst.shape  torch.Size([1, 447, 256])
m.shape torch.Size([354, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.9061279296875 GB
    Memory Allocated: 1.6846623420715332  GigaBytes
Max Memory Allocated: 1.6850619316101074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9061279296875 GB
    Memory Allocated: 1.6846623420715332  GigaBytes
Max Memory Allocated: 1.6850619316101074  GigaBytes

 h.shape torch.Size([1, 354, 256]), torch.Size([1, 354, 256])
----------------------------------------3
 Nvidia-smi: 2.9061279296875 GB
    Memory Allocated: 1.6853375434875488  GigaBytes
Max Memory Allocated: 1.6853375434875488  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 1.734544277191162  GigaBytes
Max Memory Allocated: 1.7379202842712402  GigaBytes

rst.shape  torch.Size([1, 354, 256])
m.shape torch.Size([305, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 1.737431526184082  GigaBytes
Max Memory Allocated: 1.7379202842712402  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 1.737431526184082  GigaBytes
Max Memory Allocated: 1.7379202842712402  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 1.7380132675170898  GigaBytes
Max Memory Allocated: 1.7380132675170898  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9764404296875 GB
    Memory Allocated: 1.7846574783325195  GigaBytes
Max Memory Allocated: 1.7881908416748047  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([264, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.9764404296875 GB
    Memory Allocated: 1.787923812866211  GigaBytes
Max Memory Allocated: 1.7881908416748047  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9764404296875 GB
    Memory Allocated: 1.787923812866211  GigaBytes
Max Memory Allocated: 1.7881908416748047  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 2.9764404296875 GB
    Memory Allocated: 1.7884273529052734  GigaBytes
Max Memory Allocated: 1.7884273529052734  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0408935546875 GB
    Memory Allocated: 1.831624984741211  GigaBytes
Max Memory Allocated: 1.834646224975586  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([228, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.0408935546875 GB
    Memory Allocated: 1.8342223167419434  GigaBytes
Max Memory Allocated: 1.834646224975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0408935546875 GB
    Memory Allocated: 1.8342223167419434  GigaBytes
Max Memory Allocated: 1.834646224975586  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 3.0408935546875 GB
    Memory Allocated: 1.8346571922302246  GigaBytes
Max Memory Allocated: 1.8346571922302246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 1.8746657371520996  GigaBytes
Max Memory Allocated: 1.8774924278259277  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([191, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 1.8770184516906738  GigaBytes
Max Memory Allocated: 1.8774924278259277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 1.8770184516906738  GigaBytes
Max Memory Allocated: 1.8774924278259277  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 1.877382755279541  GigaBytes
Max Memory Allocated: 1.8774924278259277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1248779296875 GB
    Memory Allocated: 1.9134488105773926  GigaBytes
Max Memory Allocated: 1.915998935699463  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([175, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.1248779296875 GB
    Memory Allocated: 1.91579008102417  GigaBytes
Max Memory Allocated: 1.915998935699463  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1248779296875 GB
    Memory Allocated: 1.91579008102417  GigaBytes
Max Memory Allocated: 1.915998935699463  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 3.1248779296875 GB
    Memory Allocated: 1.916123867034912  GigaBytes
Max Memory Allocated: 1.916123867034912  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 1.951505184173584  GigaBytes
Max Memory Allocated: 1.9540085792541504  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([151, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 1.9537672996520996  GigaBytes
Max Memory Allocated: 1.9540085792541504  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 1.9537672996520996  GigaBytes
Max Memory Allocated: 1.9540085792541504  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 1.9540553092956543  GigaBytes
Max Memory Allocated: 1.9540553092956543  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.986600399017334  GigaBytes
Max Memory Allocated: 1.9889044761657715  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([116, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.988351821899414  GigaBytes
Max Memory Allocated: 1.9889044761657715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.988351821899414  GigaBytes
Max Memory Allocated: 1.9889044761657715  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.9885730743408203  GigaBytes
Max Memory Allocated: 1.9889044761657715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2127685546875 GB
    Memory Allocated: 2.0151233673095703  GigaBytes
Max Memory Allocated: 2.0170040130615234  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([99, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2127685546875 GB
    Memory Allocated: 2.016725540161133  GigaBytes
Max Memory Allocated: 2.0170040130615234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2127685546875 GB
    Memory Allocated: 2.016725540161133  GigaBytes
Max Memory Allocated: 2.0170040130615234  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.2127685546875 GB
    Memory Allocated: 2.0169143676757812  GigaBytes
Max Memory Allocated: 2.0170040130615234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2381591796875 GB
    Memory Allocated: 2.040895462036133  GigaBytes
Max Memory Allocated: 2.0425949096679688  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([115, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2381591796875 GB
    Memory Allocated: 2.0429015159606934  GigaBytes
Max Memory Allocated: 2.042910099029541  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2381591796875 GB
    Memory Allocated: 2.0429015159606934  GigaBytes
Max Memory Allocated: 2.042910099029541  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.2381591796875 GB
    Memory Allocated: 2.043120861053467  GigaBytes
Max Memory Allocated: 2.043120861053467  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 2.0725131034851074  GigaBytes
Max Memory Allocated: 2.074596881866455  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([104, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 2.0744028091430664  GigaBytes
Max Memory Allocated: 2.074596881866455  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 2.0744028091430664  GigaBytes
Max Memory Allocated: 2.074596881866455  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 2.074601173400879  GigaBytes
Max Memory Allocated: 2.074601173400879  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2987060546875 GB
    Memory Allocated: 2.1025705337524414  GigaBytes
Max Memory Allocated: 2.1045541763305664  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([74, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2987060546875 GB
    Memory Allocated: 2.1039652824401855  GigaBytes
Max Memory Allocated: 2.1045541763305664  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2987060546875 GB
    Memory Allocated: 2.1039652824401855  GigaBytes
Max Memory Allocated: 2.1045541763305664  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.2987060546875 GB
    Memory Allocated: 2.1041064262390137  GigaBytes
Max Memory Allocated: 2.1045541763305664  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3182373046875 GB
    Memory Allocated: 2.124995708465576  GigaBytes
Max Memory Allocated: 2.1264777183532715  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([67, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.3182373046875 GB
    Memory Allocated: 2.126342296600342  GigaBytes
Max Memory Allocated: 2.1264777183532715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3182373046875 GB
    Memory Allocated: 2.126342296600342  GigaBytes
Max Memory Allocated: 2.1264777183532715  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.3182373046875 GB
    Memory Allocated: 2.1264700889587402  GigaBytes
Max Memory Allocated: 2.1264777183532715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3533935546875 GB
    Memory Allocated: 2.146277904510498  GigaBytes
Max Memory Allocated: 2.147683620452881  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([65, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.3533935546875 GB
    Memory Allocated: 2.147651195526123  GigaBytes
Max Memory Allocated: 2.147683620452881  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3533935546875 GB
    Memory Allocated: 2.147651195526123  GigaBytes
Max Memory Allocated: 2.147683620452881  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.3533935546875 GB
    Memory Allocated: 2.147775173187256  GigaBytes
Max Memory Allocated: 2.147775173187256  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3748779296875 GB
    Memory Allocated: 2.1678595542907715  GigaBytes
Max Memory Allocated: 2.169285297393799  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([46, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.3748779296875 GB
    Memory Allocated: 2.168921947479248  GigaBytes
Max Memory Allocated: 2.169285297393799  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3748779296875 GB
    Memory Allocated: 2.168921947479248  GigaBytes
Max Memory Allocated: 2.169285297393799  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.3748779296875 GB
    Memory Allocated: 2.1690096855163574  GigaBytes
Max Memory Allocated: 2.169285297393799  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3885498046875 GB
    Memory Allocated: 2.183837413787842  GigaBytes
Max Memory Allocated: 2.1848902702331543  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([638, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.3885498046875 GB
    Memory Allocated: 2.1991238594055176  GigaBytes
Max Memory Allocated: 2.199183464050293  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3885498046875 GB
    Memory Allocated: 2.1991238594055176  GigaBytes
Max Memory Allocated: 2.199183464050293  GigaBytes

 h.shape torch.Size([1, 638, 256]), torch.Size([1, 638, 256])
----------------------------------------3
 Nvidia-smi: 3.3905029296875 GB
    Memory Allocated: 2.200340747833252  GigaBytes
Max Memory Allocated: 2.200340747833252  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6346435546875 GB
    Memory Allocated: 2.415523052215576  GigaBytes
Max Memory Allocated: 2.431148052215576  GigaBytes

rst.shape  torch.Size([1, 638, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.6463623046875 GB
    Memory Allocated: 2.3461499214172363  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.6463623046875 GB
    Memory Allocated: 2.347870349884033  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.6463623046875 GB
    Memory Allocated: 2.34959077835083  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.6463623046875 GB
    Memory Allocated: 2.3477840423583984  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

torch.Size([11545, 40])
input nodes number: 22141
output nodes number: 11545
edges number: 83693
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6463623046875 GB
    Memory Allocated: 2.3497557640075684  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.6463623046875 GB
    Memory Allocated: 2.3497567176818848  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8104248046875 GB
    Memory Allocated: 0.030026912689208984  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

pseudo mini batch 1 input nodes size: 49486
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8104248046875 GB
    Memory Allocated: 0.025301456451416016  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8104248046875 GB
    Memory Allocated: 0.025301456451416016  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8104248046875 GB
    Memory Allocated: 0.04889822006225586  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8104248046875 GB
    Memory Allocated: 0.04898500442504883  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8104248046875 GB
    Memory Allocated: 0.030957698822021484  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8104248046875 GB
    Memory Allocated: 0.03271913528442383  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8104248046875 GB
    Memory Allocated: 0.03271913528442383  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8104248046875 GB
    Memory Allocated: 0.03271913528442383  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

torch.Size([49486, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8104248046875 GB
    Memory Allocated: 0.03271913528442383  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

m.shape torch.Size([2630, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.10879707336425781  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.10879707336425781  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

 h.shape torch.Size([1, 2630, 128]), torch.Size([1, 2630, 128])
----------------------------------------3
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.11130523681640625  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.1319580078125  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

rst.shape  torch.Size([1, 2630, 128])
m.shape torch.Size([2648, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.13364410400390625  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.13364410400390625  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

 h.shape torch.Size([1, 2648, 128]), torch.Size([1, 2648, 128])
----------------------------------------3
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.13616943359375  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.17440414428710938  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

rst.shape  torch.Size([1, 2648, 128])
m.shape torch.Size([2347, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.17692947387695312  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.17692947387695312  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

 h.shape torch.Size([1, 2347, 128]), torch.Size([1, 2347, 128])
----------------------------------------3
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.17929410934448242  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.23005008697509766  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

rst.shape  torch.Size([1, 2347, 128])
m.shape torch.Size([1961, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.23340749740600586  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.23340749740600586  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

 h.shape torch.Size([1, 1961, 128]), torch.Size([1, 1961, 128])
----------------------------------------3
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.23527765274047852  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.29010772705078125  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

rst.shape  torch.Size([1, 1961, 128])
m.shape torch.Size([1741, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.2933235168457031  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.2933235168457031  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

 h.shape torch.Size([1, 1741, 128]), torch.Size([1, 1741, 128])
----------------------------------------3
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.2949838638305664  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.3559236526489258  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

rst.shape  torch.Size([1, 1741, 128])
m.shape torch.Size([1414, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.35913896560668945  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.35913896560668945  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

 h.shape torch.Size([1, 1414, 128]), torch.Size([1, 1414, 128])
----------------------------------------3
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.3604874610900879  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.41932153701782227  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

rst.shape  torch.Size([1, 1414, 128])
m.shape torch.Size([1238, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.42277956008911133  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.42277956008911133  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

 h.shape torch.Size([1, 1238, 128]), torch.Size([1, 1238, 128])
----------------------------------------3
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.42396020889282227  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.48336029052734375  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

rst.shape  torch.Size([1, 1238, 128])
m.shape torch.Size([1105, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.4869852066040039  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.4869852066040039  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

 h.shape torch.Size([1, 1105, 128]), torch.Size([1, 1105, 128])
----------------------------------------3
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.4880390167236328  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.5492315292358398  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

rst.shape  torch.Size([1, 1105, 128])
m.shape torch.Size([952, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.5527901649475098  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.5527901649475098  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

 h.shape torch.Size([1, 952, 128]), torch.Size([1, 952, 128])
----------------------------------------3
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.5536980628967285  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.6125302314758301  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

rst.shape  torch.Size([1, 952, 128])
m.shape torch.Size([8512, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.6526646614074707  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.6526646614074707  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

 h.shape torch.Size([1, 8512, 128]), torch.Size([1, 8512, 128])
----------------------------------------3
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 0.6617283821105957  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 1.2380833625793457  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

rst.shape  torch.Size([1, 8512, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 1.1731700897216797  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 1.1965808868408203  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 1.219991683959961  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 1.1963977813720703  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

torch.Size([24548, 256])
first layer input nodes number: 49486
first layer output nodes number: 24548
edges number: 151194
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 1.220362663269043  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 1.2437734603881836  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 1.2496261596679688  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 1.2496261596679688  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

m.shape torch.Size([1892, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.3347272872924805  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.3347272872924805  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

 h.shape torch.Size([1, 1892, 256]), torch.Size([1, 1892, 256])
----------------------------------------3
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.3383359909057617  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.3684358596801758  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

rst.shape  torch.Size([1, 1892, 256])
m.shape torch.Size([1549, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.369950771331787  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.369950771331787  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

 h.shape torch.Size([1, 1549, 256]), torch.Size([1, 1549, 256])
----------------------------------------3
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.3729338645935059  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.4187970161437988  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

rst.shape  torch.Size([1, 1549, 256])
m.shape torch.Size([1221, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.42051362991333  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.42051362991333  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

 h.shape torch.Size([1, 1221, 256]), torch.Size([1, 1221, 256])
----------------------------------------3
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.4230303764343262  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.4791417121887207  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

rst.shape  torch.Size([1, 1221, 256])
m.shape torch.Size([998, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.4812602996826172  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.4812602996826172  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

 h.shape torch.Size([1, 998, 256]), torch.Size([1, 998, 256])
----------------------------------------3
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.483163833618164  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.5388622283935547  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

rst.shape  torch.Size([1, 998, 256])
m.shape torch.Size([832, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.5422444343566895  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.5422444343566895  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

 h.shape torch.Size([1, 832, 256]), torch.Size([1, 832, 256])
----------------------------------------3
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.5438313484191895  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.6027913093566895  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

rst.shape  torch.Size([1, 832, 256])
m.shape torch.Size([627, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.6056137084960938  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.6056137084960938  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

 h.shape torch.Size([1, 627, 256]), torch.Size([1, 627, 256])
----------------------------------------3
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.6068096160888672  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.6681785583496094  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

rst.shape  torch.Size([1, 627, 256])
m.shape torch.Size([544, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.6712408065795898  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.6712408065795898  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

 h.shape torch.Size([1, 544, 256]), torch.Size([1, 544, 256])
----------------------------------------3
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.6722784042358398  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.7251253128051758  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

rst.shape  torch.Size([1, 544, 256])
m.shape torch.Size([471, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.7282280921936035  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.7282280921936035  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

 h.shape torch.Size([1, 471, 256]), torch.Size([1, 471, 256])
----------------------------------------3
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.7291264533996582  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.7810616493225098  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

rst.shape  torch.Size([1, 471, 256])
m.shape torch.Size([384, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.783998966217041  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.783998966217041  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

 h.shape torch.Size([1, 384, 256]), torch.Size([1, 384, 256])
----------------------------------------3
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.784731388092041  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.8323216438293457  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

rst.shape  torch.Size([1, 384, 256])
m.shape torch.Size([355, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.8353676795959473  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.8353676795959473  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

 h.shape torch.Size([1, 355, 256]), torch.Size([1, 355, 256])
----------------------------------------3
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.8360447883605957  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.8853096961975098  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

rst.shape  torch.Size([1, 355, 256])
m.shape torch.Size([260, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.8877201080322266  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.8877201080322266  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

 h.shape torch.Size([1, 260, 256]), torch.Size([1, 260, 256])
----------------------------------------3
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.8882160186767578  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.928429126739502  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

rst.shape  torch.Size([1, 260, 256])
m.shape torch.Size([257, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.9311456680297852  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.9311456680297852  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.931635856628418  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.9749383926391602  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([209, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.9773049354553223  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.9773049354553223  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 1.97770357131958  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.014378070831299  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([199, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.0168566703796387  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.0168566703796387  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.0172362327575684  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.0548129081726074  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([179, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.057203769683838  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.057203769683838  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.0575451850891113  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.0937352180480957  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([127, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.095517635345459  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.095517635345459  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.095759868621826  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.1231322288513184  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([126, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.125070095062256  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.125070095062256  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.1253104209899902  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.1541495323181152  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([123, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.1561574935913086  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.1561574935913086  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.1563920974731445  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.1861867904663086  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([93, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.18776798248291  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.18776798248291  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.1879453659057617  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.211714744567871  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([77, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.213106632232666  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.213106632232666  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.2132534980773926  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.233961582183838  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([63, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.2351598739624023  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.2351598739624023  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.2352800369262695  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.2530641555786133  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([77, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.2546324729919434  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.2546324729919434  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.25477933883667  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.277543544769287  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([45, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.2787322998046875  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.2787322998046875  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.278818130493164  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.292722702026367  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([62, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.294881820678711  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.294881820678711  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.2950000762939453  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.3149852752685547  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([822, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.3346776962280273  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.3346776962280273  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

 h.shape torch.Size([1, 822, 256]), torch.Size([1, 822, 256])
----------------------------------------3
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.336245536804199  GigaBytes
Max Memory Allocated: 2.4486966133117676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9041748046875 GB
    Memory Allocated: 2.6159591674804688  GigaBytes
Max Memory Allocated: 2.635557174682617  GigaBytes

rst.shape  torch.Size([1, 822, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9041748046875 GB
    Memory Allocated: 2.5430989265441895  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9041748046875 GB
    Memory Allocated: 2.54490327835083  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9041748046875 GB
    Memory Allocated: 2.5472493171691895  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9041748046875 GB
    Memory Allocated: 2.545358180999756  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

torch.Size([11592, 40])
input nodes number: 24548
output nodes number: 11592
edges number: 85066
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9041748046875 GB
    Memory Allocated: 2.5457119941711426  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9041748046875 GB
    Memory Allocated: 2.545712471008301  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.03624725341796875  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

pseudo mini batch 2 input nodes size: 32880
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.031041622161865234  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.031041622161865234  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.047276973724365234  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.04736328125  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.023679733276367188  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.025361061096191406  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.025361061096191406  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.025361061096191406  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

torch.Size([32880, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.025361061096191406  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

m.shape torch.Size([2172, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.0913686752319336  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.0913686752319336  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 2172, 128]), torch.Size([1, 2172, 128])
----------------------------------------3
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.09344005584716797  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.1103372573852539  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 2172, 128])
m.shape torch.Size([2230, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.11142826080322266  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.11142826080322266  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 2230, 128]), torch.Size([1, 2230, 128])
----------------------------------------3
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.11379814147949219  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.14752197265625  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 2230, 128])
m.shape torch.Size([1958, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.14964866638183594  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.14964866638183594  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 1958, 128]), torch.Size([1, 1958, 128])
----------------------------------------3
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.15151596069335938  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.192596435546875  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 1958, 128])
m.shape torch.Size([1683, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.19487285614013672  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.19487285614013672  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 1683, 128]), torch.Size([1, 1683, 128])
----------------------------------------3
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.19647789001464844  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.24551868438720703  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 1683, 128])
m.shape torch.Size([1516, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.24833059310913086  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.24833059310913086  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 1516, 128]), torch.Size([1, 1516, 128])
----------------------------------------3
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.24977636337280273  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.3019251823425293  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 1516, 128])
m.shape torch.Size([1226, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.30470991134643555  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.30470991134643555  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 1226, 128]), torch.Size([1, 1226, 128])
----------------------------------------3
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.3058791160583496  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.3564143180847168  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 1226, 128])
m.shape torch.Size([1094, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.3594813346862793  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.3594813346862793  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 1094, 128]), torch.Size([1, 1094, 128])
----------------------------------------3
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.36052465438842773  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.41272878646850586  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 1094, 128])
m.shape torch.Size([957, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.41585779190063477  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.41585779190063477  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 957, 128]), torch.Size([1, 957, 128])
----------------------------------------3
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.41677045822143555  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.4701504707336426  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 957, 128])
m.shape torch.Size([821, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.4732174873352051  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.4732174873352051  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 821, 128]), torch.Size([1, 821, 128])
----------------------------------------3
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.4740004539489746  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.5256991386413574  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 821, 128])
m.shape torch.Size([7470, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.5609273910522461  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.5609273910522461  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 7470, 128]), torch.Size([1, 7470, 128])
----------------------------------------3
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 0.5680513381958008  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 1.0738515853881836  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 7470, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 1.0179901123046875  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 1.0381383895874023  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 1.0582866668701172  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 1.037980556488037  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

torch.Size([21127, 256])
first layer input nodes number: 32880
first layer output nodes number: 21127
edges number: 131577
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 1.0585336685180664  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 1.0786819458007812  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 1.0839653015136719  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 1.0839653015136719  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

m.shape torch.Size([1593, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.1766901016235352  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.1766901016235352  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 1593, 256]), torch.Size([1, 1593, 256])
----------------------------------------3
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.1801328659057617  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.2059040069580078  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 1593, 256])
m.shape torch.Size([1417, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.2075843811035156  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.2075843811035156  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 1417, 256]), torch.Size([1, 1417, 256])
----------------------------------------3
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.2103891372680664  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.2526273727416992  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 1417, 256])
m.shape torch.Size([1187, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.254328727722168  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.254328727722168  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 1187, 256]), torch.Size([1, 1187, 256])
----------------------------------------3
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.2566328048706055  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.3170509338378906  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 1187, 256])
m.shape torch.Size([932, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.3189129829406738  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.3189129829406738  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 932, 256]), torch.Size([1, 932, 256])
----------------------------------------3
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.320690631866455  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.3722424507141113  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 932, 256])
m.shape torch.Size([798, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.3751888275146484  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.3751888275146484  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 798, 256]), torch.Size([1, 798, 256])
----------------------------------------3
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.3767108917236328  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.432046890258789  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 798, 256])
m.shape torch.Size([635, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.4349479675292969  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.4349479675292969  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 635, 256]), torch.Size([1, 635, 256])
----------------------------------------3
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.4361591339111328  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.4883918762207031  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 635, 256])
m.shape torch.Size([551, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.4914937019348145  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.4914937019348145  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 551, 256]), torch.Size([1, 551, 256])
----------------------------------------3
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.4925446510314941  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.5463204383850098  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 551, 256])
m.shape torch.Size([478, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.5494704246520996  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.5494704246520996  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 478, 256]), torch.Size([1, 478, 256])
----------------------------------------3
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.550382137298584  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.6028990745544434  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 478, 256])
m.shape torch.Size([403, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.6059293746948242  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.6059293746948242  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 403, 256]), torch.Size([1, 403, 256])
----------------------------------------3
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.6066980361938477  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.6576156616210938  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 403, 256])
m.shape torch.Size([350, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.660595417022705  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.660595417022705  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 350, 256]), torch.Size([1, 350, 256])
----------------------------------------3
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.6612629890441895  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.7095284461975098  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 350, 256])
m.shape torch.Size([308, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.7124509811401367  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.7124509811401367  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 308, 256]), torch.Size([1, 308, 256])
----------------------------------------3
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.713038444519043  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.7602529525756836  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 308, 256])
m.shape torch.Size([254, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.7628889083862305  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.7628889083862305  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.7633733749389648  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.8045530319213867  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([230, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.8071846961975098  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.8071846961975098  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.8076233863830566  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.8479828834533691  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([205, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.8505220413208008  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.8505220413208008  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.8509130477905273  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.889622688293457  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([193, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.8922100067138672  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.8922100067138672  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.892578125  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.9315986633300781  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([147, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.9338326454162598  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.9338326454162598  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.9341130256652832  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.9657959938049316  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([166, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.9683685302734375  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.9683685302734375  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 1.9686851501464844  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 2.0066795349121094  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([114, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 2.0084939002990723  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 2.0084939002990723  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 2.008711338043213  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 2.0363259315490723  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([106, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 2.0381531715393066  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 2.0381531715393066  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 2.0383553504943848  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 2.0654473304748535  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([123, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 2.0677108764648438  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 2.0677108764648438  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 2.0679454803466797  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 2.101024627685547  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([114, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 2.103208541870117  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 2.103208541870117  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 2.103425979614258  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 2.1356067657470703  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([64, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 2.1368513107299805  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 2.1368513107299805  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 2.1369733810424805  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 2.1558942794799805  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([71, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 2.157402992248535  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 2.157402992248535  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.1561279296875 GB
    Memory Allocated: 2.157538414001465  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1756591796875 GB
    Memory Allocated: 2.179476737976074  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([72, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.1756591796875 GB
    Memory Allocated: 2.181069850921631  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1756591796875 GB
    Memory Allocated: 2.181069850921631  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.1756591796875 GB
    Memory Allocated: 2.1812071800231934  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1990966796875 GB
    Memory Allocated: 2.204415798187256  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([1024, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.2010498046875 GB
    Memory Allocated: 2.228951930999756  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2010498046875 GB
    Memory Allocated: 2.228951930999756  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 1024, 256]), torch.Size([1, 1024, 256])
----------------------------------------3
 Nvidia-smi: 4.2030029296875 GB
    Memory Allocated: 2.230905055999756  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2537841796875 GB
    Memory Allocated: 2.574655055999756  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 1024, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.2537841796875 GB
    Memory Allocated: 2.493443012237549  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.2537841796875 GB
    Memory Allocated: 2.495164394378662  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.2537841796875 GB
    Memory Allocated: 2.4968857765197754  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.2537841796875 GB
    Memory Allocated: 2.4950780868530273  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

torch.Size([11535, 40])
input nodes number: 21127
output nodes number: 11535
edges number: 93978
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2537841796875 GB
    Memory Allocated: 2.4952392578125  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.2537841796875 GB
    Memory Allocated: 2.495239734649658  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.028509140014648438  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

pseudo mini batch 3 input nodes size: 32666
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.023596763610839844  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.023596763610839844  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.039221763610839844  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.03930854797363281  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.022986888885498047  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.024525165557861328  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.024525165557861328  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.024525165557861328  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

torch.Size([32666, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.024525165557861328  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

m.shape torch.Size([2077, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.08397150039672852  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.08397150039672852  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 2077, 128]), torch.Size([1, 2077, 128])
----------------------------------------3
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.0859522819519043  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.10335397720336914  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 2077, 128])
m.shape torch.Size([2254, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.10451316833496094  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.10451316833496094  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 2254, 128]), torch.Size([1, 2254, 128])
----------------------------------------3
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.10756874084472656  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.14159488677978516  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 2254, 128])
m.shape torch.Size([2058, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.14374446868896484  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.14374446868896484  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 2058, 128]), torch.Size([1, 2058, 128])
----------------------------------------3
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.1457071304321289  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.1921701431274414  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 2058, 128])
m.shape torch.Size([1696, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.19350910186767578  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.19350910186767578  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 1696, 128]), torch.Size([1, 1696, 128])
----------------------------------------3
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.19512653350830078  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.24349689483642578  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 1696, 128])
m.shape torch.Size([1446, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.24613571166992188  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.24613571166992188  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 1446, 128]), torch.Size([1, 1446, 128])
----------------------------------------3
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.2475147247314453  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.29738712310791016  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 1446, 128])
m.shape torch.Size([1288, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.3003826141357422  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.3003826141357422  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 1288, 128]), torch.Size([1, 1288, 128])
----------------------------------------3
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.30161094665527344  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.35513877868652344  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 1288, 128])
m.shape torch.Size([1103, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.35820627212524414  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.35820627212524414  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 1103, 128]), torch.Size([1, 1103, 128])
----------------------------------------3
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.35925817489624023  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.4118533134460449  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 1103, 128])
m.shape torch.Size([963, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.41500091552734375  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.41500091552734375  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 963, 128]), torch.Size([1, 963, 128])
----------------------------------------3
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.41591930389404297  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.4690818786621094  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 963, 128])
m.shape torch.Size([812, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.4721074104309082  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.4721074104309082  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 812, 128]), torch.Size([1, 812, 128])
----------------------------------------3
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.4728817939758301  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.5240035057067871  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 812, 128])
m.shape torch.Size([6192, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.5531420707702637  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.5531420707702637  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 6192, 128]), torch.Size([1, 6192, 128])
----------------------------------------3
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.5590472221374512  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.9783129692077637  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 6192, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.9268226623535156  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.9463539123535156  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.9658851623535156  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.9462056159973145  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

torch.Size([19889, 256])
first layer input nodes number: 32666
first layer output nodes number: 19889
edges number: 119154
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.9661307334899902  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.9856619834899902  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.9904041290283203  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.9904041290283203  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

m.shape torch.Size([1498, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.0761966705322266  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.0761966705322266  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 1498, 256]), torch.Size([1, 1498, 256])
----------------------------------------3
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.079446792602539  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.1047744750976562  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 1498, 256])
m.shape torch.Size([1473, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.1059598922729492  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.1059598922729492  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 1473, 256]), torch.Size([1, 1473, 256])
----------------------------------------3
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.1095914840698242  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.1543912887573242  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 1473, 256])
m.shape torch.Size([1254, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.156191349029541  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.156191349029541  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 1254, 256]), torch.Size([1, 1254, 256])
----------------------------------------3
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.1586923599243164  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.216752052307129  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 1254, 256])
m.shape torch.Size([990, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.2188129425048828  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.2188129425048828  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 990, 256]), torch.Size([1, 990, 256])
----------------------------------------3
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.2207012176513672  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.275796890258789  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 990, 256])
m.shape torch.Size([837, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.2793092727661133  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.2793092727661133  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 837, 256]), torch.Size([1, 837, 256])
----------------------------------------3
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.2809057235717773  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.339125633239746  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 837, 256])
m.shape torch.Size([731, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.342543125152588  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.342543125152588  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 731, 256]), torch.Size([1, 731, 256])
----------------------------------------3
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.3439373970031738  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.4054341316223145  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 731, 256])
m.shape torch.Size([608, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.408827781677246  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.408827781677246  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 608, 256]), torch.Size([1, 608, 256])
----------------------------------------3
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.409987449645996  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.4692974090576172  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 608, 256])
m.shape torch.Size([511, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.472646713256836  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.472646713256836  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 511, 256]), torch.Size([1, 511, 256])
----------------------------------------3
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.4736213684082031  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.5298099517822266  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 511, 256])
m.shape torch.Size([445, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.5331721305847168  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.5331721305847168  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 445, 256]), torch.Size([1, 445, 256])
----------------------------------------3
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.5340209007263184  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.5899243354797363  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 445, 256])
m.shape torch.Size([392, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.5932679176330566  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.5932679176330566  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 392, 256]), torch.Size([1, 392, 256])
----------------------------------------3
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.5940155982971191  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.6473450660705566  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 392, 256])
m.shape torch.Size([364, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.6508197784423828  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.6508197784423828  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 364, 256]), torch.Size([1, 364, 256])
----------------------------------------3
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.6515140533447266  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.706197738647461  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 364, 256])
m.shape torch.Size([291, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.7092070579528809  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.7092070579528809  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.7097620964050293  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.758317470550537  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 291, 256])
m.shape torch.Size([231, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.7609262466430664  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.7609262466430664  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.761366844177246  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.8019018173217773  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([209, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.8044939041137695  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.8044939041137695  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.8048925399780273  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.8443574905395508  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([158, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.8464365005493164  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.8464365005493164  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.8467378616333008  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.8786821365356445  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([154, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.8808999061584473  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.8808999061584473  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.8811936378479004  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.9143853187561035  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([151, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.9167060852050781  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.9167060852050781  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.9169940948486328  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.9515552520751953  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([127, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.953664779663086  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.953664779663086  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.9539070129394531  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.984670639038086  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([92, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.9862298965454102  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.9862298965454102  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 1.986405372619629  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 2.0099191665649414  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([103, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 2.0118117332458496  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 2.0118117332458496  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 2.0120081901550293  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 2.0397086143493652  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([99, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 2.0416088104248047  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 2.0416088104248047  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 2.041797637939453  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 2.069744110107422  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([78, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 2.0712990760803223  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 2.0712990760803223  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 2.0714478492736816  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 2.0945076942443848  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([68, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 2.096877098083496  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 2.096877098083496  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 2.0970067977905273  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 2.11801815032959  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([61, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 2.1193604469299316  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 2.1193604469299316  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 2.119476795196533  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 2.1391396522521973  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([660, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 2.154940128326416  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 2.154940128326416  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 660, 256]), torch.Size([1, 660, 256])
----------------------------------------3
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 2.1561989784240723  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 2.3777565956115723  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 660, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 2.3032054901123047  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 2.305021286010742  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 2.3069286346435547  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 2.305026054382324  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

torch.Size([11585, 40])
input nodes number: 19889
output nodes number: 11585
edges number: 87249
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 2.3053555488586426  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 2.305356025695801  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.02762746810913086  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

pseudo mini batch 4 input nodes size: 71203
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.023081302642822266  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.023081302642822266  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.057033538818359375  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.057116031646728516  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.04140424728393555  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.043825626373291016  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.043825626373291016  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.043825626373291016  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

torch.Size([71203, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 0.043825626373291016  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

m.shape torch.Size([3019, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.16613101959228516  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.16613101959228516  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 3019, 128]), torch.Size([1, 3019, 128])
----------------------------------------3
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.16901016235351562  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.19244766235351562  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 3019, 128])
m.shape torch.Size([3057, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.1939234733581543  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.1939234733581543  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 3057, 128]), torch.Size([1, 3057, 128])
----------------------------------------3
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.1968388557434082  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.24222755432128906  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 3057, 128])
m.shape torch.Size([2486, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.24432611465454102  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.24432611465454102  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 2486, 128]), torch.Size([1, 2486, 128])
----------------------------------------3
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.24720525741577148  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.30008363723754883  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 2486, 128])
m.shape torch.Size([2138, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.30245447158813477  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.30245447158813477  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 2138, 128]), torch.Size([1, 2138, 128])
----------------------------------------3
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.3054237365722656  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.36730289459228516  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 2138, 128])
m.shape torch.Size([1959, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.3709540367126465  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.3709540367126465  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 1959, 128]), torch.Size([1, 1959, 128])
----------------------------------------3
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.37282228469848633  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.4400792121887207  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 1959, 128])
m.shape torch.Size([1645, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.4438514709472656  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.4438514709472656  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 1645, 128]), torch.Size([1, 1645, 128])
----------------------------------------3
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.4454202651977539  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.51287841796875  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 1645, 128])
m.shape torch.Size([1498, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.5170941352844238  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.5170941352844238  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 1498, 128]), torch.Size([1, 1498, 128])
----------------------------------------3
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.5185227394104004  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.5904154777526855  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 1498, 128])
m.shape torch.Size([1410, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.5950798988342285  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.5950798988342285  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 1410, 128]), torch.Size([1, 1410, 128])
----------------------------------------3
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.5964245796203613  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.6753907203674316  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 1410, 128])
m.shape torch.Size([1218, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.6799454689025879  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.6799454689025879  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 1218, 128]), torch.Size([1, 1218, 128])
----------------------------------------3
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.6811070442199707  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.7580265998840332  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 1218, 128])
m.shape torch.Size([16921, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.8381314277648926  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.8381314277648926  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 16921, 128]), torch.Size([1, 16921, 128])
----------------------------------------3
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.8542685508728027  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1014404296875 GB
    Memory Allocated: 2.0130085945129395  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 16921, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.1014404296875 GB
    Memory Allocated: 1.9030537605285645  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.1014404296875 GB
    Memory Allocated: 1.9367671012878418  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.1014404296875 GB
    Memory Allocated: 1.9704804420471191  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.1014404296875 GB
    Memory Allocated: 1.9365034103393555  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

torch.Size([35351, 256])
first layer input nodes number: 71203
first layer output nodes number: 35351
edges number: 246746
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.1014404296875 GB
    Memory Allocated: 1.971013069152832  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.1014404296875 GB
    Memory Allocated: 2.0047264099121094  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.1014404296875 GB
    Memory Allocated: 2.013154983520508  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.1014404296875 GB
    Memory Allocated: 2.013154983520508  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

m.shape torch.Size([2054, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.090738296508789  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.090738296508789  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 2054, 256]), torch.Size([1, 2054, 256])
----------------------------------------3
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.095151901245117  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.1277079582214355  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 2054, 256])
m.shape torch.Size([1716, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.12916898727417  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.12916898727417  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 1716, 256]), torch.Size([1, 1716, 256])
----------------------------------------3
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.132450580596924  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.18453311920166  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 1716, 256])
m.shape torch.Size([1197, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.1866631507873535  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.1866631507873535  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 1197, 256]), torch.Size([1, 1197, 256])
----------------------------------------3
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.1891942024230957  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.2420897483825684  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 1197, 256])
m.shape torch.Size([902, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.2441000938415527  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.2441000938415527  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 902, 256]), torch.Size([1, 902, 256])
----------------------------------------3
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.2458205223083496  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.295712947845459  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 902, 256])
m.shape torch.Size([749, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.298452377319336  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.298452377319336  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 749, 256]), torch.Size([1, 749, 256])
----------------------------------------3
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.2998809814453125  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.352354049682617  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 749, 256])
m.shape torch.Size([582, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.3549962043762207  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.3549962043762207  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 582, 256]), torch.Size([1, 582, 256])
----------------------------------------3
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.3561062812805176  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.404392719268799  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 582, 256])
m.shape torch.Size([465, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.406966209411621  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.406966209411621  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 465, 256]), torch.Size([1, 465, 256])
----------------------------------------3
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.407853126525879  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.452458381652832  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 465, 256])
m.shape torch.Size([398, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.455075263977051  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.455075263977051  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 398, 256]), torch.Size([1, 398, 256])
----------------------------------------3
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.45583438873291  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.4998350143432617  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 398, 256])
m.shape torch.Size([300, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.5020508766174316  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.5020508766174316  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.5026230812072754  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.5405960083007812  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([262, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.54282808303833  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.54282808303833  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.543327808380127  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.5799560546875  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([231, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.582148551940918  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.582148551940918  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.5825891494750977  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.6169557571411133  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([192, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.6189498901367188  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.6189498901367188  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.6193161010742188  GigaBytes
Max Memory Allocated: 2.6483850479125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.6504440307617188  GigaBytes
Max Memory Allocated: 2.6526412963867188  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([146, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.652085304260254  GigaBytes
Max Memory Allocated: 2.6526412963867188  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.652085304260254  GigaBytes
Max Memory Allocated: 2.6526412963867188  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.6523637771606445  GigaBytes
Max Memory Allocated: 2.6526412963867188  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.677983283996582  GigaBytes
Max Memory Allocated: 2.6800899505615234  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([127, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.679964065551758  GigaBytes
Max Memory Allocated: 2.6800899505615234  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.679964065551758  GigaBytes
Max Memory Allocated: 2.6800899505615234  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.680206298828125  GigaBytes
Max Memory Allocated: 2.680206298828125  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.7041873931884766  GigaBytes
Max Memory Allocated: 2.705883026123047  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([103, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.7055516242980957  GigaBytes
Max Memory Allocated: 2.705883026123047  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.7055516242980957  GigaBytes
Max Memory Allocated: 2.705883026123047  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.7057480812072754  GigaBytes
Max Memory Allocated: 2.705883026123047  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.7265725135803223  GigaBytes
Max Memory Allocated: 2.72804594039917  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([104, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.7280735969543457  GigaBytes
Max Memory Allocated: 2.7280797958374023  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.7280735969543457  GigaBytes
Max Memory Allocated: 2.7280797958374023  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.728271961212158  GigaBytes
Max Memory Allocated: 2.728271961212158  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.7506871223449707  GigaBytes
Max Memory Allocated: 2.7522740364074707  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([92, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.752091407775879  GigaBytes
Max Memory Allocated: 2.7522740364074707  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.752091407775879  GigaBytes
Max Memory Allocated: 2.7522740364074707  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.7522668838500977  GigaBytes
Max Memory Allocated: 2.7522740364074707  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.7733240127563477  GigaBytes
Max Memory Allocated: 2.774815559387207  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([97, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.7749147415161133  GigaBytes
Max Memory Allocated: 2.774921417236328  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.7749147415161133  GigaBytes
Max Memory Allocated: 2.774921417236328  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.775099754333496  GigaBytes
Max Memory Allocated: 2.775099754333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.7985963821411133  GigaBytes
Max Memory Allocated: 2.8002614974975586  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([88, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.8001112937927246  GigaBytes
Max Memory Allocated: 2.8002614974975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.8001112937927246  GigaBytes
Max Memory Allocated: 2.8002614974975586  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.800279140472412  GigaBytes
Max Memory Allocated: 2.800279140472412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.822770595550537  GigaBytes
Max Memory Allocated: 2.8243651390075684  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([87, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.82435941696167  GigaBytes
Max Memory Allocated: 2.8243660926818848  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.82435941696167  GigaBytes
Max Memory Allocated: 2.8243660926818848  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.8245253562927246  GigaBytes
Max Memory Allocated: 2.8245253562927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.8479228019714355  GigaBytes
Max Memory Allocated: 2.8495821952819824  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([65, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.849152088165283  GigaBytes
Max Memory Allocated: 2.8495821952819824  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.849152088165283  GigaBytes
Max Memory Allocated: 2.8495821952819824  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.849276065826416  GigaBytes
Max Memory Allocated: 2.8495821952819824  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.8676247596740723  GigaBytes
Max Memory Allocated: 2.868926525115967  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([51, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.8686413764953613  GigaBytes
Max Memory Allocated: 2.868926525115967  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.8686413764953613  GigaBytes
Max Memory Allocated: 2.868926525115967  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.8687386512756348  GigaBytes
Max Memory Allocated: 2.868926525115967  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.8838162422180176  GigaBytes
Max Memory Allocated: 2.8848862648010254  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([46, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.884784698486328  GigaBytes
Max Memory Allocated: 2.8848862648010254  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.884784698486328  GigaBytes
Max Memory Allocated: 2.8848862648010254  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.8848724365234375  GigaBytes
Max Memory Allocated: 2.8848862648010254  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.8990859985351562  GigaBytes
Max Memory Allocated: 2.900094985961914  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([56, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.900333881378174  GigaBytes
Max Memory Allocated: 2.900339126586914  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.900333881378174  GigaBytes
Max Memory Allocated: 2.900339126586914  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.9004406929016113  GigaBytes
Max Memory Allocated: 2.9004406929016113  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.918491840362549  GigaBytes
Max Memory Allocated: 2.919773578643799  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([925, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.940664768218994  GigaBytes
Max Memory Allocated: 2.940751075744629  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.940664768218994  GigaBytes
Max Memory Allocated: 2.940751075744629  GigaBytes

 h.shape torch.Size([1, 925, 256]), torch.Size([1, 925, 256])
----------------------------------------3
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 2.9424290657043457  GigaBytes
Max Memory Allocated: 2.9424290657043457  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 3.2529454231262207  GigaBytes
Max Memory Allocated: 3.2749991416931152  GigaBytes

rst.shape  torch.Size([1, 925, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 3.1874494552612305  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 3.1893186569213867  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 3.191206932067871  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 3.1892552375793457  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

torch.Size([11035, 40])
input nodes number: 35351
output nodes number: 11035
edges number: 78147
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 3.18965482711792  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 3.189655303955078  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.04832935333251953  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

pseudo mini batch 5 input nodes size: 52044
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.0414576530456543  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.0414576530456543  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.06627416610717773  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.06635808944702148  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.032323360443115234  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.03392934799194336  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.03392934799194336  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.03392934799194336  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

torch.Size([52044, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.03392934799194336  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

m.shape torch.Size([2992, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.10788536071777344  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.10788536071777344  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 2992, 128]), torch.Size([1, 2992, 128])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.11161661148071289  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.1347489356994629  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 2992, 128])
m.shape torch.Size([3171, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.13648080825805664  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.13648080825805664  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 3171, 128]), torch.Size([1, 3171, 128])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.13950490951538086  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.1850566864013672  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 3171, 128])
m.shape torch.Size([2832, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.1875324249267578  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.1875324249267578  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 2832, 128]), torch.Size([1, 2832, 128])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.19039344787597656  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.25053977966308594  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 2832, 128])
m.shape torch.Size([2366, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.25353431701660156  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.25353431701660156  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 2366, 128]), torch.Size([1, 2366, 128])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.25657081604003906  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.32497358322143555  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 2366, 128])
m.shape torch.Size([2053, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.3294863700866699  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.3294863700866699  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 2053, 128]), torch.Size([1, 2053, 128])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.3317270278930664  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.4078845977783203  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 2053, 128])
m.shape torch.Size([1649, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.411623477935791  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.411623477935791  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 1649, 128]), torch.Size([1, 1649, 128])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.4131960868835449  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.4808182716369629  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 1649, 128])
m.shape torch.Size([1375, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.484621524810791  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.484621524810791  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 1375, 128]), torch.Size([1, 1375, 128])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.4859328269958496  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.5519194602966309  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 1375, 128])
m.shape torch.Size([1219, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.5559139251708984  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.5559139251708984  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 1219, 128]), torch.Size([1, 1219, 128])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.5570764541625977  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.6261329650878906  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 1219, 128])
m.shape torch.Size([970, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.6297144889831543  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.6297144889831543  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 970, 128]), torch.Size([1, 970, 128])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.6306395530700684  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.6899294853210449  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 970, 128])
m.shape torch.Size([7220, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.7238945960998535  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.7238945960998535  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 7220, 128]), torch.Size([1, 7220, 128])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.7307801246643066  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.2196526527404785  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 7220, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.1566429138183594  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.1812925338745117  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.205942153930664  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.1810998916625977  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

torch.Size([25847, 256])
first layer input nodes number: 52044
first layer output nodes number: 25847
edges number: 147760
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.2063322067260742  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.2309818267822266  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.2375822067260742  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.2375822067260742  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

m.shape torch.Size([2037, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.305389404296875  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.305389404296875  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 2037, 256]), torch.Size([1, 2037, 256])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.3100242614746094  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.3441715240478516  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 2037, 256])
m.shape torch.Size([1748, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.3452143669128418  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.3452143669128418  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 1748, 256]), torch.Size([1, 1748, 256])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.349360466003418  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.4043502807617188  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 1748, 256])
m.shape torch.Size([1355, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.405940055847168  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.405940055847168  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 1355, 256]), torch.Size([1, 1355, 256])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.408717155456543  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.4720473289489746  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 1355, 256])
m.shape torch.Size([1064, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.4748458862304688  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.4748458862304688  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 1064, 256]), torch.Size([1, 1064, 256])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.4768962860107422  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.5364751815795898  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 1064, 256])
m.shape torch.Size([940, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.5398101806640625  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.5398101806640625  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 940, 256]), torch.Size([1, 940, 256])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.5416030883789062  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.6061477661132812  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 940, 256])
m.shape torch.Size([644, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.6089653968811035  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.6089653968811035  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 644, 256]), torch.Size([1, 644, 256])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.6101937294006348  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.6662983894348145  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 644, 256])
m.shape torch.Size([504, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.6690754890441895  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.6690754890441895  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 504, 256]), torch.Size([1, 504, 256])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.670036792755127  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.7215962409973145  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 504, 256])
m.shape torch.Size([435, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.7244606018066406  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.7244606018066406  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 435, 256]), torch.Size([1, 435, 256])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.725290298461914  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.7725830078125  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 435, 256])
m.shape torch.Size([353, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.775221824645996  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.775221824645996  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 353, 256]), torch.Size([1, 353, 256])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.775895118713379  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.8201065063476562  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 353, 256])
m.shape torch.Size([318, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.8228263854980469  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.8228263854980469  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.8234329223632812  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.8672218322753906  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([228, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.8693294525146484  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.8693294525146484  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.8697643280029297  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.9036846160888672  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([196, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.9057278633117676  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.9057278633117676  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.9061017036437988  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.937878131866455  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([195, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.9401278495788574  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.9401278495788574  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.9404997825622559  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.974717617034912  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([152, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.9765772819519043  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.9765772819519043  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 1.9768671989440918  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.0055689811706543  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([128, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.0072693824768066  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.0072693824768066  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.0075135231018066  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.0333924293518066  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([99, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.034834861755371  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.034834861755371  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.0350236892700195  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.056361198425293  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([92, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.057770252227783  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.057770252227783  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.057945728302002  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.079002857208252  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([80, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.0802993774414062  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.0802993774414062  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.0804519653320312  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.0998306274414062  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([65, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.1009464263916016  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.1009464263916016  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.1010704040527344  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.1176834106445312  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([61, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.1187944412231445  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.1187944412231445  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.118910789489746  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.1353158950805664  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([42, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.136105537414551  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.136105537414551  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.136185646057129  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.1480417251586914  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([33, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.1486997604370117  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.1486997604370117  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.1487627029418945  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.1585187911987305  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([37, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.1593055725097656  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.1593055725097656  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.1593761444091797  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.170808792114258  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([35, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.171581268310547  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.171581268310547  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.1716480255126953  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.1829299926757812  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([404, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.1926040649414062  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.1926040649414062  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.1933746337890625  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.3296470642089844  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 404, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.274200439453125  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.276336669921875  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.278654098510742  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.2764339447021484  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

torch.Size([11245, 40])
input nodes number: 25847
output nodes number: 11245
edges number: 67668
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.2769775390625  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 2.276978015899658  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.0373988151550293  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

pseudo mini batch 6 input nodes size: 68615
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.032590389251708984  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.032590389251708984  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.06579351425170898  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.06587839126586914  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.04097795486450195  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.0444951057434082  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.0444951057434082  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.0444951057434082  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

torch.Size([68615, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 0.0444951057434082  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

m.shape torch.Size([1997, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 0.21079492568969727  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 0.21079492568969727  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 1997, 128]), torch.Size([1, 1997, 128])
----------------------------------------3
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 0.21269941329956055  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 0.2279353141784668  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 1997, 128])
m.shape torch.Size([2045, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 0.22893333435058594  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 0.22893333435058594  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 2045, 128]), torch.Size([1, 2045, 128])
----------------------------------------3
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 0.23088359832763672  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 0.26033782958984375  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 2045, 128])
m.shape torch.Size([1950, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 0.26215219497680664  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 0.26215219497680664  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 1950, 128]), torch.Size([1, 1950, 128])
----------------------------------------3
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 0.26401185989379883  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 0.30492448806762695  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 1950, 128])
m.shape torch.Size([1713, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 0.30726194381713867  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 0.30726194381713867  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 1713, 128]), torch.Size([1, 1713, 128])
----------------------------------------3
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 0.3088955879211426  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 0.3580794334411621  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 1713, 128])
m.shape torch.Size([1623, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 0.3611321449279785  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 0.3611321449279785  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 1623, 128]), torch.Size([1, 1623, 128])
----------------------------------------3
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 0.36267995834350586  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 0.4187450408935547  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 1623, 128])
m.shape torch.Size([1536, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 0.422365665435791  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 0.422365665435791  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 1536, 128]), torch.Size([1, 1536, 128])
----------------------------------------3
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 0.423830509185791  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 0.4872927665710449  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 1536, 128])
m.shape torch.Size([1503, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 0.4915771484375  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 0.4915771484375  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 1503, 128]), torch.Size([1, 1503, 128])
----------------------------------------3
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 0.4930105209350586  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 0.5647339820861816  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 1503, 128])
m.shape torch.Size([1406, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 0.5693807601928711  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 0.5693807601928711  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 1406, 128]), torch.Size([1, 1406, 128])
----------------------------------------3
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 0.5707216262817383  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 0.6486692428588867  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 1406, 128])
m.shape torch.Size([1335, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 0.6537280082702637  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 0.6537280082702637  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 1335, 128]), torch.Size([1, 1335, 128])
----------------------------------------3
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 0.655001163482666  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 0.7373776435852051  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 1335, 128])
m.shape torch.Size([26707, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.5467529296875 GB
    Memory Allocated: 0.8640899658203125  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5467529296875 GB
    Memory Allocated: 0.8640899658203125  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 26707, 128]), torch.Size([1, 26707, 128])
----------------------------------------3
 Nvidia-smi: 5.5467529296875 GB
    Memory Allocated: 0.8895597457885742  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4666748046875 GB
    Memory Allocated: 2.6979141235351562  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 26707, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.4666748046875 GB
    Memory Allocated: 2.5436525344848633  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.4666748046875 GB
    Memory Allocated: 2.5835304260253906  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.4666748046875 GB
    Memory Allocated: 2.623408317565918  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.4666748046875 GB
    Memory Allocated: 2.583218574523926  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

torch.Size([41815, 256])
first layer input nodes number: 68615
first layer output nodes number: 41815
edges number: 336974
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.4666748046875 GB
    Memory Allocated: 2.6239218711853027  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.4666748046875 GB
    Memory Allocated: 2.66379976272583  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.4666748046875 GB
    Memory Allocated: 2.673769474029541  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.4666748046875 GB
    Memory Allocated: 2.673769474029541  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

m.shape torch.Size([1252, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 2.805424690246582  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 2.805424690246582  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 1252, 256]), torch.Size([1, 1252, 256])
----------------------------------------3
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 2.8080034255981445  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 2.8285927772521973  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 1252, 256])
m.shape torch.Size([1036, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 2.8290672302246094  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 2.8290672302246094  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 1036, 256]), torch.Size([1, 1036, 256])
----------------------------------------3
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 2.8316831588745117  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 2.8662171363830566  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 1036, 256])
m.shape torch.Size([865, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 2.866976737976074  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 2.866976737976074  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 865, 256]), torch.Size([1, 865, 256])
----------------------------------------3
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 2.868626594543457  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 2.9057111740112305  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 865, 256])
m.shape torch.Size([671, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 2.9077506065368652  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 2.9077506065368652  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 671, 256]), torch.Size([1, 671, 256])
----------------------------------------3
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 2.9090304374694824  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 2.948221206665039  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 671, 256])
m.shape torch.Size([582, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 2.95037841796875  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 2.95037841796875  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 582, 256]), torch.Size([1, 582, 256])
----------------------------------------3
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 2.951488494873047  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 2.992582321166992  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 582, 256])
m.shape torch.Size([453, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 2.9946398735046387  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 2.9946398735046387  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 453, 256]), torch.Size([1, 453, 256])
----------------------------------------3
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 2.9955039024353027  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.0343127250671387  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 453, 256])
m.shape torch.Size([399, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.0365653038024902  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.0365653038024902  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 399, 256]), torch.Size([1, 399, 256])
----------------------------------------3
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.0373263359069824  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.0803189277648926  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 399, 256])
m.shape torch.Size([319, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.0823912620544434  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.0823912620544434  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.0829997062683105  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.118345260620117  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([309, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.1207141876220703  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.1207141876220703  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.1213035583496094  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.1593236923217773  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 309, 256])
m.shape torch.Size([281, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.1617298126220703  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.1617298126220703  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.1622657775878906  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.2018699645996094  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([261, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.2043614387512207  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.2043614387512207  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.2048592567443848  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.245093822479248  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([260, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.2478437423706055  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.2478437423706055  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

 h.shape torch.Size([1, 260, 256]), torch.Size([1, 260, 256])
----------------------------------------3
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.2483396530151367  GigaBytes
Max Memory Allocated: 3.283677577972412  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.291815757751465  GigaBytes
Max Memory Allocated: 3.2947912216186523  GigaBytes

rst.shape  torch.Size([1, 260, 256])
m.shape torch.Size([223, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.2943544387817383  GigaBytes
Max Memory Allocated: 3.2947912216186523  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.2943544387817383  GigaBytes
Max Memory Allocated: 3.2947912216186523  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.2947797775268555  GigaBytes
Max Memory Allocated: 3.2947912216186523  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.3339109420776367  GigaBytes
Max Memory Allocated: 3.3367919921875  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([185, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.3365988731384277  GigaBytes
Max Memory Allocated: 3.3367919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.3365988731384277  GigaBytes
Max Memory Allocated: 3.3367919921875  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.336951732635498  GigaBytes
Max Memory Allocated: 3.336951732635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.371884822845459  GigaBytes
Max Memory Allocated: 3.374354839324951  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([179, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.374289035797119  GigaBytes
Max Memory Allocated: 3.374354839324951  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.374289035797119  GigaBytes
Max Memory Allocated: 3.374354839324951  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.3746304512023926  GigaBytes
Max Memory Allocated: 3.3746304512023926  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.410820484161377  GigaBytes
Max Memory Allocated: 3.4133810997009277  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([167, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.4132180213928223  GigaBytes
Max Memory Allocated: 3.4133810997009277  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.4132180213928223  GigaBytes
Max Memory Allocated: 3.4133810997009277  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.413536548614502  GigaBytes
Max Memory Allocated: 3.413536548614502  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.4495301246643066  GigaBytes
Max Memory Allocated: 3.452078342437744  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([158, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.4519524574279785  GigaBytes
Max Memory Allocated: 3.452078342437744  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.4519524574279785  GigaBytes
Max Memory Allocated: 3.452078342437744  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.452253818511963  GigaBytes
Max Memory Allocated: 3.452253818511963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.488417148590088  GigaBytes
Max Memory Allocated: 3.490978717803955  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([168, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.491173267364502  GigaBytes
Max Memory Allocated: 3.491184711456299  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.491173267364502  GigaBytes
Max Memory Allocated: 3.491184711456299  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.4914937019348145  GigaBytes
Max Memory Allocated: 3.4914937019348145  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.532188892364502  GigaBytes
Max Memory Allocated: 3.5350728034973145  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([153, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.534822940826416  GigaBytes
Max Memory Allocated: 3.5350728034973145  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.534822940826416  GigaBytes
Max Memory Allocated: 3.5350728034973145  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.5351147651672363  GigaBytes
Max Memory Allocated: 3.5351147651672363  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.574219226837158  GigaBytes
Max Memory Allocated: 3.576991558074951  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([135, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.5766687393188477  GigaBytes
Max Memory Allocated: 3.576991558074951  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.5766687393188477  GigaBytes
Max Memory Allocated: 3.576991558074951  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.5769262313842773  GigaBytes
Max Memory Allocated: 3.576991558074951  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.6132326126098633  GigaBytes
Max Memory Allocated: 3.61580753326416  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([147, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.6167569160461426  GigaBytes
Max Memory Allocated: 3.6167688369750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.6167569160461426  GigaBytes
Max Memory Allocated: 3.6167688369750977  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.617037296295166  GigaBytes
Max Memory Allocated: 3.617037296295166  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.6585335731506348  GigaBytes
Max Memory Allocated: 3.661477565765381  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([91, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.660317897796631  GigaBytes
Max Memory Allocated: 3.661477565765381  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.660317897796631  GigaBytes
Max Memory Allocated: 3.661477565765381  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.660491466522217  GigaBytes
Max Memory Allocated: 3.661477565765381  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.687394618988037  GigaBytes
Max Memory Allocated: 3.6893038749694824  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([117, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.689894676208496  GigaBytes
Max Memory Allocated: 3.6899051666259766  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.689894676208496  GigaBytes
Max Memory Allocated: 3.6899051666259766  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.690117835998535  GigaBytes
Max Memory Allocated: 3.690117835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.7262697219848633  GigaBytes
Max Memory Allocated: 3.7288360595703125  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([110, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.728695869445801  GigaBytes
Max Memory Allocated: 3.7288360595703125  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.728695869445801  GigaBytes
Max Memory Allocated: 3.7288360595703125  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.72890567779541  GigaBytes
Max Memory Allocated: 3.72890567779541  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.7643632888793945  GigaBytes
Max Memory Allocated: 3.766880989074707  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([2848, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.832690715789795  GigaBytes
Max Memory Allocated: 3.832956314086914  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.832690715789795  GigaBytes
Max Memory Allocated: 3.832956314086914  GigaBytes

 h.shape torch.Size([1, 2848, 256]), torch.Size([1, 2848, 256])
----------------------------------------3
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 3.838122844696045  GigaBytes
Max Memory Allocated: 3.838122844696045  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6639404296875 GB
    Memory Allocated: 4.8071112632751465  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

rst.shape  torch.Size([1, 2848, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.6639404296875 GB
    Memory Allocated: 4.68505334854126  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.6639404296875 GB
    Memory Allocated: 4.686848163604736  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.6639404296875 GB
    Memory Allocated: 4.688826084136963  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.6639404296875 GB
    Memory Allocated: 4.686946392059326  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

torch.Size([11369, 40])
input nodes number: 41815
output nodes number: 11369
edges number: 134941
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6639404296875 GB
    Memory Allocated: 4.687001705169678  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.6639404296875 GB
    Memory Allocated: 4.687002182006836  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.7947998046875 GB
    Memory Allocated: 0.0508427619934082  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

pseudo mini batch 7 input nodes size: 86527
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.7947998046875 GB
    Memory Allocated: 0.040636539459228516  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.7947998046875 GB
    Memory Allocated: 0.040636539459228516  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.7947998046875 GB
    Memory Allocated: 0.08189582824707031  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.7947998046875 GB
    Memory Allocated: 0.08197832107543945  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.7947998046875 GB
    Memory Allocated: 0.0486903190612793  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.7947998046875 GB
    Memory Allocated: 0.05242776870727539  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.7947998046875 GB
    Memory Allocated: 0.05242776870727539  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.7947998046875 GB
    Memory Allocated: 0.05242776870727539  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

torch.Size([86527, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.7947998046875 GB
    Memory Allocated: 0.05242776870727539  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

m.shape torch.Size([2405, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 0.2438502311706543  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 0.2438502311706543  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

 h.shape torch.Size([1, 2405, 128]), torch.Size([1, 2405, 128])
----------------------------------------3
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 0.24660062789916992  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 0.265200138092041  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

rst.shape  torch.Size([1, 2405, 128])
m.shape torch.Size([2664, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 0.26659393310546875  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 0.26659393310546875  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

 h.shape torch.Size([1, 2664, 128]), torch.Size([1, 2664, 128])
----------------------------------------3
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 0.269134521484375  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 0.310150146484375  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

rst.shape  torch.Size([1, 2664, 128])
m.shape torch.Size([2443, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 0.31140565872192383  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 0.31140565872192383  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

 h.shape torch.Size([1, 2443, 128]), torch.Size([1, 2443, 128])
----------------------------------------3
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 0.3137354850769043  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 0.367459774017334  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

rst.shape  torch.Size([1, 2443, 128])
m.shape torch.Size([2199, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 0.3706474304199219  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 0.3706474304199219  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

 h.shape torch.Size([1, 2199, 128]), torch.Size([1, 2199, 128])
----------------------------------------3
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 0.37287235260009766  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 0.4341259002685547  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

rst.shape  torch.Size([1, 2199, 128])
m.shape torch.Size([2119, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 0.43808889389038086  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 0.43808889389038086  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

 h.shape torch.Size([1, 2119, 128]), torch.Size([1, 2119, 128])
----------------------------------------3
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 0.4402012825012207  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 0.5161318778991699  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

rst.shape  torch.Size([1, 2119, 128])
m.shape torch.Size([1996, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 0.5208320617675781  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 0.5208320617675781  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

 h.shape torch.Size([1, 1996, 128]), torch.Size([1, 1996, 128])
----------------------------------------3
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 0.522735595703125  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 0.6058273315429688  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

rst.shape  torch.Size([1, 1996, 128])
m.shape torch.Size([1887, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 0.6111741065979004  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 0.6111741065979004  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

 h.shape torch.Size([1, 1887, 128]), torch.Size([1, 1887, 128])
----------------------------------------3
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 0.612973690032959  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 0.7029528617858887  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

rst.shape  torch.Size([1, 1887, 128])
m.shape torch.Size([1743, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 0.7087020874023438  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 0.7087020874023438  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

 h.shape torch.Size([1, 1743, 128]), torch.Size([1, 1743, 128])
----------------------------------------3
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 0.7103643417358398  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 0.8051128387451172  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

rst.shape  torch.Size([1, 1743, 128])
m.shape torch.Size([1704, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 0.8115944862365723  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 0.8115944862365723  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

 h.shape torch.Size([1, 1704, 128]), torch.Size([1, 1704, 128])
----------------------------------------3
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 0.8132195472717285  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 0.9173455238342285  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

rst.shape  torch.Size([1, 1704, 128])
m.shape torch.Size([29913, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 1.0591692924499512  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 1.0591692924499512  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

 h.shape torch.Size([1, 29913, 128]), torch.Size([1, 29913, 128])
----------------------------------------3
 Nvidia-smi: 6.9803466796875 GB
    Memory Allocated: 1.0876965522766113  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.1152663230895996  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

rst.shape  torch.Size([1, 29913, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 2.9365386962890625  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 2.9833383560180664  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.0301380157470703  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 2.9829726219177246  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

torch.Size([49073, 256])
first layer input nodes number: 86527
first layer output nodes number: 49073
edges number: 388048
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.0307846069335938  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.0775842666625977  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.0892844200134277  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.0892844200134277  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

m.shape torch.Size([1445, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.200357437133789  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.200357437133789  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

 h.shape torch.Size([1, 1445, 256]), torch.Size([1, 1445, 256])
----------------------------------------3
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.203428268432617  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.227389335632324  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

rst.shape  torch.Size([1, 1445, 256])
m.shape torch.Size([1275, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.228337287902832  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.228337287902832  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

 h.shape torch.Size([1, 1275, 256]), torch.Size([1, 1275, 256])
----------------------------------------3
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.231146812438965  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.2725234031677246  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

rst.shape  torch.Size([1, 1275, 256])
m.shape torch.Size([948, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.2736434936523438  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.2736434936523438  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

 h.shape torch.Size([1, 948, 256]), torch.Size([1, 948, 256])
----------------------------------------3
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.27545166015625  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.3152313232421875  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

rst.shape  torch.Size([1, 948, 256])
m.shape torch.Size([715, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.3172574043273926  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.3172574043273926  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

 h.shape torch.Size([1, 715, 256]), torch.Size([1, 715, 256])
----------------------------------------3
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.3186211585998535  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.3587136268615723  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

rst.shape  torch.Size([1, 715, 256])
m.shape torch.Size([627, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.3610448837280273  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.3610448837280273  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

 h.shape torch.Size([1, 627, 256]), torch.Size([1, 627, 256])
----------------------------------------3
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.362240791320801  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.407243251800537  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

rst.shape  torch.Size([1, 627, 256])
m.shape torch.Size([513, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.409604072570801  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.409604072570801  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

 h.shape torch.Size([1, 513, 256]), torch.Size([1, 513, 256])
----------------------------------------3
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.4105825424194336  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.454874038696289  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

rst.shape  torch.Size([1, 513, 256])
m.shape torch.Size([388, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.4569954872131348  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.4569954872131348  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

 h.shape torch.Size([1, 388, 256]), torch.Size([1, 388, 256])
----------------------------------------3
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.457735538482666  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.497025489807129  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

rst.shape  torch.Size([1, 388, 256])
m.shape torch.Size([327, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.4991698265075684  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.4991698265075684  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

 h.shape torch.Size([1, 327, 256]), torch.Size([1, 327, 256])
----------------------------------------3
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.499793529510498  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.5361647605895996  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

rst.shape  torch.Size([1, 327, 256])
m.shape torch.Size([335, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.5387511253356934  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.5387511253356934  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

 h.shape torch.Size([1, 335, 256]), torch.Size([1, 335, 256])
----------------------------------------3
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.5393900871276855  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.580933094024658  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

rst.shape  torch.Size([1, 335, 256])
m.shape torch.Size([287, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.583372116088867  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.583372116088867  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.5839195251464844  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.6242270469665527  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([246, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.626554489135742  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.626554489135742  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.627023696899414  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.6636219024658203  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([223, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.665959358215332  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.665959358215332  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.666384696960449  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.70253849029541  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([194, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.7047500610351562  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.7047500610351562  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.705120086669922  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.7391624450683594  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([166, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.741211414337158  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.741211414337158  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.741528034210205  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.7728734016418457  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([174, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.775223731994629  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.775223731994629  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.7755556106567383  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.810734748840332  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([162, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.8130602836608887  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.8130602836608887  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.8133692741394043  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.84828519821167  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([129, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.850238800048828  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.850238800048828  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.850484848022461  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.8800106048583984  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([140, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.882309913635254  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.882309913635254  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.8825769424438477  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.916489601135254  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([124, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.9186205863952637  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.9186205863952637  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.9188570976257324  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.950549602508545  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([117, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.9526805877685547  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.9526805877685547  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.9529037475585938  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.9843692779541016  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([113, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.986538887023926  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.986538887023926  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 3.9867544174194336  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 4.01865291595459  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([95, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 4.020554065704346  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 4.020554065704346  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 4.020735263824463  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 4.048820972442627  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([70, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 4.050278186798096  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 4.050278186798096  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 4.050411701202393  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 4.072041034698486  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([83, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 4.073889255523682  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 4.073889255523682  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 4.074047565460205  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 4.100801944732666  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([2139, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 4.152119159698486  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 4.152119159698486  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

 h.shape torch.Size([1, 2139, 256]), torch.Size([1, 2139, 256])
----------------------------------------3
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 4.1570258140563965  GigaBytes
Max Memory Allocated: 4.8754706382751465  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 4.878474712371826  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 2139, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 4.776865005493164  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 4.77860164642334  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 4.780641555786133  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 4.778822422027588  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

torch.Size([11035, 40])
input nodes number: 49073
output nodes number: 11035
edges number: 113508
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 4.779212474822998  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 4.779212951660156  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.05881929397583008  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.06436967849731445  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.06436967849731445  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.018568575382232666 |0.043762385845184326 |0.190984308719635 |0.00010645389556884766 |0.0972633957862854 |0.0070722103118896484 |
----------------------------------------------------------pseudo_mini_loss sum 5.326735496520996
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  670837
Number of first layer input nodes during this epoch:  431046
Number of first layer output nodes during this epoch:  239791
----------------------------------------before generate dataloader block 
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.06436920166015625  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes
[05:09:34] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 21719692 edges into 8 parts and get 3318123 edge cuts

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.022716045379638672
global_2_local spend time (sec) 0.04947328567504883
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004124879837036133
A = g.adjacency_matrix() spent  0.008921384811401367
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08259987831115723
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.3143947124481201
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1685945987701416

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 11701738, 2.0: 2017886, 3.0: 504377, 4.0: 152112, 5.0: 55817, 6.0: 23824, 7.0: 11409, 8.0: 5685, 9.0: 3070, 10.0: 1700, 11.0: 1036, 12.0: 534, 13.0: 336, 14.0: 225, 15.0: 120, 16.0: 118, 17.0: 96, 18.0: 53, 19.0: 34, 20.0: 8, 21.0: 6})
Convert a graph into a bidirected graph: 0.797 seconds
Metis partitioning: 4.342 seconds
Split the graph: 1.073 seconds
Construct subgraphs: 0.059 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  6.282863140106201
11656
11592
11549
11186
11038
11709
11145
11066
total k batches seeds list generation spend  19.771905422210693
after graph partition
graph partition algorithm spend time 19.94333839416504
11656
11592
11549
11186
11038
11709
11145
11066
partition_len_list
[26000, 20632, 21243, 19085, 46661, 43026, 25522, 33646]
shared_neighbor_graph_partition_s0 selection method  spend 20.046799182891846
time for parepare:  0.01776266098022461
local_output_nid generation:  0.0024080276489257812
local_in_edges_tensor generation:  0.0024111270904541016
mini_batch_src_global generation:  0.0037508010864257812
r_  generation:  0.03483772277832031
local_output_nid generation:  0.0032889842987060547
local_in_edges_tensor generation:  0.003668069839477539
mini_batch_src_global generation:  0.0038666725158691406
r_  generation:  0.02810955047607422
local_output_nid generation:  0.0033054351806640625
local_in_edges_tensor generation:  0.0025370121002197266
mini_batch_src_global generation:  0.003677845001220703
r_  generation:  0.03472471237182617
local_output_nid generation:  0.0033729076385498047
local_in_edges_tensor generation:  0.0032622814178466797
mini_batch_src_global generation:  0.003813028335571289
r_  generation:  0.032256126403808594
local_output_nid generation:  0.0031883716583251953
local_in_edges_tensor generation:  0.004338979721069336
mini_batch_src_global generation:  0.005479097366333008
r_  generation:  0.0402216911315918
local_output_nid generation:  0.0034117698669433594
local_in_edges_tensor generation:  0.0039479732513427734
mini_batch_src_global generation:  0.007004976272583008
r_  generation:  0.05414700508117676
local_output_nid generation:  0.004503488540649414
local_in_edges_tensor generation:  0.0024399757385253906
mini_batch_src_global generation:  0.0037078857421875
r_  generation:  0.029115676879882812
local_output_nid generation:  0.0032529830932617188
local_in_edges_tensor generation:  0.0022368431091308594
mini_batch_src_global generation:  0.0031557083129882812
r_  generation:  0.03091263771057129
----------------------check_connections_block total spend ----------------------------- 0.46612000465393066
generate_one_block  0.05182695388793945
generate_one_block  0.03535795211791992
generate_one_block  0.04037976264953613
generate_one_block  0.03870582580566406
generate_one_block  0.05473804473876953
generate_one_block  0.06856632232666016
generate_one_block  0.0328516960144043
generate_one_block  0.05683112144470215
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04165530204772949
gen group dst list time:  0.006577491760253906
time for parepare:  0.022207260131835938
local_output_nid generation:  0.004697322845458984
local_in_edges_tensor generation:  0.010907411575317383
mini_batch_src_global generation:  0.005767822265625
r_  generation:  0.05983090400695801
local_output_nid generation:  0.005365133285522461
local_in_edges_tensor generation:  0.004113674163818359
mini_batch_src_global generation:  0.004691600799560547
r_  generation:  0.04043698310852051
local_output_nid generation:  0.005218982696533203
local_in_edges_tensor generation:  0.0039463043212890625
mini_batch_src_global generation:  0.0036656856536865234
r_  generation:  0.04565787315368652
local_output_nid generation:  0.004797220230102539
local_in_edges_tensor generation:  0.004157543182373047
mini_batch_src_global generation:  0.0040128231048583984
r_  generation:  0.04246068000793457
local_output_nid generation:  0.010696172714233398
local_in_edges_tensor generation:  0.013077974319458008
mini_batch_src_global generation:  0.015183448791503906
r_  generation:  0.12694787979125977
local_output_nid generation:  0.009343385696411133
local_in_edges_tensor generation:  0.012166976928710938
mini_batch_src_global generation:  0.013958454132080078
r_  generation:  0.12146115303039551
local_output_nid generation:  0.006751537322998047
local_in_edges_tensor generation:  0.005463361740112305
mini_batch_src_global generation:  0.007632017135620117
r_  generation:  0.05908536911010742
local_output_nid generation:  0.008254051208496094
local_in_edges_tensor generation:  0.006800651550292969
mini_batch_src_global generation:  0.008951425552368164
r_  generation:  0.08547711372375488
----------------------check_connections_block total spend ----------------------------- 0.9251120090484619
generate_one_block  0.08138847351074219
generate_one_block  0.05066537857055664
generate_one_block  0.05860400199890137
generate_one_block  0.06992959976196289
generate_one_block  0.17368435859680176
generate_one_block  0.17010998725891113
generate_one_block  0.07316470146179199
generate_one_block  0.11249613761901855
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.06436920166015625  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

connection checking time:  0.9251120090484619
block generation total time  0.7900426387786865
average batch blocks generation time:  0.09875532984733582
block dataloader generation time/epoch 22.804931163787842
pseudo mini batch 0 input nodes size: 51173
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.054181575775146484  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.054181575775146484  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.078582763671875  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.07867002487182617  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.037328243255615234  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.03930330276489258  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.03930330276489258  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.03930330276489258  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

torch.Size([51173, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.03930330276489258  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

m.shape torch.Size([2307, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.12357521057128906  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.12357521057128906  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 2307, 128]), torch.Size([1, 2307, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.12577533721923828  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.14434289932250977  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 2307, 128])
m.shape torch.Size([2488, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.1456155776977539  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.1456155776977539  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 2488, 128]), torch.Size([1, 2488, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.14798831939697266  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.18431520462036133  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 2488, 128])
m.shape torch.Size([2242, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.18633604049682617  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.18633604049682617  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 2242, 128]), torch.Size([1, 2242, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.18859148025512695  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.23915529251098633  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 2242, 128])
m.shape torch.Size([1954, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.24236249923706055  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.24236249923706055  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1954, 128]), torch.Size([1, 1954, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.24422597885131836  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.2982668876647949  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1954, 128])
m.shape torch.Size([1793, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.30160999298095703  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.30160999298095703  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1793, 128]), torch.Size([1, 1793, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.30331993103027344  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.36487770080566406  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1793, 128])
m.shape torch.Size([1498, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.36830854415893555  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.36830854415893555  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1498, 128]), torch.Size([1, 1498, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.3697371482849121  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.4347567558288574  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1498, 128])
m.shape torch.Size([1331, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.43848514556884766  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.43848514556884766  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1331, 128]), torch.Size([1, 1331, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.4397544860839844  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.5045905113220215  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1331, 128])
m.shape torch.Size([1291, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.508880615234375  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.508880615234375  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1291, 128]), torch.Size([1, 1291, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.5101118087768555  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.5803756713867188  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1291, 128])
m.shape torch.Size([1052, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.5842747688293457  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.5842747688293457  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1052, 128]), torch.Size([1, 1052, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.5852780342102051  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.6511263847351074  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1052, 128])
m.shape torch.Size([10044, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.6985182762145996  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.6985182762145996  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 10044, 128]), torch.Size([1, 10044, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.708096981048584  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.4013209342956543  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 10044, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.3272671699523926  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.352062702178955  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.3768582344055176  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.3518686294555664  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

torch.Size([26000, 256])
first layer input nodes number: 51173
first layer output nodes number: 26000
edges number: 169331
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.377241611480713  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.4020371437072754  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.408491611480713  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.408491611480713  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

m.shape torch.Size([1573, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.5026297569274902  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.5026297569274902  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1573, 256]), torch.Size([1, 1573, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.5066866874694824  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.531752109527588  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1573, 256])
m.shape torch.Size([1418, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.5329780578613281  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.5329780578613281  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1418, 256]), torch.Size([1, 1418, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.5359230041503906  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.5774860382080078  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1418, 256])
m.shape torch.Size([1114, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.5793461799621582  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.5793461799621582  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1114, 256]), torch.Size([1, 1114, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.5815215110778809  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.629321575164795  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1114, 256])
m.shape torch.Size([934, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.6314420700073242  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.6314420700073242  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 934, 256]), torch.Size([1, 934, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.633223533630371  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.6848859786987305  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 934, 256])
m.shape torch.Size([828, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.687974452972412  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.687974452972412  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 828, 256]), torch.Size([1, 828, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.6895537376403809  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.7475676536560059  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 828, 256])
m.shape torch.Size([632, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.7504229545593262  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.7504229545593262  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 632, 256]), torch.Size([1, 632, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.7516283988952637  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.804704189300537  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 632, 256])
m.shape torch.Size([548, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.807788372039795  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.807788372039795  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 548, 256]), torch.Size([1, 548, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.8088335990905762  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.8625292778015137  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 548, 256])
m.shape torch.Size([551, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.8662433624267578  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.8662433624267578  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 551, 256]), torch.Size([1, 551, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.8672943115234375  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.9290752410888672  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 551, 256])
m.shape torch.Size([411, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.9321050643920898  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.9321050643920898  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 411, 256]), torch.Size([1, 411, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.9328889846801758  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.9848003387451172  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 411, 256])
m.shape torch.Size([379, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.988051414489746  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.988051414489746  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.988774299621582  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.041611671447754  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([301, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.044902801513672  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.044902801513672  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.0454769134521484  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.0907115936279297  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 301, 256])
m.shape torch.Size([291, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.093906879425049  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.093906879425049  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.0944619178771973  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.1429600715637207  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 291, 256])
m.shape torch.Size([251, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.1458187103271484  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.1458187103271484  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.1462974548339844  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.1903419494628906  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 251, 256])
m.shape torch.Size([224, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.1931166648864746  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.1931166648864746  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.1935439109802246  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.2358412742614746  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([209, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.238640785217285  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.238640785217285  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.239039421081543  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.281294822692871  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([154, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.283463954925537  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.283463954925537  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.2837576866149902  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.3169493675231934  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([163, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.3194661140441895  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.3194661140441895  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.319777011871338  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.3570847511291504  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([128, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.3591437339782715  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.3591437339782715  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.3593878746032715  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.3903937339782715  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([108, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.392244338989258  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.392244338989258  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.3924503326416016  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.420053482055664  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([106, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.4219884872436523  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.4219884872436523  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.4221906661987305  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.450697898864746  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([93, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.4524741172790527  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.4524741172790527  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.4526515007019043  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.4789042472839355  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([102, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.4809727668762207  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.4809727668762207  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.4811673164367676  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.511322498321533  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([73, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.5128393173217773  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.5128393173217773  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.5129785537719727  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.5355348587036133  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([70, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.5370802879333496  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.5370802879333496  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.5372138023376465  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.5597777366638184  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([995, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.5836191177368164  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.5836191177368164  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 995, 256]), torch.Size([1, 995, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.585516929626465  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.91953182220459  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 995, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.838108539581299  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.8399977684020996  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.8427062034606934  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.8407297134399414  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

torch.Size([11656, 40])
input nodes number: 26000
output nodes number: 11656
edges number: 95631
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.8411636352539062  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.8411645889282227  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.04324054718017578  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

pseudo mini batch 1 input nodes size: 31904
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.03748178482055664  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.03748178482055664  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.05310678482055664  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.05319356918334961  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.028705120086669922  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.030042171478271484  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.030042171478271484  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.030042171478271484  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

torch.Size([31904, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.030042171478271484  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

m.shape torch.Size([2808, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.08458328247070312  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.08458328247070312  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 2808, 128]), torch.Size([1, 2808, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.08726119995117188  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.10868453979492188  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 2808, 128])
m.shape torch.Size([2900, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.11011123657226562  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.11011123657226562  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 2900, 128]), torch.Size([1, 2900, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.11287689208984375  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.15436172485351562  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 2900, 128])
m.shape torch.Size([2463, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.15650224685668945  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.15650224685668945  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 2463, 128]), torch.Size([1, 2463, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.15895509719848633  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.21178388595581055  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 2463, 128])
m.shape torch.Size([2072, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.21444988250732422  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.21444988250732422  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 2072, 128]), torch.Size([1, 2072, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.21646404266357422  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.2777886390686035  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 2072, 128])
m.shape torch.Size([1702, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.281740665435791  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.281740665435791  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1702, 128]), torch.Size([1, 1702, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.28336381912231445  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.3444027900695801  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1702, 128])
m.shape torch.Size([1341, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.3474278450012207  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.3474278450012207  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1341, 128]), torch.Size([1, 1341, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.3487067222595215  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.407132625579834  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1341, 128])
m.shape torch.Size([1134, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.4102783203125  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.4102783203125  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1134, 128]), torch.Size([1, 1134, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.4113597869873047  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.46600818634033203  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1134, 128])
m.shape torch.Size([929, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.4690113067626953  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.4690113067626953  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 929, 128]), torch.Size([1, 929, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.4698972702026367  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.5204372406005859  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 929, 128])
m.shape torch.Size([790, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.5233845710754395  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.5233845710754395  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 790, 128]), torch.Size([1, 790, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.5241379737854004  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.5723557472229004  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 790, 128])
m.shape torch.Size([4493, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.5934634208679199  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.5934634208679199  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 4493, 128]), torch.Size([1, 4493, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.5977482795715332  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.9059634208679199  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 4493, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.8613996505737305  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.8810758590698242  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.900752067565918  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.8809218406677246  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

torch.Size([20632, 256])
first layer input nodes number: 31904
first layer output nodes number: 20632
edges number: 108251
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.9009919166564941  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.9206681251525879  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.9255871772766113  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.9255871772766113  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

m.shape torch.Size([1926, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.9967799186706543  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.9967799186706543  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1926, 256]), torch.Size([1, 1926, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.0013141632080078  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.0317649841308594  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1926, 256])
m.shape torch.Size([1734, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.033627986907959  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.033627986907959  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1734, 256]), torch.Size([1, 1734, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.0378899574279785  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.0875000953674316  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1734, 256])
m.shape torch.Size([1411, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.0905265808105469  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.0905265808105469  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1411, 256]), torch.Size([1, 1411, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.0933303833007812  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.1540498733520508  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1411, 256])
m.shape torch.Size([1087, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.1561908721923828  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.1561908721923828  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1087, 256]), torch.Size([1, 1087, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.15846586227417  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.2218127250671387  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1087, 256])
m.shape torch.Size([915, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.2251734733581543  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.2251734733581543  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 915, 256]), torch.Size([1, 915, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.2269186973571777  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.290297031402588  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 915, 256])
m.shape torch.Size([681, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.293351650238037  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.293351650238037  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 681, 256]), torch.Size([1, 681, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.2946505546569824  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.352149486541748  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 681, 256])
m.shape torch.Size([611, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.3556108474731445  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.3556108474731445  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 611, 256]), torch.Size([1, 611, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.356776237487793  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.4159307479858398  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 611, 256])
m.shape torch.Size([489, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.4191083908081055  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.4191083908081055  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 489, 256]), torch.Size([1, 489, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.4200410842895508  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.475386619567871  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 489, 256])
m.shape torch.Size([421, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.478562355041504  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.478562355041504  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 421, 256]), torch.Size([1, 421, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.479365348815918  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.5317020416259766  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 421, 256])
m.shape torch.Size([348, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.5346455574035645  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.5346455574035645  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 348, 256]), torch.Size([1, 348, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.5353093147277832  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.5840144157409668  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 348, 256])
m.shape torch.Size([278, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.5866217613220215  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.5866217613220215  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.5871520042419434  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.6299052238464355  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([236, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.6323623657226562  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.6323623657226562  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.6328125  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.6710739135742188  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([203, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.6733856201171875  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.6733856201171875  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.6737728118896484  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.7093944549560547  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([161, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.7113676071166992  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.7113676071166992  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.711674690246582  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.7420759201049805  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([149, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.7440705299377441  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.7440705299377441  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.7443547248840332  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.7744793891906738  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([117, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.7763352394104004  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.7763352394104004  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.7765583992004395  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.8017754554748535  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([101, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.803314208984375  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.803314208984375  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.803506851196289  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.8266239166259766  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([84, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.8279809951782227  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.8279809951782227  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.828141212463379  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.8484888076782227  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([72, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.8497238159179688  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.8497238159179688  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.8498611450195312  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.8682632446289062  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([55, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.8692522048950195  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.8692522048950195  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.8693571090698242  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.8841485977172852  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([50, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.8851056098937988  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.8851056098937988  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.8852009773254395  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.899315357208252  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([47, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.900263786315918  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.900263786315918  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.9003534317016602  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.9142484664916992  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([36, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.9149994850158691  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.9149994850158691  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.9150681495666504  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.926191806793213  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([39, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.9270572662353516  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.9270572662353516  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.9271316528320312  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.9397029876708984  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([341, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.947859764099121  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.947859764099121  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 341, 256]), torch.Size([1, 341, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.9485101699829102  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.063854217529297  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 341, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.0051183700561523  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.006955146789551  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.0086827278137207  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.0067591667175293  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

torch.Size([11592, 40])
input nodes number: 20632
output nodes number: 11592
edges number: 71054
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.0069475173950195  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.0069479942321777  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.03268766403198242  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

pseudo mini batch 2 input nodes size: 33831
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.028652667999267578  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.028652667999267578  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.0447845458984375  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.044870853424072266  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.029159069061279297  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.03080606460571289  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.03080606460571289  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.03080606460571289  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

torch.Size([33831, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.03080606460571289  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

m.shape torch.Size([2378, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.09620523452758789  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.09620523452758789  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 2378, 128]), torch.Size([1, 2378, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.09847307205200195  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.11793661117553711  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 2378, 128])
m.shape torch.Size([2269, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.11802530288696289  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.11802530288696289  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 2269, 128]), torch.Size([1, 2269, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.1202387809753418  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.15471363067626953  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 2269, 128])
m.shape torch.Size([2062, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.1568775177001953  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.1568775177001953  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 2062, 128]), torch.Size([1, 2062, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.1589059829711914  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.20533275604248047  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 2062, 128])
m.shape torch.Size([1695, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.208282470703125  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.208282470703125  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1695, 128]), torch.Size([1, 1695, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.2098989486694336  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.25899696350097656  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1695, 128])
m.shape torch.Size([1548, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.26187944412231445  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.26187944412231445  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1548, 128]), torch.Size([1, 1548, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.26335573196411133  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.31650209426879883  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1548, 128])
m.shape torch.Size([1245, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.31932592391967773  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.31932592391967773  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1245, 128]), torch.Size([1, 1245, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.3205132484436035  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.3721795082092285  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1245, 128])
m.shape torch.Size([1073, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.3757591247558594  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.3757591247558594  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1073, 128]), torch.Size([1, 1073, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.3767824172973633  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.4279470443725586  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1073, 128])
m.shape torch.Size([940, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.43102121353149414  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.43102121353149414  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 940, 128]), torch.Size([1, 940, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.431917667388916  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.4835934638977051  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 940, 128])
m.shape torch.Size([805, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.4865999221801758  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.4865999221801758  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 805, 128]), torch.Size([1, 805, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.4873676300048828  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.5375475883483887  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 805, 128])
m.shape torch.Size([7228, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.571629524230957  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.571629524230957  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 7228, 128]), torch.Size([1, 7228, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.5785226821899414  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.067936897277832  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 7228, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.010826587677002  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.03108549118042  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.051344394683838  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.0309271812438965  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

torch.Size([21243, 256])
first layer input nodes number: 33831
first layer output nodes number: 21243
edges number: 129648
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.0515985488891602  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.0718574523925781  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.0776023864746094  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.0776023864746094  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

m.shape torch.Size([1735, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.167684555053711  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.167684555053711  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1735, 256]), torch.Size([1, 1735, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.172281265258789  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.2014760971069336  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1735, 256])
m.shape torch.Size([1432, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.201977252960205  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.201977252960205  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1432, 256]), torch.Size([1, 1432, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.2047619819641113  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.2512307167053223  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1432, 256])
m.shape torch.Size([1218, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.2524447441101074  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.2524447441101074  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1218, 256]), torch.Size([1, 1218, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.2549519538879395  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.3076534271240234  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1218, 256])
m.shape torch.Size([939, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.3091559410095215  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.3091559410095215  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 939, 256]), torch.Size([1, 939, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.3109469413757324  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.3628859519958496  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 939, 256])
m.shape torch.Size([809, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.3658785820007324  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.3658785820007324  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 809, 256]), torch.Size([1, 809, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.3674216270446777  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.422971248626709  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 809, 256])
m.shape torch.Size([616, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.4257521629333496  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.4257521629333496  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 616, 256]), torch.Size([1, 616, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.426927089691162  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.4786148071289062  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 616, 256])
m.shape torch.Size([548, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.4817142486572266  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.4817142486572266  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 548, 256]), torch.Size([1, 548, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.4827594757080078  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.5374345779418945  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 548, 256])
m.shape torch.Size([460, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.5404491424560547  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.5404491424560547  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.5413265228271484  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.5918216705322266  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([394, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.5947914123535156  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.5947914123535156  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 394, 256]), torch.Size([1, 394, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.5955429077148438  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.6438751220703125  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 394, 256])
m.shape torch.Size([340, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.6467676162719727  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.6467676162719727  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 340, 256]), torch.Size([1, 340, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.647416114807129  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.6937494277954102  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 340, 256])
m.shape torch.Size([300, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.6965970993041992  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.6965970993041992  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.697169303894043  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.7426862716674805  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([245, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.7452259063720703  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.7452259063720703  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.7456932067871094  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.7854137420654297  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([217, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.7878918647766113  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.7878918647766113  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.7883057594299316  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.8263840675354004  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([201, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.8288817405700684  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.8288817405700684  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.8292651176452637  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.8672194480895996  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([183, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.8696660995483398  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.8696660995483398  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.8700151443481445  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.9070138931274414  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([141, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.9092216491699219  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.9092216491699219  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.9094905853271484  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.93988037109375  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([160, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.9423604011535645  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.9423604011535645  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.9426655769348145  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.9792866706848145  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([111, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.9810547828674316  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.9810547828674316  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.9812664985656738  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.0081543922424316  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([103, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.009929656982422  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.009929656982422  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.0101261138916016  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.0364513397216797  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([117, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.038740634918213  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.038740634918213  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.038963794708252  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.0704293251037598  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([105, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.072437286376953  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.072437286376953  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.0726375579833984  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.1022777557373047  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([60, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.1034464836120605  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.1034464836120605  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.1035609245300293  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.1212992668151855  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([72, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.122833728790283  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.122833728790283  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.1229710578918457  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.1452183723449707  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([64, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.1466259956359863  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.1466259956359863  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.1467480659484863  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.1673779487609863  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([979, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.190840721130371  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.190840721130371  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 979, 256]), torch.Size([1, 979, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.1927080154418945  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.5338077545166016  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 979, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.455012798309326  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.4569344520568848  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.459232807159424  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.4572248458862305  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

torch.Size([11549, 40])
input nodes number: 21243
output nodes number: 11549
edges number: 91295
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.457554340362549  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.457554817199707  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.03407573699951172  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

pseudo mini batch 3 input nodes size: 32542
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.029243946075439453  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.029243946075439453  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.04486894607543945  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.044952392578125  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.028734207153320312  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.0302734375  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.0302734375  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.0302734375  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

torch.Size([32542, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.0302734375  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

m.shape torch.Size([1872, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.08893251419067383  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.08893251419067383  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1872, 128]), torch.Size([1, 1872, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.09071779251098633  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.10500001907348633  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1872, 128])
m.shape torch.Size([2087, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.10653209686279297  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.10653209686279297  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 2087, 128]), torch.Size([1, 2087, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.10853433609008789  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.13989591598510742  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 2087, 128])
m.shape torch.Size([1836, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.14188623428344727  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.14188623428344727  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1836, 128]), torch.Size([1, 1836, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.14363718032836914  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.1821579933166504  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1836, 128])
m.shape torch.Size([1579, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.1844487190246582  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.1844487190246582  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1579, 128]), torch.Size([1, 1579, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.18595457077026367  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.2304234504699707  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1579, 128])
m.shape torch.Size([1328, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.23283672332763672  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.23283672332763672  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1328, 128]), torch.Size([1, 1328, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.23410320281982422  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.2796964645385742  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1328, 128])
m.shape torch.Size([1211, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.2825279235839844  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.2825279235839844  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1211, 128]), torch.Size([1, 1211, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.28368282318115234  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.33376026153564453  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1211, 128])
m.shape torch.Size([1023, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.3365974426269531  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.3365974426269531  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1023, 128]), torch.Size([1, 1023, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.3375730514526367  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.3870377540588379  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1023, 128])
m.shape torch.Size([920, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.3900594711303711  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.3900594711303711  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 920, 128]), torch.Size([1, 920, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.39093685150146484  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.4409475326538086  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 920, 128])
m.shape torch.Size([792, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.4439077377319336  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.4439077377319336  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 792, 128]), torch.Size([1, 792, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.44466304779052734  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.49323177337646484  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 792, 128])
m.shape torch.Size([6437, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.524104118347168  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.524104118347168  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 6437, 128]), torch.Size([1, 6437, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.530242919921875  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.9660978317260742  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 6437, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.9155974388122559  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.9337983131408691  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.9519991874694824  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.9336557388305664  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

torch.Size([19085, 256])
first layer input nodes number: 32542
first layer output nodes number: 19085
edges number: 117795
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.9522438049316406  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.9704446792602539  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.9749951362609863  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.9749951362609863  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

m.shape torch.Size([1417, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.062039852142334  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.062039852142334  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1417, 256]), torch.Size([1, 1417, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.064816951751709  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.087632656097412  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1417, 256])
m.shape torch.Size([1352, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.088508129119873  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.088508129119873  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1352, 256]), torch.Size([1, 1352, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.0911688804626465  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.1328015327453613  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1352, 256])
m.shape torch.Size([1126, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.1339521408081055  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.1339521408081055  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1126, 256]), torch.Size([1, 1126, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.1361818313598633  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.1837587356567383  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1126, 256])
m.shape torch.Size([943, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.186704158782959  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.186704158782959  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 943, 256]), torch.Size([1, 943, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.1885027885437012  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.2407221794128418  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 943, 256])
m.shape torch.Size([801, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.2436723709106445  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.2436723709106445  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 801, 256]), torch.Size([1, 801, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.2452001571655273  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.3002004623413086  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 801, 256])
m.shape torch.Size([693, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.3034329414367676  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.3034329414367676  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 693, 256]), torch.Size([1, 693, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.3047547340393066  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.364424228668213  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 693, 256])
m.shape torch.Size([569, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.3675918579101562  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.3675918579101562  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 569, 256]), torch.Size([1, 569, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.3686771392822266  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.4234800338745117  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 569, 256])
m.shape torch.Size([463, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.426497459411621  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.426497459411621  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 463, 256]), torch.Size([1, 463, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.4273805618286133  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.47977876663208  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 463, 256])
m.shape torch.Size([434, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.4830918312072754  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.4830918312072754  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 434, 256]), torch.Size([1, 434, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.483919620513916  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.5373616218566895  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 434, 256])
m.shape torch.Size([388, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.5406770706176758  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.5406770706176758  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 388, 256]), torch.Size([1, 388, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.541417121887207  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.5945119857788086  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 388, 256])
m.shape torch.Size([356, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.5979061126708984  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.5979061126708984  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 356, 256]), torch.Size([1, 356, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.5985851287841797  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.6525592803955078  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 356, 256])
m.shape torch.Size([289, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.6555533409118652  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.6555533409118652  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.656104564666748  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.7048487663269043  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 289, 256])
m.shape torch.Size([246, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.7076468467712402  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.7076468467712402  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.708116054534912  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.7512831687927246  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([210, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.7538743019104004  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.7538743019104004  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.754274845123291  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.793928623199463  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([162, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.7960638999938965  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.7960638999938965  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.796372890472412  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.8291258811950684  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([160, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.8314318656921387  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.8314318656921387  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.8317370414733887  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.8662219047546387  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([146, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.868454933166504  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.868454933166504  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.8687334060668945  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.9021501541137695  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([140, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.904433250427246  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.904433250427246  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.9047002792358398  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.938612937927246  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([103, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.9403605461120605  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.9403605461120605  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.9405570030212402  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.9668822288513184  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([117, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.9690332412719727  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.9690332412719727  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.9692564010620117  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.0007219314575195  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([97, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.002568244934082  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.002568244934082  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.002753257751465  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.030135154724121  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([78, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.0316920280456543  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.0316920280456543  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.0318408012390137  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.054900646209717  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([74, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.057164192199707  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.057164192199707  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.057305335998535  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.0801706314086914  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([68, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.0816688537597656  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.0816688537597656  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.081798553466797  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.103717803955078  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([754, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.1217703819274902  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.1217703819274902  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 754, 256]), torch.Size([1, 754, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.123208522796631  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.3770384788513184  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 754, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.301015853881836  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.3028640747070312  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.305051803588867  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.3031201362609863  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

torch.Size([11186, 40])
input nodes number: 19085
output nodes number: 11186
edges number: 88655
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.3032727241516113  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.3032732009887695  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.033196449279785156  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

pseudo mini batch 4 input nodes size: 84193
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.02866077423095703  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.02866077423095703  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.06880712509155273  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.06888961791992188  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.05318117141723633  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.056691646575927734  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.056691646575927734  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.056691646575927734  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

torch.Size([84193, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.056691646575927734  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

m.shape torch.Size([2481, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.2364211082458496  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.2364211082458496  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 2481, 128]), torch.Size([1, 2481, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.23878717422485352  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.25839662551879883  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 2481, 128])
m.shape torch.Size([2811, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.25989437103271484  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.25989437103271484  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 2811, 128]), torch.Size([1, 2811, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.2626204490661621  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.3038926124572754  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 2811, 128])
m.shape torch.Size([2436, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.3057689666748047  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.3057689666748047  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 2436, 128]), torch.Size([1, 2436, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.30853891372680664  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.3621530532836914  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 2436, 128])
m.shape torch.Size([2188, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.3653707504272461  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.3653707504272461  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 2188, 128]), torch.Size([1, 2188, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.36760377883911133  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.4287571907043457  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 2188, 128])
m.shape torch.Size([2087, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.43293046951293945  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.43293046951293945  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 2087, 128]), torch.Size([1, 2087, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.4349513053894043  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.5107226371765137  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 2087, 128])
m.shape torch.Size([1880, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.514371395111084  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.514371395111084  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1880, 128]), torch.Size([1, 1880, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.5161643028259277  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.593259334564209  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1880, 128])
m.shape torch.Size([1800, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.5983710289001465  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.5983710289001465  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1800, 128]), torch.Size([1, 1800, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.6000876426696777  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.6859183311462402  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1800, 128])
m.shape torch.Size([1710, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.6915831565856934  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.6915831565856934  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1710, 128]), torch.Size([1, 1710, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.693213939666748  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.7862467765808105  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1710, 128])
m.shape torch.Size([1613, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.792353630065918  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.792353630065918  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1613, 128]), torch.Size([1, 1613, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.7938919067382812  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.8930759429931641  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1613, 128])
m.shape torch.Size([27655, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.0241761207580566  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.0241761207580566  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 27655, 128]), torch.Size([1, 27655, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 1.0505499839782715  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.9235525131225586  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 27655, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.757643699645996  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.802143096923828  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.84664249420166  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.80179500579834  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

torch.Size([46661, 256])
first layer input nodes number: 84193
first layer output nodes number: 46661
edges number: 363225
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.8472719192504883  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.8917713165283203  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.9028964042663574  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.9028964042663574  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

m.shape torch.Size([1548, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.008484363555908  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.008484363555908  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1548, 256]), torch.Size([1, 1548, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.012270450592041  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.040740966796875  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1548, 256])
m.shape torch.Size([1386, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.041105270385742  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.041105270385742  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1386, 256]), torch.Size([1, 1386, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.0437674522399902  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.087225914001465  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1386, 256])
m.shape torch.Size([972, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.0888404846191406  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.0888404846191406  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 972, 256]), torch.Size([1, 972, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.0906944274902344  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.13165283203125  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 972, 256])
m.shape torch.Size([751, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.133662700653076  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.133662700653076  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 751, 256]), torch.Size([1, 751, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.1350951194763184  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.1803231239318848  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 751, 256])
m.shape torch.Size([668, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.1828174591064453  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.1828174591064453  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 668, 256]), torch.Size([1, 668, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.184091567993164  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.231276035308838  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 668, 256])
m.shape torch.Size([516, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.233614921569824  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.233614921569824  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 516, 256]), torch.Size([1, 516, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.2345991134643555  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.2778024673461914  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 516, 256])
m.shape torch.Size([389, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.2799277305603027  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.2799277305603027  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 389, 256]), torch.Size([1, 389, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.280669689178467  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.319044589996338  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 389, 256])
m.shape torch.Size([345, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.321326732635498  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.321326732635498  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 345, 256]), torch.Size([1, 345, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.3219847679138184  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.359528064727783  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 345, 256])
m.shape torch.Size([300, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.3617944717407227  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.3617944717407227  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.3623666763305664  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.3998427391052246  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([266, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.402113437652588  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.402113437652588  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.402620792388916  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.4397096633911133  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([245, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.442046642303467  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.442046642303467  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.442513942718506  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.4789633750915527  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([221, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.481278896331787  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.481278896331787  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.4817004203796387  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.5175299644470215  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([183, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.519606113433838  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.519606113433838  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.5199551582336426  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.552067279815674  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([164, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.5540995597839355  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.5540995597839355  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.554412364959717  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.5853800773620605  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([151, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.588111400604248  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.588111400604248  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.5883994102478027  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.6189284324645996  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([134, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.620845317840576  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.620845317840576  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.621100902557373  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.64998197555542  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([115, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.6517333984375  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.6517333984375  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.6519527435302734  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.678274154663086  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([149, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.6807422637939453  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.6807422637939453  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.6810264587402344  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.7171192169189453  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([132, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.719388008117676  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.719388008117676  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.719639778137207  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.7533769607543945  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([96, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.755096435546875  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.755096435546875  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.755279541015625  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.781097412109375  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([104, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.7831053733825684  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.7831053733825684  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.783303737640381  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.812661647796631  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([91, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.8144869804382324  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.8144869804382324  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.8146605491638184  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.8415637016296387  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([66, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.8429360389709473  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.8429360389709473  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.843061923980713  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.863455295562744  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([73, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.8650765419006348  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.8650765419006348  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.86521577835083  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.888746738433838  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([1973, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.936084747314453  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.936084747314453  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1973, 256]), torch.Size([1, 1973, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.939847946166992  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 4.622623443603516  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1973, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 4.5263447761535645  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 4.528075695037842  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 4.529720783233643  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 4.527907371520996  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

torch.Size([11038, 40])
input nodes number: 46661
output nodes number: 11038
edges number: 107796
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 4.5282206535339355  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 4.528221130371094  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.06357717514038086  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

pseudo mini batch 5 input nodes size: 69191
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.05306386947631836  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.05306386947631836  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.08626699447631836  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.08635425567626953  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.04612541198730469  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.04982757568359375  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.04982757568359375  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.04982757568359375  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

torch.Size([69191, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.04982757568359375  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

m.shape torch.Size([1834, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.22254037857055664  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.22254037857055664  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1834, 128]), torch.Size([1, 1834, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.2242894172668457  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.2382817268371582  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1834, 128])
m.shape torch.Size([1916, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.23923444747924805  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.23923444747924805  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1916, 128]), torch.Size([1, 1916, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.24106168746948242  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.26847028732299805  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1916, 128])
m.shape torch.Size([1846, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.2702651023864746  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.2702651023864746  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1846, 128]), torch.Size([1, 1846, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.27202558517456055  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.31075620651245117  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1846, 128])
m.shape torch.Size([1754, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.31322145462036133  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.31322145462036133  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1754, 128]), torch.Size([1, 1754, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.3148941993713379  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.3642735481262207  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1754, 128])
m.shape torch.Size([1678, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.36743783950805664  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.36743783950805664  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1678, 128]), torch.Size([1, 1678, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.36903810501098633  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.4292569160461426  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1678, 128])
m.shape torch.Size([1558, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.43291425704956055  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.43291425704956055  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1558, 128]), torch.Size([1, 1558, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.4344000816345215  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.4988560676574707  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1558, 128])
m.shape torch.Size([1545, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.503270149230957  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.503270149230957  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1545, 128]), torch.Size([1, 1545, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.5047435760498047  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.5793056488037109  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1545, 128])
m.shape torch.Size([1409, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.5839438438415527  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.5839438438415527  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1409, 128]), torch.Size([1, 1409, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.5852875709533691  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.6629538536071777  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1409, 128])
m.shape torch.Size([1408, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.6683244705200195  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.6683244705200195  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1408, 128]), torch.Size([1, 1408, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.6696672439575195  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.7578554153442383  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1408, 128])
m.shape torch.Size([28078, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.8910703659057617  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.8910703659057617  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 28078, 128]), torch.Size([1, 28078, 128])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.9178476333618164  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.819033622741699  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 28078, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.6587133407592773  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.6997461318969727  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.740778923034668  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.699425220489502  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

torch.Size([43026, 256])
first layer input nodes number: 69191
first layer output nodes number: 43026
edges number: 351497
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.7412967681884766  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.782329559326172  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.7929744720458984  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.7929744720458984  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

m.shape torch.Size([1136, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.934290885925293  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.934290885925293  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 1136, 256]), torch.Size([1, 1136, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.93698787689209  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.959092617034912  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 1136, 256])
m.shape torch.Size([978, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.9592065811157227  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.9592065811157227  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 978, 256]), torch.Size([1, 978, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.9610719680786133  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.9890527725219727  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 978, 256])
m.shape torch.Size([841, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.990550994873047  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.990550994873047  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 841, 256]), torch.Size([1, 841, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 2.992155075073242  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.027444839477539  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 841, 256])
m.shape torch.Size([666, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.0292344093322754  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.0292344093322754  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 666, 256]), torch.Size([1, 666, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.0305047035217285  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.070888042449951  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 666, 256])
m.shape torch.Size([576, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.07387638092041  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.07387638092041  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 576, 256]), torch.Size([1, 576, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.07497501373291  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.1149845123291016  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 576, 256])
m.shape torch.Size([455, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.1170592308044434  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.1170592308044434  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 455, 256]), torch.Size([1, 455, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.117927074432373  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.156947135925293  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 455, 256])
m.shape torch.Size([413, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.159292221069336  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.159292221069336  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 413, 256]), torch.Size([1, 413, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.1600799560546875  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.2008132934570312  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 413, 256])
m.shape torch.Size([334, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.2029876708984375  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.2029876708984375  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 334, 256]), torch.Size([1, 334, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.203624725341797  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.240633964538574  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 334, 256])
m.shape torch.Size([344, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.2432913780212402  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.2432913780212402  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 344, 256]), torch.Size([1, 344, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.2439475059509277  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.2859396934509277  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 344, 256])
m.shape torch.Size([313, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.2886199951171875  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.2886199951171875  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.289216995239258  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.332967758178711  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([271, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.3355345726013184  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.3355345726013184  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.3360514640808105  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.3777384757995605  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([272, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.380617141723633  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.380617141723633  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.381135940551758  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.4269847869873047  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([237, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.429687023162842  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.429687023162842  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.4301390647888184  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.471726894378662  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([207, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.4742865562438965  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.4742865562438965  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.4746813774108887  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.5137686729431152  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([193, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.5163540840148926  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.5163540840148926  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.5167222023010254  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.5557427406311035  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([188, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.5584497451782227  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.5584497451782227  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.5588083267211914  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.59932804107666  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([175, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.60200834274292  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.60200834274292  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.602342128753662  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.6423964500427246  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([173, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.6452226638793945  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.6452226638793945  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.645552635192871  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.6874589920043945  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([156, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.69014310836792  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.69014310836792  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.6904406547546387  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.730311870574951  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([169, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.7334117889404297  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.7334117889404297  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.733734130859375  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.779184341430664  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([154, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.7821316719055176  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.7821316719055176  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.7824254035949707  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.825897693634033  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([102, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.8282723426818848  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.8282723426818848  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.8284668922424316  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.8586220741271973  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([120, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.861177921295166  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.861177921295166  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 3.8614068031311035  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5955810546875 GB
    Memory Allocated: 3.8984856605529785  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([116, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.5955810546875 GB
    Memory Allocated: 3.9010472297668457  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5955810546875 GB
    Memory Allocated: 3.9010472297668457  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 7.5955810546875 GB
    Memory Allocated: 3.901268482208252  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6346435546875 GB
    Memory Allocated: 3.938660144805908  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([3120, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.6346435546875 GB
    Memory Allocated: 4.013517379760742  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6346435546875 GB
    Memory Allocated: 4.013517379760742  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

 h.shape torch.Size([1, 3120, 256]), torch.Size([1, 3120, 256])
----------------------------------------3
 Nvidia-smi: 7.6346435546875 GB
    Memory Allocated: 4.019468307495117  GigaBytes
Max Memory Allocated: 4.92947244644165  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6346435546875 GB
    Memory Allocated: 5.066831588745117  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 3120, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6346435546875 GB
    Memory Allocated: 4.93606424331665  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6346435546875 GB
    Memory Allocated: 4.937849521636963  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6346435546875 GB
    Memory Allocated: 4.939916133880615  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.6346435546875 GB
    Memory Allocated: 4.938043594360352  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

torch.Size([11709, 40])
input nodes number: 43026
output nodes number: 11709
edges number: 145260
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6346435546875 GB
    Memory Allocated: 4.938506126403809  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.6346435546875 GB
    Memory Allocated: 4.938506603240967  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.056276798248291016  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

pseudo mini batch 6 input nodes size: 52071
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.046179771423339844  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.046179771423339844  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.07100915908813477  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.07109260559082031  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.03780221939086914  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.03939199447631836  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.03939199447631836  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.03939199447631836  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

torch.Size([52071, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.03939199447631836  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

m.shape torch.Size([3036, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.11279821395874023  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.11279821395874023  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 3036, 128]), torch.Size([1, 3036, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.11569356918334961  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.14009904861450195  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 3036, 128])
m.shape torch.Size([3093, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.1416010856628418  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.1416010856628418  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 3093, 128]), torch.Size([1, 3093, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.14455080032348633  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.18970918655395508  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 3093, 128])
m.shape torch.Size([2750, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.1926589012145996  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.1926589012145996  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 2750, 128]), torch.Size([1, 2750, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.1953907012939453  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.2553234100341797  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 2750, 128])
m.shape torch.Size([2245, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.25899839401245117  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.25899839401245117  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 2245, 128]), torch.Size([1, 2245, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.2613801956176758  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.32770586013793945  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 2245, 128])
m.shape torch.Size([1986, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.3317432403564453  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.3317432403564453  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1986, 128]), torch.Size([1, 1986, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.3336372375488281  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.4018211364746094  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1986, 128])
m.shape torch.Size([1612, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.4054861068725586  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.4054861068725586  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1612, 128]), torch.Size([1, 1612, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.40702342987060547  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.47338008880615234  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1612, 128])
m.shape torch.Size([1357, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.4771409034729004  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.4771409034729004  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1357, 128]), torch.Size([1, 1357, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.47843503952026367  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5431418418884277  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1357, 128])
m.shape torch.Size([1200, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5470724105834961  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5470724105834961  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1200, 128]), torch.Size([1, 1200, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5482168197631836  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.614445686340332  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1200, 128])
m.shape torch.Size([980, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.6180791854858398  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.6180791854858398  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 980, 128]), torch.Size([1, 980, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.619013786315918  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.6802306175231934  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 980, 128])
m.shape torch.Size([7263, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.7143959999084473  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.7143959999084473  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 7263, 128]), torch.Size([1, 7263, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.7213225364685059  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.2138919830322266  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 7263, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.1516499519348145  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.1759896278381348  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.200329303741455  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.1757993698120117  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

torch.Size([25522, 256])
first layer input nodes number: 52071
first layer output nodes number: 25522
edges number: 146603
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.2007193565368652  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.2250590324401855  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.2319693565368652  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.2319693565368652  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

m.shape torch.Size([2034, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.2986984252929688  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.2986984252929688  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 2034, 256]), torch.Size([1, 2034, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.3031282424926758  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.3352651596069336  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 2034, 256])
m.shape torch.Size([1746, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.3364067077636719  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.3364067077636719  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1746, 256]), torch.Size([1, 1746, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.340491771697998  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.3947124481201172  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1746, 256])
m.shape torch.Size([1381, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.3969130516052246  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.3969130516052246  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1381, 256]), torch.Size([1, 1381, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.3996596336364746  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.462667465209961  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1381, 256])
m.shape torch.Size([1082, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.4652576446533203  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.4652576446533203  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1082, 256]), torch.Size([1, 1082, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.4674663543701172  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5289802551269531  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1082, 256])
m.shape torch.Size([868, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.531968593597412  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.531968593597412  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 868, 256]), torch.Size([1, 868, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5336241722106934  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5932250022888184  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 868, 256])
m.shape torch.Size([673, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5962786674499512  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5962786674499512  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 673, 256]), torch.Size([1, 673, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.597562313079834  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.6549673080444336  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 673, 256])
m.shape torch.Size([493, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.6576423645019531  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.6576423645019531  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 493, 256]), torch.Size([1, 493, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.6585826873779297  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7079949378967285  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 493, 256])
m.shape torch.Size([433, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7108545303344727  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7108545303344727  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 433, 256]), torch.Size([1, 433, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7116804122924805  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7588062286376953  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 433, 256])
m.shape torch.Size([370, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.761594295501709  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.761594295501709  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 370, 256]), torch.Size([1, 370, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7623000144958496  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.807614803314209  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 370, 256])
m.shape torch.Size([290, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8100495338439941  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8100495338439941  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8106026649475098  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8512835502624512  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 290, 256])
m.shape torch.Size([215, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8532800674438477  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8532800674438477  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8536901473999023  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.885676383972168  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([173, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8874669075012207  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8874669075012207  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8877968788146973  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.915844440460205  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([168, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9177789688110352  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9177789688110352  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9180994033813477  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9475793838500977  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([140, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.949303150177002  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.949303150177002  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9495701789855957  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.976006031036377  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([124, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9777178764343262  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9777178764343262  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.977954387664795  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0030245780944824  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([103, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.004490375518799  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.004490375518799  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0046868324279785  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.026886463165283  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([78, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0280628204345703  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0280628204345703  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0282115936279297  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0460643768310547  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([71, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0472183227539062  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0472183227539062  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.047353744506836  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0645523071289062  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([72, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0657997131347656  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0657997131347656  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.065937042236328  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.084339141845703  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([68, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.085577964782715  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.085577964782715  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.085707664489746  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.1039953231811523  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([43, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.1047987937927246  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.1047987937927246  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.1048808097839355  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.1170191764831543  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([29, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.117591381072998  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.117591381072998  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.1176466941833496  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.126220226287842  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([35, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.1269664764404297  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.1269664764404297  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.127033233642578  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.137847900390625  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([35, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.138622283935547  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.138622283935547  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.1386890411376953  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.1499710083007812  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([421, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.1600537300109863  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.1600537300109863  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 421, 256]), torch.Size([1, 421, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.1608567237854004  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.303480625152588  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 421, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.2487664222717285  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.250981330871582  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.2526421546936035  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.2503437995910645  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

torch.Size([11145, 40])
input nodes number: 25522
output nodes number: 11145
edges number: 66656
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.251047134399414  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.2510476112365723  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.04299306869506836  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

pseudo mini batch 7 input nodes size: 68185
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.038231849670410156  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.038231849670410156  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.07143497467041016  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.0715174674987793  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.04660463333129883  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.04891061782836914  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.04891061782836914  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.04891061782836914  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

torch.Size([68185, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.04891061782836914  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

m.shape torch.Size([2990, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.16373109817504883  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.16373109817504883  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 2990, 128]), torch.Size([1, 2990, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.16658258438110352  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.18970727920532227  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 2990, 128])
m.shape torch.Size([2968, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.19144582748413086  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.19144582748413086  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 2968, 128]), torch.Size([1, 2968, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.1944742202758789  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.23973560333251953  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 2968, 128])
m.shape torch.Size([2491, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.24256610870361328  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.24256610870361328  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 2491, 128]), torch.Size([1, 2491, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.24494171142578125  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.2984170913696289  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 2491, 128])
m.shape torch.Size([2168, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.30139875411987305  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.30139875411987305  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 2168, 128]), torch.Size([1, 2168, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.3043804168701172  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.36577320098876953  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 2168, 128])
m.shape torch.Size([1871, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.36990833282470703  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.36990833282470703  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1871, 128]), torch.Size([1, 1871, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.3716926574707031  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.4359283447265625  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1871, 128])
m.shape torch.Size([1632, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.43970537185668945  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.43970537185668945  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1632, 128]), torch.Size([1, 1632, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.44126176834106445  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5082478523254395  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1632, 128])
m.shape torch.Size([1398, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5121359825134277  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5121359825134277  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1398, 128]), torch.Size([1, 1398, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5134692192077637  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5841159820556641  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1398, 128])
m.shape torch.Size([1285, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5883512496948242  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5883512496948242  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1285, 128]), torch.Size([1, 1285, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5895767211914062  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.659428596496582  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1285, 128])
m.shape torch.Size([1169, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.6638326644897461  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.6638326644897461  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1169, 128]), torch.Size([1, 1169, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.664947509765625  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.7368330955505371  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1169, 128])
m.shape torch.Size([15674, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.8110151290893555  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.8110151290893555  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 15674, 128]), torch.Size([1, 15674, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.825963020324707  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.887263298034668  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 15674, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7847905158996582  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.816877841949463  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8489651679992676  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.816627025604248  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

torch.Size([33646, 256])
first layer input nodes number: 68185
first layer output nodes number: 33646
edges number: 231545
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.849475383758545  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8815627098083496  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8895845413208008  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8895845413208008  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

m.shape torch.Size([2059, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.966867446899414  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.966867446899414  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 2059, 256]), torch.Size([1, 2059, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.970794677734375  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0022125244140625  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 2059, 256])
m.shape torch.Size([1660, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0035810470581055  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0035810470581055  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1660, 256]), torch.Size([1, 1660, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0069684982299805  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0561065673828125  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1660, 256])
m.shape torch.Size([1214, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0578970909118652  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0578970909118652  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1214, 256]), torch.Size([1, 1214, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.060305595397949  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.1126222610473633  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1214, 256])
m.shape torch.Size([918, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.1149611473083496  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.1149611473083496  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 918, 256]), torch.Size([1, 918, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.1167120933532715  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.1678099632263184  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 918, 256])
m.shape torch.Size([757, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.1705727577209473  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.1705727577209473  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 757, 256]), torch.Size([1, 757, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.1720166206359863  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.2258543968200684  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 757, 256])
m.shape torch.Size([602, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.228604316711426  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.228604316711426  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 602, 256]), torch.Size([1, 602, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.229752540588379  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.27913761138916  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 602, 256])
m.shape torch.Size([474, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.281752586364746  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.281752586364746  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 474, 256]), torch.Size([1, 474, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.282656669616699  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.3286943435668945  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 474, 256])
m.shape torch.Size([397, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.3312950134277344  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.3312950134277344  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 397, 256]), torch.Size([1, 397, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.332052230834961  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.375640869140625  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 397, 256])
m.shape torch.Size([302, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.3778748512268066  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.3778748512268066  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.378450870513916  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.417771816253662  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 302, 256])
m.shape torch.Size([275, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.4201269149780273  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.4201269149780273  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.420651435852051  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.4584951400756836  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([237, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.4607386589050293  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.4607386589050293  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.461190700531006  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.4964499473571777  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([210, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.4986462593078613  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.4986462593078613  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.499046802520752  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.533092975616455  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([151, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.5347795486450195  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.5347795486450195  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.535067558288574  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.5615644454956055  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([127, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.563129425048828  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.563129425048828  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.5633716583251953  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.587352752685547  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([118, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.588932991027832  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.588932991027832  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.589158058166504  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.6130151748657227  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([114, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.6146559715270996  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.6146559715270996  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.6148734092712402  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.639443874359131  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([92, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.640838623046875  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.640838623046875  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.6410140991210938  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.6620712280273438  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([92, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.6635751724243164  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.6635751724243164  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.663750648498535  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.6860361099243164  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([90, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.687592029571533  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.687592029571533  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.6877636909484863  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.710766315460205  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([79, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.7121992111206055  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.7121992111206055  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.7123498916625977  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.733595848083496  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([71, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.7349538803100586  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.7349538803100586  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.7350893020629883  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.755131721496582  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([47, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.7560763359069824  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.7560763359069824  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])[05:09:59] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 21724554 edges into 8 parts and get 3252704 edge cuts

----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.7561659812927246  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.7700610160827637  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([43, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.7709670066833496  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.7709670066833496  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.7710490226745605  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.7843356132507324  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([60, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.7856788635253906  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.7856788635253906  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.7857933044433594  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.805133819580078  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([877, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.8267245292663574  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.8267245292663574  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 877, 256]), torch.Size([1, 877, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.828397274017334  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.1229872703552246  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 877, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.0579915046691895  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.05995512008667  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.0616044998168945  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.059558391571045  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

torch.Size([11066, 40])
input nodes number: 33646
output nodes number: 11066
edges number: 77903
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.059640407562256  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.059640884399414  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.05293083190917969  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.05293083190917969  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.05293083190917969  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01700693368911743 |0.002453356981277466 |0.12232154607772827 |9.799003601074219e-05 |0.09801852703094482 |0.005573749542236328 |
----------------------------------------------------------pseudo_mini_loss sum 4.657425403594971
Total (block generation + training)time/epoch 24.777605295181274
Training time/epoch 1.9722545146942139
Training time without block to device /epoch 1.9526276588439941
Training time without total dataloading part /epoch 1.769078254699707
load block tensor time/epoch 0.13605546951293945
block to device time/epoch 0.019626855850219727
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  658905
Number of first layer input nodes during this epoch:  423090
Number of first layer output nodes during this epoch:  235815
----------------------------------------before generate dataloader block 
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.052930355072021484  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.017580032348632812
global_2_local spend time (sec) 0.05679893493652344
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004334688186645508
A = g.adjacency_matrix() spent  0.010683536529541016
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.09189033508300781
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.395747423171997
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.179093599319458

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 11704867, 2.0: 2016386, 3.0: 505014, 4.0: 151832, 5.0: 55157, 6.0: 24090, 7.0: 11047, 8.0: 5737, 9.0: 3033, 10.0: 1743, 11.0: 999, 12.0: 546, 13.0: 336, 14.0: 193, 15.0: 115, 16.0: 108, 17.0: 90, 18.0: 42, 19.0: 26, 20.0: 6, 21.0: 3})
Convert a graph into a bidirected graph: 0.822 seconds
Metis partitioning: 4.338 seconds
Split the graph: 1.042 seconds
Construct subgraphs: 0.035 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  6.248997211456299
11522
11564
11460
11204
11239
11180
11709
11063
total k batches seeds list generation spend  19.753243446350098
after graph partition
graph partition algorithm spend time 19.873252391815186
11522
11564
11460
11204
11239
11180
11709
11063
partition_len_list
[21555, 26239, 21205, 21111, 22481, 33134, 42616, 46022]
shared_neighbor_graph_partition_s0 selection method  spend 19.983800172805786
time for parepare:  0.018358230590820312
local_output_nid generation:  0.0024237632751464844
local_in_edges_tensor generation:  0.0024881362915039062
mini_batch_src_global generation:  0.003418445587158203
r_  generation:  0.029551267623901367
local_output_nid generation:  0.003053903579711914
local_in_edges_tensor generation:  0.0023598670959472656
mini_batch_src_global generation:  0.004073143005371094
r_  generation:  0.03369474411010742
local_output_nid generation:  0.0030126571655273438
local_in_edges_tensor generation:  0.0024406909942626953
mini_batch_src_global generation:  0.0036873817443847656
r_  generation:  0.03333926200866699
local_output_nid generation:  0.003000020980834961
local_in_edges_tensor generation:  0.0024080276489257812
mini_batch_src_global generation:  0.0036246776580810547
r_  generation:  0.0333867073059082
local_output_nid generation:  0.0030078887939453125
local_in_edges_tensor generation:  0.0022640228271484375
mini_batch_src_global generation:  0.0029022693634033203
r_  generation:  0.02631521224975586
local_output_nid generation:  0.0028831958770751953
local_in_edges_tensor generation:  0.0022945404052734375
mini_batch_src_global generation:  0.003050565719604492
r_  generation:  0.03180956840515137
local_output_nid generation:  0.0031991004943847656
local_in_edges_tensor generation:  0.0027856826782226562
mini_batch_src_global generation:  0.006549835205078125
r_  generation:  0.05185127258300781
local_output_nid generation:  0.003926992416381836
local_in_edges_tensor generation:  0.0030679702758789062
mini_batch_src_global generation:  0.005630970001220703
r_  generation:  0.04196643829345703
----------------------check_connections_block total spend ----------------------------- 0.45220088958740234
generate_one_block  0.04380035400390625
generate_one_block  0.04782700538635254
generate_one_block  0.0419309139251709
generate_one_block  0.044277191162109375
generate_one_block  0.030686378479003906
generate_one_block  0.03982281684875488
generate_one_block  0.06751227378845215
generate_one_block  0.05827164649963379
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04338359832763672
gen group dst list time:  0.006638288497924805
time for parepare:  0.022103071212768555
local_output_nid generation:  0.004197359085083008
local_in_edges_tensor generation:  0.020517587661743164
mini_batch_src_global generation:  0.004085540771484375
r_  generation:  0.043657779693603516
local_output_nid generation:  0.006871223449707031
local_in_edges_tensor generation:  0.006250143051147461
mini_batch_src_global generation:  0.006087779998779297
r_  generation:  0.06075453758239746
local_output_nid generation:  0.005936622619628906
local_in_edges_tensor generation:  0.005169391632080078
mini_batch_src_global generation:  0.0047948360443115234
r_  generation:  0.04860043525695801
local_output_nid generation:  0.005423069000244141
local_in_edges_tensor generation:  0.004233837127685547
mini_batch_src_global generation:  0.004523038864135742
r_  generation:  0.04840731620788574
local_output_nid generation:  0.005690097808837891
local_in_edges_tensor generation:  0.0045430660247802734
mini_batch_src_global generation:  0.0041010379791259766
r_  generation:  0.04674196243286133
local_output_nid generation:  0.00813436508178711
local_in_edges_tensor generation:  0.007694721221923828
mini_batch_src_global generation:  0.008843660354614258
r_  generation:  0.09371423721313477
local_output_nid generation:  0.009635210037231445
local_in_edges_tensor generation:  0.011182546615600586
mini_batch_src_global generation:  0.013983726501464844
r_  generation:  0.12267136573791504
local_output_nid generation:  0.014047861099243164
local_in_edges_tensor generation:  0.01243734359741211
mini_batch_src_global generation:  0.016577959060668945
r_  generation:  0.13005447387695312
----------------------check_connections_block total spend ----------------------------- 0.963076114654541
generate_one_block  0.06545162200927734
generate_one_block  0.08146166801452637
generate_one_block  0.0684361457824707
generate_one_block  0.06315135955810547
generate_one_block  0.05929732322692871
generate_one_block  0.11274886131286621
generate_one_block  0.1586146354675293
generate_one_block  0.16982316970825195
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.052930355072021484  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

connection checking time:  0.963076114654541
block generation total time  0.778984785079956
average batch blocks generation time:  0.0973730981349945
block dataloader generation time/epoch 22.770021080970764
pseudo mini batch 0 input nodes size: 36716
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.046352386474609375  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.046352386474609375  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.06385993957519531  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.06394624710083008  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.030660629272460938  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.032149314880371094  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.032149314880371094  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.032149314880371094  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

torch.Size([36716, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.032149314880371094  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

m.shape torch.Size([2621, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.09380531311035156  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.09380531311035156  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 2621, 128]), torch.Size([1, 2621, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.09707880020141602  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.11801671981811523  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 2621, 128])
m.shape torch.Size([2680, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.1193227767944336  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.1193227767944336  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 2680, 128]), torch.Size([1, 2680, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.12187862396240234  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.16289424896240234  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 2680, 128])
m.shape torch.Size([2361, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.16410112380981445  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.16410112380981445  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 2361, 128]), torch.Size([1, 2361, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.1666717529296875  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.21722126007080078  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 2361, 128])
m.shape torch.Size([2050, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.22059869766235352  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.22059869766235352  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 2050, 128]), torch.Size([1, 2050, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.22255373001098633  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.2833290100097656  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 2050, 128])
m.shape torch.Size([1628, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.28623294830322266  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.28623294830322266  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1628, 128]), torch.Size([1, 1628, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.28778553009033203  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.34415340423583984  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1628, 128])
m.shape torch.Size([1359, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.34726524353027344  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.34726524353027344  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1359, 128]), torch.Size([1, 1359, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.34856128692626953  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.40642547607421875  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1359, 128])
m.shape torch.Size([1172, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.40968942642211914  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.40968942642211914  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1172, 128]), torch.Size([1, 1172, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.41080713272094727  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.4675107002258301  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1172, 128])
m.shape torch.Size([1037, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.47090768814086914  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.47090768814086914  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1037, 128]), torch.Size([1, 1037, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.4718966484069824  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5294890403747559  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1037, 128])
m.shape torch.Size([876, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5327539443969727  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5327539443969727  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 876, 128]), torch.Size([1, 876, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5335893630981445  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5879087448120117  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 876, 128])
m.shape torch.Size([5771, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.6150093078613281  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.6150093078613281  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 5771, 128]), torch.Size([1, 5771, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.6205129623413086  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.0130529403686523  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 5771, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.9601411819458008  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.9816255569458008  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.0021820068359375  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.980536937713623  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

torch.Size([21555, 256])
first layer input nodes number: 36716
first layer output nodes number: 21555
edges number: 121652
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.002457618713379  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.023941993713379  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.028153419494629  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.028153419494629  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

m.shape torch.Size([1818, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.1053705215454102  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.1053705215454102  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1818, 256]), torch.Size([1, 1818, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.1094818115234375  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.1372222900390625  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1818, 256])
m.shape torch.Size([1587, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.1389799118041992  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.1389799118041992  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1587, 256]), torch.Size([1, 1587, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.1421575546264648  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.18914794921875  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1587, 256])
m.shape torch.Size([1334, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.1912741661071777  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.1912741661071777  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1334, 256]), torch.Size([1, 1334, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.194272518157959  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.2511401176452637  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1334, 256])
m.shape torch.Size([1057, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.2537164688110352  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.2537164688110352  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1057, 256]), torch.Size([1, 1057, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.2559943199157715  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.3178133964538574  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1057, 256])
m.shape torch.Size([838, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.320589542388916  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.320589542388916  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 838, 256]), torch.Size([1, 838, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.322187900543213  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.3820528984069824  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 838, 256])
m.shape torch.Size([692, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.385244369506836  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.385244369506836  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 692, 256]), torch.Size([1, 692, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.3865642547607422  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.443319320678711  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 692, 256])
m.shape torch.Size([583, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.4465818405151367  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.4465818405151367  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 583, 256]), torch.Size([1, 583, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.4476938247680664  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5039186477661133  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 583, 256])
m.shape torch.Size([502, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5072226524353027  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5072226524353027  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 502, 256]), torch.Size([1, 502, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5081801414489746  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5636343955993652  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 502, 256])
m.shape torch.Size([429, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5673961639404297  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5673961639404297  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 429, 256]), torch.Size([1, 429, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5682144165039062  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.6206855773925781  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 429, 256])
m.shape torch.Size([316, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.6233139038085938  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.6233139038085938  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 316, 256]), torch.Size([1, 316, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.6239166259765625  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.6684494018554688  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 316, 256])
m.shape torch.Size([282, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.6711297035217285  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.6711297035217285  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.6716675758361816  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.714226245880127  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([267, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7170372009277344  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7170372009277344  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7175464630126953  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7612266540527344  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([206, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7635459899902344  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7635459899902344  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7639389038085938  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8000869750976562  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([174, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.802232265472412  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.802232265472412  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8025641441345215  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8354201316833496  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([155, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.837489128112793  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.837489128112793  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.837784767150879  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8691225051879883  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([140, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8711276054382324  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8711276054382324  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8713946342468262  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.90156888961792  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([112, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9032654762268066  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9032654762268066  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9034790992736816  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9291138648986816  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([105, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.930823802947998  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.930823802947998  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9310240745544434  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.956458568572998  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([91, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9580206871032715  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9580206871032715  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9581942558288574  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.981452465057373  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([73, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9827690124511719  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9827690124511719  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9829082489013672  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0025405883789062  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([75, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0039849281311035  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0039849281311035  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0041279792785645  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.025299549102783  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([66, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0273780822753906  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0273780822753906  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0275039672851562  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.047016143798828  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([66, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.048412322998047  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.048412322998047  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0485382080078125  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0689315795898438  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([50, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0700221061706543  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0700221061706543  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.070117473602295  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0862345695495605  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([504, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.098297119140625  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.098297119140625  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 504, 256]), torch.Size([1, 504, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0992584228515625  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.2705841064453125  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 504, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.2052764892578125  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.207010269165039  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.2087273597717285  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.206907272338867  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

torch.Size([11522, 40])
input nodes number: 21555
output nodes number: 11522
edges number: 77995
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.2069244384765625  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.206925392150879  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.03487682342529297  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

pseudo mini batch 1 input nodes size: 49453
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.030431747436523438  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.030431747436523438  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.05401277542114258  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.054099082946777344  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.03650522232055664  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.0383906364440918  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.0383906364440918  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.0383906364440918  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

torch.Size([49453, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.0383906364440918  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

m.shape torch.Size([2542, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.12024259567260742  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.12024259567260742  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 2542, 128]), torch.Size([1, 2542, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.12347269058227539  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.1440725326538086  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 2542, 128])
m.shape torch.Size([2708, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.14544296264648438  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.14544296264648438  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 2708, 128]), torch.Size([1, 2708, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.1480255126953125  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.18828201293945312  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 2708, 128])
m.shape torch.Size([2456, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.1905040740966797  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.1905040740966797  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 2456, 128]), torch.Size([1, 2456, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.1934213638305664  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.24731922149658203  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 2456, 128])
m.shape torch.Size([2119, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.25045108795166016  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.25045108795166016  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 2119, 128]), torch.Size([1, 2119, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.25275516510009766  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.3138728141784668  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 2119, 128])
m.shape torch.Size([1979, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.3175806999206543  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.3175806999206543  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1979, 128]), torch.Size([1, 1979, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.31946802139282227  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.3882150650024414  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1979, 128])
m.shape torch.Size([1649, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.39198923110961914  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.39198923110961914  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1649, 128]), torch.Size([1, 1649, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.39356184005737305  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.4611968994140625  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1649, 128])
m.shape torch.Size([1378, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.4650101661682129  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.4650101661682129  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1378, 128]), torch.Size([1, 1378, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.4663243293762207  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5324482917785645  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1378, 128])
m.shape torch.Size([1266, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5366206169128418  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5366206169128418  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1266, 128]), torch.Size([1, 1266, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5378279685974121  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.6070742607116699  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1266, 128])
m.shape torch.Size([1081, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.611109733581543  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.611109733581543  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1081, 128]), torch.Size([1, 1081, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.6121406555175781  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.6821093559265137  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1081, 128])
m.shape torch.Size([9061, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.7248001098632812  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.7248001098632812  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 9061, 128]), torch.Size([1, 9061, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.7343282699584961  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.3491272926330566  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 9061, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.2770872116088867  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.3021106719970703  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.327134132385254  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.301915168762207  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

torch.Size([26239, 256])
first layer input nodes number: 49453
first layer output nodes number: 26239
edges number: 163704
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.3275046348571777  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.3525280952453613  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.3595476150512695  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.3595476150512695  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

m.shape torch.Size([1664, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.4478068351745605  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.4478068351745605  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1664, 256]), torch.Size([1, 1664, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.45186185836792  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.4790663719177246  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1664, 256])
m.shape torch.Size([1479, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.479660987854004  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.479660987854004  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1479, 256]), torch.Size([1, 1479, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.4837589263916016  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5313386917114258  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1479, 256])
m.shape torch.Size([1169, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5324606895446777  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5324606895446777  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1169, 256]), torch.Size([1, 1169, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.534726619720459  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5846705436706543  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1169, 256])
m.shape torch.Size([937, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5871391296386719  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5871391296386719  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 937, 256]), torch.Size([1, 937, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5889263153076172  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.6407546997070312  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 937, 256])
m.shape torch.Size([875, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.644066333770752  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.644066333770752  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 875, 256]), torch.Size([1, 875, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.645735263824463  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7059426307678223  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 875, 256])
m.shape torch.Size([681, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7090353965759277  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7090353965759277  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 681, 256]), torch.Size([1, 681, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.710334300994873  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7669949531555176  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 681, 256])
m.shape torch.Size([555, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7700796127319336  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7700796127319336  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 555, 256]), torch.Size([1, 555, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7711381912231445  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8268308639526367  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 555, 256])
m.shape torch.Size([500, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.830146312713623  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.830146312713623  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 500, 256]), torch.Size([1, 500, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8310999870300293  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8872828483581543  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 500, 256])
m.shape torch.Size([422, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8904566764831543  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8904566764831543  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 422, 256]), torch.Size([1, 422, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8912615776062012  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9444928169250488  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 422, 256])
m.shape torch.Size([363, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9475793838500977  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9475793838500977  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 363, 256]), torch.Size([1, 363, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9482717514038086  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9990758895874023  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 363, 256])
m.shape torch.Size([295, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0018486976623535  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0018486976623535  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.002411365509033  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.046938419342041  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([258, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.049633026123047  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.049633026123047  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0501251220703125  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.092963218688965  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([218, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0954413414001465  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0954413414001465  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0958571434020996  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.134110927581787  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([197, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.13655424118042  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.13655424118042  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.136929988861084  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.174129009246826  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([186, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.1766228675842285  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.1766228675842285  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.1769776344299316  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.214582920074463  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([165, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.2169432640075684  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.2169432640075684  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.2172579765319824  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.2528204917907715  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([127, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.2547383308410645  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.2547383308410645  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.2549805641174316  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.284048557281494  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([113, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.2858824729919434  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.2858824729919434  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.286098003387451  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.3134703636169434  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([112, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.315408229827881  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.315408229827881  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.315621852874756  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.344247341156006  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([102, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.3461012840270996  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.3461012840270996  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.3462958335876465  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.373727321624756  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([75, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.3751440048217773  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.3751440048217773  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.3752870559692383  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.396458625793457  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([77, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.398646831512451  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.398646831512451  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.3987936973571777  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.421557903289795  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([63, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.422877311706543  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.422877311706543  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.42299747467041  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.4424638748168945  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([57, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.443718910217285  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.443718910217285  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.4438276290893555  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.4622011184692383  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([874, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.4837942123413086  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.4837942123413086  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 874, 256]), torch.Size([1, 874, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.4854612350463867  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.779031753540039  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 874, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.702322006225586  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.704570770263672  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.706294059753418  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.7039589881896973  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

torch.Size([11564, 40])
input nodes number: 26239
output nodes number: 11564
edges number: 89311
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.7047557830810547  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.704756259918213  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.04254150390625  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

pseudo mini batch 2 input nodes size: 39347
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.037020206451416016  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.037020206451416016  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.056551456451416016  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.05663728713989258  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.03296995162963867  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.03464651107788086  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.03464651107788086  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.03464651107788086  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

torch.Size([39347, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.03464651107788086  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

m.shape torch.Size([1936, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.10174942016601562  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.10174942016601562  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1936, 128]), torch.Size([1, 1936, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.10359573364257812  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.11865854263305664  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1936, 128])
m.shape torch.Size([2129, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.1197657585144043  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.1197657585144043  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 2129, 128]), torch.Size([1, 2129, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.12206888198852539  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.1535506248474121  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 2129, 128])
m.shape torch.Size([1945, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.15558099746704102  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.15558099746704102  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1945, 128]), torch.Size([1, 1945, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.15743589401245117  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.1982436180114746  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1945, 128])
m.shape torch.Size([1684, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.20052814483642578  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.20052814483642578  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1684, 128]), torch.Size([1, 1684, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.2021341323852539  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.25117969512939453  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1684, 128])
m.shape torch.Size([1469, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.2538790702819824  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.2538790702819824  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1469, 128]), torch.Size([1, 1469, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.2552800178527832  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.3059525489807129  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1469, 128])
m.shape torch.Size([1298, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.30896568298339844  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.30896568298339844  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1298, 128]), torch.Size([1, 1298, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.31020355224609375  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.36356544494628906  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1298, 128])
m.shape torch.Size([1135, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.36673498153686523  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.36673498153686523  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1135, 128]), torch.Size([1, 1135, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.36781740188598633  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.4248161315917969  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1135, 128])
m.shape torch.Size([1046, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.4282650947570801  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.4282650947570801  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1046, 128]), torch.Size([1, 1046, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.429262638092041  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.48612260818481445  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1046, 128])
m.shape torch.Size([838, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.48922014236450195  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.48922014236450195  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 838, 128]), torch.Size([1, 838, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.4900193214416504  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5427064895629883  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 838, 128])
m.shape torch.Size([7725, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5791425704956055  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5791425704956055  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 7725, 128]), torch.Size([1, 7725, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5865097045898438  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.1095762252807617  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 7725, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.0512261390686035  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.071448802947998  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.0916714668273926  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.0712904930114746  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

torch.Size([21205, 256])
first layer input nodes number: 39347
first layer output nodes number: 21205
edges number: 135003
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.0919666290283203  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.1121892929077148  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.1172451972961426  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.1172451972961426  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

m.shape torch.Size([1430, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.205634593963623  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.205634593963623  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1430, 256]), torch.Size([1, 1430, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.2091021537780762  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.2314176559448242  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1430, 256])
m.shape torch.Size([1392, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.232802391052246  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.232802391052246  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1392, 256]), torch.Size([1, 1392, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.2358026504516602  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.2784652709960938  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1392, 256])
m.shape torch.Size([1188, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.2797489166259766  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.2797489166259766  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1188, 256]), torch.Size([1, 1188, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.282303810119629  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.3348608016967773  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1188, 256])
m.shape torch.Size([992, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.3378715515136719  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.3378715515136719  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 992, 256]), torch.Size([1, 992, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.3397636413574219  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.3952445983886719  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 992, 256])
m.shape torch.Size([813, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.3987236022949219  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.3987236022949219  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 813, 256]), torch.Size([1, 813, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.4002742767333984  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.4579448699951172  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 813, 256])
m.shape torch.Size([713, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.4612812995910645  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.4612812995910645  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 713, 256]), torch.Size([1, 713, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.4626412391662598  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.522810459136963  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 713, 256])
m.shape torch.Size([597, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5261473655700684  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5261473655700684  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 597, 256]), torch.Size([1, 597, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5272860527038574  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5844569206237793  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 597, 256])
m.shape torch.Size([509, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.587801456451416  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.587801456451416  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 509, 256]), torch.Size([1, 509, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5887722969055176  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.6443390846252441  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 509, 256])
m.shape torch.Size([427, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.647547721862793  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.647547721862793  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 427, 256]), torch.Size([1, 427, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.648362159729004  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7014446258544922  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 427, 256])
m.shape torch.Size([398, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7048630714416504  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7048630714416504  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 398, 256]), torch.Size([1, 398, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7056221961975098  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.759932041168213  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 398, 256])
m.shape torch.Size([350, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7632532119750977  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7632532119750977  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 350, 256]), torch.Size([1, 350, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.763920783996582  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8185930252075195  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 350, 256])
m.shape torch.Size([272, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8213963508605957  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8213963508605957  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8219151496887207  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8683533668518066  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([265, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8714051246643066  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8714051246643066  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.871910572052002  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9187698364257812  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([229, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9215989112854004  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9215989112854004  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9220356941223145  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9652771949768066  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([172, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.967538833618164  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.967538833618164  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9678668975830078  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0026416778564453  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([149, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0047693252563477  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0047693252563477  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0050535202026367  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.037167549133301  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([153, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0395255088806152  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0395255088806152  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0398173332214355  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.074836254119873  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([130, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.076939582824707  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.076939582824707  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0771875381469727  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.108677864074707  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([100, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.110380172729492  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.110380172729492  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.1105709075927734  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.136129379272461  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([122, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.1383795738220215  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.1383795738220215  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.1386122703552246  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.1714224815368652  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([91, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.173142910003662  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.173142910003662  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.173316478729248  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.199004650115967  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([81, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.2006306648254395  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.2006306648254395  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.2007851600646973  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.224731922149658  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([52, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.2258358001708984  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.2258358001708984  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.2259349822998047  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.242002487182617  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([66, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.2434754371643066  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.2434754371643066  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.2436013221740723  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.264875888824463  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([769, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.2832908630371094  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.2832908630371094  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 769, 256]), torch.Size([1, 769, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.284757614135742  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.5461626052856445  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 769, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.4698872566223145  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.4718174934387207  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.473747730255127  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.471731662750244  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

torch.Size([11460, 40])
input nodes number: 21205
output nodes number: 11460
edges number: 89871
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.4716572761535645  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.4716577529907227  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.03757190704345703  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

pseudo mini batch 3 input nodes size: 34562
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.032651424407958984  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.032651424407958984  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.04913187026977539  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.04921579360961914  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.029598712921142578  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.031255245208740234  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.031255245208740234  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.031255245208740234  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

torch.Size([34562, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.031255245208740234  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

m.shape torch.Size([2185, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.09664678573608398  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.09664678573608398  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 2185, 128]), torch.Size([1, 2185, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.09873056411743164  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.11565876007080078  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 2185, 128])
m.shape torch.Size([2217, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.11673116683959961  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.11673116683959961  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 2217, 128]), torch.Size([1, 2217, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.11905765533447266  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.1507720947265625  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 2217, 128])
m.shape torch.Size([2007, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.15288639068603516  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.15288639068603516  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 2007, 128]), torch.Size([1, 2007, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.1548004150390625  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.19690895080566406  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 2007, 128])
m.shape torch.Size([1678, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.19915246963500977  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.19915246963500977  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1678, 128]), torch.Size([1, 1678, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.20075273513793945  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.2497696876525879  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1678, 128])
m.shape torch.Size([1511, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.25257205963134766  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.25257205963134766  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1511, 128]), torch.Size([1, 1511, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.2540130615234375  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.3058891296386719  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1511, 128])
m.shape torch.Size([1291, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.30886220932006836  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.30886220932006836  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1291, 128]), torch.Size([1, 1291, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.31009340286254883  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.36351633071899414  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1291, 128])
m.shape torch.Size([1098, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.3665657043457031  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.3665657043457031  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1098, 128]), torch.Size([1, 1098, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.3676128387451172  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.42083072662353516  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1098, 128])
m.shape torch.Size([970, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.4240074157714844  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.4240074157714844  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 970, 128]), torch.Size([1, 970, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.42493247985839844  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.4792060852050781  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 970, 128])
m.shape torch.Size([798, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.48216819763183594  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.48216819763183594  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 798, 128]), torch.Size([1, 798, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.4829292297363281  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.531951904296875  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 798, 128])
m.shape torch.Size([7356, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5666475296020508  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5666475296020508  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 7356, 128]), torch.Size([1, 7356, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5736627578735352  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.071864128112793  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 7356, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.0155210494995117  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.035654067993164  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.0557870864868164  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.035496711730957  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

torch.Size([21111, 256])
first layer input nodes number: 34562
first layer output nodes number: 21111
edges number: 130841
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.056046962738037  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.0761799812316895  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.0816807746887207  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.0816807746887207  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

m.shape torch.Size([1574, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.1719427108764648  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.1719427108764648  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1574, 256]), torch.Size([1, 1574, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.175929069519043  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.2019147872924805  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1574, 256])
m.shape torch.Size([1379, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.2026453018188477  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.2026453018188477  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1379, 256]), torch.Size([1, 1379, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.2053565979003906  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.2485108375549316  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1379, 256])
m.shape torch.Size([1152, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.2500038146972656  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.2500038146972656  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1152, 256]), torch.Size([1, 1152, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.2522163391113281  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.3029108047485352  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1152, 256])
m.shape torch.Size([899, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.3044052124023438  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.3044052124023438  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 899, 256]), torch.Size([1, 899, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.3061199188232422  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.3563385009765625  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 899, 256])
m.shape torch.Size([761, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.3591384887695312  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.3591384887695312  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 761, 256]), torch.Size([1, 761, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.3605899810791016  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.4128437042236328  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 761, 256])
m.shape torch.Size([609, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.4156303405761719  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.4156303405761719  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 609, 256]), torch.Size([1, 609, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.4167919158935547  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.4690923690795898  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 609, 256])
m.shape torch.Size([529, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.4720706939697266  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.4720706939697266  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 529, 256]), torch.Size([1, 529, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.4730796813964844  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5237703323364258  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 529, 256])
m.shape torch.Size([448, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5267105102539062  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5267105102539062  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 448, 256]), torch.Size([1, 448, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5275650024414062  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5791130065917969  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 448, 256])
m.shape torch.Size([382, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5819902420043945  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5819902420043945  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 382, 256]), torch.Size([1, 382, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.582718849182129  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.6301603317260742  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 382, 256])
m.shape torch.Size([351, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.6331696510314941  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.6331696510314941  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 351, 256]), torch.Size([1, 351, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.6338391304016113  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.6821885108947754  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 351, 256])
m.shape torch.Size([300, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.685025691986084  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.685025691986084  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.6855978965759277  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7309002876281738  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([267, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.733694076538086  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.733694076538086  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7342033386230469  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.778151035308838  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([220, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7806453704833984  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7806453704833984  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7810649871826172  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8196697235107422  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([194, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.822070598602295  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.822070598602295  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8224406242370605  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8590731620788574  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([187, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.861584186553955  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.861584186553955  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.861940860748291  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8997483253479004  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([140, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9017229080200195  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9017229080200195  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9019899368286133  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.932164192199707  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([162, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.934678077697754  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.934678077697754  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9349870681762695  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9720659255981445  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([110, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.974198818206787  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.974198818206787  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9744086265563965  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.001054286956787  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([109, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0029401779174805  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0029401779174805  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.003148078918457  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0310068130493164  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([116, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.033133029937744  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.033133029937744  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0333542823791504  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0645508766174316  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([105, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0665597915649414  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0665597915649414  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0667600631713867  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.096400260925293  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([65, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.09767484664917  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.09767484664917  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0977988243103027  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.1170153617858887  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([73, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.11856746673584  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.11856746673584  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.118706703186035  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.141263008117676  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([68, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.1427621841430664  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.1427621841430664  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.1428918838500977  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.164811134338379  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([1004, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.188870906829834  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.188870906829834  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1004, 256]), torch.Size([1, 1004, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.1907858848571777  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.5331625938415527  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1004, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.4534592628479004  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.4554524421691895  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.4574456214904785  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.4553685188293457  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

torch.Size([11204, 40])
input nodes number: 21111
output nodes number: 11204
edges number: 91374
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.4556727409362793  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.4556732177734375  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.034511566162109375  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

pseudo mini batch 4 input nodes size: 42900
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.02966165542602539  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.02966165542602539  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.05011796951293945  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.0502018928527832  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.03363752365112305  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.03500795364379883  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.03500795364379883  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.03500795364379883  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

torch.Size([42900, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.03500795364379883  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

m.shape torch.Size([2985, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.0967717170715332  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.0967717170715332  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 2985, 128]), torch.Size([1, 2985, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.09961843490600586  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.12305593490600586  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 2985, 128])
m.shape torch.Size([3199, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.12468338012695312  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.12468338012695312  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 3199, 128]), torch.Size([1, 3199, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.12773418426513672  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.17384767532348633  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 3199, 128])
m.shape torch.Size([2598, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.17684173583984375  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.17684173583984375  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 2598, 128]), torch.Size([1, 2598, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.17963171005249023  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.23468923568725586  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 2598, 128])
m.shape torch.Size([2113, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.23802661895751953  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.23802661895751953  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 2113, 128]), torch.Size([1, 2113, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.2402935028076172  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.30258607864379883  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 2113, 128])
m.shape torch.Size([1725, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.30544376373291016  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.30544376373291016  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1725, 128]), torch.Size([1, 1725, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.30708885192871094  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.36858558654785156  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1725, 128])
m.shape torch.Size([1371, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.3716855049133301  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.3716855049133301  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1371, 128]), torch.Size([1, 1371, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.37299299240112305  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.43156003952026367  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1371, 128])
m.shape torch.Size([1131, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.43468141555786133  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.43468141555786133  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1131, 128]), torch.Size([1, 1131, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.4357600212097168  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.4902353286743164  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1131, 128])
m.shape torch.Size([1020, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.49358701705932617  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.49358701705932617  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1020, 128]), torch.Size([1, 1020, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.49455976486206055  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5500826835632324  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1020, 128])
m.shape torch.Size([839, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5535635948181152  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5535635948181152  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 839, 128]), torch.Size([1, 839, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5543637275695801  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.6065840721130371  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 839, 128])
m.shape torch.Size([5500, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.6324100494384766  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.6324100494384766  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 5500, 128]), torch.Size([1, 5500, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.6376552581787109  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.0100650787353516  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 5500, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.9590997695922852  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.9805841445922852  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.002023696899414  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.9803714752197266  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

torch.Size([22481, 256])
first layer input nodes number: 42900
first layer output nodes number: 22481
edges number: 121108
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.0023455619812012  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.02378511428833  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.0291452407836914  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.0291452407836914  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

m.shape torch.Size([2176, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.0920281410217285  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.0920281410217285  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 2176, 256]), torch.Size([1, 2176, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.0971627235412598  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.1328673362731934  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 2176, 256])
m.shape torch.Size([1927, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.1337566375732422  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.1337566375732422  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1927, 256]), torch.Size([1, 1927, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.1374320983886719  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.1925640106201172  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1927, 256])
m.shape torch.Size([1410, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.1947922706604004  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.1947922706604004  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1410, 256]), torch.Size([1, 1410, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.1976680755615234  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.2590861320495605  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1410, 256])
m.shape torch.Size([1099, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.2624359130859375  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.2624359130859375  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1099, 256]), torch.Size([1, 1099, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.26466703414917  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.3278679847717285  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1099, 256])
m.shape torch.Size([881, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.3310537338256836  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.3310537338256836  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 881, 256]), torch.Size([1, 881, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.3327341079711914  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.396681785583496  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 881, 256])
m.shape torch.Size([636, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.3995094299316406  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.3995094299316406  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 636, 256]), torch.Size([1, 636, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.4007225036621094  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.4533424377441406  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 636, 256])
m.shape torch.Size([473, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.455918312072754  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.455918312072754  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 473, 256]), torch.Size([1, 473, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.4568204879760742  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5020027160644531  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 473, 256])
m.shape torch.Size([430, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5048580169677734  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5048580169677734  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 430, 256]), torch.Size([1, 430, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5056781768798828  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5529308319091797  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 430, 256])
m.shape torch.Size([345, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5556721687316895  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5556721687316895  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 345, 256]), torch.Size([1, 345, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5563302040100098  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.5988068580627441  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 345, 256])
m.shape torch.Size([295, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.601313591003418  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.601313591003418  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.6018762588500977  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.6424074172973633  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([192, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.6441559791564941  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.6441559791564941  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.6445221900939941  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.6730866432189941  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([172, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.6748876571655273  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.6748876571655273  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.675215721130371  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7031011581420898  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([157, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7048988342285156  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7048988342285156  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7051982879638672  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.732748031616211  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([135, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7349615097045898  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7349615097045898  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7352190017700195  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7607107162475586  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([110, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7621679306030273  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7621679306030273  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7623777389526367  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7846174240112305  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([91, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.785912036895752  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.785912036895752  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.786085605621338  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8056988716125488  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([77, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.806870460510254  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.806870460510254  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8070173263549805  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.824641227722168  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([73, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8258309364318848  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8258309364318848  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.82597017288208  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8436532020568848  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([50, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.844496726989746  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.844496726989746  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8445920944213867  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8573713302612305  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([40, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8580927848815918  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8580927848815918  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8581690788269043  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8689265251159668  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([46, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8698172569274902  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8698172569274902  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8699049949645996  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.882890224456787  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8833751678466797  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8833751678466797  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8834228515625  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8908138275146484  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([29, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8914313316345215  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8914313316345215  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.891486644744873  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9004473686218262  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9011578559875488  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9011578559875488  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9012188911437988  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9115338325500488  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([338, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9196252822875977  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9196252822875977  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 338, 256]), torch.Size([1, 338, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9202699661254883  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.035348892211914  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 338, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.985663890838623  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.987501621246338  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9891767501831055  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9872550964355469  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

torch.Size([11239, 40])
input nodes number: 22481
output nodes number: 11239
edges number: 62670
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.987351417541504  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.987351894378662  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.037639617919921875  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

pseudo mini batch 5 input nodes size: 66801
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.03348207473754883  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.03348207473754883  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.06533527374267578  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.06541872024536133  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.044878482818603516  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.04715871810913086  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.04715871810913086  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.04715871810913086  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

torch.Size([66801, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.04715871810913086  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

m.shape torch.Size([2928, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.16086626052856445  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.16086626052856445  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 2928, 128]), torch.Size([1, 2928, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.16439390182495117  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.18728208541870117  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 2928, 128])
m.shape torch.Size([2908, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.1886591911315918  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.1886591911315918  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 2908, 128]), torch.Size([1, 2908, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.1920008659362793  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.23360013961791992  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 2908, 128])
m.shape torch.Size([2459, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.2363734245300293  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.2363734245300293  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 2459, 128]), torch.Size([1, 2459, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.2387385368347168  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.29132080078125  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 2459, 128])
m.shape torch.Size([2127, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.29443979263305664  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.29443979263305664  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 2127, 128]), torch.Size([1, 2127, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.2975587844848633  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.3589472770690918  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 2127, 128])
m.shape torch.Size([1950, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.363004207611084  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.363004207611084  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1950, 128]), torch.Size([1, 1950, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.36486387252807617  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.4318118095397949  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1950, 128])
m.shape torch.Size([1609, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.4354853630065918  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.4354853630065918  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1609, 128]), torch.Size([1, 1609, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.43701982498168945  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5030016899108887  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1609, 128])
m.shape torch.Size([1457, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5070977210998535  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5070977210998535  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1457, 128]), torch.Size([1, 1457, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5084872245788574  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5796136856079102  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1457, 128])
m.shape torch.Size([1345, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5840497016906738  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5840497016906738  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1345, 128]), torch.Size([1, 1345, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5853323936462402  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.6584458351135254  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1345, 128])
m.shape torch.Size([1152, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.6627483367919922  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.6627483367919922  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1152, 128]), torch.Size([1, 1152, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.6638469696044922  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.736060619354248  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1152, 128])
m.shape torch.Size([15199, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.807985782623291  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.807985782623291  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 15199, 128]), torch.Size([1, 15199, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.8224806785583496  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8516182899475098  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 15199, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.750171184539795  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7817702293395996  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8133692741394043  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.7815232276916504  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

torch.Size([33134, 256])
first layer input nodes number: 66801
first layer output nodes number: 33134
edges number: 227350
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8138689994812012  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.8454680442810059  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.853367805480957  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.853367805480957  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

m.shape torch.Size([2023, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.931201457977295  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.931201457977295  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 2023, 256]), torch.Size([1, 2023, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9354147911071777  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9666142463684082  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 2023, 256])
m.shape torch.Size([1642, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9684414863586426  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9684414863586426  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1642, 256]), torch.Size([1, 1642, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 1.9715886116027832  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.020637035369873  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1642, 256])
m.shape torch.Size([1238, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0222291946411133  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0222291946411133  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1238, 256]), torch.Size([1, 1238, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.024853229522705  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0807642936706543  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1238, 256])
m.shape torch.Size([938, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0835390090942383  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0835390090942383  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 938, 256]), torch.Size([1, 938, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.0853281021118164  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.144369125366211  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 938, 256])
m.shape torch.Size([812, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.1473770141601562  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.1473770141601562  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 812, 256]), torch.Size([1, 812, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.14892578125  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.2073822021484375  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 812, 256])
m.shape torch.Size([586, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.209987163543701  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.209987163543701  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 586, 256]), torch.Size([1, 586, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.2111048698425293  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.2599635124206543  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 586, 256])
m.shape torch.Size([501, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.262775421142578  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.262775421142578  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 501, 256]), torch.Size([1, 501, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.263731002807617  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.311929702758789  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 501, 256])
m.shape torch.Size([414, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.3146352767944336  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.3146352767944336  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 414, 256]), torch.Size([1, 414, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.315424919128418  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.361506462097168  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 414, 256])
m.shape torch.Size([323, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.363905906677246  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.363905906677246  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 323, 256]), torch.Size([1, 323, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.3645219802856445  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.4047718048095703  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 323, 256])
m.shape torch.Size([280, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.4071550369262695  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.4071550369262695  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.407689094543457  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.446791172027588  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 280, 256])
m.shape torch.Size([256, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.449230670928955  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.449230670928955  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.449718952178955  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.487804889678955  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([212, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.4900059700012207  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.4900059700012207  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.490410327911377  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.524780750274658  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([159, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.5265655517578125  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.5265655517578125  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.5268688201904297  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.554769515991211  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([137, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.5564613342285156  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.5564613342285156  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.556722640991211  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.582592010498047  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([120, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.5841917991638184  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.5841917991638184  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.584420680999756  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.608682155609131  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([108, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.6102285385131836  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.6102285385131836  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.6104345321655273  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.633711814880371  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([101, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.6352591514587402  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.6352591514587402  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.6354517936706543  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.658568859100342  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([100, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.6608991622924805  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.6608991622924805  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.6610898971557617  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.6853132247924805  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([89, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.6868433952331543  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.6868433952331543  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.6870131492614746  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.7097601890563965  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([86, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.7113285064697266  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.7113285064697266  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.7114925384521484  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.734621047973633  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([68, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.7359118461608887  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.7359118461608887  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.73604154586792  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.755237102508545  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([53, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.756293296813965  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.756293296813965  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.756394386291504  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.7720632553100586  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([42, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.7729415893554688  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.7729415893554688  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.773021697998047  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.785999298095703  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([55, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.7872281074523926  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.7872281074523926  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.7873330116271973  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.8050618171691895  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([837, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.8251209259033203  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.8251209259033203  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 837, 256]), torch.Size([1, 837, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.8267173767089844  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.1121788024902344  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 837, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.0469717979431152  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.048901081085205  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.050567150115967  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.0485544204711914  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

torch.Size([11180, 40])
input nodes number: 33134
output nodes number: 11180
edges number: 78481
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.048976421356201  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.0489768981933594  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.05148029327392578  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

pseudo mini batch 6 input nodes size: 68763
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.044970035552978516  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.044970035552978516  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.07817316055297852  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.07826042175292969  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.04632377624511719  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.05085325241088867  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.05085325241088867  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.05085325241088867  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

torch.Size([68763, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.05085325241088867  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

m.shape torch.Size([1866, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.22143077850341797  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.22143077850341797  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1866, 128]), torch.Size([1, 1866, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.22321033477783203  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.2380838394165039  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1866, 128])
m.shape torch.Size([1935, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.23903942108154297  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.23903942108154297  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1935, 128]), torch.Size([1, 1935, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.24088478088378906  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.26856517791748047  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1935, 128])
m.shape torch.Size([1857, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.27029895782470703  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.27029895782470703  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1857, 128]), torch.Size([1, 1857, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.27206993103027344  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.3111233711242676  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1857, 128])
m.shape torch.Size([1748, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.3135719299316406  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.3135719299316406  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1748, 128]), torch.Size([1, 1748, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.31523895263671875  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.3645896911621094  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1748, 128])
m.shape torch.Size([1654, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.36769962310791016  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.36769962310791016  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1654, 128]), torch.Size([1, 1654, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.3692770004272461  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.4264259338378906  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1654, 128])
m.shape torch.Size([1598, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.4302091598510742  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.4302091598510742  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1598, 128]), torch.Size([1, 1598, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.4317331314086914  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.49726390838623047  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1598, 128])
m.shape torch.Size([1519, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5015721321105957  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5015721321105957  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1519, 128]), torch.Size([1, 1519, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5030207633972168  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5758566856384277  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1519, 128])
m.shape torch.Size([1430, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5805873870849609  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5805873870849609  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1430, 128]), torch.Size([1, 1430, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.5819511413574219  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.660642147064209  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1430, 128])
m.shape torch.Size([1404, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.6659855842590332  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.6659855842590332  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1404, 128]), torch.Size([1, 1404, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.6673245429992676  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.7553753852844238  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1404, 128])
m.shape torch.Size([27605, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.8863368034362793  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.8863368034362793  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 27605, 128]), torch.Size([1, 27605, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 0.9126629829406738  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.7830519676208496  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 27605, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.6239867210388184  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.664628505706787  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.705270290374756  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.664310932159424  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

torch.Size([42616, 256])
first layer input nodes number: 68763
first layer output nodes number: 42616
edges number: 346916
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.7065324783325195  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.7471742630004883  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.758082389831543  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.758082389831543  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

m.shape torch.Size([1203, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.897587776184082  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.897587776184082  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1203, 256]), torch.Size([1, 1203, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.900038719177246  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.91947078704834  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1203, 256])
m.shape torch.Size([987, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.9199929237365723  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.9199929237365723  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 987, 256]), torch.Size([1, 987, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.921875476837158  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.9501137733459473  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 987, 256])
m.shape torch.Size([829, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.951735019683838  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.951735019683838  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 829, 256]), torch.Size([1, 829, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.9533162117004395  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.988570213317871  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 829, 256])
m.shape torch.Size([669, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.9903955459594727  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.9903955459594727  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 669, 256]), torch.Size([1, 669, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 2.991671562194824  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.02960205078125  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 669, 256])
m.shape torch.Size([581, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.0317564010620117  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.0317564010620117  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 581, 256]), torch.Size([1, 581, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.032864570617676  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.072758674621582  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 581, 256])
m.shape torch.Size([472, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.0749268531799316  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.0749268531799316  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 472, 256]), torch.Size([1, 472, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.075827121734619  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.118490219116211  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 472, 256])
m.shape torch.Size([404, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.120758533477783  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.120758533477783  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.1215291023254395  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.1617488861083984  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([322, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.163839817047119  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.163839817047119  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 322, 256]), torch.Size([1, 322, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.1644539833068848  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.200660228729248  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 322, 256])
m.shape torch.Size([348, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.2033634185791016  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.2033634185791016  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 348, 256]), torch.Size([1, 348, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.2040271759033203  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.248067855834961  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 348, 256])
m.shape torch.Size([306, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.2506771087646484  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.2506771087646484  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.251260757446289  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.2936649322509766  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([276, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.2962913513183594  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.2962913513183594  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.2968177795410156  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.3386611938476562  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([277, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.341592788696289  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.341592788696289  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.342121124267578  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.3886241912841797  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 277, 256])
m.shape torch.Size([249, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.3914713859558105  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.3914713859558105  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.391946315765381  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.4356398582458496  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([200, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.438093662261963  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.438093662261963  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.4384751319885254  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.476240634918213  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([197, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.4788904190063477  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.4788904190063477  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.4792661666870117  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.5190954208374023  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([178, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.5216450691223145  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.5216450691223145  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.521984577178955  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.5603489875793457  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([169, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.5629405975341797  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.5629405975341797  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.563262939453125  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.6019439697265625  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([179, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.604879856109619  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.604879856109619  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.6052212715148926  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.648581027984619  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([167, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.6514601707458496  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.6514601707458496  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.6517786979675293  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.6944613456726074  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([159, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.6973586082458496  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.6973586082458496  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.697661876678467  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.7404227256774902  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([157, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.7434401512145996  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.7434401512145996  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.743739604949951  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.7880587577819824  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([100, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.7900238037109375  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.7900238037109375  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.7902145385742188  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.8197784423828125  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([120, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.822336196899414  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.822336196899414  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.8225650787353516  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.8596439361572266  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([119, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.862274646759033  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.862274646759033  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.862501621246338  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.90086030960083  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([3041, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.973816394805908  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.973816394805908  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 3041, 256]), torch.Size([1, 3041, 256])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 3.979616641998291  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 5.0015339851379395  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 3041, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 4.8727922439575195  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 4.874922752380371  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 4.877053260803223  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 4.87483549118042  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

torch.Size([11709, 40])
input nodes number: 42616
output nodes number: 11709
edges number: 143459
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 4.875441551208496  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 4.875442028045654  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.05745983123779297  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

pseudo mini batch 7 input nodes size: 81255
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.046525001525878906  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.046525001525878906  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.08527040481567383  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.08535289764404297  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.0520625114440918  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.05557680130004883  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.05557680130004883  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.05557680130004883  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

torch.Size([81255, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.05557680130004883  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

m.shape torch.Size([2456, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.23403310775756836  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.23403310775756836  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 2456, 128]), torch.Size([1, 2456, 128])
----------------------------------------3
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.2363753318786621  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.2558012008666992  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 2456, 128])
m.shape torch.Size([2655, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.25716209411621094  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.25716209411621094  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 2655, 128]), torch.Size([1, 2655, 128])
----------------------------------------3
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.25969409942626953  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.2979612350463867  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 2655, 128])
m.shape torch.Size([2378, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.30023908615112305  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.30023908615112305  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 2378, 128]), torch.Size([1, 2378, 128])
----------------------------------------3
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.30258893966674805  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.35262107849121094  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 2378, 128])
m.shape torch.Size([2096, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.35602283477783203  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.35602283477783203  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 2096, 128]), torch.Size([1, 2096, 128])
----------------------------------------3
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.35810136795043945  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.41898488998413086  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 2096, 128])
m.shape torch.Size([2031, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.4221487045288086  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.4221487045288086  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 2031, 128]), torch.Size([1, 2031, 128])
----------------------------------------3
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.4240856170654297  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.49474143981933594  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 2031, 128])
m.shape torch.Size([1764, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.499697208404541  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.499697208404541  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1764, 128]), torch.Size([1, 1764, 128])
----------------------------------------3
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.5013794898986816  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.5745720863342285  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1764, 128])
m.shape torch.Size([1730, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.579505443572998  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.579505443572998  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1730, 128]), torch.Size([1, 1730, 128])
----------------------------------------3
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.5811553001403809  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.6645503044128418  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1730, 128])
m.shape torch.Size([1592, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.6697983741760254  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.6697983741760254  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1592, 128]), torch.Size([1, 1592, 128])
----------------------------------------3
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.6713166236877441  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.7586426734924316  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1592, 128])
m.shape torch.Size([1562, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.7652688026428223  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.7652688026428223  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1562, 128]), torch.Size([1, 1562, 128])
----------------------------------------3
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.7667584419250488  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.8622021675109863  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1562, 128])
m.shape torch.Size([27758, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.9938178062438965  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.9938178062438965  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 27758, 128]), torch.Size([1, 27758, 128])
----------------------------------------3
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 1.0202898979187012  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 2.899824619293213  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 27758, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 2.7357664108276367  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 2.779656410217285  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 2.8235464096069336  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 2.779313087463379  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

torch.Size([46022, 256])
first layer input nodes number: 81255
first layer output nodes number: 46022
edges number: 360507
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 2.8241539001464844  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 2.868043899536133  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 2.879016399383545  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 2.879016399383545  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

m.shape torch.Size([1540, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 2.9877161979675293  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 2.9877161979675293  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1540, 256]), torch.Size([1, 1540, 256])
----------------------------------------3
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 2.991027355194092  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.017324924468994  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1540, 256])
m.shape torch.Size([1313, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.0186104774475098  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.0186104774475098  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 1313, 256]), torch.Size([1, 1313, 256])
----------------------------------------3
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.021188735961914  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.065669059753418  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 1313, 256])
m.shape torch.Size([957, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.067126750946045  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.067126750946045  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 957, 256]), torch.Size([1, 957, 256])
----------------------------------------3
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.0689520835876465  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.109109401702881  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 957, 256])
m.shape torch.Size([729, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.110999584197998  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.110999584197998  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 729, 256]), torch.Size([1, 729, 256])
----------------------------------------3
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.1123900413513184  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.157113552093506  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 729, 256])
m.shape torch.Size([661, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.1599574089050293  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.1599574089050293  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 661, 256]), torch.Size([1, 661, 256])
----------------------------------------3
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.1612181663513184  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.2077126502990723  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 661, 256])
m.shape torch.Size([479, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.2098445892333984  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.2098445892333984  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 479, 256]), torch.Size([1, 479, 256])
----------------------------------------3
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.2107582092285156  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.2512855529785156  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 479, 256])
m.shape torch.Size([403, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.253540515899658  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.253540515899658  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 403, 256]), torch.Size([1, 403, 256])
----------------------------------------3
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.2543091773986816  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.2938475608825684  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 403, 256])
m.shape torch.Size([347, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.2961316108703613  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.2961316108703613  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 347, 256]), torch.Size([1, 347, 256])
----------------------------------------3
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.2967934608459473  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.33494234085083  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 347, 256])
m.shape torch.Size([300, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.3372068405151367  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.3372068405151367  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.3377790451049805  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.374913215637207  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([290, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.3774147033691406  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.3774147033691406  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.3779678344726562  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.41799259185791  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 290, 256])
m.shape torch.Size([252, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.4203805923461914  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.4203805923461914  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.42086124420166  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.4583520889282227  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([212, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.460556983947754  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.460556983947754  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.46096134185791  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.4953317642211914  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([182, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.497403621673584  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.497403621673584  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.497750759124756  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.5296874046325684  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([168, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.5317745208740234  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.5317745208740234  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.532094955444336  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.5638179779052734  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([162, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.565993309020996  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.565993309020996  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.5663022994995117  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.599055290222168  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([140, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.6010537147521973  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.6010537147521973  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.601320743560791  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.6314949989318848  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([129, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.6335678100585938  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.6335678100585938  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.6338138580322266  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.663339614868164  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([138, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.6656041145324707  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.6656041145324707  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.665867328643799  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.6992955207824707  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([118, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.7013192176818848  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.7013192176818848  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.7015442848205566  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.731703281402588  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([109, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.7336864471435547  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.7336864471435547  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.7338943481445312  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.7632083892822266  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([100, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.765122890472412  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.765122890472412  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.7653136253356934  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.7935423851013184  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([89, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.7953290939331055  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.7953290939331055  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.795498847961426  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.821810722351074  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([74, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.823361873626709  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.823361873626709  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes
Using backend: pytorch

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.823503017425537  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.8463683128356934  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([78, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.848097324371338  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.848097324371338  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.8482460975646973  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.8733887672424316  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([2093, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.923605442047119  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.923605442047119  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

 h.shape torch.Size([1, 2093, 256]), torch.Size([1, 2093, 256])
----------------------------------------3
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 3.9284348487854004  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 4.63187837600708  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

rst.shape  torch.Size([1, 2093, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 4.531918525695801  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 4.53359317779541  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 4.535772323608398  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 4.53401517868042  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

torch.Size([11063, 40])
input nodes number: 46022
output nodes number: 11063
edges number: 111089
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 4.533985137939453  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 4.533985614776611  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.062195777893066406  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.062195777893066406  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.062195777893066406  GigaBytes
Max Memory Allocated: 5.141218185424805  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01750040054321289 |0.0023750662803649902 |0.12057626247406006 |9.754300117492676e-05 |0.09723320603370667 |0.004712820053100586 |
----------------------------------------------------------pseudo_mini_loss sum 3.64129376411438
Total (block generation + training)time/epoch 24.736347556114197
Training time/epoch 1.9596383571624756
Training time without block to device /epoch 1.9406378269195557
Training time without total dataloading part /epoch 1.7479689121246338
load block tensor time/epoch 0.14000320434570312
block to device time/epoch 0.019000530242919922
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  654160
Number of first layer input nodes during this epoch:  419797
Number of first layer output nodes during this epoch:  234363
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
