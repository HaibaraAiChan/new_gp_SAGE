[05:11:50] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28387380 edges into 8 parts and get 4655631 edge cuts
main start at this time 1651554689.181377
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.024759531021118164
global_2_local spend time (sec) 0.035390615463256836
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004430294036865234
A = g.adjacency_matrix() spent  0.007746219635009766
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0818328857421875
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.2938389778137207
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1627411842346191

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])
drop edges based on redundancy f4

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366})
Convert a graph into a bidirected graph: 1.197 seconds
Metis partitioning: 5.072 seconds
Split the graph: 1.715 seconds
Construct subgraphs: 0.148 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  8.14603853225708
11364
11402
11609
11551
11592
11144
11035
11244
total k batches seeds list generation spend  18.852161169052124
after graph partition
graph partition algorithm spend time 18.939796924591064
11364
11402
11609
11551
11592
11144
11035
11244
partition_len_list
[19891, 20653, 21157, 24924, 26374, 34439, 47909, 41454]
shared_neighbor_graph_partition_s0 selection method  spend 19.02376413345337
time for parepare:  0.018072843551635742
local_output_nid generation:  0.0019388198852539062
local_in_edges_tensor generation:  0.002218008041381836
mini_batch_src_global generation:  0.0038034915924072266
r_  generation:  0.03161954879760742
local_output_nid generation:  0.002480030059814453
local_in_edges_tensor generation:  0.0021123886108398438
mini_batch_src_global generation:  0.0038073062896728516
r_  generation:  0.030608177185058594
local_output_nid generation:  0.0025343894958496094
local_in_edges_tensor generation:  0.0020279884338378906
mini_batch_src_global generation:  0.0032892227172851562
r_  generation:  0.02612590789794922
local_output_nid generation:  0.0025844573974609375
local_in_edges_tensor generation:  0.002034902572631836
mini_batch_src_global generation:  0.002782583236694336
r_  generation:  0.029097318649291992
local_output_nid generation:  0.002498626708984375
local_in_edges_tensor generation:  0.002147674560546875
mini_batch_src_global generation:  0.002637147903442383
r_  generation:  0.02867913246154785
local_output_nid generation:  0.0025434494018554688
local_in_edges_tensor generation:  0.0023005008697509766
mini_batch_src_global generation:  0.0029435157775878906
r_  generation:  0.030996322631835938
local_output_nid generation:  0.0025835037231445312
local_in_edges_tensor generation:  0.002167940139770508
mini_batch_src_global generation:  0.0039327144622802734
r_  generation:  0.038926124572753906
local_output_nid generation:  0.0027904510498046875
local_in_edges_tensor generation:  0.002744436264038086
mini_batch_src_global generation:  0.0071637630462646484
r_  generation:  0.04382205009460449
----------------------check_connections_block total spend ----------------------------- 0.41161227226257324
generate_one_block  0.04089808464050293
generate_one_block  0.03730058670043945
generate_one_block  0.03321647644042969
generate_one_block  0.03648495674133301
generate_one_block  0.034453392028808594
generate_one_block  0.04095792770385742
generate_one_block  0.05365109443664551
generate_one_block  0.06995463371276855
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.047272682189941406
gen group dst list time:  0.00666356086730957
time for parepare:  0.022124767303466797
local_output_nid generation:  0.0033960342407226562
local_in_edges_tensor generation:  0.0226590633392334
mini_batch_src_global generation:  0.006670951843261719
r_  generation:  0.04307818412780762
local_output_nid generation:  0.007758140563964844
local_in_edges_tensor generation:  0.005244255065917969
mini_batch_src_global generation:  0.004798412322998047
r_  generation:  0.044483184814453125
local_output_nid generation:  0.008333683013916016
local_in_edges_tensor generation:  0.005162239074707031
mini_batch_src_global generation:  0.0036897659301757812
r_  generation:  0.04338431358337402
local_output_nid generation:  0.009824991226196289
local_in_edges_tensor generation:  0.006608724594116211
mini_batch_src_global generation:  0.0059108734130859375
r_  generation:  0.06157803535461426
local_output_nid generation:  0.01167917251586914
local_in_edges_tensor generation:  0.006577730178833008
mini_batch_src_global generation:  0.011478900909423828
r_  generation:  0.06090545654296875
local_output_nid generation:  0.013123273849487305
local_in_edges_tensor generation:  0.010771751403808594
mini_batch_src_global generation:  0.028781652450561523
r_  generation:  0.09199190139770508
local_output_nid generation:  0.015043020248413086
local_in_edges_tensor generation:  0.013964176177978516
mini_batch_src_global generation:  0.019588232040405273
r_  generation:  0.1453697681427002
local_output_nid generation:  0.010549545288085938
local_in_edges_tensor generation:  0.01878643035888672
mini_batch_src_global generation:  0.017812490463256836
r_  generation:  0.13507676124572754
----------------------check_connections_block total spend ----------------------------- 1.0774433612823486
generate_one_block  0.06571698188781738
generate_one_block  0.05511331558227539
generate_one_block  0.05263829231262207
generate_one_block  0.07313990592956543
generate_one_block  0.09562873840332031
generate_one_block  0.11594820022583008
generate_one_block  0.1758732795715332
generate_one_block  0.16212725639343262
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  1.0774433612823486
block generation total time  0.7961859703063965
average batch blocks generation time:  0.09952324628829956
pseudo mini batch 0 input nodes size: 34225
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.019097328186035156  GigaBytes
Max Memory Allocated: 0.019097328186035156  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.019182205200195312  GigaBytes
Max Memory Allocated: 0.019182205200195312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.019182205200195312  GigaBytes
Max Memory Allocated: 0.019182205200195312  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.02082347869873047  GigaBytes
Max Memory Allocated: 0.02082347869873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.02082347869873047  GigaBytes
Max Memory Allocated: 0.02082347869873047  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.02082347869873047  GigaBytes
Max Memory Allocated: 0.02082347869873047  GigaBytes

torch.Size([34225, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.02082347869873047  GigaBytes
Max Memory Allocated: 0.02082347869873047  GigaBytes

m.shape torch.Size([1786, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.08391475677490234  GigaBytes
Max Memory Allocated: 0.08489656448364258  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.08391475677490234  GigaBytes
Max Memory Allocated: 0.08489656448364258  GigaBytes

 h.shape torch.Size([1, 1786, 128]), torch.Size([1, 1786, 128])
----------------------------------------3
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0856180191040039  GigaBytes
Max Memory Allocated: 0.0856180191040039  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0992441177368164  GigaBytes
Max Memory Allocated: 0.10009574890136719  GigaBytes

rst.shape  torch.Size([1, 1786, 128])
m.shape torch.Size([1953, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.10025501251220703  GigaBytes
Max Memory Allocated: 0.10029935836791992  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.10025501251220703  GigaBytes
Max Memory Allocated: 0.10029935836791992  GigaBytes

 h.shape torch.Size([1, 1953, 128]), torch.Size([1, 1953, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.10211753845214844  GigaBytes
Max Memory Allocated: 0.10211753845214844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.13096141815185547  GigaBytes
Max Memory Allocated: 0.13282394409179688  GigaBytes

rst.shape  torch.Size([1, 1953, 128])
m.shape torch.Size([1830, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.13264799118041992  GigaBytes
Max Memory Allocated: 0.13282394409179688  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.13264799118041992  GigaBytes
Max Memory Allocated: 0.13282394409179688  GigaBytes

 h.shape torch.Size([1, 1830, 128]), torch.Size([1, 1830, 128])
----------------------------------------3
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.13439321517944336  GigaBytes
Max Memory Allocated: 0.13439321517944336  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.17278814315795898  GigaBytes
Max Memory Allocated: 0.17540597915649414  GigaBytes

rst.shape  torch.Size([1, 1830, 128])
m.shape torch.Size([1632, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.17502832412719727  GigaBytes
Max Memory Allocated: 0.17540597915649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.17502832412719727  GigaBytes
Max Memory Allocated: 0.17540597915649414  GigaBytes

 h.shape torch.Size([1, 1632, 128]), torch.Size([1, 1632, 128])
----------------------------------------3
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.17658472061157227  GigaBytes
Max Memory Allocated: 0.17658472061157227  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.22342920303344727  GigaBytes
Max Memory Allocated: 0.22654199600219727  GigaBytes

rst.shape  torch.Size([1, 1632, 128])
m.shape torch.Size([1366, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.2259078025817871  GigaBytes
Max Memory Allocated: 0.22654199600219727  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.2259078025817871  GigaBytes
Max Memory Allocated: 0.22654199600219727  GigaBytes

 h.shape torch.Size([1, 1366, 128]), torch.Size([1, 1366, 128])
----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.22721052169799805  GigaBytes
Max Memory Allocated: 0.22721052169799805  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.2747502326965332  GigaBytes
Max Memory Allocated: 0.27800703048706055  GigaBytes

rst.shape  torch.Size([1, 1366, 128])
m.shape torch.Size([1272, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.277738094329834  GigaBytes
Max Memory Allocated: 0.27800703048706055  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.277738094329834  GigaBytes
Max Memory Allocated: 0.27800703048706055  GigaBytes

 h.shape torch.Size([1, 1272, 128]), torch.Size([1, 1272, 128])
----------------------------------------3
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.27895116806030273  GigaBytes
Max Memory Allocated: 0.27895116806030273  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5330810546875 GB
    Memory Allocated: 0.332242488861084  GigaBytes
Max Memory Allocated: 0.33588171005249023  GigaBytes

rst.shape  torch.Size([1, 1272, 128])
m.shape torch.Size([1095, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5330810546875 GB
    Memory Allocated: 0.33529090881347656  GigaBytes
Max Memory Allocated: 0.33588171005249023  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5330810546875 GB
    Memory Allocated: 0.33529090881347656  GigaBytes
Max Memory Allocated: 0.33588171005249023  GigaBytes

 h.shape torch.Size([1, 1095, 128]), torch.Size([1, 1095, 128])
----------------------------------------3
 Nvidia-smi: 1.5330810546875 GB
    Memory Allocated: 0.3363351821899414  GigaBytes
Max Memory Allocated: 0.3363351821899414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.3900175094604492  GigaBytes
Max Memory Allocated: 0.39367246627807617  GigaBytes

rst.shape  torch.Size([1, 1095, 128])
m.shape torch.Size([981, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.3932375907897949  GigaBytes
Max Memory Allocated: 0.39367246627807617  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.3932375907897949  GigaBytes
Max Memory Allocated: 0.39367246627807617  GigaBytes

 h.shape torch.Size([1, 981, 128]), torch.Size([1, 981, 128])
----------------------------------------3
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.39417314529418945  GigaBytes
Max Memory Allocated: 0.39417314529418945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.4489130973815918  GigaBytes
Max Memory Allocated: 0.4526553153991699  GigaBytes

rst.shape  torch.Size([1, 981, 128])
m.shape torch.Size([838, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.4520416259765625  GigaBytes
Max Memory Allocated: 0.4526553153991699  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.4520416259765625  GigaBytes
Max Memory Allocated: 0.4526553153991699  GigaBytes

 h.shape torch.Size([1, 838, 128]), torch.Size([1, 838, 128])
----------------------------------------3
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.45284080505371094  GigaBytes
Max Memory Allocated: 0.45284080505371094  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7186279296875 GB
    Memory Allocated: 0.5047488212585449  GigaBytes
Max Memory Allocated: 0.5083451271057129  GigaBytes

rst.shape  torch.Size([1, 838, 128])
m.shape torch.Size([7138, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.5383858680725098  GigaBytes
Max Memory Allocated: 0.5391840934753418  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.5383858680725098  GigaBytes
Max Memory Allocated: 0.5391840934753418  GigaBytes

 h.shape torch.Size([1, 7138, 128]), torch.Size([1, 7138, 128])
----------------------------------------3
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.5451931953430176  GigaBytes
Max Memory Allocated: 0.5451931953430176  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2967529296875 GB
    Memory Allocated: 1.030972957611084  GigaBytes
Max Memory Allocated: 1.065009593963623  GigaBytes

rst.shape  torch.Size([1, 7138, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2967529296875 GB
    Memory Allocated: 0.9761295318603516  GigaBytes
Max Memory Allocated: 1.065009593963623  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2967529296875 GB
    Memory Allocated: 0.9950990676879883  GigaBytes
Max Memory Allocated: 1.065009593963623  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2967529296875 GB
    Memory Allocated: 1.014068603515625  GigaBytes
Max Memory Allocated: 1.065009593963623  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2967529296875 GB
    Memory Allocated: 0.9949507713317871  GigaBytes
Max Memory Allocated: 1.065009593963623  GigaBytes

torch.Size([19891, 256])
first layer input nodes number: 34225
first layer output nodes number: 19891
edges number: 126607
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2967529296875 GB
    Memory Allocated: 1.0143256187438965  GigaBytes
Max Memory Allocated: 1.065009593963623  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2967529296875 GB
    Memory Allocated: 1.0332951545715332  GigaBytes
Max Memory Allocated: 1.065009593963623  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 1.0385994911193848  GigaBytes
Max Memory Allocated: 1.065009593963623  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 1.0385994911193848  GigaBytes
Max Memory Allocated: 1.065009593963623  GigaBytes

m.shape torch.Size([1383, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.4061279296875 GB
    Memory Allocated: 1.1309099197387695  GigaBytes
Max Memory Allocated: 1.131009578704834  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4061279296875 GB
    Memory Allocated: 1.1309099197387695  GigaBytes
Max Memory Allocated: 1.131009578704834  GigaBytes

 h.shape torch.Size([1, 1383, 256]), torch.Size([1, 1383, 256])
----------------------------------------3
 Nvidia-smi: 2.4061279296875 GB
    Memory Allocated: 1.1335477828979492  GigaBytes
Max Memory Allocated: 1.1335477828979492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4061279296875 GB
    Memory Allocated: 1.1554646492004395  GigaBytes
Max Memory Allocated: 1.1567835807800293  GigaBytes

rst.shape  torch.Size([1, 1383, 256])
m.shape torch.Size([1322, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.4061279296875 GB
    Memory Allocated: 1.1566872596740723  GigaBytes
Max Memory Allocated: 1.1567835807800293  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4061279296875 GB
    Memory Allocated: 1.1566872596740723  GigaBytes
Max Memory Allocated: 1.1567835807800293  GigaBytes

 h.shape torch.Size([1, 1322, 256]), torch.Size([1, 1322, 256])
----------------------------------------3
 Nvidia-smi: 2.4061279296875 GB
    Memory Allocated: 1.159299373626709  GigaBytes
Max Memory Allocated: 1.159299373626709  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4256591796875 GB
    Memory Allocated: 1.1984319686889648  GigaBytes
Max Memory Allocated: 1.200953483581543  GigaBytes

rst.shape  torch.Size([1, 1322, 256])
m.shape torch.Size([1125, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.4256591796875 GB
    Memory Allocated: 1.2009787559509277  GigaBytes
Max Memory Allocated: 1.2009916305541992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4256591796875 GB
    Memory Allocated: 1.2009787559509277  GigaBytes
Max Memory Allocated: 1.2009916305541992  GigaBytes

 h.shape torch.Size([1, 1125, 256]), torch.Size([1, 1125, 256])
----------------------------------------3
 Nvidia-smi: 2.4256591796875 GB
    Memory Allocated: 1.2032017707824707  GigaBytes
Max Memory Allocated: 1.2032017707824707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4647216796875 GB
    Memory Allocated: 1.2517390251159668  GigaBytes
Max Memory Allocated: 1.254957675933838  GigaBytes

rst.shape  torch.Size([1, 1125, 256])
m.shape torch.Size([948, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.4647216796875 GB
    Memory Allocated: 1.2541451454162598  GigaBytes
Max Memory Allocated: 1.254957675933838  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4647216796875 GB
    Memory Allocated: 1.2541451454162598  GigaBytes
Max Memory Allocated: 1.254957675933838  GigaBytes

 h.shape torch.Size([1, 948, 256]), torch.Size([1, 948, 256])
----------------------------------------3
 Nvidia-smi: 2.4647216796875 GB
    Memory Allocated: 1.255953311920166  GigaBytes
Max Memory Allocated: 1.255953311920166  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 1.3084893226623535  GigaBytes
Max Memory Allocated: 1.312105655670166  GigaBytes

rst.shape  torch.Size([1, 948, 256])
m.shape torch.Size([775, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 1.311309814453125  GigaBytes
Max Memory Allocated: 1.312105655670166  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 1.311309814453125  GigaBytes
Max Memory Allocated: 1.312105655670166  GigaBytes

 h.shape torch.Size([1, 775, 256]), torch.Size([1, 775, 256])
----------------------------------------3
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 1.3127880096435547  GigaBytes
Max Memory Allocated: 1.3127880096435547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 1.3660030364990234  GigaBytes
Max Memory Allocated: 1.3696985244750977  GigaBytes

rst.shape  torch.Size([1, 775, 256])
m.shape torch.Size([715, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 1.3693876266479492  GigaBytes
Max Memory Allocated: 1.3696985244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 1.3693876266479492  GigaBytes
Max Memory Allocated: 1.3696985244750977  GigaBytes

 h.shape torch.Size([1, 715, 256]), torch.Size([1, 715, 256])
----------------------------------------3
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 1.3707513809204102  GigaBytes
Max Memory Allocated: 1.3707513809204102  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6502685546875 GB
    Memory Allocated: 1.431157112121582  GigaBytes
Max Memory Allocated: 1.4352483749389648  GigaBytes

rst.shape  torch.Size([1, 715, 256])
m.shape torch.Size([569, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.6502685546875 GB
    Memory Allocated: 1.4343037605285645  GigaBytes
Max Memory Allocated: 1.4352483749389648  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6502685546875 GB
    Memory Allocated: 1.4343037605285645  GigaBytes
Max Memory Allocated: 1.4352483749389648  GigaBytes

 h.shape torch.Size([1, 569, 256]), torch.Size([1, 569, 256])
----------------------------------------3
 Nvidia-smi: 2.6502685546875 GB
    Memory Allocated: 1.4353890419006348  GigaBytes
Max Memory Allocated: 1.4353890419006348  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7147216796875 GB
    Memory Allocated: 1.4898476600646973  GigaBytes
Max Memory Allocated: 1.4936461448669434  GigaBytes

rst.shape  torch.Size([1, 569, 256])
m.shape torch.Size([483, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.7147216796875 GB
    Memory Allocated: 1.4930191040039062  GigaBytes
Max Memory Allocated: 1.4936461448669434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7147216796875 GB
    Memory Allocated: 1.4930191040039062  GigaBytes
Max Memory Allocated: 1.4936461448669434  GigaBytes

 h.shape torch.Size([1, 483, 256]), torch.Size([1, 483, 256])
----------------------------------------3
 Nvidia-smi: 2.7147216796875 GB
    Memory Allocated: 1.4939403533935547  GigaBytes
Max Memory Allocated: 1.4939403533935547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7615966796875 GB
    Memory Allocated: 1.5478782653808594  GigaBytes
Max Memory Allocated: 1.5515632629394531  GigaBytes

rst.shape  torch.Size([1, 483, 256])
m.shape torch.Size([445, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.7615966796875 GB
    Memory Allocated: 1.551267147064209  GigaBytes
Max Memory Allocated: 1.5515632629394531  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7615966796875 GB
    Memory Allocated: 1.551267147064209  GigaBytes
Max Memory Allocated: 1.5515632629394531  GigaBytes

 h.shape torch.Size([1, 445, 256]), torch.Size([1, 445, 256])
----------------------------------------3
 Nvidia-smi: 2.7615966796875 GB
    Memory Allocated: 1.5521159172058105  GigaBytes
Max Memory Allocated: 1.5521159172058105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8299560546875 GB
    Memory Allocated: 1.6082491874694824  GigaBytes
Max Memory Allocated: 1.6120686531066895  GigaBytes

rst.shape  torch.Size([1, 445, 256])
m.shape torch.Size([375, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.8299560546875 GB
    Memory Allocated: 1.611429214477539  GigaBytes
Max Memory Allocated: 1.6120686531066895  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8299560546875 GB
    Memory Allocated: 1.611429214477539  GigaBytes
Max Memory Allocated: 1.6120686531066895  GigaBytes

 h.shape torch.Size([1, 375, 256]), torch.Size([1, 375, 256])
----------------------------------------3
 Nvidia-smi: 2.8299560546875 GB
    Memory Allocated: 1.6121444702148438  GigaBytes
Max Memory Allocated: 1.6121444702148438  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 1.663900375366211  GigaBytes
Max Memory Allocated: 1.6674766540527344  GigaBytes

rst.shape  torch.Size([1, 375, 256])
m.shape torch.Size([349, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 1.6672325134277344  GigaBytes
Max Memory Allocated: 1.6674766540527344  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 1.6672325134277344  GigaBytes
Max Memory Allocated: 1.6674766540527344  GigaBytes

 h.shape torch.Size([1, 349, 256]), torch.Size([1, 349, 256])
----------------------------------------3
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 1.667898178100586  GigaBytes
Max Memory Allocated: 1.667898178100586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9412841796875 GB
    Memory Allocated: 1.7214698791503906  GigaBytes
Max Memory Allocated: 1.7251310348510742  GigaBytes

rst.shape  torch.Size([1, 349, 256])
m.shape torch.Size([294, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.9412841796875 GB
    Memory Allocated: 1.7247190475463867  GigaBytes
Max Memory Allocated: 1.7251310348510742  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9412841796875 GB
    Memory Allocated: 1.7247190475463867  GigaBytes
Max Memory Allocated: 1.7251310348510742  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 2.9412841796875 GB
    Memory Allocated: 1.7252798080444336  GigaBytes
Max Memory Allocated: 1.7252798080444336  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9881591796875 GB
    Memory Allocated: 1.7741293907165527  GigaBytes
Max Memory Allocated: 1.777493953704834  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([258, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.9881591796875 GB
    Memory Allocated: 1.7770729064941406  GigaBytes
Max Memory Allocated: 1.777493953704834  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9881591796875 GB
    Memory Allocated: 1.7770729064941406  GigaBytes
Max Memory Allocated: 1.777493953704834  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 2.9881591796875 GB
    Memory Allocated: 1.7775650024414062  GigaBytes
Max Memory Allocated: 1.7775650024414062  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.8245010375976562  GigaBytes
Max Memory Allocated: 1.8276996612548828  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([217, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.8271751403808594  GigaBytes
Max Memory Allocated: 1.8276996612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.8271751403808594  GigaBytes
Max Memory Allocated: 1.8276996612548828  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.8275890350341797  GigaBytes
Max Memory Allocated: 1.8276996612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.8685646057128906  GigaBytes
Max Memory Allocated: 1.8714618682861328  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([168, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.8707799911499023  GigaBytes
Max Memory Allocated: 1.8714618682861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.8707799911499023  GigaBytes
Max Memory Allocated: 1.8714618682861328  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.8711004257202148  GigaBytes
Max Memory Allocated: 1.8714618682861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1072998046875 GB
    Memory Allocated: 1.9050664901733398  GigaBytes
Max Memory Allocated: 1.9074697494506836  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([174, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.1072998046875 GB
    Memory Allocated: 1.9075822830200195  GigaBytes
Max Memory Allocated: 1.9075927734375  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1072998046875 GB
    Memory Allocated: 1.9075822830200195  GigaBytes
Max Memory Allocated: 1.9075927734375  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 3.1072998046875 GB
    Memory Allocated: 1.907914161682129  GigaBytes
Max Memory Allocated: 1.907914161682129  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1541748046875 GB
    Memory Allocated: 1.9454164505004883  GigaBytes
Max Memory Allocated: 1.9480714797973633  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([169, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.1541748046875 GB
    Memory Allocated: 1.948011875152588  GigaBytes
Max Memory Allocated: 1.9480714797973633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1541748046875 GB
    Memory Allocated: 1.948011875152588  GigaBytes
Max Memory Allocated: 1.9480714797973633  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 3.1541748046875 GB
    Memory Allocated: 1.9483342170715332  GigaBytes
Max Memory Allocated: 1.9483342170715332  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.9870152473449707  GigaBytes
Max Memory Allocated: 1.9897551536560059  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([149, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.9894318580627441  GigaBytes
Max Memory Allocated: 1.9897551536560059  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.9894318580627441  GigaBytes
Max Memory Allocated: 1.9897551536560059  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.9897160530090332  GigaBytes
Max Memory Allocated: 1.9897551536560059  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2225341796875 GB
    Memory Allocated: 2.025808811187744  GigaBytes
Max Memory Allocated: 2.0283665657043457  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([116, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2225341796875 GB
    Memory Allocated: 2.027785301208496  GigaBytes
Max Memory Allocated: 2.0283665657043457  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2225341796875 GB
    Memory Allocated: 2.027785301208496  GigaBytes
Max Memory Allocated: 2.0283665657043457  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.2225341796875 GB
    Memory Allocated: 2.0280065536499023  GigaBytes
Max Memory Allocated: 2.0283665657043457  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 2.05765438079834  GigaBytes
Max Memory Allocated: 2.059756278991699  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([128, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 2.0607547760009766  GigaBytes
Max Memory Allocated: 2.0607643127441406  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 2.0607547760009766  GigaBytes
Max Memory Allocated: 2.0607643127441406  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 3.2518310546875 GB
    Memory Allocated: 2.0609989166259766  GigaBytes
Max Memory Allocated: 2.0609989166259766  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3045654296875 GB
    Memory Allocated: 2.0954227447509766  GigaBytes
Max Memory Allocated: 2.0978641510009766  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([104, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.3045654296875 GB
    Memory Allocated: 2.097400188446045  GigaBytes
Max Memory Allocated: 2.0978641510009766  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3045654296875 GB
    Memory Allocated: 2.097400188446045  GigaBytes
Max Memory Allocated: 2.0978641510009766  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 3.3045654296875 GB
    Memory Allocated: 2.0975985527038574  GigaBytes
Max Memory Allocated: 2.0978641510009766  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3358154296875 GB
    Memory Allocated: 2.1269564628601074  GigaBytes
Max Memory Allocated: 2.1290392875671387  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([82, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.3358154296875 GB
    Memory Allocated: 2.128591537475586  GigaBytes
Max Memory Allocated: 2.1290392875671387  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3358154296875 GB
    Memory Allocated: 2.128591537475586  GigaBytes
Max Memory Allocated: 2.1290392875671387  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.3358154296875 GB
    Memory Allocated: 2.1287479400634766  GigaBytes
Max Memory Allocated: 2.1290392875671387  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3572998046875 GB
    Memory Allocated: 2.1529903411865234  GigaBytes
Max Memory Allocated: 2.1547107696533203  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([83, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.3572998046875 GB
    Memory Allocated: 2.1547470092773438  GigaBytes
Max Memory Allocated: 2.154754161834717  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3572998046875 GB
    Memory Allocated: 2.1547470092773438  GigaBytes
Max Memory Allocated: 2.154754161834717  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.3572998046875 GB
    Memory Allocated: 2.154905319213867  GigaBytes
Max Memory Allocated: 2.154905319213867  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3826904296875 GB
    Memory Allocated: 2.180551528930664  GigaBytes
Max Memory Allocated: 2.1823720932006836  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([75, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.3826904296875 GB
    Memory Allocated: 2.1822028160095215  GigaBytes
Max Memory Allocated: 2.1823720932006836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3826904296875 GB
    Memory Allocated: 2.1822028160095215  GigaBytes
Max Memory Allocated: 2.1823720932006836  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.3826904296875 GB
    Memory Allocated: 2.1823458671569824  GigaBytes
Max Memory Allocated: 2.1823720932006836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4061279296875 GB
    Memory Allocated: 2.206521511077881  GigaBytes
Max Memory Allocated: 2.208238124847412  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([858, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 2.2270665168762207  GigaBytes
Max Memory Allocated: 2.227146625518799  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 2.2270665168762207  GigaBytes
Max Memory Allocated: 2.227146625518799  GigaBytes

 h.shape torch.Size([1, 858, 256]), torch.Size([1, 858, 256])
----------------------------------------3
 Nvidia-smi: 3.4295654296875 GB
    Memory Allocated: 2.228703022003174  GigaBytes
Max Memory Allocated: 2.228703022003174  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7947998046875 GB
    Memory Allocated: 2.516727924346924  GigaBytes
Max Memory Allocated: 2.537184238433838  GigaBytes

rst.shape  torch.Size([1, 858, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8065185546875 GB
    Memory Allocated: 2.4366116523742676  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8065185546875 GB
    Memory Allocated: 2.4386963844299316  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8065185546875 GB
    Memory Allocated: 2.441068172454834  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8065185546875 GB
    Memory Allocated: 2.4388985633850098  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

torch.Size([11364, 40])
input nodes number: 19891
output nodes number: 11364
edges number: 93490
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8065185546875 GB
    Memory Allocated: 2.441216468811035  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8065185546875 GB
    Memory Allocated: 2.4412174224853516  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.028850555419921875  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

pseudo mini batch 1 input nodes size: 32482
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.02404308319091797  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.02404308319091797  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.04017066955566406  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.04025602340698242  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.023851394653320312  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.025424957275390625  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.025424957275390625  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.025424957275390625  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

torch.Size([32482, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.025424957275390625  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

m.shape torch.Size([2353, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.08751773834228516  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.08751773834228516  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 2353, 128]), torch.Size([1, 2353, 128])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.09011268615722656  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.10856342315673828  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 2353, 128])
m.shape torch.Size([2337, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.10968542098999023  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.10968542098999023  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 2337, 128]), torch.Size([1, 2337, 128])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.11191415786743164  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.14618253707885742  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 2337, 128])
m.shape torch.Size([2025, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.14841127395629883  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.14841127395629883  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 2025, 128]), torch.Size([1, 2025, 128])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.15034246444702148  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.19282865524291992  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 2025, 128])
m.shape torch.Size([1725, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.19515323638916016  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.19515323638916016  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 1725, 128]), torch.Size([1, 1725, 128])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.19679832458496094  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.24603939056396484  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 1725, 128])
m.shape torch.Size([1503, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.24880027770996094  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.24880027770996094  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 1503, 128]), torch.Size([1, 1503, 128])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.25023365020751953  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.3020915985107422  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 1503, 128])
m.shape torch.Size([1231, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.30489683151245117  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.30489683151245117  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 1231, 128]), torch.Size([1, 1231, 128])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.30607080459594727  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.3568606376647949  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 1231, 128])
m.shape torch.Size([1071, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.3598484992980957  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.3598484992980957  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 1071, 128]), torch.Size([1, 1071, 128])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.3608698844909668  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.41234731674194336  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 1071, 128])
m.shape torch.Size([917, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.41533470153808594  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.41533470153808594  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 917, 128]), torch.Size([1, 917, 128])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.41620922088623047  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.46715354919433594  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 917, 128])
m.shape torch.Size([759, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.4699735641479492  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.4699735641479492  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 759, 128]), torch.Size([1, 759, 128])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.47069740295410156  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.5186729431152344  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 759, 128])
m.shape torch.Size([6732, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.5504117012023926  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.5504117012023926  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 6732, 128]), torch.Size([1, 6732, 128])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.5568318367004395  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.0156407356262207  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 6732, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.9625425338745117  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.98223876953125  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.0019350051879883  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.9820847511291504  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

torch.Size([20653, 256])
first layer input nodes number: 32482
first layer output nodes number: 20653
edges number: 123887
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.0021791458129883  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.0218753814697266  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.0267996788024902  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.0267996788024902  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

m.shape torch.Size([1762, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.1128602027893066  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.1128602027893066  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 1762, 256]), torch.Size([1, 1762, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.1164240837097168  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.1433100700378418  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 1762, 256])
m.shape torch.Size([1468, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.144707202911377  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.144707202911377  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 1468, 256]), torch.Size([1, 1468, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.1475377082824707  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.1900029182434082  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 1468, 256])
m.shape torch.Size([1223, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.192521572113037  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.192521572113037  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 1223, 256]), torch.Size([1, 1223, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.1950840950012207  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.2519416809082031  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 1223, 256])
m.shape torch.Size([946, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.2535533905029297  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.2535533905029297  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 946, 256]), torch.Size([1, 946, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.2553577423095703  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.3076839447021484  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 946, 256])
m.shape torch.Size([799, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.310621738433838  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.310621738433838  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 799, 256]), torch.Size([1, 799, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.312145709991455  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.367323398590088  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 799, 256])
m.shape torch.Size([616, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.3701138496398926  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.3701138496398926  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 616, 256]), torch.Size([1, 616, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.371288776397705  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.4225430488586426  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 616, 256])
m.shape torch.Size([536, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.4255619049072266  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.4255619049072266  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 536, 256]), torch.Size([1, 536, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.426584243774414  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.4781208038330078  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 536, 256])
m.shape torch.Size([445, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.4810314178466797  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.4810314178466797  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 445, 256]), torch.Size([1, 445, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.4818801879882812  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.5326404571533203  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 445, 256])
m.shape torch.Size([382, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.5355205535888672  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.5355205535888672  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 382, 256]), torch.Size([1, 382, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.5362491607666016  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.583785057067871  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 382, 256])
m.shape torch.Size([330, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.586592674255371  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.586592674255371  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 330, 256]), torch.Size([1, 330, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.5872220993041992  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.6326065063476562  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 330, 256])
m.shape torch.Size([300, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.6354637145996094  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.6354637145996094  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.6360359191894531  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.6811904907226562  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([249, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.6837763786315918  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.6837763786315918  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.684251308441162  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.7246203422546387  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([215, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.72706937789917  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.72706937789917  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.7274794578552246  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.7652068138122559  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([197, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.767652988433838  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.767652988433838  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.768028736114502  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.8052277565002441  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([178, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.8076062202453613  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.8076062202453613  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.807945728302002  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.8439335823059082  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([135, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.8458399772644043  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.8458399772644043  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.846097469329834  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.8751940727233887  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([146, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.877450942993164  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.877450942993164  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.8777294158935547  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.9111461639404297  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([109, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.9128928184509277  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.9128928184509277  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.9131007194519043  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.9395041465759277  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([97, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.941171646118164  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.941171646118164  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.9413566589355469  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.9661483764648438  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([115, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.968266487121582  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.968266487121582  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.9684858322143555  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.9994134902954102  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([102, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 2.0013628005981445  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 2.0013628005981445  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 2.0015573501586914  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 2.030350685119629  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([59, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 2.031660556793213  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 2.031660556793213  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 2.031773090362549  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 2.049215793609619  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([62, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 2.050530433654785  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 2.050530433654785  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 2.0506486892700195  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 2.0698060989379883  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([61, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 2.0711541175842285  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 2.0711541175842285  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 2.07127046585083  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 2.090933322906494  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([870, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 2.1125216484069824  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 2.1125216484069824  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 870, 256]), torch.Size([1, 870, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 2.1141810417175293  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 2.4070591926574707  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 870, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 2.332827568054199  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 2.3348474502563477  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 2.3365468978881836  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 2.334441661834717  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

torch.Size([11402, 40])
input nodes number: 20653
output nodes number: 11402
edges number: 87230
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 2.334616184234619  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 2.3346166610717773  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.028417110443115234  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

pseudo mini batch 2 input nodes size: 34826
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.023786544799804688  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.023786544799804688  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.04129791259765625  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.04138469696044922  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.025171756744384766  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.026585102081298828  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.026585102081298828  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.026585102081298828  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

torch.Size([34826, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.026585102081298828  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

m.shape torch.Size([2717, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.08481884002685547  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.08481884002685547  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 2717, 128]), torch.Size([1, 2717, 128])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.08740997314453125  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.10828495025634766  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 2717, 128])
m.shape torch.Size([2809, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.10966825485229492  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.10966825485229492  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 2809, 128]), torch.Size([1, 2809, 128])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.11293172836303711  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.1536698341369629  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 2809, 128])
m.shape torch.Size([2397, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.15575933456420898  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.15575933456420898  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 2397, 128]), torch.Size([1, 2397, 128])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.15835046768188477  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.21001815795898438  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 2397, 128])
m.shape torch.Size([1980, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.21340322494506836  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.21340322494506836  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 1980, 128]), torch.Size([1, 1980, 128])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.21529150009155273  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.27080297470092773  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 1980, 128])
m.shape torch.Size([1680, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.2738642692565918  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.2738642692565918  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 1680, 128]), torch.Size([1, 1680, 128])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.2754664421081543  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.3358888626098633  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 1680, 128])
m.shape torch.Size([1363, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.3389873504638672  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.3389873504638672  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 1363, 128]), torch.Size([1, 1363, 128])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.3402872085571289  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.39896488189697266  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 1363, 128])
m.shape torch.Size([1140, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.40212011337280273  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.40212011337280273  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 1140, 128]), torch.Size([1, 1140, 128])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.40320730209350586  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.45970773696899414  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 1140, 128])
m.shape torch.Size([976, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.4628872871398926  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.4628872871398926  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 976, 128]), torch.Size([1, 976, 128])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.4638180732727051  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.5190472602844238  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 976, 128])
m.shape torch.Size([837, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.5221738815307617  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.5221738815307617  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 837, 128]), torch.Size([1, 837, 128])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.5229721069335938  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.5753817558288574  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 837, 128])
m.shape torch.Size([5258, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.6000547409057617  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.6000547409057617  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 5258, 128]), torch.Size([1, 5258, 128])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.6050691604614258  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.9611482620239258  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 5258, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.9130501747131348  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.9332270622253418  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.9534039497375488  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.9330692291259766  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

torch.Size([21157, 256])
first layer input nodes number: 34826
first layer output nodes number: 21157
edges number: 115925
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.9536657333374023  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.9738426208496094  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.9788870811462402  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.9788870811462402  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

m.shape torch.Size([1932, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.052088737487793  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.052088737487793  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 1932, 256]), torch.Size([1, 1932, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.0560503005981445  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.086327075958252  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 1932, 256])
m.shape torch.Size([1747, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.0876126289367676  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.0876126289367676  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 1747, 256]), torch.Size([1, 1747, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.0913386344909668  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.1421937942504883  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 1747, 256])
m.shape torch.Size([1360, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.1450462341308594  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.1450462341308594  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 1360, 256]), torch.Size([1, 1360, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.147693157196045  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.2057604789733887  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 1360, 256])
m.shape torch.Size([1061, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.2085657119750977  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.2085657119750977  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 1061, 256]), torch.Size([1, 1061, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.2107748985290527  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.2738122940063477  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 1061, 256])
m.shape torch.Size([895, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.2767057418823242  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.2767057418823242  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 895, 256]), torch.Size([1, 895, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.2784128189086914  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.3398675918579102  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 895, 256])
m.shape torch.Size([706, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.343085765838623  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.343085765838623  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 706, 256]), torch.Size([1, 706, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.3444323539733887  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.4042773246765137  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 706, 256])
m.shape torch.Size([588, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.4075603485107422  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.4075603485107422  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 588, 256]), torch.Size([1, 588, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.408681869506836  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.4658374786376953  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 588, 256])
m.shape torch.Size([479, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.4689598083496094  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.4689598083496094  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 479, 256]), torch.Size([1, 479, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.4698734283447266  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.5219497680664062  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 479, 256])
m.shape torch.Size([397, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.5249271392822266  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.5249271392822266  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 397, 256]), torch.Size([1, 397, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.5256843566894531  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.5747556686401367  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 397, 256])
m.shape torch.Size([345, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.577692985534668  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.577692985534668  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 345, 256]), torch.Size([1, 345, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.5783510208129883  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.6258926391601562  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 345, 256])
m.shape torch.Size([269, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.6284079551696777  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.6284079551696777  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.6289210319519043  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.669705867767334  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([230, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.672102451324463  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.672102451324463  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.6725411415100098  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.7098298072814941  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([194, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.7120347023010254  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.7120347023010254  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.712404727935791  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.7464470863342285  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([170, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.7485499382019043  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.7485499382019043  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.7488741874694824  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.7809748649597168  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([154, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.7830333709716797  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.7830333709716797  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.7833271026611328  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.814462661743164  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([121, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.8161768913269043  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.8161768913269043  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.8164076805114746  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.84248685836792  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([100, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.8440055847167969  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.8440055847167969  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.8441963195800781  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.8670845031738281  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([83, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.8684253692626953  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.8684253692626953  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.8685836791992188  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.8886890411376953  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([81, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.890089511871338  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.890089511871338  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.8902440071105957  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.9109463691711426  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([58, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.9119844436645508  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.9119844436645508  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.912095069885254  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.9276933670043945  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([55, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.928748607635498  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.928748607635498  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.9288535118103027  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.9443793296813965  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([59, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.9455747604370117  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.9455747604370117  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.9456872940063477  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.963129997253418  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([54, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.9642677307128906  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.9642677307128906  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.9643707275390625  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.9810562133789062  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([46, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.9820661544799805  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.9820661544799805  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.9821538925170898  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 1.9969816207885742  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([425, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 2.007150173187256  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 2.007150173187256  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 425, 256]), torch.Size([1, 425, 256])
----------------------------------------3
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 2.007960796356201  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 2.15171480178833  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 425, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 2.09165096282959  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 2.093656539916992  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 2.095386505126953  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 2.093294143676758  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

torch.Size([11609, 40])
input nodes number: 21157
output nodes number: 11609
edges number: 73616
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 2.09352445602417  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 2.093524932861328  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.02939748764038086  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

pseudo mini batch 3 input nodes size: 50035
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.025157451629638672  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.025157451629638672  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.04901599884033203  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.0491023063659668  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.031504154205322266  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.03327608108520508  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.03327608108520508  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.03327608108520508  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

torch.Size([50035, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.03327608108520508  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

m.shape torch.Size([2464, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.11001110076904297  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.11001110076904297  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 2464, 128]), torch.Size([1, 2464, 128])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.11236095428466797  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.13115978240966797  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 2464, 128])
m.shape torch.Size([2666, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.13252735137939453  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.13252735137939453  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 2666, 128]), torch.Size([1, 2666, 128])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.1356968879699707  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.17575311660766602  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 2666, 128])
m.shape torch.Size([2378, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.1769242286682129  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.1769242286682129  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 2378, 128]), torch.Size([1, 2378, 128])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.17922067642211914  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.22986078262329102  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 2378, 128])
m.shape torch.Size([2126, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.2332625389099121  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.2332625389099121  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 2126, 128]), torch.Size([1, 2126, 128])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.23537302017211914  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.29692888259887695  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 2126, 128])
m.shape torch.Size([1772, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.29964685440063477  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.29964685440063477  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 1772, 128]), torch.Size([1, 1772, 128])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.30133676528930664  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.36330652236938477  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 1772, 128])
m.shape torch.Size([1499, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.36675024032592773  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.36675024032592773  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 1499, 128]), torch.Size([1, 1499, 128])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.3681797981262207  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.42993593215942383  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 1499, 128])
m.shape torch.Size([1343, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.4337038993835449  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.4337038993835449  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 1343, 128]), torch.Size([1, 1343, 128])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.4349846839904785  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.5016160011291504  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 1343, 128])
m.shape torch.Size([1187, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.5055036544799805  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.5055036544799805  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 1187, 128]), torch.Size([1, 1187, 128])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.5066356658935547  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.5717673301696777  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 1187, 128])
m.shape torch.Size([984, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.5754241943359375  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.5754241943359375  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 984, 128]), torch.Size([1, 984, 128])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.5763626098632812  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.6399269104003906  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 984, 128])
m.shape torch.Size([8505, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.6800127029418945  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.6800127029418945  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 8505, 128]), torch.Size([1, 8505, 128])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.6881237030029297  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.2640047073364258  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 8505, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.1978869438171387  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.221656322479248  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.2454257011413574  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.2214703559875488  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

torch.Size([24924, 256])
first layer input nodes number: 50035
first layer output nodes number: 24924
edges number: 154091
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.245800495147705  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.2695698738098145  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.2755122184753418  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.2755122184753418  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

m.shape torch.Size([1715, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.3579888343811035  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.3579888343811035  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 1715, 256]), torch.Size([1, 1715, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.3613286018371582  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.3875737190246582  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 1715, 256])
m.shape torch.Size([1570, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.3892712593078613  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.3892712593078613  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 1570, 256]), torch.Size([1, 1570, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.392282485961914  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.437896728515625  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 1570, 256])
m.shape torch.Size([1280, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.4397754669189453  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.4397754669189453  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 1280, 256]), torch.Size([1, 1280, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.442479133605957  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.4992561340332031  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 1280, 256])
m.shape torch.Size([1045, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.5029497146606445  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.5029497146606445  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 1045, 256]), torch.Size([1, 1045, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.5049619674682617  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.5640125274658203  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 1045, 256])
m.shape torch.Size([846, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.5670819282531738  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.5670819282531738  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 846, 256]), torch.Size([1, 846, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.5686955451965332  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.6280159950256348  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 846, 256])
m.shape torch.Size([677, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.6311135292053223  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.6311135292053223  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 677, 256]), torch.Size([1, 677, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.6324048042297363  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.6951966285705566  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 677, 256])
m.shape torch.Size([586, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.6984939575195312  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.6984939575195312  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 586, 256]), torch.Size([1, 586, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.6996116638183594  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.7554969787597656  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 586, 256])
m.shape torch.Size([491, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.7588510513305664  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.7588510513305664  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 491, 256]), torch.Size([1, 491, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.7597875595092773  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.8151044845581055  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 491, 256])
m.shape torch.Size([382, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.8179407119750977  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.8179407119750977  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 382, 256]), torch.Size([1, 382, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.818669319152832  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.866511344909668  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 382, 256])
m.shape torch.Size([355, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.8695592880249023  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.8695592880249023  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 355, 256]), torch.Size([1, 355, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.8702363967895508  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.9195146560668945  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 355, 256])
m.shape torch.Size([267, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.9219989776611328  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.9219989776611328  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.9225082397460938  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.9635000228881836  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([244, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.966059684753418  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.966059684753418  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 244, 256]), torch.Size([1, 244, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.9665250778198242  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.0060834884643555  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 244, 256])
m.shape torch.Size([205, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.0084123611450195  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.0084123611450195  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.008803367614746  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.04477596282959  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([193, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.047177791595459  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.047177791595459  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.047545909881592  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.0839896202087402  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([181, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.0864152908325195  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.0864152908325195  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.0867605209350586  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.123354911804199  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([113, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.125171184539795  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.125171184539795  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.1253867149353027  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.1497416496276855  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([135, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.1518397331237793  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.1518397331237793  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.152097225189209  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.1829962730407715  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([107, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.1847190856933594  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.1847190856933594  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.1849231719970703  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.2108421325683594  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([80, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.2122011184692383  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.2122011184692383  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.2123537063598633  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.2328004837036133  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([86, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.234377384185791  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.234377384185791  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.234541416168213  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.2576699256896973  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([70, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.259000778198242  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.259000778198242  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.259134292602539  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.2788944244384766  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([73, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.28037166595459  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.28037166595459  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.280510902404785  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.3020925521850586  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([44, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.3029956817626953  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.3029956817626953  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.303079605102539  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.3166751861572266  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([53, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.3178558349609375  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.3178558349609375  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.3179569244384766  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.335041046142578  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([753, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.353084087371826  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.353084087371826  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

 h.shape torch.Size([1, 753, 256]), torch.Size([1, 753, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.354520320892334  GigaBytes
Max Memory Allocated: 2.549347400665283  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.6075282096862793  GigaBytes
Max Memory Allocated: 2.625481128692627  GigaBytes

rst.shape  torch.Size([1, 753, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.536653995513916  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.5387425422668457  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.541038990020752  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.5388641357421875  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

torch.Size([11551, 40])
input nodes number: 24924
output nodes number: 11551
edges number: 83586
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.539219379425049  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.539219856262207  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.1522216796875 GB
    Memory Allocated: 0.03681516647338867  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

pseudo mini batch 4 input nodes size: 51353
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.1522216796875 GB
    Memory Allocated: 0.03158712387084961  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.1522216796875 GB
    Memory Allocated: 0.03158712387084961  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.1522216796875 GB
    Memory Allocated: 0.05607414245605469  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.1522216796875 GB
    Memory Allocated: 0.056160926818847656  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.1522216796875 GB
    Memory Allocated: 0.03221607208251953  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.1522216796875 GB
    Memory Allocated: 0.03397846221923828  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1522216796875 GB
    Memory Allocated: 0.03397846221923828  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.1522216796875 GB
    Memory Allocated: 0.03397846221923828  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

torch.Size([51353, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.1522216796875 GB
    Memory Allocated: 0.03397846221923828  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

m.shape torch.Size([2694, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.11325311660766602  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.11325311660766602  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 2694, 128]), torch.Size([1, 2694, 128])
----------------------------------------3
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.11623477935791016  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.13733816146850586  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 2694, 128])
m.shape torch.Size([2949, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.13886594772338867  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.13886594772338867  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 2949, 128]), torch.Size([1, 2949, 128])
----------------------------------------3
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.1416783332824707  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.18386411666870117  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 2949, 128])
m.shape torch.Size([2654, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.1866765022277832  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.1866765022277832  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 2654, 128]), torch.Size([1, 2654, 128])
----------------------------------------3
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.1892075538635254  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.24489068984985352  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 2654, 128])
m.shape torch.Size([2307, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.24802541732788086  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.24802541732788086  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 2307, 128]), torch.Size([1, 2307, 128])
----------------------------------------3
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.25034523010253906  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.31685924530029297  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 2307, 128])
m.shape torch.Size([2003, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.3212594985961914  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.3212594985961914  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 2003, 128]), torch.Size([1, 2003, 128])
----------------------------------------3
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.3231697082519531  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.391937255859375  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 2003, 128])
m.shape torch.Size([1654, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.39571428298950195  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.39571428298950195  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 1654, 128]), torch.Size([1, 1654, 128])
----------------------------------------3
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.3972916603088379  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.4651188850402832  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 1654, 128])
m.shape torch.Size([1387, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.4689598083496094  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.4689598083496094  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 1387, 128]), torch.Size([1, 1387, 128])
----------------------------------------3
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.47028255462646484  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.5373344421386719  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 1387, 128])
m.shape torch.Size([1311, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.5416741371154785  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.5416741371154785  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 1311, 128]), torch.Size([1, 1311, 128])
----------------------------------------3
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.5429244041442871  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.6143193244934082  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 1311, 128])
m.shape torch.Size([1079, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.6183247566223145  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.6183247566223145  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 1079, 128]), torch.Size([1, 1079, 128])
----------------------------------------3
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.6193537712097168  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.6872520446777344  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 1079, 128])
m.shape torch.Size([8336, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.7264866828918457  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.7264866828918457  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 8336, 128]), torch.Size([1, 8336, 128])
----------------------------------------3
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.7344365119934082  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.2988743782043457  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 8336, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.231006145477295  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.2561583518981934  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.2813105583190918  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.2559614181518555  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

torch.Size([26374, 256])
first layer input nodes number: 51353
first layer output nodes number: 26374
edges number: 158989
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.2816953659057617  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.3072028160095215  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.313802719116211  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.313802719116211  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

m.shape torch.Size([1922, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.3906927108764648  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.3906927108764648  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 1922, 256]), torch.Size([1, 1922, 256])
----------------------------------------3
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.3945531845092773  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.4249944686889648  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 1922, 256])
m.shape torch.Size([1671, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.4268183708190918  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.4268183708190918  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 1671, 256]), torch.Size([1, 1671, 256])
----------------------------------------3
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.4304156303405762  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.4799647331237793  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 1671, 256])
m.shape torch.Size([1348, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.4823765754699707  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.4823765754699707  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 1348, 256]), torch.Size([1, 1348, 256])
----------------------------------------3
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.485215187072754  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.5435657501220703  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 1348, 256])
m.shape torch.Size([1072, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.5464167594909668  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.5464167594909668  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 1072, 256]), torch.Size([1, 1072, 256])
----------------------------------------3
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.5485224723815918  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.608858585357666  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 1072, 256])
m.shape torch.Size([905, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.6119422912597656  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.6119422912597656  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 905, 256]), torch.Size([1, 905, 256])
----------------------------------------3
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.613668441772461  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.6784992218017578  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 905, 256])
m.shape torch.Size([625, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.6812958717346191  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.6812958717346191  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 625, 256]), torch.Size([1, 625, 256])
----------------------------------------3
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.682487964630127  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.7358908653259277  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 625, 256])
m.shape torch.Size([504, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.7386860847473145  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.7386860847473145  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 504, 256]), torch.Size([1, 504, 256])
----------------------------------------3
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.739647388458252  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.7884182929992676  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 504, 256])
m.shape torch.Size([495, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.7917437553405762  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.7917437553405762  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 495, 256]), torch.Size([1, 495, 256])
----------------------------------------3
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.7926878929138184  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.8481402397155762  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 495, 256])
m.shape torch.Size([400, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.8511285781860352  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.8511285781860352  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 400, 256]), torch.Size([1, 400, 256])
----------------------------------------3
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.8518915176391602  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.9012727737426758  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 400, 256])
m.shape torch.Size([344, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.9041976928710938  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.9041976928710938  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 344, 256]), torch.Size([1, 344, 256])
----------------------------------------3
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.9048538208007812  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.9520645141601562  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 344, 256])
m.shape torch.Size([260, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.9544854164123535  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.9544854164123535  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 260, 256]), torch.Size([1, 260, 256])
----------------------------------------3
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.9549813270568848  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.9970531463623047  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 260, 256])
m.shape torch.Size([250, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.9996886253356934  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 1.9996886253356934  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.0001654624938965  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.040696620941162  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([202, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.042982578277588  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.042982578277588  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.043367862701416  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.0788140296936035  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([177, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.081003189086914  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.081003189086914  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.081340789794922  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.1147632598876953  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([141, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.1166276931762695  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.1166276931762695  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.116896629333496  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.1454038619995117  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([134, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.1473302841186523  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.1473302841186523  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.147585868835449  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.176466941833496  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([96, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.177907943725586  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.177907943725586  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.178091049194336  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.200063705444336  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([88, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.2014946937561035  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.2014946937561035  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.201662540435791  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.2229790687561035  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([86, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.224465847015381  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.224465847015381  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.2246298789978027  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.246610164642334  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([72, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.2479124069213867  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.2479124069213867  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.248049736022949  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.2674131393432617  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([58, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.26863956451416  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.26863956451416  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.2687501907348633  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.285122871398926  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([46, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.2860403060913086  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.2860403060913086  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.286128044128418  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.299727439880371  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([48, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.3014345169067383  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.3014345169067383  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.3015260696411133  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.3163576126098633  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([42, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.3172807693481445  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.3172807693481445  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.3173608779907227  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.330899238586426  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([606, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.3454203605651855  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.3454203605651855  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 606, 256]), torch.Size([1, 606, 256])
----------------------------------------3
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.34657621383667  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.551145076751709  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 606, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.486860752105713  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.4886937141418457  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.490997791290283  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.4890780448913574  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

torch.Size([11592, 40])
input nodes number: 26374
output nodes number: 11592
edges number: 77404
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.4891061782836914  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.4891066551208496  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.037166595458984375  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

pseudo mini batch 5 input nodes size: 66025
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.031960487365722656  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.031960487365722656  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.06344366073608398  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.06352710723876953  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.038953304290771484  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.041437625885009766  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.041437625885009766  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.041437625885009766  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

torch.Size([66025, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.041437625885009766  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

m.shape torch.Size([2752, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.16370439529418945  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.16370439529418945  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 2752, 128]), torch.Size([1, 2752, 128])
----------------------------------------3
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.16681528091430664  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.18781137466430664  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 2752, 128])
m.shape torch.Size([2712, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.18912363052368164  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.18912363052368164  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 2712, 128]), torch.Size([1, 2712, 128])
----------------------------------------3
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.19229745864868164  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.2325730323791504  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 2712, 128])
m.shape torch.Size([2309, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.23460626602172852  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.23460626602172852  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 2309, 128]), torch.Size([1, 2309, 128])
----------------------------------------3
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.2371201515197754  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.2870192527770996  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 2309, 128])
m.shape torch.Size([1999, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.28927135467529297  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.28927135467529297  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 1999, 128]), torch.Size([1, 1999, 128])
----------------------------------------3
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.29117774963378906  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.3464632034301758  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 1999, 128])
m.shape torch.Size([1822, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.3498539924621582  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.3498539924621582  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 1822, 128]), torch.Size([1, 1822, 128])
----------------------------------------3
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.3515915870666504  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.41414499282836914  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 1822, 128])
m.shape torch.Size([1581, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.4177994728088379  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.4177994728088379  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 1581, 128]), torch.Size([1, 1581, 128])
----------------------------------------3
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.41930723190307617  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.4850640296936035  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 1581, 128])
m.shape torch.Size([1426, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.48906993865966797  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.48906993865966797  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 1426, 128]), torch.Size([1, 1426, 128])
----------------------------------------3
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.4904298782348633  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.5591011047363281  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 1426, 128])
m.shape torch.Size([1369, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.5636434555053711  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.5636434555053711  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 1369, 128]), torch.Size([1, 1369, 128])
----------------------------------------3
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.5649490356445312  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.6404438018798828  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 1369, 128])
m.shape torch.Size([1203, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.644953727722168  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.644953727722168  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 1203, 128]), torch.Size([1, 1203, 128])
----------------------------------------3
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.6461009979248047  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.7202105522155762  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 1203, 128])
m.shape torch.Size([17266, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.8019676208496094  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.8019676208496094  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 17266, 128]), torch.Size([1, 17266, 128])
----------------------------------------3
 Nvidia-smi: 4.2733154296875 GB
    Memory Allocated: 0.8184337615966797  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0213623046875 GB
    Memory Allocated: 1.9929466247558594  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 17266, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0213623046875 GB
    Memory Allocated: 1.8831286430358887  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0213623046875 GB
    Memory Allocated: 1.9159722328186035  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0213623046875 GB
    Memory Allocated: 1.9488158226013184  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0213623046875 GB
    Memory Allocated: 1.915715217590332  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

torch.Size([34439, 256])
first layer input nodes number: 66025
first layer output nodes number: 34439
edges number: 246116
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.0213623046875 GB
    Memory Allocated: 1.9493098258972168  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0213623046875 GB
    Memory Allocated: 1.9821534156799316  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0213623046875 GB
    Memory Allocated: 1.9903645515441895  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0213623046875 GB
    Memory Allocated: 1.9903645515441895  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

m.shape torch.Size([1926, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.0773611068725586  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.0773611068725586  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 1926, 256]), torch.Size([1, 1926, 256])
----------------------------------------3
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.081705093383789  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.1120529174804688  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 1926, 256])
m.shape torch.Size([1558, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.113304615020752  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.113304615020752  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 1558, 256]), torch.Size([1, 1558, 256])
----------------------------------------3
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.1165242195129395  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.162353992462158  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 1558, 256])
m.shape torch.Size([1159, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.164116859436035  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.164116859436035  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 1159, 256]), torch.Size([1, 1159, 256])
----------------------------------------3
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.16642427444458  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.2174811363220215  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 1159, 256])
m.shape torch.Size([857, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.2191967964172363  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.2191967964172363  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 857, 256]), torch.Size([1, 857, 256])
----------------------------------------3
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.2208313941955566  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.269115924835205  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 857, 256])
m.shape torch.Size([757, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.2719368934631348  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.2719368934631348  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 757, 256]), torch.Size([1, 757, 256])
----------------------------------------3
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.273380756378174  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.327484607696533  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 757, 256])
m.shape torch.Size([565, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.3300209045410156  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.3300209045410156  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 565, 256]), torch.Size([1, 565, 256])
----------------------------------------3
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.3310985565185547  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.3775711059570312  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 565, 256])
m.shape torch.Size([467, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.3801746368408203  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.3801746368408203  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 467, 256]), torch.Size([1, 467, 256])
----------------------------------------3
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.3810653686523438  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.4256668090820312  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 467, 256])
m.shape torch.Size([411, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.42838191986084  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.42838191986084  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 411, 256]), torch.Size([1, 411, 256])
----------------------------------------3
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.429165840148926  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.474726676940918  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 411, 256])
m.shape torch.Size([338, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.4772586822509766  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.4772586822509766  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 338, 256]), torch.Size([1, 338, 256])
----------------------------------------3
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.477903366088867  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.5198135375976562  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 338, 256])
m.shape torch.Size([279, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.5221729278564453  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.5221729278564453  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.522705078125  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.5609021186828613  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([252, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.563300609588623  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.563300609588623  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.563781261444092  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.6012721061706543  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([199, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.6035523414611816  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.6035523414611816  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.6039319038391113  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.6361947059631348  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([157, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.6379666328430176  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.6379666328430176  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.638266086578369  GigaBytes
Max Memory Allocated: 2.6399011611938477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.665815830230713  GigaBytes
Max Memory Allocated: 2.667762279510498  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([135, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.667482852935791  GigaBytes
Max Memory Allocated: 2.667762279510498  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.667482852935791  GigaBytes
Max Memory Allocated: 2.667762279510498  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.6677403450012207  GigaBytes
Max Memory Allocated: 2.667762279510498  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.6932320594787598  GigaBytes
Max Memory Allocated: 2.6950345039367676  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([113, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.694732666015625  GigaBytes
Max Memory Allocated: 2.6950345039367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.694732666015625  GigaBytes
Max Memory Allocated: 2.6950345039367676  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.694948196411133  GigaBytes
Max Memory Allocated: 2.6950345039367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.717794418334961  GigaBytes
Max Memory Allocated: 2.7194108963012695  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([110, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.7193784713745117  GigaBytes
Max Memory Allocated: 2.7194108963012695  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.7193784713745117  GigaBytes
Max Memory Allocated: 2.7194108963012695  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.719588279724121  GigaBytes
Max Memory Allocated: 2.719588279724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.7432966232299805  GigaBytes
Max Memory Allocated: 2.7449750900268555  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([98, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.74479341506958  GigaBytes
Max Memory Allocated: 2.7449750900268555  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.74479341506958  GigaBytes
Max Memory Allocated: 2.7449750900268555  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.7449803352355957  GigaBytes
Max Memory Allocated: 2.7449803352355957  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.7674107551574707  GigaBytes
Max Memory Allocated: 2.7689995765686035  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([113, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.7692723274230957  GigaBytes
Max Memory Allocated: 2.769279956817627  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.7692723274230957  GigaBytes
Max Memory Allocated: 2.769279956817627  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.7694878578186035  GigaBytes
Max Memory Allocated: 2.7694878578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.7968602180480957  GigaBytes
Max Memory Allocated: 2.798799991607666  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([101, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.7985968589782715  GigaBytes
Max Memory Allocated: 2.798799991607666  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.7985968589782715  GigaBytes
Max Memory Allocated: 2.798799991607666  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.7987895011901855  GigaBytes
Max Memory Allocated: 2.798799991607666  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.82460355758667  GigaBytes
Max Memory Allocated: 2.8264336585998535  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([97, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.8263721466064453  GigaBytes
Max Memory Allocated: 2.8264336585998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.8263721466064453  GigaBytes
Max Memory Allocated: 2.8264336585998535  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.826557159423828  GigaBytes
Max Memory Allocated: 2.826557159423828  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.8526439666748047  GigaBytes
Max Memory Allocated: 2.855278968811035  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([70, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.853964328765869  GigaBytes
Max Memory Allocated: 2.855278968811035  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.853964328765869  GigaBytes
Max Memory Allocated: 2.855278968811035  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.854097843170166  GigaBytes
Max Memory Allocated: 2.855278968811035  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.8738579750061035  GigaBytes
Max Memory Allocated: 2.8752598762512207  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([65, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.8751659393310547  GigaBytes
Max Memory Allocated: 2.8752598762512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.8751659393310547  GigaBytes
Max Memory Allocated: 2.8752598762512207  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.8752899169921875  GigaBytes
Max Memory Allocated: 2.8752899169921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.8945064544677734  GigaBytes
Max Memory Allocated: 2.8958702087402344  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([48, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.8955078125  GigaBytes
Max Memory Allocated: 2.8958702087402344  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.8955078125  GigaBytes
Max Memory Allocated: 2.8958702087402344  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.895599365234375  GigaBytes
Max Memory Allocated: 2.8958702087402344  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.910430908203125  GigaBytes
Max Memory Allocated: 2.9116640090942383  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([66, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.91190767288208  GigaBytes
Max Memory Allocated: 2.9119138717651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.91190767288208  GigaBytes
Max Memory Allocated: 2.9119138717651367  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.9120335578918457  GigaBytes
Max Memory Allocated: 2.9120335578918457  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.9333081245422363  GigaBytes
Max Memory Allocated: 2.934818744659424  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([1203, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.962151050567627  GigaBytes
Max Memory Allocated: 2.9622631072998047  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.962151050567627  GigaBytes
Max Memory Allocated: 2.9622631072998047  GigaBytes

 h.shape torch.Size([1, 1203, 256]), torch.Size([1, 1203, 256])
----------------------------------------3
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 2.964531421661377  GigaBytes
Max Memory Allocated: 2.964531421661377  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 3.3694911003112793  GigaBytes
Max Memory Allocated: 3.3981728553771973  GigaBytes

rst.shape  torch.Size([1, 1203, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 3.2942862510681152  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 3.2961230278015137  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 3.297783851623535  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 3.295863628387451  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

torch.Size([11144, 40])
input nodes number: 34439
output nodes number: 11144
edges number: 87279
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 3.29617977142334  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1053466796875 GB
    Memory Allocated: 3.296180248260498  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1893310546875 GB
    Memory Allocated: 0.04593706130981445  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

pseudo mini batch 6 input nodes size: 85855
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1893310546875 GB
    Memory Allocated: 0.038928985595703125  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1893310546875 GB
    Memory Allocated: 0.038928985595703125  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1893310546875 GB
    Memory Allocated: 0.07986783981323242  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1893310546875 GB
    Memory Allocated: 0.07995033264160156  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1893310546875 GB
    Memory Allocated: 0.04838371276855469  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1893310546875 GB
    Memory Allocated: 0.0519866943359375  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1893310546875 GB
    Memory Allocated: 0.0519866943359375  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.1893310546875 GB
    Memory Allocated: 0.0519866943359375  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

torch.Size([85855, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.1893310546875 GB
    Memory Allocated: 0.0519866943359375  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

m.shape torch.Size([2520, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.3709716796875 GB
    Memory Allocated: 0.23797941207885742  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3709716796875 GB
    Memory Allocated: 0.23797941207885742  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

 h.shape torch.Size([1, 2520, 128]), torch.Size([1, 2520, 128])
----------------------------------------3
 Nvidia-smi: 5.3709716796875 GB
    Memory Allocated: 0.24038267135620117  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3709716796875 GB
    Memory Allocated: 0.260861873626709  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

rst.shape  torch.Size([1, 2520, 128])
m.shape torch.Size([2710, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.3709716796875 GB
    Memory Allocated: 0.26206350326538086  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3709716796875 GB
    Memory Allocated: 0.26206350326538086  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

 h.shape torch.Size([1, 2710, 128]), torch.Size([1, 2710, 128])
----------------------------------------3
 Nvidia-smi: 5.3709716796875 GB
    Memory Allocated: 0.2646479606628418  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3709716796875 GB
    Memory Allocated: 0.3049139976501465  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

rst.shape  torch.Size([1, 2710, 128])
m.shape torch.Size([2429, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.3709716796875 GB
    Memory Allocated: 0.3070964813232422  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3709716796875 GB
    Memory Allocated: 0.3070964813232422  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

 h.shape torch.Size([1, 2429, 128]), torch.Size([1, 2429, 128])
----------------------------------------3
 Nvidia-smi: 5.3709716796875 GB
    Memory Allocated: 0.30954694747924805  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3709716796875 GB
    Memory Allocated: 0.3625502586364746  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

rst.shape  torch.Size([1, 2429, 128])
m.shape torch.Size([2109, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.3709716796875 GB
    Memory Allocated: 0.3657979965209961  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3709716796875 GB
    Memory Allocated: 0.3657979965209961  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

 h.shape torch.Size([1, 2109, 128]), torch.Size([1, 2109, 128])
----------------------------------------3
 Nvidia-smi: 5.3709716796875 GB
    Memory Allocated: 0.36797380447387695  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3709716796875 GB
    Memory Allocated: 0.4287734031677246  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

rst.shape  torch.Size([1, 2109, 128])
m.shape torch.Size([2140, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.3709716796875 GB
    Memory Allocated: 0.43227148056030273  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3709716796875 GB
    Memory Allocated: 0.43227148056030273  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

 h.shape torch.Size([1, 2140, 128]), torch.Size([1, 2140, 128])
----------------------------------------3
 Nvidia-smi: 5.3709716796875 GB
    Memory Allocated: 0.43489599227905273  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3709716796875 GB
    Memory Allocated: 0.511359691619873  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

rst.shape  torch.Size([1, 2140, 128])
m.shape torch.Size([1924, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.3709716796875 GB
    Memory Allocated: 0.5158476829528809  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3709716796875 GB
    Memory Allocated: 0.5158476829528809  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

 h.shape torch.Size([1, 1924, 128]), torch.Size([1, 1924, 128])
----------------------------------------3
 Nvidia-smi: 5.3709716796875 GB
    Memory Allocated: 0.5176825523376465  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3709716796875 GB
    Memory Allocated: 0.5972037315368652  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

rst.shape  torch.Size([1, 1924, 128])
m.shape torch.Size([1804, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.3709716796875 GB
    Memory Allocated: 0.6023077964782715  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3709716796875 GB
    Memory Allocated: 0.6023077964782715  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

 h.shape torch.Size([1, 1804, 128]), torch.Size([1, 1804, 128])
----------------------------------------3
 Nvidia-smi: 5.3709716796875 GB
    Memory Allocated: 0.6040282249450684  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3709716796875 GB
    Memory Allocated: 0.6917104721069336  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

rst.shape  torch.Size([1, 1804, 128])
m.shape torch.Size([1732, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.3709716796875 GB
    Memory Allocated: 0.6974573135375977  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3709716796875 GB
    Memory Allocated: 0.6974573135375977  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

 h.shape torch.Size([1, 1732, 128]), torch.Size([1, 1732, 128])
----------------------------------------3
 Nvidia-smi: 5.3709716796875 GB
    Memory Allocated: 0.6991090774536133  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3709716796875 GB
    Memory Allocated: 0.7932596206665039  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

rst.shape  torch.Size([1, 1732, 128])
m.shape torch.Size([1654, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.3709716796875 GB
    Memory Allocated: 0.7995319366455078  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3709716796875 GB
    Memory Allocated: 0.7995319366455078  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

 h.shape torch.Size([1, 1654, 128]), torch.Size([1, 1654, 128])
----------------------------------------3
 Nvidia-smi: 5.3709716796875 GB
    Memory Allocated: 0.8011093139648438  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3709716796875 GB
    Memory Allocated: 0.9044723510742188  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

rst.shape  torch.Size([1, 1654, 128])
m.shape torch.Size([28887, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0423555374145508  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0423555374145508  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

 h.shape torch.Size([1, 28887, 128]), torch.Size([1, 28887, 128])
----------------------------------------3
 Nvidia-smi: 5.5096435546875 GB
    Memory Allocated: 1.0699043273925781  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.0258684158325195  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

rst.shape  torch.Size([1, 28887, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 2.853752613067627  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 2.899442195892334  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 2.945131778717041  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 2.89908504486084  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

torch.Size([47909, 256])
first layer input nodes number: 85855
first layer output nodes number: 47909
edges number: 376147
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 2.9457736015319824  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 2.9914631843566895  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.0028858184814453  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.0028858184814453  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

m.shape torch.Size([1577, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.1080803871154785  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.1080803871154785  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

 h.shape torch.Size([1, 1577, 256]), torch.Size([1, 1577, 256])
----------------------------------------3
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.111166477203369  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.1354122161865234  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

rst.shape  torch.Size([1, 1577, 256])
m.shape torch.Size([1360, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.136552333831787  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.136552333831787  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

 h.shape torch.Size([1, 1360, 256]), torch.Size([1, 1360, 256])
----------------------------------------3
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.1396384239196777  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.1834378242492676  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

rst.shape  torch.Size([1, 1360, 256])
m.shape torch.Size([995, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.184846878051758  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.184846878051758  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

 h.shape torch.Size([1, 995, 256]), torch.Size([1, 995, 256])
----------------------------------------3
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.1867446899414062  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.228496551513672  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

rst.shape  torch.Size([1, 995, 256])
m.shape torch.Size([712, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.2305378913879395  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.2305378913879395  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

 h.shape torch.Size([1, 712, 256]), torch.Size([1, 712, 256])
----------------------------------------3
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.231895923614502  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.273740768432617  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

rst.shape  torch.Size([1, 712, 256])
m.shape torch.Size([669, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.2762770652770996  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.2762770652770996  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

 h.shape torch.Size([1, 669, 256]), torch.Size([1, 669, 256])
----------------------------------------3
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.277553081512451  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.3257412910461426  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

rst.shape  torch.Size([1, 669, 256])
m.shape torch.Size([507, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.3280272483825684  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.3280272483825684  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

 h.shape torch.Size([1, 507, 256]), torch.Size([1, 507, 256])
----------------------------------------3
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.3289942741394043  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.372213363647461  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

rst.shape  torch.Size([1, 507, 256])
m.shape torch.Size([392, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.3743672370910645  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.3743672370910645  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

 h.shape torch.Size([1, 392, 256]), torch.Size([1, 392, 256])
----------------------------------------3
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.375114917755127  GigaBytes
Max Memory Allocated: 3.4002718925476074  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.4130492210388184  GigaBytes
Max Memory Allocated: 3.415666103363037  GigaBytes

rst.shape  torch.Size([1, 392, 256])
m.shape torch.Size([357, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.4154205322265625  GigaBytes
Max Memory Allocated: 3.415666103363037  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.4154205322265625  GigaBytes
Max Memory Allocated: 3.415666103363037  GigaBytes

 h.shape torch.Size([1, 357, 256]), torch.Size([1, 357, 256])
----------------------------------------3
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.4161014556884766  GigaBytes
Max Memory Allocated: 3.4161014556884766  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.4553794860839844  GigaBytes
Max Memory Allocated: 3.4581031799316406  GigaBytes

rst.shape  torch.Size([1, 357, 256])
m.shape torch.Size([316, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.457772731781006  GigaBytes
Max Memory Allocated: 3.4581031799316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.457772731781006  GigaBytes
Max Memory Allocated: 3.4581031799316406  GigaBytes

 h.shape torch.Size([1, 316, 256]), torch.Size([1, 316, 256])
----------------------------------------3
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.4583754539489746  GigaBytes
Max Memory Allocated: 3.4583754539489746  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.497803211212158  GigaBytes
Max Memory Allocated: 3.5005154609680176  GigaBytes

rst.shape  torch.Size([1, 316, 256])
m.shape torch.Size([280, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.5001931190490723  GigaBytes
Max Memory Allocated: 3.5005154609680176  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.5001931190490723  GigaBytes
Max Memory Allocated: 3.5005154609680176  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.5007271766662598  GigaBytes
Max Memory Allocated: 3.5007271766662598  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.540104866027832  GigaBytes
Max Memory Allocated: 3.5427751541137695  GigaBytes

rst.shape  torch.Size([1, 280, 256])
m.shape torch.Size([230, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.542269706726074  GigaBytes
Max Memory Allocated: 3.5427751541137695  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.542269706726074  GigaBytes
Max Memory Allocated: 3.5427751541137695  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.542708396911621  GigaBytes
Max Memory Allocated: 3.5427751541137695  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.5769262313842773  GigaBytes
Max Memory Allocated: 3.579339027404785  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([207, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.579094409942627  GigaBytes
Max Memory Allocated: 3.579339027404785  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.579094409942627  GigaBytes
Max Memory Allocated: 3.579339027404785  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.579489231109619  GigaBytes
Max Memory Allocated: 3.579489231109619  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.613049030303955  GigaBytes
Max Memory Allocated: 3.616049289703369  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([206, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.6158719062805176  GigaBytes
Max Memory Allocated: 3.616049289703369  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.6158719062805176  GigaBytes
Max Memory Allocated: 3.616049289703369  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.616264820098877  GigaBytes
Max Memory Allocated: 3.616264820098877  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.6524128913879395  GigaBytes
Max Memory Allocated: 3.6549668312072754  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([156, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.654315948486328  GigaBytes
Max Memory Allocated: 3.6549668312072754  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.654315948486328  GigaBytes
Max Memory Allocated: 3.6549668312072754  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.654613494873047  GigaBytes
Max Memory Allocated: 3.6549668312072754  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.684070587158203  GigaBytes
Max Memory Allocated: 3.6861534118652344  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([167, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.6863298416137695  GigaBytes
Max Memory Allocated: 3.6863393783569336  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.6863298416137695  GigaBytes
Max Memory Allocated: 3.6863393783569336  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.686648368835449  GigaBytes
Max Memory Allocated: 3.686648368835449  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.720412254333496  GigaBytes
Max Memory Allocated: 3.7228012084960938  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([141, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.722421646118164  GigaBytes
Max Memory Allocated: 3.7228012084960938  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.722421646118164  GigaBytes
Max Memory Allocated: 3.7228012084960938  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.7226905822753906  GigaBytes
Max Memory Allocated: 3.7228012084960938  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.753080368041992  GigaBytes
Max Memory Allocated: 3.7552318572998047  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([114, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.7548089027404785  GigaBytes
Max Memory Allocated: 3.7552318572998047  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.7548089027404785  GigaBytes
Max Memory Allocated: 3.7552318572998047  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.755026340484619  GigaBytes
Max Memory Allocated: 3.7552318572998047  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.781118869781494  GigaBytes
Max Memory Allocated: 3.7829670906066895  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([138, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.783397674560547  GigaBytes
Max Memory Allocated: 3.783407211303711  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.783397674560547  GigaBytes
Max Memory Allocated: 3.783407211303711  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.783660888671875  GigaBytes
Max Memory Allocated: 3.783660888671875  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.817089080810547  GigaBytes
Max Memory Allocated: 3.8194580078125  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([124, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.8192219734191895  GigaBytes
Max Memory Allocated: 3.8194580078125  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.8192219734191895  GigaBytes
Max Memory Allocated: 3.8194580078125  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.819458484649658  GigaBytes
Max Memory Allocated: 3.819458484649658  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.8511509895324707  GigaBytes
Max Memory Allocated: 3.853397846221924  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([109, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.853128433227539  GigaBytes
Max Memory Allocated: 3.853397846221924  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.853128433227539  GigaBytes
Max Memory Allocated: 3.853397846221924  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.8533363342285156  GigaBytes
Max Memory Allocated: 3.853397846221924  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.882650375366211  GigaBytes
Max Memory Allocated: 3.8847293853759766  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([120, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.8849687576293945  GigaBytes
Max Memory Allocated: 3.8849782943725586  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.8849687576293945  GigaBytes
Max Memory Allocated: 3.8849782943725586  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.885197639465332  GigaBytes
Max Memory Allocated: 3.885197639465332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.919072151184082  GigaBytes
Max Memory Allocated: 3.921475410461426  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([77, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.9209322929382324  GigaBytes
Max Memory Allocated: 3.921475410461426  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.9209322929382324  GigaBytes
Max Memory Allocated: 3.921475410461426  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.921079158782959  GigaBytes
Max Memory Allocated: 3.921475410461426  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.943843364715576  GigaBytes
Max Memory Allocated: 3.9454588890075684  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([71, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.9453396797180176  GigaBytes
Max Memory Allocated: 3.9454588890075684  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.9453396797180176  GigaBytes
Max Memory Allocated: 3.9454588890075684  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.9454751014709473  GigaBytes
Max Memory Allocated: 3.9454751014709473  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.9674134254455566  GigaBytes
Max Memory Allocated: 3.968970775604248  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([70, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.968960762023926  GigaBytes
Max Memory Allocated: 3.968970775604248  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.968960762023926  GigaBytes
Max Memory Allocated: 3.968970775604248  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.9690942764282227  GigaBytes
Max Memory Allocated: 3.9690942764282227  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 3.9916582107543945  GigaBytes
Max Memory Allocated: 3.993260383605957  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([1940, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.8280029296875 GB
    Memory Allocated: 4.038827896118164  GigaBytes
Max Memory Allocated: 4.039008617401123  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8280029296875 GB
    Memory Allocated: 4.038827896118164  GigaBytes
Max Memory Allocated: 4.039008617401123  GigaBytes

 h.shape torch.Size([1, 1940, 256]), torch.Size([1, 1940, 256])
----------------------------------------3
 Nvidia-smi: 6.8280029296875 GB
    Memory Allocated: 4.04252815246582  GigaBytes
Max Memory Allocated: 4.04252815246582  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8748779296875 GB
    Memory Allocated: 4.6948394775390625  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

rst.shape  torch.Size([1, 1940, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.8748779296875 GB
    Memory Allocated: 4.600594997406006  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.8748779296875 GB
    Memory Allocated: 4.602345943450928  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.8748779296875 GB
    Memory Allocated: 4.60399055480957  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.8748779296875 GB
    Memory Allocated: 4.602157115936279  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

torch.Size([11035, 40])
input nodes number: 47909
output nodes number: 11035
edges number: 107383
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.8748779296875 GB
    Memory Allocated: 4.6025390625  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.8748779296875 GB
    Memory Allocated: 4.602539539337158  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.058675289154052734  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

pseudo mini batch 7 input nodes size: 67813
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.04832601547241211  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.04832601547241211  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.08152914047241211  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.08161306381225586  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.04059171676635742  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.04410409927368164  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.04410409927368164  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.04410409927368164  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

torch.Size([67813, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.04410409927368164  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

m.shape torch.Size([1841, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.20977210998535156  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.20977210998535156  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

 h.shape torch.Size([1, 1841, 128]), torch.Size([1, 1841, 128])
----------------------------------------3
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.21152782440185547  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.22557353973388672  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

rst.shape  torch.Size([1, 1841, 128])
m.shape torch.Size([1899, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.22650671005249023  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.22650671005249023  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

 h.shape torch.Size([1, 1899, 128]), torch.Size([1, 1899, 128])
----------------------------------------3
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.2283177375793457  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.25548315048217773  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

rst.shape  torch.Size([1, 1899, 128])
m.shape torch.Size([1818, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.2573833465576172  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.2573833465576172  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

 h.shape torch.Size([1, 1818, 128]), torch.Size([1, 1818, 128])
----------------------------------------3
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.25911712646484375  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.2972602844238281  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

rst.shape  torch.Size([1, 1818, 128])
m.shape torch.Size([1732, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.2996969223022461  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.2996969223022461  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

 h.shape torch.Size([1, 1732, 128]), torch.Size([1, 1732, 128])
----------------------------------------3
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.3013486862182617  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.3502950668334961  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

rst.shape  torch.Size([1, 1732, 128])
m.shape torch.Size([1627, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.3533482551574707  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.3533482551574707  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

 h.shape torch.Size([1, 1627, 128]), torch.Size([1, 1627, 128])
----------------------------------------3
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.35489988327026367  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.4122314453125  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

rst.shape  torch.Size([1, 1627, 128])
m.shape torch.Size([1496, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.41573572158813477  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.41573572158813477  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

 h.shape torch.Size([1, 1496, 128]), torch.Size([1, 1496, 128])
----------------------------------------3
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.4171624183654785  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.479372501373291  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

rst.shape  torch.Size([1, 1496, 128])
m.shape torch.Size([1458, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.48352575302124023  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.48352575302124023  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

 h.shape torch.Size([1, 1458, 128]), torch.Size([1, 1458, 128])
----------------------------------------3
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.48491621017456055  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.5547566413879395  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

rst.shape  torch.Size([1, 1458, 128])
m.shape torch.Size([1375, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.5593066215515137  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.5593066215515137  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

 h.shape torch.Size([1, 1375, 128]), torch.Size([1, 1375, 128])
----------------------------------------3
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.5606179237365723  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.6381564140319824  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

rst.shape  torch.Size([1, 1375, 128])
m.shape torch.Size([1350, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.6432943344116211  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.6432943344116211  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

 h.shape torch.Size([1, 1350, 128]), torch.Size([1, 1350, 128])
----------------------------------------3
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.6445817947387695  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.7279157638549805  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

rst.shape  torch.Size([1, 1350, 128])
m.shape torch.Size([26858, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.8553409576416016  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.8553409576416016  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

 h.shape torch.Size([1, 26858, 128]), torch.Size([1, 26858, 128])
----------------------------------------3
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.8809547424316406  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 2.699533462524414  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

rst.shape  torch.Size([1, 26858, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 2.544987678527832  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 2.5845212936401367  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 2.6240549087524414  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 2.584212303161621  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

torch.Size([41454, 256])
first layer input nodes number: 67813
first layer output nodes number: 41454
edges number: 337068
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 2.6245622634887695  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 2.664095878601074  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 2.674698829650879  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 2.674698829650879  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

m.shape torch.Size([1211, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 2.8054451942443848  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 2.8054451942443848  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

 h.shape torch.Size([1, 1211, 256]), torch.Size([1, 1211, 256])
----------------------------------------3
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 2.8080763816833496  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 2.830132007598877  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

rst.shape  torch.Size([1, 1211, 256])
m.shape torch.Size([1010, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 2.830687999725342  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 2.830687999725342  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

 h.shape torch.Size([1, 1010, 256]), torch.Size([1, 1010, 256])
----------------------------------------3
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 2.8326144218444824  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 2.861510753631592  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

rst.shape  torch.Size([1, 1010, 256])
m.shape torch.Size([787, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 2.862823486328125  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 2.862823486328125  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

 h.shape torch.Size([1, 787, 256]), torch.Size([1, 787, 256])
----------------------------------------3
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 2.8643245697021484  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 2.897348403930664  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

rst.shape  torch.Size([1, 787, 256])
m.shape torch.Size([679, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 2.8992085456848145  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 2.8992085456848145  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

 h.shape torch.Size([1, 679, 256]), torch.Size([1, 679, 256])
----------------------------------------3
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 2.900503635406494  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 2.9385266304016113  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

rst.shape  torch.Size([1, 679, 256])
m.shape torch.Size([576, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 2.9406471252441406  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 2.9406471252441406  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

 h.shape torch.Size([1, 576, 256]), torch.Size([1, 576, 256])
----------------------------------------3
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 2.9417457580566406  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 2.984973907470703  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

rst.shape  torch.Size([1, 576, 256])
m.shape torch.Size([457, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 2.987060070037842  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 2.987060070037842  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

 h.shape torch.Size([1, 457, 256]), torch.Size([1, 457, 256])
----------------------------------------3
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 2.987931728363037  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.0255818367004395  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

rst.shape  torch.Size([1, 457, 256])
m.shape torch.Size([403, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.02840518951416  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.02840518951416  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

 h.shape torch.Size([1, 403, 256]), torch.Size([1, 403, 256])
----------------------------------------3
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.0291738510131836  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.069101333618164  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

rst.shape  torch.Size([1, 403, 256])
m.shape torch.Size([311, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.071108341217041  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.071108341217041  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.0717015266418457  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.1100430488586426  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([316, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.1124801635742188  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.1124801635742188  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

 h.shape torch.Size([1, 316, 256]), torch.Size([1, 316, 256])
----------------------------------------3
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.1130828857421875  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.1542720794677734  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

rst.shape  torch.Size([1, 316, 256])
m.shape torch.Size([291, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.1567678451538086  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.1567678451538086  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.157322883605957  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.1988906860351562  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

rst.shape  torch.Size([1, 291, 256])
m.shape torch.Size([276, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.201531410217285  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.201531410217285  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.2020578384399414  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.2440185546875  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([264, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.246800422668457  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.246800422668457  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.2473039627075195  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.2905778884887695  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([219, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.293062686920166  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.293062686920166  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.293480396270752  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.331909656524658  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([189, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.3342442512512207  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.3342442512512207  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.3346047401428223  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.370293140411377  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([187, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.3728089332580566  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.3728089332580566  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.3731656074523926  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.410973072052002  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([183, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.4143776893615723  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.4143776893615723  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.414726734161377  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.4541687965393066  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([172, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.4568047523498535  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.4568047523498535  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.4571328163146973  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.4965004920959473  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([161, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.499122142791748  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.499122142791748  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.499429225921631  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.538428783416748  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([151, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.5410327911376953  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.5410327911376953  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.54132080078125  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.579914093017578  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([142, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.5824999809265137  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.5824999809265137  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.582770824432373  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.620959758758545  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([138, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.623610019683838  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.623610019683838  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.623873233795166  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.6628289222717285  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([95, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.664706230163574  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.664706230163574  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.6648874282836914  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.6929731369018555  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([109, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.6952924728393555  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.6952924728393555  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 3.695500373840332  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0838623046875 GB
    Memory Allocated: 3.729180335998535  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([112, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.0838623046875 GB
    Memory Allocated: 3.7316598892211914  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0838623046875 GB
    Memory Allocated: 3.7316598892211914  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 7.0838623046875 GB
    Memory Allocated: 3.7318735122680664  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1209716796875 GB
    Memory Allocated: 3.7679758071899414  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([2805, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.1209716796875 GB
    Memory Allocated: 3.835268020629883  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1209716796875 GB
    Memory Allocated: 3.835268020629883  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

 h.shape torch.Size([1, 2805, 256]), torch.Size([1, 2805, 256])
----------------------------------------3
 Nvidia-smi: 7.1209716796875 GB
    Memory Allocated: 3.840618133544922  GigaBytes
Max Memory Allocated: 4.7417144775390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1209716796875 GB
    Memory Allocated: 4.798101425170898  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 2805, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.1209716796875 GB
    Memory Allocated: 4.677881240844727  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.1209716796875 GB
    Memory Allocated: 4.679981231689453  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.1209716796875 GB
    Memory Allocated: 4.681656837463379  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.1209716796875 GB
    Memory Allocated: 4.679472923278809  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

torch.Size([11244, 40])
input nodes number: 41454
output nodes number: 11244
edges number: 134262
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.1209716796875 GB
    Memory Allocated: 4.679790496826172  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.1209716796875 GB
    Memory Allocated: 4.67979097366333  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.050099849700927734  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.05565023422241211  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.05565023422241211  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02091941237449646 |0.04376670718193054 |0.18883022665977478 |0.0001118779182434082 |0.07715848088264465 |0.005823373794555664 |
----------------------------------------------------------pseudo_mini_loss sum 5.331013202667236[05:12:15] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28447620 edges into 8 parts and get 4566254 edge cuts

 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  659415
Number of first layer input nodes during this epoch:  422614
Number of first layer output nodes during this epoch:  236801
----------------------------------------before generate dataloader block 
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.055649757385253906  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.019256114959716797
global_2_local spend time (sec) 0.04610800743103027
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004358053207397461
A = g.adjacency_matrix() spent  0.011335611343383789
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08528852462768555
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.3228299617767334
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.185178518295288

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])
drop edges based on redundancy f4

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432})
Convert a graph into a bidirected graph: 1.204 seconds
Metis partitioning: 5.285 seconds
Split the graph: 2.057 seconds
Construct subgraphs: 0.087 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  8.647453308105469
11560
11709
11592
11427
11204
11086
11328
11035
total k batches seeds list generation spend  19.44678258895874
after graph partition
graph partition algorithm spend time 19.551061391830444
11560
11709
11592
11427
11204
11086
11328
11035
partition_len_list
[19969, 25180, 21464, 19311, 27841, 33477, 41694, 47683]
shared_neighbor_graph_partition_s0 selection method  spend 19.648146867752075
time for parepare:  0.01660299301147461
local_output_nid generation:  0.0020987987518310547
local_in_edges_tensor generation:  0.0023331642150878906
mini_batch_src_global generation:  0.0024814605712890625
r_  generation:  0.024303674697875977
local_output_nid generation:  0.0023288726806640625
local_in_edges_tensor generation:  0.0025513172149658203
mini_batch_src_global generation:  0.003335714340209961
r_  generation:  0.031763315200805664
local_output_nid generation:  0.0027027130126953125
local_in_edges_tensor generation:  0.002785921096801758
mini_batch_src_global generation:  0.003693819046020508
r_  generation:  0.03293132781982422
local_output_nid generation:  0.002995014190673828
local_in_edges_tensor generation:  0.002493619918823242
mini_batch_src_global generation:  0.0031616687774658203
r_  generation:  0.030658960342407227
local_output_nid generation:  0.002888917922973633
local_in_edges_tensor generation:  0.0023877620697021484
mini_batch_src_global generation:  0.0026602745056152344
r_  generation:  0.026631593704223633
local_output_nid generation:  0.002847909927368164
local_in_edges_tensor generation:  0.0027565956115722656
mini_batch_src_global generation:  0.0029556751251220703
r_  generation:  0.028996944427490234
local_output_nid generation:  0.0028722286224365234
local_in_edges_tensor generation:  0.003554821014404297
mini_batch_src_global generation:  0.00473785400390625
r_  generation:  0.0470426082611084
local_output_nid generation:  0.0030956268310546875
local_in_edges_tensor generation:  0.0029611587524414062
mini_batch_src_global generation:  0.006312131881713867
r_  generation:  0.042389631271362305
----------------------check_connections_block total spend ----------------------------- 0.4217357635498047
generate_one_block  0.04094409942626953
generate_one_block  0.04353046417236328
generate_one_block  0.04212450981140137
generate_one_block  0.0390782356262207
generate_one_block  0.033270835876464844
generate_one_block  0.038858652114868164
generate_one_block  0.06435585021972656
generate_one_block  0.05784344673156738
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.06152701377868652
gen group dst list time:  0.006626129150390625
time for parepare:  0.022426605224609375
local_output_nid generation:  0.003610372543334961
local_in_edges_tensor generation:  0.011400461196899414
mini_batch_src_global generation:  0.003437519073486328
r_  generation:  0.03792095184326172
local_output_nid generation:  0.0061757564544677734
local_in_edges_tensor generation:  0.00487828254699707
mini_batch_src_global generation:  0.006440162658691406
r_  generation:  0.05809807777404785
local_output_nid generation:  0.0054934024810791016
local_in_edges_tensor generation:  0.004102945327758789
mini_batch_src_global generation:  0.004859447479248047
r_  generation:  0.04735827445983887
local_output_nid generation:  0.0048253536224365234
local_in_edges_tensor generation:  0.004416942596435547
mini_batch_src_global generation:  0.004220008850097656
r_  generation:  0.04265546798706055
local_output_nid generation:  0.006931781768798828
local_in_edges_tensor generation:  0.005244255065917969
mini_batch_src_global generation:  0.005808591842651367
r_  generation:  0.0630180835723877
local_output_nid generation:  0.008108139038085938
local_in_edges_tensor generation:  0.007316112518310547
mini_batch_src_global generation:  0.009674072265625
r_  generation:  0.0829916000366211
local_output_nid generation:  0.00919032096862793
local_in_edges_tensor generation:  0.010065555572509766
mini_batch_src_global generation:  0.017616748809814453
r_  generation:  0.12895560264587402
local_output_nid generation:  0.011044502258300781
local_in_edges_tensor generation:  0.011643409729003906
mini_batch_src_global generation:  0.015162467956542969
r_  generation:  0.13616728782653809
----------------------check_connections_block total spend ----------------------------- 0.948768138885498
generate_one_block  0.05696821212768555
generate_one_block  0.07513260841369629
generate_one_block  0.06299781799316406
generate_one_block  0.0704500675201416
generate_one_block  0.08505606651306152
generate_one_block  0.11105060577392578
generate_one_block  0.15957140922546387
generate_one_block  0.18081116676330566
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.055649757385253906  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

connection checking time:  0.948768138885498
block generation total time  0.8020379543304443
average batch blocks generation time:  0.10025474429130554
block dataloader generation time/epoch 22.403624057769775
pseudo mini batch 0 input nodes size: 31132
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.0460658073425293  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.0460658073425293  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.060910701751708984  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.06099700927734375  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.0277099609375  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.02900981903076172  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.02900981903076172  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.02900981903076172  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

torch.Size([31132, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.02900981903076172  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

m.shape torch.Size([2792, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.0818471908569336  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.0818471908569336  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 2792, 128]), torch.Size([1, 2792, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.0845804214477539  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.10643959045410156  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 2792, 128])
m.shape torch.Size([2810, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.1077880859375  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.1077880859375  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 2810, 128]), torch.Size([1, 2810, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.11046791076660156  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.15121078491210938  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 2810, 128])
m.shape torch.Size([2340, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.15389060974121094  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.15389060974121094  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 2340, 128]), torch.Size([1, 2340, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.15682601928710938  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.2072162628173828  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 2340, 128])
m.shape torch.Size([1972, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.21056365966796875  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.21056365966796875  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1972, 128]), torch.Size([1, 1972, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.21244430541992188  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.2669830322265625  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1972, 128])
m.shape torch.Size([1649, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.2699742317199707  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.2699742317199707  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1649, 128]), torch.Size([1, 1649, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.2715468406677246  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.3289499282836914  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1649, 128])
m.shape torch.Size([1263, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.332399845123291  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.332399845123291  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1263, 128]), torch.Size([1, 1263, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.3336043357849121  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.38539743423461914  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1263, 128])
m.shape torch.Size([1058, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.38832664489746094  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.38832664489746094  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1058, 128]), torch.Size([1, 1058, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.38933563232421875  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.44216060638427734  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1058, 128])
m.shape torch.Size([916, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.44515037536621094  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.44515037536621094  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 916, 128]), torch.Size([1, 916, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.44602394104003906  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.49617576599121094  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 916, 128])
m.shape torch.Size([763, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.49901342391967773  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.49901342391967773  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 763, 128]), torch.Size([1, 763, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.4997410774230957  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5476174354553223  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 763, 128])
m.shape torch.Size([4406, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5687379837036133  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5687379837036133  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 4406, 128]), torch.Size([1, 4406, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5729398727416992  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.8807458877563477  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 4406, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.8377656936645508  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.8572969436645508  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.8768281936645508  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.8571476936340332  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

torch.Size([19969, 256])
first layer input nodes number: 31132
first layer output nodes number: 19969
edges number: 104804
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.8770623207092285  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.8965935707092285  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.9013547897338867  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.9013547897338867  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

m.shape torch.Size([2019, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.9706015586853027  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.9706015586853027  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 2019, 256]), torch.Size([1, 2019, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.9744524955749512  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.0059022903442383  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 2019, 256])
m.shape torch.Size([1791, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.0078544616699219  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.0078544616699219  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1791, 256]), torch.Size([1, 1791, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.011270523071289  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.0637798309326172  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1791, 256])
m.shape torch.Size([1373, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.0662617683410645  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.0662617683410645  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1373, 256]), torch.Size([1, 1373, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.0689826011657715  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.1280732154846191  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1373, 256])
m.shape torch.Size([1106, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.1310162544250488  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.1310162544250488  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1106, 256]), torch.Size([1, 1106, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.1331892013549805  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.1964988708496094  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1106, 256])
m.shape torch.Size([913, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.1998319625854492  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.1998319625854492  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 913, 256]), torch.Size([1, 913, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.201573371887207  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.2651100158691406  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 913, 256])
m.shape torch.Size([675, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.268132209777832  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.268132209777832  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 675, 256]), torch.Size([1, 675, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.2694196701049805  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.3247804641723633  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 675, 256])
m.shape torch.Size([588, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.3280930519104004  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.3280930519104004  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 588, 256]), torch.Size([1, 588, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.3292145729064941  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.3852906227111816  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 588, 256])
m.shape torch.Size([510, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.3886513710021973  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.3886513710021973  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 510, 256]), torch.Size([1, 510, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.3896241188049316  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.4457688331604004  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 510, 256])
m.shape torch.Size([376, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.4485349655151367  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.4485349655151367  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.4492521286010742  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.498173713684082  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([329, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.5009775161743164  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.5009775161743164  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 329, 256]), torch.Size([1, 329, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.5016050338745117  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.5468645095825195  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 329, 256])
m.shape torch.Size([246, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.54915189743042  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.54915189743042  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.5496211051940918  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.586219310760498  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([219, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.5885109901428223  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.5885109901428223  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.5889286994934082  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.624433994293213  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([175, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.6264119148254395  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.6264119148254395  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.6267457008361816  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.657454013824463  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([154, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.6593594551086426  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.6593594551086426  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.6596531867980957  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.688732624053955  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([148, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.6907196044921875  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.6907196044921875  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.6910018920898438  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.7209243774414062  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([105, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.722398281097412  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.722398281097412  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.7225985527038574  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.7452292442321777  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([92, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.7466325759887695  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.7466325759887695  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.7468080520629883  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.7678651809692383  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([90, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.7693347930908203  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.7693347930908203  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.7695064544677734  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.7913074493408203  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([75, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.7927117347717285  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.7927117347717285  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.7928547859191895  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.812023639678955  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([58, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.813115119934082  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.813115119934082  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8132257461547852  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8288240432739258  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([49, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8297762870788574  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8297762870788574  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8298697471618652  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8437018394470215  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([46, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.844627857208252  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.844627857208252  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8447155952453613  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8583149909973145  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([39, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8591337203979492  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8591337203979492  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.859208106994629  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8712587356567383  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([39, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8721213340759277  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8721213340759277  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8721957206726074  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8847670555114746  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([345, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.893019676208496  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.893019676208496  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 345, 256]), torch.Size([1, 345, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8936777114868164  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.0098648071289062  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 345, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.9534435272216797  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.955368995666504  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.958024024963379  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.95601224899292  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

torch.Size([11560, 40])
input nodes number: 19969
output nodes number: 11560
edges number: 69562
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.9564976692199707  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.956498622894287  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.03188943862915039  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

pseudo mini batch 1 input nodes size: 47537
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.027960777282714844  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.027960777282714844  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.0506281852722168  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.05071544647216797  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.035784244537353516  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.0376734733581543  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.0376734733581543  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.0376734733581543  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

torch.Size([47537, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.0376734733581543  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

m.shape torch.Size([2302, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.11763191223144531  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.11763191223144531  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 2302, 128]), torch.Size([1, 2302, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.11989688873291016  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.13811635971069336  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 2302, 128])
m.shape torch.Size([2439, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.13995599746704102  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.13995599746704102  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 2439, 128]), torch.Size([1, 2439, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.14228200912475586  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.1798086166381836  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 2439, 128])
m.shape torch.Size([2314, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.1810770034790039  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.1810770034790039  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 2314, 128]), torch.Size([1, 2314, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.18422222137451172  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.23461532592773438  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 2314, 128])
m.shape torch.Size([1952, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.23680400848388672  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.23680400848388672  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1952, 128]), torch.Size([1, 1952, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.23866558074951172  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.2926511764526367  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1952, 128])
m.shape torch.Size([1811, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.2960381507873535  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.2960381507873535  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1811, 128]), torch.Size([1, 1811, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.29776525497436523  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.3599410057067871  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1811, 128])
m.shape torch.Size([1533, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.3634634017944336  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.3634634017944336  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1533, 128]), torch.Size([1, 1533, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.3649253845214844  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.42933177947998047  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1533, 128])
m.shape torch.Size([1350, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.4331068992614746  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.4331068992614746  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1350, 128]), torch.Size([1, 1350, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.43439435958862305  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5014920234680176  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1350, 128])
m.shape torch.Size([1255, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5056357383728027  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5056357383728027  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1255, 128]), torch.Size([1, 1255, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5068325996398926  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5762538909912109  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1255, 128])
m.shape torch.Size([1029, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5800714492797852  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5800714492797852  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1029, 128]), torch.Size([1, 1029, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5810527801513672  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.6440186500549316  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1029, 128])
m.shape torch.Size([9195, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.687373161315918  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.687373161315918  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 9195, 128]), torch.Size([1, 9195, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.6961421966552734  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.3192334175109863  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 9195, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.2487845420837402  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.2727980613708496  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.296811580657959  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.2726101875305176  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

torch.Size([25180, 256])
first layer input nodes number: 47537
first layer output nodes number: 25180
edges number: 160884
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.2971677780151367  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.321181297302246  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.327558994293213  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.327558994293213  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

m.shape torch.Size([1606, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.4187955856323242  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.4187955856323242  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1606, 256]), torch.Size([1, 1606, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.4223661422729492  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.448592185974121  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1606, 256])
m.shape torch.Size([1440, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.4496502876281738  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.4496502876281738  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1440, 256]), torch.Size([1, 1440, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.4524474143981934  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.4968409538269043  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1440, 256])
m.shape torch.Size([1176, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.4985709190368652  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.4985709190368652  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1176, 256]), torch.Size([1, 1176, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.500852108001709  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.5563597679138184  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1176, 256])
m.shape torch.Size([971, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.5584545135498047  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.5584545135498047  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 971, 256]), torch.Size([1, 971, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.5603065490722656  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.6146960258483887  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 971, 256])
m.shape torch.Size([837, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.6177926063537598  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.6177926063537598  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 837, 256]), torch.Size([1, 837, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.6193890571594238  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.6776089668273926  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 837, 256])
m.shape torch.Size([685, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.6807613372802734  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.6807613372802734  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 685, 256]), torch.Size([1, 685, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.68206787109375  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.740114688873291  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 685, 256])
m.shape torch.Size([592, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.7434444427490234  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.7434444427490234  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 592, 256]), torch.Size([1, 592, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.7445735931396484  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8013191223144531  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 592, 256])
m.shape torch.Size([517, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.80472993850708  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.80472993850708  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 517, 256]), torch.Size([1, 517, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8057160377502441  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.862475872039795  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 517, 256])
m.shape torch.Size([422, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.865633487701416  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.865633487701416  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 422, 256]), torch.Size([1, 422, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.866438388824463  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.920029640197754  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 422, 256])
m.shape torch.Size([380, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.9232797622680664  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.9232797622680664  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 380, 256]), torch.Size([1, 380, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.9240045547485352  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.9766321182250977  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 380, 256])
m.shape torch.Size([306, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.9798808097839355  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.9798808097839355  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.9804644584655762  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.027068614959717  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([271, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.029902458190918  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.029902458190918  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.03041934967041  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.076329231262207  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([243, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.0791072845458984  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.0791072845458984  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.079570770263672  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.122211456298828  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([223, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.1249804496765137  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.1249804496765137  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.125405788421631  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.1675143241882324  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([205, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.170257568359375  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.170257568359375  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.1706485748291016  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.212095260620117  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([149, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.214191436767578  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.214191436767578  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.214475631713867  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.2465896606445312  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([147, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.248849868774414  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.248849868774414  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.2491302490234375  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.28277587890625  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([112, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.284573554992676  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.284573554992676  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.284787178039551  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.311917304992676  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([107, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.3137645721435547  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.3137645721435547  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.3139686584472656  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.3413162231445312  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([111, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.3433480262756348  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.3433480262756348  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.343559741973877  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.3734116554260254  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([84, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.3754096031188965  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.3754096031188965  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.3755698204040527  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.3992819786071777  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([81, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.4009146690368652  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.4009146690368652  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.401069164276123  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.425015926361084  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([57, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.426198959350586  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.426198959350586  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.4263076782226562  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.443920135498047  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([61, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.445272922515869  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.445272922515869  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.4453892707824707  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.4650521278381348  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([926, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.487244129180908  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.487244129180908  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 926, 256]), torch.Size([1, 926, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.4890103340148926  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.8009705543518066  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 926, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.720688819885254  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.72255802154541  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.7244272232055664  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.722470760345459  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

torch.Size([11709, 40])
input nodes number: 25180
output nodes number: 11709
edges number: 92668
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.722689628601074  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.7226901054382324  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.04124593734741211  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

pseudo mini batch 2 input nodes size: 34395
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.03572797775268555  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.03572797775268555  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.05212879180908203  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.052215576171875  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.029460906982421875  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.031164169311523438  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.031164169311523438  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.031164169311523438  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

torch.Size([34395, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.031164169311523438  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

m.shape torch.Size([2134, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.09819984436035156  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.09819984436035156  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 2134, 128]), torch.Size([1, 2134, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.1002349853515625  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.11704158782958984  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 2134, 128])
m.shape torch.Size([2203, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.11812496185302734  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.11812496185302734  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 2203, 128]), torch.Size([1, 2203, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.12022590637207031  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.15205049514770508  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 2203, 128])
m.shape torch.Size([2015, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.15415143966674805  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.15415143966674805  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 2015, 128]), torch.Size([1, 2015, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.15607309341430664  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.1983494758605957  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 2015, 128])
m.shape torch.Size([1720, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.2006692886352539  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.2006692886352539  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1720, 128]), torch.Size([1, 1720, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.20230960845947266  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.2509775161743164  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1720, 128])
m.shape torch.Size([1538, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.25398731231689453  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.25398731231689453  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1538, 128]), torch.Size([1, 1538, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.25545406341552734  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.3085908889770508  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1538, 128])
m.shape torch.Size([1298, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.3115711212158203  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.3115711212158203  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1298, 128]), torch.Size([1, 1298, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.3128089904785156  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.36603736877441406  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1298, 128])
m.shape torch.Size([1116, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.3691434860229492  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.3691434860229492  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1116, 128]), torch.Size([1, 1116, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.3702077865600586  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.42598819732666016  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1116, 128])
m.shape torch.Size([998, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.4292631149291992  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.4292631149291992  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 998, 128]), torch.Size([1, 998, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.43021488189697266  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.4856100082397461  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 998, 128])
m.shape torch.Size([839, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.48873472213745117  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.48873472213745117  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 839, 128]), torch.Size([1, 839, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.489534854888916  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5428476333618164  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 839, 128])
m.shape torch.Size([7603, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5787014961242676  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5787014961242676  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 7603, 128]), torch.Size([1, 7603, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5859522819519043  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.1007580757141113  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 7603, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.043297290802002  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.0637669563293457  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.0842366218566895  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.0636067390441895  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

torch.Size([21464, 256])
first layer input nodes number: 34395
first layer output nodes number: 21464
edges number: 134320
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.0844950675964355  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.1049647331237793  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.1100821495056152  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.1100821495056152  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

m.shape torch.Size([1589, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.2030901908874512  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.2030901908874512  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1589, 256]), torch.Size([1, 1589, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.2069830894470215  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.2319693565368652  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1589, 256])
m.shape torch.Size([1400, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.2331452369689941  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.2331452369689941  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1400, 256]), torch.Size([1, 1400, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.2359538078308105  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.2764229774475098  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1400, 256])
m.shape torch.Size([1236, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.2785825729370117  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.2785825729370117  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1236, 256]), torch.Size([1, 1236, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.2811689376831055  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.3365421295166016  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1236, 256])
m.shape torch.Size([941, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.3393011093139648  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.3393011093139648  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 941, 256]), torch.Size([1, 941, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.3410959243774414  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.3931455612182617  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 941, 256])
m.shape torch.Size([787, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.3960304260253906  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.3960304260253906  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 787, 256]), torch.Size([1, 787, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.397531509399414  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.452845573425293  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 787, 256])
m.shape torch.Size([647, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.4558262825012207  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.4558262825012207  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 647, 256]), torch.Size([1, 647, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.4570603370666504  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.5107741355895996  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 647, 256])
m.shape torch.Size([553, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.5138778686523438  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.5138778686523438  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 553, 256]), torch.Size([1, 553, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.514932632446289  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.568756103515625  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 553, 256])
m.shape torch.Size([470, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.5718426704406738  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.5718426704406738  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 470, 256]), torch.Size([1, 470, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.5727391242980957  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.625105381011963  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 470, 256])
m.shape torch.Size([417, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.6282644271850586  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.6282644271850586  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 417, 256]), torch.Size([1, 417, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.6290597915649414  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.6808395385742188  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 417, 256])
m.shape torch.Size([362, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.6839213371276855  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.6839213371276855  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 362, 256]), torch.Size([1, 362, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.6846117973327637  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.7361512184143066  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 362, 256])
m.shape torch.Size([313, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.7391152381896973  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.7391152381896973  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.7397122383117676  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.786705493927002  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([256, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.7893595695495605  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.7893595695495605  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.7898478507995605  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8313517570495605  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([227, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.833944320678711  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.833944320678711  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8343772888183594  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8742103576660156  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([208, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8767929077148438  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8767929077148438  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8771896362304688  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.9164657592773438  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([197, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.9191079139709473  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.9191079139709473  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.9194836616516113  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.959312915802002  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([152, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.9614624977111816  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.9614624977111816  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.9617524147033691  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.9945130348205566  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([166, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.9970808029174805  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.9970808029174805  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.9973974227905273  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.0353918075561523  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([118, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.0372753143310547  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.0372753143310547  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.0375003814697266  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.0660839080810547  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([109, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.067962169647217  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.067962169647217  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.0681700706481934  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.0960288047790527  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([122, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.0982704162597656  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.0982704162597656  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.0985031127929688  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.1313133239746094  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([106, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.1338114738464355  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.1338114738464355  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.1340136528015137  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.163936138153076  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([62, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.1656928062438965  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.1656928062438965  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.165811061859131  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.184140682220459  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([78, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.1858062744140625  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.1858062744140625  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.185955047607422  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.2100563049316406  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([71, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.2116198539733887  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.2116198539733887  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.2117552757263184  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.2346415519714355  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([1005, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.2587223052978516  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.2587223052978516  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1005, 256]), torch.Size([1, 1005, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.260639190673828  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.6035823822021484  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1005, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.5233092308044434  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.5250368118286133  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.526764392852783  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.5249500274658203  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

torch.Size([11592, 40])
input nodes number: 21464
output nodes number: 11592
edges number: 94117
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.525055408477783  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.5250558853149414  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.034295082092285156  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

pseudo mini batch 3 input nodes size: 32808
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.029319286346435547  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.029319286346435547  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.04496335983276367  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.04504871368408203  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.028561115264892578  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.03011941909790039  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.03011941909790039  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.03011941909790039  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

torch.Size([32808, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.03011941909790039  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

m.shape torch.Size([1917, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.08968353271484375  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.08968353271484375  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1917, 128]), torch.Size([1, 1917, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.09151172637939453  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.1063680648803711  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1917, 128])
m.shape torch.Size([2057, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.10792255401611328  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.10792255401611328  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 2057, 128]), torch.Size([1, 2057, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.10988426208496094  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.14220619201660156  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 2057, 128])
m.shape torch.Size([1848, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.14294815063476562  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.14294815063476562  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1848, 128]), torch.Size([1, 1848, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.14471054077148438  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.18348312377929688  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1848, 128])
m.shape torch.Size([1618, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.185699462890625  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.185699462890625  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1618, 128]), torch.Size([1, 1618, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.1872425079345703  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.23200225830078125  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1618, 128])
m.shape torch.Size([1343, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.23443269729614258  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.23443269729614258  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1343, 128]), torch.Size([1, 1343, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.23571348190307617  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.28441381454467773  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1343, 128])
m.shape torch.Size([1178, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.2871437072753906  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.2871437072753906  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1178, 128]), torch.Size([1, 1178, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.2882671356201172  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.3369560241699219  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1178, 128])
m.shape torch.Size([1022, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.33980560302734375  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.33980560302734375  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1022, 128]), torch.Size([1, 1022, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.34078025817871094  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.38973379135131836  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1022, 128])
m.shape torch.Size([931, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.39279794692993164  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.39279794692993164  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 931, 128]), torch.Size([1, 931, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.39368581771850586  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.4449343681335449  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 931, 128])
m.shape torch.Size([797, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.44791078567504883  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.44791078567504883  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 797, 128]), torch.Size([1, 797, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.4486708641052246  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.49819087982177734  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 797, 128])
m.shape torch.Size([6600, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5292820930480957  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5292820930480957  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 6600, 128]), torch.Size([1, 6600, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.535576343536377  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.9889531135559082  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 6600, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.9369673728942871  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.9553837776184082  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.9738001823425293  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.9552397727966309  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

torch.Size([19311, 256])
first layer input nodes number: 32808
first layer output nodes number: 19311
edges number: 119605
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.9740467071533203  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.9924631118774414  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.9970674514770508  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.9970674514770508  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

m.shape torch.Size([1505, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.0849871635437012  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.0849871635437012  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1505, 256]), torch.Size([1, 1505, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.0882296562194824  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.112504482269287  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1505, 256])
m.shape torch.Size([1421, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.1138372421264648  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.1138372421264648  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1421, 256]), torch.Size([1, 1421, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.1166763305664062  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.1583328247070312  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1421, 256])
m.shape torch.Size([1157, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.1601471900939941  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.1601471900939941  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1157, 256]), torch.Size([1, 1157, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.162376880645752  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.2117338180541992  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1157, 256])
m.shape torch.Size([980, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.2142601013183594  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.2142601013183594  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 980, 256]), torch.Size([1, 980, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.2161293029785156  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.2720146179199219  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 980, 256])
m.shape torch.Size([802, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.2749342918395996  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.2749342918395996  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 802, 256]), torch.Size([1, 802, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.2764639854431152  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.3325161933898926  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 802, 256])
m.shape torch.Size([679, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.3356671333312988  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.3356671333312988  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 679, 256]), torch.Size([1, 679, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.3369622230529785  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.3932809829711914  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 679, 256])
m.shape torch.Size([581, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.3965425491333008  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.3965425491333008  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 581, 256]), torch.Size([1, 581, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.3976507186889648  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.4553871154785156  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 581, 256])
m.shape torch.Size([479, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.458878517150879  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.458878517150879  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 479, 256]), torch.Size([1, 479, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.459792137145996  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.5122122764587402  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 479, 256])
m.shape torch.Size([431, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.5154838562011719  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.5154838562011719  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 431, 256]), torch.Size([1, 431, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.516305923461914  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.569448471069336  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 431, 256])
m.shape torch.Size([387, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.5727572441101074  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.5727572441101074  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 387, 256]), torch.Size([1, 387, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.5734953880310059  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.6266283988952637  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 387, 256])
m.shape torch.Size([347, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.6299281120300293  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.6299281120300293  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 347, 256]), torch.Size([1, 347, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.6305899620056152  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.6833691596984863  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 347, 256])
m.shape torch.Size([285, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.6863255500793457  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.6863255500793457  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.6868691444396973  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.7349591255187988  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([246, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.7377610206604004  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.7377610206604004  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.7382302284240723  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.7813973426818848  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([216, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.784069538116455  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.784069538116455  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.7844815254211426  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.825268268585205  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([157, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8273258209228516  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8273258209228516  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8276252746582031  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8593673706054688  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([163, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8617243766784668  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8617243766784668  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8620352745056152  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8971667289733887  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([151, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8994789123535156  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8994789123535156  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8997669219970703  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.9343280792236328  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([139, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.936589241027832  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.936589241027832  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.936854362487793  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.970524787902832  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([103, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.972273349761963  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.972273349761963  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.9724698066711426  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.9987950325012207  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([114, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.0008883476257324  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.0008883476257324  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.001105785369873  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.031764507293701  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([102, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.033714771270752  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.033714771270752  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.033909320831299  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.0627026557922363  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([84, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.0643815994262695  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.0643815994262695  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.064541816711426  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.0893754959106445  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([72, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.0908870697021484  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.0908870697021484  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.091024398803711  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.113271713256836  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([67, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.114748954772949  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.114748954772949  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.1148767471313477  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.1364736557006836  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([759, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.1546473503112793  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.1546473503112793  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 759, 256]), torch.Size([1, 759, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.156095027923584  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.4112820625305176  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 759, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.3356332778930664  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.33779239654541  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.339951515197754  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.337707042694092  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

torch.Size([11427, 40])
input nodes number: 19311
output nodes number: 11427
edges number: 89427
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.3383679389953613  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.3383684158325195  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.033580780029296875  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

pseudo mini batch 4 input nodes size: 58305
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.028992652893066406  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.028992652893066406  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.05679464340209961  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.05687856674194336  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.041149139404296875  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.04291725158691406  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.04291725158691406  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.04291725158691406  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

torch.Size([58305, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.04291725158691406  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

m.shape torch.Size([2974, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.1267070770263672  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.1267070770263672  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 2974, 128]), torch.Size([1, 2974, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.12954330444335938  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.15351581573486328  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 2974, 128])
m.shape torch.Size([3144, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.15509605407714844  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.15509605407714844  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 3144, 128]), torch.Size([1, 3144, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.1580944061279297  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.20360755920410156  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 3144, 128])
m.shape torch.Size([2794, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.2066059112548828  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.2066059112548828  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 2794, 128]), torch.Size([1, 2794, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.20962142944335938  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.2696380615234375  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 2794, 128])
m.shape torch.Size([2398, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.27287960052490234  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.27287960052490234  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 2398, 128]), torch.Size([1, 2398, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.2753586769104004  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.34201765060424805  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 2398, 128])
m.shape torch.Size([2065, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.3457975387573242  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.3457975387573242  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 2065, 128]), torch.Size([1, 2065, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.34787607192993164  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.42470836639404297  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 2065, 128])
m.shape torch.Size([1659, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.4275989532470703  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.4275989532470703  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1659, 128]), torch.Size([1, 1659, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.4291810989379883  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.49724340438842773  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1659, 128])
m.shape torch.Size([1457, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5013155937194824  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5013155937194824  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1457, 128]), torch.Size([1, 1457, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5027050971984863  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5737824440002441  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1457, 128])
m.shape torch.Size([1302, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5787239074707031  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5787239074707031  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1302, 128]), torch.Size([1, 1302, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5799655914306641  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.6508140563964844  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1302, 128])
m.shape torch.Size([1093, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.654883861541748  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.654883861541748  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1093, 128]), torch.Size([1, 1093, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.6559262275695801  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.7247591018676758  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1093, 128])
m.shape torch.Size([8955, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.7669386863708496  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.7669386863708496  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 8955, 128]), torch.Size([1, 8955, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.7754788398742676  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.3821959495544434  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 8955, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.309340000152588  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.3358912467956543  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.3624424934387207  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.3356833457946777  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

torch.Size([27841, 256])
first layer input nodes number: 58305
first layer output nodes number: 27841
edges number: 167517
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.3628792762756348  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.3894305229187012  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.3960824012756348  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.3960824012756348  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

m.shape torch.Size([2028, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.46586275100708  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.46586275100708  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 2028, 256]), torch.Size([1, 2028, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.4707646369934082  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.503777027130127  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 2028, 256])
m.shape torch.Size([1740, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.5055265426635742  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.5055265426635742  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1740, 256]), torch.Size([1, 1740, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.509063720703125  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.5630111694335938  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1740, 256])
m.shape torch.Size([1347, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.5650568008422852  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.5650568008422852  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1347, 256]), torch.Size([1, 1347, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.5678596496582031  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.6253533363342285  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1347, 256])
m.shape torch.Size([1040, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.6282157897949219  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.6282157897949219  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1040, 256]), torch.Size([1, 1040, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.6302452087402344  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.6890764236450195  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1040, 256])
m.shape torch.Size([896, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.692215919494629  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.692215919494629  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 896, 256]), torch.Size([1, 896, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.693924903869629  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.756180763244629  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 896, 256])
m.shape torch.Size([606, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.7588210105895996  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.7588210105895996  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 606, 256]), torch.Size([1, 606, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.759976863861084  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8121752738952637  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 606, 256])
m.shape torch.Size([450, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8148760795593262  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8148760795593262  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 450, 256]), torch.Size([1, 450, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8157343864440918  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8615927696228027  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 450, 256])
m.shape torch.Size([460, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8647007942199707  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8647007942199707  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8655781745910645  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.9162373542785645  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([378, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.919562816619873  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.919562816619873  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 378, 256]), torch.Size([1, 378, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.9202837944030762  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.9681429862976074  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 378, 256])
m.shape torch.Size([279, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.9704642295837402  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.9704642295837402  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.970996379852295  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.00999116897583  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([220, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.0120511054992676  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.0120511054992676  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.0124707221984863  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.045200824737549  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([205, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.0473556518554688  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.0473556518554688  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.0477466583251953  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.080982208251953  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([196, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.083235740661621  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.083235740661621  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.0836095809936523  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.1180028915405273  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([157, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.119938373565674  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.119938373565674  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.1202378273010254  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.14988374710083  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([123, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.1515073776245117  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.1515073776245117  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.1517419815063477  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.176609992980957  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([114, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.178246021270752  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.178246021270752  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.1784634590148926  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.203033924102783  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([92, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.2044286727905273  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.2044286727905273  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.204604148864746  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.225661277770996  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([93, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.2271828651428223  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.2271828651428223  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.227360248565674  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.2498879432678223  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([68, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.2510414123535156  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.2510414123535156  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.251171112060547  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.2685508728027344  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([59, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.269620418548584  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.269620418548584  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.26973295211792  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.285600185394287  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([56, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.2866744995117188  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.2866744995117188  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.2867813110351562  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.3025894165039062  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([37, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.303318500518799  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.303318500518799  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.303389072418213  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.3143277168273926  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([47, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.31533145904541  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.31533145904541  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.3154211044311523  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.3299436569213867  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([36, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.3307294845581055  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.3307294845581055  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.3307981491088867  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.342402458190918  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([477, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.353829860687256  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.353829860687256  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 477, 256]), torch.Size([1, 477, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.3547396659851074  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.5162911415100098  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 477, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.458329677581787  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.460780620574951  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.4624505043029785  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.4599156379699707  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

torch.Size([11204, 40])
input nodes number: 27841
output nodes number: 11204
edges number: 69712
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.4604992866516113  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.4604997634887695  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.04668140411376953  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

pseudo mini batch 5 input nodes size: 68449
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.04144096374511719  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.04144096374511719  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.07464408874511719  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.07472705841064453  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.04684114456176758  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.04913187026977539  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.04913187026977539  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.04913187026977539  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

torch.Size([68449, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.04913187026977539  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

m.shape torch.Size([2883, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.16370582580566406  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.16370582580566406  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 2883, 128]), torch.Size([1, 2883, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.16645526885986328  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.18917179107666016  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 2883, 128])
m.shape torch.Size([2909, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.19057130813598633  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.19057130813598633  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 2909, 128]), torch.Size([1, 2909, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.19400596618652344  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.23561954498291016  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 2909, 128])
m.shape torch.Size([2437, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.23839378356933594  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.23839378356933594  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 2437, 128]), torch.Size([1, 2437, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.2407693862915039  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.2940535545349121  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 2437, 128])
m.shape torch.Size([2136, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.29637765884399414  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.29637765884399414  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 2136, 128]), torch.Size([1, 2136, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.298429012298584  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.3592557907104492  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 2136, 128])
m.shape torch.Size([1921, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.36281728744506836  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.36281728744506836  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1921, 128]), torch.Size([1, 1921, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.36464929580688477  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.4306015968322754  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1921, 128])
m.shape torch.Size([1641, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.43438053131103516  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.43438053131103516  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1641, 128]), torch.Size([1, 1641, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.4359455108642578  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.503239631652832  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1641, 128])
m.shape torch.Size([1494, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.507443904876709  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.507443904876709  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1494, 128]), torch.Size([1, 1494, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5088686943054199  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5801081657409668  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1494, 128])
m.shape torch.Size([1326, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5844540596008301  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5844540596008301  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1326, 128]), torch.Size([1, 1326, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5857186317443848  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.658881664276123  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1326, 128])
m.shape torch.Size([1226, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.663510799407959  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.663510799407959  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1226, 128]), torch.Size([1, 1226, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.664680004119873  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.741981029510498  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1226, 128])
m.shape torch.Size([15504, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.8153252601623535  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.8153252601623535  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 15504, 128]), torch.Size([1, 15504, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.830111026763916  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8799004554748535  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 15504, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.777618408203125  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.809544563293457  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.841470718383789  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8092947006225586  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

torch.Size([33477, 256])
first layer input nodes number: 68449
first layer output nodes number: 33477
edges number: 231147
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8419828414916992  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8739089965820312  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8818907737731934  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.8818907737731934  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

m.shape torch.Size([2027, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.9575438499450684  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.9575438499450684  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 2027, 256]), torch.Size([1, 2027, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.9620003700256348  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.9947800636291504  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 2027, 256])
m.shape torch.Size([1699, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.995774745941162  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.995774745941162  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1699, 256]), torch.Size([1, 1699, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.9993658065795898  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.051241397857666  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1699, 256])
m.shape torch.Size([1209, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.052888870239258  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.052888870239258  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1209, 256]), torch.Size([1, 1209, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.0554256439208984  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.1105470657348633  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1209, 256])
m.shape torch.Size([941, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.1128811836242676  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.1128811836242676  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 941, 256]), torch.Size([1, 941, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.114675998687744  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.167229175567627  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 941, 256])
m.shape torch.Size([794, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.1701788902282715  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.1701788902282715  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 794, 256]), torch.Size([1, 794, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.1716933250427246  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.228623867034912  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 794, 256])
m.shape torch.Size([637, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.2315402030944824  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.2315402030944824  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 637, 256]), torch.Size([1, 637, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.232755184173584  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.2852654457092285  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 637, 256])
m.shape torch.Size([482, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.287900924682617  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.287900924682617  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 482, 256]), torch.Size([1, 482, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.288820266723633  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.3352088928222656  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 482, 256])
m.shape torch.Size([384, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.3377017974853516  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.3377017974853516  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 384, 256]), torch.Size([1, 384, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.3384342193603516  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.3807544708251953  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 384, 256])
m.shape torch.Size([318, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.383139133453369  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.383139133453369  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.3837456703186035  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.423771381378174  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([289, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.426246166229248  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.426246166229248  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.426797389984131  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.4661917686462402  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 289, 256])
m.shape torch.Size([241, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.4684643745422363  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.4684643745422363  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.468924045562744  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.5047783851623535  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([207, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.5069360733032227  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.5069360733032227  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.507330894470215  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.540890693664551  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([157, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.5426549911499023  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.5426549911499023  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.542954444885254  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.5705041885375977  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([126, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.572050094604492  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.572050094604492  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.5722904205322266  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.5960826873779297  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([115, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.5976204872131348  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.5976204872131348  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.597839832305908  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.6210904121398926  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([108, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.6226415634155273  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.6226415634155273  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.622847557067871  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.646124839782715  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([90, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.6474924087524414  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.6474924087524414  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.6476640701293945  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.6682634353637695  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([84, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.669631004333496  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.669631004333496  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.6697912216186523  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.690138816833496  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([97, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.6918301582336426  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.6918301582336426  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.6920151710510254  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.7168068885803223  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([88, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.7184062004089355  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.7184062004089355  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.718574047088623  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.7422404289245605  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([60, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.7435708045959473  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.7435708045959473  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.743685245513916  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.760622501373291  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([43, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.761474609375  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.761474609375  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.761556625366211  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.7742691040039062  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([38, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.7750682830810547  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.7750682830810547  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.7751407623291016  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.7868824005126953  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([59, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.788207530975342  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.788207530975342  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.7883200645446777  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.807338237762451  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([793, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.826961040496826  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.826961040496826  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 793, 256]), torch.Size([1, 793, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.8284735679626465  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.0946784019470215  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 793, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.0310535430908203  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.0329504013061523  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.034602642059326  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.032622814178467  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

torch.Size([11086, 40])
input nodes number: 33477
output nodes number: 11086
edges number: 76165
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.0324015617370605  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.0324020385742188  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.05282115936279297  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

pseudo mini batch 6 input nodes size: 68316
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.04628705978393555  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.04628705978393555  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.07949018478393555  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.0795745849609375  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.046288490295410156  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.04986000061035156  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.04986000061035156  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.04986000061035156  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

torch.Size([68316, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.04986000061035156  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

m.shape torch.Size([1844, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.2172560691833496  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.2172560691833496  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1844, 128]), torch.Size([1, 1844, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.21901464462280273  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.23308324813842773  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1844, 128])
m.shape torch.Size([1852, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.23397016525268555  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.23397016525268555  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1852, 128]), torch.Size([1, 1852, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.23573637008666992  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.26222944259643555  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1852, 128])
m.shape torch.Size([1791, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.2644209861755371  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.2644209861755371  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1791, 128]), torch.Size([1, 1791, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.2661290168762207  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.30372095108032227  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1791, 128])
m.shape torch.Size([1662, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.3060579299926758  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.3060579299926758  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1662, 128]), torch.Size([1, 1662, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.30764293670654297  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.3536081314086914  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1662, 128])
m.shape torch.Size([1592, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.3566112518310547  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.3566112518310547  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1592, 128]), torch.Size([1, 1592, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.35812950134277344  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.4136219024658203  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1592, 128])
m.shape torch.Size([1510, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.41742515563964844  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.41742515563964844  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1510, 128]), torch.Size([1, 1510, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.4188652038574219  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.4807872772216797  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1510, 128])
m.shape torch.Size([1450, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.4849071502685547  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.4849071502685547  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1450, 128]), torch.Size([1, 1450, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.48628997802734375  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5557374954223633  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1450, 128])
m.shape torch.Size([1351, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5601997375488281  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5601997375488281  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1351, 128]), torch.Size([1, 1351, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.561488151550293  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.6382408142089844  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1351, 128])
m.shape torch.Size([1350, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.6433901786804199  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.6433901786804199  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1350, 128]), torch.Size([1, 1350, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.6446776390075684  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.727226734161377  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1350, 128])
m.shape torch.Size([27292, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.8567214012145996  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.8567214012145996  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 27292, 128]), torch.Size([1, 27292, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.882749080657959  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.7307143211364746  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 27292, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.574380874633789  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.6141433715820312  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.6539058685302734  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.613832473754883  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

torch.Size([41694, 256])
first layer input nodes number: 68316
first layer output nodes number: 41694
edges number: 340617
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.654417037963867  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.6941795349121094  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.70412015914917  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.70412015914917  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

m.shape torch.Size([1228, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.839130401611328  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.839130401611328  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 1228, 256]), torch.Size([1, 1228, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.8421630859375  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.8629813194274902  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 1228, 256])
m.shape torch.Size([980, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.8633079528808594  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.8633079528808594  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 980, 256]), torch.Size([1, 980, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.8651771545410156  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.898296356201172  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 980, 256])
m.shape torch.Size([799, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.8996658325195312  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.8996658325195312  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 799, 256]), torch.Size([1, 799, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.9011898040771484  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.9347171783447266  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 799, 256])
m.shape torch.Size([633, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.9363889694213867  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.9363889694213867  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 633, 256]), torch.Size([1, 633, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.937596321105957  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.972609519958496  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 633, 256])
m.shape torch.Size([550, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.974648952484131  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.974648952484131  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 550, 256]), torch.Size([1, 550, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 2.9756979942321777  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.0144782066345215  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 550, 256])
m.shape torch.Size([454, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.0165719985961914  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.0165719985961914  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 454, 256]), torch.Size([1, 454, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.0174379348754883  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.056030750274658  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 454, 256])
m.shape torch.Size([370, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.058670997619629  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.058670997619629  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 370, 256]), torch.Size([1, 370, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.0593767166137695  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.097842216491699  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 370, 256])
m.shape torch.Size([304, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.0998268127441406  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.0998268127441406  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.1004066467285156  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.136819839477539  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([319, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.139289379119873  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.139289379119873  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.1398978233337402  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.180354595184326  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([295, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.1837387084960938  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.1837387084960938  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.1843013763427734  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.2247161865234375  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([262, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.227205276489258  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.227205276489258  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.2277050018310547  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.267658233642578  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([256, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.2703609466552734  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.2703609466552734  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.2708492279052734  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.3123531341552734  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([227, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.314945697784424  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.314945697784424  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.3153786659240723  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.3552117347717285  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([195, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.357619285583496  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.357619285583496  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.3579912185668945  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.39481258392334  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([190, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.3973660469055176  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.3973660469055176  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.397728443145752  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.4361424446105957  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([172, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.4386062622070312  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.4386062622070312  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.438934326171875  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.4760055541992188  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([164, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.4785213470458984  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.4785213470458984  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.4788341522216797  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.5163707733154297  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([175, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.519242286682129  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.519242286682129  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.519576072692871  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.561966896057129  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([154, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.56461238861084  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.56461238861084  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.564906120300293  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.6042661666870117  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([157, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.607137680053711  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.607137680053711  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.6074371337890625  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.649660110473633  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([135, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.6522727012634277  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.6522727012634277  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.6525301933288574  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.690639019012451  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([99, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.692715644836426  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.692715644836426  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.692904472351074  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.722172737121582  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([119, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.7247090339660645  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.7247090339660645  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 3.724936008453369  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2615966796875 GB
    Memory Allocated: 3.7617058753967285  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([109, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.2615966796875 GB
    Memory Allocated: 3.7641067504882812  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2615966796875 GB
    Memory Allocated: 3.7641067504882812  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 7.2635498046875 GB
    Memory Allocated: 3.764314651489258  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2987060546875 GB
    Memory Allocated: 3.799449920654297  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([2982, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.3006591796875 GB
    Memory Allocated: 3.870997905731201  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3006591796875 GB
    Memory Allocated: 3.870997905731201  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

 h.shape torch.Size([1, 2982, 256]), torch.Size([1, 2982, 256])
----------------------------------------3
 Nvidia-smi: 7.3006591796875 GB
    Memory Allocated: 3.876685619354248  GigaBytes
Max Memory Allocated: 4.864977836608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3006591796875 GB
    Memory Allocated: 4.877723217010498  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 2982, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3006591796875 GB
    Memory Allocated: 4.752635955810547  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3006591796875 GB
    Memory Allocated: 4.754455089569092  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3006591796875 GB
    Memory Allocated: 4.756923198699951  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.3006591796875 GB
    Memory Allocated: 4.755019664764404  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

torch.Size([11328, 40])
input nodes number: 41694
output nodes number: 11328
edges number: 138591
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3006591796875 GB
    Memory Allocated: 4.755337238311768  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.3006591796875 GB
    Memory Allocated: 4.755337715148926  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.05595541000366211  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

pseudo mini batch 7 input nodes size: 83872
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.04621076583862305  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.04621076583862305  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.08620405197143555  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.08628654479980469  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.052999019622802734  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.05666303634643555  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.05666303634643555  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.05666303634643555  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

torch.Size([83872, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.05666303634643555  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

m.shape torch.Size([2325, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.24260425567626953  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.24260425567626953  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 2325, 128]), torch.Size([1, 2325, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.24526453018188477  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.26363515853881836  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 2325, 128])
m.shape torch.Size([2531, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.2649402618408203  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.2649402618408203  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 2531, 128]), torch.Size([1, 2531, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.26735401153564453  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.3039565086364746  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 2531, 128])
m.shape torch.Size([2336, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.30609130859375  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.30609130859375  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 2336, 128]), torch.Size([1, 2336, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.30848026275634766  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.3594784736633301  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 2336, 128])
m.shape torch.Size([2110, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.3628201484680176  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.3628201484680176  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 2110, 128]), torch.Size([1, 2110, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.3652496337890625  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.42597389221191406  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 2110, 128])
m.shape torch.Size([2122, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.4300270080566406  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.4300270080566406  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 2122, 128]), torch.Size([1, 2122, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.4320507049560547  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5080680847167969  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 2122, 128])
m.shape torch.Size([1923, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.513127326965332  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.513127326965332  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1923, 128]), torch.Size([1, 1923, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5149612426757812  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5938196182250977  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1923, 128])
m.shape torch.Size([1820, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5989775657653809  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5989775657653809  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1820, 128]), torch.Size([1, 1820, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.6007132530212402  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.6883730888366699  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1820, 128])
m.shape torch.Size([1773, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.6942687034606934  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.6942687034606934  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1773, 128]), torch.Size([1, 1773, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.6959595680236816  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.7923388481140137  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1773, 128])
m.shape torch.Size([1687, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.7987332344055176  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.7987332344055176  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1687, 128]), torch.Size([1, 1687, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.8003420829772949  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.9042487144470215  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1687, 128])
m.shape torch.Size([29056, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.0421161651611328  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.0421161651611328  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 29056, 128]), torch.Size([1, 29056, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.0698261260986328  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.037233352661133  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 29056, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.865142345428467  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.910616397857666  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.9560904502868652  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.9102606773376465  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

torch.Size([47683, 256])
first layer input nodes number: 83872
first layer output nodes number: 47683
edges number: 377650
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.9567174911499023  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.0021915435791016  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.0135602951049805  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.0135602951049805  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

m.shape torch.Size([1426, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.124978542327881  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.124978542327881  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1426, 256]), torch.Size([1, 1426, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.1288890838623047  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.152986526489258  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1426, 256])
m.shape torch.Size([1235, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.1541037559509277  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.1541037559509277  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1235, 256]), torch.Size([1, 1235, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.1565093994140625  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.1973419189453125  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1235, 256])
m.shape torch.Size([980, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.198946952819824  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.198946952819824  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 980, 256]), torch.Size([1, 980, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.2008161544799805  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.241938591003418  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 980, 256])
m.shape torch.Size([708, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.2438979148864746  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.2438979148864746  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 708, 256]), torch.Size([1, 708, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.245248317718506  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.2856597900390625  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 708, 256])
m.shape torch.Size([643, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.2880749702453613  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.2880749702453613  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 643, 256]), torch.Size([1, 643, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.2893013954162598  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.3355135917663574  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 643, 256])
m.shape torch.Size([485, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.3376975059509277  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.3376975059509277  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 485, 256]), torch.Size([1, 485, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.338622570037842  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.3801116943359375  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 485, 256])
m.shape torch.Size([429, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.382535457611084  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.382535457611084  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 429, 256]), torch.Size([1, 429, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.3833537101745605  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.4247097969055176  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 429, 256])
m.shape torch.Size([348, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.4269766807556152  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.4269766807556152  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 348, 256]), torch.Size([1, 348, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.427640438079834  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.466622829437256  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 348, 256])
m.shape torch.Size([315, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.4690160751342773  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.4690160751342773  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 315, 256]), torch.Size([1, 315, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.4696168899536133  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.5086803436279297  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 315, 256])
m.shape torch.Size([278, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.511052131652832  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.511052131652832  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.511582374572754  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.549755573272705  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([268, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.5523242950439453  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.5523242950439453  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.552835464477539  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.593587875366211  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([238, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.5960774421691895  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.5960774421691895  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.596531391143799  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.6351170539855957  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([185, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.6372017860412598  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.6372017860412598  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.63755464553833  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.670017719268799  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([155, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.671926975250244  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.671926975250244  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.67222261428833  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.701490879058838  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([154, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.703563690185547  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.703563690185547  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.703857421875  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.7349929809570312  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([148, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.737122058868408  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.737122058868408  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.7374043464660645  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.7693028450012207  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([128, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.7712531089782715  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.7712531089782715  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.7714972496032715  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.8007941246032715  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([137, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.803042411804199  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.803042411804199  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.8033037185668945  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.836489677429199  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([123, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.8386054039001465  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.8386054039001465  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.8388400077819824  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.870276927947998  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([98, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.8720436096191406  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.8720436096191406  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.8722305297851562  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.8985862731933594  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([125, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.9010162353515625  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.9010162353515625  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.901254653930664  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.9365406036376953  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([104, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.9386205673217773  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.9386205673217773  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.93881893157959  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.9695653915405273  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([69, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.970991611480713  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.970991611480713  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.971123218536377  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.992443561553955  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([83, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.994292736053467  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.994292736053467  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.9944510459899902  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 4.021205425262451  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([2173, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 4.073339462280273  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 4.073339462280273  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 2173, 256]), torch.Size([1, 2173, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 4.077484130859375  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 4.830657005310059  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 2173, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 4.7301154136657715  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 4.731977939605713  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 4.7336225509643555  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 4.731677532196045  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

torch.Size([11035, 40])
input nodes number: 47683
output nodes number: 11035
edges number: 114008
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 4.731941223144531  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 4.7319416999816895  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.06297445297241211  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.06297445297241211  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.06297445297241211  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.018388032913208008 |0.0031294822692871094 |0.12334507703781128 |0.00010064244270324707 |0.07872027158737183 |0.005614519119262695 |
----------------------------------------------------------pseudo_mini_loss sum 4.653969764709473
Total (block generation + training)time/epoch 24.25474214553833
Training time/epoch 1.850830316543579
Training time without block to device /epoch 1.8257944583892822
Training time without total dataloading part /epoch 1.6229424476623535
load block tensor time/epoch 0.14710426330566406
block to device time/epoch 0.025035858154296875
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  661433
Number of first layer input nodes during this epoch:  424814
Number of first layer output nodes during this epoch:  236619
----------------------------------------before generate dataloader block 
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.0629739761352539  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02478313446044922
global_2_local spend time (sec) 0.04959273338317871
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004787445068359375
A = g.adjacency_matrix() spent  0.010151386260986328
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08773422241210938
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.3215432167053223
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent [05:12:39] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28452268 edges into 8 parts and get 4732720 edge cuts
 1.1690857410430908

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])
drop edges based on redundancy f4

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096})
Convert a graph into a bidirected graph: 1.206 seconds
Metis partitioning: 5.245 seconds
Split the graph: 1.856 seconds
Construct subgraphs: 0.066 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  8.387436389923096
11708
11627
11106
11602
11161
11083
11619
11035
total k batches seeds list generation spend  19.385705709457397
after graph partition
graph partition algorithm spend time 19.478379011154175
11708
11627
11106
11602
11161
11083
11619
11035
partition_len_list
[24927, 20690, 19283, 22152, 29107, 34661, 42322, 47900]
shared_neighbor_graph_partition_s0 selection method  spend 19.58087921142578
time for parepare:  0.01766180992126465
local_output_nid generation:  0.003432035446166992
local_in_edges_tensor generation:  0.002343416213989258
mini_batch_src_global generation:  0.0036547183990478516
r_  generation:  0.03219795227050781
local_output_nid generation:  0.002650022506713867
local_in_edges_tensor generation:  0.002028942108154297
mini_batch_src_global generation:  0.0034246444702148438
r_  generation:  0.027843713760375977
local_output_nid generation:  0.002555370330810547
local_in_edges_tensor generation:  0.002244710922241211
mini_batch_src_global generation:  0.004838705062866211
r_  generation:  0.0313420295715332
local_output_nid generation:  0.0026962757110595703
local_in_edges_tensor generation:  0.0022270679473876953
mini_batch_src_global generation:  0.0038077831268310547
r_  generation:  0.03224539756774902
local_output_nid generation:  0.0026526451110839844
local_in_edges_tensor generation:  0.0019621849060058594
mini_batch_src_global generation:  0.002949237823486328
r_  generation:  0.027946949005126953
local_output_nid generation:  0.0026717185974121094
local_in_edges_tensor generation:  0.002012014389038086
mini_batch_src_global generation:  0.0032465457916259766
r_  generation:  0.030379772186279297
local_output_nid generation:  0.0027730464935302734
local_in_edges_tensor generation:  0.0023162364959716797
mini_batch_src_global generation:  0.0059773921966552734
r_  generation:  0.04816007614135742
local_output_nid generation:  0.002976655960083008
local_in_edges_tensor generation:  0.002452850341796875
mini_batch_src_global generation:  0.005041360855102539
r_  generation:  0.043135881423950195
----------------------check_connections_block total spend ----------------------------- 0.43945765495300293
generate_one_block  0.04661202430725098
generate_one_block  0.03354358673095703
generate_one_block  0.03814816474914551
generate_one_block  0.0403439998626709
generate_one_block  0.03420758247375488
generate_one_block  0.03857231140136719
generate_one_block  0.06668877601623535
generate_one_block  0.05687427520751953
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.040285348892211914
gen group dst list time:  0.006821632385253906
time for parepare:  0.020838499069213867
local_output_nid generation:  0.004571676254272461
local_in_edges_tensor generation:  0.012155294418334961
mini_batch_src_global generation:  0.004918813705444336
r_  generation:  0.0559391975402832
local_output_nid generation:  0.005350351333618164
local_in_edges_tensor generation:  0.004267692565917969
mini_batch_src_global generation:  0.004634857177734375
r_  generation:  0.04129195213317871
local_output_nid generation:  0.005113124847412109
local_in_edges_tensor generation:  0.00435638427734375
mini_batch_src_global generation:  0.0036242008209228516
r_  generation:  0.043209075927734375
local_output_nid generation:  0.005438804626464844
local_in_edges_tensor generation:  0.004472017288208008
mini_batch_src_global generation:  0.0045757293701171875
r_  generation:  0.048876047134399414
local_output_nid generation:  0.007375955581665039
local_in_edges_tensor generation:  0.00616145133972168
mini_batch_src_global generation:  0.006313800811767578
r_  generation:  0.06812310218811035
local_output_nid generation:  0.008571863174438477
local_in_edges_tensor generation:  0.00845646858215332
mini_batch_src_global generation:  0.00922250747680664
r_  generation:  0.08756208419799805
local_output_nid generation:  0.009516000747680664
local_in_edges_tensor generation:  0.012179851531982422
mini_batch_src_global generation:  0.0129241943359375
r_  generation:  0.11976265907287598
local_output_nid generation:  0.01094365119934082
local_in_edges_tensor generation:  0.016324520111083984
mini_batch_src_global generation:  0.01538991928100586
r_  generation:  0.13381266593933105
----------------------check_connections_block total spend ----------------------------- 0.9549994468688965
generate_one_block  0.07087063789367676
generate_one_block  0.052893877029418945
generate_one_block  0.05574226379394531
generate_one_block  0.06174302101135254
generate_one_block  0.09104466438293457
generate_one_block  0.11508345603942871
generate_one_block  0.15664362907409668
generate_one_block  0.1799612045288086
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.0629739761352539  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

connection checking time:  0.9549994468688965
block generation total time  0.7839827537536621
average batch blocks generation time:  0.09799784421920776
block dataloader generation time/epoch 22.343218326568604
pseudo mini batch 0 input nodes size: 47217
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.052823543548583984  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.052823543548583984  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.07533836364746094  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.07542562484741211  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.03534984588623047  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.03717613220214844  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.03717613220214844  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.03717613220214844  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

torch.Size([47217, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.03717613220214844  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

m.shape torch.Size([2430, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.11466264724731445  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.11466264724731445  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 2430, 128]), torch.Size([1, 2430, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.11698007583618164  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.13577938079833984  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 2430, 128])
m.shape torch.Size([2621, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.13712024688720703  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.13712024688720703  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 2621, 128]), torch.Size([1, 2621, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.1403942108154297  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.1783585548400879  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 2621, 128])
m.shape torch.Size([2357, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.18078231811523438  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.18078231811523438  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 2357, 128]), torch.Size([1, 2357, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.18311500549316406  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.23388671875  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 2357, 128])
m.shape torch.Size([2010, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.23641157150268555  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.23641157150268555  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 2010, 128]), torch.Size([1, 2010, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.2383284568786621  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.2939181327819824  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 2010, 128])
m.shape torch.Size([1766, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.29717016220092773  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.29717016220092773  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1766, 128]), torch.Size([1, 1766, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.29885435104370117  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.36008358001708984  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1766, 128])
m.shape torch.Size([1484, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.36348724365234375  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.36348724365234375  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1484, 128]), torch.Size([1, 1484, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.3649024963378906  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.42575836181640625  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1484, 128])
m.shape torch.Size([1333, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.42950010299682617  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.42950010299682617  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1333, 128]), torch.Size([1, 1333, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.4307713508605957  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.4973587989807129  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1333, 128])
m.shape torch.Size([1203, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.501312255859375  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.501312255859375  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1203, 128]), torch.Size([1, 1203, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5024595260620117  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5680751800537109  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1203, 128])
m.shape torch.Size([1022, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5718874931335449  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5718874931335449  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1022, 128]), torch.Size([1, 1022, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5728621482849121  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.6366915702819824  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1022, 128])
m.shape torch.Size([8701, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.6776938438415527  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.6776938438415527  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 8701, 128]), torch.Size([1, 8701, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.6859917640686035  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.275144100189209  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 8701, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.208178997039795  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.2319512367248535  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.255723476409912  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.2317652702331543  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

torch.Size([24927, 256])
first layer input nodes number: 47217
first layer output nodes number: 24927
edges number: 155680
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.2560772895812988  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.2798495292663574  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.2857928276062012  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.2857928276062012  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

m.shape torch.Size([1704, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.37373685836792  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.37373685836792  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1704, 256]), torch.Size([1, 1704, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.377392292022705  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.403393268585205  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1704, 256])
m.shape torch.Size([1533, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.404726505279541  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.404726505279541  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1533, 256]), torch.Size([1, 1533, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.4077353477478027  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.4521431922912598  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1533, 256])
m.shape torch.Size([1208, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.454279899597168  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.454279899597168  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1208, 256]), torch.Size([1, 1208, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.4566459655761719  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.5094499588012695  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1208, 256])
m.shape torch.Size([974, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.5126357078552246  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.5126357078552246  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 974, 256]), torch.Size([1, 974, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.514493465423584  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.569383144378662  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 974, 256])
m.shape torch.Size([836, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.572472095489502  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.572472095489502  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 836, 256]), torch.Size([1, 836, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.5740666389465332  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.6322636604309082  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 836, 256])
m.shape torch.Size([650, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.6352148056030273  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.6352148056030273  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 650, 256]), torch.Size([1, 650, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.6364545822143555  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.6979703903198242  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 650, 256])
m.shape torch.Size([580, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.7012529373168945  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.7012529373168945  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 580, 256]), torch.Size([1, 580, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.7023591995239258  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.7656240463256836  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 580, 256])
m.shape torch.Size([505, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.7689542770385742  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.7689542770385742  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 505, 256]), torch.Size([1, 505, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.7699174880981445  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8253545761108398  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 505, 256])
m.shape torch.Size([414, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8284544944763184  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8284544944763184  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 414, 256]), torch.Size([1, 414, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8292441368103027  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.881192684173584  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 414, 256])
m.shape torch.Size([372, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.884373664855957  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.884373664855957  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 372, 256]), torch.Size([1, 372, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8850831985473633  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9358882904052734  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 372, 256])
m.shape torch.Size([292, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9386210441589355  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9386210441589355  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9391779899597168  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9841790199279785  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([285, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9871878623962402  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9871878623962402  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9877314567565918  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.0339484214782715  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([225, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.0364880561828613  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.0364880561828613  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.036917209625244  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.076399326324463  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([212, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.079037666320801  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.079037666320801  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.079442024230957  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.119473457336426  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([201, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.1221694946289062  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.1221694946289062  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.1225528717041016  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.1631908416748047  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([145, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.165229320526123  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.165229320526123  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.165505886077881  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.1967577934265137  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([148, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.199038028717041  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.199038028717041  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.1993203163146973  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.2331948280334473  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([118, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.23537015914917  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.23537015914917  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.235595226287842  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.26417875289917  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([93, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.2657647132873535  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.2657647132873535  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.265942096710205  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.2897114753723145  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([93, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.2914109230041504  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.2914109230041504  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.291588306427002  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.3165993690490723  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([84, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.318206310272217  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.318206310272217  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.318366527557373  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.342078685760498  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([89, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.3438806533813477  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.3438806533813477  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.344050407409668  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.3703622817993164  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([67, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.3717589378356934  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.3717589378356934  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.371886730194092  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.3925890922546387  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([63, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.3939785957336426  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.3939785957336426  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.3940987586975098  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.4144062995910645  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([817, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.434030055999756  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.434030055999756  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 817, 256]), torch.Size([1, 817, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.4355883598327637  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.7156710624694824  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 817, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.6403908729553223  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.642427921295166  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.6441726684570312  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.6420483589172363  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

torch.Size([11708, 40])
input nodes number: 24927
output nodes number: 11708
edges number: 89243
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.642714023590088  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.6427149772644043  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.04110240936279297  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

pseudo mini batch 1 input nodes size: 33166
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.03574323654174805  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.03574323654174805  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.05155801773071289  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.05164480209350586  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.029042720794677734  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.03042745590209961  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.03042745590209961  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.03042745590209961  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

torch.Size([33166, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.03042745590209961  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

m.shape torch.Size([2664, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.08763504028320312  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.08763504028320312  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 2664, 128]), torch.Size([1, 2664, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.09045219421386719  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.11106300354003906  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 2664, 128])
m.shape torch.Size([2746, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.11330223083496094  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.11330223083496094  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 2746, 128]), torch.Size([1, 2746, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.1159210205078125  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.1569366455078125  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 2746, 128])
m.shape torch.Size([2306, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.15834808349609375  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.15834808349609375  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 2306, 128]), torch.Size([1, 2306, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.1614665985107422  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.2126455307006836  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 2306, 128])
m.shape torch.Size([1978, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.2148418426513672  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.2148418426513672  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1978, 128]), torch.Size([1, 1978, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.21672821044921875  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.27143287658691406  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1978, 128])
m.shape torch.Size([1677, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.2744879722595215  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.2744879722595215  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1677, 128]), torch.Size([1, 1677, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.27608728408813477  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.3363947868347168  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1677, 128])
m.shape torch.Size([1385, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.3395576477050781  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.3395576477050781  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1385, 128]), torch.Size([1, 1385, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.3408784866333008  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.3997354507446289  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1385, 128])
m.shape torch.Size([1106, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.40276670455932617  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.40276670455932617  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1106, 128]), torch.Size([1, 1106, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.4038214683532715  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.45778846740722656  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1106, 128])
m.shape torch.Size([997, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.46106433868408203  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.46106433868408203  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 997, 128]), torch.Size([1, 997, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.46201515197753906  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5172929763793945  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 997, 128])
m.shape torch.Size([833, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5203924179077148  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5203924179077148  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 833, 128]), torch.Size([1, 833, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5211868286132812  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5726833343505859  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 833, 128])
m.shape torch.Size([4998, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5961184501647949  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5961184501647949  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 4998, 128]), torch.Size([1, 4998, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.6008849143981934  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.9478650093078613  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 4998, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.900665283203125  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.9203968048095703  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.9401283264160156  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.9202423095703125  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

torch.Size([20690, 256])
first layer input nodes number: 33166
first layer output nodes number: 20690
edges number: 112876
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.9403777122497559  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.9601092338562012  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.9650421142578125  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.9650421142578125  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

m.shape torch.Size([1930, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.0374517440795898  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.0374517440795898  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1930, 256]), torch.Size([1, 1930, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.041132926940918  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.0716323852539062  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1930, 256])
m.shape torch.Size([1718, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.0734987258911133  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.0734987258911133  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1718, 256]), torch.Size([1, 1718, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.076889991760254  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.1264066696166992  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1718, 256])
m.shape torch.Size([1357, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.1295843124389648  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.1295843124389648  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1357, 256]), torch.Size([1, 1357, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.132211685180664  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.1903753280639648  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1357, 256])
m.shape torch.Size([1104, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.1933255195617676  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.1933255195617676  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1104, 256]), torch.Size([1, 1104, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.195695400238037  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.260033130645752  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1104, 256])
m.shape torch.Size([907, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.2633390426635742  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.2633390426635742  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 907, 256]), torch.Size([1, 907, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.2650690078735352  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.327347755432129  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 907, 256])
m.shape torch.Size([707, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.3305602073669434  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.3305602073669434  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 707, 256]), torch.Size([1, 707, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.3319087028503418  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.3918251991271973  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 707, 256])
m.shape torch.Size([599, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.3951811790466309  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.3951811790466309  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 599, 256]), torch.Size([1, 599, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.3963236808776855  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.4540352821350098  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 599, 256])
m.shape torch.Size([501, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.4573163986206055  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.4573163986206055  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 501, 256]), torch.Size([1, 501, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.4582719802856445  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.5138006210327148  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 501, 256])
m.shape torch.Size([404, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.516817569732666  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.516817569732666  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.5175881385803223  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.5670514106750488  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([346, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.5699920654296875  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.5699920654296875  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 346, 256]), torch.Size([1, 346, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.5706520080566406  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.6179008483886719  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 346, 256])
m.shape torch.Size([277, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.620499610900879  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.620499610900879  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.621027946472168  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.6640052795410156  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 277, 256])
m.shape torch.Size([225, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.6663365364074707  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.6663365364074707  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.6667656898498535  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.7032437324523926  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([206, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.7056031227111816  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.7056031227111816  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.705996036529541  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.7421441078186035  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([165, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.7441682815551758  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.7441682815551758  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.7444829940795898  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.775639533996582  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([153, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.7776880264282227  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.7776880264282227  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.777979850769043  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.808913230895996  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([120, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.810612678527832  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.810612678527832  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8108415603637695  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.836705207824707  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([87, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8380126953125  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8380126953125  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8381786346435547  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8580913543701172  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([88, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8595309257507324  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8595309257507324  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.85969877243042  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8810153007507324  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([85, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.882483959197998  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.882483959197998  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.882646083831787  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9043707847595215  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([73, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9059057235717773  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9059057235717773  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9060449600219727  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9256772994995117  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([49, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.926623821258545  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.926623821258545  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9267172813415527  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.940549373626709  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([46, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9414753913879395  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9414753913879395  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9415631294250488  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.955162525177002  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([41, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9560251235961914  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9560251235961914  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9561033248901367  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9687719345092773  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([38, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9696097373962402  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9696097373962402  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.969682216644287  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.981931209564209  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([401, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.991530418395996  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.991530418395996  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 401, 256]), torch.Size([1, 401, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.992295265197754  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.1277008056640625  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 401, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.0671825408935547  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.069610595703125  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.071343421936035  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.068828582763672  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

torch.Size([11627, 40])
input nodes number: 20690
output nodes number: 11627
edges number: 72936
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.069460868835449  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.0694613456726074  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.03358793258666992  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

pseudo mini batch 2 input nodes size: 33449
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.029433727264404297  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.029433727264404297  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.045383453369140625  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.04546642303466797  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.029564857482910156  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.031158447265625  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.031158447265625  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.031158447265625  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

torch.Size([33449, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.031158447265625  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

m.shape torch.Size([1666, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.09266424179077148  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.09266424179077148  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1666, 128]), torch.Size([1, 1666, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.0942530632019043  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.10736751556396484  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1666, 128])
m.shape torch.Size([1871, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.10835742950439453  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.10835742950439453  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1871, 128]), torch.Size([1, 1871, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.11014175415039062  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.1369171142578125  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1871, 128])
m.shape torch.Size([1756, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.1389908790588379  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.1389908790588379  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1756, 128]), torch.Size([1, 1756, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.14066553115844727  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.17805719375610352  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1756, 128])
m.shape torch.Size([1577, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.1804051399230957  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.1804051399230957  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1577, 128]), torch.Size([1, 1577, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.18190908432006836  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.2255234718322754  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1577, 128])
m.shape torch.Size([1306, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.22788524627685547  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.22788524627685547  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1306, 128]), torch.Size([1, 1306, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.22913074493408203  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.2745628356933594  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1306, 128])
m.shape torch.Size([1199, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.2773704528808594  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.2773704528808594  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1199, 128]), torch.Size([1, 1199, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.27851390838623047  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.32857227325439453  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1199, 128])
m.shape torch.Size([1071, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.3315753936767578  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.3315753936767578  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1071, 128]), torch.Size([1, 1071, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.3325967788696289  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.3842496871948242  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1071, 128])
m.shape torch.Size([954, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.3873782157897949  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.3873782157897949  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 954, 128]), torch.Size([1, 954, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.3882880210876465  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.4426107406616211  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 954, 128])
m.shape torch.Size([806, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.4456148147583008  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.4456148147583008  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 806, 128]), torch.Size([1, 806, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.4463834762573242  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.49588680267333984  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 806, 128])
m.shape torch.Size([7077, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5292482376098633  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5292482376098633  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 7077, 128]), torch.Size([1, 7077, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5359973907470703  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.0162396430969238  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 7077, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.9626317024230957  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.9810214042663574  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.9994111061096191  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.9808773994445801  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

torch.Size([19283, 256])
first layer input nodes number: 33449
first layer output nodes number: 19283
edges number: 123861
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.9996623992919922  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.018052101135254  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.0226497650146484  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.0226497650146484  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

m.shape torch.Size([1299, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.1109418869018555  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.1109418869018555  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1299, 256]), torch.Size([1, 1299, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.1137256622314453  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.134671688079834  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1299, 256])
m.shape torch.Size([1303, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.1353387832641602  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.1353387832641602  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1303, 256]), torch.Size([1, 1303, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.1381936073303223  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.1765871047973633  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1303, 256])
m.shape torch.Size([1127, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.1792354583740234  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.1792354583740234  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1127, 256]), torch.Size([1, 1127, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.1813907623291016  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.229651927947998  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1127, 256])
m.shape torch.Size([942, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.2320566177368164  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.2320566177368164  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 942, 256]), torch.Size([1, 942, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.2338533401489258  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.2861108779907227  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 942, 256])
m.shape torch.Size([767, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.2888984680175781  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.2888984680175781  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 767, 256]), torch.Size([1, 767, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.2903614044189453  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.343027114868164  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 767, 256])
m.shape torch.Size([667, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.346142292022705  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.346142292022705  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 667, 256]), torch.Size([1, 667, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.347414493560791  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.4036006927490234  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 667, 256])
m.shape torch.Size([590, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.4069342613220215  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.4069342613220215  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 590, 256]), torch.Size([1, 590, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.4080595970153809  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.4653239250183105  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 590, 256])
m.shape torch.Size([507, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.4686598777770996  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.4686598777770996  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 507, 256]), torch.Size([1, 507, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.4696269035339355  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.524980068206787  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 507, 256])
m.shape torch.Size([439, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.5285849571228027  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.5285849571228027  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 439, 256]), torch.Size([1, 439, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.5294222831726074  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.5830745697021484  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 439, 256])
m.shape torch.Size([392, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.5864238739013672  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.5864238739013672  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 392, 256]), torch.Size([1, 392, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.5871715545654297  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.6406688690185547  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 392, 256])
m.shape torch.Size([364, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.6441435813903809  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.6441435813903809  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 364, 256]), torch.Size([1, 364, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.6448378562927246  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.6992912292480469  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 364, 256])
m.shape torch.Size([298, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.7023811340332031  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.7023811340332031  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.7029495239257812  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.7522058486938477  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 298, 256])
m.shape torch.Size([258, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.75514554977417  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.75514554977417  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.7556376457214355  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.802016258239746  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([221, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8047442436218262  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8047442436218262  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8051657676696777  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8468966484069824  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([158, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8489642143249512  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8489642143249512  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8492655754089355  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8812098503112793  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([165, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8835968971252441  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8835968971252441  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8839116096496582  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9194741249084473  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([156, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9218659400939941  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9218659400939941  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.922163486480713  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.957869052886963  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([137, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9600906372070312  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9600906372070312  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9603519439697266  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9935379028320312  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([103, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.995288372039795  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.995288372039795  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9954848289489746  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.0218100547790527  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([111, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.023845672607422  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.023845672607422  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.024057388305664  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.0539093017578125  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([101, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.055842399597168  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.055842399597168  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.056035041809082  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.0845460891723633  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([83, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.0862812995910645  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.0862812995910645  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.086439609527588  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.1109776496887207  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([69, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.112423896789551  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.112423896789551  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.112555503845215  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.133875846862793  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([67, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.1361751556396484  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.1361751556396484  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.136302947998047  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.157899856567383  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([782, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.1775131225585938  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.1775131225585938  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 782, 256]), torch.Size([1, 782, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.179004669189453  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.441516876220703  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 782, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.3652920722961426  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.3672356605529785  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.3688907623291016  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.3668642044067383  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

torch.Size([11106, 40])
input nodes number: 19283
output nodes number: 11106
edges number: 89973
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.3663182258605957  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.366318702697754  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.03345537185668945  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

pseudo mini batch 3 input nodes size: 35488
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.02879190444946289  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.02879190444946289  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.04637002944946289  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.04645681381225586  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.030424118041992188  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.03211498260498047  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.03211498260498047  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.03211498260498047  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

torch.Size([35488, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.03211498260498047  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

m.shape torch.Size([2436, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.09956026077270508  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.09956026077270508  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 2436, 128]), torch.Size([1, 2436, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.1018834114074707  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.1204686164855957  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 2436, 128])
m.shape torch.Size([2408, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.12160348892211914  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.12160348892211914  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 2408, 128]), torch.Size([1, 2408, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.12402963638305664  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.15938425064086914  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 2408, 128])
m.shape torch.Size([2118, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.16126585006713867  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.16126585006713867  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 2118, 128]), torch.Size([1, 2118, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.16334867477416992  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.20986032485961914  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 2118, 128])
m.shape torch.Size([1789, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.21226263046264648  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.21226263046264648  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1789, 128]), torch.Size([1, 1789, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.21396875381469727  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.2634921073913574  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1789, 128])
m.shape torch.Size([1615, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.26648950576782227  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.26648950576782227  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1615, 128]), torch.Size([1, 1615, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.26802968978881836  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.32441139221191406  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1615, 128])
m.shape torch.Size([1335, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.32807207107543945  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.32807207107543945  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1335, 128]), torch.Size([1, 1335, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.3293452262878418  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.3871731758117676  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1335, 128])
m.shape torch.Size([1115, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.3902583122253418  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.3902583122253418  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1115, 128]), torch.Size([1, 1115, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.39132165908813477  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.4478282928466797  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1115, 128])
m.shape torch.Size([1003, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.4511227607727051  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.4511227607727051  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1003, 128]), torch.Size([1, 1003, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.45207929611206055  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5072293281555176  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1003, 128])
m.shape torch.Size([859, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5104374885559082  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5104374885559082  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 859, 128]), torch.Size([1, 859, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5112566947937012  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5652852058410645  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 859, 128])
m.shape torch.Size([7474, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.6005144119262695  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.6005144119262695  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 7474, 128]), torch.Size([1, 7474, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.6076421737670898  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.1142578125  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 7474, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.0558514595031738  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.0773358345031738  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.098461627960205  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.0768117904663086  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

torch.Size([22152, 256])
first layer input nodes number: 35488
first layer output nodes number: 22152
edges number: 135147
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.0987281799316406  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.1198539733886719  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.1251354217529297  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.1251354217529297  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

m.shape torch.Size([1752, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.2154560089111328  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.2154560089111328  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1752, 256]), torch.Size([1, 1752, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.2188796997070312  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.2457771301269531  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1752, 256])
m.shape torch.Size([1457, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.2477741241455078  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.2477741241455078  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1457, 256]), torch.Size([1, 1457, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.2509946823120117  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.2946138381958008  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1457, 256])
m.shape torch.Size([1214, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.2964024543762207  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.2964024543762207  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1214, 256]), torch.Size([1, 1214, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.2989144325256348  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.359729290008545  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1214, 256])
m.shape torch.Size([942, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.3616390228271484  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.3616390228271484  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 942, 256]), torch.Size([1, 942, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.3634357452392578  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.4155406951904297  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 942, 256])
m.shape torch.Size([798, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.4184775352478027  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.4184775352478027  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 798, 256]), torch.Size([1, 798, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.419999599456787  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.47529935836792  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 798, 256])
m.shape torch.Size([643, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.4782466888427734  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.4782466888427734  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 643, 256]), torch.Size([1, 643, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.4794731140136719  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.533127784729004  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 643, 256])
m.shape torch.Size([522, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.536026954650879  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.536026954650879  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 522, 256]), torch.Size([1, 522, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.537022590637207  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.5883464813232422  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 522, 256])
m.shape torch.Size([457, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.5913629531860352  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.5913629531860352  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 457, 256]), torch.Size([1, 457, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.5922346115112305  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.6428022384643555  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 457, 256])
m.shape torch.Size([405, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.6458697319030762  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.6458697319030762  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 405, 256]), torch.Size([1, 405, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.6466422080993652  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.6968951225280762  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 405, 256])
m.shape torch.Size([347, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.6998443603515625  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.6998443603515625  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 347, 256]), torch.Size([1, 347, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.7005062103271484  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.7476139068603516  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 347, 256])
m.shape torch.Size([300, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.7504549026489258  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.7504549026489258  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.7510271072387695  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.7965497970581055  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([239, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.7990202903747559  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.7990202903747559  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.799476146697998  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.838223934173584  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([215, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8406825065612793  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8406825065612793  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.841092586517334  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8788199424743652  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([200, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8813061714172363  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8813061714172363  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8816876411437988  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9194531440734863  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([184, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9219155311584473  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9219155311584473  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9222664833068848  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9594674110412598  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([142, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9624152183532715  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9624152183532715  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9626860618591309  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9932913780212402  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([160, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9957704544067383  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9957704544067383  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9960756301879883  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.0326967239379883  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([110, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.034447193145752  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.034447193145752  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.0346570014953613  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.061302661895752  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([107, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.0631518363952637  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.0631518363952637  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.0633559226989746  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.0907034873962402  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([115, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.0928120613098145  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.0928120613098145  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.093031406402588  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.1239590644836426  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([100, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.1258678436279297  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.1258678436279297  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.126058578491211  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.154287338256836  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([60, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.155460834503174  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.155460834503174  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.1555752754211426  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.173313617706299  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([73, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.174870491027832  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.174870491027832  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.1750097274780273  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.197566032409668  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([67, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.199042320251465  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.199042320251465  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.1991701126098633  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.220767021179199  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([993, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.244563102722168  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.244563102722168  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 993, 256]), torch.Size([1, 993, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.246457099914551  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.588810920715332  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 993, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.511207103729248  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.5131592750549316  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.514888286590576  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.5128493309020996  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

torch.Size([11602, 40])
input nodes number: 22152
output nodes number: 11602
edges number: 91709
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.5131754875183105  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.5131759643554688  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.03545522689819336  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

pseudo mini batch 4 input nodes size: 62891
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.030498027801513672  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.030498027801513672  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.060486793518066406  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.06057024002075195  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.042905330657958984  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.04476118087768555  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.04476118087768555  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.04476118087768555  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

torch.Size([62891, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.04476118087768555  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

m.shape torch.Size([3028, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.13466691970825195  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.13466691970825195  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 3028, 128]), torch.Size([1, 3028, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.13788127899169922  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.16383600234985352  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 3028, 128])
m.shape torch.Size([3100, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.16527986526489258  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.16527986526489258  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 3100, 128]), torch.Size([1, 3100, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.16823625564575195  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.21375131607055664  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 3100, 128])
m.shape torch.Size([2766, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.21670770645141602  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.21670770645141602  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 2766, 128]), torch.Size([1, 2766, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.2193455696105957  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.2793087959289551  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 2766, 128])
m.shape torch.Size([2356, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.2831110954284668  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.2831110954284668  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 2356, 128]), torch.Size([1, 2356, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.2855534553527832  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.3520073890686035  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 2356, 128])
m.shape torch.Size([2081, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.35650110244750977  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.35650110244750977  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 2081, 128]), torch.Size([1, 2081, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.35848569869995117  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.4345064163208008  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 2081, 128])
m.shape torch.Size([1666, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.43770360946655273  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.43770360946655273  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1666, 128]), torch.Size([1, 1666, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.43929243087768555  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5120282173156738  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1666, 128])
m.shape torch.Size([1456, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5160937309265137  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5160937309265137  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1456, 128]), torch.Size([1, 1456, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5174822807312012  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5879054069519043  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1456, 128])
m.shape torch.Size([1285, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5928568840026855  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5928568840026855  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1285, 128]), torch.Size([1, 1285, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5940823554992676  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.6641592979431152  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1285, 128])
m.shape torch.Size([1110, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.6683101654052734  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.6683101654052734  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1110, 128]), torch.Size([1, 1110, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.6693687438964844  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.7388439178466797  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1110, 128])
m.shape torch.Size([10259, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.7872333526611328  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.7872333526611328  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 10259, 128]), torch.Size([1, 10259, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.7970170974731445  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.4916629791259766  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 10259, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.4135932922363281  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.4413518905639648  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.4691104888916016  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.4411349296569824  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

torch.Size([29107, 256])
first layer input nodes number: 62891
first layer output nodes number: 29107
edges number: 180403
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.469581127166748  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.4973397254943848  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.504279613494873  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.504279613494873  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

m.shape torch.Size([2078, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.5730094909667969  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.5730094909667969  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 2078, 256]), torch.Size([1, 2078, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.578577995300293  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.6120185852050781  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 2078, 256])
m.shape torch.Size([1752, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.6136894226074219  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.6136894226074219  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1752, 256]), torch.Size([1, 1752, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.6171298027038574  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.6689772605895996  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1752, 256])
m.shape torch.Size([1330, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.6709423065185547  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.6709423065185547  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1330, 256]), torch.Size([1, 1330, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.6738643646240234  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.7359952926635742  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1330, 256])
m.shape torch.Size([1036, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.7387099266052246  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.7387099266052246  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1036, 256]), torch.Size([1, 1036, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.7408256530761719  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8017492294311523  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1036, 256])
m.shape torch.Size([881, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8042263984680176  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8042263984680176  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 881, 256]), torch.Size([1, 881, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8059067726135254  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8683648109436035  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 881, 256])
m.shape torch.Size([620, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8711004257202148  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8711004257202148  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 620, 256]), torch.Size([1, 620, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8722829818725586  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9246044158935547  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 620, 256])
m.shape torch.Size([478, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.927229404449463  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.927229404449463  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 478, 256]), torch.Size([1, 478, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9281411170959473  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.974052906036377  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 478, 256])
m.shape torch.Size([428, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9768881797790527  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9768881797790527  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 428, 256]), torch.Size([1, 428, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9777045249938965  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.024360179901123  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 428, 256])
m.shape torch.Size([343, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.026919364929199  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.026919364929199  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 343, 256]), torch.Size([1, 343, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.027573585510254  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.06997013092041  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 343, 256])
m.shape torch.Size([279, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.072324752807617  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.072324752807617  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.072856903076172  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.1119232177734375  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([227, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.1140575408935547  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.1140575408935547  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.114490509033203  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.1482620239257812  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([201, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.1503639221191406  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.1503639221191406  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.150747299194336  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.1833343505859375  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([184, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.1854419708251953  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.1854419708251953  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.185792922973633  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.218080520629883  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([144, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.219998359680176  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.219998359680176  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.220273017883301  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.247464179992676  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([128, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.2491722106933594  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.2491722106933594  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.2494163513183594  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.2752952575683594  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([108, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.276834011077881  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.276834011077881  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.2770400047302246  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.3003172874450684  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([89, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.301668643951416  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.301668643951416  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.3018383979797363  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.322208881378174  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([83, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.3235602378845215  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.3235602378845215  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.323718547821045  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.3438239097595215  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([70, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.3450231552124023  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.3450231552124023  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.345156669616699  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.3630475997924805  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([60, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.3641343116760254  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.3641343116760254  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.364248752593994  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.380384922027588  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([61, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.381559371948242  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.381559371948242  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.3816757202148438  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.398895263671875  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([35, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.3995776176452637  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.3995776176452637  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.399644374847412  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.40999174118042  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([42, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.4108872413635254  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.4108872413635254  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.4109673500061035  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.4239449501037598  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([36, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.4247355461120605  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.4247355461120605  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.424804210662842  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.436408519744873  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([468, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.4476194381713867  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.4476194381713867  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 468, 256]), torch.Size([1, 468, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.448512077331543  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.6057443618774414  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 468, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.549370765686035  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.551041603088379  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.552720069885254  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.5509657859802246  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

torch.Size([11161, 40])
input nodes number: 29107
output nodes number: 11161
edges number: 68571
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.551208019256592  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.55120849609375  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.04831552505493164  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

pseudo mini batch 5 input nodes size: 72260
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.0428471565246582  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.0428471565246582  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.0780034065246582  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.07808637619018555  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.048014163970947266  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.05037069320678711  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.05037069320678711  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.05037069320678711  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

torch.Size([72260, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.05037069320678711  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

m.shape torch.Size([2905, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.16974306106567383  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.16974306106567383  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 2905, 128]), torch.Size([1, 2905, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.17251348495483398  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.19618988037109375  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 2905, 128])
m.shape torch.Size([2970, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.19763708114624023  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.19763708114624023  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 2970, 128]), torch.Size([1, 2970, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.2004694938659668  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.24573373794555664  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 2970, 128])
m.shape torch.Size([2547, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.24714994430541992  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.24714994430541992  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 2547, 128]), torch.Size([1, 2547, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.24971866607666016  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.3041849136352539  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 2547, 128])
m.shape torch.Size([2263, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.30728673934936523  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.30728673934936523  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 2263, 128]), torch.Size([1, 2263, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.3095884323120117  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.3760976791381836  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 2263, 128])
m.shape torch.Size([2074, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.37996339797973633  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.37996339797973633  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 2074, 128]), torch.Size([1, 2074, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.3828444480895996  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.4581265449523926  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 2074, 128])
m.shape torch.Size([1732, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.46209287643432617  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.46209287643432617  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1732, 128]), torch.Size([1, 1732, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.4637446403503418  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5366015434265137  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1732, 128])
m.shape torch.Size([1544, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5409293174743652  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5409293174743652  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1544, 128]), torch.Size([1, 1544, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5424017906188965  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.616025447845459  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1544, 128])
m.shape torch.Size([1399, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.6206259727478027  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.6206259727478027  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1399, 128]), torch.Size([1, 1399, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.6219601631164551  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.700751781463623  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1399, 128])
m.shape torch.Size([1266, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.7055177688598633  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.7055177688598633  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1266, 128]), torch.Size([1, 1266, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.7067251205444336  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.7846364974975586  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1266, 128])
m.shape torch.Size([15961, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.8601408004760742  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.8601408004760742  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 15961, 128]), torch.Size([1, 15961, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.8753623962402344  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9560956954956055  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 15961, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8499383926391602  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.8829936981201172  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9160490036010742  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.882735252380371  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

torch.Size([34661, 256])
first layer input nodes number: 72260
first layer output nodes number: 34661
edges number: 239304
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9165897369384766  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.9496450424194336  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.957909107208252  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.957909107208252  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

m.shape torch.Size([1966, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.0341243743896484  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.0341243743896484  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1966, 256]), torch.Size([1, 1966, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.0389938354492188  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.0725326538085938  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1966, 256])
m.shape torch.Size([1662, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.0735650062561035  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.0735650062561035  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1662, 256]), torch.Size([1, 1662, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.0770115852355957  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.12550687789917  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1662, 256])
m.shape torch.Size([1238, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.127732276916504  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.127732276916504  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1238, 256]), torch.Size([1, 1238, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.130152702331543  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.1855320930480957  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1238, 256])
m.shape torch.Size([955, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.1879515647888184  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.1879515647888184  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 955, 256]), torch.Size([1, 955, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.1897730827331543  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.249485492706299  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 955, 256])
m.shape torch.Size([801, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.2524242401123047  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.2524242401123047  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 801, 256]), torch.Size([1, 801, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.2539520263671875  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.3093862533569336  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 801, 256])
m.shape torch.Size([628, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.312243938446045  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.312243938446045  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 628, 256]), torch.Size([1, 628, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.313441753387451  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.369080066680908  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 628, 256])
m.shape torch.Size([485, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.3717446327209473  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.3717446327209473  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 485, 256]), torch.Size([1, 485, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.3726696968078613  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.4189229011535645  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 485, 256])
m.shape torch.Size([416, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.421658992767334  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.421658992767334  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.422452449798584  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.468301296234131  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 416, 256])
m.shape torch.Size([328, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.4707422256469727  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.4707422256469727  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 328, 256]), torch.Size([1, 328, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.471367835998535  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.513193130493164  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 328, 256])
m.shape torch.Size([282, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.5155911445617676  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.5155911445617676  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.5161290168762207  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.555744171142578  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([234, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.5579495429992676  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.5579495429992676  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.5583958625793457  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.5932087898254395  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([198, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.5952696800231934  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.5952696800231934  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.5956473350524902  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.6277480125427246  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([155, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.6294960975646973  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.6294960975646973  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.629791736602783  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.6569905281066895  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([131, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.6586055755615234  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.6586055755615234  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.658855438232422  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.683591842651367  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([132, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.6853699684143066  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.6853699684143066  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.685621738433838  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.7123093605041504  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([102, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.7139172554016113  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.7139172554016113  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.714111804962158  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.736095905303955  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([97, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.737583637237549  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.737583637237549  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.7377686500549316  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.759970188140869  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([97, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.7615561485290527  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.7615561485290527  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.7617411613464355  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.7852377891540527  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([86, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.7867159843444824  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.7867159843444824  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.7868800163269043  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.8088603019714355  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([81, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.810335636138916  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.810335636138916  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.810490131378174  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.8322739601135254  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([61, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.833428382873535  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.833428382873535  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.8335447311401367  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.850764274597168  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([45, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.8516578674316406  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.8516578674316406  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.851743698120117  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.8650474548339844  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([38, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.8658447265625  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.8658447265625  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.865917205810547  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.8776588439941406  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([57, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.8789377212524414  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.8789377212524414  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.8790464401245117  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.8974199295043945  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([808, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.9170475006103516  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.9170475006103516  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 808, 256]), torch.Size([1, 808, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.918588638305664  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.189828872680664  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 808, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.1252150535583496  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.1268668174743652  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.128518581390381  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.126783847808838  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

torch.Size([11083, 40])
input nodes number: 34661
output nodes number: 11083
edges number: 76865
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.127106189727783  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.1271066665649414  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.05471992492675781  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

pseudo mini batch 6 input nodes size: 68257
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.04799509048461914  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.04799509048461914  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.08119821548461914  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.08128499984741211  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.046045780181884766  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.049654483795166016  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.049654483795166016  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.049654483795166016  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

torch.Size([68257, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.049654483795166016  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

m.shape torch.Size([1895, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.21882057189941406  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.21882057189941406  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1895, 128]), torch.Size([1, 1895, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.2206277847290039  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.23508548736572266  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1895, 128])
m.shape torch.Size([1950, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.23636293411254883  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.23636293411254883  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1950, 128]), torch.Size([1, 1950, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.23822259902954102  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.2667832374572754  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1950, 128])
m.shape torch.Size([1890, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.2691941261291504  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.2691941261291504  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1890, 128]), torch.Size([1, 1890, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.2709965705871582  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.3106503486633301  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1890, 128])
m.shape torch.Size([1707, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.3130049705505371  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.3130049705505371  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1707, 128]), torch.Size([1, 1707, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.3146328926086426  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.36343908309936523  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1707, 128])
m.shape torch.Size([1596, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.36643028259277344  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.36643028259277344  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1596, 128]), torch.Size([1, 1596, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.3679523468017578  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.42305755615234375  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1596, 128])
m.shape torch.Size([1582, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.4268226623535156  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.4268226623535156  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1582, 128]), torch.Size([1, 1582, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.4283313751220703  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.49324607849121094  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1582, 128])
m.shape torch.Size([1473, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.497408390045166  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.497408390045166  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1473, 128]), torch.Size([1, 1473, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.4988131523132324  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5692653656005859  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1473, 128])
m.shape torch.Size([1401, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5739073753356934  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5739073753356934  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1401, 128]), torch.Size([1, 1401, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5752434730529785  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.6528887748718262  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1401, 128])
m.shape torch.Size([1390, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.6581859588623047  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.6581859588623047  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1390, 128]), torch.Size([1, 1390, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.6595115661621094  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.7462959289550781  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1390, 128])
m.shape torch.Size([27438, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.8764677047729492  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.8764677047729492  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 27438, 128]), torch.Size([1, 27438, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.9026346206665039  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.7604856491088867  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 27438, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.6026740074157715  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.643035411834717  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.683396816253662  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.6427197456359863  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

torch.Size([42322, 256])
first layer input nodes number: 68257
first layer output nodes number: 42322
edges number: 344174
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.6839075088500977  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.724268913269043  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.7350893020629883  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.7350893020629883  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

m.shape torch.Size([1261, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.871466636657715  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.871466636657715  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1261, 256]), torch.Size([1, 1261, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.874457359313965  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.89548397064209  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1261, 256])
m.shape torch.Size([1028, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.8958754539489746  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.8958754539489746  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 1028, 256]), torch.Size([1, 1028, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.8990797996520996  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.9331631660461426  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 1028, 256])
m.shape torch.Size([851, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.9343600273132324  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.9343600273132324  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 851, 256]), torch.Size([1, 851, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.935983180999756  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.972242832183838  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 851, 256])
m.shape torch.Size([666, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.973991870880127  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.973991870880127  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 666, 256]), torch.Size([1, 666, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 2.97526216506958  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.0121006965637207  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 666, 256])
m.shape torch.Size([566, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.014185905456543  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.014185905456543  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 566, 256]), torch.Size([1, 566, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.015265464782715  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.055177688598633  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 566, 256])
m.shape torch.Size([465, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.0573196411132812  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.0573196411132812  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 465, 256]), torch.Size([1, 465, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.058206558227539  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.0981225967407227  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 465, 256])
m.shape torch.Size([387, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.100283145904541  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.100283145904541  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 387, 256]), torch.Size([1, 387, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.1010212898254395  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.142061710357666  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 387, 256])
m.shape torch.Size([329, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.1442227363586426  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.1442227363586426  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 329, 256]), torch.Size([1, 329, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.144850254058838  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.182187557220459  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 329, 256])
m.shape torch.Size([331, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.184737205505371  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.184737205505371  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 331, 256]), torch.Size([1, 331, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.185368537902832  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.2266483306884766  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 331, 256])
m.shape torch.Size([301, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.2292261123657227  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.2292261123657227  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.229800224304199  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.271265983581543  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 301, 256])
m.shape torch.Size([281, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.274458408355713  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.274458408355713  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.274994373321533  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.317253589630127  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([264, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.320030689239502  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.320030689239502  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.3205342292785645  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.36484956741333  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([244, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.3676466941833496  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.3676466941833496  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 244, 256]), torch.Size([1, 244, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.368112087249756  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.410928249359131  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 244, 256])
m.shape torch.Size([188, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.4132256507873535  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.4132256507873535  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.4135842323303223  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.4490838050842285  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([185, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.4515719413757324  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.4515719413757324  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.4519248008728027  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.489327907562256  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([177, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.4918737411499023  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.4918737411499023  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.49221134185791  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.530360221862793  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([164, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.5338258743286133  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.5338258743286133  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.5341386795043945  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.5716753005981445  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([172, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.5744948387145996  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.5744948387145996  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.5748229026794434  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.6164870262145996  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([159, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.6192269325256348  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.6192269325256348  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.619530200958252  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.660168170928955  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([154, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.6629772186279297  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.6629772186279297  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.663270950317383  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.7046871185302734  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([149, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.707547664642334  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.707547664642334  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.707831859588623  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.7498927116394043  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([100, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.7518653869628906  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.7518653869628906  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.752056121826172  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.7816200256347656  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([115, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.784067153930664  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.784067153930664  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.7842864990234375  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.8198204040527344  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([107, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.8228859901428223  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.8228859901428223  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.823090076446533  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.8575806617736816  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([2975, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.9289627075195312  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.9289627075195312  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

 h.shape torch.Size([1, 2975, 256]), torch.Size([1, 2975, 256])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 3.9346370697021484  GigaBytes
Max Memory Allocated: 4.948819637298584  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 4.933324813842773  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

rst.shape  torch.Size([1, 2975, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 4.807365894317627  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 4.80957555770874  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 4.812083721160889  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 4.809787273406982  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

torch.Size([11619, 40])
input nodes number: 42322
output nodes number: 11619
edges number: 140056
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 4.8107476234436035  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 4.810748100280762  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.05645132064819336  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

pseudo mini batch 7 input nodes size: 85363
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.04660367965698242  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.04660367965698242  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.08730792999267578  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.08739042282104492  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.05410051345825195  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.057782649993896484  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.057782649993896484  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.057782649993896484  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

torch.Size([85363, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.057782649993896484  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

m.shape torch.Size([2362, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.24568843841552734  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.24568843841552734  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

 h.shape torch.Size([1, 2362, 128]), torch.Size([1, 2362, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.2479410171508789  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.2659616470336914  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

rst.shape  torch.Size([1, 2362, 128])
m.shape torch.Size([2563, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.26727962493896484  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.26727962493896484  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

 h.shape torch.Size([1, 2563, 128]), torch.Size([1, 2563, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.2700839042663574  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.3074331283569336  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

rst.shape  torch.Size([1, 2563, 128])
m.shape torch.Size([2379, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.3098773956298828  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.3098773956298828  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

 h.shape torch.Size([1, 2379, 128]), torch.Size([1, 2379, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.3121986389160156  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.3622303009033203  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

rst.shape  torch.Size([1, 2379, 128])
m.shape torch.Size([2155, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.365206241607666  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.365206241607666  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

 h.shape torch.Size([1, 2155, 128]), torch.Size([1, 2155, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.36743831634521484  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.4284977912902832  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

rst.shape  torch.Size([1, 2155, 128])
m.shape torch.Size([2080, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.43260812759399414  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.43260812759399414  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

 h.shape torch.Size([1, 2080, 128]), torch.Size([1, 2080, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.43500709533691406  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5110874176025391  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

rst.shape  torch.Size([1, 2080, 128])
m.shape torch.Size([1871, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5160465240478516  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5160465240478516  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

 h.shape torch.Size([1, 1871, 128]), torch.Size([1, 1871, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5178308486938477  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5945568084716797  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

rst.shape  torch.Size([1, 1871, 128])
m.shape torch.Size([1828, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5997662544250488  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.5997662544250488  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

 h.shape torch.Size([1, 1828, 128]), torch.Size([1, 1828, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.6015095710754395  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.6894173622131348  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

rst.shape  torch.Size([1, 1828, 128])
m.shape torch.Size([1704, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.6950459480285645  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.6950459480285645  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

 h.shape torch.Size([1, 1704, 128]), torch.Size([1, 1704, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.6966710090637207  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.789391040802002  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

rst.shape  torch.Size([1, 1704, 128])
m.shape torch.Size([1680, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.7957882881164551  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.7957882881164551  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

 h.shape torch.Size([1, 1680, 128]), torch.Size([1, 1680, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.7973904609680176  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 0.9009747505187988  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

rst.shape  torch.Size([1, 1680, 128])
m.shape torch.Size([29278, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.0397820472717285  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.0397820472717285  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

 h.shape torch.Size([1, 29278, 128]), torch.Size([1, 29278, 128])
----------------------------------------3
 Nvidia-smi: 7.6170654296875 GB
    Memory Allocated: 1.0677037239074707  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.0660881996154785  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

rst.shape  torch.Size([1, 29278, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 2.891648292541504  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 2.9373292922973633  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 2.9830102920532227  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 2.936972141265869  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

torch.Size([47900, 256])
first layer input nodes number: 85363
first layer output nodes number: 47900
edges number: 379199
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 2.9836483001708984  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.029329299926758  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.041482925415039  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.041482925415039  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

m.shape torch.Size([1438, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.153749942779541  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.153749942779541  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

 h.shape torch.Size([1, 1438, 256]), torch.Size([1, 1438, 256])
----------------------------------------3
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.1576180458068848  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.180764675140381  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

rst.shape  torch.Size([1, 1438, 256])
m.shape torch.Size([1253, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.182155132293701  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.182155132293701  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

 h.shape torch.Size([1, 1253, 256]), torch.Size([1, 1253, 256])
----------------------------------------3
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.1847143173217773  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.226588249206543  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

rst.shape  torch.Size([1, 1253, 256])
m.shape torch.Size([952, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.227804660797119  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.227804660797119  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

 h.shape torch.Size([1, 952, 256]), torch.Size([1, 952, 256])
----------------------------------------3
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.2296204566955566  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.2695679664611816  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

rst.shape  torch.Size([1, 952, 256])
m.shape torch.Size([701, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.2717251777648926  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.2717251777648926  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

 h.shape torch.Size([1, 701, 256]), torch.Size([1, 701, 256])
----------------------------------------3
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.273062229156494  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.3131699562072754  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

rst.shape  torch.Size([1, 701, 256])
m.shape torch.Size([666, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.315702438354492  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.315702438354492  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

 h.shape torch.Size([1, 666, 256]), torch.Size([1, 666, 256])
----------------------------------------3
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.3169727325439453  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.362703323364258  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

rst.shape  torch.Size([1, 666, 256])
m.shape torch.Size([488, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.364882469177246  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.364882469177246  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

 h.shape torch.Size([1, 488, 256]), torch.Size([1, 488, 256])
----------------------------------------3
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.3658132553100586  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.4068899154663086  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

rst.shape  torch.Size([1, 488, 256])
m.shape torch.Size([404, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.4091429710388184  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.4091429710388184  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.4099135398864746  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.44923734664917  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([329, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.4513821601867676  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.4513821601867676  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

 h.shape torch.Size([1, 329, 256]), torch.Size([1, 329, 256])
----------------------------------------3
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.452009677886963  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.488358974456787  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

rst.shape  torch.Size([1, 329, 256])
m.shape torch.Size([312, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.490744113922119  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.490744113922119  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.4913392066955566  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.5306496620178223  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([280, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.533043384552002  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.533043384552002  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.5335774421691895  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.5719289779663086  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

rst.shape  torch.Size([1, 280, 256])
m.shape torch.Size([228, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.57407283782959  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.57407283782959  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.574507713317871  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.6084280014038086  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([227, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.6108288764953613  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.6108288764953613  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.6112618446350098  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.648064136505127  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([169, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.6499595642089844  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.6499595642089844  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.6502819061279297  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.6799373626708984  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([173, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.6821041107177734  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.6821041107177734  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.68243408203125  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.7151012420654297  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([148, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.7170701026916504  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.7170701026916504  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.7173523902893066  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.747274875640869  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([152, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.7494711875915527  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.7494711875915527  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.7497611045837402  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.7825217247009277  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([129, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.78448486328125  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.78448486328125  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.784730911254883  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.8142566680908203  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([143, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.81660795211792  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.81660795211792  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.816880702972412  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.85152006149292  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([133, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.8538126945495605  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.8538126945495605  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.8540663719177246  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.888059139251709  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([120, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.8902392387390137  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.8902392387390137  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.890468120574951  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.9227404594421387  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([112, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.924886703491211  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.924886703491211  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.925100326538086  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.956716537475586  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

rst.shape Using backend: pytorch
 torch.Size([1, 112, 256])
m.shape torch.Size([98, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.958682060241699  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.958682060241699  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.958868980407715  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.9878416061401367  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([74, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.989384174346924  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.989384174346924  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 3.989525318145752  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 4.012390613555908  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([90, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 4.0143961906433105  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 4.0143961906433105  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 4.014567852020264  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 4.043578624725342  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([2216, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 4.096739292144775  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 4.096739292144775  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

 h.shape torch.Size([1, 2216, 256]), torch.Size([1, 2216, 256])
----------------------------------------3
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 4.101134777069092  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 4.861250400543213  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

rst.shape  torch.Size([1, 2216, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 4.759861946105957  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 4.7615065574646  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 4.763151168823242  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 4.7614240646362305  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

torch.Size([11035, 40])
input nodes number: 47900
output nodes number: 11035
edges number: 114897
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 4.761298656463623  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 4.761299133300781  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 0.06410741806030273  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 0.06410741806030273  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 0.06410741806030273  GigaBytes
Max Memory Allocated: 5.004254341125488  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01993575692176819 |0.002415090799331665 |0.12388747930526733 |0.00010135769844055176 |0.07969281077384949 |0.004698991775512695 |
----------------------------------------------------------pseudo_mini_loss sum 3.655150890350342
Total (block generation + training)time/epoch 24.205543279647827
Training time/epoch 1.8732306957244873
Training time without block to device /epoch 1.853909969329834
Training time without total dataloading part /epoch 1.6341521739959717
load block tensor time/epoch 0.1594860553741455
block to device time/epoch 0.01932072639465332
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  679133
Number of first layer input nodes during this epoch:  438091
Number of first layer output nodes during this epoch:  241042
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
