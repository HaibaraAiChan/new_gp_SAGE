main start at this time 1651554988.0260618
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03259468078613281
number of batches is  8
batch size is  11368
random selection method spend 0.007627248764038086
time for parepare:  0.019030332565307617
local_output_nid generation:  0.004326343536376953
local_in_edges_tensor generation:  0.007695913314819336
mini_batch_src_global generation:  0.0032300949096679688
r_  generation:  0.04601764678955078
local_output_nid generation:  0.0055315494537353516
local_in_edges_tensor generation:  0.002964019775390625
mini_batch_src_global generation:  0.0036280155181884766
r_  generation:  0.033823490142822266
local_output_nid generation:  0.005810260772705078
local_in_edges_tensor generation:  0.0029630661010742188
mini_batch_src_global generation:  0.0023889541625976562
r_  generation:  0.03370308876037598
local_output_nid generation:  0.005797624588012695
local_in_edges_tensor generation:  0.003119230270385742
mini_batch_src_global generation:  0.002529144287109375
r_  generation:  0.03417634963989258
local_output_nid generation:  0.005834817886352539
local_in_edges_tensor generation:  0.0030007362365722656
mini_batch_src_global generation:  0.002589702606201172
r_  generation:  0.03502368927001953
local_output_nid generation:  0.005900382995605469
local_in_edges_tensor generation:  0.0029273033142089844
mini_batch_src_global generation:  0.0026438236236572266
r_  generation:  0.03582334518432617
local_output_nid generation:  0.005883455276489258
local_in_edges_tensor generation:  0.00289154052734375
mini_batch_src_global generation:  0.002656698226928711
r_  generation:  0.0362095832824707
local_output_nid generation:  0.005866527557373047
local_in_edges_tensor generation:  0.0029845237731933594
mini_batch_src_global generation:  0.0027227401733398438
r_  generation:  0.03563046455383301
----------------------check_connections_block total spend ----------------------------- 0.47353363037109375
generate_one_block  0.0493159294128418
generate_one_block  0.048363685607910156
generate_one_block  0.04878950119018555
generate_one_block  0.05211687088012695
generate_one_block  0.04819345474243164
generate_one_block  0.0489649772644043
generate_one_block  0.04912543296813965
generate_one_block  0.04812216758728027
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02486896514892578
gen group dst list time:  0.013896942138671875
time for parepare:  0.018141984939575195
local_output_nid generation:  0.012162923812866211
local_in_edges_tensor generation:  0.02042222023010254
mini_batch_src_global generation:  0.015025615692138672
r_  generation:  0.16115307807922363
local_output_nid generation:  0.017029762268066406
local_in_edges_tensor generation:  0.019747495651245117
mini_batch_src_global generation:  0.017990589141845703
r_  generation:  0.17677927017211914
local_output_nid generation:  0.016658306121826172
local_in_edges_tensor generation:  0.016996145248413086
mini_batch_src_global generation:  0.017502307891845703
r_  generation:  0.17410898208618164
local_output_nid generation:  0.016889095306396484
local_in_edges_tensor generation:  0.01695728302001953
mini_batch_src_global generation:  0.018648624420166016
r_  generation:  0.17382478713989258
local_output_nid generation:  0.016756296157836914
local_in_edges_tensor generation:  0.015899658203125
mini_batch_src_global generation:  0.019374608993530273
r_  generation:  0.17816495895385742
local_output_nid generation:  0.01690053939819336
local_in_edges_tensor generation:  0.017395496368408203
mini_batch_src_global generation:  0.019849538803100586
r_  generation:  0.17946553230285645
local_output_nid generation:  0.016810178756713867
local_in_edges_tensor generation:  0.01717209815979004
mini_batch_src_global generation:  0.01956462860107422
r_  generation:  0.18032073974609375
local_output_nid generation:  0.01679062843322754
local_in_edges_tensor generation:  0.017029285430908203
mini_batch_src_global generation:  0.020190000534057617
r_  generation:  0.17719340324401855
----------------------check_connections_block total spend ----------------------------- 2.162160634994507
generate_one_block  0.2146008014678955
generate_one_block  0.2118062973022461
generate_one_block  0.2146620750427246
generate_one_block  0.23318219184875488
generate_one_block  0.22110509872436523
generate_one_block  0.21608972549438477
generate_one_block  0.21329379081726074
generate_one_block  0.2130587100982666
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  2.162160634994507
block generation total time  1.7377986907958984
average batch blocks generation time:  0.2172248363494873
pseudo mini batch 0 input nodes size: 122510
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0780029296875 GB
    Memory Allocated: 0.0613713264465332  GigaBytes
Max Memory Allocated: 0.0613713264465332  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0780029296875 GB
    Memory Allocated: 0.06145620346069336  GigaBytes
Max Memory Allocated: 0.06145620346069336  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0780029296875 GB
    Memory Allocated: 0.06145620346069336  GigaBytes
Max Memory Allocated: 0.06145620346069336  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1619873046875 GB
    Memory Allocated: 0.06560182571411133  GigaBytes
Max Memory Allocated: 0.06560182571411133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1619873046875 GB
    Memory Allocated: 0.06560182571411133  GigaBytes
Max Memory Allocated: 0.06560182571411133  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1619873046875 GB
    Memory Allocated: 0.06560182571411133  GigaBytes
Max Memory Allocated: 0.06560182571411133  GigaBytes

torch.Size([122510, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1619873046875 GB
    Memory Allocated: 0.06560182571411133  GigaBytes
Max Memory Allocated: 0.06560182571411133  GigaBytes

m.shape torch.Size([3221, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.29457569122314453  GigaBytes
Max Memory Allocated: 0.29947423934936523  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.29457569122314453  GigaBytes
Max Memory Allocated: 0.29947423934936523  GigaBytes

 h.shape torch.Size([1, 3221, 128]), torch.Size([1, 3221, 128])
----------------------------------------3
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.29764747619628906  GigaBytes
Max Memory Allocated: 0.29947423934936523  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.3222217559814453  GigaBytes
Max Memory Allocated: 0.3237576484680176  GigaBytes

rst.shape  torch.Size([1, 3221, 128])
m.shape torch.Size([3984, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5350341796875 GB
    Memory Allocated: 0.32448530197143555  GigaBytes
Max Memory Allocated: 0.32457494735717773  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5350341796875 GB
    Memory Allocated: 0.32448530197143555  GigaBytes
Max Memory Allocated: 0.32457494735717773  GigaBytes

 h.shape torch.Size([1, 3984, 128]), torch.Size([1, 3984, 128])
----------------------------------------3
 Nvidia-smi: 1.5350341796875 GB
    Memory Allocated: 0.32828474044799805  GigaBytes
Max Memory Allocated: 0.32828474044799805  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5936279296875 GB
    Memory Allocated: 0.38687849044799805  GigaBytes
Max Memory Allocated: 0.39067792892456055  GigaBytes

rst.shape  torch.Size([1, 3984, 128])
m.shape torch.Size([4043, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5936279296875 GB
    Memory Allocated: 0.39067792892456055  GigaBytes
Max Memory Allocated: 0.39081382751464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5936279296875 GB
    Memory Allocated: 0.39067792892456055  GigaBytes
Max Memory Allocated: 0.39081382751464844  GigaBytes

 h.shape torch.Size([1, 4043, 128]), torch.Size([1, 4043, 128])
----------------------------------------3
 Nvidia-smi: 1.5936279296875 GB
    Memory Allocated: 0.394533634185791  GigaBytes
Max Memory Allocated: 0.394533634185791  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.48037004470825195  GigaBytes
Max Memory Allocated: 0.48654699325561523  GigaBytes

rst.shape  torch.Size([1, 4043, 128])
m.shape torch.Size([3860, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.48580455780029297  GigaBytes
Max Memory Allocated: 0.48654699325561523  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.48580455780029297  GigaBytes
Max Memory Allocated: 0.48654699325561523  GigaBytes

 h.shape torch.Size([1, 3860, 128]), torch.Size([1, 3860, 128])
----------------------------------------3
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.48957300186157227  GigaBytes
Max Memory Allocated: 0.48957300186157227  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8280029296875 GB
    Memory Allocated: 0.5971035957336426  GigaBytes
Max Memory Allocated: 0.6044659614562988  GigaBytes

rst.shape  torch.Size([1, 3860, 128])
m.shape torch.Size([3692, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.8280029296875 GB
    Memory Allocated: 0.6040654182434082  GigaBytes
Max Memory Allocated: 0.6044659614562988  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8280029296875 GB
    Memory Allocated: 0.6040654182434082  GigaBytes
Max Memory Allocated: 0.6044659614562988  GigaBytes

 h.shape torch.Size([1, 3692, 128]), torch.Size([1, 3692, 128])
----------------------------------------3
 Nvidia-smi: 1.8280029296875 GB
    Memory Allocated: 0.6075863838195801  GigaBytes
Max Memory Allocated: 0.6075863838195801  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.7348389625549316  GigaBytes
Max Memory Allocated: 0.7436413764953613  GigaBytes

rst.shape  torch.Size([1, 3692, 128])
m.shape torch.Size([3311, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.742551326751709  GigaBytes
Max Memory Allocated: 0.7436413764953613  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.742551326751709  GigaBytes
Max Memory Allocated: 0.7436413764953613  GigaBytes

 h.shape torch.Size([1, 3311, 128]), torch.Size([1, 3311, 128])
----------------------------------------3
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.7462382316589355  GigaBytes
Max Memory Allocated: 0.7462382316589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1209716796875 GB
    Memory Allocated: 0.8883728981018066  GigaBytes
Max Memory Allocated: 0.8978457450866699  GigaBytes

rst.shape  torch.Size([1, 3311, 128])
m.shape torch.Size([2918, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.1209716796875 GB
    Memory Allocated: 0.8965339660644531  GigaBytes
Max Memory Allocated: 0.8978457450866699  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1209716796875 GB
    Memory Allocated: 0.8965339660644531  GigaBytes
Max Memory Allocated: 0.8978457450866699  GigaBytes

 h.shape torch.Size([1, 2918, 128]), torch.Size([1, 2918, 128])
----------------------------------------3
 Nvidia-smi: 2.1209716796875 GB
    Memory Allocated: 0.8995041847229004  GigaBytes
Max Memory Allocated: 0.8995041847229004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 1.0390057563781738  GigaBytes
Max Memory Allocated: 1.0487456321716309  GigaBytes

rst.shape  torch.Size([1, 2918, 128])
m.shape torch.Size([2803, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 1.048255443572998  GigaBytes
Max Memory Allocated: 1.0487456321716309  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 1.048255443572998  GigaBytes
Max Memory Allocated: 1.0487456321716309  GigaBytes

 h.shape torch.Size([1, 2803, 128]), torch.Size([1, 2803, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 1.051039218902588  GigaBytes
Max Memory Allocated: 1.051039218902588  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4373779296875 GB
    Memory Allocated: 1.2093043327331543  GigaBytes
Max Memory Allocated: 1.2199969291687012  GigaBytes

rst.shape  torch.Size([1, 2803, 128])
m.shape torch.Size([2531, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.4373779296875 GB
    Memory Allocated: 1.219686508178711  GigaBytes
Max Memory Allocated: 1.2199969291687012  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4373779296875 GB
    Memory Allocated: 1.219686508178711  GigaBytes
Max Memory Allocated: 1.2199969291687012  GigaBytes

 h.shape torch.Size([1, 2531, 128]), torch.Size([1, 2531, 128])
----------------------------------------3
 Nvidia-smi: 2.4373779296875 GB
    Memory Allocated: 1.2223072052001953  GigaBytes
Max Memory Allocated: 1.2223072052001953  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5936279296875 GB
    Memory Allocated: 1.3793697357177734  GigaBytes
Max Memory Allocated: 1.3902316093444824  GigaBytes

rst.shape  torch.Size([1, 2531, 128])
m.shape torch.Size([32093, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.7479248046875 GB
    Memory Allocated: 1.5311942100524902  GigaBytes
Max Memory Allocated: 1.5347909927368164  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7479248046875 GB
    Memory Allocated: 1.5311942100524902  GigaBytes
Max Memory Allocated: 1.5347909927368164  GigaBytes

 h.shape torch.Size([1, 32093, 128]), torch.Size([1, 32093, 128])
----------------------------------------3
 Nvidia-smi: 2.7791748046875 GB
    Memory Allocated: 1.5624442100524902  GigaBytes
Max Memory Allocated: 1.5624442100524902  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1522216796875 GB
    Memory Allocated: 3.742570400238037  GigaBytes
Max Memory Allocated: 3.895601749420166  GigaBytes

rst.shape  torch.Size([1, 32093, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.1522216796875 GB
    Memory Allocated: 3.533188819885254  GigaBytes
Max Memory Allocated: 3.895601749420166  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.1522216796875 GB
    Memory Allocated: 3.5927515029907227  GigaBytes
Max Memory Allocated: 3.895601749420166  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.1522216796875 GB
    Memory Allocated: 3.6523141860961914  GigaBytes
Max Memory Allocated: 3.895601749420166  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.1522216796875 GB
    Memory Allocated: 3.5922861099243164  GigaBytes
Max Memory Allocated: 3.895601749420166  GigaBytes

torch.Size([62456, 256])
first layer input nodes number: 122510
first layer output nodes number: 62456
edges number: 463643
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.1522216796875 GB
    Memory Allocated: 3.653229236602783  GigaBytes
Max Memory Allocated: 3.895601749420166  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.1522216796875 GB
    Memory Allocated: 3.712791919708252  GigaBytes
Max Memory Allocated: 3.895601749420166  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.1522216796875 GB
    Memory Allocated: 3.728416919708252  GigaBytes
Max Memory Allocated: 3.895601749420166  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.1522216796875 GB
    Memory Allocated: 3.728416919708252  GigaBytes
Max Memory Allocated: 3.895601749420166  GigaBytes

m.shape torch.Size([1728, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2440185546875 GB
    Memory Allocated: 3.819681167602539  GigaBytes
Max Memory Allocated: 3.895601749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2440185546875 GB
    Memory Allocated: 3.819681167602539  GigaBytes
Max Memory Allocated: 3.895601749420166  GigaBytes

 h.shape torch.Size([1, 1728, 256]), torch.Size([1, 1728, 256])
----------------------------------------3
 Nvidia-smi: 5.2440185546875 GB
    Memory Allocated: 3.8234214782714844  GigaBytes
Max Memory Allocated: 3.895601749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2440185546875 GB
    Memory Allocated: 3.851475715637207  GigaBytes
Max Memory Allocated: 3.895601749420166  GigaBytes

rst.shape  torch.Size([1, 1728, 256])
m.shape torch.Size([1474, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2440185546875 GB
    Memory Allocated: 3.852661609649658  GigaBytes
Max Memory Allocated: 3.895601749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2440185546875 GB
    Memory Allocated: 3.852661609649658  GigaBytes
Max Memory Allocated: 3.895601749420166  GigaBytes

 h.shape torch.Size([1, 1474, 256]), torch.Size([1, 1474, 256])
----------------------------------------3
 Nvidia-smi: 5.2440185546875 GB
    Memory Allocated: 3.855795383453369  GigaBytes
Max Memory Allocated: 3.895601749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2440185546875 GB
    Memory Allocated: 3.898913860321045  GigaBytes
Max Memory Allocated: 3.9017252922058105  GigaBytes

rst.shape  torch.Size([1, 1474, 256])
m.shape torch.Size([1100, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.2440185546875 GB
    Memory Allocated: 3.9006800651550293  GigaBytes
Max Memory Allocated: 3.9017252922058105  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2440185546875 GB
    Memory Allocated: 3.9006800651550293  GigaBytes
Max Memory Allocated: 3.9017252922058105  GigaBytes

 h.shape torch.Size([1, 1100, 256]), torch.Size([1, 1100, 256])
----------------------------------------3
 Nvidia-smi: 5.2440185546875 GB
    Memory Allocated: 3.9028754234313965  GigaBytes
Max Memory Allocated: 3.9028754234313965  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2440185546875 GB
    Memory Allocated: 3.950307846069336  GigaBytes
Max Memory Allocated: 3.9534549713134766  GigaBytes

rst.shape  torch.Size([1, 1100, 256])
m.shape torch.Size([913, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.2440185546875 GB
    Memory Allocated: 3.952530860900879  GigaBytes
Max Memory Allocated: 3.9534549713134766  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2440185546875 GB
    Memory Allocated: 3.952530860900879  GigaBytes
Max Memory Allocated: 3.9534549713134766  GigaBytes

 h.shape torch.Size([1, 913, 256]), torch.Size([1, 913, 256])
----------------------------------------3
 Nvidia-smi: 5.2440185546875 GB
    Memory Allocated: 3.9542722702026367  GigaBytes
Max Memory Allocated: 3.9542722702026367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 4.004773139953613  GigaBytes
Max Memory Allocated: 4.008255958557129  GigaBytes

rst.shape  torch.Size([1, 913, 256])
m.shape torch.Size([758, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 4.007545471191406  GigaBytes
Max Memory Allocated: 4.008255958557129  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 4.007545471191406  GigaBytes
Max Memory Allocated: 4.008255958557129  GigaBytes

 h.shape torch.Size([1, 758, 256]), torch.Size([1, 758, 256])
----------------------------------------3
 Nvidia-smi: 5.2557373046875 GB
    Memory Allocated: 4.008991241455078  GigaBytes
Max Memory Allocated: 4.008991241455078  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3065185546875 GB
    Memory Allocated: 4.061338424682617  GigaBytes
Max Memory Allocated: 4.064952850341797  GigaBytes

rst.shape  torch.Size([1, 758, 256])
m.shape torch.Size([620, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.3065185546875 GB
    Memory Allocated: 4.0641913414001465  GigaBytes
Max Memory Allocated: 4.064952850341797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3065185546875 GB
    Memory Allocated: 4.0641913414001465  GigaBytes
Max Memory Allocated: 4.064952850341797  GigaBytes

 h.shape torch.Size([1, 620, 256]), torch.Size([1, 620, 256])
----------------------------------------3
 Nvidia-smi: 5.3065185546875 GB
    Memory Allocated: 4.06537389755249  GigaBytes
Max Memory Allocated: 4.06537389755249  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3729248046875 GB
    Memory Allocated: 4.1174445152282715  GigaBytes
Max Memory Allocated: 4.120992183685303  GigaBytes

rst.shape  torch.Size([1, 620, 256])
m.shape torch.Size([503, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.3729248046875 GB
    Memory Allocated: 4.120237827301025  GigaBytes
Max Memory Allocated: 4.120992183685303  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3729248046875 GB
    Memory Allocated: 4.120237827301025  GigaBytes
Max Memory Allocated: 4.120992183685303  GigaBytes

 h.shape torch.Size([1, 503, 256]), torch.Size([1, 503, 256])
----------------------------------------3
 Nvidia-smi: 5.3729248046875 GB
    Memory Allocated: 4.12119722366333  GigaBytes
Max Memory Allocated: 4.12119722366333  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 4.169773578643799  GigaBytes
Max Memory Allocated: 4.173131465911865  GigaBytes

rst.shape  torch.Size([1, 503, 256])
m.shape torch.Size([464, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 4.172861576080322  GigaBytes
Max Memory Allocated: 4.173131465911865  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 4.172861576080322  GigaBytes
Max Memory Allocated: 4.173131465911865  GigaBytes

 h.shape torch.Size([1, 464, 256]), torch.Size([1, 464, 256])
----------------------------------------3
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 4.173746585845947  GigaBytes
Max Memory Allocated: 4.173746585845947  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4666748046875 GB
    Memory Allocated: 4.224358558654785  GigaBytes
Max Memory Allocated: 4.227898597717285  GigaBytes

rst.shape  torch.Size([1, 464, 256])
m.shape torch.Size([403, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.4666748046875 GB
    Memory Allocated: 4.227402210235596  GigaBytes
Max Memory Allocated: 4.227898597717285  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4666748046875 GB
    Memory Allocated: 4.227402210235596  GigaBytes
Max Memory Allocated: 4.227898597717285  GigaBytes

 h.shape torch.Size([1, 403, 256]), torch.Size([1, 403, 256])
----------------------------------------3
 Nvidia-smi: 5.4666748046875 GB
    Memory Allocated: 4.228170871734619  GigaBytes
Max Memory Allocated: 4.228170871734619  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5330810546875 GB
    Memory Allocated: 4.277740001678467  GigaBytes
Max Memory Allocated: 4.281198978424072  GigaBytes

rst.shape  torch.Size([1, 403, 256])
m.shape torch.Size([310, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.5330810546875 GB
    Memory Allocated: 4.280335426330566  GigaBytes
Max Memory Allocated: 4.281198978424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5330810546875 GB
    Memory Allocated: 4.280335426330566  GigaBytes
Max Memory Allocated: 4.281198978424072  GigaBytes

 h.shape torch.Size([1, 310, 256]), torch.Size([1, 310, 256])
----------------------------------------3
 Nvidia-smi: 5.5330810546875 GB
    Memory Allocated: 4.280926704406738  GigaBytes
Max Memory Allocated: 4.281198978424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5408935546875 GB
    Memory Allocated: 4.326103687286377  GigaBytes
Max Memory Allocated: 4.329060077667236  GigaBytes

rst.shape  torch.Size([1, 310, 256])
m.shape torch.Size([272, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.5408935546875 GB
    Memory Allocated: 4.328683853149414  GigaBytes
Max Memory Allocated: 4.329060077667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5408935546875 GB
    Memory Allocated: 4.328683853149414  GigaBytes
Max Memory Allocated: 4.329060077667236  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 5.5408935546875 GB
    Memory Allocated: 4.329202651977539  GigaBytes
Max Memory Allocated: 4.329202651977539  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5858154296875 GB
    Memory Allocated: 4.371777534484863  GigaBytes
Max Memory Allocated: 4.374630928039551  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([227, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.5858154296875 GB
    Memory Allocated: 4.374136447906494  GigaBytes
Max Memory Allocated: 4.374630928039551  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5858154296875 GB
    Memory Allocated: 4.374136447906494  GigaBytes
Max Memory Allocated: 4.374630928039551  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 5.5858154296875 GB
    Memory Allocated: 4.374569416046143  GigaBytes
Max Memory Allocated: 4.374630928039551  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6229248046875 GB
    Memory Allocated: 4.41137170791626  GigaBytes
Max Memory Allocated: 4.41396951675415  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([198, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.6229248046875 GB
    Memory Allocated: 4.413629531860352  GigaBytes
Max Memory Allocated: 4.41396951675415  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6229248046875 GB
    Memory Allocated: 4.413629531860352  GigaBytes
Max Memory Allocated: 4.41396951675415  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 5.6229248046875 GB
    Memory Allocated: 4.414007186889648  GigaBytes
Max Memory Allocated: 4.414007186889648  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6619873046875 GB
    Memory Allocated: 4.448751449584961  GigaBytes
Max Memory Allocated: 4.451206207275391  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([182, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.6619873046875 GB
    Memory Allocated: 4.451011657714844  GigaBytes
Max Memory Allocated: 4.451206207275391  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6619873046875 GB
    Memory Allocated: 4.451011657714844  GigaBytes
Max Memory Allocated: 4.451206207275391  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 5.6619873046875 GB
    Memory Allocated: 4.451358795166016  GigaBytes
Max Memory Allocated: 4.451358795166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7030029296875 GB
    Memory Allocated: 4.485725402832031  GigaBytes
Max Memory Allocated: 4.488155364990234  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([165, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7030029296875 GB
    Memory Allocated: 4.487930774688721  GigaBytes
Max Memory Allocated: 4.488155364990234  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7030029296875 GB
    Memory Allocated: 4.487930774688721  GigaBytes
Max Memory Allocated: 4.488155364990234  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 5.7030029296875 GB
    Memory Allocated: 4.488245487213135  GigaBytes
Max Memory Allocated: 4.488245487213135  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7322998046875 GB
    Memory Allocated: 4.521605014801025  GigaBytes
Max Memory Allocated: 4.523965358734131  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([146, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7322998046875 GB
    Memory Allocated: 4.523693084716797  GigaBytes
Max Memory Allocated: 4.523965358734131  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7322998046875 GB
    Memory Allocated: 4.523693084716797  GigaBytes
Max Memory Allocated: 4.523965358734131  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 5.7322998046875 GB
    Memory Allocated: 4.5239715576171875  GigaBytes
Max Memory Allocated: 4.5239715576171875  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7576904296875 GB
    Memory Allocated: 4.555438995361328  GigaBytes
Max Memory Allocated: 4.557666778564453  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([130, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7576904296875 GB
    Memory Allocated: 4.557424068450928  GigaBytes
Max Memory Allocated: 4.557666778564453  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7576904296875 GB
    Memory Allocated: 4.557424068450928  GigaBytes
Max Memory Allocated: 4.557666778564453  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 5.7576904296875 GB
    Memory Allocated: 4.557672023773193  GigaBytes
Max Memory Allocated: 4.557672023773193  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7908935546875 GB
    Memory Allocated: 4.587426662445068  GigaBytes
Max Memory Allocated: 4.589534282684326  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([118, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7908935546875 GB
    Memory Allocated: 4.589344501495361  GigaBytes
Max Memory Allocated: 4.589534282684326  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7908935546875 GB
    Memory Allocated: 4.589344501495361  GigaBytes
Max Memory Allocated: 4.589534282684326  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 5.7908935546875 GB
    Memory Allocated: 4.589569568634033  GigaBytes
Max Memory Allocated: 4.589569568634033  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8182373046875 GB
    Memory Allocated: 4.618153095245361  GigaBytes
Max Memory Allocated: 4.620178699493408  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([102, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.8182373046875 GB
    Memory Allocated: 4.619903564453125  GigaBytes
Max Memory Allocated: 4.620178699493408  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8182373046875 GB
    Memory Allocated: 4.619903564453125  GigaBytes
Max Memory Allocated: 4.620178699493408  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 5.8182373046875 GB
    Memory Allocated: 4.620098114013672  GigaBytes
Max Memory Allocated: 4.620178699493408  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8631591796875 GB
    Memory Allocated: 4.646167755126953  GigaBytes
Max Memory Allocated: 4.648015975952148  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([96, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.8631591796875 GB
    Memory Allocated: 4.647915840148926  GigaBytes
Max Memory Allocated: 4.648015975952148  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8631591796875 GB
    Memory Allocated: 4.647915840148926  GigaBytes
Max Memory Allocated: 4.648015975952148  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 5.8631591796875 GB
    Memory Allocated: 4.648098945617676  GigaBytes
Max Memory Allocated: 4.648098945617676  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8885498046875 GB
    Memory Allocated: 4.673916816711426  GigaBytes
Max Memory Allocated: 4.675747871398926  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([92, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.8885498046875 GB
    Memory Allocated: 4.675682544708252  GigaBytes
Max Memory Allocated: 4.675747871398926  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8885498046875 GB
    Memory Allocated: 4.675682544708252  GigaBytes
Max Memory Allocated: 4.675747871398926  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 5.8885498046875 GB
    Memory Allocated: 4.675858020782471  GigaBytes
Max Memory Allocated: 4.675858020782471  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9139404296875 GB
    Memory Allocated: 4.701828479766846  GigaBytes
Max Memory Allocated: 4.703670978546143  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([66, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.9139404296875 GB
    Memory Allocated: 4.703230857849121  GigaBytes
Max Memory Allocated: 4.703670978546143  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9139404296875 GB
    Memory Allocated: 4.703230857849121  GigaBytes
Max Memory Allocated: 4.703670978546143  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.9139404296875 GB
    Memory Allocated: 4.703356742858887  GigaBytes
Max Memory Allocated: 4.703670978546143  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9315185546875 GB
    Memory Allocated: 4.722868919372559  GigaBytes
Max Memory Allocated: 4.7242536544799805  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([67, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.9315185546875 GB
    Memory Allocated: 4.724287509918213  GigaBytes
Max Memory Allocated: 4.7242937088012695  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9315185546875 GB
    Memory Allocated: 4.724287509918213  GigaBytes
Max Memory Allocated: 4.7242937088012695  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 5.9315185546875 GB
    Memory Allocated: 4.724415302276611  GigaBytes
Max Memory Allocated: 4.724415302276611  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9530029296875 GB
    Memory Allocated: 4.745117664337158  GigaBytes
Max Memory Allocated: 4.74658727645874  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([64, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.9530029296875 GB
    Memory Allocated: 4.746530055999756  GigaBytes
Max Memory Allocated: 4.74658727645874  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9530029296875 GB
    Memory Allocated: 4.746530055999756  GigaBytes
Max Memory Allocated: 4.74658727645874  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 5.9530029296875 GB
    Memory Allocated: 4.746652126312256  GigaBytes
Max Memory Allocated: 4.746652126312256  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9744873046875 GB
    Memory Allocated: 4.767282009124756  GigaBytes
Max Memory Allocated: 4.768746852874756  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([1170, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.0037841796875 GB
    Memory Allocated: 4.795334339141846  GigaBytes
Max Memory Allocated: 4.795443534851074  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0037841796875 GB
    Memory Allocated: 4.795334339141846  GigaBytes
Max Memory Allocated: 4.795443534851074  GigaBytes

 h.shape torch.Size([1, 1170, 256]), torch.Size([1, 1170, 256])
----------------------------------------3
 Nvidia-smi: 6.0037841796875 GB
    Memory Allocated: 4.797852039337158  GigaBytes
Max Memory Allocated: 4.797852039337158  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4432373046875 GB
    Memory Allocated: 5.2028021812438965  GigaBytes
Max Memory Allocated: 5.230697154998779  GigaBytes

rst.shape  torch.Size([1, 1170, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.4432373046875 GB
    Memory Allocated: 5.1229023933410645  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.4432373046875 GB
    Memory Allocated: 5.125062942504883  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.4432373046875 GB
    Memory Allocated: 5.1267571449279785  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.4432373046875 GB
    Memory Allocated: 5.12451171875  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

torch.Size([11368, 40])
input nodes number: 62456
output nodes number: 11368
edges number: 92650
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.4432373046875 GB
    Memory Allocated: 5.126756191253662  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.4432373046875 GB
    Memory Allocated: 5.1267571449279785  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.07787370681762695  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

pseudo mini batch 1 input nodes size: 122679
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.06592655181884766  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.06592655181884766  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.12442445755004883  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.12450933456420898  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.06583070755004883  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.07051753997802734  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.07051753997802734  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.07051753997802734  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

torch.Size([122679, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.07051753997802734  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

m.shape torch.Size([3207, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.29876184463500977  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.29876184463500977  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 3207, 128]), torch.Size([1, 3207, 128])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.3018202781677246  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.32628774642944336  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 3207, 128])
m.shape torch.Size([3998, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.3285713195800781  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.3285713195800781  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 3998, 128]), torch.Size([1, 3998, 128])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.3325052261352539  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.3911924362182617  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 3998, 128])
m.shape torch.Size([4108, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.39516258239746094  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.39516258239746094  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 4108, 128]), torch.Size([1, 4108, 128])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.3990802764892578  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.48526954650878906  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 4108, 128])
m.shape torch.Size([3858, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.4911003112792969  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.4911003112792969  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 3858, 128]), torch.Size([1, 3858, 128])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.49492645263671875  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.6073665618896484  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 3858, 128])
m.shape torch.Size([3671, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.6142792701721191  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.6142792701721191  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 3671, 128]), torch.Size([1, 3671, 128])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.6179203987121582  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.7445063591003418  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 3671, 128])
m.shape torch.Size([3315, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.7522401809692383  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.7522401809692383  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 3315, 128]), torch.Size([1, 3315, 128])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.7554826736450195  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.8963861465454102  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 3315, 128])
m.shape torch.Size([2943, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.9046287536621094  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.9046287536621094  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 2943, 128]), torch.Size([1, 2943, 128])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.9076523780822754  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 1.048902988433838  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 2943, 128])
m.shape torch.Size([2768, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 1.058058738708496  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 1.058058738708496  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 2768, 128]), torch.Size([1, 2768, 128])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 1.0607500076293945  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 1.2116022109985352  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 2768, 128])
m.shape torch.Size([2539, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 1.2211785316467285  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 1.2211785316467285  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 2539, 128]), torch.Size([1, 2539, 128])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 1.2237310409545898  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 1.38130521774292  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 2539, 128])
m.shape torch.Size([32017, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 1.5327634811401367  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 1.5327634811401367  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 32017, 128]), torch.Size([1, 32017, 128])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 1.5632972717285156  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 3.731196403503418  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 32017, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 3.52311372756958  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 3.582645893096924  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 3.6421780586242676  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 3.5821805000305176  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

torch.Size([62424, 256])
first layer input nodes number: 122679
first layer output nodes number: 62424
edges number: 462970
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 3.643094062805176  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 3.7026262283325195  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 3.7175092697143555  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 3.7175092697143555  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

m.shape torch.Size([1684, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 3.807823657989502  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 3.807823657989502  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 1684, 256]), torch.Size([1, 1684, 256])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 3.811622142791748  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 3.8394389152526855  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 1684, 256])
m.shape torch.Size([1466, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 3.8398842811584473  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 3.8398842811584473  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 1466, 256]), torch.Size([1, 1466, 256])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 3.8427200317382812  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 3.884868621826172  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 1466, 256])
m.shape torch.Size([1230, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 3.887728214263916  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 3.887728214263916  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 1230, 256]), torch.Size([1, 1230, 256])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 3.8905930519104004  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 3.9458069801330566  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 1230, 256])
m.shape torch.Size([906, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 3.9486660957336426  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 3.9486660957336426  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 906, 256]), torch.Size([1, 906, 256])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 3.9503941535949707  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.010206699371338  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 906, 256])
m.shape torch.Size([743, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.013635158538818  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.013635158538818  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 743, 256]), torch.Size([1, 743, 256])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.015052318572998  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.066737651824951  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 743, 256])
m.shape torch.Size([632, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.069674015045166  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.069674015045166  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 632, 256]), torch.Size([1, 632, 256])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.0708794593811035  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.124247074127197  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 632, 256])
m.shape torch.Size([512, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.127089023590088  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.127089023590088  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 512, 256]), torch.Size([1, 512, 256])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.128065586090088  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.178401470184326  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 512, 256])
m.shape torch.Size([437, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.181273460388184  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.181273460388184  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 437, 256]), torch.Size([1, 437, 256])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.182106971740723  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.229763984680176  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 437, 256])
m.shape torch.Size([371, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.2325568199157715  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.2325568199157715  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 371, 256]), torch.Size([1, 371, 256])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.233264446258545  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.279077053070068  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 371, 256])
m.shape torch.Size([354, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.282125949859619  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.282125949859619  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 354, 256]), torch.Size([1, 354, 256])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.282801151275635  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.331366062164307  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 354, 256])
m.shape torch.Size([271, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.333893775939941  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.333893775939941  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.334410667419434  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.376725196838379  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([244, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.379281044006348  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.379281044006348  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 244, 256]), torch.Size([1, 244, 256])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.379746437072754  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.419304847717285  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 244, 256])
m.shape torch.Size([172, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.4212212562561035  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.4212212562561035  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.421549320220947  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.451731204986572  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([161, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.453733921051025  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.453733921051025  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.454041004180908  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.484442234039307  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([176, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.486826419830322  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.486826419830322  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.487162113189697  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.522745609283447  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([133, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.524623394012451  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.524623394012451  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.524877071380615  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.553542613983154  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([125, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.5554585456848145  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.5554585456848145  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.555696964263916  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.5843071937561035  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([106, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.586021900177002  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.586021900177002  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.58622407913208  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.611900806427002  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([107, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.613753795623779  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.613753795623779  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.61395788192749  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.641305446624756  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([106, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.643344402313232  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.643344402313232  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.6435465812683105  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.672053813934326  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([83, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.673628330230713  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.673628330230713  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.673786640167236  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.697216510772705  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([69, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.698596477508545  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.698596477508545  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.698728084564209  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.719127178192139  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([65, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.720498561859131  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.720498561859131  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.720622539520264  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.740706920623779  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([78, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.7424445152282715  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.7424445152282715  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.742593288421631  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.767735958099365  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([1137, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.794981956481934  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.794981956481934  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 1137, 256]), torch.Size([1, 1137, 256])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 4.797734260559082  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 5.180478096008301  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 1137, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 5.102144718170166  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 5.103838920593262  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 5.105533123016357  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 5.103754043579102  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

torch.Size([11368, 40])
input nodes number: 62424
output nodes number: 11368
edges number: 91802
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 5.104304313659668  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 5.104304790496826  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.07794427871704102  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

pseudo mini batch 2 input nodes size: 123592
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.06583070755004883  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.06583070755004883  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.12476396560668945  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.12484884262084961  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.06626605987548828  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.0705270767211914  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.0705270767211914  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.0705270767211914  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

torch.Size([123592, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.0705270767211914  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

m.shape torch.Size([3189, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 0.3027353286743164  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 0.3027353286743164  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 3189, 128]), torch.Size([1, 3189, 128])
----------------------------------------3
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 0.3059110641479492  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 0.33109331130981445  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 3189, 128])
m.shape torch.Size([4022, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 0.3334083557128906  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 0.3334083557128906  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 4022, 128]), torch.Size([1, 4022, 128])
----------------------------------------3
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 0.338228702545166  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 0.39661073684692383  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 4022, 128])
m.shape torch.Size([4144, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 0.4006209373474121  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 0.4006209373474121  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 4144, 128]), torch.Size([1, 4144, 128])
----------------------------------------3
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 0.4047389030456543  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 0.4916834831237793  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 4144, 128])
m.shape torch.Size([3916, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 0.49742841720581055  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 0.49742841720581055  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 3916, 128]), torch.Size([1, 3916, 128])
----------------------------------------3
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 0.5012755393981934  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 0.613584041595459  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 3916, 128])
m.shape torch.Size([3695, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 0.6205263137817383  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 0.6205263137817383  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 3695, 128]), torch.Size([1, 3695, 128])
----------------------------------------3
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 0.6241121292114258  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 0.7514462471008301  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 3695, 128])
m.shape torch.Size([3302, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 0.7591314315795898  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 0.7591314315795898  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 3302, 128]), torch.Size([1, 3302, 128])
----------------------------------------3
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 0.7628054618835449  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 0.9026732444763184  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 3302, 128])
m.shape torch.Size([3109, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 0.9114761352539062  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 0.9114761352539062  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 3109, 128]), torch.Size([1, 3109, 128])
----------------------------------------3
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 0.9145264625549316  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 1.0646371841430664  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 3109, 128])
m.shape torch.Size([2840, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 1.073988437652588  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 1.073988437652588  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 2840, 128]), torch.Size([1, 2840, 128])
----------------------------------------3
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 1.0768251419067383  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 1.2355270385742188  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 2840, 128])
m.shape torch.Size([2515, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 1.2443938255310059  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 1.2443938255310059  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 2515, 128]), torch.Size([1, 2515, 128])
----------------------------------------3
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 1.2476391792297363  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 1.404116153717041  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 2515, 128])
m.shape torch.Size([32647, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 1.5585899353027344  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 1.5585899353027344  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 32647, 128]), torch.Size([1, 32647, 128])
----------------------------------------3
 Nvidia-smi: 6.8533935546875 GB
    Memory Allocated: 1.5897245407104492  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.806974411010742  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 32647, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.5957531929016113  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.656196117401123  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.7166390419006348  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.6557235717773438  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

torch.Size([63379, 256])
first layer input nodes number: 123592
first layer output nodes number: 63379
edges number: 471204
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.717562198638916  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.7780051231384277  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.7931160926818848  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.7931160926818848  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

m.shape torch.Size([1687, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.8848800659179688  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.8848800659179688  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 1687, 256]), torch.Size([1, 1687, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.888665199279785  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.915745258331299  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 1687, 256])
m.shape torch.Size([1404, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.916835308074951  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.916835308074951  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 1404, 256]), torch.Size([1, 1404, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.9196720123291016  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.9613137245178223  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 1404, 256])
m.shape torch.Size([1189, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.9634652137756348  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.9634652137756348  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 1189, 256]), torch.Size([1, 1189, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.965940475463867  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.017287731170654  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 1189, 256])
m.shape torch.Size([905, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.020144939422607  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.020144939422607  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 905, 256]), torch.Size([1, 905, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.021871089935303  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.07806921005249  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 905, 256])
m.shape torch.Size([758, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.081198692321777  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.081198692321777  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 758, 256]), torch.Size([1, 758, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.082644462585449  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.134692192077637  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 758, 256])
m.shape torch.Size([619, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.137539386749268  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.137539386749268  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 619, 256]), torch.Size([1, 619, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.1387200355529785  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.190769672393799  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 619, 256])
m.shape torch.Size([538, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.193799018859863  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.193799018859863  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 538, 256]), torch.Size([1, 538, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.194825172424316  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.246272087097168  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 538, 256])
m.shape torch.Size([434, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.249096393585205  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.249096393585205  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 434, 256]), torch.Size([1, 434, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.249924182891846  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.297148704528809  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 434, 256])
m.shape torch.Size([345, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.299719333648682  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.299719333648682  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 345, 256]), torch.Size([1, 345, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.300377368927002  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.3434739112854  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 345, 256])
m.shape torch.Size([316, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.346182346343994  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.346182346343994  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 316, 256]), torch.Size([1, 316, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.346785068511963  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.389881610870361  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 316, 256])
m.shape torch.Size([323, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.392995357513428  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.392995357513428  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 323, 256]), torch.Size([1, 323, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.393611431121826  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.442030429840088  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 323, 256])
m.shape torch.Size([249, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.444594383239746  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.444594383239746  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.445069313049316  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.485438346862793  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([220, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.487949848175049  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.487949848175049  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.488369464874268  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.526974201202393  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([184, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.529240608215332  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.529240608215332  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.5295915603637695  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.564335823059082  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([161, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.566481590270996  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.566481590270996  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.566788673400879  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.599339485168457  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([151, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.601508140563965  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.601508140563965  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.6017961502075195  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.634341239929199  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([118, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.636493682861328  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.636493682861328  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.63671875  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.663726806640625  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([108, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.665482997894287  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.665482997894287  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.665688991546631  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.691850185394287  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([93, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.693445682525635  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.693445682525635  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.693623065948486  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.717392444610596  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([94, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.71911096572876  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.71911096572876  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.719290256500244  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.744570255279541  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([78, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.7460551261901855  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.7460551261901855  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.746203899383545  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.768222332000732  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([86, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.7699666023254395  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.7699666023254395  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.770130634307861  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.795555591583252  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([46, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.796530723571777  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.796530723571777  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.796618461608887  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.8108320236206055  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([60, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.812357425689697  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.812357425689697  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.812471866607666  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.831812381744385  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([1202, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.861276149749756  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.861276149749756  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

 h.shape torch.Size([1, 1202, 256]), torch.Size([1, 1202, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.863589763641357  GigaBytes
Max Memory Allocated: 5.233969688415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 5.270658016204834  GigaBytes
Max Memory Allocated: 5.299315929412842  GigaBytes

rst.shape  torch.Size([1, 1202, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 5.189570426940918  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 5.191695213317871  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 5.194050312042236  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 5.191840648651123  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

torch.Size([11368, 40])
input nodes number: 63379
output nodes number: 11368
edges number: 93172
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 5.19282865524292  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 5.192829132080078  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.07844352722167969  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

pseudo mini batch 3 input nodes size: 123065
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.0666966438293457  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.0666966438293457  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.12537860870361328  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.12546348571777344  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.06644535064697266  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.07096147537231445  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.07096147537231445  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.07096147537231445  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

torch.Size([123065, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.07096147537231445  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

m.shape torch.Size([3313, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.3032207489013672  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.3032207489013672  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

 h.shape torch.Size([1, 3313, 128]), torch.Size([1, 3313, 128])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.3063802719116211  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.33214330673217773  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

rst.shape  torch.Size([1, 3313, 128])
m.shape torch.Size([3941, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.3338966369628906  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.3338966369628906  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

 h.shape torch.Size([1, 3941, 128]), torch.Size([1, 3941, 128])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.33765506744384766  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.3963966369628906  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

rst.shape  torch.Size([1, 3941, 128])
m.shape torch.Size([4062, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.40015506744384766  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.40015506744384766  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

 h.shape torch.Size([1, 4062, 128]), torch.Size([1, 4062, 128])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.40402889251708984  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.4899592399597168  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

rst.shape  torch.Size([1, 4062, 128])
m.shape torch.Size([3916, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.49549150466918945  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.49549150466918945  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

 h.shape torch.Size([1, 3916, 128]), torch.Size([1, 3916, 128])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.499295711517334  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.6126046180725098  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

rst.shape  torch.Size([1, 3916, 128])
m.shape torch.Size([3656, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.6194539070129395  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.6194539070129395  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

 h.shape torch.Size([1, 3656, 128]), torch.Size([1, 3656, 128])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.6230883598327637  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.7493166923522949  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

rst.shape  torch.Size([1, 3656, 128])
m.shape torch.Size([3286, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.7569746971130371  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.7569746971130371  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

 h.shape torch.Size([1, 3286, 128]), torch.Size([1, 3286, 128])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.7603316307067871  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.9000277519226074  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

rst.shape  torch.Size([1, 3286, 128])
m.shape torch.Size([2998, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.9085907936096191  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.9085907936096191  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

 h.shape torch.Size([1, 2998, 128]), torch.Size([1, 2998, 128])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.911588191986084  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 1.0608983039855957  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

rst.shape  torch.Size([1, 2998, 128])
m.shape torch.Size([2810, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 1.070188045501709  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 1.070188045501709  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

 h.shape torch.Size([1, 2810, 128]), torch.Size([1, 2810, 128])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 1.0730247497558594  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 1.231954574584961  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

rst.shape  torch.Size([1, 2810, 128])
m.shape torch.Size([2519, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 1.2414250373840332  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 1.2414250373840332  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

 h.shape torch.Size([1, 2519, 128]), torch.Size([1, 2519, 128])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 1.2439661026000977  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 1.4006199836730957  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

rst.shape  torch.Size([1, 2519, 128])
m.shape torch.Size([32746, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 1.555668830871582  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 1.555668830871582  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

 h.shape torch.Size([1, 32746, 128]), torch.Size([1, 32746, 128])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 1.586897850036621  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.805375099182129  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

rst.shape  torch.Size([1, 32746, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.5939621925354004  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.6542792320251465  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.7145962715148926  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.6538076400756836  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

torch.Size([63247, 256])
first layer input nodes number: 123065
first layer output nodes number: 63247
edges number: 470638
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.71551513671875  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.775832176208496  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.7909116744995117  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.7909116744995117  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

m.shape torch.Size([1741, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.8837761878967285  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.8837761878967285  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

 h.shape torch.Size([1, 1741, 256]), torch.Size([1, 1741, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.887592315673828  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.9159975051879883  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

rst.shape  torch.Size([1, 1741, 256])
m.shape torch.Size([1434, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.917609214782715  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.917609214782715  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

 h.shape torch.Size([1, 1434, 256]), torch.Size([1, 1434, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.9206056594848633  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.9638829231262207  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

rst.shape  torch.Size([1, 1434, 256])
m.shape torch.Size([1106, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.966071605682373  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.966071605682373  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

 h.shape torch.Size([1, 1106, 256]), torch.Size([1, 1106, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 3.9690070152282715  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.016947269439697  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

rst.shape  torch.Size([1, 1106, 256])
m.shape torch.Size([923, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.019836902618408  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.019836902618408  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

 h.shape torch.Size([1, 923, 256]), torch.Size([1, 923, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.021597385406494  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.0774006843566895  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

rst.shape  torch.Size([1, 923, 256])
m.shape torch.Size([790, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.0804667472839355  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.0804667472839355  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

 h.shape torch.Size([1, 790, 256]), torch.Size([1, 790, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.081973552703857  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.140075206756592  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

rst.shape  torch.Size([1, 790, 256])
m.shape torch.Size([592, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.142735958099365  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.142735958099365  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

 h.shape torch.Size([1, 592, 256]), torch.Size([1, 592, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.14386510848999  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.19275426864624  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

rst.shape  torch.Size([1, 592, 256])
m.shape torch.Size([491, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.195493221282959  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.195493221282959  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

 h.shape torch.Size([1, 491, 256]), torch.Size([1, 491, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.19642972946167  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.24416971206665  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

rst.shape  torch.Size([1, 491, 256])
m.shape torch.Size([405, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.2468156814575195  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.2468156814575195  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

 h.shape torch.Size([1, 405, 256]), torch.Size([1, 405, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.247588157653809  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.292449951171875  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

rst.shape  torch.Size([1, 405, 256])
m.shape torch.Size([373, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.295290470123291  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.295290470123291  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

 h.shape torch.Size([1, 373, 256]), torch.Size([1, 373, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.29600191116333  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.341602802276611  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

rst.shape  torch.Size([1, 373, 256])
m.shape torch.Size([350, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.344611167907715  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.344611167907715  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

 h.shape torch.Size([1, 350, 256]), torch.Size([1, 350, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.345278739929199  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.394984245300293  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

rst.shape  torch.Size([1, 350, 256])
m.shape torch.Size([281, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.3976216316223145  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.3976216316223145  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.398157596588135  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.440493106842041  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([238, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.442970275878906  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.442970275878906  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.443424224853516  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.4820098876953125  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([209, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.484394550323486  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.484394550323486  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.484793186187744  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.521467685699463  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([161, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.523435115814209  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.523435115814209  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.523742198944092  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.55414342880249  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([161, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.556311130523682  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.556311130523682  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.5566182136535645  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.589169025421143  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([128, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.590983867645264  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.590983867645264  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.591228008270264  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.618815898895264  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([147, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.621096134185791  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.621096134185791  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.6213765144348145  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.655022144317627  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([128, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.6570963859558105  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.6570963859558105  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.6573405265808105  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.6883463859558105  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([114, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.690306186676025  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.690306186676025  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.690523624420166  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.71966028213501  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([91, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.721301078796387  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.721301078796387  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.721474647521973  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.74594783782959  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([96, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.747798919677734  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.747798919677734  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.747982025146484  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.775081634521484  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([71, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.776491641998291  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.776491641998291  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.776627063751221  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.797617435455322  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([75, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.79920768737793  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.79920768737793  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.799350738525391  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.8225250244140625  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([66, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.823976039886475  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.823976039886475  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 4.82410192489624  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0174560546875 GB
    Memory Allocated: 4.845376491546631  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([1197, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.0174560546875 GB
    Memory Allocated: 4.874833583831787  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0174560546875 GB
    Memory Allocated: 4.874833583831787  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

 h.shape torch.Size([1, 1197, 256]), torch.Size([1, 1197, 256])
----------------------------------------3
 Nvidia-smi: 7.0174560546875 GB
    Memory Allocated: 4.877139568328857  GigaBytes
Max Memory Allocated: 5.301914691925049  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0174560546875 GB
    Memory Allocated: 5.283086776733398  GigaBytes
Max Memory Allocated: 5.3116254806518555  GigaBytes

rst.shape  torch.Size([1, 1197, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0174560546875 GB
    Memory Allocated: 5.201559066772461  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0174560546875 GB
    Memory Allocated: 5.203258514404297  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0174560546875 GB
    Memory Allocated: 5.205514907836914  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.0174560546875 GB
    Memory Allocated: 5.203730583190918  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

torch.Size([11368, 40])
input nodes number: 63247
output nodes number: 11368
edges number: 93637
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0174560546875 GB
    Memory Allocated: 5.203861713409424  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.0174560546875 GB
    Memory Allocated: 5.203862190246582  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.07828998565673828  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

pseudo mini batch 4 input nodes size: 122913
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.06602001190185547  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.06602001190185547  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.12462949752807617  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.12471437454223633  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.0659475326538086  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.07052946090698242  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.07052946090698242  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.07052946090698242  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

torch.Size([122913, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.07052946090698242  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

m.shape torch.Size([3150, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.3012666702270508  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.3012666702270508  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 3150, 128]), torch.Size([1, 3150, 128])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.30427074432373047  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.32986879348754883  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 3150, 128])
m.shape torch.Size([3949, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.33213281631469727  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.33213281631469727  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 3949, 128]), torch.Size([1, 3949, 128])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.33596038818359375  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.39469432830810547  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 3949, 128])
m.shape torch.Size([3989, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.3985176086425781  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.3985176086425781  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 3989, 128]), torch.Size([1, 3989, 128])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.40232181549072266  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.4880552291870117  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 3989, 128])
m.shape torch.Size([3900, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.4935917854309082  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.4935917854309082  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 3900, 128]), torch.Size([1, 3900, 128])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.49735355377197266  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.610898494720459  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 3900, 128])
m.shape torch.Size([3741, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.6179580688476562  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.6179580688476562  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 3741, 128]), torch.Size([1, 3741, 128])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.6216626167297363  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.7500996589660645  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 3741, 128])
m.shape torch.Size([3263, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.7576513290405273  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.7576513290405273  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 3263, 128]), torch.Size([1, 3263, 128])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.7610368728637695  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.9013690948486328  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 3263, 128])
m.shape torch.Size([3039, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.9099569320678711  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.9099569320678711  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 3039, 128]), torch.Size([1, 3039, 128])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.9129619598388672  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 1.06341552734375  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 3039, 128])
m.shape torch.Size([2836, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 1.073559284210205  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 1.073559284210205  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 2836, 128]), torch.Size([1, 2836, 128])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 1.0762677192687988  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 1.2346997261047363  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 2836, 128])
m.shape torch.Size([2632, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 1.2440438270568848  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 1.2440438270568848  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 2632, 128]), torch.Size([1, 2632, 128])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 1.2479462623596191  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 1.412825107574463  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 2632, 128])
m.shape torch.Size([32394, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 1.565330982208252  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 1.565330982208252  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 32394, 128]), torch.Size([1, 32394, 128])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 1.596224308013916  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.810337543487549  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 32394, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.5979270935058594  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.6579065322875977  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.717885971069336  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.657437801361084  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

torch.Size([62893, 256])
first layer input nodes number: 122913
first layer output nodes number: 62893
edges number: 468487
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.718803882598877  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.7787833213806152  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.793778419494629  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.793778419494629  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

m.shape torch.Size([1644, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.8851675987243652  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.8851675987243652  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 1644, 256]), torch.Size([1, 1644, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.8889293670654297  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.9152560234069824  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 1644, 256])
m.shape torch.Size([1474, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.9166340827941895  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.9166340827941895  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 1474, 256]), torch.Size([1, 1474, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.9197349548339844  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.962678909301758  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 1474, 256])
m.shape torch.Size([1138, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.965383529663086  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.965383529663086  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 1138, 256]), torch.Size([1, 1138, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.9678430557250977  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.017532825469971  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 1138, 256])
m.shape torch.Size([942, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.020420074462891  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.020420074462891  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 942, 256]), torch.Size([1, 942, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.022216796875  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.0802154541015625  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 942, 256])
m.shape torch.Size([828, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.083432674407959  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.083432674407959  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 828, 256]), torch.Size([1, 828, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.085011959075928  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.1480021476745605  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 828, 256])
m.shape torch.Size([603, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.150690078735352  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.150690078735352  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 603, 256]), torch.Size([1, 603, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.1518402099609375  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.201295852661133  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 603, 256])
m.shape torch.Size([485, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.203984260559082  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.203984260559082  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 485, 256]), torch.Size([1, 485, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.204909324645996  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.251380920410156  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 485, 256])
m.shape torch.Size([446, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.254347801208496  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.254347801208496  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 446, 256]), torch.Size([1, 446, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.2551984786987305  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.305171012878418  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 446, 256])
m.shape torch.Size([362, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.307877063751221  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.307877063751221  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 362, 256]), torch.Size([1, 362, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.308567523956299  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.353066921234131  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 362, 256])
m.shape torch.Size([311, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.355710983276367  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.355710983276367  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.356304168701172  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.399936676025391  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([262, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.402410507202148  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.402410507202148  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.402910232543945  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.44264030456543  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([264, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.445435523986816  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.445435523986816  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.445939064025879  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.490067481994629  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([206, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.492389678955078  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.492389678955078  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.4927825927734375  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.5289306640625  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([199, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.531412124633789  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.531412124633789  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.531791687011719  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.569368362426758  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([162, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.571514129638672  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.571514129638672  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.5718231201171875  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.604576110839844  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([144, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.606636047363281  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.606636047363281  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.606910705566406  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.637947082519531  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([131, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.639950275421143  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.639950275421143  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.640200138092041  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.6701836585998535  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([111, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.6719794273376465  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.6719794273376465  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.672191143035889  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.6990790367126465  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([99, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.700781345367432  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.700781345367432  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.70097017288208  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.726273059844971  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([114, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.728370189666748  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.728370189666748  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.728587627410889  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.759246349334717  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([97, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.7610955238342285  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.7610955238342285  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.761280536651611  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.788662433624268  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([76, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.790390968322754  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.790390968322754  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.790535926818848  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.813004493713379  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([71, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.814501762390137  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.814501762390137  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.814637184143066  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.836575508117676  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([56, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.837799549102783  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.837799549102783  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.837906360626221  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.855957508087158  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([1143, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.884174346923828  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.884174346923828  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 1143, 256]), torch.Size([1, 1143, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.886354446411133  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 5.273796081542969  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 1143, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 5.194857597351074  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 5.19655179977417  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 5.198246002197266  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 5.19646692276001  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

torch.Size([11368, 40])
input nodes number: 62893
output nodes number: 11368
edges number: 92758
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 5.197015285491943  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 5.197015762329102  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.07784843444824219  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

pseudo mini batch 5 input nodes size: 122928
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.06594228744506836  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.06594228744506836  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.12455892562866211  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.12464380264282227  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.0659494400024414  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.07053375244140625  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.07053375244140625  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.07053375244140625  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

torch.Size([122928, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.07053375244140625  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

m.shape torch.Size([3111, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.30269670486450195  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.30269670486450195  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 3111, 128]), torch.Size([1, 3111, 128])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.3056635856628418  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.33018922805786133  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 3111, 128])
m.shape torch.Size([3988, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.33250904083251953  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.33250904083251953  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 3988, 128]), torch.Size([1, 3988, 128])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.3363924026489258  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.39508914947509766  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 3988, 128])
m.shape torch.Size([4015, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.39893102645874023  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.39893102645874023  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 4015, 128]), torch.Size([1, 4015, 128])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.40276002883911133  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.4885430335998535  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 4015, 128])
m.shape torch.Size([3828, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.4939298629760742  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.4939298629760742  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 3828, 128]), torch.Size([1, 3828, 128])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.49772024154663086  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.6050100326538086  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 3828, 128])
m.shape torch.Size([3769, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.6121706962585449  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.6121706962585449  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 3769, 128]), torch.Size([1, 3769, 128])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.6157650947570801  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.7451634407043457  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 3769, 128])
m.shape torch.Size([3297, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.7527990341186523  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.7527990341186523  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 3297, 128]), torch.Size([1, 3297, 128])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.7561554908752441  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.8960185050964355  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 3297, 128])
m.shape torch.Size([3050, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.9054512977600098  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.9054512977600098  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 3050, 128]), torch.Size([1, 3050, 128])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.9085698127746582  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 1.0584826469421387  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 3050, 128])
m.shape torch.Size([2853, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 1.0672869682312012  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 1.0672869682312012  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 2853, 128]), torch.Size([1, 2853, 128])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 1.0714449882507324  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 1.2309012413024902  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 2853, 128])
m.shape torch.Size([2598, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 1.2406902313232422  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 1.2406902313232422  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 2598, 128]), torch.Size([1, 2598, 128])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 1.243185043334961  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 1.4074649810791016  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 2598, 128])
m.shape torch.Size([32673, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 1.5624761581420898  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 1.5624761581420898  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 32673, 128]), torch.Size([1, 32673, 128])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 1.5936355590820312  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.8112077713012695  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 32673, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.597965717315674  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.6582207679748535  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.718475818634033  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.657749652862549  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

torch.Size([63182, 256])
first layer input nodes number: 122928
first layer output nodes number: 63182
edges number: 471357
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.719393730163574  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.779648780822754  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.794712543487549  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.794712543487549  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

m.shape torch.Size([1609, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.887134552001953  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.887134552001953  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 1609, 256]), torch.Size([1, 1609, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.8908743858337402  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.9166178703308105  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 1609, 256])
m.shape torch.Size([1454, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.9180455207824707  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.9180455207824707  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 1454, 256]), torch.Size([1, 1454, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.9209680557250977  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.9638452529907227  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 1454, 256])
m.shape torch.Size([1146, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.966317653656006  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.966317653656006  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 1146, 256]), torch.Size([1, 1146, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.9686717987060547  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.020152568817139  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 1146, 256])
m.shape torch.Size([934, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.022366523742676  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.022366523742676  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 934, 256]), torch.Size([1, 934, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.024147987365723  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.080473899841309  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 934, 256])
m.shape torch.Size([793, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.083564281463623  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.083564281463623  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 793, 256]), torch.Size([1, 793, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.085076808929443  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.143233776092529  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 793, 256])
m.shape torch.Size([604, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.145960807800293  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.145960807800293  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 604, 256]), torch.Size([1, 604, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.147112846374512  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.197292804718018  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 604, 256])
m.shape torch.Size([495, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.200047492980957  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.200047492980957  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 495, 256]), torch.Size([1, 495, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.200991630554199  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.250009536743164  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 495, 256])
m.shape torch.Size([455, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.253036022186279  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.253036022186279  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 455, 256]), torch.Size([1, 455, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.253903865814209  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.304278373718262  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 455, 256])
m.shape torch.Size([404, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.307339191436768  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.307339191436768  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.308109760284424  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.357494831085205  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([317, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.360156536102295  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.360156536102295  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 317, 256]), torch.Size([1, 317, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.3607611656188965  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.40470552444458  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 317, 256])
m.shape torch.Size([286, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.4074273109436035  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.4074273109436035  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.407972812652588  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.4507222175598145  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([229, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.453090667724609  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.453090667724609  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.453527450561523  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.490653991699219  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([237, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.493397235870361  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.493397235870361  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.493849277496338  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.535437107086182  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([179, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.538292407989502  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.538292407989502  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.538633823394775  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.572433948516846  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([152, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.5744547843933105  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.5744547843933105  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.574744701385498  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.605475902557373  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([118, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.6071457862854  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.6071457862854  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.607370853424072  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.632803440093994  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([125, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.6347336769104  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.6347336769104  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.634972095489502  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.6635823249816895  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([118, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.6655049324035645  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.6655049324035645  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.665729999542236  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.6943135261535645  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([111, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.69622802734375  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.69622802734375  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.696439743041992  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.724809646606445  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([98, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.726587772369385  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.726587772369385  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.7267746925354  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.7531304359436035  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([82, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.754692077636719  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.754692077636719  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.754848480224609  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.777996063232422  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([60, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.779186725616455  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.779186725616455  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.779301166534424  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.79703950881958  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([60, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.798308849334717  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.798308849334717  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.7984232902526855  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.816962718963623  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([75, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.818635940551758  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.818635940551758  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.818778991699219  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.842954635620117  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([1227, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.872408866882324  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.872408866882324  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

 h.shape torch.Size([1, 1227, 256]), torch.Size([1, 1227, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.875268936157227  GigaBytes
Max Memory Allocated: 5.3139567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 5.297507286071777  GigaBytes
Max Memory Allocated: 5.326761245727539  GigaBytes

rst.shape  torch.Size([1, 1227, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 5.2168965339660645  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 5.2187886238098145  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 5.22048282623291  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 5.218505859375  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

torch.Size([11368, 40])
input nodes number: 63182
output nodes number: 11368
edges number: 94055
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 5.219061851501465  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 5.219062328338623  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.07795047760009766  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

pseudo mini batch 6 input nodes size: 122818
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.0659494400024414  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.0659494400024414  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.1245431900024414  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.12462806701660156  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.06592655181884766  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.07009601593017578  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.07009601593017578  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.07009601593017578  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

torch.Size([122818, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.07009601593017578  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

m.shape torch.Size([3158, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.300076961517334  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.300076961517334  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3158, 128]), torch.Size([1, 3158, 128])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.303347110748291  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.3279685974121094  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3158, 128])
m.shape torch.Size([4085, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.33035850524902344  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.33035850524902344  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 4085, 128]), torch.Size([1, 4085, 128])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.33425426483154297  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.39285850524902344  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 4085, 128])
m.shape torch.Size([4162, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.396822452545166  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.396822452545166  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 4162, 128]), torch.Size([1, 4162, 128])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.40079689025878906  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.48811912536621094  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 4162, 128])
m.shape torch.Size([3867, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.4938211441040039  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.4938211441040039  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3867, 128]), torch.Size([1, 3867, 128])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.4975762367248535  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.6097726821899414  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3867, 128])
m.shape torch.Size([3655, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.6171483993530273  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.6171483993530273  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3655, 128]), torch.Size([1, 3655, 128])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.6207342147827148  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.7469387054443359  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3655, 128])
m.shape torch.Size([3271, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.7541942596435547  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.7541942596435547  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3271, 128]), torch.Size([1, 3271, 128])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.7575588226318359  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.8992071151733398  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3271, 128])
m.shape torch.Size([3050, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.9070134162902832  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.9070134162902832  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3050, 128]), torch.Size([1, 3050, 128])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 0.9108419418334961  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 1.0619068145751953  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3050, 128])
m.shape torch.Size([2765, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 1.071000099182129  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 1.071000099182129  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 2765, 128]), torch.Size([1, 2765, 128])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 1.073659896850586  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 1.223963737487793  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 2765, 128])
m.shape torch.Size([2558, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 1.234511375427246  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 1.234511375427246  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 2558, 128]), torch.Size([1, 2558, 128])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 1.2369508743286133  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 1.3933348655700684  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 2558, 128])
m.shape torch.Size([32224, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 1.5464119911193848  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 1.5464119911193848  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 32224, 128]), torch.Size([1, 32224, 128])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 1.5771431922912598  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.7590584754943848  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 32224, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.549178123474121  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.609078884124756  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.6689648628234863  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.608595848083496  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

torch.Size([62795, 256])
first layer input nodes number: 122818
first layer output nodes number: 62795
edges number: 465915
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.669882297515869  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.7297682762145996  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.7447400093078613  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.7447400093078613  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

m.shape torch.Size([1630, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.837294578552246  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.837294578552246  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1630, 256]), torch.Size([1, 1630, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.84088134765625  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.86751127243042  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1630, 256])
m.shape torch.Size([1499, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.8690881729125977  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.8690881729125977  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1499, 256]), torch.Size([1, 1499, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.872710704803467  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.9174914360046387  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1499, 256])
m.shape torch.Size([1163, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.9202537536621094  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.9202537536621094  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1163, 256]), torch.Size([1, 1163, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.9228787422180176  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.97481107711792  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1163, 256])
m.shape torch.Size([912, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.9778947830200195  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.9778947830200195  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 912, 256]), torch.Size([1, 912, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 3.9796342849731445  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.0383195877075195  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 912, 256])
m.shape torch.Size([767, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.041644096374512  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.041644096374512  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 767, 256]), torch.Size([1, 767, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.043107032775879  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.096142768859863  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 767, 256])
m.shape torch.Size([600, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.09887170791626  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.09887170791626  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 600, 256]), torch.Size([1, 600, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.100016117095947  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.14922571182251  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 600, 256])
m.shape torch.Size([543, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.152307033538818  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.152307033538818  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 543, 256]), torch.Size([1, 543, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.1533427238464355  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.206050395965576  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 543, 256])
m.shape torch.Size([406, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.208654403686523  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.208654403686523  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 406, 256]), torch.Size([1, 406, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.209428787231445  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.254941940307617  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 406, 256])
m.shape torch.Size([358, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.2576518058776855  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.2576518058776855  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.258334636688232  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.3025126457214355  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([316, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.305208683013916  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.305208683013916  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 316, 256]), torch.Size([1, 316, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.305811405181885  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.349564075469971  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 316, 256])
m.shape torch.Size([268, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.3520965576171875  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.3520965576171875  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.352607727050781  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.393088340759277  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([243, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.395635604858398  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.395635604858398  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.396099090576172  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.435495376586914  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([215, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.437950134277344  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.437950134277344  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.438360214233398  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.47608757019043  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([190, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.4784393310546875  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.4784393310546875  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.478801727294922  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.514678955078125  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([150, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.516660690307617  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.516660690307617  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.516946792602539  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.547273635864258  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([149, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.549422264099121  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.549422264099121  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.54970645904541  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.581820487976074  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([135, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.583884239196777  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.583884239196777  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.584141731262207  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.6150407791137695  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([128, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.61712646484375  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.61712646484375  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.61737060546875  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.64837646484375  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([106, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.650190353393555  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.650190353393555  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.650392532348633  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.677484512329102  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([117, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.679632663726807  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.679632663726807  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.679855823516846  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.7113213539123535  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([93, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.71308708190918  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.71308708190918  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.713264465332031  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.7395172119140625  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([63, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.74094295501709  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.74094295501709  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.741063117980957  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.759688377380371  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([77, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.761330604553223  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.761330604553223  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.761477470397949  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.785269737243652  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([56, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.786488056182861  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.786488056182861  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.786594867706299  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.804646015167236  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([1184, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.833042144775391  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.833042144775391  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1184, 256]), torch.Size([1, 1184, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.835971832275391  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 5.239624500274658  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1184, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 5.158426284790039  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 5.160120487213135  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 5.1618146896362305  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 5.160035610198975  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

torch.Size([11368, 40])
input nodes number: 62795
output nodes number: 11368
edges number: 93591
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 5.16058874130249  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 5.160589218139648  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.07741117477416992  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

pseudo mini batch 7 input nodes size: 122878
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.06592655181884766  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.06592655181884766  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.12451934814453125  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.1246042251586914  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.06592559814453125  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.07052326202392578  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.07052326202392578  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.07052326202392578  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

torch.Size([122878, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.07052326202392578  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

m.shape torch.Size([3166, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.30050134658813477  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.30050134658813477  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3166, 128]), torch.Size([1, 3166, 128])
----------------------------------------3
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.30352067947387695  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.3285789489746094  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3166, 128])
m.shape torch.Size([4012, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.33089542388916016  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.33089542388916016  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 4012, 128]), torch.Size([1, 4012, 128])
----------------------------------------3
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.33559417724609375  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.3939476013183594  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 4012, 128])
m.shape torch.Size([4011, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.39777231216430664  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.39777231216430664  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 4011, 128]), torch.Size([1, 4011, 128])
----------------------------------------3
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.4015979766845703  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.4880180358886719  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 4011, 128])
m.shape torch.Size([3903, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.49354982376098633  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.49354982376098633  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3903, 128]), torch.Size([1, 3903, 128])
----------------------------------------3
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.49732351303100586  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.6104207038879395  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3903, 128])
m.shape torch.Size([3659, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.6172833442687988  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.6172833442687988  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3659, 128]), torch.Size([1, 3659, 128])
----------------------------------------3
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.621741771697998  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.7480416297912598  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3659, 128])
m.shape torch.Size([3306, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.7557554244995117  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.7557554244995117  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3306, 128]), torch.Size([1, 3306, 128])
----------------------------------------3
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.759089469909668  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.9006433486938477  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3306, 128])
m.shape torch.Size([2984, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.9084129333496094  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.9084129333496094  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 2984, 128]), torch.Size([1, 2984, 128])
----------------------------------------3
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.9121131896972656  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 1.0544013977050781  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 2984, 128])
m.shape torch.Size([2799, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 1.0636558532714844  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 1.0636558532714844  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 2799, 128]), torch.Size([1, 2799, 128])
----------------------------------------3
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 1.066413402557373  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 1.2253327369689941  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 2799, 128])
m.shape torch.Size([2500, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 1.234726905822754  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 1.234726905822754  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 2500, 128]), torch.Size([1, 2500, 128])
----------------------------------------3
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 1.2373666763305664  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 1.3936982154846191  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 2500, 128])
m.shape torch.Size([32307, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 1.5463452339172363  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 1.5463452339172363  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 32307, 128]), torch.Size([1, 32307, 128])
----------------------------------------3
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 1.577155590057373  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 3.7901902198791504  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 32307, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 3.580503463745117  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 3.640474796295166  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 3.7002196311950684  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 3.6397814750671387  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

torch.Size([62647, 256])
first layer input nodes number: 122878
first layer output nodes number: 62647
edges number: 465816
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 3.701137065887451  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 3.7608819007873535  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 3.775818347930908  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 3.775818347930908  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

m.shape torch.Size([1705, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 3.866908550262451  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 3.866908550262451  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1705, 256]), torch.Size([1, 1705, 256])
----------------------------------------3
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 3.870514392852783  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 3.8977770805358887  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1705, 256])
m.shape torch.Size([1501, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 3.8982057571411133  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 3.8982057571411133  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1501, 256]), torch.Size([1, 1501, 256])
----------------------------------------3
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 3.901291847229004  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 3.9466018676757812  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1501, 256])
m.shape torch.Size([1205, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 3.9493236541748047  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 3.9493236541748047  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1205, 256]), torch.Size([1, 1205, 256])
----------------------------------------3
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 3.9519214630126953  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.0037336349487305  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1205, 256])
m.shape torch.Size([885, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.006058692932129  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.006058692932129  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 885, 256]), torch.Size([1, 885, 256])
----------------------------------------3
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.007746696472168  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.065699577331543  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 885, 256])
m.shape torch.Size([785, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.069011211395264  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.069011211395264  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 785, 256]), torch.Size([1, 785, 256])
----------------------------------------3
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.0705084800720215  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.124410152435303  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 785, 256])
m.shape torch.Size([598, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.127110481262207  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.127110481262207  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 598, 256]), torch.Size([1, 598, 256])
----------------------------------------3
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.128251075744629  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.177992343902588  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 598, 256])
m.shape torch.Size([478, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.180638313293457  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.180638313293457  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 478, 256]), torch.Size([1, 478, 256])
----------------------------------------3
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.181550025939941  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.227139949798584  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 478, 256])
m.shape torch.Size([425, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.229952335357666  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.229952335357666  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 425, 256]), torch.Size([1, 425, 256])
----------------------------------------3
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.230762958526611  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.277124881744385  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 425, 256])
m.shape torch.Size([360, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.279833793640137  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.279833793640137  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 360, 256]), torch.Size([1, 360, 256])
----------------------------------------3
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.280520439147949  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.325207710266113  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 360, 256])
m.shape torch.Size([325, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.327988147735596  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.327988147735596  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.32860803604126  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.373730182647705  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([240, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.37595796585083  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.37595796585083  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.376415729522705  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.412121295928955  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([243, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.415290355682373  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.415290355682373  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.4157538414001465  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.455150127410889  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([199, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.457405090332031  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.457405090332031  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.457784652709961  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.492704391479492  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([178, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.494909763336182  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.494909763336182  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.495249271392822  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.528860569000244  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([162, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.531026363372803  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.531026363372803  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.531335353851318  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.564088344573975  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([142, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.566117763519287  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.566117763519287  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.5663886070251465  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.596993923187256  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([119, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.5988030433654785  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.5988030433654785  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.599030017852783  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.626266956329346  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([131, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.628419876098633  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.628419876098633  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.628669738769531  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.660402297973633  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([104, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.662176609039307  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.662176609039307  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.662374973297119  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.688955783843994  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([91, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.690606117248535  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.690606117248535  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.690779685974121  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.715252876281738  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([96, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.717586517333984  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.717586517333984  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.717769622802734  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.744869232177734  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([65, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.746152400970459  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.746152400970459  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.746276378631592  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.765492916107178  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([58, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.7667131423950195  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.7667131423950195  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.766823768615723  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.784745216369629  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([70, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.786304950714111  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.786304950714111  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 4.786438465118408  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0369873046875 GB
    Memory Allocated: 4.80900239944458  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([1200, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.0369873046875 GB
    Memory Allocated: 4.838456153869629  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0369873046875 GB
    Memory Allocated: 4.838456153869629  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1200, 256]), torch.Size([1, 1200, 256])
----------------------------------------3
 Nvidia-smi: 7.0369873046875 GB
    Memory Allocated: 4.840744972229004  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0369873046875 GB
    Memory Allocated: 5.246772766113281  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1200, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0369873046875 GB
    Memory Allocated: 5.167942047119141  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0369873046875 GB
    Memory Allocated: 5.169635772705078  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0369873046875 GB
    Memory Allocated: 5.171329498291016  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.0369873046875 GB
    Memory Allocated: 5.169550895690918  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

torch.Size([11365, 40])
input nodes number: 62647
output nodes number: 11365
edges number: 92585
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0369873046875 GB
    Memory Allocated: 5.170102119445801  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.0369873046875 GB
    Memory Allocated: 5.170102596282959  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.0778188705444336  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.08336925506591797  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.08336925506591797  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0407998263835907 |0.044458746910095215 |0.2017880082130432 |0.00011184811592102051 |0.08132326602935791 |0.005690574645996094 |
----------------------------------------------------------pseudo_mini_loss sum 5.340305805206299
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1486406
Number of first layer input nodes during this epoch:  983383
Number of first layer output nodes during this epoch:  503023
----------------------------------------before generate dataloader block 
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.08336877822875977  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030955791473388672
number of batches is  8
batch size is  11368
random selection method spend 0.006259918212890625
time for parepare:  0.02154397964477539
local_output_nid generation:  0.004360198974609375
local_in_edges_tensor generation:  0.009875774383544922
mini_batch_src_global generation:  0.003077268600463867
r_  generation:  0.03451681137084961
local_output_nid generation:  0.005815029144287109
local_in_edges_tensor generation:  0.0033025741577148438
mini_batch_src_global generation:  0.003618478775024414
r_  generation:  0.03598451614379883
local_output_nid generation:  0.0059812068939208984
local_in_edges_tensor generation:  0.003154277801513672
mini_batch_src_global generation:  0.002518177032470703
r_  generation:  0.03595137596130371
local_output_nid generation:  0.005958080291748047
local_in_edges_tensor generation:  0.0031692981719970703
mini_batch_src_global generation:  0.0025680065155029297
r_  generation:  0.03682208061218262
local_output_nid generation:  0.006022214889526367
local_in_edges_tensor generation:  0.0033037662506103516
mini_batch_src_global generation:  0.002653360366821289
r_  generation:  0.03710174560546875
local_output_nid generation:  0.006005525588989258
local_in_edges_tensor generation:  0.0030791759490966797
mini_batch_src_global generation:  0.002948760986328125
r_  generation:  0.0377347469329834
local_output_nid generation:  0.0059735774993896484
local_in_edges_tensor generation:  0.003100156784057617
mini_batch_src_global generation:  0.0029718875885009766
r_  generation:  0.03709983825683594
local_output_nid generation:  0.0059812068939208984
local_in_edges_tensor generation:  0.0031325817108154297
mini_batch_src_global generation:  0.00292205810546875
r_  generation:  0.03818821907043457
----------------------check_connections_block total spend ----------------------------- 0.48735928535461426
generate_one_block  0.05207467079162598
generate_one_block  0.05097222328186035
generate_one_block  0.050683021545410156
generate_one_block  0.051943063735961914
generate_one_block  0.051557064056396484
generate_one_block  0.051299333572387695
generate_one_block  0.05108022689819336
generate_one_block  0.05245375633239746
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026855945587158203
gen group dst list time:  0.014467239379882812
time for parepare:  0.01944446563720703
local_output_nid generation:  0.015265464782714844
local_in_edges_tensor generation:  0.037919044494628906
mini_batch_src_global generation:  0.014667749404907227
r_  generation:  0.1713705062866211
local_output_nid generation:  0.017982959747314453
local_in_edges_tensor generation:  0.01528310775756836
mini_batch_src_global generation:  0.017867088317871094
r_  generation:  0.17045235633850098
local_output_nid generation:  0.017061233520507812
local_in_edges_tensor generation:  0.01329183578491211
mini_batch_src_global generation:  0.017243623733520508
r_  generation:  0.17797541618347168
local_output_nid generation:  0.017174720764160156
local_in_edges_tensor generation:  0.014238357543945312
mini_batch_src_global generation:  0.01858234405517578
r_  generation:  0.17984461784362793
local_output_nid generation:  0.01726841926574707
local_in_edges_tensor generation:  0.017841577529907227
mini_batch_src_global generation:  0.01939868927001953
r_  generation:  0.1821298599243164
local_output_nid generation:  0.01724863052368164
local_in_edges_tensor generation:  0.014944076538085938
mini_batch_src_global generation:  0.020062685012817383
r_  generation:  0.17903923988342285
local_output_nid generation:  0.017181873321533203
local_in_edges_tensor generation:  0.015146493911743164
mini_batch_src_global generation:  0.021272659301757812
r_  generation:  0.18240976333618164
local_output_nid generation:  0.017311573028564453
local_in_edges_tensor generation:  0.015369415283203125
mini_batch_src_global generation:  0.021538734436035156
r_  generation:  0.1864461898803711
----------------------check_connections_block total spend ----------------------------- 2.211381196975708
generate_one_block  0.23054218292236328
generate_one_block  0.21827340126037598
generate_one_block  0.22135663032531738
generate_one_block  0.22211408615112305
generate_one_block  0.22182726860046387
generate_one_block  0.22647523880004883
generate_one_block  0.24149799346923828
generate_one_block  0.22462964057922363
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.08336877822875977  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

connection checking time:  2.211381196975708
block generation total time  1.8067164421081543
average batch blocks generation time:  0.2258395552635193
block dataloader generation time/epoch 5.134071588516235
pseudo mini batch 0 input nodes size: 122789
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.07147455215454102  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.07147455215454102  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.13002490997314453  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.1301097869873047  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.07143211364746094  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.07607412338256836  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.07607412338256836  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.07607412338256836  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

torch.Size([122789, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.07607412338256836  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

m.shape torch.Size([3176, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.30606698989868164  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.30606698989868164  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3176, 128]), torch.Size([1, 3176, 128])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.30991029739379883  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.33414125442504883  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3176, 128])
m.shape torch.Size([3996, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.3364377021789551  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.3364377021789551  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3996, 128]), torch.Size([1, 3996, 128])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.3417019844055176  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.40004968643188477  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3996, 128])
m.shape torch.Size([4036, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.40424203872680664  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.40424203872680664  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 4036, 128]), torch.Size([1, 4036, 128])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.40809106826782227  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.4939141273498535  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 4036, 128])
m.shape torch.Size([3878, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.49968767166137695  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.49968767166137695  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3878, 128]), torch.Size([1, 3878, 128])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.5037083625793457  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.6167817115783691  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3878, 128])
m.shape torch.Size([3657, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.624178409576416  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.624178409576416  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3657, 128]), torch.Size([1, 3657, 128])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.6276659965515137  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.7539181709289551  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3657, 128])
m.shape torch.Size([3257, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.7614927291870117  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.7614927291870117  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3257, 128]), torch.Size([1, 3257, 128])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.7648420333862305  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.9057626724243164  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3257, 128])
m.shape torch.Size([3040, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.9150810241699219  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.9150810241699219  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3040, 128]), torch.Size([1, 3040, 128])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.9180450439453125  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 1.0684967041015625  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3040, 128])
m.shape torch.Size([2801, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 1.0770454406738281  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 1.0770454406738281  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 2801, 128]), torch.Size([1, 2801, 128])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 1.079979419708252  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 1.2387866973876953  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 2801, 128])
m.shape torch.Size([2544, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 1.248368740081787  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 1.248368740081787  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 2544, 128]), torch.Size([1, 2544, 128])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 1.2507948875427246  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 1.4070448875427246  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 2544, 128])
m.shape torch.Size([32348, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 1.5601286888122559  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 1.5601286888122559  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 32348, 128]), torch.Size([1, 32348, 128])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 1.5909781455993652  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.804521083831787  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 32348, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.5950560569763184  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.6548829078674316  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.714709758758545  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.6544151306152344  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

torch.Size([62733, 256])
first layer input nodes number: 122789
first layer output nodes number: 62733
edges number: 466679
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.7156267166137695  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.775453567504883  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.7904105186462402  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.7904105186462402  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

m.shape torch.Size([1673, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.881922721862793  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.881922721862793  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1673, 256]), torch.Size([1, 1673, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.8856773376464844  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.912766456604004  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1673, 256])
m.shape torch.Size([1459, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.913975715637207  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.913975715637207  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1459, 256]), torch.Size([1, 1459, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.9169397354125977  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.959099292755127  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1459, 256])
m.shape torch.Size([1177, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.961789608001709  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.961789608001709  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1177, 256]), torch.Size([1, 1177, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.964151382446289  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.015528678894043  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1177, 256])
m.shape torch.Size([887, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.018069267272949  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.018069267272949  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 887, 256]), torch.Size([1, 887, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.019761085510254  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.077498435974121  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 887, 256])
m.shape torch.Size([802, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.080789089202881  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.080789089202881  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 802, 256]), torch.Size([1, 802, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.0823187828063965  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.137387752532959  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 802, 256])
m.shape torch.Size([605, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.140111923217773  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.140111923217773  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 605, 256]), torch.Size([1, 605, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.141265869140625  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.191381454467773  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 605, 256])
m.shape torch.Size([498, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.194155216217041  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.194155216217041  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 498, 256]), torch.Size([1, 498, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.195105075836182  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.243454456329346  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 498, 256])
m.shape torch.Size([440, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.246362686157227  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.246362686157227  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 440, 256]), torch.Size([1, 440, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.247201919555664  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.295077323913574  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 440, 256])
m.shape torch.Size([353, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.297711372375488  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.297711372375488  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 353, 256]), torch.Size([1, 353, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.298384666442871  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.342521667480469  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 353, 256])
m.shape torch.Size([331, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.345366477966309  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.345366477966309  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 331, 256]), torch.Size([1, 331, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.3459978103637695  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.391797065734863  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 331, 256])
m.shape torch.Size([298, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.394632339477539  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.394632339477539  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.395200729370117  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.440906524658203  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 298, 256])
m.shape torch.Size([249, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.4434943199157715  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.4434943199157715  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.443969249725342  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.484338283538818  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([204, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.486649990081787  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.486649990081787  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.487039089202881  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.522836208343506  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([186, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.525144577026367  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.525144577026367  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.52549934387207  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.56062126159668  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([146, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.562549114227295  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.562549114227295  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.5628275871276855  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.592345714569092  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([131, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.594221115112305  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.594221115112305  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.594470977783203  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.622705459594727  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([119, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.62452507019043  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.62452507019043  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.624752044677734  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.651988983154297  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([131, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.654141902923584  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.654141902923584  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.654391765594482  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.686124324798584  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([117, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.688136100769043  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.688136100769043  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.688359260559082  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.718262672424316  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([103, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.7201313972473145  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.7201313972473145  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.720327854156494  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.74802827835083  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([98, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.749908447265625  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.749908447265625  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.750095367431641  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.777759552001953  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([73, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.779210090637207  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.779210090637207  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.779349327087402  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.800930976867676  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([74, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.802497386932373  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.802497386932373  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.802638530731201  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.825503826141357  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([63, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.8268866539001465  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.8268866539001465  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.827006816864014  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.847314357757568  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([1151, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.875613689422607  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.875613689422607  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1151, 256]), torch.Size([1, 1151, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.87824010848999  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 5.277887344360352  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1151, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 5.1981611251831055  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 5.199873924255371  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 5.201568126678467  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 5.199770450592041  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

torch.Size([11368, 40])
input nodes number: 62733
output nodes number: 11368
edges number: 92928
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 5.200323581695557  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 5.200324535369873  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.08338356018066406  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

pseudo mini batch 1 input nodes size: 122705
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.07143354415893555  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.07143354415893555  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.13002729415893555  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.1301121711730957  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.07147693634033203  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.07561397552490234  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.07561397552490234  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.07561397552490234  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

torch.Size([122705, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.07561397552490234  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

m.shape torch.Size([3136, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.3038163185119629  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.3038163185119629  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3136, 128]), torch.Size([1, 3136, 128])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.3068070411682129  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.331298828125  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3136, 128])
m.shape torch.Size([3925, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.33354663848876953  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.33354663848876953  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3925, 128]), torch.Size([1, 3925, 128])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.33845996856689453  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.3965644836425781  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3925, 128])
m.shape torch.Size([4010, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.40042924880981445  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.40042924880981445  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 4010, 128]), torch.Size([1, 4010, 128])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.40482473373413086  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.49100732803344727  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 4010, 128])
m.shape torch.Size([3931, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.49674367904663086  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.49674367904663086  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3931, 128]), torch.Size([1, 3931, 128])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.5008583068847656  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.6140952110290527  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3931, 128])
m.shape torch.Size([3715, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.6210780143737793  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.6210780143737793  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3715, 128]), torch.Size([1, 3715, 128])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.624824047088623  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.7524590492248535  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3715, 128])
m.shape torch.Size([3255, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.7600002288818359  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.7600002288818359  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3255, 128]), torch.Size([1, 3255, 128])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.7635884284973145  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.9046740531921387  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3255, 128])
m.shape torch.Size([3072, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.9124698638916016  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.9124698638916016  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3072, 128]), torch.Size([1, 3072, 128])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 0.9154300689697266  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 1.0658559799194336  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3072, 128])
m.shape torch.Size([2717, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 1.0742673873901367  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 1.0742673873901367  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 2717, 128]), torch.Size([1, 2717, 128])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 1.0770630836486816  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 1.2269372940063477  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 2717, 128])
m.shape torch.Size([2514, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 1.236332893371582  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 1.236332893371582  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 2514, 128]), torch.Size([1, 2514, 128])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 1.2389249801635742  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 1.3965563774108887  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 2514, 128])
m.shape torch.Size([32000, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 1.547945499420166  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 1.547945499420166  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 32000, 128]), torch.Size([1, 32000, 128])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 1.578463077545166  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.745211124420166  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 32000, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.536863327026367  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.5962533950805664  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.6556434631347656  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.5957889556884766  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

torch.Size([62275, 256])
first layer input nodes number: 122705
first layer output nodes number: 62275
edges number: 462711
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.656559944152832  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.7159500122070312  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.73079776763916  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.73079776763916  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

m.shape torch.Size([1682, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.821784019470215  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.821784019470215  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1682, 256]), torch.Size([1, 1682, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.8252644538879395  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.851787567138672  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1682, 256])
m.shape torch.Size([1433, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.8529534339904785  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.8529534339904785  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1433, 256]), torch.Size([1, 1433, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.8558831214904785  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.8974709510803223  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1433, 256])
m.shape torch.Size([1115, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.899221420288086  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.899221420288086  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1115, 256]), torch.Size([1, 1115, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.9014663696289062  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.9510855674743652  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1115, 256])
m.shape torch.Size([939, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.954303741455078  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.954303741455078  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 939, 256]), torch.Size([1, 939, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 3.956094741821289  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.0149383544921875  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 939, 256])
m.shape torch.Size([817, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.017969131469727  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.017969131469727  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 817, 256]), torch.Size([1, 817, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.019527435302734  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.076488494873047  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 817, 256])
m.shape torch.Size([597, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.0791521072387695  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.0791521072387695  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 597, 256]), torch.Size([1, 597, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.080290794372559  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.130298137664795  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 597, 256])
m.shape torch.Size([539, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.133355140686035  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.133355140686035  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 539, 256]), torch.Size([1, 539, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.134383201599121  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.185998916625977  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 539, 256])
m.shape torch.Size([448, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.188929557800293  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.188929557800293  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 448, 256]), torch.Size([1, 448, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.189784049987793  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.239260673522949  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 448, 256])
m.shape torch.Size([377, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.242094993591309  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.242094993591309  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 377, 256]), torch.Size([1, 377, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.242814064025879  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.289775371551514  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 377, 256])
m.shape torch.Size([359, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.2928667068481445  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.2928667068481445  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.293551445007324  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.343365669250488  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([256, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.345729827880859  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.345729827880859  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.346218109130859  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.384304046630859  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([236, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.386782169342041  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.386782169342041  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.387232303619385  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.4254937171936035  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([198, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.427742958068848  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.427742958068848  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.4281206130981445  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.462864875793457  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([185, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.465165615081787  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.465165615081787  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.465518474578857  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.500451564788818  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([165, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.502654075622559  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.502654075622559  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.502968788146973  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.536328315734863  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([150, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.538477897644043  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.538477897644043  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.538763999938965  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.571093559265137  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([133, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.573123931884766  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.573123931884766  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.57337760925293  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.603818893432617  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([122, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.6058125495910645  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.6058125495910645  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.606045246124268  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.6355977058410645  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([100, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.637307643890381  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.637307643890381  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.637498378753662  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.66305685043335  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([94, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.664768695831299  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.664768695831299  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.664947986602783  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.69022798538208  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([75, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.691652297973633  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.691652297973633  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.691795349121094  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.7129669189453125  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([68, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.714333534240723  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.714333534240723  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.714463233947754  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.734566688537598  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([58, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.735824108123779  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.735824108123779  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.735934734344482  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.753856182098389  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([71, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.755438804626465  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.755438804626465  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 7.0408935546875 GB
    Memory Allocated: 4.7555742263793945  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0467529296875 GB
    Memory Allocated: 4.778460502624512  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([1151, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.0467529296875 GB
    Memory Allocated: 4.806049346923828  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0467529296875 GB
    Memory Allocated: 4.806049346923828  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1151, 256]), torch.Size([1, 1151, 256])
----------------------------------------3
 Nvidia-smi: 7.0467529296875 GB
    Memory Allocated: 4.8090057373046875  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0467529296875 GB
    Memory Allocated: 5.210893630981445  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1151, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0467529296875 GB
    Memory Allocated: 5.1317291259765625  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0467529296875 GB
    Memory Allocated: 5.133423328399658  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0467529296875 GB
    Memory Allocated: 5.135117530822754  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.0467529296875 GB
    Memory Allocated: 5.133338451385498  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

torch.Size([11368, 40])
input nodes number: 62275
output nodes number: 11368
edges number: 92464
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0467529296875 GB
    Memory Allocated: 5.133887767791748  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.0467529296875 GB
    Memory Allocated: 5.133888244628906  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.08317041397094727  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

pseudo mini batch 2 input nodes size: 122912
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07147693634033203  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07147693634033203  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.13008594512939453  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.1301708221435547  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07149219512939453  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07632017135620117  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07632017135620117  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07632017135620117  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

torch.Size([122912, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07632017135620117  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

m.shape torch.Size([3140, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.30520105361938477  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.30520105361938477  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3140, 128]), torch.Size([1, 3140, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.3081955909729004  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.3321518898010254  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3140, 128])
m.shape torch.Size([4046, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.33451318740844727  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.33451318740844727  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 4046, 128]), torch.Size([1, 4046, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.34003114700317383  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.39867258071899414  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 4046, 128])
m.shape torch.Size([4093, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.40259838104248047  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.40259838104248047  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 4093, 128]), torch.Size([1, 4093, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.40650177001953125  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.4924335479736328  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 4093, 128])
m.shape torch.Size([3806, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.4977412223815918  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.4977412223815918  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3806, 128]), torch.Size([1, 3806, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.5015773773193359  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.6080927848815918  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3806, 128])
m.shape torch.Size([3682, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.6150565147399902  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.6150565147399902  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3682, 128]), torch.Size([1, 3682, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.618567943572998  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.7454161643981934  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3682, 128])
m.shape torch.Size([3357, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.7530465126037598  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.7530465126037598  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3357, 128]), torch.Size([1, 3357, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.7569947242736816  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.8983731269836426  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3357, 128])
m.shape torch.Size([2991, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.9067559242248535  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.9067559242248535  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 2991, 128]), torch.Size([1, 2991, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.9097733497619629  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.0531821250915527  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 2991, 128])
m.shape torch.Size([2749, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.0622425079345703  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.0622425079345703  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 2749, 128]), torch.Size([1, 2749, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.0650115013122559  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.2144455909729004  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 2749, 128])
m.shape torch.Size([2514, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.223923683166504  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.223923683166504  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 2514, 128]), torch.Size([1, 2514, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.2264556884765625  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.3833589553833008  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 2514, 128])
m.shape torch.Size([32075, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.5351057052612305  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.5351057052612305  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 32075, 128]), torch.Size([1, 32075, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.565694808959961  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.737521171569824  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 32075, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.5292654037475586  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.588825225830078  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.6483850479125977  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.588359832763672  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

torch.Size([62453, 256])
first layer input nodes number: 122912
first layer output nodes number: 62453
edges number: 463592
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.6493029594421387  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.708862781524658  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.723752975463867  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.723752975463867  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

m.shape torch.Size([1659, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.814380168914795  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.814380168914795  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1659, 256]), torch.Size([1, 1659, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.818118095397949  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.844874858856201  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1659, 256])
m.shape torch.Size([1459, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.846097469329834  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.846097469329834  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1459, 256]), torch.Size([1, 1459, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.848977565765381  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.891796588897705  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1459, 256])
m.shape torch.Size([1196, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.8946175575256348  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.8946175575256348  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1196, 256]), torch.Size([1, 1196, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.8969626426696777  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.9476423263549805  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1196, 256])
m.shape torch.Size([931, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.9507274627685547  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.9507274627685547  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 931, 256]), torch.Size([1, 931, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.952503204345703  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.0122222900390625  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 931, 256])
m.shape torch.Size([822, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.015602111816406  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.015602111816406  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 822, 256]), torch.Size([1, 822, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.017169952392578  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.074329376220703  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 822, 256])
m.shape torch.Size([654, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.077427864074707  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.077427864074707  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 654, 256]), torch.Size([1, 654, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.078675270080566  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.1330037117004395  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 654, 256])
m.shape torch.Size([490, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.135676860809326  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.135676860809326  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 490, 256]), torch.Size([1, 490, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.136611461639404  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.184632778167725  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 490, 256])
m.shape torch.Size([389, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.187156677246094  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.187156677246094  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 389, 256]), torch.Size([1, 389, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.187898635864258  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.230998992919922  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 389, 256])
m.shape torch.Size([372, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.233846187591553  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.233846187591553  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 372, 256]), torch.Size([1, 372, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.234555721282959  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.280458927154541  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 372, 256])
m.shape torch.Size([320, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.283179759979248  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.283179759979248  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 320, 256]), torch.Size([1, 320, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.283790111541748  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.330106735229492  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 320, 256])
m.shape torch.Size([278, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.332740783691406  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.332740783691406  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.333271026611328  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.3765339851379395  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([240, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.379914283752441  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.379914283752441  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.380372047424316  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.419281959533691  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([187, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.421389579772949  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.421389579772949  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.421746253967285  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.454560279846191  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([186, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.456884860992432  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.456884860992432  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.457239627838135  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.492361545562744  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([166, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.494577407836914  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.494577407836914  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.494894027709961  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.52845573425293  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([139, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.530435085296631  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.530435085296631  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.530700206756592  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.560658931732178  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([126, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.562585353851318  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.562585353851318  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.562825679779053  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.591664791107178  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([110, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.593447685241699  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.593447685241699  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.593657493591309  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.620303153991699  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([115, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.622298717498779  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.622298717498779  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.622518062591553  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.651910305023193  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([92, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.653569221496582  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.653569221496582  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.653744697570801  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.6784868240356445  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([94, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.680878162384033  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.680878162384033  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.681057453155518  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.707592487335205  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([67, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.708920001983643  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.708920001983643  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.709047794342041  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.728855609893799  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([65, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.730228900909424  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.730228900909424  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.730352878570557  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.750437259674072  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([69, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.751966953277588  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.751966953277588  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.752098560333252  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.7743401527404785  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([1142, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.801714897155762  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.801714897155762  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1142, 256]), torch.Size([1, 1142, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.8043904304504395  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 5.189684867858887  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1142, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 5.110960483551025  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 5.112654685974121  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 5.114348888397217  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 5.112569808959961  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

torch.Size([11368, 40])
input nodes number: 62453
output nodes number: 11368
edges number: 91996
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 5.113120079040527  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 5.1131205558776855  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.08402204513549805  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

pseudo mini batch 3 input nodes size: 123248
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07149219512939453  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07149219512939453  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.13026142120361328  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.13034629821777344  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07165241241455078  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07607841491699219  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07607841491699219  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07607841491699219  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

torch.Size([123248, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07607841491699219  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

m.shape torch.Size([3215, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.3082890510559082  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.3082890510559082  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3215, 128]), torch.Size([1, 3215, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.3113551139831543  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.336946964263916  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3215, 128])
m.shape torch.Size([4054, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.3392801284790039  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.3392801284790039  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 4054, 128]), torch.Size([1, 4054, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.34314632415771484  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.4017801284790039  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 4054, 128])
m.shape torch.Size([4108, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.40564632415771484  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.40564632415771484  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 4108, 128]), torch.Size([1, 4108, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.4095640182495117  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.49575328826904297  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 4108, 128])
m.shape torch.Size([3884, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.5015840530395508  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.5015840530395508  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3884, 128]), torch.Size([1, 3884, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.5054101943969727  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.617950439453125  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3884, 128])
m.shape torch.Size([3645, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.624788761138916  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.624788761138916  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3645, 128]), torch.Size([1, 3645, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.6283788681030273  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.7547125816345215  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3645, 128])
m.shape torch.Size([3279, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.7623558044433594  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.7623558044433594  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3279, 128]), torch.Size([1, 3279, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.7657966613769531  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.9055895805358887  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3279, 128])
m.shape torch.Size([2958, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.9141759872436523  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.9141759872436523  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 2958, 128]), torch.Size([1, 2958, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.9172320365905762  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.0591692924499512  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 2958, 128])
m.shape torch.Size([2831, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.0685582160949707  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.0685582160949707  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 2831, 128]), torch.Size([1, 2831, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.0713186264038086  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.2302684783935547  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 2831, 128])
m.shape torch.Size([2554, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.2392468452453613  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.2392468452453613  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 2554, 128]), torch.Size([1, 2554, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.2418274879455566  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.3989167213439941  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 2554, 128])
m.shape torch.Size([32684, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.5539488792419434  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.5539488792419434  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 32684, 128]), torch.Size([1, 32684, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.5851187705993652  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.8028273582458496  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 32684, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.5907793045043945  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.6510629653930664  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.7113466262817383  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.6505918502807617  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

torch.Size([63212, 256])
first layer input nodes number: 123248
first layer output nodes number: 63212
edges number: 470262
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.7122669219970703  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.772550582885742  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.78762149810791  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.78762149810791  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

m.shape torch.Size([1714, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.8804659843444824  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.8804659843444824  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1714, 256]), torch.Size([1, 1714, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.8843579292297363  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.9117045402526855  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1714, 256])
m.shape torch.Size([1506, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.9129652976989746  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.9129652976989746  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1506, 256]), torch.Size([1, 1506, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.9160518646240234  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.961270809173584  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1506, 256])
m.shape torch.Size([1169, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.9638071060180664  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.9638071060180664  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1169, 256]), torch.Size([1, 1169, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.9661970138549805  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.01668119430542  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1169, 256])
m.shape torch.Size([910, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.018596649169922  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.018596649169922  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 910, 256]), torch.Size([1, 910, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.020332336425781  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.076366424560547  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 910, 256])
m.shape torch.Size([691, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.079470634460449  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.079470634460449  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 691, 256]), torch.Size([1, 691, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.080788612365723  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.129117012023926  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 691, 256])
m.shape torch.Size([612, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.131987571716309  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.131987571716309  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 612, 256]), torch.Size([1, 612, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.13315486907959  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.184378623962402  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 612, 256])
m.shape torch.Size([497, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.18713903427124  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.18713903427124  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 497, 256]), torch.Size([1, 497, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.188086986541748  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.236805438995361  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 497, 256])
m.shape torch.Size([440, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.239714622497559  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.239714622497559  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 440, 256]), torch.Size([1, 440, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.240553855895996  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.2891950607299805  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 440, 256])
m.shape torch.Size([355, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.29184627532959  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.29184627532959  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 355, 256]), torch.Size([1, 355, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.292523384094238  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.337475776672363  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 355, 256])
m.shape torch.Size([314, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.340155601501465  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.340155601501465  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.340754508972168  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.3843793869018555  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 314, 256])
m.shape torch.Size([286, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.387104034423828  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.387104034423828  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.3876495361328125  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.430837631225586  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([226, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.43317174911499  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.43317174911499  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.433602809906006  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.470242977142334  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([206, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.472601413726807  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.472601413726807  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.472994327545166  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.5091423988342285  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([178, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.511341094970703  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.511341094970703  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.511680603027344  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.545291900634766  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([143, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.547183990478516  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.547183990478516  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.547456741333008  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.57636833190918  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([171, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.578861713409424  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.578861713409424  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.579187870025635  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.616043567657471  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([130, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.61800479888916  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.61800479888916  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.618252754211426  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.648007392883301  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([117, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.64990758895874  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.64990758895874  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.650130748748779  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.67847204208374  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([76, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.67974853515625  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.67974853515625  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.679893493652344  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.699317932128906  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([105, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.701263904571533  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.701263904571533  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.7014641761779785  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.729702472686768  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([105, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.731721878051758  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.731721878051758  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.731922149658203  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.761562347412109  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([68, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.763339996337891  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.763339996337891  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.763469696044922  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.783573150634766  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([78, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.785233020782471  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.785233020782471  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.78538179397583  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.809483051300049  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([63, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.810862064361572  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.810862064361572  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.8109822273254395  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.831289768218994  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([1208, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.860751628875732  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.860751628875732  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1208, 256]), torch.Size([1, 1208, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.86305570602417  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 5.27189302444458  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1208, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 5.19083309173584  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 5.193144798278809  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 5.194839000701904  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 5.192442417144775  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

torch.Size([11368, 40])
input nodes number: 63212
output nodes number: 11368
edges number: 93310
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 5.19299840927124  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 5.192998886108398  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.08400392532348633  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

pseudo mini batch 4 input nodes size: 123069
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07165241241455078  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07165241241455078  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.13033628463745117  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.13042116165161133  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07156705856323242  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07607555389404297  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07607555389404297  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07607555389404297  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

torch.Size([123069, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07607555389404297  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

m.shape torch.Size([3204, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.3060874938964844  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.3060874938964844  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3204, 128]), torch.Size([1, 3204, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.30914306640625  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.33443450927734375  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3204, 128])
m.shape torch.Size([3971, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.33669376373291016  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.33669376373291016  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3971, 128]), torch.Size([1, 3971, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.3411393165588379  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.39985227584838867  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3971, 128])
m.shape torch.Size([4017, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.4032282829284668  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.4032282829284668  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 4017, 128]), torch.Size([1, 4017, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.4075140953063965  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.4936680793762207  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 4017, 128])
m.shape torch.Size([3892, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.49941444396972656  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.49941444396972656  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3892, 128]), torch.Size([1, 3892, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.5031609535217285  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.6159496307373047  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3892, 128])
m.shape torch.Size([3658, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.6228151321411133  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.6228151321411133  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3658, 128]), torch.Size([1, 3658, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.6273050308227539  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.7535810470581055  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3658, 128])
m.shape torch.Size([3300, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.7612781524658203  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.7612781524658203  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3300, 128]), torch.Size([1, 3300, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.7646198272705078  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.9061832427978516  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3300, 128])
m.shape torch.Size([3086, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.9142618179321289  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.9142618179321289  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3086, 128]), torch.Size([1, 3086, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.9180116653442383  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.0693302154541016  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3086, 128])
m.shape torch.Size([2829, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.0786504745483398  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.0786504745483398  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 2829, 128]), torch.Size([1, 2829, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.0814709663391113  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.2404189109802246  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 2829, 128])
m.shape torch.Size([2587, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.2501721382141113  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.2501721382141113  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 2587, 128]), torch.Size([1, 2587, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.252802848815918  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.410700798034668  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 2587, 128])
m.shape torch.Size([32252, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.5637640953063965  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.5637640953063965  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 32252, 128]), torch.Size([1, 32252, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.5945219993591309  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.7783331871032715  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 32252, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.568661689758301  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.6285486221313477  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.6884355545043945  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.628080368041992  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

torch.Size([62796, 256])
first layer input nodes number: 123069
first layer output nodes number: 62796
edges number: 466892
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.689354419708252  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.749241352081299  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.7642130851745605  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.7642130851745605  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

m.shape torch.Size([1661, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.8556718826293945  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.8556718826293945  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1661, 256]), torch.Size([1, 1661, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.859400749206543  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.885544776916504  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1661, 256])
m.shape torch.Size([1445, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.887477397918701  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.887477397918701  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1445, 256]), torch.Size([1, 1445, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.8905344009399414  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.933164596557617  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1445, 256])
m.shape torch.Size([1157, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.9357266426086426  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.9357266426086426  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1157, 256]), torch.Size([1, 1157, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.938352584838867  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.990488052368164  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1157, 256])
m.shape torch.Size([902, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.9935641288757324  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.9935641288757324  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 902, 256]), torch.Size([1, 902, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.9952845573425293  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.053714275360107  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 902, 256])
m.shape torch.Size([807, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.057036876678467  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.057036876678467  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 807, 256]), torch.Size([1, 807, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.0585761070251465  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.113988399505615  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 807, 256])
m.shape torch.Size([582, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.116575241088867  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.116575241088867  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 582, 256]), torch.Size([1, 582, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.117685317993164  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.16541862487793  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 582, 256])
m.shape torch.Size([527, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.16840934753418  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.16840934753418  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 527, 256]), torch.Size([1, 527, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.169414520263672  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.220576286315918  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 527, 256])
m.shape torch.Size([458, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.22359561920166  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.22359561920166  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 458, 256]), torch.Size([1, 458, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.224469184875488  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.27510929107666  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 458, 256])
m.shape torch.Size([374, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.277907848358154  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.277907848358154  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 374, 256]), torch.Size([1, 374, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.278621196746826  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.324340343475342  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 374, 256])
m.shape torch.Size([330, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.327155590057373  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.327155590057373  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 330, 256]), torch.Size([1, 330, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.327785015106201  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.374051570892334  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 330, 256])
m.shape torch.Size([285, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.3767499923706055  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.3767499923706055  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.377293586730957  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.420172691345215  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([242, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.42269229888916  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.42269229888916  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.423153877258301  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.462388038635254  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([234, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.465081214904785  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.465081214904785  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.465527534484863  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.506588935852051  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([172, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.50868034362793  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.50868034362793  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.509008407592773  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.541486740112305  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([163, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.543673038482666  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.543673038482666  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.5439839363098145  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.576939105987549  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([133, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.579509258270264  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.579509258270264  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.579762935638428  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.608428478240967  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([130, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.61042594909668  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.61042594909668  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.610673904418945  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.64042854309082  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([120, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.642380714416504  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.642380714416504  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.642609596252441  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.671677589416504  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([105, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.673480987548828  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.673480987548828  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.673681259155273  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.700517654418945  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([108, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.702493667602539  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.702493667602539  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.702699661254883  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.731744766235352  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([80, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.733256816864014  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.733256816864014  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.733409404754639  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.755992412567139  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([74, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.757481098175049  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.757481098175049  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.757622241973877  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.779499530792236  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([60, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.780755519866943  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.780755519866943  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.780869960784912  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.79940938949585  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([57, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.8006672859191895  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.8006672859191895  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.80077600479126  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.819149494171143  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([1162, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.847961902618408  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.847961902618408  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1162, 256]), torch.Size([1, 1162, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.850178241729736  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 5.249711513519287  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1162, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 5.1704888343811035  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 5.172231197357178  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 5.173925399780273  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 5.172098159790039  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

torch.Size([11368, 40])
input nodes number: 62796
output nodes number: 11368
edges number: 92869
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 5.172651290893555  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 5.172651767730713  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.0833883285522461  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

pseudo mini batch 5 input nodes size: 123013
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07156705856323242  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07156705856323242  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.13022422790527344  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.1303091049194336  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07154035568237305  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07607841491699219  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07607841491699219  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07607841491699219  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

torch.Size([123013, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07607841491699219  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

m.shape torch.Size([3177, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.30651044845581055  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.30651044845581055  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3177, 128]), torch.Size([1, 3177, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.3095402717590332  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.33377885818481445  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3177, 128])
m.shape torch.Size([4035, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.33611202239990234  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.33611202239990234  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 4035, 128]), torch.Size([1, 4035, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.3414287567138672  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.40008068084716797  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 4035, 128])
m.shape torch.Size([4114, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.40404176712036133  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.40404176712036133  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 4114, 128]), torch.Size([1, 4114, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.40796518325805664  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.4942803382873535  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 4114, 128])
m.shape torch.Size([3960, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.5000967979431152  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.5000967979431152  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3960, 128]), torch.Size([1, 3960, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.503882884979248  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.6165347099304199  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3960, 128])
m.shape torch.Size([3713, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.6234989166259766  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.6234989166259766  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3713, 128]), torch.Size([1, 3713, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.6272358894348145  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.7548232078552246  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3713, 128])
m.shape torch.Size([3320, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.7624955177307129  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.7624955177307129  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3320, 128]), torch.Size([1, 3320, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.7661480903625488  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.907588005065918  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3320, 128])
m.shape torch.Size([3071, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.9162554740905762  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.9162554740905762  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3071, 128]), torch.Size([1, 3071, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.9193534851074219  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.0697460174560547  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3071, 128])
m.shape torch.Size([2815, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.0799965858459473  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.0799965858459473  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 2815, 128]), torch.Size([1, 2815, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.082918643951416  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.2420907020568848  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 2815, 128])
m.shape torch.Size([2562, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.2517433166503906  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.2517433166503906  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 2562, 128]), torch.Size([1, 2562, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.2543110847473145  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.4106841087341309  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 2562, 128])
m.shape torch.Size([32236, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.5637593269348145  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.5637593269348145  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 32236, 128]), torch.Size([1, 32236, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.5945019721984863  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.7772297859191895  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 32236, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.5663652420043945  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.6264495849609375  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.6865339279174805  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.6259799003601074  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

torch.Size([63003, 256])
first layer input nodes number: 123013
first layer output nodes number: 63003
edges number: 467349
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.687452793121338  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.747537136077881  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.7625584602355957  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.7625584602355957  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

m.shape torch.Size([1651, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.8553194999694824  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.8553194999694824  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1651, 256]), torch.Size([1, 1651, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.8591694831848145  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.885924816131592  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1651, 256])
m.shape torch.Size([1450, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.8865556716918945  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.8865556716918945  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1450, 256]), torch.Size([1, 1450, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.8894143104553223  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.933403491973877  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1450, 256])
m.shape torch.Size([1143, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.936206340789795  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.936206340789795  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1143, 256]), torch.Size([1, 1143, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.9385271072387695  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.989138126373291  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1143, 256])
m.shape torch.Size([935, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.9922361373901367  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.9922361373901367  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 935, 256]), torch.Size([1, 935, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.9940195083618164  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.052855491638184  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 935, 256])
m.shape torch.Size([740, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.056151390075684  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.056151390075684  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 740, 256]), torch.Size([1, 740, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.057562828063965  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.10837459564209  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 740, 256])
m.shape torch.Size([610, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.111186981201172  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.111186981201172  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 610, 256]), torch.Size([1, 610, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.1123504638671875  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.164306640625  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 610, 256])
m.shape torch.Size([511, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.167162895202637  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.167162895202637  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 511, 256]), torch.Size([1, 511, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.168137550354004  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.2175750732421875  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 511, 256])
m.shape torch.Size([456, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.2205939292907715  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.2205939292907715  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 456, 256]), torch.Size([1, 456, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.221463680267334  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.271543979644775  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 456, 256])
m.shape torch.Size([413, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.27468204498291  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.27468204498291  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 413, 256]), torch.Size([1, 413, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.275469779968262  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.327474594116211  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 413, 256])
m.shape torch.Size([329, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.330243110656738  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.330243110656738  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 329, 256]), torch.Size([1, 329, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.330870628356934  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.376940727233887  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 329, 256])
m.shape torch.Size([278, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.379566192626953  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.379566192626953  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.380096435546875  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.422780990600586  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([255, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.425457000732422  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.425457000732422  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.425943374633789  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.46728515625  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([210, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.469666004180908  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.469666004180908  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.470066547393799  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.506916522979736  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([182, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.509165287017822  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.509165287017822  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.509512424468994  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.54387903213501  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([163, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.546055793762207  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.546055793762207  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.5463666915893555  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.57932186126709  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([133, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.581212043762207  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.581212043762207  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.581465721130371  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.61013126373291  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([130, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.612128734588623  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.612128734588623  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.612376689910889  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.642131328582764  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([126, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.6441874504089355  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.6441874504089355  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.64442777633667  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.6749491691589355  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([103, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.67671012878418  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.67671012878418  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.676906585693359  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.7032318115234375  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([100, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.705056190490723  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.705056190490723  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.705246925354004  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.73214054107666  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([82, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.733700275421143  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.733700275421143  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.733856678009033  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.757004261016846  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([55, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.758218765258789  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.758218765258789  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.758323669433594  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.77458381652832  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([61, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.775879859924316  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.775879859924316  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.775996208190918  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.794844627380371  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([60, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.796513080596924  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.796513080596924  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.796627521514893  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.815968036651611  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([1192, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.844684600830078  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.844684600830078  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1192, 256]), torch.Size([1, 1192, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.846958160400391  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 5.252350330352783  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1192, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 5.171812534332275  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 5.173506736755371  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 5.175200939178467  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 5.173421859741211  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

torch.Size([11368, 40])
input nodes number: 63003
output nodes number: 11368
edges number: 93291
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 5.173976421356201  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 5.173976898193359  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.08363580703735352  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

pseudo mini batch 6 input nodes size: 122853
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07154035568237305  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07154035568237305  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.13013410568237305  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.1302189826965332  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07147693634033203  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07566547393798828  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07566547393798828  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07566547393798828  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

torch.Size([122853, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07566547393798828  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

m.shape torch.Size([3185, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.3064393997192383  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.3064393997192383  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3185, 128]), torch.Size([1, 3185, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.3094768524169922  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.3341832160949707  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3185, 128])
m.shape torch.Size([3973, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.3364534378051758  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.3364534378051758  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3973, 128]), torch.Size([1, 3973, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.3410162925720215  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.3992581367492676  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3973, 128])
m.shape torch.Size([4090, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.4032144546508789  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.4032144546508789  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 4090, 128]), torch.Size([1, 4090, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.4074726104736328  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.4935331344604492  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 4090, 128])
m.shape torch.Size([3820, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.49938392639160156  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.49938392639160156  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3820, 128]), torch.Size([1, 3820, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.5032515525817871  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.609285831451416  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3820, 128])
m.shape torch.Size([3637, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.6161355972290039  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.6161355972290039  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3637, 128]), torch.Size([1, 3637, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.6196913719177246  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.7450957298278809  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3637, 128])
m.shape torch.Size([3223, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.7521281242370605  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.7521281242370605  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3223, 128]), torch.Size([1, 3223, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.7565054893493652  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.888674259185791  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3223, 128])
m.shape torch.Size([3016, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.8972043991088867  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.8972043991088867  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3016, 128]), torch.Size([1, 3016, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.9001612663269043  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.0506587028503418  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3016, 128])
m.shape torch.Size([2807, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.0599284172058105  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.0599284172058105  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 2807, 128]), torch.Size([1, 2807, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.0627169609069824  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.2217435836791992  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 2807, 128])
m.shape torch.Size([2450, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.2301268577575684  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.2301268577575684  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 2450, 128]), torch.Size([1, 2450, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.233445644378662  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.3901710510253906  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 2450, 128])
m.shape torch.Size([32671, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.545252799987793  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.545252799987793  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 32671, 128]), torch.Size([1, 32671, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.5764102935791016  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.794142723083496  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 32671, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.5831165313720703  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.643075942993164  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.703035354614258  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.6426072120666504  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

torch.Size([62872, 256])
first layer input nodes number: 122853
first layer output nodes number: 62872
edges number: 468532
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.7039527893066406  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.7639122009277344  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.778902053833008  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.778902053833008  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

m.shape torch.Size([1701, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.8717150688171387  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.8717150688171387  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1701, 256]), torch.Size([1, 1701, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.8755598068237305  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.902359962463379  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1701, 256])
m.shape torch.Size([1472, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.9040040969848633  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.9040040969848633  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1472, 256]), torch.Size([1, 1472, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.907059669494629  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.9501004219055176  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1472, 256])
m.shape torch.Size([1147, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.9526748657226562  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.9526748657226562  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1147, 256]), torch.Size([1, 1147, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 3.954914093017578  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.00589656829834  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1147, 256])
m.shape torch.Size([919, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.008421897888184  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.008421897888184  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 919, 256]), torch.Size([1, 919, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.010174751281738  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.06636905670166  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 919, 256])
m.shape torch.Size([763, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.069473743438721  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.069473743438721  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 763, 256]), torch.Size([1, 763, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.070929050445557  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.123922824859619  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 763, 256])
m.shape torch.Size([596, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.126632213592529  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.126632213592529  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 596, 256]), torch.Size([1, 596, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.1277689933776855  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.176856517791748  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 596, 256])
m.shape torch.Size([492, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.179598331451416  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.179598331451416  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 492, 256]), torch.Size([1, 492, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.18053674697876  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.228453159332275  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 492, 256])
m.shape torch.Size([440, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.231367111206055  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.231367111206055  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 440, 256]), torch.Size([1, 440, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.232206344604492  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.280118942260742  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 440, 256])
m.shape torch.Size([377, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.282960891723633  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.282960891723633  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 377, 256]), torch.Size([1, 377, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.283679962158203  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.330569267272949  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 377, 256])
m.shape torch.Size([309, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.333179950714111  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.333179950714111  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.33376932144165  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.375871181488037  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 309, 256])
m.shape torch.Size([274, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.37847375869751  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.37847375869751  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.3789963722229  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.420388698577881  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([239, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.422883987426758  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.422883987426758  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.42333984375  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.462087631225586  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([216, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.4645586013793945  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.4645586013793945  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.464970588684082  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.502873420715332  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([159, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.504806995391846  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.504806995391846  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.505110263824463  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.5351338386535645  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([185, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.537649631500244  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.537649631500244  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.5380024909973145  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.575405597686768  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([122, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.577105522155762  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.577105522155762  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.577338218688965  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.603632926940918  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([130, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.605640888214111  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.605640888214111  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.605888843536377  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.635643482208252  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([110, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.637422561645508  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.637422561645508  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.637632369995117  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.664278030395508  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([110, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.666182041168213  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.666182041168213  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.666391849517822  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.6945061683654785  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([89, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.696177005767822  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.696177005767822  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.696346759796143  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.720282077789307  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([90, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.7220139503479  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.7220139503479  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.7221856117248535  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.747591495513916  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([78, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.749155044555664  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.749155044555664  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.749303817749023  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.772363662719727  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([63, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.77379846572876  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.77379846572876  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.773918628692627  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.793385028839111  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([71, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.7949628829956055  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.7949628829956055  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.795098304748535  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.817984580993652  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([1216, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.847440242767334  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.847440242767334  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1216, 256]), torch.Size([1, 1216, 256])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 4.849759578704834  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 5.272657871246338  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1216, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 5.192270278930664  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 5.194767951965332  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 5.196462154388428  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 5.1938796043396  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

torch.Size([11368, 40])
input nodes number: 62872
output nodes number: 11368
edges number: 93462
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 5.194433212280273  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 5.194433689117432  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.08300065994262695  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

pseudo mini batch 7 input nodes size: 123449
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07147693634033203  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07147693634033203  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.1303420066833496  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.13042688369750977  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07174825668334961  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07608318328857422  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07608318328857422  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07608318328857422  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

torch.Size([123449, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.07608318328857422  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

m.shape torch.Size([3248, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.3109779357910156  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.3109779357910156  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3248, 128]), torch.Size([1, 3248, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.3140754699707031  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.3406105041503906  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3248, 128])
m.shape torch.Size([4028, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.3421592712402344  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.3421592712402344  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 4028, 128]), torch.Size([1, 4028, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.34600067138671875  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.4045982360839844  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 4028, 128])
m.shape torch.Size([4011, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.40843963623046875  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.40843963623046875  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 4011, 128]), torch.Size([1, 4011, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.4125404357910156  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.49831581115722656  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 4011, 128])
m.shape torch.Size([3860, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.5040535926818848  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.5040535926818848  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3860, 128]), torch.Size([1, 3860, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.5081310272216797  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.6211872100830078  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3860, 128])
m.shape torch.Size([3724, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.6285495758056641  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.6285495758056641  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3724, 128]), torch.Size([1, 3724, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.6330661773681641  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.7609195709228516  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3724, 128])
m.shape torch.Size([3336, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.7686882019042969  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.7686882019042969  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 3336, 128]), torch.Size([1, 3336, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.7722358703613281  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.9135398864746094  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 3336, 128])
m.shape torch.Size([2999, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.921959400177002  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.921959400177002  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 2999, 128]), torch.Size([1, 2999, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 0.9249801635742188  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.0762739181518555  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 2999, 128])
m.shape torch.Size([2750, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.0862841606140137  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.0862841606140137  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 2750, 128]), torch.Size([1, 2750, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.0891222953796387  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.2390384674072266  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 2750, 128])
m.shape torch.Size([2542, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.248636245727539  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.248636245727539  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 2542, 128]), torch.Size([1, 2542, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.25115966796875  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.4079656600952148  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 2542, 128])
m.shape torch.Size([33015, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.5641813278198242  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.5641813278198242  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 33015, 128]), torch.Size([1, 33015, 128])
----------------------------------------3
 Nvidia-smi: 7.0506591796875 GB
    Memory Allocated: 1.5956668853759766  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 3.831141471862793  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 33015, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 3.6179542541503906  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 3.678524971008301  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 3.739095687866211  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 3.678051471710205  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

torch.Size([63513, 256])
first layer input nodes number: 123449
first layer output nodes number: 63513
edges number: 473434
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 3.7400174140930176  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 3.8005881309509277  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 3.8157310485839844  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 3.8157310485839844  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

m.shape torch.Size([1687, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 3.908240795135498  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 3.908240795135498  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1687, 256]), torch.Size([1, 1687, 256])
----------------------------------------3
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 3.911993980407715  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 3.9395618438720703  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1687, 256])
m.shape torch.Size([1482, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 3.940831184387207  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 3.940831184387207  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1482, 256]), torch.Size([1, 1482, 256])
----------------------------------------3
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 3.9437432289123535  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 3.986555576324463  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1482, 256])
m.shape torch.Size([1173, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 3.9888882637023926  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 3.9888882637023926  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1173, 256]), torch.Size([1, 1173, 256])
----------------------------------------3
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 3.991234302520752  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.042126178741455  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 1173, 256])
m.shape torch.Size([897, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.044459819793701  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.044459819793701  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 897, 256]), torch.Size([1, 897, 256])
----------------------------------------3
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.046170711517334  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.100186824798584  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 897, 256])
m.shape torch.Size([780, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.103148937225342  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.103148937225342  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 780, 256]), torch.Size([1, 780, 256])
----------------------------------------3
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.1046366691589355  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.164065361022949  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 780, 256])
m.shape torch.Size([612, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.166851043701172  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.166851043701172  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 612, 256]), torch.Size([1, 612, 256])
----------------------------------------3
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.168018341064453  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.219788551330566  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 612, 256])
m.shape torch.Size([491, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.222508430480957  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.222508430480957  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 491, 256]), torch.Size([1, 491, 256])
----------------------------------------3
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.223444938659668  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.271183967590332  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 491, 256])
m.shape torch.Size([401, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.273799419403076  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.273799419403076  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 401, 256]), torch.Size([1, 401, 256])
----------------------------------------3
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.274564266204834  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.319091320037842  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 401, 256])
m.shape torch.Size([355, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.321779727935791  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.321779727935791  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 355, 256]), torch.Size([1, 355, 256])
----------------------------------------3
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.3224568367004395  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.367908000946045  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 355, 256])
m.shape torch.Size([307, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.370520114898682  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.370520114898682  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.371105670928955  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.414321422576904  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 307, 256])
m.shape torch.Size([248, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.416650772094727  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.416650772094727  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.417123794555664  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.454019546508789  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([250, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.456666469573975  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.456666469573975  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.457143306732178  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.497674465179443  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([201, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.499947547912598  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.499947547912598  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.500330924987793  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.535601615905762  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([186, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.537912845611572  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.537912845611572  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.538267612457275  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.573389530181885  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([158, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.575587749481201  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.575587749481201  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.5758891105651855  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.607833385467529  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([132, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.609712600708008  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.609712600708008  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.609964370727539  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.63841438293457  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([132, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.640445709228516  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.640445709228516  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.640697479248047  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.670909881591797  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([112, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.672721862792969  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.672721862792969  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.672935485839844  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.700065612792969  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([110, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.701967716217041  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.701967716217041  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.70217752456665  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.730291843414307  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([116, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.732417106628418  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.732417106628418  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.732638359069824  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.7638349533081055  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([93, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.765601634979248  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.765601634979248  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.7657790184021  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.792031764984131  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([73, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.794366359710693  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.794366359710693  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.794505596160889  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.816087245941162  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([60, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.8173441886901855  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.8173441886901855  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.817458629608154  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.835998058319092  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([71, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.837578773498535  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.837578773498535  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 8.4979248046875 GB
    Memory Allocated: 4.837714195251465  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4998779296875 GB
    Memory Allocated: 4.860600471496582  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([1238, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.5018310546875 GB
    Memory Allocated: 4.890279769897461  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5018310546875 GB
    Memory Allocated: 4.890279769897461  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

 h.shape torch.Size([1, 1238, 256]), torch.Size([1, 1238, 256])
----------------------------------------3
 Nvidia-smi: 8.5018310546875 GB
    Memory Allocated: 4.892978191375732  GigaBytes
Max Memory Allocated: 5.328908443450928  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5018310546875 GB
    Memory Allocated: 5.321566581726074  GigaBytes
Max Memory Allocated: 5.351082801818848  GigaBytes

rst.shape  torch.Size([1, 1238, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5018310546875 GB
    Memory Allocated: 5.240334987640381  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5018310546875 GB
    Memory Allocated: 5.2425923347473145  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5018310546875 GB
    Memory Allocated: 5.244286060333252  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.5018310546875 GB
    Memory Allocated: 5.241943836212158  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

torch.Size([11365, 40])
input nodes number: 63513
output nodes number: 11365
edges number: 93930
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5018310546875 GB
    Memory Allocated: 5.242501735687256  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.5018310546875 GB
    Memory Allocated: 5.242502212524414  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.08347845077514648  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.08347845077514648  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.08347845077514648  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04552215337753296 |0.004302322864532471 |0.13511842489242554 |9.617209434509277e-05 |0.07700097560882568 |0.005266904830932617 |
----------------------------------------------------------pseudo_mini_loss sum 4.096782207489014
Total (block generation + training)time/epoch 7.297871828079224
Training time/epoch 2.1632723808288574
Training time without block to device /epoch 2.1288537979125977
Training time without total dataloading part /epoch 1.7029914855957031
load block tensor time/epoch 0.36417722702026367
block to device time/epoch 0.034418582916259766
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1486895
Number of first layer input nodes during this epoch:  984038
Number of first layer output nodes during this epoch:  502857
----------------------------------------before generate dataloader block 
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.08347797393798828  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0451664924621582
number of batches is  8
batch size is  11368
random selection method spend 0.0073528289794921875
time for parepare:  0.02506256103515625
local_output_nid generation:  0.004978179931640625
local_in_edges_tensor generation:  0.007567882537841797
mini_batch_src_global generation:  0.0037016868591308594
r_  generation:  0.03612875938415527
local_output_nid generation:  0.006781339645385742
local_in_edges_tensor generation:  0.0035216808319091797
mini_batch_src_global generation:  0.004560232162475586
r_  generation:  0.03928661346435547
local_output_nid generation:  0.006963968276977539
local_in_edges_tensor generation:  0.0029702186584472656
mini_batch_src_global generation:  0.00292205810546875
r_  generation:  0.03643202781677246
local_output_nid generation:  0.007063865661621094
local_in_edges_tensor generation:  0.0032138824462890625
mini_batch_src_global generation:  0.002622842788696289
r_  generation:  0.037601470947265625
local_output_nid generation:  0.008649349212646484
local_in_edges_tensor generation:  0.0033206939697265625
mini_batch_src_global generation:  0.002678394317626953
r_  generation:  0.0385434627532959
local_output_nid generation:  0.0070989131927490234
local_in_edges_tensor generation:  0.003151416778564453
mini_batch_src_global generation:  0.002922534942626953
r_  generation:  0.038831233978271484
local_output_nid generation:  0.0070765018463134766
local_in_edges_tensor generation:  0.003011465072631836
mini_batch_src_global generation:  0.0029392242431640625
r_  generation:  0.03795266151428223
local_output_nid generation:  0.007136821746826172
local_in_edges_tensor generation:  0.0030260086059570312
mini_batch_src_global generation:  0.002964496612548828
r_  generation:  0.03871560096740723
----------------------check_connections_block total spend ----------------------------- 0.5169613361358643
generate_one_block  0.06530880928039551
generate_one_block  0.05166292190551758
generate_one_block  0.05293726921081543
generate_one_block  0.05249333381652832
generate_one_block  0.052375078201293945
generate_one_block  0.05234575271606445
generate_one_block  0.05121159553527832
generate_one_block  0.05188131332397461
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02461528778076172
gen group dst list time:  0.014759063720703125
time for parepare:  0.019491910934448242
local_output_nid generation:  0.013183355331420898
local_in_edges_tensor generation:  0.020809650421142578
mini_batch_src_global generation:  0.015068769454956055
r_  generation:  0.16350340843200684
local_output_nid generation:  0.02115797996520996
local_in_edges_tensor generation:  0.016970396041870117
mini_batch_src_global generation:  0.017987489700317383
r_  generation:  0.1744067668914795
local_output_nid generation:  0.02075052261352539
local_in_edges_tensor generation:  0.014984130859375
mini_batch_src_global generation:  0.01774144172668457
r_  generation:  0.17655301094055176
local_output_nid generation:  0.020180463790893555
local_in_edges_tensor generation:  0.015079736709594727
mini_batch_src_global generation:  0.018576383590698242
r_  generation:  0.17838311195373535
local_output_nid generation:  0.0207674503326416
local_in_edges_tensor generation:  0.015760183334350586
mini_batch_src_global generation:  0.021925687789916992
r_  generation:  0.1840212345123291
local_output_nid generation:  0.02065753936767578
local_in_edges_tensor generation:  0.01514434814453125
mini_batch_src_global generation:  0.023986339569091797
r_  generation:  0.1840519905090332
local_output_nid generation:  0.020477771759033203
local_in_edges_tensor generation:  0.014479398727416992
mini_batch_src_global generation:  0.020367860794067383
r_  generation:  0.18070411682128906
local_output_nid generation:  0.020415782928466797
local_in_edges_tensor generation:  0.01456761360168457
mini_batch_src_global generation:  0.02034902572631836
r_  generation:  0.18674683570861816
----------------------check_connections_block total spend ----------------------------- 2.2257492542266846
generate_one_block  0.2182457447052002
generate_one_block  0.22032570838928223
generate_one_block  0.21686196327209473
generate_one_block  0.2195124626159668
generate_one_block  0.22497010231018066
generate_one_block  0.2256944179534912
generate_one_block  0.223480224609375
generate_one_block  0.22070693969726562
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.08347797393798828  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

connection checking time:  2.2257492542266846
block generation total time  1.7697975635528564
average batch blocks generation time:  0.22122469544410706
block dataloader generation time/epoch 5.14817476272583
pseudo mini batch 0 input nodes size: 123003
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.071746826171875  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.071746826171875  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.13039922714233398  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.13048410415649414  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.0715341567993164  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.07606935501098633  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.07606935501098633  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.07606935501098633  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

torch.Size([123003, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.07606935501098633  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

m.shape torch.Size([3180, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.30695056915283203  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.30695056915283203  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3180, 128]), torch.Size([1, 3180, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.3099832534790039  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.33512353897094727  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3180, 128])
m.shape torch.Size([3944, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.33774423599243164  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.33774423599243164  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3944, 128]), torch.Size([1, 3944, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.34188127517700195  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.40019655227661133  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3944, 128])
m.shape torch.Size([3918, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.40334081649780273  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.40334081649780273  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3918, 128]), torch.Size([1, 3918, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.4076695442199707  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.49393415451049805  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3918, 128])
m.shape torch.Size([3969, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.4995388984680176  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.4995388984680176  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3969, 128]), torch.Size([1, 3969, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.5039787292480469  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.6171388626098633  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3969, 128])
m.shape torch.Size([3711, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.6236095428466797  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.6236095428466797  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3711, 128]), torch.Size([1, 3711, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.6278061866760254  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.7566914558410645  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3711, 128])
m.shape torch.Size([3268, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.7642717361450195  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.7642717361450195  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3268, 128]), torch.Size([1, 3268, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.7675995826721191  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.9089665412902832  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3268, 128])
m.shape torch.Size([2974, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.917335033416748  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.917335033416748  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 2974, 128]), torch.Size([1, 2974, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.9202723503112793  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.0622353553771973  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 2974, 128])
m.shape torch.Size([2811, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.07216215133667  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.07216215133667  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 2811, 128]), torch.Size([1, 2811, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.074842929840088  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.2337737083435059  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 2811, 128])
m.shape torch.Size([2524, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.243265151977539  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.243265151977539  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 2524, 128]), torch.Size([1, 2524, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.2457003593444824  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.4016757011413574  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 2524, 128])
m.shape torch.Size([32306, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.5547690391540527  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.5547690391540527  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 32306, 128]), torch.Size([1, 32306, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.585578441619873  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.798600673675537  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 32306, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.5883212089538574  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.6480259895324707  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.707730770111084  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.64755916595459  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

torch.Size([62605, 256])
first layer input nodes number: 123003
first layer output nodes number: 62605
edges number: 465943
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.708649158477783  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.7683539390563965  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.783280372619629  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.783280372619629  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

m.shape torch.Size([1679, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.874173641204834  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.874173641204834  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 1679, 256]), torch.Size([1, 1679, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.877922534942627  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.904477119445801  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 1679, 256])
m.shape torch.Size([1424, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.905731678009033  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.905731678009033  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 1424, 256]), torch.Size([1, 1424, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.909018039703369  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.950796604156494  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 1424, 256])
m.shape torch.Size([1216, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.9528322219848633  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.9528322219848633  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 1216, 256]), torch.Size([1, 1216, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.9560494422912598  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.010234355926514  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 1216, 256])
m.shape torch.Size([915, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.013228893280029  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.013228893280029  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 915, 256]), torch.Size([1, 915, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.014974117279053  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.073218822479248  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 915, 256])
m.shape torch.Size([774, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.076501846313477  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.076501846313477  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 774, 256]), torch.Size([1, 774, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.077978134155273  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.131254196166992  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 774, 256])
m.shape torch.Size([628, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.1341376304626465  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.1341376304626465  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 628, 256]), torch.Size([1, 628, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.135335445404053  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.1875739097595215  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 628, 256])
m.shape torch.Size([556, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.190715789794922  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.190715789794922  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 556, 256]), torch.Size([1, 556, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.191776275634766  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.245941162109375  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 556, 256])
m.shape torch.Size([426, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.248686790466309  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.248686790466309  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 426, 256]), torch.Size([1, 426, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.249499320983887  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.29628324508667  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 426, 256])
m.shape torch.Size([352, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.298922061920166  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.298922061920166  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 352, 256]), torch.Size([1, 352, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.299593448638916  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.344118595123291  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 352, 256])
m.shape torch.Size([329, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.346945285797119  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.346945285797119  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 329, 256]), torch.Size([1, 329, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.3475728034973145  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.393200397491455  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 329, 256])
m.shape torch.Size([281, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.395857810974121  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.395857810974121  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.396393775939941  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.440441131591797  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([245, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.442998886108398  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.442998886108398  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.4434661865234375  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.483186721801758  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([192, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.485352039337158  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.485352039337158  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.485718250274658  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.519409656524658  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([167, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.5214738845825195  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.5214738845825195  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.521792411804199  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.553326606750488  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([163, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.555517673492432  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.555517673492432  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.55582857131958  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.5887837409973145  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([139, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.590765953063965  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.590765953063965  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.591031074523926  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.620989799499512  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([117, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.622769355773926  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.622769355773926  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.622992515563965  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.649771690368652  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([106, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.652226448059082  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.652226448059082  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.65242862701416  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.678105354309082  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([106, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.679940223693848  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.679940223693848  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.680142402648926  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.7072343826293945  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([103, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.709113597869873  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.709113597869873  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.709310054779053  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.737010478973389  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([90, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.738729000091553  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.738729000091553  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.738900661468506  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.764306545257568  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([80, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.7659125328063965  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.7659125328063965  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.7660651206970215  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.7897162437438965  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([65, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.791077136993408  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.791077136993408  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.791201114654541  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.811285495758057  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([70, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.812838554382324  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.812838554382324  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.812972068786621  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.835536003112793  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([1145, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.862981796264648  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.862981796264648  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 1145, 256]), torch.Size([1, 1145, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.865516185760498  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 5.26505184173584  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 1145, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 5.186008930206299  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 5.187816143035889  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 5.189510345458984  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 5.187618255615234  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

torch.Size([11368, 40])
input nodes number: 62605
output nodes number: 11368
edges number: 92186
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 5.188283443450928  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 5.188284397125244  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.08437204360961914  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

pseudo mini batch 1 input nodes size: 122764
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.07164859771728516  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.07164859771728516  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.13024234771728516  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.1303272247314453  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.07158994674682617  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.07575273513793945  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.07575273513793945  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.07575273513793945  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

torch.Size([122764, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.07575273513793945  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

m.shape torch.Size([3197, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.30574989318847656  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.30574989318847656  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3197, 128]), torch.Size([1, 3197, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.30900144577026367  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.333773136138916  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3197, 128])
m.shape torch.Size([4001, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.33606433868408203  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.33606433868408203  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 4001, 128]), torch.Size([1, 4001, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.33987998962402344  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.39856433868408203  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 4001, 128])
m.shape torch.Size([4062, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.40210485458374023  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.40210485458374023  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 4062, 128]), torch.Size([1, 4062, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.4063119888305664  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.4924015998840332  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 4062, 128])
m.shape torch.Size([3922, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.4982123374938965  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.4982123374938965  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3922, 128]), torch.Size([1, 3922, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.5019612312316895  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.6154065132141113  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3922, 128])
m.shape torch.Size([3760, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.6225008964538574  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.6225008964538574  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3760, 128]), torch.Size([1, 3760, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.6261639595031738  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.7552533149719238  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3760, 128])
m.shape torch.Size([3275, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.7628302574157715  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.7628302574157715  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3275, 128]), torch.Size([1, 3275, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.7660202980041504  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.9064059257507324  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3275, 128])
m.shape torch.Size([2931, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.9146275520324707  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.9146275520324707  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 2931, 128]), torch.Size([1, 2931, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.9174227714538574  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.0571837425231934  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 2931, 128])
m.shape torch.Size([2803, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.0664787292480469  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.0664787292480469  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 2803, 128]), torch.Size([1, 2803, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.0692033767700195  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.2261285781860352  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 2803, 128])
m.shape torch.Size([2504, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.2347187995910645  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.2347187995910645  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 2504, 128]), torch.Size([1, 2504, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.2372822761535645  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.395291805267334  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 2504, 128])
m.shape torch.Size([32285, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.5479674339294434  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.5479674339294434  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 32285, 128]), torch.Size([1, 32285, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.5787568092346191  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.7924399375915527  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 32285, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.5824666023254395  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.6423001289367676  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.7021336555480957  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.6418323516845703  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

torch.Size([62740, 256])
first layer input nodes number: 122764
first layer output nodes number: 62740
edges number: 465850
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.7030506134033203  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.7628841400146484  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.7778425216674805  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.7778425216674805  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

m.shape torch.Size([1721, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.86922550201416  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.86922550201416  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 1721, 256]), torch.Size([1, 1721, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.873070240020752  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.900653839111328  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 1721, 256])
m.shape torch.Size([1469, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.9023170471191406  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.9023170471191406  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 1469, 256]), torch.Size([1, 1469, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.9055633544921875  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.9479494094848633  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 1469, 256])
m.shape torch.Size([1108, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.950709819793701  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.950709819793701  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 1108, 256]), torch.Size([1, 1108, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.9528727531433105  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.002465724945068  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 1108, 256])
m.shape torch.Size([905, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.005231857299805  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.005231857299805  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 905, 256]), torch.Size([1, 905, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.0069580078125  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.065227508544922  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 905, 256])
m.shape torch.Size([826, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.0685319900512695  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.0685319900512695  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 826, 256]), torch.Size([1, 826, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.070107460021973  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.127449989318848  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 826, 256])
m.shape torch.Size([608, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.130168437957764  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.130168437957764  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 608, 256]), torch.Size([1, 608, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.131328105926514  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.183475971221924  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 608, 256])
m.shape torch.Size([468, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.186045169830322  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.186045169830322  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 468, 256]), torch.Size([1, 468, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.1869378089904785  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.231569766998291  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 468, 256])
m.shape torch.Size([452, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.2345991134643555  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.2345991134643555  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 452, 256]), torch.Size([1, 452, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.235461235046387  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.285857200622559  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 452, 256])
m.shape torch.Size([364, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.288575172424316  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.288575172424316  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 364, 256]), torch.Size([1, 364, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.28926944732666  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.334238529205322  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 364, 256])
m.shape torch.Size([335, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.337111473083496  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.337111473083496  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 335, 256]), torch.Size([1, 335, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.337750434875488  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.383681297302246  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 335, 256])
m.shape torch.Size([242, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.385920524597168  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.385920524597168  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.386382102966309  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.422385215759277  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([235, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.424865245819092  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.424865245819092  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.425313472747803  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.463412761688232  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([224, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.465987682342529  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.465987682342529  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.466414928436279  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.505721569061279  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([193, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.508105278015137  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.508105278015137  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.5084733963012695  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.544917106628418  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([181, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.547342777252197  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.547342777252197  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.547688007354736  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.584282398223877  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([138, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.5862321853637695  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.5862321853637695  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.586495399475098  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.616238594055176  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([129, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.618215084075928  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.618215084075928  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.6184611320495605  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.647986888885498  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([105, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.6496806144714355  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.6496806144714355  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.649880886077881  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.6753153800964355  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([110, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.677224159240723  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.677224159240723  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.677433967590332  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.705548286437988  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([99, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.707346439361572  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.707346439361572  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.707535266876221  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.73415994644165  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([91, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.735902309417725  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.735902309417725  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.7360758781433105  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.761764049530029  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([65, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.7633867263793945  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.7633867263793945  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.763510704040527  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.782727241516113  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([57, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.783925533294678  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.783925533294678  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.784034252166748  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.801646709442139  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([57, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.802907466888428  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.802907466888428  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.803016185760498  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.821389675140381  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([1186, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.849833011627197  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.849833011627197  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 1186, 256]), torch.Size([1, 1186, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.852097034454346  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 5.256276607513428  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 1186, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 5.176970958709717  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 5.1786651611328125  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 5.180359363555908  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 5.178580284118652  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

torch.Size([11368, 40])
input nodes number: 62740
output nodes number: 11368
edges number: 92741
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 5.179019927978516  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 5.179020404815674  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.08294010162353516  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

pseudo mini batch 2 input nodes size: 122504
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.07147693634033203  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.07147693634033203  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.12989139556884766  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.1299762725830078  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.07129764556884766  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.07607650756835938  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.07607650756835938  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.07607650756835938  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

torch.Size([122504, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.07607650756835938  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

m.shape torch.Size([3072, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.3049616813659668  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.3049616813659668  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3072, 128]), torch.Size([1, 3072, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.3078913688659668  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.3313288688659668  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3072, 128])
m.shape torch.Size([4026, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.3337702751159668  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.3337702751159668  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 4026, 128]), torch.Size([1, 4026, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.33760976791381836  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.3962702751159668  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 4026, 128])
m.shape torch.Size([4165, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.40010976791381836  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.40010976791381836  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 4165, 128]), torch.Size([1, 4165, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.4040818214416504  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.4914669990539551  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 4165, 128])
m.shape torch.Size([3894, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.497161865234375  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.497161865234375  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3894, 128]), torch.Size([1, 3894, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.501004695892334  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.6135668754577637  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3894, 128])
m.shape torch.Size([3636, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.6209940910339355  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.6209940910339355  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3636, 128]), torch.Size([1, 3636, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.6246352195739746  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.7504706382751465  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3636, 128])
m.shape torch.Size([3302, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.7581839561462402  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.7581839561462402  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3302, 128]), torch.Size([1, 3302, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.761629581451416  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.9019570350646973  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3302, 128])
m.shape torch.Size([3016, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.9104666709899902  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.9104666709899902  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3016, 128]), torch.Size([1, 3016, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.9134793281555176  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.062868595123291  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3016, 128])
m.shape torch.Size([2787, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.0720620155334473  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.0720620155334473  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 2787, 128]), torch.Size([1, 2787, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.0757737159729004  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.2346816062927246  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 2787, 128])
m.shape torch.Size([2606, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.2445363998413086  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.2445363998413086  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 2606, 128]), torch.Size([1, 2606, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.2471933364868164  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.4125213623046875  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 2606, 128])
m.shape torch.Size([32072, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.5642099380493164  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.5642099380493164  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 32072, 128]), torch.Size([1, 32072, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.5947961807250977  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.7664194107055664  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 32072, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.5568227767944336  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.616499900817871  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.6761770248413086  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.6160335540771484  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

torch.Size([62576, 256])
first layer input nodes number: 122504
first layer output nodes number: 62576
edges number: 464769
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.6770920753479004  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.736769199371338  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.7516884803771973  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.7516884803771973  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

m.shape torch.Size([1637, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.843073844909668  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.843073844909668  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 1637, 256]), torch.Size([1, 1637, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.8468503952026367  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.8736777305603027  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 1637, 256])
m.shape torch.Size([1457, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.8740038871765137  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.8740038871765137  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 1457, 256]), torch.Size([1, 1457, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.876901149749756  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.9208292961120605  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 1457, 256])
m.shape torch.Size([1162, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.923704147338867  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.923704147338867  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 1162, 256]), torch.Size([1, 1162, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.926211357116699  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.9784955978393555  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 1162, 256])
m.shape torch.Size([967, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.9814352989196777  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.9814352989196777  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 967, 256]), torch.Size([1, 967, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.9832797050476074  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.043359279632568  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 967, 256])
m.shape torch.Size([725, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.0467023849487305  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.0467023849487305  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 725, 256]), torch.Size([1, 725, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.0480852127075195  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.097958564758301  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 725, 256])
m.shape torch.Size([613, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.100802421569824  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.100802421569824  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 613, 256]), torch.Size([1, 613, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.101971626281738  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.153700828552246  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 613, 256])
m.shape torch.Size([541, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.156756401062012  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.156756401062012  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 541, 256]), torch.Size([1, 541, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.157788276672363  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.211263656616211  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 541, 256])
m.shape torch.Size([465, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.2143235206604  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.2143235206604  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 465, 256]), torch.Size([1, 465, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.215210437774658  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.266022205352783  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 465, 256])
m.shape torch.Size([407, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.269099712371826  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.269099712371826  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 407, 256]), torch.Size([1, 407, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.269876003265381  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.320749759674072  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 407, 256])
m.shape torch.Size([339, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.323619842529297  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.323619842529297  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 339, 256]), torch.Size([1, 339, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.32426643371582  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.372162342071533  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 339, 256])
m.shape torch.Size([241, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.374387264251709  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.374387264251709  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.374846935272217  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.410701274871826  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([233, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.413158893585205  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.413158893585205  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.41360330581665  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.451378345489502  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([204, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.453705310821533  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.453705310821533  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.454094409942627  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.489891529083252  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([177, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.49207878112793  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.49207878112793  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.4924163818359375  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.525838851928711  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([143, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.527731895446777  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.527731895446777  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.5280046463012695  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.556916236877441  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([130, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.558779239654541  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.558779239654541  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.559027194976807  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.587046146392822  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([123, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.588932037353516  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.588932037353516  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.589166641235352  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.617319107055664  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([121, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.619295597076416  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.619295597076416  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.619526386260986  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.648836612701416  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([103, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.650602340698242  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.650602340698242  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.650798797607422  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.6771240234375  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([111, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.679159641265869  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.679159641265869  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.679371356964111  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.70922327041626  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([98, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.711688041687012  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.711688041687012  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.711874961853027  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.73953914642334  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([62, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.740993499755859  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.740993499755859  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.741111755371094  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.759441375732422  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([62, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.761181354522705  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.761181354522705  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.7612996101379395  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.780457019805908  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([68, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.781966686248779  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.781966686248779  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.7820963859558105  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.804015636444092  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([1179, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.832280158996582  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.832280158996582  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 1179, 256]), torch.Size([1, 1179, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.834591865539551  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 5.237620830535889  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 1179, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 5.1582255363464355  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 5.159919738769531  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 5.161613941192627  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 5.159834861755371  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

torch.Size([11368, 40])
input nodes number: 62576
output nodes number: 11368
edges number: 92971
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 5.160386085510254  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 5.160386562347412  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.08336639404296875  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

pseudo mini batch 3 input nodes size: 122988
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.07129764556884766  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.07129764556884766  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.1299428939819336  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.13002777099609375  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.07152843475341797  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.07607555389404297  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.07607555389404297  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.07607555389404297  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

torch.Size([122988, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.07607555389404297  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

m.shape torch.Size([3210, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.30608415603637695  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.30608415603637695  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3210, 128]), torch.Size([1, 3210, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.309145450592041  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.3352651596069336  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3210, 128])
m.shape torch.Size([4003, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.3375520706176758  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.3375520706176758  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 4003, 128]), torch.Size([1, 4003, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.34136962890625  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.4000520706176758  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 4003, 128])
m.shape torch.Size([4094, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.40364503860473633  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.40364503860473633  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 4094, 128]), torch.Size([1, 4094, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.40786075592041016  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.49393224716186523  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 4094, 128])
m.shape torch.Size([3772, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.499788761138916  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.499788761138916  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3772, 128]), torch.Size([1, 3772, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.5034527778625488  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.6082415580749512  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3772, 128])
m.shape torch.Size([3643, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.6151285171508789  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.6151285171508789  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3643, 128]), torch.Size([1, 3643, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.6186642646789551  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.7445826530456543  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3643, 128])
m.shape torch.Size([3334, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.7523841857910156  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.7523841857910156  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3334, 128]), torch.Size([1, 3334, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.7558403015136719  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.8973040580749512  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3334, 128])
m.shape torch.Size([3028, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.9058213233947754  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.9058213233947754  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3028, 128]), torch.Size([1, 3028, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.9088549613952637  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.0593295097351074  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3028, 128])
m.shape torch.Size([2760, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.0684142112731934  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.0684142112731934  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 2760, 128]), torch.Size([1, 2760, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.0710463523864746  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.2210783958435059  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 2760, 128])
m.shape torch.Size([2555, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.2316069602966309  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.2316069602966309  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 2555, 128]), torch.Size([1, 2555, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.2340788841247559  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.3907299041748047  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 2555, 128])
m.shape torch.Size([32344, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.5437703132629395  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.5437703132629395  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 32344, 128]), torch.Size([1, 32344, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.5746159553527832  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.788109302520752  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 32344, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.5778956413269043  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.6377320289611816  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.697568416595459  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.6372642517089844  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

torch.Size([62743, 256])
first layer input nodes number: 122988
first layer output nodes number: 62743
edges number: 466516
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.698486804962158  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.7583231925964355  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.773282527923584  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.773282527923584  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

m.shape torch.Size([1663, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.8647689819335938  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.8647689819335938  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 1663, 256]), torch.Size([1, 1663, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.8686299324035645  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.8957276344299316  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 1663, 256])
m.shape torch.Size([1449, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.896970748901367  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.896970748901367  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 1449, 256]), torch.Size([1, 1449, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.9005126953125  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.942688465118408  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 1449, 256])
m.shape torch.Size([1182, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.945441722869873  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.945441722869873  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 1182, 256]), torch.Size([1, 1182, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.947874069213867  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.999606132507324  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 1182, 256])
m.shape torch.Size([885, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.0026140213012695  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.0026140213012695  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 885, 256]), torch.Size([1, 885, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.004302024841309  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.062043190002441  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 885, 256])
m.shape torch.Size([815, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.065338134765625  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.065338134765625  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 815, 256]), torch.Size([1, 815, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.066892623901367  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.12373161315918  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 815, 256])
m.shape torch.Size([619, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.126524448394775  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.126524448394775  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 619, 256]), torch.Size([1, 619, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.127705097198486  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.179647922515869  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 619, 256])
m.shape torch.Size([496, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.182394981384277  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.182394981384277  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 496, 256]), torch.Size([1, 496, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.183341026306152  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.231301307678223  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 496, 256])
m.shape torch.Size([452, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.234303951263428  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.234303951263428  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 452, 256]), torch.Size([1, 452, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.235166072845459  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.285268306732178  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 452, 256])
m.shape torch.Size([379, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.288115978240967  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.288115978240967  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.288838863372803  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.336267948150635  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([301, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.338799953460693  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.338799953460693  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.33937406539917  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.380351543426514  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 301, 256])
m.shape torch.Size([266, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.382876873016357  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.382876873016357  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.3833842277526855  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.42422342300415  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([262, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.426991939544678  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.426991939544678  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.427491664886475  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.470822811126709  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([224, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.473371982574463  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.473371982574463  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.473799228668213  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.513105869293213  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([172, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.515206813812256  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.515206813812256  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.5155348777771  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.548013210296631  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([148, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.549983024597168  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.549983024597168  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.550265312194824  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.580187797546387  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([141, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.582215309143066  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.582215309143066  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.582484245300293  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.6128740310668945  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([136, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.614962100982666  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.614962100982666  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.6152215003967285  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.6463494300842285  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([130, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.648468971252441  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.648468971252441  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.648716926574707  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.680207252502441  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([99, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.681891441345215  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.681891441345215  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.682080268859863  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.707383155822754  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([95, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.709115028381348  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.709115028381348  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.709296226501465  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.734845161437988  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([90, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.736571311950684  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.736571311950684  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.736742973327637  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.762148857116699  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([76, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.763670444488525  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.763670444488525  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.763815402984619  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.78628396987915  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([57, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.787568092346191  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.787568092346191  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.787676811218262  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.805289268493652  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([50, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.8063883781433105  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.8063883781433105  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.806483745574951  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.822600841522217  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([1181, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.850930690765381  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.850930690765381  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 1181, 256]), torch.Size([1, 1181, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.853196620941162  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 5.255840301513672  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 1181, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 5.176198959350586  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 5.177911758422852  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 5.180272579193115  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 5.1784749031066895  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

torch.Size([11368, 40])
input nodes number: 62743
output nodes number: 11368
edges number: 92842
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 5.179027557373047  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 5.179028034210205  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.08338403701782227  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

pseudo mini batch 4 input nodes size: 123765
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.07152843475341797  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.07152843475341797  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.13054418563842773  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.1306290626525879  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.0718989372253418  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.07670974731445312  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.07670974731445312  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.07670974731445312  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

torch.Size([123765, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.07670974731445312  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

m.shape torch.Size([3224, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.3089280128479004  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.3089280128479004  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3224, 128]), torch.Size([1, 3224, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.31200265884399414  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.33745765686035156  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3224, 128])
m.shape torch.Size([3991, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.33972644805908203  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.33972644805908203  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3991, 128]), torch.Size([1, 3991, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.34412431716918945  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.4028182029724121  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3991, 128])
m.shape torch.Size([4131, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.40642404556274414  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.40642404556274414  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 4131, 128]), torch.Size([1, 4131, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.41069746017456055  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.4974360466003418  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 4131, 128])
m.shape torch.Size([3908, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.5032119750976562  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.5032119750976562  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3908, 128]), torch.Size([1, 3908, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.5070452690124512  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.6197466850280762  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3908, 128])
m.shape torch.Size([3807, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.6272006034851074  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.6272006034851074  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3807, 128]), torch.Size([1, 3807, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.6308732032775879  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.7623624801635742  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3807, 128])
m.shape torch.Size([3280, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.7699313163757324  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.7699313163757324  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3280, 128]), torch.Size([1, 3280, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.7735357284545898  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.9136991500854492  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3280, 128])
m.shape torch.Size([3043, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.9215292930603027  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.9215292930603027  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3043, 128]), torch.Size([1, 3043, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.9253935813903809  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.0767254829406738  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3043, 128])
m.shape torch.Size([2849, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.0854744911193848  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.0854744911193848  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 2849, 128]), torch.Size([1, 2849, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.0882306098937988  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.2474894523620605  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 2849, 128])
m.shape torch.Size([2494, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.256321907043457  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.256321907043457  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 2494, 128]), torch.Size([1, 2494, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.2594003677368164  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.4158282279968262  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 2494, 128])
m.shape torch.Size([32571, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.570385456085205  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.570385456085205  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 32571, 128]), torch.Size([1, 32571, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.601447582244873  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.8181309700012207  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 32571, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.6073899269104004  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.667755603790283  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.728121280670166  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.667283535003662  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

torch.Size([63298, 256])
first layer input nodes number: 123765
first layer output nodes number: 63298
edges number: 470195
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.7290453910827637  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.7894110679626465  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.804502487182617  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.804502487182617  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

m.shape torch.Size([1678, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.8971915245056152  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.8971915245056152  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 1678, 256]), torch.Size([1, 1678, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.9008703231811523  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.928274631500244  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 1678, 256])
m.shape torch.Size([1460, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.9286813735961914  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.9286813735961914  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 1460, 256]), torch.Size([1, 1460, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.9316697120666504  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.9736504554748535  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 1460, 256])
m.shape torch.Size([1150, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.9762840270996094  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.9762840270996094  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 1150, 256]), torch.Size([1, 1150, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.9784889221191406  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.029364585876465  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 1150, 256])
m.shape torch.Size([921, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.031408786773682  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.031408786773682  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 921, 256]), torch.Size([1, 921, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.033165454864502  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.089951038360596  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 921, 256])
m.shape torch.Size([761, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.093101501464844  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.093101501464844  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 761, 256]), torch.Size([1, 761, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.094552993774414  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.147371292114258  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 761, 256])
m.shape torch.Size([577, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.149973392486572  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.149973392486572  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 577, 256]), torch.Size([1, 577, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.151073932647705  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.198397159576416  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 577, 256])
m.shape torch.Size([527, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.201392650604248  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.201392650604248  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 527, 256]), torch.Size([1, 527, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.20239782333374  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.25265645980835  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 527, 256])
m.shape torch.Size([385, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.255114555358887  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.255114555358887  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 385, 256]), torch.Size([1, 385, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.2558488845825195  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.300161361694336  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 385, 256])
m.shape torch.Size([382, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.303098678588867  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.303098678588867  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 382, 256]), torch.Size([1, 382, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.303827285766602  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.351222991943359  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 382, 256])
m.shape torch.Size([340, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.354126930236816  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.354126930236816  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 340, 256]), torch.Size([1, 340, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.354775428771973  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.4019365310668945  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 340, 256])
m.shape torch.Size([306, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.404847621917725  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.404847621917725  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.405431270599365  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.451879024505615  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([242, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.454378604888916  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.454378604888916  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.454840183258057  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.49407434463501  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([201, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.496355056762695  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.496355056762695  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.496738433837891  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.532009124755859  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([178, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.534212589263916  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.534212589263916  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.534552097320557  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.5681633949279785  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([145, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.570084095001221  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.570084095001221  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.5703606605529785  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.599676609039307  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([149, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.601830005645752  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.601830005645752  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.602114200592041  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.634228229522705  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([139, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.636357307434082  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.636357307434082  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.636622428894043  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.6684370040893555  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([127, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.670501708984375  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.670501708984375  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.670743942260742  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.701507568359375  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([115, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.703486919403076  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.703486919403076  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.70370626449585  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.73309850692749  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([115, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.735199451446533  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.735199451446533  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.735418796539307  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.766346454620361  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([94, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.768134117126465  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.768134117126465  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.768313407897949  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.794848442077637  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([68, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.796199798583984  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.796199798583984  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.796329498291016  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.816432952880859  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([72, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.818593978881836  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.818593978881836  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.818731307983398  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.840978622436523  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([60, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.842294216156006  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.842294216156006  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.842408657073975  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.861749172210693  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([1176, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.890322208404541  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.890322208404541  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 1176, 256]), torch.Size([1, 1176, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.8925652503967285  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 5.2934746742248535  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 1176, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 5.21312141418457  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 5.214815616607666  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 5.216509819030762  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 5.214730739593506  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

torch.Size([11368, 40])
input nodes number: 63298
output nodes number: 11368
edges number: 93640
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 5.216140270233154  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 5.2161407470703125  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.08553218841552734  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

pseudo mini batch 5 input nodes size: 123268
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.07275152206420898  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.07275152206420898  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.1315302848815918  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.13161516189575195  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.07251453399658203  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.07673072814941406  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.07673072814941406  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.07673072814941406  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

torch.Size([123268, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.07673072814941406  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

m.shape torch.Size([3128, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.3091740608215332  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.3091740608215332  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3128, 128]), torch.Size([1, 3128, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.31215715408325195  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.33720970153808594  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3128, 128])
m.shape torch.Size([4034, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.33926963806152344  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.33926963806152344  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 4034, 128]), torch.Size([1, 4034, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.34311676025390625  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.40176963806152344  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 4034, 128])
m.shape torch.Size([4056, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.40561676025390625  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.40561676025390625  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 4056, 128]), torch.Size([1, 4056, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.40948486328125  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.49535655975341797  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 4056, 128])
m.shape torch.Size([3875, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.5008134841918945  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.5008134841918945  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3875, 128]), torch.Size([1, 3875, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.5045952796936035  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.6179046630859375  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3875, 128])
m.shape torch.Size([3644, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.6247448921203613  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.6247448921203613  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3644, 128]), torch.Size([1, 3644, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.628361701965332  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.7543039321899414  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3644, 128])
m.shape torch.Size([3293, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.7615699768066406  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.7615699768066406  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3293, 128]), torch.Size([1, 3293, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.7650184631347656  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.9074239730834961  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3293, 128])
m.shape torch.Size([3042, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.9160075187683105  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.9160075187683105  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3042, 128]), torch.Size([1, 3042, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 0.9190816879272461  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.0686159133911133  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3042, 128])
m.shape torch.Size([2840, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.0779991149902344  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.0779991149902344  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 2840, 128]), torch.Size([1, 2840, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.080775260925293  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.2406005859375  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 2840, 128])
m.shape torch.Size([2536, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.2501296997070312  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.2501296997070312  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 2536, 128]), torch.Size([1, 2536, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.252767562866211  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.409250259399414  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 2536, 128])
m.shape torch.Size([32821, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.5645437240600586  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.5645437240600586  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 32821, 128]), torch.Size([1, 32821, 128])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 1.5958442687988281  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.818182945251465  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 32821, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.6068081855773926  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.6671462059020996  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.7274842262268066  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.6666746139526367  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

torch.Size([63269, 256])
first layer input nodes number: 123268
first layer output nodes number: 63269
edges number: 471890
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.728404998779297  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.788743019104004  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.8038277626037598  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.8038277626037598  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

m.shape torch.Size([1630, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.896063804626465  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.896063804626465  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 1630, 256]), torch.Size([1, 1630, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.8995018005371094  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.92543363571167  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 1630, 256])
m.shape torch.Size([1542, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.927485942840576  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.927485942840576  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 1542, 256]), torch.Size([1, 1542, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.9308295249938965  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.9772353172302246  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 1542, 256])
m.shape torch.Size([1141, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.979290008544922  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.979290008544922  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 1141, 256]), torch.Size([1, 1141, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.9819536209106445  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.036036968231201  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 1141, 256])
m.shape torch.Size([907, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.038093090057373  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.038093090057373  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 907, 256]), torch.Size([1, 907, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.039823055267334  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.0950446128845215  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 907, 256])
m.shape torch.Size([770, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.098089694976807  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.098089694976807  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 770, 256]), torch.Size([1, 770, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.099558353424072  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.159167766571045  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 770, 256])
m.shape torch.Size([612, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.161962985992432  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.161962985992432  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 612, 256]), torch.Size([1, 612, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.163130283355713  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.214178562164307  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 612, 256])
m.shape torch.Size([447, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.216602325439453  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.216602325439453  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 447, 256]), torch.Size([1, 447, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.21745491027832  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.264359474182129  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 447, 256])
m.shape torch.Size([445, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.267354965209961  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.267354965209961  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 445, 256]), torch.Size([1, 445, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.2682037353515625  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.31828498840332  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 445, 256])
m.shape torch.Size([383, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.321173667907715  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.321173667907715  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 383, 256]), torch.Size([1, 383, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.321904182434082  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.369409561157227  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 383, 256])
m.shape torch.Size([321, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.372129917144775  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.372129917144775  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.372742176055908  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.4168477058410645  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 321, 256])
m.shape torch.Size([278, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.419480800628662  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.419480800628662  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.420011043548584  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.462447643280029  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([221, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.464731693267822  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.464731693267822  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.465153217315674  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.500982761383057  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([208, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.503371238708496  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.503371238708496  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.503767967224121  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.540266990661621  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([185, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.542558193206787  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.542558193206787  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.542911052703857  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.577844142913818  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([189, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.580392837524414  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.580392837524414  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.580753326416016  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.618965148925781  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([141, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.620953559875488  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.620953559875488  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.621222496032715  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.651612281799316  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([135, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.653683662414551  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.653683662414551  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.6539411544799805  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.684840202331543  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([98, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.686407089233398  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.686407089233398  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.686594009399414  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.710332870483398  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([97, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.712010860443115  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.712010860443115  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.712195873260498  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.736987590789795  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([93, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.738683223724365  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.738683223724365  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.738860607147217  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.763871669769287  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([85, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.766021251678467  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.766021251678467  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.766183376312256  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.790177822113037  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([70, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.791577339172363  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.791577339172363  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.79171085357666  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.812405586242676  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([65, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.813776016235352  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.813776016235352  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.813899993896484  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.833984375  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([77, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.83569860458374  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.83569860458374  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.835845470428467  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.860665798187256  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([1228, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.89011812210083  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.89011812210083  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 1228, 256]), torch.Size([1, 1228, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.892460346221924  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 5.317460060119629  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 1228, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 5.236124038696289  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 5.23797607421875  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 5.239828109741211  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 5.23789119720459  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

torch.Size([11368, 40])
input nodes number: 63269
output nodes number: 11368
edges number: 93858
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 5.237752914428711  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 5.237753391265869  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.08341360092163086  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

pseudo mini batch 6 input nodes size: 122738
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.07181978225708008  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.07181978225708008  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.13041353225708008  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.13049840927124023  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.07163476943969727  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.07579278945922852  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.07579278945922852  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.07579278945922852  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

torch.Size([122738, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.07579278945922852  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

m.shape torch.Size([3280, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.3058285713195801  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.3058285713195801  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3280, 128]), torch.Size([1, 3280, 128])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.30904245376586914  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.3348374366760254  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3280, 128])
m.shape torch.Size([3973, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.33640146255493164  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.33640146255493164  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3973, 128]), torch.Size([1, 3973, 128])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.34019041061401367  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.3992319107055664  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3973, 128])
m.shape torch.Size([4057, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.40267181396484375  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.40267181396484375  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 4057, 128]), torch.Size([1, 4057, 128])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.4069700241088867  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.4931020736694336  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 4057, 128])
m.shape torch.Size([3888, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.49890565872192383  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.49890565872192383  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3888, 128]), torch.Size([1, 3888, 128])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.5026140213012695  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.6160874366760254  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3888, 128])
m.shape torch.Size([3711, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.6230812072753906  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.6230812072753906  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3711, 128]), torch.Size([1, 3711, 128])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.6267046928405762  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.754244327545166  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3711, 128])
m.shape torch.Size([3325, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.7619876861572266  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.7619876861572266  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3325, 128]), torch.Size([1, 3325, 128])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.7653427124023438  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.9064693450927734  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3325, 128])
m.shape torch.Size([2924, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.9146437644958496  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.9146437644958496  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 2924, 128]), torch.Size([1, 2924, 128])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.9175810813903809  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 1.0574545860290527  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 2924, 128])
m.shape torch.Size([2823, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 1.0668292045593262  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 1.0668292045593262  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 2823, 128]), torch.Size([1, 2823, 128])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 1.0695695877075195  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 1.2286195755004883  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 2823, 128])
m.shape torch.Size([2532, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 1.2374539375305176  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 1.2374539375305176  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 2532, 128]), torch.Size([1, 2532, 128])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 1.2408242225646973  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 1.3974652290344238  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 2532, 128])
m.shape torch.Size([32248, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 1.5505547523498535  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 1.5505547523498535  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 32248, 128]), torch.Size([1, 32248, 128])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 1.5813088417053223  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.7648491859436035  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 32248, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.5546960830688477  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.6145496368408203  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.674403190612793  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.614081859588623  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

torch.Size([62761, 256])
first layer input nodes number: 122738
first layer output nodes number: 62761
edges number: 465774
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.6753196716308594  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.735173225402832  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.7501368522644043  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.7501368522644043  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

m.shape torch.Size([1701, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.8410606384277344  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.8410606384277344  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 1701, 256]), torch.Size([1, 1701, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.844852924346924  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.871776580810547  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 1701, 256])
m.shape torch.Size([1452, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.87310791015625  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.87310791015625  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 1452, 256]), torch.Size([1, 1452, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.876077651977539  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.918147087097168  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 1452, 256])
m.shape torch.Size([1166, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.920942783355713  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.920942783355713  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 1166, 256]), torch.Size([1, 1166, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.9231667518615723  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.9757509231567383  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 1166, 256])
m.shape torch.Size([928, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.97882080078125  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.97882080078125  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 928, 256]), torch.Size([1, 928, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.9805908203125  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.0392913818359375  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 928, 256])
m.shape torch.Size([762, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.04258918762207  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.04258918762207  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 762, 256]), torch.Size([1, 762, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.044042587280273  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.096914291381836  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 762, 256])
m.shape torch.Size([626, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.09979772567749  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.09979772567749  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 626, 256]), torch.Size([1, 626, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.100991725921631  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.152760982513428  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 626, 256])
m.shape torch.Size([515, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.1556291580200195  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.1556291580200195  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 515, 256]), torch.Size([1, 515, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.156611442565918  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.206499099731445  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 515, 256])
m.shape torch.Size([422, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.209847927093506  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.209847927093506  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 422, 256]), torch.Size([1, 422, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.210652828216553  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.256997585296631  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 422, 256])
m.shape torch.Size([347, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.260051727294922  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.260051727294922  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 347, 256]), torch.Size([1, 347, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.260713577270508  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.303071975708008  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 347, 256])
m.shape torch.Size([350, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.306105136871338  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.306105136871338  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 350, 256]), torch.Size([1, 350, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.306772708892822  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.3551812171936035  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 350, 256])
m.shape torch.Size([303, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.358051300048828  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.358051300048828  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.35862922668457  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.404862403869629  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([255, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.407514572143555  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.407514572143555  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.408000946044922  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.449342727661133  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([197, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.451561450958252  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.451561450958252  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.451937198638916  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.48650598526001  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([184, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.488794326782227  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.488794326782227  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.489145278930664  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.523889541625977  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([151, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.525891304016113  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.525891304016113  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.526179313659668  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.556708335876465  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([135, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.558640480041504  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.558640480041504  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.558897972106934  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.587994575500488  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([116, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.589761257171631  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.589761257171631  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.589982509613037  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.616532802581787  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([119, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.618584156036377  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.618584156036377  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.618811130523682  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.647636890411377  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([109, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.649514198303223  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.649514198303223  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.649722099304199  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.677580833435059  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([85, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.679111003875732  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.679111003875732  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.6792731285095215  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.702132701873779  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([80, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.703666687011719  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.703666687011719  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.703819274902344  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.726402282714844  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([66, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.727721691131592  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.727721691131592  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.727847576141357  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.747359752655029  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([75, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.748954772949219  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.748954772949219  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.74909782409668  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.772272109985352  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([64, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.773676872253418  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.773676872253418  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.773798942565918  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.794428825378418  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([1160, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.822240829467773  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.822240829467773  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 1160, 256]), torch.Size([1, 1160, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.824993133544922  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 5.224453926086426  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 1160, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 5.144459247589111  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 5.146389484405518  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 5.148083686828613  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 5.146068572998047  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

torch.Size([11368, 40])
input nodes number: 62761
output nodes number: 11368
edges number: 92218
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 5.14669942855835  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 5.146699905395508  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.08316230773925781  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

pseudo mini batch 7 input nodes size: 122725
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.07171297073364258  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.07171297073364258  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.1302328109741211  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.13031768798828125  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.0716390609741211  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.07631826400756836  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.07631826400756836  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.07631826400756836  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

torch.Size([122725, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.07631826400756836  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

m.shape torch.Size([3241, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.30710506439208984  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.30710506439208984  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3241, 128]), torch.Size([1, 3241, 128])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.3101959228515625  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.33579397201538086  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3241, 128])
m.shape torch.Size([3986, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.33804988861083984  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.33804988861083984  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3986, 128]), torch.Size([1, 3986, 128])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.34185123443603516  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.40054988861083984  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3986, 128])
m.shape torch.Size([4082, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.40435123443603516  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.40435123443603516  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 4082, 128]), torch.Size([1, 4082, 128])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.40824413299560547  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.4942007064819336  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 4082, 128])
m.shape torch.Size([3797, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.4994964599609375  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.4994964599609375  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3797, 128]), torch.Size([1, 3797, 128])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.5032534599304199  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.6095952987670898  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3797, 128])
m.shape torch.Size([3641, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.6164655685424805  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.6164655685424805  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3641, 128]), torch.Size([1, 3641, 128])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.6200122833251953  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.7461223602294922  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3641, 128])
m.shape torch.Size([3243, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.753664493560791  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.753664493560791  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 3243, 128]), torch.Size([1, 3243, 128])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.7569870948791504  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.8979611396789551  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 3243, 128])
m.shape torch.Size([2972, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.905360221862793  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.905360221862793  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 2972, 128]), torch.Size([1, 2972, 128])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.9082155227661133  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 1.0503935813903809  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 2972, 128])
m.shape torch.Size([2788, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 1.0596117973327637  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 1.0596117973327637  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 2788, 128]), torch.Size([1, 2788, 128])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 1.0622706413269043  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 1.2222285270690918  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 2788, 128])
m.shape torch.Size([2525, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 1.2317352294921875  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 1.2317352294921875  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 2525, 128]), torch.Size([1, 2525, 128])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 1.2341432571411133  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 1.3903932571411133  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 2525, 128])
m.shape torch.Size([32636, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 1.5454392433166504  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 1.5454392433166504  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 32636, 128]), torch.Size([1, 32636, 128])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 1.5765633583068848  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.7936768531799316  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 32636, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.58148193359375  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.6414785385131836  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.701475143432617  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.64100980758667  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

torch.Size([62911, 256])
first layer input nodes number: 122725
first layer output nodes number: 62911
edges number: 468503
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.7023916244506836  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.762388229370117  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.7773876190185547  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.7773876190185547  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

m.shape torch.Size([1719, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.8701953887939453  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.8701953887939453  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 1719, 256]), torch.Size([1, 1719, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.874042510986328  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.9014668464660645  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 1719, 256])
m.shape torch.Size([1453, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.903128147125244  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.903128147125244  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 1453, 256]), torch.Size([1, 1453, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.9060916900634766  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.9495811462402344  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 1453, 256])
m.shape torch.Size([1152, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.952190399169922  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.952190399169922  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 1152, 256]), torch.Size([1, 1152, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 3.95440673828125  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.00337028503418  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 1152, 256])
m.shape torch.Size([892, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.0062255859375  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.0062255859375  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 892, 256]), torch.Size([1, 892, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.007926940917969  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.064064025878906  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 892, 256])
m.shape torch.Size([789, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.067212104797363  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.067212104797363  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 789, 256]), torch.Size([1, 789, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.068717002868652  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.128649711608887  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 789, 256])
m.shape torch.Size([585, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.131270885467529  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.131270885467529  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 585, 256]), torch.Size([1, 585, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.132386684417725  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.180825710296631  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 585, 256])
m.shape torch.Size([495, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.1842041015625  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.1842041015625  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 495, 256]), torch.Size([1, 495, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.185148239135742  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.23371696472168  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 495, 256])
m.shape torch.Size([425, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.236513137817383  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.236513137817383  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 425, 256]), torch.Size([1, 425, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.237323760986328  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.28373908996582  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 425, 256])
m.shape torch.Size([362, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.286465167999268  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.286465167999268  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 362, 256]), torch.Size([1, 362, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.287155628204346  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.331639766693115  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 362, 256])
m.shape torch.Size([284, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.334024429321289  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.334024429321289  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.334566116333008  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.3736419677734375  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 284, 256])
m.shape torch.Size([286, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.376395225524902  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.376395225524902  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.376940727233887  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.419747352600098  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([244, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.42228889465332  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.42228889465332  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 244, 256]), torch.Size([1, 244, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.422754287719727  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.462312698364258  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 244, 256])
m.shape torch.Size([206, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.464655876159668  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.464655876159668  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.465048789978027  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.50119686126709  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([178, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.5033955574035645  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.5033955574035645  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.503735065460205  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.537346363067627  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([169, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.539613246917725  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.539613246917725  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.53993558883667  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.574103832244873  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([138, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.5760650634765625  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.5760650634765625  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.576328277587891  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.606071472167969  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([135, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.608145713806152  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.608145713806152  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.608403205871582  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.6393022537231445  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([142, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.641630172729492  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.641630172729492  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.641901016235352  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.676298141479492  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([97, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.677934169769287  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.677934169769287  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.67811918258667  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.702910900115967  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([106, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.7048563957214355  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.7048563957214355  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.705058574676514  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.733565807342529  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([89, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.7352614402771  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.7352614402771  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.73543119430542  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.760554790496826  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([69, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.761929035186768  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.761929035186768  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.762060642242432  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.782459735870361  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([66, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.783853054046631  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.783853054046631  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.7839789390563965  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.804372310638428  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([79, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.806131839752197  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.806131839752197  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.8062825202941895  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.831747531890869  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([1205, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.861193656921387  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes
Using backend: pytorch

----------------------------------------2
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.861193656921387  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

 h.shape torch.Size([1, 1205, 256]), torch.Size([1, 1205, 256])
----------------------------------------3
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 4.863492012023926  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 5.268975734710693  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

rst.shape  torch.Size([1, 1205, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 5.188450813293457  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 5.1901445388793945  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 5.191838264465332  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 5.190059661865234  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

torch.Size([11365, 40])
input nodes number: 62911
output nodes number: 11365
edges number: 93794
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 5.1903767585754395  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 5.190377235412598  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.0834197998046875  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.0834197998046875  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.0834197998046875  GigaBytes
Max Memory Allocated: 5.352947235107422  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04516494274139404 |0.004162013530731201 |0.13332965970039368 |9.59634780883789e-05 |0.0770120918750763 |0.004594087600708008 |
----------------------------------------------------------pseudo_mini_loss sum 3.073113203048706
Total (block generation + training)time/epoch 7.302561521530151
Training time/epoch 2.1447958946228027
Training time without block to device /epoch 2.111499786376953
Training time without total dataloading part /epoch 1.6880958080291748
load block tensor time/epoch 0.36131954193115234
block to device time/epoch 0.03329610824584961
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  1486658
Number of first layer input nodes during this epoch:  983755
Number of first layer output nodes during this epoch:  502903
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
