[04:43:00] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28871986 edges into 4 parts and get 1911744 edge cuts
main start at this time 1652848959.7724705
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

<class 'int'>
<class 'int'>
----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.022263288497924805
global_2_local spend time (sec) 0.03672337532043457
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004381895065307617
A = g.adjacency_matrix() spent  0.009303808212280273
auxiliary_graph
Graph(num_nodes=154611, num_edges=28962927,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0888063907623291
remove nodes length
63670
auxiliary_graph.remove_nodes spent  1.2830874919891357
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28962927,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1667661666870117

the counter of shared neighbor distribution
Counter({1.0: 23350590, 2.0: 4010844, 3.0: 1004314, 4.0: 300894, 5.0: 109354, 6.0: 47662, 7.0: 22182, 8.0: 11490, 9.0: 6150, 10.0: 3490, 11.0: 2010, 12.0: 1100, 13.0: 704, 14.0: 414, 15.0: 272, 16.0: 202, 17.0: 172, 18.0: 78, 19.0: 52, 21.0: 8, 20.0: 4})
28871986
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28871983, 28871984, 28871985])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23350590, 2.0: 4010844, 3.0: 1004314, 4.0: 300894, 5.0: 109354, 6.0: 47662, 7.0: 22182, 8.0: 11490, 9.0: 6150, 10.0: 3490, 11.0: 2010, 12.0: 1100, 13.0: 704, 14.0: 414, 15.0: 272, 16.0: 202, 17.0: 172, 18.0: 78, 19.0: 52, 21.0: 8, 20.0: 4})
Convert a graph into a bidirected graph: 1.253 seconds
Metis partitioning: 4.893 seconds
Split the graph: 3.722 seconds
Construct subgraphs: 0.149 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  10.030389547348022
23164
22658
22072
23047
total k batches seeds list generation spend  20.262823820114136
after graph partition
graph partition algorithm spend time 20.37292218208313
23164
22658
22072
23047
partition_len_list
[40108, 34877, 53031, 69363]
shared_neighbor_graph_partition_s0 selection method  spend 20.458329677581787
time for parepare:  0.016571760177612305
local_output_nid generation:  0.0027761459350585938
local_in_edges_tensor generation:  0.0035676956176757812
mini_batch_src_global generation:  0.005185127258300781
r_  generation:  0.06231212615966797
local_output_nid generation:  0.0036563873291015625
local_in_edges_tensor generation:  0.004118919372558594
mini_batch_src_global generation:  0.0070343017578125
r_  generation:  0.06291747093200684
local_output_nid generation:  0.00429534912109375
local_in_edges_tensor generation:  0.0072934627532958984
mini_batch_src_global generation:  0.005944013595581055
r_  generation:  0.05313849449157715
local_output_nid generation:  0.006511211395263672
local_in_edges_tensor generation:  0.00524139404296875
mini_batch_src_global generation:  0.009453535079956055
r_  generation:  0.09290313720703125
----------------------check_connections_block total spend ----------------------------- 0.4278249740600586
generate_one_block  0.07770037651062012
generate_one_block  0.07721114158630371
generate_one_block  0.06621050834655762
generate_one_block  0.1242058277130127
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028784751892089844
gen group dst list time:  0.005395650863647461
time for parepare:  0.0218045711517334
local_output_nid generation:  0.0058422088623046875
local_in_edges_tensor generation:  0.01528310775756836
mini_batch_src_global generation:  0.007905960083007812
r_  generation:  0.0836331844329834
local_output_nid generation:  0.007294416427612305
local_in_edges_tensor generation:  0.006008625030517578
mini_batch_src_global generation:  0.008113622665405273
r_  generation:  0.07579278945922852
local_output_nid generation:  0.011159181594848633
local_in_edges_tensor generation:  0.009937763214111328
mini_batch_src_global generation:  0.01126861572265625
r_  generation:  0.12868714332580566
local_output_nid generation:  0.011542320251464844
local_in_edges_tensor generation:  0.017158031463623047
mini_batch_src_global generation:  0.019084453582763672
r_  generation:  0.19217205047607422
----------------------check_connections_block total spend ----------------------------- 0.7437677383422852
generate_one_block  0.10712885856628418
generate_one_block  0.0910484790802002
generate_one_block  0.15334224700927734
generate_one_block  0.2511465549468994
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  1.1715927124023438
block generation total time  0.9479939937591553
average batch blocks generation time:  0.23699849843978882
pseudo mini batch 0 input nodes size: 61239
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0487060546875 GB
    Memory Allocated: 0.0320744514465332  GigaBytes
Max Memory Allocated: 0.0320744514465332  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0487060546875 GB
    Memory Allocated: 0.032247066497802734  GigaBytes
Max Memory Allocated: 0.032247066497802734  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0487060546875 GB
    Memory Allocated: 0.032247066497802734  GigaBytes
Max Memory Allocated: 0.032247066497802734  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1170654296875 GB
    Memory Allocated: 0.03513479232788086  GigaBytes
Max Memory Allocated: 0.03513479232788086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1170654296875 GB
    Memory Allocated: 0.03513479232788086  GigaBytes
Max Memory Allocated: 0.03513479232788086  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1170654296875 GB
    Memory Allocated: 0.03513479232788086  GigaBytes
Max Memory Allocated: 0.03513479232788086  GigaBytes

torch.Size([61239, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1170654296875 GB
    Memory Allocated: 0.03513479232788086  GigaBytes
Max Memory Allocated: 0.03513479232788086  GigaBytes

m.shape torch.Size([4885, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.15004396438598633  GigaBytes
Max Memory Allocated: 0.15091562271118164  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.15004396438598633  GigaBytes
Max Memory Allocated: 0.15091562271118164  GigaBytes

 h.shape torch.Size([1, 4885, 128]), torch.Size([1, 4885, 128])
----------------------------------------3
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.15470266342163086  GigaBytes
Max Memory Allocated: 0.15470266342163086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.19376516342163086  GigaBytes
Max Memory Allocated: 0.19609451293945312  GigaBytes

rst.shape  torch.Size([1, 4885, 128])
m.shape torch.Size([4989, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.19619369506835938  GigaBytes
Max Memory Allocated: 0.1963052749633789  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.19619369506835938  GigaBytes
Max Memory Allocated: 0.1963052749633789  GigaBytes

 h.shape torch.Size([1, 4989, 128]), torch.Size([1, 4989, 128])
----------------------------------------3
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.20095157623291016  GigaBytes
Max Memory Allocated: 0.20095157623291016  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.2745170593261719  GigaBytes
Max Memory Allocated: 0.27927494049072266  GigaBytes

rst.shape  torch.Size([1, 4989, 128])
m.shape torch.Size([4369, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4901123046875 GB
    Memory Allocated: 0.27788829803466797  GigaBytes
Max Memory Allocated: 0.27927494049072266  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4901123046875 GB
    Memory Allocated: 0.27788829803466797  GigaBytes
Max Memory Allocated: 0.27927494049072266  GigaBytes

 h.shape torch.Size([1, 4369, 128]), torch.Size([1, 4369, 128])
----------------------------------------3
 Nvidia-smi: 1.4901123046875 GB
    Memory Allocated: 0.2830467224121094  GigaBytes
Max Memory Allocated: 0.2830467224121094  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5877685546875 GB
    Memory Allocated: 0.3792247772216797  GigaBytes
Max Memory Allocated: 0.38547468185424805  GigaBytes

rst.shape  torch.Size([1, 4369, 128])
m.shape torch.Size([3575, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5877685546875 GB
    Memory Allocated: 0.3831787109375  GigaBytes
Max Memory Allocated: 0.38547468185424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5877685546875 GB
    Memory Allocated: 0.3831787109375  GigaBytes
Max Memory Allocated: 0.38547468185424805  GigaBytes

 h.shape torch.Size([1, 3575, 128]), torch.Size([1, 3575, 128])
----------------------------------------3
 Nvidia-smi: 1.5877685546875 GB
    Memory Allocated: 0.38658809661865234  GigaBytes
Max Memory Allocated: 0.38658809661865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7049560546875 GB
    Memory Allocated: 0.48779916763305664  GigaBytes
Max Memory Allocated: 0.49461793899536133  GigaBytes

rst.shape  torch.Size([1, 3575, 128])
m.shape torch.Size([3028, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.7244873046875 GB
    Memory Allocated: 0.49253416061401367  GigaBytes
Max Memory Allocated: 0.49461793899536133  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7244873046875 GB
    Memory Allocated: 0.49253416061401367  GigaBytes
Max Memory Allocated: 0.49461793899536133  GigaBytes

 h.shape torch.Size([1, 3028, 128]), torch.Size([1, 3028, 128])
----------------------------------------3
 Nvidia-smi: 1.7244873046875 GB
    Memory Allocated: 0.4954218864440918  GigaBytes
Max Memory Allocated: 0.4954218864440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8026123046875 GB
    Memory Allocated: 0.6035399436950684  GigaBytes
Max Memory Allocated: 0.6107592582702637  GigaBytes

rst.shape  torch.Size([1, 3028, 128])
m.shape torch.Size([2491, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.8026123046875 GB
    Memory Allocated: 0.6092228889465332  GigaBytes
Max Memory Allocated: 0.6107592582702637  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8026123046875 GB
    Memory Allocated: 0.6092228889465332  GigaBytes
Max Memory Allocated: 0.6107592582702637  GigaBytes

 h.shape torch.Size([1, 2491, 128]), torch.Size([1, 2491, 128])
----------------------------------------3
 Nvidia-smi: 1.8026123046875 GB
    Memory Allocated: 0.612060546875  GigaBytes
Max Memory Allocated: 0.612060546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.7168436050415039  GigaBytes
Max Memory Allocated: 0.7239704132080078  GigaBytes

rst.shape  torch.Size([1, 2491, 128])
m.shape torch.Size([2120, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.7227320671081543  GigaBytes
Max Memory Allocated: 0.7239704132080078  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.7227320671081543  GigaBytes
Max Memory Allocated: 0.7239704132080078  GigaBytes

 h.shape torch.Size([1, 2120, 128]), torch.Size([1, 2120, 128])
----------------------------------------3
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.724815845489502  GigaBytes
Max Memory Allocated: 0.724815845489502  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0369873046875 GB
    Memory Allocated: 0.8279514312744141  GigaBytes
Max Memory Allocated: 0.8350276947021484  GigaBytes

rst.shape  torch.Size([1, 2120, 128])
m.shape torch.Size([1862, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.0369873046875 GB
    Memory Allocated: 0.8340435028076172  GigaBytes
Max Memory Allocated: 0.8350276947021484  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0369873046875 GB
    Memory Allocated: 0.8340435028076172  GigaBytes
Max Memory Allocated: 0.8350276947021484  GigaBytes

 h.shape torch.Size([1, 1862, 128]), torch.Size([1, 1862, 128])
----------------------------------------3
 Nvidia-smi: 2.0389404296875 GB
    Memory Allocated: 0.8358192443847656  GigaBytes
Max Memory Allocated: 0.8358192443847656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.9370365142822266  GigaBytes
Max Memory Allocated: 0.9441394805908203  GigaBytes

rst.shape  torch.Size([1, 1862, 128])
m.shape torch.Size([1571, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.9428906440734863  GigaBytes
Max Memory Allocated: 0.9441394805908203  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.9428906440734863  GigaBytes
Max Memory Allocated: 0.9441394805908203  GigaBytes

 h.shape torch.Size([1, 1571, 128]), torch.Size([1, 1571, 128])
----------------------------------------3
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.9443888664245605  GigaBytes
Max Memory Allocated: 0.9443888664245605  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 1.040884017944336  GigaBytes
Max Memory Allocated: 1.04762601852417  GigaBytes

rst.shape  torch.Size([1, 1571, 128])
m.shape torch.Size([11218, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 1.0936264991760254  GigaBytes
Max Memory Allocated: 1.0948805809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 1.0936264991760254  GigaBytes
Max Memory Allocated: 1.0948805809020996  GigaBytes

 h.shape torch.Size([1, 5609, 128]), torch.Size([1, 5609, 128])
----------------------------------------3
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 1.098975658416748  GigaBytes
Max Memory Allocated: 1.098975658416748  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7615966796875 GB
    Memory Allocated: 1.4844303131103516  GigaBytes
Max Memory Allocated: 1.5117740631103516  GigaBytes

rst 0 shape torch.Size([1, 5609, 128])
----------------------------------------1
 Nvidia-smi: 2.7615966796875 GB
    Memory Allocated: 1.4844303131103516  GigaBytes
Max Memory Allocated: 1.5117740631103516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7615966796875 GB
    Memory Allocated: 1.4844303131103516  GigaBytes
Max Memory Allocated: 1.5117740631103516  GigaBytes

 h.shape torch.Size([1, 5609, 128]), torch.Size([1, 5609, 128])
----------------------------------------3
 Nvidia-smi: 2.7615966796875 GB
    Memory Allocated: 1.4897794723510742  GigaBytes
Max Memory Allocated: 1.5117740631103516  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1756591796875 GB
    Memory Allocated: 1.8723483085632324  GigaBytes
Max Memory Allocated: 1.9023666381835938  GigaBytes

rst 1 shape torch.Size([1, 5609, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2147216796875 GB
    Memory Allocated: 1.7779898643493652  GigaBytes
Max Memory Allocated: 1.9280924797058105  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2147216796875 GB
    Memory Allocated: 1.816239833831787  GigaBytes
Max Memory Allocated: 1.9280924797058105  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2537841796875 GB
    Memory Allocated: 1.855302333831787  GigaBytes
Max Memory Allocated: 1.9280924797058105  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2537841796875 GB
    Memory Allocated: 1.8167533874511719  GigaBytes
Max Memory Allocated: 1.9280924797058105  GigaBytes

torch.Size([40108, 256])
first layer input nodes number: 61239
first layer output nodes number: 40108
edges number: 228411
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2537841796875 GB
    Memory Allocated: 1.8557605743408203  GigaBytes
Max Memory Allocated: 1.9280924797058105  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2537841796875 GB
    Memory Allocated: 1.8940105438232422  GigaBytes
Max Memory Allocated: 1.9280924797058105  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2928466796875 GB
    Memory Allocated: 1.9043855667114258  GigaBytes
Max Memory Allocated: 1.9426355361938477  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2928466796875 GB
    Memory Allocated: 1.9043855667114258  GigaBytes
Max Memory Allocated: 1.9426355361938477  GigaBytes

m.shape torch.Size([3588, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4451904296875 GB
    Memory Allocated: 2.0622434616088867  GigaBytes
Max Memory Allocated: 2.0622572898864746  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4451904296875 GB
    Memory Allocated: 2.0622434616088867  GigaBytes
Max Memory Allocated: 2.0622572898864746  GigaBytes

 h.shape torch.Size([1, 3588, 256]), torch.Size([1, 3588, 256])
----------------------------------------3
 Nvidia-smi: 3.4451904296875 GB
    Memory Allocated: 2.069087028503418  GigaBytes
Max Memory Allocated: 2.069087028503418  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4451904296875 GB
    Memory Allocated: 2.123835563659668  GigaBytes
Max Memory Allocated: 2.1272573471069336  GigaBytes

rst.shape  torch.Size([1, 3588, 256])
m.shape torch.Size([3281, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4451904296875 GB
    Memory Allocated: 2.127009868621826  GigaBytes
Max Memory Allocated: 2.1272573471069336  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4451904296875 GB
    Memory Allocated: 2.127009868621826  GigaBytes
Max Memory Allocated: 2.1272573471069336  GigaBytes

 h.shape torch.Size([1, 3281, 256]), torch.Size([1, 3281, 256])
----------------------------------------3
 Nvidia-smi: 3.4451904296875 GB
    Memory Allocated: 2.1335606575012207  GigaBytes
Max Memory Allocated: 2.1335606575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 2.2281880378723145  GigaBytes
Max Memory Allocated: 2.2344460487365723  GigaBytes

rst.shape  torch.Size([1, 3281, 256])
m.shape torch.Size([2644, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 2.232682704925537  GigaBytes
Max Memory Allocated: 2.2344460487365723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 2.232682704925537  GigaBytes
Max Memory Allocated: 2.2344460487365723  GigaBytes

 h.shape torch.Size([1, 2644, 256]), torch.Size([1, 2644, 256])
----------------------------------------3
 Nvidia-smi: 3.5389404296875 GB
    Memory Allocated: 2.2377257347106934  GigaBytes
Max Memory Allocated: 2.2377257347106934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 2.348672389984131  GigaBytes
Max Memory Allocated: 2.3562369346618652  GigaBytes

rst.shape  torch.Size([1, 2644, 256])
m.shape torch.Size([2101, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 2.3542284965515137  GigaBytes
Max Memory Allocated: 2.3562369346618652  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 2.3542284965515137  GigaBytes
Max Memory Allocated: 2.3562369346618652  GigaBytes

 h.shape torch.Size([1, 2101, 256]), torch.Size([1, 2101, 256])
----------------------------------------3
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 2.3583831787109375  GigaBytes
Max Memory Allocated: 2.3583831787109375  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 2.476743698120117  GigaBytes
Max Memory Allocated: 2.4847583770751953  GigaBytes

rst.shape  torch.Size([1, 2101, 256])
m.shape torch.Size([1741, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 2.483107089996338  GigaBytes
Max Memory Allocated: 2.4847583770751953  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 2.483107089996338  GigaBytes
Max Memory Allocated: 2.4847583770751953  GigaBytes

 h.shape torch.Size([1, 1741, 256]), torch.Size([1, 1741, 256])
----------------------------------------3
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 2.4865856170654297  GigaBytes
Max Memory Allocated: 2.4865856170654297  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9530029296875 GB
    Memory Allocated: 2.608069896697998  GigaBytes
Max Memory Allocated: 2.6163716316223145  GigaBytes

rst.shape  torch.Size([1, 1741, 256])
m.shape torch.Size([1347, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9530029296875 GB
    Memory Allocated: 2.614177703857422  GigaBytes
Max Memory Allocated: 2.6163716316223145  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9530029296875 GB
    Memory Allocated: 2.614177703857422  GigaBytes
Max Memory Allocated: 2.6163716316223145  GigaBytes

 h.shape torch.Size([1, 1347, 256]), torch.Size([1, 1347, 256])
----------------------------------------3
 Nvidia-smi: 3.9530029296875 GB
    Memory Allocated: 2.617051124572754  GigaBytes
Max Memory Allocated: 2.617051124572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0311279296875 GB
    Memory Allocated: 2.731832504272461  GigaBytes
Max Memory Allocated: 2.7395401000976562  GigaBytes

rst.shape  torch.Size([1, 1347, 256])
m.shape torch.Size([1146, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0311279296875 GB
    Memory Allocated: 2.737910270690918  GigaBytes
Max Memory Allocated: 2.7395401000976562  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0311279296875 GB
    Memory Allocated: 2.737910270690918  GigaBytes
Max Memory Allocated: 2.7395401000976562  GigaBytes

 h.shape torch.Size([1, 1146, 256]), torch.Size([1, 1146, 256])
----------------------------------------3
 Nvidia-smi: 4.0311279296875 GB
    Memory Allocated: 2.7401304244995117  GigaBytes
Max Memory Allocated: 2.7401304244995117  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1287841796875 GB
    Memory Allocated: 2.854520320892334  GigaBytes
Max Memory Allocated: 2.862170696258545  GigaBytes

rst.shape  torch.Size([1, 1146, 256])
m.shape torch.Size([986, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.1287841796875 GB
    Memory Allocated: 2.8600573539733887  GigaBytes
Max Memory Allocated: 2.862170696258545  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1287841796875 GB
    Memory Allocated: 2.8600573539733887  GigaBytes
Max Memory Allocated: 2.862170696258545  GigaBytes

 h.shape torch.Size([1, 986, 256]), torch.Size([1, 986, 256])
----------------------------------------3
 Nvidia-smi: 4.1287841796875 GB
    Memory Allocated: 2.861937999725342  GigaBytes
Max Memory Allocated: 2.862170696258545  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2440185546875 GB
    Memory Allocated: 2.9730982780456543  GigaBytes
Max Memory Allocated: 2.980620861053467  GigaBytes

rst.shape  torch.Size([1, 986, 256])
m.shape torch.Size([803, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.2440185546875 GB
    Memory Allocated: 2.9791040420532227  GigaBytes
Max Memory Allocated: 2.980620861053467  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2440185546875 GB
    Memory Allocated: 2.9791040420532227  GigaBytes
Max Memory Allocated: 2.980620861053467  GigaBytes

 h.shape torch.Size([1, 803, 256]), torch.Size([1, 803, 256])
----------------------------------------3
 Nvidia-smi: 4.2440185546875 GB
    Memory Allocated: 2.980635643005371  GigaBytes
Max Memory Allocated: 2.980635643005371  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3416748046875 GB
    Memory Allocated: 3.0798120498657227  GigaBytes
Max Memory Allocated: 3.0867042541503906  GigaBytes

rst.shape  torch.Size([1, 803, 256])
m.shape torch.Size([691, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.3416748046875 GB
    Memory Allocated: 3.0856876373291016  GigaBytes
Max Memory Allocated: 3.0867042541503906  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3416748046875 GB
    Memory Allocated: 3.0856876373291016  GigaBytes
Max Memory Allocated: 3.0867042541503906  GigaBytes

 h.shape torch.Size([1, 691, 256]), torch.Size([1, 691, 256])
----------------------------------------3
 Nvidia-smi: 4.3436279296875 GB
    Memory Allocated: 3.087005615234375  GigaBytes
Max Memory Allocated: 3.087005615234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4627685546875 GB
    Memory Allocated: 3.180697441101074  GigaBytes
Max Memory Allocated: 3.1872873306274414  GigaBytes

rst.shape  torch.Size([1, 691, 256])
m.shape torch.Size([562, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4627685546875 GB
    Memory Allocated: 3.1859803199768066  GigaBytes
Max Memory Allocated: 3.1872873306274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4627685546875 GB
    Memory Allocated: 3.1859803199768066  GigaBytes
Max Memory Allocated: 3.1872873306274414  GigaBytes

 h.shape torch.Size([1, 562, 256]), torch.Size([1, 562, 256])
----------------------------------------3
 Nvidia-smi: 4.4627685546875 GB
    Memory Allocated: 3.1870522499084473  GigaBytes
Max Memory Allocated: 3.1872873306274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5487060546875 GB
    Memory Allocated: 3.2721447944641113  GigaBytes
Max Memory Allocated: 3.2780404090881348  GigaBytes

rst.shape  torch.Size([1, 562, 256])
m.shape torch.Size([492, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5487060546875 GB
    Memory Allocated: 3.2772836685180664  GigaBytes
Max Memory Allocated: 3.2780404090881348  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5487060546875 GB
    Memory Allocated: 3.2772836685180664  GigaBytes
Max Memory Allocated: 3.2780404090881348  GigaBytes

 h.shape torch.Size([1, 492, 256]), torch.Size([1, 492, 256])
----------------------------------------3
 Nvidia-smi: 4.5487060546875 GB
    Memory Allocated: 3.27822208404541  GigaBytes
Max Memory Allocated: 3.27822208404541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6405029296875 GB
    Memory Allocated: 3.3604440689086914  GigaBytes
Max Memory Allocated: 3.366074562072754  GigaBytes

rst.shape  torch.Size([1, 492, 256])
m.shape torch.Size([409, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.6405029296875 GB
    Memory Allocated: 3.3650856018066406  GigaBytes
Max Memory Allocated: 3.366074562072754  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6405029296875 GB
    Memory Allocated: 3.3650856018066406  GigaBytes
Max Memory Allocated: 3.366074562072754  GigaBytes

 h.shape torch.Size([1, 409, 256]), torch.Size([1, 409, 256])
----------------------------------------3
 Nvidia-smi: 4.6405029296875 GB
    Memory Allocated: 3.365865707397461  GigaBytes
Max Memory Allocated: 3.366074562072754  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7030029296875 GB
    Memory Allocated: 3.439671516418457  GigaBytes
Max Memory Allocated: 3.444742202758789  GigaBytes

rst.shape  torch.Size([1, 409, 256])
m.shape torch.Size([371, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.7030029296875 GB
    Memory Allocated: 3.4442739486694336  GigaBytes
Max Memory Allocated: 3.444742202758789  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7030029296875 GB
    Memory Allocated: 3.4442739486694336  GigaBytes
Max Memory Allocated: 3.444742202758789  GigaBytes

 h.shape torch.Size([1, 371, 256]), torch.Size([1, 371, 256])
----------------------------------------3
 Nvidia-smi: 4.7030029296875 GB
    Memory Allocated: 3.444981575012207  GigaBytes
Max Memory Allocated: 3.444981575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7928466796875 GB
    Memory Allocated: 3.5150365829467773  GigaBytes
Max Memory Allocated: 3.5199899673461914  GigaBytes

rst.shape  torch.Size([1, 371, 256])
m.shape torch.Size([353, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.7928466796875 GB
    Memory Allocated: 3.5197720527648926  GigaBytes
Max Memory Allocated: 3.5199899673461914  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7928466796875 GB
    Memory Allocated: 3.5197720527648926  GigaBytes
Max Memory Allocated: 3.5199899673461914  GigaBytes

 h.shape torch.Size([1, 353, 256]), torch.Size([1, 353, 256])
----------------------------------------3
 Nvidia-smi: 4.7928466796875 GB
    Memory Allocated: 3.5204453468322754  GigaBytes
Max Memory Allocated: 3.5204453468322754  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8631591796875 GB
    Memory Allocated: 3.593222141265869  GigaBytes
Max Memory Allocated: 3.5982718467712402  GigaBytes

rst.shape  torch.Size([1, 353, 256])
m.shape torch.Size([246, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.8631591796875 GB
    Memory Allocated: 3.5966687202453613  GigaBytes
Max Memory Allocated: 3.5982718467712402  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8631591796875 GB
    Memory Allocated: 3.5966687202453613  GigaBytes
Max Memory Allocated: 3.5982718467712402  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 4.8631591796875 GB
    Memory Allocated: 3.597137928009033  GigaBytes
Max Memory Allocated: 3.5982718467712402  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9158935546875 GB
    Memory Allocated: 3.650158405303955  GigaBytes
Max Memory Allocated: 3.65391206741333  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([221, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9158935546875 GB
    Memory Allocated: 3.6535348892211914  GigaBytes
Max Memory Allocated: 3.65391206741333  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9158935546875 GB
    Memory Allocated: 3.6535348892211914  GigaBytes
Max Memory Allocated: 3.65391206741333  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 4.9158935546875 GB
    Memory Allocated: 3.653956413269043  GigaBytes
Max Memory Allocated: 3.653956413269043  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9686279296875 GB
    Memory Allocated: 3.7045392990112305  GigaBytes
Max Memory Allocated: 3.7081222534179688  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([199, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9686279296875 GB
    Memory Allocated: 3.7077713012695312  GigaBytes
Max Memory Allocated: 3.7081222534179688  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9686279296875 GB
    Memory Allocated: 3.7077713012695312  GigaBytes
Max Memory Allocated: 3.7081222534179688  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 4.9686279296875 GB
    Memory Allocated: 3.708150863647461  GigaBytes
Max Memory Allocated: 3.708150863647461  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0408935546875 GB
    Memory Allocated: 3.7563552856445312  GigaBytes
Max Memory Allocated: 3.7597713470458984  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([178, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0408935546875 GB
    Memory Allocated: 3.759582996368408  GigaBytes
Max Memory Allocated: 3.7597713470458984  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0408935546875 GB
    Memory Allocated: 3.759582996368408  GigaBytes
Max Memory Allocated: 3.7597713470458984  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 5.0408935546875 GB
    Memory Allocated: 3.759922504425049  GigaBytes
Max Memory Allocated: 3.759922504425049  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0955810546875 GB
    Memory Allocated: 3.8054165840148926  GigaBytes
Max Memory Allocated: 3.8086419105529785  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([145, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0955810546875 GB
    Memory Allocated: 3.8080344200134277  GigaBytes
Max Memory Allocated: 3.8086419105529785  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0955810546875 GB
    Memory Allocated: 3.8080344200134277  GigaBytes
Max Memory Allocated: 3.8086419105529785  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 5.0955810546875 GB
    Memory Allocated: 3.8083109855651855  GigaBytes
Max Memory Allocated: 3.8086419105529785  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1229248046875 GB
    Memory Allocated: 3.847306728363037  GigaBytes
Max Memory Allocated: 3.8500723838806152  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([131, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.1229248046875 GB
    Memory Allocated: 3.8498125076293945  GigaBytes
Max Memory Allocated: 3.8500723838806152  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1229248046875 GB
    Memory Allocated: 3.8498125076293945  GigaBytes
Max Memory Allocated: 3.8500723838806152  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 5.1229248046875 GB
    Memory Allocated: 3.850062370300293  GigaBytes
Max Memory Allocated: 3.8500723838806152  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1639404296875 GB
    Memory Allocated: 3.8870420455932617  GigaBytes
Max Memory Allocated: 3.8896656036376953  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([120, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.1639404296875 GB
    Memory Allocated: 3.8894548416137695  GigaBytes
Max Memory Allocated: 3.8896656036376953  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1639404296875 GB
    Memory Allocated: 3.8894548416137695  GigaBytes
Max Memory Allocated: 3.8896656036376953  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 5.1639404296875 GB
    Memory Allocated: 3.889683723449707  GigaBytes
Max Memory Allocated: 3.889683723449707  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1971435546875 GB
    Memory Allocated: 3.9251604080200195  GigaBytes
Max Memory Allocated: 3.927678108215332  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([111, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.1971435546875 GB
    Memory Allocated: 3.927499771118164  GigaBytes
Max Memory Allocated: 3.927678108215332  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1971435546875 GB
    Memory Allocated: 3.927499771118164  GigaBytes
Max Memory Allocated: 3.927678108215332  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 5.1971435546875 GB
    Memory Allocated: 3.9277114868164062  GigaBytes
Max Memory Allocated: 3.9277114868164062  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2322998046875 GB
    Memory Allocated: 3.9620094299316406  GigaBytes
Max Memory Allocated: 3.964444160461426  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([94, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.2322998046875 GB
    Memory Allocated: 3.9640722274780273  GigaBytes
Max Memory Allocated: 3.964444160461426  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2322998046875 GB
    Memory Allocated: 3.9640722274780273  GigaBytes
Max Memory Allocated: 3.964444160461426  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 5.2322998046875 GB
    Memory Allocated: 3.9642515182495117  GigaBytes
Max Memory Allocated: 3.964444160461426  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2615966796875 GB
    Memory Allocated: 3.994551658630371  GigaBytes
Max Memory Allocated: 3.9967031478881836  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([1204, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.2908935546875 GB
    Memory Allocated: 4.023983478546143  GigaBytes
Max Memory Allocated: 4.0240960121154785  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2908935546875 GB
    Memory Allocated: 4.023983478546143  GigaBytes
Max Memory Allocated: 4.0240960121154785  GigaBytes

 h.shape torch.Size([1, 1204, 256]), torch.Size([1, 1204, 256])
----------------------------------------3
 Nvidia-smi: 5.2908935546875 GB
    Memory Allocated: 4.02628755569458  GigaBytes
Max Memory Allocated: 4.02628755569458  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7303466796875 GB
    Memory Allocated: 4.4310784339904785  GigaBytes
Max Memory Allocated: 4.4603753089904785  GigaBytes

rst.shape  torch.Size([1, 1204, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7772216796875 GB
    Memory Allocated: 4.296963214874268  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7772216796875 GB
    Memory Allocated: 4.300465106964111  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7772216796875 GB
    Memory Allocated: 4.303916931152344  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7772216796875 GB
    Memory Allocated: 4.3002424240112305  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

torch.Size([23164, 40])
input nodes number: 40108
output nodes number: 23164
edges number: 159069
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7772216796875 GB
    Memory Allocated: 4.304215908050537  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7772216796875 GB
    Memory Allocated: 4.3042168617248535  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.047098636627197266  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

pseudo mini batch 1 input nodes size: 48993
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.03852510452270508  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.03852510452270508  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.06196260452270508  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.06213188171386719  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.032662391662597656  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.035567283630371094  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.035567283630371094  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.035567283630371094  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

torch.Size([48993, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.035567283630371094  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

m.shape torch.Size([3962, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.1398625373840332  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.1398625373840332  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

 h.shape torch.Size([1, 3962, 128]), torch.Size([1, 3962, 128])
----------------------------------------3
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.14364099502563477  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.1746354103088379  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

rst.shape  torch.Size([1, 3962, 128])
m.shape torch.Size([3910, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.17652463912963867  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.17652463912963867  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

 h.shape torch.Size([1, 3910, 128]), torch.Size([1, 3910, 128])
----------------------------------------3
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.18066167831420898  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.23809385299682617  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

rst.shape  torch.Size([1, 3910, 128])
m.shape torch.Size([3509, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.24071693420410156  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.24071693420410156  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

 h.shape torch.Size([1, 3509, 128]), torch.Size([1, 3509, 128])
----------------------------------------3
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.24551010131835938  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.3218817710876465  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

rst.shape  torch.Size([1, 3509, 128])
m.shape torch.Size([2947, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.32582950592041016  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.32582950592041016  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

 h.shape torch.Size([1, 2947, 128]), torch.Size([1, 2947, 128])
----------------------------------------3
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.32918214797973633  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.41597747802734375  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

rst.shape  torch.Size([1, 2947, 128])
m.shape torch.Size([2519, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.4198598861694336  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.4198598861694336  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

 h.shape torch.Size([1, 2519, 128]), torch.Size([1, 2519, 128])
----------------------------------------3
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.42226219177246094  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.5148763656616211  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

rst.shape  torch.Size([1, 2519, 128])
m.shape torch.Size([2100, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.5205893516540527  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.5205893516540527  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

 h.shape torch.Size([1, 2100, 128]), torch.Size([1, 2100, 128])
----------------------------------------3
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.5228047370910645  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.6117367744445801  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

rst.shape  torch.Size([1, 2100, 128])
m.shape torch.Size([1791, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.6167135238647461  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.6167135238647461  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

 h.shape torch.Size([1, 1791, 128]), torch.Size([1, 1791, 128])
----------------------------------------3
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.6184215545654297  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.7049903869628906  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

rst.shape  torch.Size([1, 1791, 128])
m.shape torch.Size([1554, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.7100644111633301  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.7100644111633301  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

 h.shape torch.Size([1, 1554, 128]), torch.Size([1, 1554, 128])
----------------------------------------3
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.7115464210510254  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.7960209846496582  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

rst.shape  torch.Size([1, 1554, 128])
m.shape torch.Size([1353, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.80108642578125  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.80108642578125  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

 h.shape torch.Size([1, 1353, 128]), torch.Size([1, 1353, 128])
----------------------------------------3
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.8023767471313477  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.8875017166137695  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

rst.shape  torch.Size([1, 1353, 128])
m.shape torch.Size([11232, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.9404149055480957  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.9404149055480957  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

 h.shape torch.Size([1, 5616, 128]), torch.Size([1, 5616, 128])
----------------------------------------3
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 0.9457707405090332  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 1.3307499885559082  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

rst 0 shape torch.Size([1, 5616, 128])
----------------------------------------1
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 1.3307499885559082  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 1.3307499885559082  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

 h.shape torch.Size([1, 5616, 128]), torch.Size([1, 5616, 128])
----------------------------------------3
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 1.3368916511535645  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 1.7199788093566895  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

rst 1 shape torch.Size([1, 5616, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 1.6328225135803223  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 1.666083812713623  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 1.6993451118469238  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 1.6658239364624023  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

torch.Size([34877, 256])
first layer input nodes number: 48993
first layer output nodes number: 34877
edges number: 208758
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 1.6997122764587402  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 1.732973575592041  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 1.741793155670166  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0897216796875 GB
    Memory Allocated: 1.741793155670166  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

m.shape torch.Size([3093, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 1.9204368591308594  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 1.9204368591308594  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

 h.shape torch.Size([1, 3093, 256]), torch.Size([1, 3093, 256])
----------------------------------------3
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 1.9263362884521484  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 1.973531723022461  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

rst.shape  torch.Size([1, 3093, 256])
m.shape torch.Size([2764, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 1.9758954048156738  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 1.9758954048156738  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

 h.shape torch.Size([1, 2764, 256]), torch.Size([1, 2764, 256])
----------------------------------------3
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 1.9816474914550781  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 2.062814235687256  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

rst.shape  torch.Size([1, 2764, 256])
m.shape torch.Size([2321, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 2.0659589767456055  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 2.0659589767456055  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

 h.shape torch.Size([1, 2321, 256]), torch.Size([1, 2321, 256])
----------------------------------------3
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 2.0706043243408203  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 2.1702442169189453  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

rst.shape  torch.Size([1, 2321, 256])
m.shape torch.Size([1897, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 2.175323963165283  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 2.175323963165283  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

 h.shape torch.Size([1, 1897, 256]), torch.Size([1, 1897, 256])
----------------------------------------3
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 2.178955554962158  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 2.2862448692321777  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

rst.shape  torch.Size([1, 1897, 256])
m.shape torch.Size([1575, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 2.2920050621032715  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 2.2920050621032715  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

 h.shape torch.Size([1, 1575, 256]), torch.Size([1, 1575, 256])
----------------------------------------3
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 2.2951712608337402  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 2.4043807983398438  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

rst.shape  torch.Size([1, 1575, 256])
m.shape torch.Size([1293, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 2.41025447845459  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 2.41025447845459  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

 h.shape torch.Size([1, 1293, 256]), torch.Size([1, 1293, 256])
----------------------------------------3
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 2.412898063659668  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 2.5228095054626465  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

rst.shape  torch.Size([1, 1293, 256])
m.shape torch.Size([1091, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 2.528916835784912  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 2.528916835784912  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

 h.shape torch.Size([1, 1091, 256]), torch.Size([1, 1091, 256])
----------------------------------------3
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 2.531123638153076  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 2.641056537628174  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

rst.shape  torch.Size([1, 1091, 256])
m.shape torch.Size([925, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 2.6471285820007324  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 2.6471285820007324  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

 h.shape torch.Size([1, 925, 256]), torch.Size([1, 925, 256])
----------------------------------------3
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 2.648892879486084  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 2.7534022331237793  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

rst.shape  torch.Size([1, 925, 256])
m.shape torch.Size([815, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 2.7595701217651367  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 2.7595701217651367  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

 h.shape torch.Size([1, 815, 256]), torch.Size([1, 815, 256])
----------------------------------------3
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 2.761124610900879  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 2.863344192504883  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

rst.shape  torch.Size([1, 815, 256])
m.shape torch.Size([739, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 2.8696699142456055  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 2.8696699142456055  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

 h.shape torch.Size([1, 739, 256]), torch.Size([1, 739, 256])
----------------------------------------3
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 2.871079444885254  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 2.971480369567871  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

rst.shape  torch.Size([1, 739, 256])
m.shape torch.Size([654, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 2.9776902198791504  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 2.9776902198791504  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

 h.shape torch.Size([1, 654, 256]), torch.Size([1, 654, 256])
----------------------------------------3
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 2.9789376258850098  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.078817844390869  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

rst.shape  torch.Size([1, 654, 256])
m.shape torch.Size([530, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.0843071937561035  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.0843071937561035  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

 h.shape torch.Size([1, 530, 256]), torch.Size([1, 530, 256])
----------------------------------------3
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.085318088531494  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.1714024543762207  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

rst.shape  torch.Size([1, 530, 256])
m.shape torch.Size([472, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.1767945289611816  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.1767945289611816  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

 h.shape torch.Size([1, 472, 256]), torch.Size([1, 472, 256])
----------------------------------------3
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.177694797515869  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.2607827186584473  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

rst.shape  torch.Size([1, 472, 256])
m.shape torch.Size([422, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.2660112380981445  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.2660112380981445  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

 h.shape torch.Size([1, 422, 256]), torch.Size([1, 422, 256])
----------------------------------------3
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.2668161392211914  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.347226142883301  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

rst.shape  torch.Size([1, 422, 256])
m.shape torch.Size([342, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.351754665374756  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.351754665374756  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

 h.shape torch.Size([1, 342, 256]), torch.Size([1, 342, 256])
----------------------------------------3
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.3524069786071777  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.4230990409851074  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

rst.shape  torch.Size([1, 342, 256])
m.shape torch.Size([310, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.4275403022766113  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.4275403022766113  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

 h.shape torch.Size([1, 310, 256]), torch.Size([1, 310, 256])
----------------------------------------3
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.428131580352783  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.497053623199463  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

rst.shape  torch.Size([1, 310, 256])
m.shape torch.Size([321, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.5020031929016113  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.5020031929016113  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.502615451812744  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.576180934906006  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

rst.shape  torch.Size([1, 321, 256])
m.shape torch.Size([253, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.580252170562744  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.580252170562744  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.5807347297668457  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.642019748687744  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([212, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.6456499099731445  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.6456499099731445  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.646054267883301  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.7002382278442383  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([246, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.7052969932556152  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.7052969932556152  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.705766201019287  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.7719244956970215  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([211, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.775949001312256  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.775949001312256  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.7763514518737793  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.835914134979248  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([146, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.8388004302978516  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.8388004302978516  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.839078903198242  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.882242202758789  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([141, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.8852200508117676  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.8852200508117676  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.885488986968994  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.9290566444396973  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([140, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.9321517944335938  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.9321517944335938  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 6.2635498046875 GB
    Memory Allocated: 3.9324188232421875  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3084716796875 GB
    Memory Allocated: 3.9775466918945312  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([1745, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.3084716796875 GB
    Memory Allocated: 4.019342422485352  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3084716796875 GB
    Memory Allocated: 4.019342422485352  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

 h.shape torch.Size([1, 1745, 256]), torch.Size([1, 1745, 256])
----------------------------------------3
 Nvidia-smi: 6.3084716796875 GB
    Memory Allocated: 4.022670745849609  GigaBytes
Max Memory Allocated: 4.496292591094971  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3084716796875 GB
    Memory Allocated: 4.61176872253418  GigaBytes
Max Memory Allocated: 4.653372764587402  GigaBytes

rst.shape  torch.Size([1, 1745, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.3084716796875 GB
    Memory Allocated: 4.455198764801025  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.3084716796875 GB
    Memory Allocated: 4.458746433258057  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.3084716796875 GB
    Memory Allocated: 4.462122917175293  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.3084716796875 GB
    Memory Allocated: 4.4584059715271  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

torch.Size([22658, 40])
input nodes number: 34877
output nodes number: 22658
edges number: 181085
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.3084716796875 GB
    Memory Allocated: 4.45888090133667  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.3084716796875 GB
    Memory Allocated: 4.458881378173828  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.6600341796875 GB
    Memory Allocated: 0.04126691818237305  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

pseudo mini batch 2 input nodes size: 93958
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.6600341796875 GB
    Memory Allocated: 0.032708168029785156  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.6600341796875 GB
    Memory Allocated: 0.032708168029785156  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.6600341796875 GB
    Memory Allocated: 0.07751083374023438  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.6600341796875 GB
    Memory Allocated: 0.07767534255981445  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.6600341796875 GB
    Memory Allocated: 0.054068565368652344  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.6600341796875 GB
    Memory Allocated: 0.057582855224609375  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6600341796875 GB
    Memory Allocated: 0.057582855224609375  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.6600341796875 GB
    Memory Allocated: 0.057582855224609375  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

torch.Size([93958, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6600341796875 GB
    Memory Allocated: 0.057582855224609375  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

m.shape torch.Size([5672, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 0.2229609489440918  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 0.2229609489440918  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

 h.shape torch.Size([1, 5672, 128]), torch.Size([1, 5672, 128])
----------------------------------------3
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 0.22837018966674805  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 0.27524518966674805  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

rst.shape  torch.Size([1, 5672, 128])
m.shape torch.Size([5703, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 0.27797937393188477  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 0.27797937393188477  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

 h.shape torch.Size([1, 5703, 128]), torch.Size([1, 5703, 128])
----------------------------------------3
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 0.2843036651611328  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 0.37177371978759766  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

rst.shape  torch.Size([1, 5703, 128])
m.shape torch.Size([4835, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 0.37597084045410156  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 0.37597084045410156  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

 h.shape torch.Size([1, 4835, 128]), torch.Size([1, 4835, 128])
----------------------------------------3
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 0.3813800811767578  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 0.48435211181640625  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

rst.shape  torch.Size([1, 4835, 128])
m.shape torch.Size([4125, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 0.48972320556640625  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 0.48972320556640625  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

 h.shape torch.Size([1, 4125, 128]), torch.Size([1, 4125, 128])
----------------------------------------3
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 0.49445438385009766  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 0.609067440032959  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

rst.shape  torch.Size([1, 4125, 128])
m.shape torch.Size([3567, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 0.6156048774719238  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 0.6156048774719238  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

 h.shape torch.Size([1, 3567, 128]), torch.Size([1, 3567, 128])
----------------------------------------3
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 0.6193728446960449  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 0.743833065032959  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

rst.shape  torch.Size([1, 3567, 128])
m.shape torch.Size([2880, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 0.7499227523803711  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 0.7499227523803711  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

 h.shape torch.Size([1, 2880, 128]), torch.Size([1, 2880, 128])
----------------------------------------3
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 0.7535862922668457  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 0.8746500015258789  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

rst.shape  torch.Size([1, 2880, 128])
m.shape torch.Size([2515, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 0.8816714286804199  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 0.8816714286804199  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

 h.shape torch.Size([1, 2515, 128]), torch.Size([1, 2515, 128])
----------------------------------------3
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 0.8842959403991699  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 1.008488655090332  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

rst.shape  torch.Size([1, 2515, 128])
m.shape torch.Size([2200, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 1.0156817436218262  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 1.0156817436218262  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

 h.shape torch.Size([1, 2200, 128]), torch.Size([1, 2200, 128])
----------------------------------------3
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 1.017890453338623  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 1.1415224075317383  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

rst.shape  torch.Size([1, 2200, 128])
m.shape torch.Size([1940, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 1.1481504440307617  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 1.1481504440307617  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

 h.shape torch.Size([1, 1940, 128]), torch.Size([1, 1940, 128])
----------------------------------------3
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 1.1500005722045898  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 1.2685136795043945  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

rst.shape  torch.Size([1, 1940, 128])
m.shape torch.Size([19594, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 1.3610200881958008  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 1.3610200881958008  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

 h.shape torch.Size([1, 9797, 128]), torch.Size([1, 9797, 128])
----------------------------------------3
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 1.3703632354736328  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 2.063300132751465  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

rst 0 shape torch.Size([1, 9797, 128])
----------------------------------------1
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 2.063300132751465  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 2.063300132751465  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

 h.shape torch.Size([1, 9797, 128]), torch.Size([1, 9797, 128])
----------------------------------------3
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 2.072643280029297  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 2.761753559112549  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

rst 1 shape torch.Size([1, 9797, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 2.6209325790405273  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 2.671506881713867  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 2.7227020263671875  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 2.6717324256896973  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

torch.Size([53031, 256])
first layer input nodes number: 93958
first layer output nodes number: 53031
edges number: 331803
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 2.7234044075012207  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 2.7739787101745605  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 2.7866225242614746  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 2.7866225242614746  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

m.shape torch.Size([4172, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 2.925736427307129  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 2.925736427307129  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

 h.shape torch.Size([1, 4172, 256]), torch.Size([1, 4172, 256])
----------------------------------------3
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 2.9336938858032227  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 2.9973535537719727  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

rst.shape  torch.Size([1, 4172, 256])
m.shape torch.Size([3421, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 2.999950885772705  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 2.999950885772705  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

 h.shape torch.Size([1, 3421, 256]), torch.Size([1, 3421, 256])
----------------------------------------3
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 3.00718355178833  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 3.106271743774414  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

rst.shape  torch.Size([1, 3421, 256])
m.shape torch.Size([2587, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 3.110468864440918  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 3.110468864440918  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

 h.shape torch.Size([1, 2587, 256]), torch.Size([1, 2587, 256])
----------------------------------------3
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 3.1156702041625977  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 3.226924419403076  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

rst.shape  torch.Size([1, 2587, 256])
m.shape torch.Size([1956, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 3.2319774627685547  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 3.2319774627685547  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

 h.shape torch.Size([1, 1956, 256]), torch.Size([1, 1956, 256])
----------------------------------------3
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 3.235873222351074  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 3.3472704887390137  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

rst.shape  torch.Size([1, 1956, 256])
m.shape torch.Size([1668, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 3.353085517883301  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 3.353085517883301  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

 h.shape torch.Size([1, 1668, 256]), torch.Size([1, 1668, 256])
----------------------------------------3
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 3.3564839363098145  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 3.4778571128845215  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

rst.shape  torch.Size([1, 1668, 256])
m.shape torch.Size([1216, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 3.483278751373291  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 3.483278751373291  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

 h.shape torch.Size([1, 1216, 256]), torch.Size([1, 1216, 256])
----------------------------------------3
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 3.4860787391662598  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 3.5915069580078125  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

rst.shape  torch.Size([1, 1216, 256])
m.shape torch.Size([967, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 3.596853256225586  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 3.596853256225586  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

 h.shape torch.Size([1, 967, 256]), torch.Size([1, 967, 256])
----------------------------------------3
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 3.5986976623535156  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 3.6916847229003906  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

rst.shape  torch.Size([1, 967, 256])
m.shape torch.Size([851, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 3.6973061561584473  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 3.6973061561584473  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

 h.shape torch.Size([1, 851, 256]), torch.Size([1, 851, 256])
----------------------------------------3
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 3.6989293098449707  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 3.7916626930236816  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

rst.shape  torch.Size([1, 851, 256])
m.shape torch.Size([704, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 3.796940803527832  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 3.796940803527832  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

 h.shape torch.Size([1, 704, 256]), torch.Size([1, 704, 256])
----------------------------------------3
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 3.798283576965332  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 3.886418342590332  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

rst.shape  torch.Size([1, 704, 256])
m.shape torch.Size([543, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 3.8909659385681152  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 3.8909659385681152  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

 h.shape torch.Size([1, 543, 256]), torch.Size([1, 543, 256])
----------------------------------------3
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 3.8920016288757324  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 3.9682021141052246  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

rst.shape  torch.Size([1, 543, 256])
m.shape torch.Size([451, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 3.9724526405334473  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 3.9724526405334473  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

 h.shape torch.Size([1, 451, 256]), torch.Size([1, 451, 256])
----------------------------------------3
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 3.9733128547668457  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.041957378387451  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

rst.shape  torch.Size([1, 451, 256])
m.shape torch.Size([396, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.04609489440918  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.04609489440918  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

 h.shape torch.Size([1, 396, 256]), torch.Size([1, 396, 256])
----------------------------------------3
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.046850204467773  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.111701011657715  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

rst.shape  torch.Size([1, 396, 256])
m.shape torch.Size([347, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.115659236907959  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.115659236907959  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

 h.shape torch.Size([1, 347, 256]), torch.Size([1, 347, 256])
----------------------------------------3
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.116321086883545  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.1783061027526855  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

rst.shape  torch.Size([1, 347, 256])
m.shape torch.Size([268, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.181581497192383  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.181581497192383  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.182092666625977  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.233846664428711  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([222, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.237354755401611  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.237354755401611  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.237778186798096  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.2826619148254395  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([204, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.285587310791016  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.285587310791016  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.285976409912109  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.329944610595703  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([175, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.3326096534729  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.3326096534729  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.332943439483643  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.372997760772705  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([159, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.375581741333008  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.375581741333008  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.375885009765625  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.414400100708008  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([146, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.416914939880371  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.416914939880371  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.417193412780762  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.4545087814331055  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([146, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.457176208496094  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.457176208496094  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.457454681396484  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.4967193603515625  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([91, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.498416900634766  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.498416900634766  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.498590469360352  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.52427864074707  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([88, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.526052951812744  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.526052951812744  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.526220798492432  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.552237033843994  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([68, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.553656578063965  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.553656578063965  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.553786277770996  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.574797630310059  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([83, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.576647758483887  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.576647758483887  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.57680606842041  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.603560447692871  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([1143, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.630945682525635  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.630945682525635  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

 h.shape torch.Size([1, 1143, 256]), torch.Size([1, 1143, 256])
----------------------------------------3
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.6331257820129395  GigaBytes
Max Memory Allocated: 4.674234390258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 5.020127296447754  GigaBytes
Max Memory Allocated: 5.0473785400390625  GigaBytes

rst.shape  torch.Size([1, 1143, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.906131267547607  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.910109996795654  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.9133992195129395  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.9092559814453125  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

torch.Size([22072, 40])
input nodes number: 53031
output nodes number: 22072
edges number: 139657
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.909557342529297  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 4.909557819366455  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 0.06401395797729492  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

pseudo mini batch 3 input nodes size: 93777
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 0.05381011962890625  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 0.05381011962890625  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 0.0985264778137207  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 0.09869861602783203  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 0.053731441497802734  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 0.05970144271850586  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 0.05970144271850586  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 0.05970144271850586  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

torch.Size([93777, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6619873046875 GB
    Memory Allocated: 0.05970144271850586  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

m.shape torch.Size([3873, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.9217529296875 GB
    Memory Allocated: 0.32410526275634766  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9217529296875 GB
    Memory Allocated: 0.32410526275634766  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

 h.shape torch.Size([1, 3873, 128]), torch.Size([1, 3873, 128])
----------------------------------------3
 Nvidia-smi: 6.9217529296875 GB
    Memory Allocated: 0.32779884338378906  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9217529296875 GB
    Memory Allocated: 0.35926151275634766  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

rst.shape  torch.Size([1, 3873, 128])
m.shape torch.Size([4066, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.9217529296875 GB
    Memory Allocated: 0.36110830307006836  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9217529296875 GB
    Memory Allocated: 0.36110830307006836  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

 h.shape torch.Size([1, 4066, 128]), torch.Size([1, 4066, 128])
----------------------------------------3
 Nvidia-smi: 6.9217529296875 GB
    Memory Allocated: 0.36498594284057617  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9217529296875 GB
    Memory Allocated: 0.42340803146362305  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

rst.shape  torch.Size([1, 4066, 128])
m.shape torch.Size([3650, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.9217529296875 GB
    Memory Allocated: 0.4274635314941406  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9217529296875 GB
    Memory Allocated: 0.4274635314941406  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

 h.shape torch.Size([1, 3650, 128]), torch.Size([1, 3650, 128])
----------------------------------------3
 Nvidia-smi: 6.9217529296875 GB
    Memory Allocated: 0.4311513900756836  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9217529296875 GB
    Memory Allocated: 0.5091791152954102  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

rst.shape  torch.Size([1, 3650, 128])
m.shape torch.Size([3361, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.9217529296875 GB
    Memory Allocated: 0.5138492584228516  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9217529296875 GB
    Memory Allocated: 0.5138492584228516  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

 h.shape torch.Size([1, 3361, 128]), torch.Size([1, 3361, 128])
----------------------------------------3
 Nvidia-smi: 6.9217529296875 GB
    Memory Allocated: 0.5171923637390137  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9217529296875 GB
    Memory Allocated: 0.6101460456848145  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

rst.shape  torch.Size([1, 3361, 128])
m.shape torch.Size([3169, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.9217529296875 GB
    Memory Allocated: 0.6160988807678223  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9217529296875 GB
    Memory Allocated: 0.6160988807678223  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

 h.shape torch.Size([1, 3169, 128]), torch.Size([1, 3169, 128])
----------------------------------------3
 Nvidia-smi: 6.9217529296875 GB
    Memory Allocated: 0.6192021369934082  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9217529296875 GB
    Memory Allocated: 0.7285699844360352  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

rst.shape  torch.Size([1, 3169, 128])
m.shape torch.Size([2953, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.9217529296875 GB
    Memory Allocated: 0.7352838516235352  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9217529296875 GB
    Memory Allocated: 0.7352838516235352  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

 h.shape torch.Size([1, 2953, 128]), torch.Size([1, 2953, 128])
----------------------------------------3
 Nvidia-smi: 6.9217529296875 GB
    Memory Allocated: 0.738426685333252  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9217529296875 GB
    Memory Allocated: 0.8625621795654297  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

rst.shape  torch.Size([1, 2953, 128])
m.shape torch.Size([2814, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.9217529296875 GB
    Memory Allocated: 0.8710107803344727  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9217529296875 GB
    Memory Allocated: 0.8710107803344727  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

 h.shape torch.Size([1, 2814, 128]), torch.Size([1, 2814, 128])
----------------------------------------3
 Nvidia-smi: 6.9217529296875 GB
    Memory Allocated: 0.8736944198608398  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9217529296875 GB
    Memory Allocated: 1.0111284255981445  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

rst.shape  torch.Size([1, 2814, 128])
m.shape torch.Size([2611, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.9217529296875 GB
    Memory Allocated: 1.0190010070800781  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9217529296875 GB
    Memory Allocated: 1.0190010070800781  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

 h.shape torch.Size([1, 2611, 128]), torch.Size([1, 2611, 128])
----------------------------------------3
 Nvidia-smi: 6.9217529296875 GB
    Memory Allocated: 1.021559715270996  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9217529296875 GB
    Memory Allocated: 1.171494483947754  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

rst.shape  torch.Size([1, 2611, 128])
m.shape torch.Size([2457, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.9217529296875 GB
    Memory Allocated: 1.1807937622070312  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9217529296875 GB
    Memory Allocated: 1.1807937622070312  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

 h.shape torch.Size([1, 2457, 128]), torch.Size([1, 2457, 128])
----------------------------------------3
 Nvidia-smi: 6.9217529296875 GB
    Memory Allocated: 1.1832828521728516  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9217529296875 GB
    Memory Allocated: 1.3395328521728516  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

rst.shape  torch.Size([1, 2457, 128])
m.shape torch.Size([40409, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.1151123046875 GB
    Memory Allocated: 1.5317206382751465  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1151123046875 GB
    Memory Allocated: 1.5317206382751465  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

 h.shape torch.Size([1, 20204, 128]), torch.Size([1, 20204, 128])
----------------------------------------3
 Nvidia-smi: 7.1151123046875 GB
    Memory Allocated: 1.5509886741638184  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 2.9258627891540527  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

rst 0 shape torch.Size([1, 20204, 128])
----------------------------------------1
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 2.9258627891540527  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 2.9258627891540527  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

 h.shape torch.Size([1, 20205, 128]), torch.Size([1, 20205, 128])
----------------------------------------3
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 2.945394515991211  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6385498046875 GB
    Memory Allocated: 4.3211669921875  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

rst 1 shape torch.Size([1, 20205, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.6385498046875 GB
    Memory Allocated: 4.085707187652588  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.6385498046875 GB
    Memory Allocated: 4.151856899261475  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.6385498046875 GB
    Memory Allocated: 4.218006610870361  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.6385498046875 GB
    Memory Allocated: 4.151340007781982  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

torch.Size([69363, 256])
first layer input nodes number: 93777
first layer output nodes number: 69363
edges number: 536751
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.6385498046875 GB
    Memory Allocated: 4.21870756149292  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.6385498046875 GB
    Memory Allocated: 4.284857273101807  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.6385498046875 GB
    Memory Allocated: 4.301394939422607  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.6385498046875 GB
    Memory Allocated: 4.301394939422607  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

m.shape torch.Size([2575, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 4.559627532958984  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 4.559627532958984  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

 h.shape torch.Size([1, 2575, 256]), torch.Size([1, 2575, 256])
----------------------------------------3
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 4.564538955688477  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 4.603978633880615  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

rst.shape  torch.Size([1, 2575, 256])
m.shape torch.Size([2240, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 4.605828762054443  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 4.605828762054443  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

 h.shape torch.Size([1, 2240, 256]), torch.Size([1, 2240, 256])
----------------------------------------3
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 4.610101222991943  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 4.675196170806885  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

rst.shape  torch.Size([1, 2240, 256])
m.shape torch.Size([1725, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 4.678033828735352  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 4.678033828735352  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

 h.shape torch.Size([1, 1725, 256]), torch.Size([1, 1725, 256])
----------------------------------------3
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 4.681491851806641  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 4.756106853485107  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

rst.shape  torch.Size([1, 1725, 256])
m.shape torch.Size([1366, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 4.759713649749756  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 4.759713649749756  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

 h.shape torch.Size([1, 1366, 256]), torch.Size([1, 1366, 256])
----------------------------------------3
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 4.762528896331787  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 4.839715480804443  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

rst.shape  torch.Size([1, 1366, 256])
m.shape torch.Size([1238, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 4.844362258911133  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 4.844362258911133  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

 h.shape torch.Size([1, 1238, 256]), torch.Size([1, 1238, 256])
----------------------------------------3
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 4.846772193908691  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 4.935198783874512  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

rst.shape  torch.Size([1, 1238, 256])
m.shape torch.Size([1012, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 4.939854145050049  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 4.939854145050049  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

 h.shape torch.Size([1, 1012, 256]), torch.Size([1, 1012, 256])
----------------------------------------3
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 4.941784381866455  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.025471210479736  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

rst.shape  torch.Size([1, 1012, 256])
m.shape torch.Size([841, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.0301642417907715  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.0301642417907715  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

 h.shape torch.Size([1, 841, 256]), torch.Size([1, 841, 256])
----------------------------------------3
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.031768321990967  GigaBytes
Max Memory Allocated: 5.082269668579102  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.112819194793701  GigaBytes
Max Memory Allocated: 5.118433475494385  GigaBytes

rst.shape  torch.Size([1, 841, 256])
m.shape torch.Size([710, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.117476463317871  GigaBytes
Max Memory Allocated: 5.118433475494385  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.117476463317871  GigaBytes
Max Memory Allocated: 5.118433475494385  GigaBytes

 h.shape torch.Size([1, 710, 256]), torch.Size([1, 710, 256])
----------------------------------------3
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.118830680847168  GigaBytes
Max Memory Allocated: 5.118830680847168  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.197737693786621  GigaBytes
Max Memory Allocated: 5.203154563903809  GigaBytes

rst.shape  torch.Size([1, 710, 256])
m.shape torch.Size([654, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.2027177810668945  GigaBytes
Max Memory Allocated: 5.203154563903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.2027177810668945  GigaBytes
Max Memory Allocated: 5.203154563903809  GigaBytes

 h.shape torch.Size([1, 654, 256]), torch.Size([1, 654, 256])
----------------------------------------3
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.203965187072754  GigaBytes
Max Memory Allocated: 5.203965187072754  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.283799171447754  GigaBytes
Max Memory Allocated: 5.289412498474121  GigaBytes

rst.shape  torch.Size([1, 654, 256])
m.shape torch.Size([626, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.289192199707031  GigaBytes
Max Memory Allocated: 5.289412498474121  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.289192199707031  GigaBytes
Max Memory Allocated: 5.289412498474121  GigaBytes

 h.shape torch.Size([1, 626, 256]), torch.Size([1, 626, 256])
----------------------------------------3
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.290386199951172  GigaBytes
Max Memory Allocated: 5.290386199951172  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.376441955566406  GigaBytes
Max Memory Allocated: 5.382411956787109  GigaBytes

rst.shape  torch.Size([1, 626, 256])
m.shape torch.Size([536, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.38151216506958  GigaBytes
Max Memory Allocated: 5.382411956787109  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.38151216506958  GigaBytes
Max Memory Allocated: 5.382411956787109  GigaBytes

 h.shape torch.Size([1, 536, 256]), torch.Size([1, 536, 256])
----------------------------------------3
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.382534503936768  GigaBytes
Max Memory Allocated: 5.382534503936768  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.4629034996032715  GigaBytes
Max Memory Allocated: 5.468526363372803  GigaBytes

rst.shape  torch.Size([1, 536, 256])
m.shape torch.Size([519, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.46837854385376  GigaBytes
Max Memory Allocated: 5.468526363372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.46837854385376  GigaBytes
Max Memory Allocated: 5.468526363372803  GigaBytes

 h.shape torch.Size([1, 519, 256]), torch.Size([1, 519, 256])
----------------------------------------3
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.4693684577941895  GigaBytes
Max Memory Allocated: 5.4693684577941895  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.553511142730713  GigaBytes
Max Memory Allocated: 5.559450626373291  GigaBytes

rst.shape  torch.Size([1, 519, 256])
m.shape torch.Size([428, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.558363914489746  GigaBytes
Max Memory Allocated: 5.559450626373291  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.558363914489746  GigaBytes
Max Memory Allocated: 5.559450626373291  GigaBytes

 h.shape torch.Size([1, 428, 256]), torch.Size([1, 428, 256])
----------------------------------------3
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.55918025970459  GigaBytes
Max Memory Allocated: 5.559450626373291  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.634875297546387  GigaBytes
Max Memory Allocated: 5.640181541442871  GigaBytes

rst.shape  torch.Size([1, 428, 256])
m.shape torch.Size([373, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.639486312866211  GigaBytes
Max Memory Allocated: 5.640181541442871  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.639486312866211  GigaBytes
Max Memory Allocated: 5.640181541442871  GigaBytes

 h.shape torch.Size([1, 373, 256]), torch.Size([1, 373, 256])
----------------------------------------3
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.64019775390625  GigaBytes
Max Memory Allocated: 5.64019775390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.711204528808594  GigaBytes
Max Memory Allocated: 5.716184616088867  GigaBytes

rst.shape  torch.Size([1, 373, 256])
m.shape torch.Size([372, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.716212272644043  GigaBytes
Max Memory Allocated: 5.716233253479004  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.716212272644043  GigaBytes
Max Memory Allocated: 5.716233253479004  GigaBytes

 h.shape torch.Size([1, 372, 256]), torch.Size([1, 372, 256])
----------------------------------------3
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.716921806335449  GigaBytes
Max Memory Allocated: 5.716921806335449  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.79215145111084  GigaBytes
Max Memory Allocated: 5.797472953796387  GigaBytes

rst.shape  torch.Size([1, 372, 256])
m.shape torch.Size([351, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.797194480895996  GigaBytes
Max Memory Allocated: 5.797472953796387  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.797194480895996  GigaBytes
Max Memory Allocated: 5.797472953796387  GigaBytes

 h.shape torch.Size([1, 351, 256]), torch.Size([1, 351, 256])
----------------------------------------3
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.797863960266113  GigaBytes
Max Memory Allocated: 5.797863960266113  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.8760175704956055  GigaBytes
Max Memory Allocated: 5.881373405456543  GigaBytes

rst.shape  torch.Size([1, 351, 256])
m.shape torch.Size([313, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.880797386169434  GigaBytes
Max Memory Allocated: 5.881373405456543  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.880797386169434  GigaBytes
Max Memory Allocated: 5.881373405456543  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.881394386291504  GigaBytes
Max Memory Allocated: 5.881394386291504  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.954837799072266  GigaBytes
Max Memory Allocated: 5.959912300109863  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([337, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.96036958694458  GigaBytes
Max Memory Allocated: 5.960392475128174  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.96036958694458  GigaBytes
Max Memory Allocated: 5.960392475128174  GigaBytes

 h.shape torch.Size([1, 337, 256]), torch.Size([1, 337, 256])
----------------------------------------3
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 5.961012363433838  GigaBytes
Max Memory Allocated: 5.961012363433838  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 6.043909549713135  GigaBytes
Max Memory Allocated: 6.049694538116455  GigaBytes

rst.shape  torch.Size([1, 337, 256])
m.shape torch.Size([300, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 6.04906702041626  GigaBytes
Max Memory Allocated: 6.049694538116455  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 6.04906702041626  GigaBytes
Max Memory Allocated: 6.049694538116455  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 6.0496392250061035  GigaBytes
Max Memory Allocated: 6.049694538116455  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 6.1269097328186035  GigaBytes
Max Memory Allocated: 6.132345676422119  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([270, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 6.131814002990723  GigaBytes
Max Memory Allocated: 6.132345676422119  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 6.131814002990723  GigaBytes
Max Memory Allocated: 6.132345676422119  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 6.132328987121582  GigaBytes
Max Memory Allocated: 6.132345676422119  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 6.205830097198486  GigaBytes
Max Memory Allocated: 6.21097993850708  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([284, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 6.211305141448975  GigaBytes
Max Memory Allocated: 6.21132755279541  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 6.211305141448975  GigaBytes
Max Memory Allocated: 6.21132755279541  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 6.211846828460693  GigaBytes
Max Memory Allocated: 6.211846828460693  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 6.2938055992126465  GigaBytes
Max Memory Allocated: 6.299493312835693  GigaBytes

rst.shape  torch.Size([1, 284, 256])
m.shape torch.Size([202, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 6.297806262969971  GigaBytes
Max Memory Allocated: 6.299493312835693  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 6.297806262969971  GigaBytes
Max Memory Allocated: 6.299493312835693  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 6.298191547393799  GigaBytes
Max Memory Allocated: 6.299493312835693  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 6.357910633087158  GigaBytes
Max Memory Allocated: 6.362148761749268  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([199, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 6.362117290496826  GigaBytes
Max Memory Allocated: 6.362148761749268  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 6.362117290496826  GigaBytes
Max Memory Allocated: 6.362148761749268  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 6.362496852874756  GigaBytes
Max Memory Allocated: 6.362496852874756  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 6.423985958099365  GigaBytes
Max Memory Allocated: 6.428350925445557  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([208, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 6.42859411239624  GigaBytes
Max Memory Allocated: 6.42861270904541  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 6.42859411239624  GigaBytes
Max Memory Allocated: 6.42861270904541  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 6.428990840911865  GigaBytes
Max Memory Allocated: 6.428990840911865  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8924560546875 GB
    Memory Allocated: 6.49603796005249  GigaBytes
Max Memory Allocated: 6.50079870223999  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([5368, 25, 256])
----------------------------------------1
 Nvidia-smi: 9.0213623046875 GB
    Memory Allocated: 6.625762462615967  GigaBytes
Max Memory Allocated: 6.626262664794922  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0213623046875 GB
    Memory Allocated: 6.625762462615967  GigaBytes
Max Memory Allocated: 6.626262664794922  GigaBytes

 h.shape torch.Size([1, 5368, 256]), torch.Size([1, 5368, 256])
----------------------------------------3
 Nvidia-smi: 9.0213623046875 GB
    Memory Allocated: 6.636168003082275  GigaBytes
Max Memory Allocated: 6.636168003082275  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3963623046875 GB
    Memory Allocated: 8.440088272094727  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 5368, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.3963623046875 GB
    Memory Allocated: 8.203670978546143  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.3963623046875 GB
    Memory Allocated: 8.207371234893799  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.3963623046875 GB
    Memory Allocated: 8.211071491241455  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.3963623046875 GB
    Memory Allocated: 8.207199096679688  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

torch.Size([23047, 40])
input nodes number: 69363
output nodes number: 23047
edges number: 264439
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3963623046875 GB
    Memory Allocated: 8.208299160003662  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes
[04:43:25] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28846524 edges into 4 parts and get 1819516 edge cuts

-----------------------------------------after loss calculation
 Nvidia-smi: 10.3963623046875 GB
    Memory Allocated: 8.20829963684082  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.07094049453735352  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.07649087905883789  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.07649087905883789  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03369015455245972 |0.08495563268661499 |0.2684626579284668 |0.00014328956604003906 |0.10452425479888916 |0.0058672428131103516 |
----------------------------------------------------------pseudo_mini_loss sum 5.3272624015808105
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  495346
Number of first layer input nodes during this epoch:  297967
Number of first layer output nodes during this epoch:  197379
----------------------------------------before generate dataloader block 
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.07649040222167969  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.01962590217590332
global_2_local spend time (sec) 0.04173874855041504
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0039861202239990234
A = g.adjacency_matrix() spent  0.007607221603393555
auxiliary_graph
Graph(num_nodes=154728, num_edges=28937465,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08375978469848633
remove nodes length
63787
auxiliary_graph.remove_nodes spent  1.4199738502502441
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28937465,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1736855506896973

the counter of shared neighbor distribution
Counter({1.0: 23292734, 2.0: 4025850, 3.0: 1012928, 4.0: 306592, 5.0: 111950, 6.0: 47874, 7.0: 22518, 8.0: 11474, 9.0: 6096, 10.0: 3464, 11.0: 1990, 12.0: 1176, 13.0: 670, 14.0: 384, 15.0: 282, 16.0: 210, 17.0: 182, 18.0: 86, 19.0: 48, 21.0: 8, 20.0: 8})
28846524
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28846521, 28846522, 28846523])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23292734, 2.0: 4025850, 3.0: 1012928, 4.0: 306592, 5.0: 111950, 6.0: 47874, 7.0: 22518, 8.0: 11474, 9.0: 6096, 10.0: 3464, 11.0: 1990, 12.0: 1176, 13.0: 670, 14.0: 384, 15.0: 282, 16.0: 210, 17.0: 182, 18.0: 86, 19.0: 48, 21.0: 8, 20.0: 8})
Convert a graph into a bidirected graph: 1.286 seconds
Metis partitioning: 4.769 seconds
Split the graph: 3.371 seconds
Construct subgraphs: 0.083 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  9.521690130233765
23140
22416
22386
22999
total k batches seeds list generation spend  19.5698139667511
after graph partition
graph partition algorithm spend time 19.682247638702393
23140
22416
22386
22999
partition_len_list
[41476, 34345, 51258, 69406]
shared_neighbor_graph_partition_s0 selection method  spend 19.775419235229492
time for parepare:  0.017680644989013672
local_output_nid generation:  0.003204345703125
local_in_edges_tensor generation:  0.0038433074951171875
mini_batch_src_global generation:  0.00527191162109375
r_  generation:  0.061307668685913086
local_output_nid generation:  0.0038280487060546875
local_in_edges_tensor generation:  0.004080057144165039
mini_batch_src_global generation:  0.007939577102661133
r_  generation:  0.06211423873901367
local_output_nid generation:  0.003939390182495117
local_in_edges_tensor generation:  0.0034542083740234375
mini_batch_src_global generation:  0.005304098129272461
r_  generation:  0.05269575119018555
local_output_nid generation:  0.0039904117584228516
local_in_edges_tensor generation:  0.0050046443939208984
mini_batch_src_global generation:  0.009727239608764648
r_  generation:  0.08824682235717773
----------------------check_connections_block total spend ----------------------------- 0.44356846809387207
generate_one_block  0.08027338981628418
generate_one_block  0.08769822120666504
generate_one_block  0.06824588775634766
generate_one_block  0.1327979564666748
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03337740898132324
gen group dst list time:  0.0056459903717041016
time for parepare:  0.022151470184326172
local_output_nid generation:  0.006323575973510742
local_in_edges_tensor generation:  0.013997793197631836
mini_batch_src_global generation:  0.00818490982055664
r_  generation:  0.08777093887329102
local_output_nid generation:  0.00718998908996582
local_in_edges_tensor generation:  0.010084152221679688
mini_batch_src_global generation:  0.008805036544799805
r_  generation:  0.07974886894226074
local_output_nid generation:  0.01302337646484375
local_in_edges_tensor generation:  0.011688709259033203
mini_batch_src_global generation:  0.011375904083251953
r_  generation:  0.11653304100036621
local_output_nid generation:  0.011597156524658203
local_in_edges_tensor generation:  0.015402078628540039
mini_batch_src_global generation:  0.018890857696533203
r_  generation:  0.19312763214111328
----------------------check_connections_block total spend ----------------------------- 0.7507171630859375
generate_one_block  0.11351943016052246
generate_one_block  0.09217000007629395
generate_one_block  0.14900922775268555
generate_one_block  0.2389202117919922
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.07649040222167969  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

connection checking time:  1.1942856311798096
block generation total time  0.9626343250274658
average batch blocks generation time:  0.24065858125686646
block dataloader generation time/epoch 22.098307132720947
pseudo mini batch 0 input nodes size: 65169
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.0596919059753418  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.0596919059753418  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.09076690673828125  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.09093952178955078  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.046051025390625  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.04903697967529297  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.04903697967529297  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.04903697967529297  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

torch.Size([65169, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.04903697967529297  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

m.shape torch.Size([4905, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.16881847381591797  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.16881847381591797  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 4905, 128]), torch.Size([1, 4905, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.1744670867919922  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.21193790435791016  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 4905, 128])
m.shape torch.Size([5028, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.21439409255981445  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.21439409255981445  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 5028, 128]), torch.Size([1, 5028, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.21918916702270508  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.29111528396606445  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 5028, 128])
m.shape torch.Size([4422, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.2956414222717285  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.2956414222717285  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 4422, 128]), torch.Size([1, 4422, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.299898624420166  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.3933982849121094  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 4422, 128])
m.shape torch.Size([3688, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.39809370040893555  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.39809370040893555  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 3688, 128]), torch.Size([1, 3688, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.4028301239013672  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.5048274993896484  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 3688, 128])
m.shape torch.Size([3131, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.5105338096618652  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.5105338096618652  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 3131, 128]), torch.Size([1, 3131, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.5135855674743652  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.6225275993347168  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 3131, 128])
m.shape torch.Size([2554, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.6284995079040527  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.6284995079040527  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 2554, 128]), torch.Size([1, 2554, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.6311502456665039  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.7503080368041992  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 2554, 128])
m.shape torch.Size([2215, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.7564835548400879  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.7564835548400879  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 2215, 128]), torch.Size([1, 2215, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.7587575912475586  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.8685274124145508  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 2215, 128])
m.shape torch.Size([1929, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.8748297691345215  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.8748297691345215  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 1929, 128]), torch.Size([1, 1929, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.8766694068908691  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.9815287590026855  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 1929, 128])
m.shape torch.Size([1637, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.9876341819763184  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.9876341819763184  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 1637, 128]), torch.Size([1, 1637, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.9891953468322754  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.0915184020996094  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 1637, 128])
m.shape torch.Size([11967, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.1478009223937988  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.1478009223937988  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 5983, 128]), torch.Size([1, 5983, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.1535067558288574  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.5586209297180176  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst 0 shape torch.Size([1, 5983, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.5586209297180176  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.5586209297180176  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 5984, 128]), torch.Size([1, 5984, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.5643277168273926  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.9666566848754883  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst 1 shape torch.Size([1, 5984, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.8684406280517578  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.9079952239990234  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.947549819946289  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.9076857566833496  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

torch.Size([41476, 256])
first layer input nodes number: 65169
first layer output nodes number: 41476
edges number: 239298
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.9480376243591309  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.9875922203063965  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.997480869293213  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.997480869293213  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

m.shape torch.Size([3557, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.157135486602783  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.157135486602783  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 3557, 256]), torch.Size([1, 3557, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.1639199256896973  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.2181954383850098  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 3557, 256])
m.shape torch.Size([3218, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.220989227294922  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.220989227294922  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 3218, 256]), torch.Size([1, 3218, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.2271270751953125  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.319194793701172  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 3218, 256])
m.shape torch.Size([2625, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.3243026733398438  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.3243026733398438  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 2625, 256]), torch.Size([1, 2625, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.330089569091797  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.4402389526367188  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 2625, 256])
m.shape torch.Size([2093, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.445915699005127  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.445915699005127  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 2093, 256]), torch.Size([1, 2093, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.450413227081299  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.571476936340332  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 2093, 256])
m.shape torch.Size([1747, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.5774617195129395  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.5774617195129395  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 1747, 256]), torch.Size([1, 1747, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.5808281898498535  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.705954074859619  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 1747, 256])
m.shape torch.Size([1357, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.711723804473877  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.711723804473877  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 1357, 256]), torch.Size([1, 1357, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.714393138885498  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.827939510345459  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 1357, 256])
m.shape torch.Size([1148, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.8342080116271973  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.8342080116271973  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 1148, 256]), torch.Size([1, 1148, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.836460590362549  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.9530458450317383  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 1148, 256])
m.shape torch.Size([969, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.959402084350586  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.959402084350586  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 969, 256]), torch.Size([1, 969, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.9612503051757812  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.072061538696289  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 969, 256])
m.shape torch.Size([818, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.078213691711426  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.078213691711426  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 818, 256]), torch.Size([1, 818, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.0797739028930664  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.1828622817993164  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 818, 256])
m.shape torch.Size([688, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.188694953918457  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.188694953918457  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 688, 256]), torch.Size([1, 688, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.190007209777832  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.285088539123535  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 688, 256])
m.shape torch.Size([518, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.2899093627929688  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.2899093627929688  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 518, 256]), torch.Size([1, 518, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.2908973693847656  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.3737592697143555  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 518, 256])
m.shape torch.Size([493, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.3789515495300293  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.3789515495300293  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 493, 256]), torch.Size([1, 493, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.379891872406006  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.4622416496276855  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 493, 256])
m.shape torch.Size([414, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.466944694519043  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.466944694519043  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 414, 256]), torch.Size([1, 414, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.4677343368530273  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.542281150817871  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 414, 256])
m.shape torch.Size([372, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.547243118286133  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.547243118286133  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 372, 256]), torch.Size([1, 372, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.547952651977539  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.618257522583008  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 372, 256])
m.shape torch.Size([335, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.622732639312744  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.622732639312744  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 335, 256]), torch.Size([1, 335, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.6233716011047363  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.692225933074951  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 335, 256])
m.shape torch.Size([266, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.6959972381591797  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.6959972381591797  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.696504592895508  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.755669593811035  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([236, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.7592720985412598  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.7592720985412598  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.7597222328186035  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.8137383460998535  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([199, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.816956043243408  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.816956043243408  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.817335605621338  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.865540027618408  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([179, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.868619441986084  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.868619441986084  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.8689608573913574  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.914710521697998  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([156, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.917719841003418  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.917719841003418  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.9180173873901367  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.9599714279174805  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([131, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.9624667167663574  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.9624667167663574  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.962716579437256  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.9996962547302246  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([139, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.0025105476379395  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.0025105476379395  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.0027756690979  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.043869495391846  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([106, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.046080589294434  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.046080589294434  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.046282768249512  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.079035758972168  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([101, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.081264495849609  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.081264495849609  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.081457138061523  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.114013671875  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([1275, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.1445536613464355  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.1445536613464355  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 1275, 256]), torch.Size([1, 1275, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.1469855308532715  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.58020544052124  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 1275, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.445343971252441  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.4488725662231445  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.4523210525512695  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.448619842529297  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

torch.Size([23140, 40])
input nodes number: 41476
output nodes number: 23140
edges number: 161293
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.448850154876709  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.448851108551025  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.054648399353027344  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

pseudo mini batch 1 input nodes size: 48139
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.045800209045410156  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.045800209045410156  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.06923770904541016  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.06940507888793945  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.03815746307373047  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.041019439697265625  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.041019439697265625  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.041019439697265625  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

torch.Size([48139, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.041019439697265625  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

m.shape torch.Size([3860, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.14370203018188477  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.14370203018188477  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 3860, 128]), torch.Size([1, 3860, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.1473832130432129  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.17818307876586914  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 3860, 128])
m.shape torch.Size([3879, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.1800236701965332  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.1800236701965332  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 3879, 128]), torch.Size([1, 3879, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.1843891143798828  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.24140310287475586  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 3879, 128])
m.shape torch.Size([3461, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.24450445175170898  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.24450445175170898  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 3461, 128]), torch.Size([1, 3461, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.24800443649291992  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.3207855224609375  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 3461, 128])
m.shape torch.Size([2877, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.32462263107299805  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.32462263107299805  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 2877, 128]), torch.Size([1, 2877, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.32736635208129883  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.4121208190917969  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 2877, 128])
m.shape torch.Size([2449, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.4169802665710449  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.4169802665710449  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 2449, 128]), torch.Size([1, 2449, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.4196500778198242  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.5052738189697266  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 2449, 128])
m.shape torch.Size([2118, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.5101656913757324  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.5101656913757324  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 2118, 128]), torch.Size([1, 2118, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.512204647064209  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.602783203125  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 2118, 128])
m.shape torch.Size([1802, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.6072235107421875  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.6072235107421875  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 1802, 128]), torch.Size([1, 1802, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.6089420318603516  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.6960811614990234  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 1802, 128])
m.shape torch.Size([1580, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.7012491226196289  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.7012491226196289  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 1580, 128]), torch.Size([1, 1580, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.7027559280395508  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.7886438369750977  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 1580, 128])
m.shape torch.Size([1340, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.7936410903930664  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.7936410903930664  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 1340, 128]), torch.Size([1, 1340, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.7949190139770508  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.879490852355957  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 1340, 128])
m.shape torch.Size([10979, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.9312038421630859  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.9312038421630859  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 5489, 128]), torch.Size([1, 5489, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.9364385604858398  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.3081035614013672  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst 0 shape torch.Size([1, 5489, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.3081035614013672  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.3081035614013672  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 5490, 128]), torch.Size([1, 5490, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.3133392333984375  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.6824545860290527  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst 1 shape torch.Size([1, 5490, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.5962724685668945  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.6290264129638672  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.6617803573608398  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.628770351409912  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

torch.Size([34345, 256])
first layer input nodes number: 48139
first layer output nodes number: 34345
edges number: 205566
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.6621413230895996  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.6948952674865723  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.7039551734924316  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.7039551734924316  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

m.shape torch.Size([3063, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.8794922828674316  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.8794922828674316  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 3063, 256]), torch.Size([1, 3063, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.8863029479980469  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.9353160858154297  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 3063, 256])
m.shape torch.Size([2748, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.937211036682129  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.937211036682129  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 2748, 256]), torch.Size([1, 2748, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.9432191848754883  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.0218400955200195  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 2748, 256])
m.shape torch.Size([2329, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.025935173034668  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.025935173034668  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 2329, 256]), torch.Size([1, 2329, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.0306224822998047  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.1320152282714844  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 2329, 256])
m.shape torch.Size([1856, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.136754035949707  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.136754035949707  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 1856, 256]), torch.Size([1, 1856, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.1405744552612305  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.245333671569824  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 1856, 256])
m.shape torch.Size([1548, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.250792980194092  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.250792980194092  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 1548, 256]), torch.Size([1, 1548, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.2540297508239746  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.3629608154296875  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 1548, 256])
m.shape torch.Size([1290, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.3687195777893066  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.3687195777893066  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 1290, 256]), torch.Size([1, 1290, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.371534824371338  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.48154878616333  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 1290, 256])
m.shape torch.Size([1097, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.4870028495788574  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.4870028495788574  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 1097, 256]), torch.Size([1, 1097, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.4891371726989746  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.59830904006958  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 1097, 256])
m.shape torch.Size([936, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.6042962074279785  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.6042962074279785  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 936, 256]), torch.Size([1, 936, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.606081485748291  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.713545322418213  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 936, 256])
m.shape torch.Size([806, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.7196249961853027  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.7196249961853027  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 806, 256]), torch.Size([1, 806, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.7211623191833496  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.820152759552002  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 806, 256])
m.shape torch.Size([720, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.8263044357299805  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.8263044357299805  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 720, 256]), torch.Size([1, 720, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.8276777267456055  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.926121711730957  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 720, 256])
m.shape torch.Size([641, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.9322123527526855  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.9322123527526855  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 641, 256]), torch.Size([1, 641, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.9334349632263184  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.0299859046936035  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 641, 256])
m.shape torch.Size([534, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.035533905029297  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.035533905029297  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 534, 256]), torch.Size([1, 534, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.0365524291992188  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.1250457763671875  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 534, 256])
m.shape torch.Size([457, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.130246639251709  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.130246639251709  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 457, 256]), torch.Size([1, 457, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.1311182975769043  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.212245464324951  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 457, 256])
m.shape torch.Size([404, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.2172460556030273  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.2172460556030273  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.2180166244506836  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.2955684661865234  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([341, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.3000993728637695  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.3000993728637695  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 341, 256]), torch.Size([1, 341, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.3007497787475586  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.3701858520507812  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 341, 256])
m.shape torch.Size([301, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.3744897842407227  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.3744897842407227  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.375063896179199  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.4411444664001465  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 301, 256])
m.shape torch.Size([312, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.445955276489258  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.445955276489258  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.4465503692626953  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.5191287994384766  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([246, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.523087501525879  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.523087501525879  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.523556709289551  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.583146095275879  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([203, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.5866189002990723  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.5866189002990723  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.587006092071533  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.638889789581299  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([231, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.643136978149414  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.643136978149414  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.6435775756835938  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.7057018280029297  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([206, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.709639549255371  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.709639549255371  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.7100324630737305  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.768183708190918  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([139, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.7713088989257812  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.7713088989257812  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.771574020385742  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.8126678466796875  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([141, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.815652370452881  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.815652370452881  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.8159213066101074  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.8594889640808105  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([131, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.8623766899108887  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.8623766899108887  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.862626552581787  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.904853343963623  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([1736, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.946441650390625  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.946441650390625  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 1736, 256]), torch.Size([1, 1736, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.9497528076171875  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.5325164794921875  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 1736, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.380751132965088  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.384091377258301  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.387431621551514  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.3839240074157715  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

torch.Size([22416, 40])
input nodes number: 34345
output nodes number: 22416
edges number: 178438
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.384239196777344  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.384239673614502  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.04648256301879883  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

pseudo mini batch 2 input nodes size: 90543
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.03804922103881836  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.03804922103881836  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.0812234878540039  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.081390380859375  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.0577855110168457  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.06117963790893555  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.06117963790893555  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.06117963790893555  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

torch.Size([90543, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.06117963790893555  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

m.shape torch.Size([5727, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.21934795379638672  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.21934795379638672  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 5727, 128]), torch.Size([1, 5727, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.2248096466064453  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.27147912979125977  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 5727, 128])
m.shape torch.Size([5719, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.27420997619628906  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.27420997619628906  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 5719, 128]), torch.Size([1, 5719, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.2796640396118164  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.36795616149902344  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 5719, 128])
m.shape torch.Size([4742, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.3712019920349121  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.3712019920349121  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 4742, 128]), torch.Size([1, 4742, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.37575340270996094  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.4785480499267578  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 4742, 128])
m.shape torch.Size([4057, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.483612060546875  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.483612060546875  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 4057, 128]), torch.Size([1, 4057, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.4884653091430664  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.6018538475036621  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 4057, 128])
m.shape torch.Size([3514, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.6082973480224609  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.6082973480224609  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 3514, 128]), torch.Size([1, 3514, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.6119074821472168  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.7356982231140137  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 3514, 128])
m.shape torch.Size([2797, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.7420248985290527  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.7420248985290527  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 2797, 128]), torch.Size([1, 2797, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.745293140411377  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.86328125  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 2797, 128])
m.shape torch.Size([2375, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.8690156936645508  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.8690156936645508  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 2375, 128]), torch.Size([1, 2375, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.871424674987793  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.9950094223022461  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 2375, 128])
m.shape torch.Size([2164, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.002936840057373  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.002936840057373  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 2164, 128]), torch.Size([1, 2164, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.0050349235534668  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.1283960342407227  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 2164, 128])
m.shape torch.Size([1823, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.1351876258850098  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.1351876258850098  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 1823, 128]), torch.Size([1, 1823, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.1369261741638184  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.2481932640075684  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 1823, 128])
m.shape torch.Size([18340, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.3347759246826172  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.3347759246826172  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 9170, 128]), torch.Size([1, 9170, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.3435211181640625  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.9644298553466797  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst 0 shape torch.Size([1, 9170, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.9644298553466797  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.9644298553466797  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 9170, 128]), torch.Size([1, 9170, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.973175048828125  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.5897111892700195  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst 1 shape torch.Size([1, 9170, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.4577488899230957  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.5066323280334473  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.555515766143799  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.5062503814697266  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

torch.Size([51258, 256])
first layer input nodes number: 90543
first layer output nodes number: 51258
edges number: 315715
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.556192398071289  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.6050758361816406  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.6172966957092285  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.6172966957092285  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

m.shape torch.Size([4213, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.7568907737731934  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.7568907737731934  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 4213, 256]), torch.Size([1, 4213, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.765763759613037  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.8300490379333496  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 4213, 256])
m.shape torch.Size([3536, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.8333945274353027  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.8333945274353027  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 3536, 256]), torch.Size([1, 3536, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.8403143882751465  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.942326068878174  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 3536, 256])
m.shape torch.Size([2592, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.946427822113037  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.946427822113037  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 2592, 256]), torch.Size([1, 2592, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.951768398284912  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.061877727508545  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 2592, 256])
m.shape torch.Size([2017, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.0671606063842773  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.0671606063842773  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 2017, 256]), torch.Size([1, 2017, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.071150779724121  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.1832494735717773  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 2017, 256])
m.shape torch.Size([1735, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.189546585083008  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.189546585083008  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 1735, 256]), torch.Size([1, 1735, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.193263053894043  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.317030906677246  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 1735, 256])
m.shape torch.Size([1209, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.321962356567383  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.321962356567383  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 1209, 256]), torch.Size([1, 1209, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.3243908882141113  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.4301466941833496  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 1209, 256])
m.shape torch.Size([968, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.4346184730529785  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.4346184730529785  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 968, 256]), torch.Size([1, 968, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.436464786529541  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.5296807289123535  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 968, 256])
m.shape torch.Size([867, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.53542423248291  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.53542423248291  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 867, 256]), torch.Size([1, 867, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.5370779037475586  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.632120132446289  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 867, 256])
m.shape torch.Size([688, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.637244701385498  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.637244701385498  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 688, 256]), torch.Size([1, 688, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.638556957244873  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.724524974822998  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 688, 256])
m.shape torch.Size([582, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.7294626235961914  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.7294626235961914  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 582, 256]), torch.Size([1, 582, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.7305727005004883  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.809750556945801  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 582, 256])
m.shape torch.Size([487, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.8143444061279297  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.8143444061279297  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 487, 256]), torch.Size([1, 487, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.8152732849121094  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.893768310546875  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 487, 256])
m.shape torch.Size([393, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.897836685180664  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.897836685180664  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 393, 256]), torch.Size([1, 393, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.8985862731933594  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.9772896766662598  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 393, 256])
m.shape torch.Size([355, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.981350898742676  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.981350898742676  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 355, 256]), torch.Size([1, 355, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.982028007507324  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.045466423034668  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 355, 256])
m.shape torch.Size([292, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.0490570068359375  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.0490570068359375  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.049613952636719  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.105835437774658  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([239, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.109003067016602  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.109003067016602  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.109458923339844  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.157779693603516  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([194, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.161434650421143  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.161434650421143  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.161804676055908  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.203617572784424  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([166, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.206145286560059  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.206145286560059  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.2064619064331055  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.2444562911987305  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([168, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.247204780578613  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.247204780578613  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.247525215148926  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.288220405578613  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([140, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.290616989135742  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.290616989135742  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.290884017944336  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.326665878295898  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([137, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.329165935516357  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.329165935516357  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.329427242279053  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.366271495819092  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([113, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.368422031402588  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.368422031402588  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.368637561798096  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.400536060333252  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([77, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.402056694030762  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.402056694030762  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.402203559875488  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.4249677658081055  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([78, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.426619052886963  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.426619052886963  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.426767826080322  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.450869083404541  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([84, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.452732563018799  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.452732563018799  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.452892780303955  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.479969501495361  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([1056, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.505263328552246  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.505263328552246  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 1056, 256]), torch.Size([1, 1056, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.50739860534668  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.867980003356934  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 1056, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.753469944000244  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.756842136383057  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.760178089141846  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.756639003753662  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

torch.Size([22386, 40])
input nodes number: 51258
output nodes number: 22386
edges number: 139770
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.7572197914123535  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.757220268249512  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.06834125518798828  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

pseudo mini batch 3 input nodes size: 93750
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.05781745910644531  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.05781745910644531  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.10252094268798828  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.1026926040649414  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.059351444244384766  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.0659952163696289  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.0659952163696289  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.0659952163696289  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

torch.Size([93750, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.0659952163696289  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

m.shape torch.Size([3895, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.3304476737976074  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.3304476737976074  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 3895, 128]), torch.Size([1, 3895, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.33419227600097656  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.36505889892578125  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 3895, 128])
m.shape torch.Size([4059, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.36707258224487305  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.36707258224487305  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 4059, 128]), torch.Size([1, 4059, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.37144041061401367  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.4298224449157715  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 4059, 128])
m.shape torch.Size([3675, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.43379926681518555  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.43379926681518555  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 3675, 128]), torch.Size([1, 3675, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.4374680519104004  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.516171932220459  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 3675, 128])
m.shape torch.Size([3346, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.520329475402832  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.520329475402832  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 3346, 128]), torch.Size([1, 3346, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.5241494178771973  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.6166882514953613  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 3346, 128])
m.shape torch.Size([3191, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.6227006912231445  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.6227006912231445  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 3191, 128]), torch.Size([1, 3191, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.6258177757263184  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.7358055114746094  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 3191, 128])
m.shape torch.Size([2954, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.7434134483337402  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.7434134483337402  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 2954, 128]), torch.Size([1, 2954, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.7464499473571777  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.8700785636901855  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 2954, 128])
m.shape torch.Size([2807, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.8780393600463867  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.8780393600463867  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 2807, 128]), torch.Size([1, 2807, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.8808093070983887  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.0198588371276855  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 2807, 128])
m.shape torch.Size([2602, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.0284461975097656  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.0284461975097656  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 2602, 128]), torch.Size([1, 2602, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.0310888290405273  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.1796183586120605  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 2602, 128])
m.shape torch.Size([2463, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.1889476776123047  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.1889476776123047  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 2463, 128]), torch.Size([1, 2463, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.1913628578186035  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.3471927642822266  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 2463, 128])
m.shape torch.Size([40414, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.5393776893615723  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.5393776893615723  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 20207, 128]), torch.Size([1, 20207, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.5589089393615723  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.9456276893615723  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst 0 shape torch.Size([1, 20207, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.9456276893615723  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.9456276893615723  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 20207, 128]), torch.Size([1, 20207, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.9651589393615723  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.329224586486816  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst 1 shape torch.Size([1, 20207, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.09326171875  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.159452438354492  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.225643157958984  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.158935070037842  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

torch.Size([69406, 256])
first layer input nodes number: 93750
first layer output nodes number: 69406
edges number: 536873
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.226343631744385  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.292534351348877  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.30908203125  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.30908203125  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

m.shape torch.Size([2595, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.5669708251953125  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.5669708251953125  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 2595, 256]), torch.Size([1, 2595, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.572543621063232  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.61214017868042  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 2595, 256])
m.shape torch.Size([2204, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.6139020919799805  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.6139020919799805  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 2204, 256]), torch.Size([1, 2204, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.618363857269287  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.683123588562012  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 2204, 256])
m.shape torch.Size([1731, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.686013221740723  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.686013221740723  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 1731, 256]), torch.Size([1, 1731, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.689806938171387  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.763707637786865  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 1731, 256])
m.shape torch.Size([1354, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.7672624588012695  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.7672624588012695  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 1354, 256]), torch.Size([1, 1354, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.769973278045654  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.846238136291504  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 1354, 256])
m.shape torch.Size([1192, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.850675582885742  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.850675582885742  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 1192, 256]), torch.Size([1, 1192, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.852972030639648  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.935924530029297  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 1192, 256])
m.shape torch.Size([1012, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.940623760223389  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.940623760223389  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 1012, 256]), torch.Size([1, 1012, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.942553997039795  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.02730131149292  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 1012, 256])
m.shape torch.Size([832, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.031933784484863  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.031933784484863  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 832, 256]), torch.Size([1, 832, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.033520698547363  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.114926338195801  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 832, 256])
m.shape torch.Size([700, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.119515419006348  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.119515419006348  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 700, 256]), torch.Size([1, 700, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.120850563049316  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.199471473693848  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 700, 256])
m.shape torch.Size([664, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.205028533935547  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.205028533935547  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 664, 256]), torch.Size([1, 664, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.206295013427734  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.287349700927734  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 664, 256])
m.shape torch.Size([609, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.292570114135742  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.292570114135742  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 609, 256]), torch.Size([1, 609, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.293731689453125  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.37904167175293  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 609, 256])
m.shape torch.Size([557, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.384349822998047  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.384349822998047  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 557, 256]), torch.Size([1, 557, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.385412216186523  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.470442771911621  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 557, 256])
m.shape torch.Size([517, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.475874423980713  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.475874423980713  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 517, 256]), torch.Size([1, 517, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.476860523223877  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.560852527618408  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 517, 256])
m.shape torch.Size([430, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.565732479095459  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.565732479095459  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 430, 256]), torch.Size([1, 430, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.566552639007568  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.643920421600342  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 430, 256])
m.shape torch.Size([366, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.648435592651367  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.648435592651367  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 366, 256]), torch.Size([1, 366, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.649133682250977  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.718622207641602  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 366, 256])
m.shape torch.Size([374, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.723665237426758  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.723665237426758  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 374, 256]), torch.Size([1, 374, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.72437858581543  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.800090789794922  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 374, 256])
m.shape torch.Size([350, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.805116653442383  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.805116653442383  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 350, 256]), torch.Size([1, 350, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.805784225463867  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.883646011352539  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 350, 256])
m.shape torch.Size([316, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.88847541809082  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.88847541809082  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 316, 256]), torch.Size([1, 316, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.889078140258789  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.962137222290039  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 316, 256])
m.shape torch.Size([335, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.967631816864014  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.967631816864014  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 335, 256]), torch.Size([1, 335, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 5.968270778656006  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 6.050506114959717  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 335, 256])
m.shape torch.Size([314, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 6.0559210777282715  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 6.0559210777282715  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 6.056519985198975  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 6.13803243637085  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 314, 256])
m.shape torch.Size([283, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 6.1431732177734375  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 6.1431732177734375  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 283, 256]), torch.Size([1, 283, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 6.143712997436523  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 6.22073221206665  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 283, 256])
m.shape torch.Size([267, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 6.225851535797119  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 6.225851535797119  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 6.22636079788208  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 6.3026933670043945  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([201, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 6.306689262390137  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 6.306689262390137  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 6.307072639465332  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 6.3664960861206055  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([194, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 6.370593070983887  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 6.370593070983887  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 6.370963096618652  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 6.430907249450684  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([209, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 6.435543537139893  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 6.435543537139893  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 6.43594217300415  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 6.503311634063721  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([5393, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 6.632696151733398  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 6.632696151733398  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

 h.shape torch.Size([1, 5393, 256]), torch.Size([1, 5393, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 6.642982482910156  GigaBytes
Max Memory Allocated: 8.568994522094727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 8.507575035095215  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 5393, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 8.270555973052979  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 8.274137020111084  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes
[04:43:48] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28957872 edges into 4 parts and get 2141557 edge cuts

----------------------------------------after rst
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 8.27771806716919  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 8.27396535873413  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

torch.Size([22999, 40])
input nodes number: 69406
output nodes number: 22999
edges number: 264749
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 8.274863243103027  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 8.274863719940186  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.07669210433959961  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.07669210433959961  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.07669210433959961  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03745943307876587 |0.0033341646194458008 |0.13155055046081543 |9.912252426147461e-05 |0.10050898790359497 |0.0047092437744140625 |
----------------------------------------------------------pseudo_mini_loss sum 4.559362411499023
Total (block generation + training)time/epoch 23.234208583831787
* Pure training time/epoch 1.0965182781219482
Training time/epoch 1.1353812217712402
Training time without block to device /epoch 1.122044563293457
Training time without total dataloading part /epoch 0.9333438873291016
load block tensor time/epoch 0.14983773231506348
block to device time/epoch 0.013336658477783203
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  494086
Number of first layer input nodes during this epoch:  297601
Number of first layer output nodes during this epoch:  196485
----------------------------------------before generate dataloader block 
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.0766916275024414  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.016024351119995117
global_2_local spend time (sec) 0.04602861404418945
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004391670227050781
A = g.adjacency_matrix() spent  0.007794857025146484
auxiliary_graph
Graph(num_nodes=154614, num_edges=29048813,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07917666435241699
remove nodes length
63673
auxiliary_graph.remove_nodes spent  1.2946622371673584
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29048813,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1639420986175537

the counter of shared neighbor distribution
Counter({1.0: 23402436, 2.0: 4027368, 3.0: 1011142, 4.0: 307344, 5.0: 112146, 6.0: 48448, 7.0: 22696, 8.0: 11506, 9.0: 6294, 10.0: 3494, 11.0: 1966, 12.0: 1128, 13.0: 656, 14.0: 434, 15.0: 300, 16.0: 212, 17.0: 164, 18.0: 68, 19.0: 54, 20.0: 10, 21.0: 6})
28957872
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28957869, 28957870, 28957871])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23402436, 2.0: 4027368, 3.0: 1011142, 4.0: 307344, 5.0: 112146, 6.0: 48448, 7.0: 22696, 8.0: 11506, 9.0: 6294, 10.0: 3494, 11.0: 1966, 12.0: 1128, 13.0: 656, 14.0: 434, 15.0: 300, 16.0: 212, 17.0: 164, 18.0: 68, 19.0: 54, 20.0: 10, 21.0: 6})
Convert a graph into a bidirected graph: 1.327 seconds
Metis partitioning: 4.953 seconds
Split the graph: 3.218 seconds
Construct subgraphs: 0.077 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  9.588578939437866
23177
23092
22335
22337
total k batches seeds list generation spend  19.495808839797974
after graph partition
graph partition algorithm spend time 19.61987829208374
23177
23092
22335
22337
partition_len_list
[41886, 35774, 68865, 53921]
shared_neighbor_graph_partition_s0 selection method  spend 19.717167854309082
time for parepare:  0.016291141510009766
local_output_nid generation:  0.0032427310943603516
local_in_edges_tensor generation:  0.0036525726318359375
mini_batch_src_global generation:  0.00548100471496582
r_  generation:  0.057090044021606445
local_output_nid generation:  0.004025697708129883
local_in_edges_tensor generation:  0.003666400909423828
mini_batch_src_global generation:  0.007589101791381836
r_  generation:  0.06135439872741699
local_output_nid generation:  0.003901958465576172
local_in_edges_tensor generation:  0.004614114761352539
mini_batch_src_global generation:  0.008628606796264648
r_  generation:  0.08478784561157227
local_output_nid generation:  0.00432133674621582
local_in_edges_tensor generation:  0.003583192825317383
mini_batch_src_global generation:  0.006544828414916992
r_  generation:  0.05654263496398926
----------------------check_connections_block total spend ----------------------------- 0.3982727527618408
generate_one_block  0.08109283447265625
generate_one_block  0.07974910736083984
generate_one_block  0.13178586959838867
generate_one_block  0.06934928894042969
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0357966423034668
gen group dst list time:  0.005475521087646484
time for parepare:  0.019652843475341797
local_output_nid generation:  0.006259918212890625
local_in_edges_tensor generation:  0.048956871032714844
mini_batch_src_global generation:  0.00766444206237793
r_  generation:  0.08829903602600098
local_output_nid generation:  0.00751042366027832
local_in_edges_tensor generation:  0.006804466247558594
mini_batch_src_global generation:  0.009268760681152344
r_  generation:  0.07727909088134766
local_output_nid generation:  0.011739969253540039
local_in_edges_tensor generation:  0.016858816146850586
mini_batch_src_global generation:  0.019582509994506836
r_  generation:  0.1889476776123047
local_output_nid generation:  0.011588096618652344
local_in_edges_tensor generation:  0.010789871215820312
mini_batch_src_global generation:  0.013728618621826172
r_  generation:  0.13252592086791992
----------------------check_connections_block total spend ----------------------------- 0.7872061729431152
generate_one_block  0.11186051368713379
generate_one_block  0.09580039978027344
generate_one_block  0.2365117073059082
generate_one_block  0.1600956916809082
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.0766916275024414  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

connection checking time:  1.185478925704956
block generation total time  0.9662454128265381
average batch blocks generation time:  0.24156135320663452
block dataloader generation time/epoch 22.05670201778412
pseudo mini batch 0 input nodes size: 65606
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.05955934524536133  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.05955934524536133  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.09084272384643555  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.09101581573486328  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.04614067077636719  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.04919719696044922  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.04919719696044922  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.04919719696044922  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

torch.Size([65606, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.04919719696044922  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

m.shape torch.Size([4850, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.17150449752807617  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.17150449752807617  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 4850, 128]), torch.Size([1, 4850, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.1769709587097168  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.21428442001342773  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 4850, 128])
m.shape torch.Size([4979, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.2167201042175293  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.2167201042175293  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 4979, 128]), torch.Size([1, 4979, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.22156238555908203  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.2927875518798828  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 4979, 128])
m.shape torch.Size([4329, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.29660606384277344  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.29660606384277344  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 4329, 128]), torch.Size([1, 4329, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.30105018615722656  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.39319467544555664  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 4329, 128])
m.shape torch.Size([3707, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.3979201316833496  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.3979201316833496  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 3707, 128]), torch.Size([1, 3707, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.40203285217285156  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.5045557022094727  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 3707, 128])
m.shape torch.Size([3133, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.5102577209472656  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.5102577209472656  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 3133, 128]), torch.Size([1, 3133, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.513646125793457  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.622410774230957  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 3133, 128])
m.shape torch.Size([2559, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.6282382011413574  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.6282382011413574  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 2559, 128]), torch.Size([1, 2559, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.630760669708252  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.7501235008239746  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 2559, 128])
m.shape torch.Size([2235, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.7563633918762207  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.7563633918762207  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 2235, 128]), torch.Size([1, 2235, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.7585387229919434  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.8726682662963867  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 2235, 128])
m.shape torch.Size([2002, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.8783564567565918  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.8783564567565918  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 2002, 128]), torch.Size([1, 2002, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.8802657127380371  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.9912867546081543  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 2002, 128])
m.shape torch.Size([1681, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.9975461959838867  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.9975461959838867  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 1681, 128]), torch.Size([1, 1681, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.9991493225097656  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.1030659675598145  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 1681, 128])
m.shape torch.Size([12411, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.1614446640014648  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.1614446640014648  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 6205, 128]), torch.Size([1, 6205, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.1679034233093262  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.5880494117736816  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst 0 shape torch.Size([1, 6205, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.5880494117736816  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.5880494117736816  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 6206, 128]), torch.Size([1, 6206, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.5939679145812988  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.0112228393554688  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst 1 shape torch.Size([1, 6206, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.9108452796936035  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.9507908821105957  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.990736484527588  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.9504785537719727  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

torch.Size([41886, 256])
first layer input nodes number: 65606
first layer output nodes number: 41886
edges number: 244542
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.991227626800537  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.0311732292175293  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.0411596298217773  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.0411596298217773  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

m.shape torch.Size([3528, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.2047033309936523  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.2047033309936523  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 3528, 256]), torch.Size([1, 3528, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.211432456970215  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.2671728134155273  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 3528, 256])
m.shape torch.Size([3163, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.269928455352783  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.269928455352783  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 3163, 256]), torch.Size([1, 3163, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.2763094902038574  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.3668036460876465  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 3163, 256])
m.shape torch.Size([2514, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.3713088035583496  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.3713088035583496  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 2514, 256]), torch.Size([1, 2514, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.376521110534668  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.484250545501709  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 2514, 256])
m.shape torch.Size([2072, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.489819049835205  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.489819049835205  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 2072, 256]), torch.Size([1, 2072, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.4939074516296387  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.6107592582702637  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 2072, 256])
m.shape torch.Size([1712, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.6170105934143066  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.6170105934143066  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 1712, 256]), torch.Size([1, 1712, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.6204190254211426  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.740558624267578  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 1712, 256])
m.shape torch.Size([1327, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.7465367317199707  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.7465367317199707  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 1327, 256]), torch.Size([1, 1327, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.7492799758911133  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.863741397857666  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 1327, 256])
m.shape torch.Size([1162, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.869781017303467  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.869781017303467  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 1162, 256]), torch.Size([1, 1162, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.872107982635498  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.9857120513916016  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 1162, 256])
m.shape torch.Size([1004, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.9916534423828125  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.9916534423828125  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 1004, 256]), torch.Size([1, 1004, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.9935684204101562  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.1046295166015625  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 1004, 256])
m.shape torch.Size([827, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.110826015472412  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.110826015472412  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 827, 256]), torch.Size([1, 827, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.112403392791748  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.217433452606201  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 827, 256])
m.shape torch.Size([687, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.22324800491333  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.22324800491333  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 687, 256]), torch.Size([1, 687, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.2245583534240723  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.3178296089172363  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 687, 256])
m.shape torch.Size([559, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.323084831237793  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.323084831237793  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 559, 256]), torch.Size([1, 559, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.324151039123535  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.4084949493408203  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 559, 256])
m.shape torch.Size([519, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.4139480590820312  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.4139480590820312  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 519, 256]), torch.Size([1, 519, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.414937973022461  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.4990806579589844  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 519, 256])
m.shape torch.Size([419, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.50382137298584  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.50382137298584  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 419, 256]), torch.Size([1, 419, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.5046205520629883  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.58195161819458  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 419, 256])
m.shape torch.Size([378, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.5866384506225586  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.5866384506225586  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 378, 256]), torch.Size([1, 378, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.5873594284057617  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.6604061126708984  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 378, 256])
m.shape torch.Size([353, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.665134906768799  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.665134906768799  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 353, 256]), torch.Size([1, 353, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.6658082008361816  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.739549160003662  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 353, 256])
m.shape torch.Size([288, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.7436413764953613  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.7436413764953613  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.7441906929016113  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.808311939239502  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([248, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.812089443206787  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.812089443206787  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.8125624656677246  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.8693251609802246  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([214, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.872791290283203  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.872791290283203  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.873199462890625  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.925037384033203  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([185, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.9282116889953613  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.9282116889953613  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.9285645484924316  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.9758477210998535  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([171, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.9789586067199707  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.9789586067199707  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.9792847633361816  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.025272846221924  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([146, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.028184413909912  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.028184413909912  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.028462886810303  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.069676876068115  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([138, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.072455883026123  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.072455883026123  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.072719097137451  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.1135172843933105  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([128, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.116215229034424  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.116215229034424  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.116459369659424  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.156010150909424  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([104, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.158287048339844  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.158287048339844  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.158485412597656  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.192008972167969  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([1331, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.223891258239746  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.223891258239746  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 1331, 256]), torch.Size([1, 1331, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.2264299392700195  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.680890083312988  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 1331, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.541127681732178  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.544740200042725  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.54819393157959  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.544408321380615  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

torch.Size([23177, 40])
input nodes number: 41886
output nodes number: 23177
edges number: 165524
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.544925212860107  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 4.544926166534424  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.0552067756652832  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

pseudo mini batch 1 input nodes size: 50765
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.046173095703125  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.046173095703125  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.07037973403930664  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.07055187225341797  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.039095401763916016  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.04204511642456055  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.04204511642456055  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.04204511642456055  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

torch.Size([50765, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.04204511642456055  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

m.shape torch.Size([4039, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.14873790740966797  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.14873790740966797  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 4039, 128]), torch.Size([1, 4039, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.1525897979736328  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.1837310791015625  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 4039, 128])
m.shape torch.Size([4054, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.18565702438354492  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.18565702438354492  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 4054, 128]), torch.Size([1, 4054, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.18967914581298828  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.24791240692138672  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 4054, 128])
m.shape torch.Size([3596, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.2510032653808594  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.2510032653808594  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 3596, 128]), torch.Size([1, 3596, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.2548046112060547  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.3322610855102539  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 3596, 128])
m.shape torch.Size([3012, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.3365640640258789  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.3365640640258789  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 3012, 128]), torch.Size([1, 3012, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.34049081802368164  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.4265408515930176  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 3012, 128])
m.shape torch.Size([2598, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.43129873275756836  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.43129873275756836  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 2598, 128]), torch.Size([1, 2598, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.4347224235534668  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.5284724235534668  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 2598, 128])
m.shape torch.Size([2234, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.5336251258850098  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.5336251258850098  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 2234, 128]), torch.Size([1, 2234, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.5359797477722168  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.6298174858093262  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 2234, 128])
m.shape torch.Size([1856, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.634946346282959  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.634946346282959  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 1856, 128]), torch.Size([1, 1856, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.636716365814209  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.725217342376709  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 1856, 128])
m.shape torch.Size([1631, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.7305541038513184  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.7305541038513184  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 1631, 128]), torch.Size([1, 1631, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.732109546661377  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.8210272789001465  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 1631, 128])
m.shape torch.Size([1394, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.8262319564819336  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.8262319564819336  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 1394, 128]), torch.Size([1, 1394, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.8275613784790039  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.9157800674438477  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 1394, 128])
m.shape torch.Size([11360, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.9698028564453125  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.9698028564453125  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 5680, 128]), torch.Size([1, 5680, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 0.9752197265625  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.3644447326660156  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst 0 shape torch.Size([1, 5680, 128])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.3644447326660156  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.3644447326660156  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 5680, 128]), torch.Size([1, 5680, 128])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.3704338073730469  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.7557563781738281  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst 1 shape torch.Size([1, 5680, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.6670255661010742  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.7011423110961914  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.7352590560913086  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.7008757591247559  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

torch.Size([35774, 256])
first layer input nodes number: 50765
first layer output nodes number: 35774
edges number: 213563
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.7356395721435547  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.7697563171386719  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.7784538269042969  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.7784538269042969  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

m.shape torch.Size([3118, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.9577388763427734  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.9577388763427734  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 3118, 256]), torch.Size([1, 3118, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 1.9643001556396484  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.0118770599365234  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 3118, 256])
m.shape torch.Size([2845, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.0143723487854004  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.0143723487854004  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 2845, 256]), torch.Size([1, 2845, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.020059108734131  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.1025328636169434  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 2845, 256])
m.shape torch.Size([2422, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.106264591217041  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.106264591217041  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 2422, 256]), torch.Size([1, 2422, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.111036777496338  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.215294361114502  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 2422, 256])
m.shape torch.Size([1943, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.220454692840576  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.220454692840576  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 1943, 256]), torch.Size([1, 1943, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.224313735961914  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.333707809448242  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 1943, 256])
m.shape torch.Size([1616, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.339621067047119  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.339621067047119  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 1616, 256]), torch.Size([1, 1616, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.3430256843566895  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.454507350921631  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 1616, 256])
m.shape torch.Size([1365, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.4617247581481934  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.4617247581481934  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 1365, 256]), torch.Size([1, 1365, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.4646286964416504  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.57912015914917  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 1365, 256])
m.shape torch.Size([1114, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.58530855178833  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.58530855178833  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 1114, 256]), torch.Size([1, 1114, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.5874733924865723  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.6966586112976074  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 1114, 256])
m.shape torch.Size([958, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.702758312225342  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.702758312225342  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 958, 256]), torch.Size([1, 958, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.704585552215576  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.8087382316589355  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 958, 256])
m.shape torch.Size([849, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.815168857574463  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.815168857574463  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 849, 256]), torch.Size([1, 849, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.8167881965637207  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.9238972663879395  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 849, 256])
m.shape torch.Size([742, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.9302191734313965  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.9302191734313965  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 742, 256]), torch.Size([1, 742, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 2.9316344261169434  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.0321173667907715  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 742, 256])
m.shape torch.Size([670, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.0384936332702637  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.0384936332702637  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 670, 256]), torch.Size([1, 670, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.039771556854248  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.1394495964050293  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 670, 256])
m.shape torch.Size([547, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.1451196670532227  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.1451196670532227  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 547, 256]), torch.Size([1, 547, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.146162986755371  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.2404518127441406  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 547, 256])
m.shape torch.Size([481, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.2459402084350586  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.2459402084350586  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 481, 256]), torch.Size([1, 481, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.2468576431274414  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.33126163482666  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 481, 256])
m.shape torch.Size([425, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.336521625518799  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.336521625518799  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 425, 256]), torch.Size([1, 425, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.337332248687744  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.418867588043213  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 425, 256])
m.shape torch.Size([356, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.4235949516296387  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.4235949516296387  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 356, 256]), torch.Size([1, 356, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.42427396774292  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.497466564178467  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 356, 256])
m.shape torch.Size([306, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.501832962036133  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.501832962036133  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.5024166107177734  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.571603775024414  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([309, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.5763611793518066  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.5763611793518066  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.5769505500793457  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.6501688957214355  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 309, 256])
m.shape torch.Size([245, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.6541128158569336  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.6541128158569336  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.6545801162719727  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.7139272689819336  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([208, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.71749210357666  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.71749210357666  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.717888832092285  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.771050453186035  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([233, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.7753310203552246  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.7753310203552246  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.77577543258667  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.838437557220459  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([199, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.8422322273254395  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.8422322273254395  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.842611789703369  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.898787021636963  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([145, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.9017481803894043  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.9017481803894043  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.902024745941162  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.944892406463623  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([137, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.9477829933166504  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.9477829933166504  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.9480443000793457  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.9903759956359863  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([136, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.993382453918457  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.993382453918457  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 10.9041748046875 GB
    Memory Allocated: 3.9936418533325195  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9061279296875 GB
    Memory Allocated: 4.037480354309082  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([1723, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.9061279296875 GB
    Memory Allocated: 4.078751564025879  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9061279296875 GB
    Memory Allocated: 4.078751564025879  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 1723, 256]), torch.Size([1, 1723, 256])
----------------------------------------3
 Nvidia-smi: 10.9061279296875 GB
    Memory Allocated: 4.082037925720215  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9061279296875 GB
    Memory Allocated: 4.662181854248047  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 1723, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9061279296875 GB
    Memory Allocated: 4.505928993225098  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9061279296875 GB
    Memory Allocated: 4.50937032699585  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.9061279296875 GB
    Memory Allocated: 4.512811660766602  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.9061279296875 GB
    Memory Allocated: 4.509198188781738  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

torch.Size([23092, 40])
input nodes number: 35774
output nodes number: 23092
edges number: 182146
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9061279296875 GB
    Memory Allocated: 4.50946569442749  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.9061279296875 GB
    Memory Allocated: 4.509466171264648  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.047618865966796875  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

pseudo mini batch 2 input nodes size: 93688
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.038924217224121094  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.038924217224121094  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.08359813690185547  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.08376455307006836  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.05938577651977539  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.06621932983398438  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.06621932983398438  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.06621932983398438  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

torch.Size([93688, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.06621932983398438  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

m.shape torch.Size([3727, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.33037471771240234  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.33037471771240234  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 3727, 128]), torch.Size([1, 3727, 128])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.3346266746520996  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.36306142807006836  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 3727, 128])
m.shape torch.Size([4012, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.3658943176269531  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.3658943176269531  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 4012, 128]), torch.Size([1, 4012, 128])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.37064027786254883  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.4287533760070801  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 4012, 128])
m.shape torch.Size([3632, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.431795597076416  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.431795597076416  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 3632, 128]), torch.Size([1, 3632, 128])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.43610239028930664  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.5135102272033691  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 3632, 128])
m.shape torch.Size([3251, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.5183014869689941  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.5183014869689941  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 3251, 128]), torch.Size([1, 3251, 128])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.5215835571289062  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.6119170188903809  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 3251, 128])
m.shape torch.Size([3198, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.6179914474487305  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.6179914474487305  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 3198, 128]), torch.Size([1, 3198, 128])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.6212325096130371  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.7316765785217285  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 3198, 128])
m.shape torch.Size([2908, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.7382550239562988  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.7382550239562988  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 2908, 128]), torch.Size([1, 2908, 128])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.7413830757141113  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.8642897605895996  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 2908, 128])
m.shape torch.Size([2726, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.8726096153259277  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.8726096153259277  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 2726, 128]), torch.Size([1, 2726, 128])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.8752646446228027  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 1.0098423957824707  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 2726, 128])
m.shape torch.Size([2523, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 1.017493724822998  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 1.017493724822998  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 2523, 128]), torch.Size([1, 2523, 128])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 1.021440029144287  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 1.1606159210205078  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 2523, 128])
m.shape torch.Size([2459, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 1.1702404022216797  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 1.1702404022216797  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 2459, 128]), torch.Size([1, 2459, 128])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 1.172595500946045  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 1.32850980758667  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 2459, 128])
m.shape torch.Size([40429, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 1.5206966400146484  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 1.5206966400146484  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 20214, 128]), torch.Size([1, 20214, 128])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 1.5402278900146484  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 2.9269466400146484  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst 0 shape torch.Size([1, 20214, 128])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 2.9269466400146484  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 2.9269466400146484  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 20215, 128]), torch.Size([1, 20215, 128])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 2.9464778900146484  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.311174392700195  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst 1 shape torch.Size([1, 20215, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.0769500732421875  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.142624855041504  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.20829963684082  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.142111301422119  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

torch.Size([68865, 256])
first layer input nodes number: 93688
first layer output nodes number: 68865
edges number: 534776
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.2089996337890625  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.274674415588379  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.291093349456787  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.291093349456787  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

m.shape torch.Size([2517, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.541950702667236  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.541950702667236  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 2517, 256]), torch.Size([1, 2517, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.546751499176025  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.586090564727783  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 2517, 256])
m.shape torch.Size([2160, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.5885233879089355  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.5885233879089355  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 2160, 256]), torch.Size([1, 2160, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.5926432609558105  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.655148029327393  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 2160, 256])
m.shape torch.Size([1678, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.657926559448242  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.657926559448242  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 1678, 256]), torch.Size([1, 1678, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.661348342895508  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.733645915985107  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 1678, 256])
m.shape torch.Size([1329, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.737155437469482  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.737155437469482  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 1329, 256]), torch.Size([1, 1329, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.739786624908447  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.815193176269531  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 1329, 256])
m.shape torch.Size([1203, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.819706916809082  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.819706916809082  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 1203, 256]), torch.Size([1, 1203, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.8220977783203125  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.906693935394287  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 1203, 256])
m.shape torch.Size([930, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.911352634429932  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.911352634429932  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 930, 256]), torch.Size([1, 930, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.913126468658447  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.990175724029541  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 930, 256])
m.shape torch.Size([818, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.994792461395264  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.994792461395264  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 818, 256]), torch.Size([1, 818, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.996352672576904  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.077523708343506  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 818, 256])
m.shape torch.Size([676, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.081941604614258  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.081941604614258  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 676, 256]), torch.Size([1, 676, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.083230972290039  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.157663345336914  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 676, 256])
m.shape torch.Size([643, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.162580966949463  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.162580966949463  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 643, 256]), torch.Size([1, 643, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.163807392120361  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.242298603057861  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 643, 256])
m.shape torch.Size([605, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.247500419616699  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.247500419616699  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 605, 256]), torch.Size([1, 605, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.248654365539551  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.330744743347168  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 605, 256])
m.shape torch.Size([520, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.335894584655762  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.335894584655762  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 520, 256]), torch.Size([1, 520, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.336886405944824  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.414486885070801  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 520, 256])
m.shape torch.Size([500, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.419757843017578  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.419757843017578  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 500, 256]), torch.Size([1, 500, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.420711517333984  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.503223419189453  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 500, 256])
m.shape torch.Size([421, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.508007049560547  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.508007049560547  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 421, 256]), torch.Size([1, 421, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.508810043334961  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.584383010864258  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 421, 256])
m.shape torch.Size([362, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.588852882385254  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.588852882385254  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 362, 256]), torch.Size([1, 362, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.589543342590332  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.658707618713379  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 362, 256])
m.shape torch.Size([357, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.663509368896484  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.663509368896484  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 357, 256]), torch.Size([1, 357, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.664190292358398  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.738009452819824  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 357, 256])
m.shape torch.Size([324, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.742651462554932  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.742651462554932  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 324, 256]), torch.Size([1, 324, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.743269443511963  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.813818454742432  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 324, 256])
m.shape torch.Size([305, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.818493366241455  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.818493366241455  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.819075107574463  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.890977382659912  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([314, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.896298408508301  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.896298408508301  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.896897315979004  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.974057197570801  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 314, 256])
m.shape torch.Size([292, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.979090213775635  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.979090213775635  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.979647159576416  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 6.055871486663818  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([278, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 6.06093692779541  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 6.06093692779541  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 6.061467170715332  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 6.138222694396973  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([263, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 6.143266201019287  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 6.143266201019287  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 6.143767833709717  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 6.2198052406311035  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([194, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 6.22365665435791  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 6.22365665435791  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 6.224026679992676  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 6.281380653381348  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([192, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 6.285439968109131  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 6.285439968109131  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 6.285806179046631  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 6.345132350921631  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([196, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 6.349470615386963  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 6.349470615386963  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 6.349844455718994  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 6.413023471832275  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([5258, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 6.539188861846924  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 6.539188861846924  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 5258, 256]), torch.Size([1, 5258, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 6.549217700958252  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 8.31526231765747  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 5258, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 8.084667682647705  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 8.088047504425049  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 8.092272281646729  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 8.088726043701172  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

torch.Size([22335, 40])
input nodes number: 68865
output nodes number: 22335
edges number: 256859
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 8.089344501495361  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 8.08934497833252  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.07727861404418945  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

pseudo mini batch 3 input nodes size: 94696
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.05932426452636719  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.05932426452636719  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.10447883605957031  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.1046457290649414  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.05980539321899414  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.06337213516235352  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.06337213516235352  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.06337213516235352  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

torch.Size([94696, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.06337213516235352  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

m.shape torch.Size([5820, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.2322850227355957  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.2322850227355957  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 5820, 128]), torch.Size([1, 5820, 128])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.23783540725708008  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.28409242630004883  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 5820, 128])
m.shape torch.Size([5802, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.28748559951782227  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.28748559951782227  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 5802, 128]), torch.Size([1, 5802, 128])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.2936539649963379  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.38187074661254883  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 5802, 128])
m.shape torch.Size([4890, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.38609933853149414  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.38609933853149414  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 4890, 128]), torch.Size([1, 4890, 128])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.3907628059387207  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.49383974075317383  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 4890, 128])
m.shape torch.Size([4057, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.49918603897094727  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.49918603897094727  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 4057, 128]), torch.Size([1, 4057, 128])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.503969669342041  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.6167302131652832  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 4057, 128])
m.shape torch.Size([3512, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.6231689453125  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.6231689453125  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 3512, 128]), torch.Size([1, 3512, 128])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.6267781257629395  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.7508664131164551  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 3512, 128])
m.shape torch.Size([2872, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.757408618927002  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.757408618927002  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 2872, 128]), torch.Size([1, 2872, 128])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.761385440826416  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.8806405067443848  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 2872, 128])
m.shape torch.Size([2512, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.8878464698791504  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.8878464698791504  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 2512, 128]), torch.Size([1, 2512, 128])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.8903298377990723  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 1.0149993896484375  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 2512, 128])
m.shape torch.Size([2223, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 1.0219154357910156  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 1.0219154357910156  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 2223, 128]), torch.Size([1, 2223, 128])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 1.02459716796875  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 1.150026798248291  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 2223, 128])
m.shape torch.Size([1919, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 1.1572022438049316  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 1.1572022438049316  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 1919, 128]), torch.Size([1, 1919, 128])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 1.1590323448181152  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 1.2767095565795898  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 1919, 128])
m.shape torch.Size([20314, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 1.373450756072998  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 1.373450756072998  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 10157, 128]), torch.Size([1, 10157, 128])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 1.3831372261047363  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 2.076575756072998  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst 0 shape torch.Size([1, 10157, 128])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 2.076575756072998  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 2.076575756072998  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 10157, 128]), torch.Size([1, 10157, 128])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 2.0862622261047363  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 2.774857521057129  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst 1 shape torch.Size([1, 10157, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 2.6319780349731445  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 2.683401107788086  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 2.7348241806030273  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 2.6829991340637207  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

torch.Size([53921, 256])
first layer input nodes number: 94696
first layer output nodes number: 53921
edges number: 338893
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 2.735531806945801  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 2.786954879760742  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 2.7998108863830566  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 2.7998108863830566  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

m.shape torch.Size([4265, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 2.9390501976013184  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 2.9390501976013184  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 4265, 256]), torch.Size([1, 4265, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 2.9471850395202637  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.012263774871826  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 4265, 256])
m.shape torch.Size([3538, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.0149974822998047  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.0149974822998047  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 3538, 256]), torch.Size([1, 3538, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.0220017433166504  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.123918056488037  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 3538, 256])
m.shape torch.Size([2663, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.1282224655151367  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.1282224655151367  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 2663, 256]), torch.Size([1, 2663, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.133491039276123  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.248277187347412  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 2663, 256])
m.shape torch.Size([1976, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.2523789405822754  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.2523789405822754  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 1976, 256]), torch.Size([1, 1976, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.2567896842956543  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.3690648078918457  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 1976, 256])
m.shape torch.Size([1691, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.3746204376220703  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.3746204376220703  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 1691, 256]), torch.Size([1, 1691, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.377927303314209  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.4986891746520996  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 1691, 256])
m.shape torch.Size([1246, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.5033035278320312  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.5033035278320312  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 1246, 256]), torch.Size([1, 1246, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.5057315826416016  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.611414909362793  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 1246, 256])
m.shape torch.Size([951, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.6172118186950684  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.6172118186950684  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 951, 256]), torch.Size([1, 951, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.619025707244873  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.7097201347351074  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 951, 256])
m.shape torch.Size([834, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.715226173400879  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.715226173400879  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 834, 256]), torch.Size([1, 834, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.7168169021606445  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.8088159561157227  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 834, 256])
m.shape torch.Size([657, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.813704013824463  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.813704013824463  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 657, 256]), torch.Size([1, 657, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.8149571418762207  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.8958287239074707  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 657, 256])
m.shape torch.Size([565, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.900632858276367  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.900632858276367  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 565, 256]), torch.Size([1, 565, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.9017105102539062  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.9786243438720703  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 565, 256])
m.shape torch.Size([454, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.9828858375549316  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.9828858375549316  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 454, 256]), torch.Size([1, 454, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 3.9837517738342285  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.053022861480713  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 454, 256])
m.shape torch.Size([371, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.056869029998779  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.056869029998779  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 371, 256]), torch.Size([1, 371, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.057576656341553  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.118457317352295  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 371, 256])
m.shape torch.Size([335, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.122289657592773  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.122289657592773  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 335, 256]), torch.Size([1, 335, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.122928619384766  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.1828203201293945  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 335, 256])
m.shape torch.Size([269, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.186120510101318  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.186120510101318  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.186633586883545  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.238976955413818  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([223, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.241935729980469  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.241935729980469  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.242361068725586  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.287446975708008  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([193, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.290202617645264  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.290202617645264  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.2905707359313965  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.332168102264404  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([168, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.334729194641113  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.334729194641113  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.335049629211426  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.373501777648926  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([175, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.376369476318359  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.376369476318359  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.376703262329102  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.419094085693359  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([151, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.422413349151611  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.422413349151611  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.422701358795166  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.461294651031494  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([125, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.4635539054870605  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.4635539054870605  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.463792324066162  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.497409343719482  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([109, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.499490261077881  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.499490261077881  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.499698162078857  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.530467510223389  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([79, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.532034397125244  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.532034397125244  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.532185077667236  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.555540561676025  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([62, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.556836128234863  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.556836128234863  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.556954383850098  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.576111793518066  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([89, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.578105926513672  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.578105926513672  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.578275680541992  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.606964111328125  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes
Using backend: pytorch

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([1148, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.634463787078857  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.634463787078857  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

 h.shape torch.Size([1, 1148, 256]), torch.Size([1, 1148, 256])
----------------------------------------3
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.637485027313232  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 5.035532474517822  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

rst.shape  torch.Size([1, 1148, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.920632839202881  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.924006938934326  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.928074359893799  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.924533367156982  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

torch.Size([22337, 40])
input nodes number: 53921
output nodes number: 22337
edges number: 139721
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.92509651184082  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 4.9250969886779785  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.07013702392578125  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.07013702392578125  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 10.9100341796875 GB
    Memory Allocated: 0.07013702392578125  GigaBytes
Max Memory Allocated: 8.636154174804688  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04338425397872925 |0.0031757354736328125 |0.13372766971588135 |9.888410568237305e-05 |0.09176546335220337 |0.004620790481567383 |
----------------------------------------------------------pseudo_mini_loss sum 3.574998378753662
Total (block generation + training)time/epoch 23.195760369300842
* Pure training time/epoch 1.093228816986084
Training time/epoch 1.1419408321380615
Training time without block to device /epoch 1.1292378902435303
Training time without total dataloading part /epoch 0.9069888591766357
load block tensor time/epoch 0.173537015914917
block to device time/epoch 0.01270294189453125
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  505201
Number of first layer input nodes during this epoch:  304755
Number of first layer output nodes during this epoch:  200446
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
