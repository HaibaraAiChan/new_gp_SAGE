[04:47:04] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28871986 edges into 32 parts and get 9307027 edge cuts
main start at this time 1652849202.995633
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

<class 'int'>
<class 'int'>
----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06921815872192383
global_2_local spend time (sec) 0.036606788635253906
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004377603530883789
A = g.adjacency_matrix() spent  0.008875608444213867
auxiliary_graph
Graph(num_nodes=154611, num_edges=28962927,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07803225517272949
remove nodes length
63670
auxiliary_graph.remove_nodes spent  1.2824742794036865
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28962927,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.291067123413086

the counter of shared neighbor distribution
Counter({1.0: 23350590, 2.0: 4010844, 3.0: 1004314, 4.0: 300894, 5.0: 109354, 6.0: 47662, 7.0: 22182, 8.0: 11490, 9.0: 6150, 10.0: 3490, 11.0: 2010, 12.0: 1100, 13.0: 704, 14.0: 414, 15.0: 272, 16.0: 202, 17.0: 172, 18.0: 78, 19.0: 52, 21.0: 8, 20.0: 4})
28871986
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28871983, 28871984, 28871985])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23350590, 2.0: 4010844, 3.0: 1004314, 4.0: 300894, 5.0: 109354, 6.0: 47662, 7.0: 22182, 8.0: 11490, 9.0: 6150, 10.0: 3490, 11.0: 2010, 12.0: 1100, 13.0: 704, 14.0: 414, 15.0: 272, 16.0: 202, 17.0: 172, 18.0: 78, 19.0: 52, 21.0: 8, 20.0: 4})
Convert a graph into a bidirected graph: 1.257 seconds
Metis partitioning: 5.300 seconds
Split the graph: 0.553 seconds
Construct subgraphs: 0.076 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  7.19844126701355
2823
2860
2823
2819
2895
2837
2872
2887
2895
2874
2927
2864
2914
2914
2875
2901
2916
2906
2895
2925
2771
2768
2758
2758
2766
2758
2777
2783
2758
2758
2758
2906
total k batches seeds list generation spend  17.398558855056763
after graph partition
graph partition algorithm spend time 17.478477239608765
2823
2860
2823
2819
2895
2837
2872
2887
2895
2874
2927
2864
2914
2914
2875
2901
2916
2906
2895
2925
2771
2768
2758
2758
2766
2758
2777
2783
2758
2758
2758
2906
partition_len_list
[6847, 7288, 8884, 7586, 6044, 5886, 6083, 6772, 7534, 7873, 5255, 5001, 7356, 6345, 5653, 5551, 7716, 6875, 8105, 9264, 11588, 10378, 12195, 15654, 18975, 18258, 15175, 14012, 15866, 16528, 18271, 18199]
shared_neighbor_graph_partition_s0 selection method  spend 17.56838583946228
time for parepare:  0.01717352867126465
local_output_nid generation:  0.0006542205810546875
local_in_edges_tensor generation:  0.0008697509765625
mini_batch_src_global generation:  0.0010693073272705078
r_  generation:  0.006684303283691406
local_output_nid generation:  0.0007090568542480469
local_in_edges_tensor generation:  0.0007746219635009766
mini_batch_src_global generation:  0.0010821819305419922
r_  generation:  0.007210969924926758
local_output_nid generation:  0.0007290840148925781
local_in_edges_tensor generation:  0.0006811618804931641
mini_batch_src_global generation:  0.0007205009460449219
r_  generation:  0.005852699279785156
local_output_nid generation:  0.0007278919219970703
local_in_edges_tensor generation:  0.0007596015930175781
mini_batch_src_global generation:  0.0007381439208984375
r_  generation:  0.006802558898925781
local_output_nid generation:  0.0007483959197998047
local_in_edges_tensor generation:  0.0006766319274902344
mini_batch_src_global generation:  0.0007901191711425781
r_  generation:  0.0072400569915771484
local_output_nid generation:  0.0007326602935791016
local_in_edges_tensor generation:  0.0006473064422607422
mini_batch_src_global generation:  0.0007431507110595703
r_  generation:  0.007075071334838867
local_output_nid generation:  0.0007417201995849609
local_in_edges_tensor generation:  0.0006341934204101562
mini_batch_src_global generation:  0.0007126331329345703
r_  generation:  0.0064928531646728516
local_output_nid generation:  0.0007531642913818359
local_in_edges_tensor generation:  0.0006477832794189453
mini_batch_src_global generation:  0.0007762908935546875
r_  generation:  0.007039546966552734
local_output_nid generation:  0.0007598400115966797
local_in_edges_tensor generation:  0.0006353855133056641
mini_batch_src_global generation:  0.0007908344268798828
r_  generation:  0.00682830810546875
local_output_nid generation:  0.0007576942443847656
local_in_edges_tensor generation:  0.0006289482116699219
mini_batch_src_global generation:  0.0007317066192626953
r_  generation:  0.00650477409362793
local_output_nid generation:  0.00075531005859375
local_in_edges_tensor generation:  0.0005943775177001953
mini_batch_src_global generation:  0.0005702972412109375
r_  generation:  0.005112409591674805
local_output_nid generation:  0.0007371902465820312
local_in_edges_tensor generation:  0.0005884170532226562
mini_batch_src_global generation:  0.0005090236663818359
r_  generation:  0.0047931671142578125
local_output_nid generation:  0.0007381439208984375
local_in_edges_tensor generation:  0.0006182193756103516
mini_batch_src_global generation:  0.0007040500640869141
r_  generation:  0.006373882293701172
local_output_nid generation:  0.0007576942443847656
local_in_edges_tensor generation:  0.0006222724914550781
mini_batch_src_global generation:  0.0006847381591796875
r_  generation:  0.006232023239135742
local_output_nid generation:  0.0007421970367431641
local_in_edges_tensor generation:  0.0006084442138671875
mini_batch_src_global generation:  0.0006508827209472656
r_  generation:  0.005998373031616211
local_output_nid generation:  0.0007507801055908203
local_in_edges_tensor generation:  0.0005898475646972656
mini_batch_src_global generation:  0.0005290508270263672
r_  generation:  0.004767894744873047
local_output_nid generation:  0.00074005126953125
local_in_edges_tensor generation:  0.0006012916564941406
mini_batch_src_global generation:  0.0005891323089599609
r_  generation:  0.005521535873413086
local_output_nid generation:  0.0007524490356445312
local_in_edges_tensor generation:  0.0005948543548583984
mini_batch_src_global generation:  0.0005857944488525391
r_  generation:  0.005367279052734375
local_output_nid generation:  0.0007469654083251953
local_in_edges_tensor generation:  0.0005934238433837891
mini_batch_src_global generation:  0.0006690025329589844
r_  generation:  0.005877256393432617
local_output_nid generation:  0.0007588863372802734
local_in_edges_tensor generation:  0.0006189346313476562
mini_batch_src_global generation:  0.0008893013000488281
r_  generation:  0.0069921016693115234
local_output_nid generation:  0.000732421875
local_in_edges_tensor generation:  0.0006127357482910156
mini_batch_src_global generation:  0.0007696151733398438
r_  generation:  0.006638288497924805
local_output_nid generation:  0.0007598400115966797
local_in_edges_tensor generation:  0.0006184577941894531
mini_batch_src_global generation:  0.0006396770477294922
r_  generation:  0.005280971527099609
local_output_nid generation:  0.0007405281066894531
local_in_edges_tensor generation:  0.0007481575012207031
mini_batch_src_global generation:  0.000885009765625
r_  generation:  0.007544994354248047
local_output_nid generation:  0.0007717609405517578
local_in_edges_tensor generation:  0.0008368492126464844
mini_batch_src_global generation:  0.0012333393096923828
r_  generation:  0.009122610092163086
local_output_nid generation:  0.0008215904235839844
local_in_edges_tensor generation:  0.0006489753723144531
mini_batch_src_global generation:  0.001111745834350586
r_  generation:  0.00895237922668457
local_output_nid generation:  0.0008549690246582031
local_in_edges_tensor generation:  0.006395578384399414
mini_batch_src_global generation:  0.0012049674987792969
r_  generation:  0.009145736694335938
local_output_nid generation:  0.0008244514465332031
local_in_edges_tensor generation:  0.0006704330444335938
mini_batch_src_global generation:  0.0009486675262451172
r_  generation:  0.008182048797607422
local_output_nid generation:  0.0008366107940673828
local_in_edges_tensor generation:  0.0006468296051025391
mini_batch_src_global generation:  0.0008318424224853516
r_  generation:  0.006977081298828125
local_output_nid generation:  0.0008313655853271484
local_in_edges_tensor generation:  0.0006473064422607422
mini_batch_src_global generation:  0.0009732246398925781
r_  generation:  0.009208917617797852
local_output_nid generation:  0.0008387565612792969
local_in_edges_tensor generation:  0.0006396770477294922
mini_batch_src_global generation:  0.0010006427764892578
r_  generation:  0.009000062942504883
local_output_nid generation:  0.0008962154388427734
local_in_edges_tensor generation:  0.0006883144378662109
mini_batch_src_global generation:  0.0012764930725097656
r_  generation:  0.008821249008178711
local_output_nid generation:  0.0009479522705078125
local_in_edges_tensor generation:  0.0008447170257568359
mini_batch_src_global generation:  0.0014147758483886719
r_  generation:  0.012355804443359375
----------------------check_connections_block total spend ----------------------------- 0.38694000244140625
generate_one_block  0.016657352447509766
generate_one_block  0.012163162231445312
generate_one_block  0.009480476379394531
generate_one_block  0.010334491729736328
generate_one_block  0.010559320449829102
generate_one_block  0.010200738906860352
generate_one_block  0.009322643280029297
generate_one_block  0.010268211364746094
generate_one_block  0.010183095932006836
generate_one_block  0.010535478591918945
generate_one_block  0.00699615478515625
generate_one_block  0.006825685501098633
generate_one_block  0.00964665412902832
generate_one_block  0.00908517837524414
generate_one_block  0.008629083633422852
generate_one_block  0.006819725036621094
generate_one_block  0.008705615997314453
generate_one_block  0.007999420166015625
generate_one_block  0.008999109268188477
generate_one_block  0.010738611221313477
generate_one_block  0.010587453842163086
generate_one_block  0.008384466171264648
generate_one_block  0.011089324951171875
generate_one_block  0.015266180038452148
generate_one_block  0.014321327209472656
generate_one_block  0.014032602310180664
generate_one_block  0.011299848556518555
generate_one_block  0.010389328002929688
generate_one_block  0.014290571212768555
generate_one_block  0.014200925827026367
generate_one_block  0.014022111892700195
generate_one_block  0.01770305633544922
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030164480209350586
gen group dst list time:  0.009420156478881836
time for parepare:  0.022624492645263672
local_output_nid generation:  0.0013997554779052734
local_in_edges_tensor generation:  0.009131908416748047
mini_batch_src_global generation:  0.0015950202941894531
r_  generation:  0.015658855438232422
local_output_nid generation:  0.0019488334655761719
local_in_edges_tensor generation:  0.0017387866973876953
mini_batch_src_global generation:  0.001973867416381836
r_  generation:  0.0168459415435791
local_output_nid generation:  0.0023241043090820312
local_in_edges_tensor generation:  0.0018422603607177734
mini_batch_src_global generation:  0.0018150806427001953
r_  generation:  0.020557403564453125
local_output_nid generation:  0.0019254684448242188
local_in_edges_tensor generation:  0.0015790462493896484
mini_batch_src_global generation:  0.0017001628875732422
r_  generation:  0.018453359603881836
local_output_nid generation:  0.0016086101531982422
local_in_edges_tensor generation:  0.0013697147369384766
mini_batch_src_global generation:  0.001287221908569336
r_  generation:  0.014100313186645508
local_output_nid generation:  0.0015146732330322266
local_in_edges_tensor generation:  0.0012497901916503906
mini_batch_src_global generation:  0.0012557506561279297
r_  generation:  0.01432347297668457
local_output_nid generation:  0.001558065414428711
local_in_edges_tensor generation:  0.0012841224670410156
mini_batch_src_global generation:  0.0012073516845703125
r_  generation:  0.013791084289550781
local_output_nid generation:  0.001764535903930664
local_in_edges_tensor generation:  0.0014147758483886719
mini_batch_src_global generation:  0.0014071464538574219
r_  generation:  0.015857219696044922
local_output_nid generation:  0.0019445419311523438
local_in_edges_tensor generation:  0.001687765121459961
mini_batch_src_global generation:  0.0016298294067382812
r_  generation:  0.017232656478881836
local_output_nid generation:  0.002069711685180664
local_in_edges_tensor generation:  0.0017170906066894531
mini_batch_src_global generation:  0.0013403892517089844
r_  generation:  0.01790904998779297
local_output_nid generation:  0.0014688968658447266
local_in_edges_tensor generation:  0.0013213157653808594
mini_batch_src_global generation:  0.0010743141174316406
r_  generation:  0.008692502975463867
local_output_nid generation:  0.0013632774353027344
local_in_edges_tensor generation:  0.001079559326171875
mini_batch_src_global generation:  0.0010530948638916016
r_  generation:  0.008144378662109375
local_output_nid generation:  0.0019855499267578125
local_in_edges_tensor generation:  0.0015189647674560547
mini_batch_src_global generation:  0.0013661384582519531
r_  generation:  0.0167236328125
local_output_nid generation:  0.001659393310546875
local_in_edges_tensor generation:  0.0016252994537353516
mini_batch_src_global generation:  0.0012209415435791016
r_  generation:  0.013633251190185547
local_output_nid generation:  0.0014657974243164062
local_in_edges_tensor generation:  0.0011563301086425781
mini_batch_src_global generation:  0.0010485649108886719
r_  generation:  0.011672258377075195
local_output_nid generation:  0.0014338493347167969
local_in_edges_tensor generation:  0.0011425018310546875
mini_batch_src_global generation:  0.0011544227600097656
r_  generation:  0.009499549865722656
local_output_nid generation:  0.0019085407257080078
local_in_edges_tensor generation:  0.0015463829040527344
mini_batch_src_global generation:  0.0012292861938476562
r_  generation:  0.01661062240600586
local_output_nid generation:  0.0017724037170410156
local_in_edges_tensor generation:  0.0014181137084960938
mini_batch_src_global generation:  0.001318216323852539
r_  generation:  0.014348745346069336
local_output_nid generation:  0.0020372867584228516
local_in_edges_tensor generation:  0.0016646385192871094
mini_batch_src_global generation:  0.0014216899871826172
r_  generation:  0.017825603485107422
local_output_nid generation:  0.002389192581176758
local_in_edges_tensor generation:  0.0019571781158447266
mini_batch_src_global generation:  0.0021011829376220703
r_  generation:  0.022820234298706055
local_output_nid generation:  0.002964019775390625
local_in_edges_tensor generation:  0.002881765365600586
mini_batch_src_global generation:  0.004059314727783203
r_  generation:  0.029733896255493164
local_output_nid generation:  0.002912759780883789
local_in_edges_tensor generation:  0.002383708953857422
mini_batch_src_global generation:  0.0026428699493408203
r_  generation:  0.02764272689819336
local_output_nid generation:  0.0036673545837402344
local_in_edges_tensor generation:  0.003438234329223633
mini_batch_src_global generation:  0.003612518310546875
r_  generation:  0.03532052040100098
local_output_nid generation:  0.004427909851074219
local_in_edges_tensor generation:  0.004087924957275391
mini_batch_src_global generation:  0.00471186637878418
r_  generation:  0.04468941688537598
local_output_nid generation:  0.005210161209106445
local_in_edges_tensor generation:  0.0059223175048828125
mini_batch_src_global generation:  0.006722927093505859
r_  generation:  0.05849337577819824
local_output_nid generation:  0.005032539367675781
local_in_edges_tensor generation:  0.004698514938354492
mini_batch_src_global generation:  0.006139278411865234
r_  generation:  0.05705428123474121
local_output_nid generation:  0.004438877105712891
local_in_edges_tensor generation:  0.0036804676055908203
mini_batch_src_global generation:  0.0049762725830078125
r_  generation:  0.04493093490600586
local_output_nid generation:  0.004996538162231445
local_in_edges_tensor generation:  0.005040645599365234
mini_batch_src_global generation:  0.005217790603637695
r_  generation:  0.03932762145996094
local_output_nid generation:  0.004401445388793945
local_in_edges_tensor generation:  0.003688335418701172
mini_batch_src_global generation:  0.004780292510986328
r_  generation:  0.047006845474243164
local_output_nid generation:  0.004576683044433594
local_in_edges_tensor generation:  0.006716012954711914
mini_batch_src_global generation:  0.005767822265625
r_  generation:  0.047092437744140625
local_output_nid generation:  0.00507044792175293
local_in_edges_tensor generation:  0.005768299102783203
mini_batch_src_global generation:  0.007234334945678711
r_  generation:  0.057116031646728516
local_output_nid generation:  0.006227731704711914
local_in_edges_tensor generation:  0.0054302215576171875
mini_batch_src_global generation:  0.006378889083862305
r_  generation:  0.05392909049987793
----------------------check_connections_block total spend ----------------------------- 1.3555212020874023
generate_one_block  0.035318613052368164
generate_one_block  0.02583169937133789
generate_one_block  0.029956579208374023
generate_one_block  0.025011539459228516
generate_one_block  0.018507719039916992
generate_one_block  0.01855754852294922
generate_one_block  0.018285036087036133
generate_one_block  0.022128820419311523
generate_one_block  0.023095369338989258
generate_one_block  0.023211956024169922
generate_one_block  0.012135744094848633
generate_one_block  0.022310256958007812
generate_one_block  0.02141404151916504
generate_one_block  0.01833319664001465
generate_one_block  0.015386581420898438
generate_one_block  0.013588666915893555
generate_one_block  0.021019458770751953
generate_one_block  0.019515037536621094
generate_one_block  0.024120569229125977
generate_one_block  0.031282901763916016
generate_one_block  0.04127907752990723
generate_one_block  0.035787343978881836
generate_one_block  0.04792928695678711
generate_one_block  0.06084775924682617
generate_one_block  0.0791327953338623
generate_one_block  0.07170295715332031
generate_one_block  0.05669760704040527
generate_one_block  0.0511164665222168
generate_one_block  0.06159496307373047
generate_one_block  0.06353211402893066
generate_one_block  0.07595348358154297
generate_one_block  0.09961962699890137
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  1.7424612045288086
block generation total time  1.5339422225952148
average batch blocks generation time:  0.047935694456100464
pseudo mini batch 0 input nodes size: 15528
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010181903839111328  GigaBytes
Max Memory Allocated: 0.010181903839111328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010203361511230469  GigaBytes
Max Memory Allocated: 0.010203361511230469  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010203361511230469  GigaBytes
Max Memory Allocated: 0.010203361511230469  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.010723114013671875  GigaBytes
Max Memory Allocated: 0.010723114013671875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.010723114013671875  GigaBytes
Max Memory Allocated: 0.010723114013671875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.010723114013671875  GigaBytes
Max Memory Allocated: 0.010723114013671875  GigaBytes

torch.Size([15528, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.010723114013671875  GigaBytes
Max Memory Allocated: 0.010723114013671875  GigaBytes

m.shape torch.Size([564, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2303466796875 GB
    Memory Allocated: 0.033521175384521484  GigaBytes
Max Memory Allocated: 0.033924102783203125  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2303466796875 GB
    Memory Allocated: 0.033521175384521484  GigaBytes
Max Memory Allocated: 0.033924102783203125  GigaBytes

 h.shape torch.Size([1, 564, 128]), torch.Size([1, 564, 128])
----------------------------------------3
 Nvidia-smi: 1.2303466796875 GB
    Memory Allocated: 0.03405904769897461  GigaBytes
Max Memory Allocated: 0.03405904769897461  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2322998046875 GB
    Memory Allocated: 0.03880023956298828  GigaBytes
Max Memory Allocated: 0.039069175720214844  GigaBytes

rst.shape  torch.Size([1, 564, 128])
m.shape torch.Size([572, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2322998046875 GB
    Memory Allocated: 0.039076805114746094  GigaBytes
Max Memory Allocated: 0.03908967971801758  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2322998046875 GB
    Memory Allocated: 0.039076805114746094  GigaBytes
Max Memory Allocated: 0.03908967971801758  GigaBytes

 h.shape torch.Size([1, 572, 128]), torch.Size([1, 572, 128])
----------------------------------------3
 Nvidia-smi: 1.2322998046875 GB
    Memory Allocated: 0.03962230682373047  GigaBytes
Max Memory Allocated: 0.03962230682373047  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2342529296875 GB
    Memory Allocated: 0.047804832458496094  GigaBytes
Max Memory Allocated: 0.04835033416748047  GigaBytes

rst.shape  torch.Size([1, 572, 128])
m.shape torch.Size([561, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2342529296875 GB
    Memory Allocated: 0.048334598541259766  GigaBytes
Max Memory Allocated: 0.048354148864746094  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2342529296875 GB
    Memory Allocated: 0.048334598541259766  GigaBytes
Max Memory Allocated: 0.048354148864746094  GigaBytes

 h.shape torch.Size([1, 561, 128]), torch.Size([1, 561, 128])
----------------------------------------3
 Nvidia-smi: 1.2342529296875 GB
    Memory Allocated: 0.04886960983276367  GigaBytes
Max Memory Allocated: 0.04886960983276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2576904296875 GB
    Memory Allocated: 0.06085920333862305  GigaBytes
Max Memory Allocated: 0.061661720275878906  GigaBytes

rst.shape  torch.Size([1, 561, 128])
m.shape torch.Size([490, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2576904296875 GB
    Memory Allocated: 0.06152629852294922  GigaBytes
Max Memory Allocated: 0.061661720275878906  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2576904296875 GB
    Memory Allocated: 0.06152629852294922  GigaBytes
Max Memory Allocated: 0.061661720275878906  GigaBytes

 h.shape torch.Size([1, 490, 128]), torch.Size([1, 490, 128])
----------------------------------------3
 Nvidia-smi: 1.2576904296875 GB
    Memory Allocated: 0.06199359893798828  GigaBytes
Max Memory Allocated: 0.06199359893798828  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0755453109741211  GigaBytes
Max Memory Allocated: 0.07647991180419922  GigaBytes

rst.shape  torch.Size([1, 490, 128])
m.shape torch.Size([472, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.07643699645996094  GigaBytes
Max Memory Allocated: 0.07647991180419922  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.07643699645996094  GigaBytes
Max Memory Allocated: 0.07647991180419922  GigaBytes

 h.shape torch.Size([1, 472, 128]), torch.Size([1, 472, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.07688713073730469  GigaBytes
Max Memory Allocated: 0.07688713073730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.09309196472167969  GigaBytes
Max Memory Allocated: 0.09421730041503906  GigaBytes

rst.shape  torch.Size([1, 472, 128])
m.shape torch.Size([404, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.09402275085449219  GigaBytes
Max Memory Allocated: 0.09421730041503906  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.09402275085449219  GigaBytes
Max Memory Allocated: 0.09421730041503906  GigaBytes

 h.shape torch.Size([1, 404, 128]), torch.Size([1, 404, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.09440803527832031  GigaBytes
Max Memory Allocated: 0.09440803527832031  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.11097526550292969  GigaBytes
Max Memory Allocated: 0.11213111877441406  GigaBytes

rst.shape  torch.Size([1, 404, 128])
m.shape torch.Size([365, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.11200094223022461  GigaBytes
Max Memory Allocated: 0.11213111877441406  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.11200094223022461  GigaBytes
Max Memory Allocated: 0.11213111877441406  GigaBytes

 h.shape torch.Size([1, 365, 128]), torch.Size([1, 365, 128])
----------------------------------------3
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.11234903335571289  GigaBytes
Max Memory Allocated: 0.11234903335571289  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.12975358963012695  GigaBytes
Max Memory Allocated: 0.13097190856933594  GigaBytes

rst.shape  torch.Size([1, 365, 128])
m.shape torch.Size([317, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.13078880310058594  GigaBytes
Max Memory Allocated: 0.13097190856933594  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.13078880310058594  GigaBytes
Max Memory Allocated: 0.13097190856933594  GigaBytes

 h.shape torch.Size([1, 317, 128]), torch.Size([1, 317, 128])
----------------------------------------3
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.13109111785888672  GigaBytes
Max Memory Allocated: 0.13109111785888672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.14832305908203125  GigaBytes
Max Memory Allocated: 0.14953231811523438  GigaBytes

rst.shape  torch.Size([1, 317, 128])
m.shape torch.Size([269, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.14932632446289062  GigaBytes
Max Memory Allocated: 0.14953231811523438  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.14932632446289062  GigaBytes
Max Memory Allocated: 0.14953231811523438  GigaBytes

 h.shape torch.Size([1, 269, 128]), torch.Size([1, 269, 128])
----------------------------------------3
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.1495828628540039  GigaBytes
Max Memory Allocated: 0.1495828628540039  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3592529296875 GB
    Memory Allocated: 0.1660013198852539  GigaBytes
Max Memory Allocated: 0.16715574264526367  GigaBytes

rst.shape  torch.Size([1, 269, 128])
m.shape torch.Size([2833, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.17954492568969727  GigaBytes
Max Memory Allocated: 0.17986202239990234  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.17954492568969727  GigaBytes
Max Memory Allocated: 0.17986202239990234  GigaBytes

 h.shape torch.Size([1, 1416, 128]), torch.Size([1, 1416, 128])
----------------------------------------3
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.18089532852172852  GigaBytes
Max Memory Allocated: 0.18089532852172852  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.27927637100219727  GigaBytes
Max Memory Allocated: 0.2860283851623535  GigaBytes

rst 0 shape torch.Size([1, 1416, 128])
----------------------------------------1
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.27927637100219727  GigaBytes
Max Memory Allocated: 0.2860283851623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.27927637100219727  GigaBytes
Max Memory Allocated: 0.2860283851623535  GigaBytes

 h.shape torch.Size([1, 1417, 128]), torch.Size([1, 1417, 128])
----------------------------------------3
 Nvidia-smi: 1.4959716796875 GB
    Memory Allocated: 0.2806277275085449  GigaBytes
Max Memory Allocated: 0.2860283851623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.37834787368774414  GigaBytes
Max Memory Allocated: 0.38577985763549805  GigaBytes

rst 1 shape torch.Size([1, 1417, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.35887908935546875  GigaBytes
Max Memory Allocated: 0.38800764083862305  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.36540889739990234  GigaBytes
Max Memory Allocated: 0.38800764083862305  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.37193870544433594  GigaBytes
Max Memory Allocated: 0.38800764083862305  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.3653578758239746  GigaBytes
Max Memory Allocated: 0.38800764083862305  GigaBytes

torch.Size([6847, 256])
first layer input nodes number: 15528
first layer output nodes number: 6847
edges number: 45977
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.3720564842224121  GigaBytes
Max Memory Allocated: 0.38800764083862305  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.3785862922668457  GigaBytes
Max Memory Allocated: 0.38800764083862305  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.6151123046875 GB
    Memory Allocated: 0.3804326057434082  GigaBytes
Max Memory Allocated: 0.38800764083862305  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.6151123046875 GB
    Memory Allocated: 0.3804326057434082  GigaBytes
Max Memory Allocated: 0.38800764083862305  GigaBytes

m.shape torch.Size([380, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.40453577041625977  GigaBytes
Max Memory Allocated: 0.4045372009277344  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.40453577041625977  GigaBytes
Max Memory Allocated: 0.4045372009277344  GigaBytes

 h.shape torch.Size([1, 380, 256]), torch.Size([1, 380, 256])
----------------------------------------3
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.4052605628967285  GigaBytes
Max Memory Allocated: 0.4052605628967285  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.4123091697692871  GigaBytes
Max Memory Allocated: 0.4126715660095215  GigaBytes

rst.shape  torch.Size([1, 380, 256])
m.shape torch.Size([324, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.4125699996948242  GigaBytes
Max Memory Allocated: 0.4126715660095215  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.4125699996948242  GigaBytes
Max Memory Allocated: 0.4126715660095215  GigaBytes

 h.shape torch.Size([1, 324, 256]), torch.Size([1, 324, 256])
----------------------------------------3
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.41318798065185547  GigaBytes
Max Memory Allocated: 0.41318798065185547  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.4230809211730957  GigaBytes
Max Memory Allocated: 0.42369890213012695  GigaBytes

rst.shape  torch.Size([1, 324, 256])
m.shape torch.Size([291, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.4236111640930176  GigaBytes
Max Memory Allocated: 0.42369890213012695  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.4236111640930176  GigaBytes
Max Memory Allocated: 0.42369890213012695  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.424166202545166  GigaBytes
Max Memory Allocated: 0.424166202545166  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.436978816986084  GigaBytes
Max Memory Allocated: 0.43781137466430664  GigaBytes

rst.shape  torch.Size([1, 291, 256])
m.shape torch.Size([225, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.43756675720214844  GigaBytes
Max Memory Allocated: 0.43781137466430664  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.43756675720214844  GigaBytes
Max Memory Allocated: 0.43781137466430664  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.43799591064453125  GigaBytes
Max Memory Allocated: 0.43799591064453125  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.4504413604736328  GigaBytes
Max Memory Allocated: 0.45129966735839844  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([187, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.4511256217956543  GigaBytes
Max Memory Allocated: 0.45129966735839844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.4511256217956543  GigaBytes
Max Memory Allocated: 0.45129966735839844  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.45148229598999023  GigaBytes
Max Memory Allocated: 0.45148229598999023  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6658935546875 GB
    Memory Allocated: 0.464322566986084  GigaBytes
Max Memory Allocated: 0.46521425247192383  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([153, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.6658935546875 GB
    Memory Allocated: 0.46502685546875  GigaBytes
Max Memory Allocated: 0.46521425247192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6658935546875 GB
    Memory Allocated: 0.46502685546875  GigaBytes
Max Memory Allocated: 0.46521425247192383  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 1.6658935546875 GB
    Memory Allocated: 0.4653186798095703  GigaBytes
Max Memory Allocated: 0.4653186798095703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6717529296875 GB
    Memory Allocated: 0.47786712646484375  GigaBytes
Max Memory Allocated: 0.4787425994873047  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([133, 7, 256])
----------------------------------------1
 Nvidia-smi: 1.6717529296875 GB
    Memory Allocated: 0.47861623764038086  GigaBytes
Max Memory Allocated: 0.4787425994873047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6717529296875 GB
    Memory Allocated: 0.47861623764038086  GigaBytes
Max Memory Allocated: 0.4787425994873047  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 1.6717529296875 GB
    Memory Allocated: 0.4788699150085449  GigaBytes
Max Memory Allocated: 0.4788699150085449  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.49155378341674805  GigaBytes
Max Memory Allocated: 0.49244165420532227  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([108, 8, 256])
----------------------------------------1
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.49225759506225586  GigaBytes
Max Memory Allocated: 0.49244165420532227  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.49225759506225586  GigaBytes
Max Memory Allocated: 0.49244165420532227  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.4924635887145996  GigaBytes
Max Memory Allocated: 0.4924635887145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6971435546875 GB
    Memory Allocated: 0.5042052268981934  GigaBytes
Max Memory Allocated: 0.5050292015075684  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([104, 9, 256])
----------------------------------------1
 Nvidia-smi: 1.6971435546875 GB
    Memory Allocated: 0.5050020217895508  GigaBytes
Max Memory Allocated: 0.5050292015075684  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6971435546875 GB
    Memory Allocated: 0.5050020217895508  GigaBytes
Max Memory Allocated: 0.5050292015075684  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 1.6971435546875 GB
    Memory Allocated: 0.5052003860473633  GigaBytes
Max Memory Allocated: 0.5052003860473633  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7108154296875 GB
    Memory Allocated: 0.5178956985473633  GigaBytes
Max Memory Allocated: 0.5187883377075195  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([97, 10, 256])
----------------------------------------1
 Nvidia-smi: 1.7108154296875 GB
    Memory Allocated: 0.5187292098999023  GigaBytes
Max Memory Allocated: 0.5187883377075195  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7108154296875 GB
    Memory Allocated: 0.5187292098999023  GigaBytes
Max Memory Allocated: 0.5187883377075195  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 1.7108154296875 GB
    Memory Allocated: 0.5189142227172852  GigaBytes
Max Memory Allocated: 0.5189142227172852  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7244873046875 GB
    Memory Allocated: 0.5320501327514648  GigaBytes
Max Memory Allocated: 0.5329751968383789  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([91, 11, 256])
----------------------------------------1
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.5329198837280273  GigaBytes
Max Memory Allocated: 0.5329751968383789  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.5329198837280273  GigaBytes
Max Memory Allocated: 0.5329751968383789  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.5330934524536133  GigaBytes
Max Memory Allocated: 0.5330934524536133  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.5466318130493164  GigaBytes
Max Memory Allocated: 0.5475864410400391  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.547271728515625  GigaBytes
Max Memory Allocated: 0.5475864410400391  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.547271728515625  GigaBytes
Max Memory Allocated: 0.5475864410400391  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.5473918914794922  GigaBytes
Max Memory Allocated: 0.5475864410400391  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.5576057434082031  GigaBytes
Max Memory Allocated: 0.5583267211914062  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([60, 13, 256])
----------------------------------------1
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.558295726776123  GigaBytes
Max Memory Allocated: 0.5583267211914062  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.558295726776123  GigaBytes
Max Memory Allocated: 0.5583267211914062  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.5584101676940918  GigaBytes
Max Memory Allocated: 0.5584101676940918  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7596435546875 GB
    Memory Allocated: 0.5689387321472168  GigaBytes
Max Memory Allocated: 0.5696825981140137  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 1.7596435546875 GB
    Memory Allocated: 0.5694870948791504  GigaBytes
Max Memory Allocated: 0.5696825981140137  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7596435546875 GB
    Memory Allocated: 0.5694870948791504  GigaBytes
Max Memory Allocated: 0.5696825981140137  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 1.7596435546875 GB
    Memory Allocated: 0.569572925567627  GigaBytes
Max Memory Allocated: 0.5696825981140137  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.5780701637268066  GigaBytes
Max Memory Allocated: 0.5786709785461426  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([47, 15, 256])
----------------------------------------1
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.5787053108215332  GigaBytes
Max Memory Allocated: 0.5787081718444824  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.5787053108215332  GigaBytes
Max Memory Allocated: 0.5787081718444824  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.5787949562072754  GigaBytes
Max Memory Allocated: 0.5787949562072754  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7791748046875 GB
    Memory Allocated: 0.5882973670959473  GigaBytes
Max Memory Allocated: 0.5889697074890137  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([45, 16, 256])
----------------------------------------1
 Nvidia-smi: 1.7791748046875 GB
    Memory Allocated: 0.5889449119567871  GigaBytes
Max Memory Allocated: 0.5889697074890137  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7791748046875 GB
    Memory Allocated: 0.5889449119567871  GigaBytes
Max Memory Allocated: 0.5889697074890137  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 1.7791748046875 GB
    Memory Allocated: 0.5890307426452637  GigaBytes
Max Memory Allocated: 0.5890307426452637  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.5987296104431152  GigaBytes
Max Memory Allocated: 0.5994162559509277  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([42, 17, 256])
----------------------------------------1
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.5993733406066895  GigaBytes
Max Memory Allocated: 0.5994162559509277  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.5993733406066895  GigaBytes
Max Memory Allocated: 0.5994162559509277  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.5994534492492676  GigaBytes
Max Memory Allocated: 0.5994534492492676  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8006591796875 GB
    Memory Allocated: 0.6090664863586426  GigaBytes
Max Memory Allocated: 0.6097474098205566  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 1.8006591796875 GB
    Memory Allocated: 0.6095285415649414  GigaBytes
Max Memory Allocated: 0.6097474098205566  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8006591796875 GB
    Memory Allocated: 0.6095285415649414  GigaBytes
Max Memory Allocated: 0.6097474098205566  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 1.8006591796875 GB
    Memory Allocated: 0.609583854675293  GigaBytes
Max Memory Allocated: 0.6097474098205566  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8065185546875 GB
    Memory Allocated: 0.6166086196899414  GigaBytes
Max Memory Allocated: 0.6171064376831055  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 1.8065185546875 GB
    Memory Allocated: 0.6171655654907227  GigaBytes
Max Memory Allocated: 0.6171679496765137  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8065185546875 GB
    Memory Allocated: 0.6171655654907227  GigaBytes
Max Memory Allocated: 0.6171679496765137  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 1.8065185546875 GB
    Memory Allocated: 0.6172266006469727  GigaBytes
Max Memory Allocated: 0.6172266006469727  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8162841796875 GB
    Memory Allocated: 0.6254053115844727  GigaBytes
Max Memory Allocated: 0.6259851455688477  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([33, 20, 256])
----------------------------------------1
 Nvidia-smi: 1.8162841796875 GB
    Memory Allocated: 0.626009464263916  GigaBytes
Max Memory Allocated: 0.6260123252868652  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8162841796875 GB
    Memory Allocated: 0.626009464263916  GigaBytes
Max Memory Allocated: 0.6260123252868652  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 1.8162841796875 GB
    Memory Allocated: 0.6260724067687988  GigaBytes
Max Memory Allocated: 0.6260724067687988  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.6349472999572754  GigaBytes
Max Memory Allocated: 0.6355767250061035  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.6355419158935547  GigaBytes
Max Memory Allocated: 0.6355767250061035  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.6355419158935547  GigaBytes
Max Memory Allocated: 0.6355767250061035  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.6356010437011719  GigaBytes
Max Memory Allocated: 0.6356010437011719  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8338623046875 GB
    Memory Allocated: 0.6443519592285156  GigaBytes
Max Memory Allocated: 0.6449728012084961  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 1.8338623046875 GB
    Memory Allocated: 0.6447243690490723  GigaBytes
Max Memory Allocated: 0.6449728012084961  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8338623046875 GB
    Memory Allocated: 0.6447243690490723  GigaBytes
Max Memory Allocated: 0.6449728012084961  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 1.8338623046875 GB
    Memory Allocated: 0.6447606086730957  GigaBytes
Max Memory Allocated: 0.6449728012084961  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8397216796875 GB
    Memory Allocated: 0.6503777503967285  GigaBytes
Max Memory Allocated: 0.6507763862609863  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 1.8397216796875 GB
    Memory Allocated: 0.6506695747375488  GigaBytes
Max Memory Allocated: 0.6507763862609863  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8397216796875 GB
    Memory Allocated: 0.6506695747375488  GigaBytes
Max Memory Allocated: 0.6507763862609863  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 1.8397216796875 GB
    Memory Allocated: 0.6506962776184082  GigaBytes
Max Memory Allocated: 0.6507763862609863  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8436279296875 GB
    Memory Allocated: 0.655022144317627  GigaBytes
Max Memory Allocated: 0.6553292274475098  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 1.8436279296875 GB
    Memory Allocated: 0.6554012298583984  GigaBytes
Max Memory Allocated: 0.6554031372070312  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8436279296875 GB
    Memory Allocated: 0.6554012298583984  GigaBytes
Max Memory Allocated: 0.6554031372070312  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 1.8436279296875 GB
    Memory Allocated: 0.6554336547851562  GigaBytes
Max Memory Allocated: 0.6554336547851562  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8494873046875 GB
    Memory Allocated: 0.6609134674072266  GigaBytes
Max Memory Allocated: 0.6613025665283203  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([253, 25, 256])
----------------------------------------1
 Nvidia-smi: 1.8690185546875 GB
    Memory Allocated: 0.6669764518737793  GigaBytes
Max Memory Allocated: 0.6670002937316895  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8690185546875 GB
    Memory Allocated: 0.6669764518737793  GigaBytes
Max Memory Allocated: 0.6670002937316895  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 1.8690185546875 GB
    Memory Allocated: 0.6674590110778809  GigaBytes
Max Memory Allocated: 0.6674590110778809  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9549560546875 GB
    Memory Allocated: 0.7523894309997559  GigaBytes
Max Memory Allocated: 0.7584214210510254  GigaBytes

rst.shape  torch.Size([1, 253, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.9549560546875 GB
    Memory Allocated: 0.7313327789306641  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.9549560546875 GB
    Memory Allocated: 0.7317538261413574  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.9569091796875 GB
    Memory Allocated: 0.7321748733520508  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.9569091796875 GB
    Memory Allocated: 0.7317323684692383  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

torch.Size([2823, 40])
input nodes number: 6847
output nodes number: 2823
edges number: 23575
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9569091796875 GB
    Memory Allocated: 0.7322258949279785  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9569091796875 GB
    Memory Allocated: 0.7322268486022949  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.014918327331542969  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

pseudo mini batch 1 input nodes size: 15431
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.013400554656982422  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.013400554656982422  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.020758628845214844  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.020780086517333984  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.013354301452636719  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.013921737670898438  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.013921737670898438  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.013921737670898438  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

torch.Size([15431, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.013921737670898438  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

m.shape torch.Size([554, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.03886270523071289  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.03886270523071289  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

 h.shape torch.Size([1, 554, 128]), torch.Size([1, 554, 128])
----------------------------------------3
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.03939104080200195  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.043927669525146484  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

rst.shape  torch.Size([1, 554, 128])
m.shape torch.Size([574, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.04421091079711914  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.04421091079711914  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

 h.shape torch.Size([1, 574, 128]), torch.Size([1, 574, 128])
----------------------------------------3
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.04475831985473633  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.053435325622558594  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

rst.shape  torch.Size([1, 574, 128])
m.shape torch.Size([556, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.05395698547363281  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.05395698547363281  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

 h.shape torch.Size([1, 556, 128]), torch.Size([1, 556, 128])
----------------------------------------3
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.05448722839355469  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.06705665588378906  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

rst.shape  torch.Size([1, 556, 128])
m.shape torch.Size([500, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.06774520874023438  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.06774520874023438  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

 h.shape torch.Size([1, 500, 128]), torch.Size([1, 500, 128])
----------------------------------------3
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.0682220458984375  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.08205032348632812  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

rst.shape  torch.Size([1, 500, 128])
m.shape torch.Size([463, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.0829157829284668  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.0829157829284668  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

 h.shape torch.Size([1, 463, 128]), torch.Size([1, 463, 128])
----------------------------------------3
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.08335733413696289  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.09925317764282227  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

rst.shape  torch.Size([1, 463, 128])
m.shape torch.Size([430, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.10026264190673828  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.10026264190673828  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

 h.shape torch.Size([1, 430, 128]), torch.Size([1, 430, 128])
----------------------------------------3
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.10067272186279297  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.11830615997314453  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

rst.shape  torch.Size([1, 430, 128])
m.shape torch.Size([368, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.11932945251464844  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.11932945251464844  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

 h.shape torch.Size([1, 368, 128]), torch.Size([1, 368, 128])
----------------------------------------3
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.11968040466308594  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.13722801208496094  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

rst.shape  torch.Size([1, 368, 128])
m.shape torch.Size([295, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.13817787170410156  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.13817787170410156  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

 h.shape torch.Size([1, 295, 128]), torch.Size([1, 295, 128])
----------------------------------------3
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.1384592056274414  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.1544952392578125  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

rst.shape  torch.Size([1, 295, 128])
m.shape torch.Size([299, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.1559152603149414  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.1559152603149414  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

 h.shape torch.Size([1, 299, 128]), torch.Size([1, 299, 128])
----------------------------------------3
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.15620040893554688  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.17444992065429688  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

rst.shape  torch.Size([1, 299, 128])
m.shape torch.Size([3249, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.18979978561401367  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.18979978561401367  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

 h.shape torch.Size([1, 1624, 128]), torch.Size([1, 1624, 128])
----------------------------------------3
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.19134855270385742  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.30603647232055664  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

rst 0 shape torch.Size([1, 1624, 128])
----------------------------------------1
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.30603647232055664  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.30603647232055664  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

 h.shape torch.Size([1, 1625, 128]), torch.Size([1, 1625, 128])
----------------------------------------3
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.3075861930847168  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.4215245246887207  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

rst 1 shape torch.Size([1, 1625, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.40005970001220703  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.4070100784301758  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.41396045684814453  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.4069557189941406  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

torch.Size([7288, 256])
first layer input nodes number: 15431
first layer output nodes number: 7288
edges number: 50382
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.4140777587890625  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.42102813720703125  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.4231834411621094  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.4231834411621094  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

m.shape torch.Size([375, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.4492521286010742  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.4492521286010742  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

 h.shape torch.Size([1, 375, 256]), torch.Size([1, 375, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.4499673843383789  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.45630359649658203  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

rst.shape  torch.Size([1, 375, 256])
m.shape torch.Size([309, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.4565401077270508  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.4565401077270508  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.45712947845458984  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.46646785736083984  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

rst.shape  torch.Size([1, 309, 256])
m.shape torch.Size([282, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.46698665618896484  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.46698665618896484  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.46752452850341797  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.47962474822998047  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([226, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.4802250862121582  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.4802250862121582  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.48065614700317383  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.49315690994262695  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([199, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.4938979148864746  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.4938979148864746  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.4942774772644043  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.507941722869873  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([151, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5086231231689453  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5086231231689453  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5089111328125  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5212955474853516  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([108, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5218782424926758  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5218782424926758  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5220842361450195  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.532383918762207  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([111, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5331344604492188  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5331344604492188  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5333461761474609  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5454139709472656  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([103, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5461993217468262  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5461993217468262  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5463957786560059  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5589690208435059  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([84, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5596785545349121  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5596785545349121  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5598387718200684  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5712141990661621  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([69, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5718636512756348  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5718636512756348  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5719952583312988  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5822606086730957  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([74, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5830483436584473  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5830483436584473  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5831894874572754  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.595186710357666  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([55, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5958037376403809  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5958037376403809  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5959086418151855  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6055598258972168  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([51, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.606194019317627  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.606194019317627  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6062912940979004  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6159214973449707  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([46, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6165361404418945  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6165361404418945  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6166238784790039  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6259241104125977  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([29, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6263265609741211  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6263265609741211  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6263818740844727  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6326322555541992  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([45, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6333398818969727  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6333398818969727  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6334257125854492  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6437253952026367  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([38, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6443400382995605  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6443400382995605  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6444125175476074  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6536173820495605  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6541657447814941  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6541657447814941  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6542267799377441  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6624054908752441  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([35, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6630477905273438  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6630477905273438  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6631145477294922  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6725273132324219  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([36, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6732206344604492  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6732206344604492  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6732892990112305  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6834516525268555  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.683840274810791  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.683840274810791  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6838784217834473  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.689791202545166  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6902809143066406  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6902809143066406  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6903247833251953  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6974315643310547  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6978483200073242  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6978483200073242  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6978845596313477  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.7040090560913086  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([340, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.712160587310791  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.712160587310791  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

 h.shape torch.Size([1, 340, 256]), torch.Size([1, 340, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.7128090858459473  GigaBytes
Max Memory Allocated: 0.7602329254150391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0955810546875 GB
    Memory Allocated: 0.8286795616149902  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 340, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0955810546875 GB
    Memory Allocated: 0.8056201934814453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0955810546875 GB
    Memory Allocated: 0.8060464859008789  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.0955810546875 GB
    Memory Allocated: 0.8064727783203125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.0955810546875 GB
    Memory Allocated: 0.8060250282287598  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([2860, 40])
input nodes number: 7288
output nodes number: 2860
edges number: 25723
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0955810546875 GB
    Memory Allocated: 0.8061060905456543  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.0955810546875 GB
    Memory Allocated: 0.8061065673828125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1463623046875 GB
    Memory Allocated: 0.014997005462646484  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

pseudo mini batch 2 input nodes size: 21985
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1463623046875 GB
    Memory Allocated: 0.013359546661376953  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1463623046875 GB
    Memory Allocated: 0.013359546661376953  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1463623046875 GB
    Memory Allocated: 0.023842811584472656  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1463623046875 GB
    Memory Allocated: 0.023864269256591797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1463623046875 GB
    Memory Allocated: 0.016484737396240234  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1463623046875 GB
    Memory Allocated: 0.017077922821044922  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1463623046875 GB
    Memory Allocated: 0.017077922821044922  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1463623046875 GB
    Memory Allocated: 0.017077922821044922  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([21985, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1463623046875 GB
    Memory Allocated: 0.017077922821044922  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

m.shape torch.Size([740, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.047513484954833984  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.047513484954833984  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 740, 128]), torch.Size([1, 740, 128])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.04821920394897461  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.054230690002441406  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 740, 128])
m.shape torch.Size([753, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.054595947265625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.054595947265625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 753, 128]), torch.Size([1, 753, 128])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.055314064025878906  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.0660858154296875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 753, 128])
m.shape torch.Size([715, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.06674957275390625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.06674957275390625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 715, 128]), torch.Size([1, 715, 128])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.06743144989013672  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.08272981643676758  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 715, 128])
m.shape torch.Size([636, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.0836019515991211  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.0836019515991211  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 636, 128]), torch.Size([1, 636, 128])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.08420848846435547  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.10268115997314453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 636, 128])
m.shape torch.Size([576, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.10375118255615234  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.10375118255615234  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 576, 128]), torch.Size([1, 576, 128])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.10430049896240234  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.1245412826538086  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 576, 128])
m.shape torch.Size([477, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.12563133239746094  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.12563133239746094  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 477, 128]), torch.Size([1, 477, 128])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.12608623504638672  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.1456470489501953  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 477, 128])
m.shape torch.Size([442, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.1468949317932129  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.1468949317932129  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 442, 128]), torch.Size([1, 442, 128])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.14731645584106445  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.16839265823364258  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 442, 128])
m.shape torch.Size([396, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.1696925163269043  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.1696925163269043  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 396, 128]), torch.Size([1, 396, 128])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.17007017135620117  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.19159650802612305  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 396, 128])
m.shape torch.Size([336, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.19284963607788086  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.19284963607788086  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 336, 128]), torch.Size([1, 336, 128])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.19317007064819336  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.21367788314819336  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 336, 128])
m.shape torch.Size([3813, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.23169946670532227  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.23169946670532227  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 1906, 128]), torch.Size([1, 1906, 128])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.23351716995239258  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.36257410049438477  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst 0 shape torch.Size([1, 1906, 128])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.36257410049438477  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.36257410049438477  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 1907, 128]), torch.Size([1, 1907, 128])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.3643927574157715  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.49260854721069336  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst 1 shape torch.Size([1, 1907, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.46646690368652344  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.47493934631347656  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.4834117889404297  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.47487306594848633  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([8884, 256])
first layer input nodes number: 21985
first layer output nodes number: 8884
edges number: 60093
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.4835777282714844  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.4920501708984375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.49488258361816406  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.49488258361816406  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

m.shape torch.Size([501, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5141639709472656  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5141639709472656  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 501, 256]), torch.Size([1, 501, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5151195526123047  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5231781005859375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 501, 256])
m.shape torch.Size([401, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5234713554382324  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5234713554382324  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 401, 256]), torch.Size([1, 401, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5242362022399902  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5357928276062012  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 401, 256])
m.shape torch.Size([333, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5363707542419434  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5363707542419434  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 333, 256]), torch.Size([1, 333, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5370059013366699  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5516858100891113  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 333, 256])
m.shape torch.Size([251, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5523333549499512  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5523333549499512  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5528120994567871  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5666956901550293  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 251, 256])
m.shape torch.Size([192, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5673789978027344  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5673789978027344  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5677452087402344  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5809288024902344  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([130, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5814957618713379  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5814957618713379  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5817437171936035  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5924057960510254  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([137, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5932035446166992  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5932035446166992  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5934648513793945  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6065301895141602  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([97, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6071457862854004  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6071457862854004  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6073307991027832  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6178765296936035  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([105, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6186923980712891  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6186923980712891  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6188926696777344  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6317100524902344  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([75, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6323308944702148  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6323308944702148  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6324739456176758  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6426305770874023  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6431937217712402  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6431937217712402  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.643308162689209  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6522345542907715  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6528582572937012  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6528582572937012  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6529707908630371  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6625361442565918  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([45, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6630425453186035  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6630425453186035  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6631283760070801  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6710247993469238  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6715741157531738  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6715741157531738  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6716580390930176  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6799664497375488  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6804294586181641  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6804294586181641  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6804962158203125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6875724792480469  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6880159378051758  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6880159378051758  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.688075065612793  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6947565078735352  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6952829360961914  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6952829360961914  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.695347785949707  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.703129768371582  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([18, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7034091949462891  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7034091949462891  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7034435272216797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7078037261962891  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.708280086517334  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.708280086517334  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7083315849304199  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7152323722839355  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7156872749328613  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7156872749328613  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7157349586486816  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7224583625793457  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7227778434753418  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7227778434753418  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7228102684020996  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7276091575622559  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7278046607971191  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7278046607971191  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7278237342834473  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7307801246643066  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7309699058532715  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7309699058532715  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7309870719909668  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7337679862976074  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7340364456176758  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7340364456176758  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7340593338012695  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7379274368286133  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([175, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7421212196350098  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7421212196350098  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.742455005645752  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.801201343536377  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 175, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.785125732421875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7855467796325684  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7859678268432617  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7855253219604492  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([2823, 40])
input nodes number: 8884
output nodes number: 2823
edges number: 19428
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7856078147888184  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7856082916259766  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.01820659637451172  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

pseudo mini batch 3 input nodes size: 16725
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.0164794921875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.0164794921875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.024454593658447266  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.024476051330566406  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.013971328735351562  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.014553070068359375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.014553070068359375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.014553070068359375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([16725, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.014553070068359375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

m.shape torch.Size([505, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.04144001007080078  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.04144001007080078  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 505, 128]), torch.Size([1, 505, 128])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.04192161560058594  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.04577445983886719  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 505, 128])
m.shape torch.Size([526, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.0460352897644043  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.0460352897644043  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 526, 128]), torch.Size([1, 526, 128])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.046536922454833984  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.05439901351928711  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 526, 128])
m.shape torch.Size([511, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.054879188537597656  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.054879188537597656  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 511, 128]), torch.Size([1, 511, 128])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.05536651611328125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.06608772277832031  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 511, 128])
m.shape torch.Size([481, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.06676149368286133  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.06676149368286133  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 481, 128]), torch.Size([1, 481, 128])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.06722021102905273  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.08052301406860352  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 481, 128])
m.shape torch.Size([469, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.08141183853149414  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.08141183853149414  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 469, 128]), torch.Size([1, 469, 128])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.08185911178588867  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.0979609489440918  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 469, 128])
m.shape torch.Size([402, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.09888744354248047  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.09888744354248047  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 402, 128]), torch.Size([1, 402, 128])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.09927082061767578  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.11575603485107422  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 402, 128])
m.shape torch.Size([410, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.11693286895751953  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.11693286895751953  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 410, 128]), torch.Size([1, 410, 128])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.1173238754272461  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.13687419891357422  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 410, 128])
m.shape torch.Size([368, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.13808250427246094  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.13808250427246094  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 368, 128]), torch.Size([1, 368, 128])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.13843345642089844  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.15843772888183594  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 368, 128])
m.shape torch.Size([305, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.15957117080688477  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.15957117080688477  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 305, 128]), torch.Size([1, 305, 128])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.15986204147338867  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.17847776412963867  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 305, 128])
m.shape torch.Size([3609, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.1955413818359375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.1955413818359375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 1804, 128]), torch.Size([1, 1804, 128])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.19726181030273438  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.3194122314453125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst 0 shape torch.Size([1, 1804, 128])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.3194122314453125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.3194122314453125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 1805, 128]), torch.Size([1, 1805, 128])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.3211336135864258  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.4424915313720703  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst 1 shape torch.Size([1, 1805, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.41915035247802734  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.42638492584228516  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.43361949920654297  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.426328182220459  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([7586, 256])
first layer input nodes number: 16725
first layer output nodes number: 7586
edges number: 54420
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.433746337890625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.4409809112548828  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.4431777000427246  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.4431777000427246  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

m.shape torch.Size([378, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.4662594795227051  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.4662594795227051  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 378, 256]), torch.Size([1, 378, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.4669804573059082  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.474851131439209  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 378, 256])
m.shape torch.Size([330, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.4751253128051758  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.4751253128051758  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 330, 256]), torch.Size([1, 330, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.4757547378540039  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.4851961135864258  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 330, 256])
m.shape torch.Size([253, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.4856109619140625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.4856109619140625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.48609352111816406  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.49670982360839844  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([217, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.4973030090332031  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.4973030090332031  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.49771690368652344  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5097198486328125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([172, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5103397369384766  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5103397369384766  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5106678009033203  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5224781036376953  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([156, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5232138633728027  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5232138633728027  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5235114097595215  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5363059043884277  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([155, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5372238159179688  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5372238159179688  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5375194549560547  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5523014068603516  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([138, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5532207489013672  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5532207489013672  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5534839630126953  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5684871673583984  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5691776275634766  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5691776275634766  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5693588256835938  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5809555053710938  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([96, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5817875862121582  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5817875862121582  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5819706916809082  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5949711799621582  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([106, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5960006713867188  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5960006713867188  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.5962028503417969  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6119728088378906  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6125640869140625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6125640869140625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6126785278320312  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.622406005859375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([60, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6230988502502441  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6230988502502441  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6232132911682129  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6337418556213379  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([60, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6344923973083496  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6344923973083496  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6346068382263184  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6459364891052246  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([59, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6467299461364746  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6467299461364746  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6468424797058105  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6587710380554199  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([47, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6594376564025879  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6594376564025879  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6595273017883301  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6696572303771973  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6702661514282227  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6702661514282227  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6703424453735352  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6794977188110352  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6799788475036621  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6799788475036621  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6800360679626465  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6873030662536621  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([20, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6876397132873535  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6876397132873535  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6876778602600098  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6927895545959473  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([32, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6933856010437012  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6933856010437012  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.6934466361999512  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7020525932312012  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7025065422058105  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7025065422058105  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.702552318572998  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.709327220916748  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7096853256225586  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7096853256225586  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7097196578979492  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7150411605834961  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7155327796936035  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7155327796936035  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7155766487121582  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7226834297180176  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7231001853942871  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7231001853942871  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7231364250183105  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7292609214782715  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([231, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7347936630249023  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7347936630249023  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.735234260559082  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2147216796875 GB
    Memory Allocated: 0.812779426574707  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 231, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2147216796875 GB
    Memory Allocated: 0.7943482398986816  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2147216796875 GB
    Memory Allocated: 0.7947683334350586  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7951884269714355  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7947468757629395  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([2819, 40])
input nodes number: 7586
output nodes number: 2819
edges number: 23508
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7948241233825684  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7948246002197266  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.01563739776611328  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

pseudo mini batch 4 input nodes size: 12561
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.013970375061035156  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.013970375061035156  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.01995992660522461  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.019981861114501953  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.011985301971435547  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.012477397918701172  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.012477397918701172  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.012477397918701172  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([12561, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.012477397918701172  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

m.shape torch.Size([455, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03276395797729492  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03276395797729492  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 455, 128]), torch.Size([1, 455, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.033197879791259766  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.036669254302978516  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 455, 128])
m.shape torch.Size([534, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03696155548095703  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03696155548095703  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 534, 128]), torch.Size([1, 534, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03747081756591797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.04558372497558594  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 534, 128])
m.shape torch.Size([526, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.04608154296875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.04608154296875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 526, 128]), torch.Size([1, 526, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.04658317565917969  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.05855607986450195  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 526, 128])
m.shape torch.Size([455, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0591731071472168  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0591731071472168  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 455, 128]), torch.Size([1, 455, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.05960702896118164  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07219076156616211  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 455, 128])
m.shape torch.Size([362, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07283687591552734  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07283687591552734  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 362, 128]), torch.Size([1, 362, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0731821060180664  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.08561038970947266  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 362, 128])
m.shape torch.Size([337, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.08640193939208984  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.08640193939208984  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 337, 128]), torch.Size([1, 337, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.08672332763671875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.10054302215576172  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 337, 128])
m.shape torch.Size([339, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.10151386260986328  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.10151386260986328  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 339, 128]), torch.Size([1, 339, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.101837158203125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.11800193786621094  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 339, 128])
m.shape torch.Size([274, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.11888551712036133  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.11888551712036133  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 274, 128]), torch.Size([1, 274, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.11914682388305664  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.13404130935668945  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 274, 128])
m.shape torch.Size([245, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1349620819091797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1349620819091797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 245, 128]), torch.Size([1, 245, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.13519573211669922  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.15014934539794922  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 245, 128])
m.shape torch.Size([2517, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1620345115661621  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1620345115661621  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 1258, 128]), torch.Size([1, 1258, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.16323423385620117  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.24998807907104492  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst 0 shape torch.Size([1, 1258, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.24998807907104492  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.24998807907104492  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 1259, 128]), torch.Size([1, 1259, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2511887550354004  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.33679819107055664  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst 1 shape torch.Size([1, 1259, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3194270133972168  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.32519102096557617  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.33095502853393555  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3251457214355469  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([6044, 256])
first layer input nodes number: 12561
first layer output nodes number: 6044
edges number: 40693
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3310508728027344  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.33681488037109375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3390541076660156  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3390541076660156  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

m.shape torch.Size([336, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3638114929199219  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3638114929199219  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 336, 256]), torch.Size([1, 336, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3644523620605469  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.36989784240722656  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 336, 256])
m.shape torch.Size([322, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3701968193054199  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3701968193054199  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 322, 256]), torch.Size([1, 322, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.37081098556518555  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.38086462020874023  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 322, 256])
m.shape torch.Size([298, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.38141679763793945  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.38141679763793945  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3819851875305176  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.39455318450927734  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 298, 256])
m.shape torch.Size([243, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3952035903930664  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3952035903930664  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.39566707611083984  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.40910816192626953  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([182, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.40975141525268555  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.40975141525268555  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4100985527038574  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4225955009460449  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([152, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.42329883575439453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.42329883575439453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.42358875274658203  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.43605518341064453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([148, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.436917781829834  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.436917781829834  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.43720006942749023  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.45131444931030273  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([114, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.45205020904541016  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.45205020904541016  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4522676467895508  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4646615982055664  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([116, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.46560192108154297  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.46560192108154297  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4658231735229492  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4799833297729492  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([86, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4806995391845703  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4806995391845703  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4808635711669922  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4925098419189453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([71, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4931788444519043  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4931788444519043  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.493314266204834  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5038771629333496  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([76, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5046863555908203  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5046863555908203  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5048313140869141  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5171527862548828  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([61, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5178427696228027  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5178427696228027  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5179591178894043  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.528663158416748  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([62, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5294394493103027  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5294394493103027  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5295577049255371  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5412650108337402  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5418548583984375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5418548583984375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5419406890869141  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5510387420654297  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([54, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5518264770507812  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5518264770507812  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5519294738769531  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.563568115234375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([44, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5642356872558594  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5642356872558594  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5643196105957031  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5743904113769531  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([51, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5752310752868652  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5752310752868652  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5753283500671387  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5876822471618652  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([36, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5882911682128906  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5882911682128906  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5883598327636719  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5975608825683594  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5980267524719238  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5980267524719238  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.598076343536377  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6050686836242676  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([35, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.605750560760498  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.605750560760498  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6058173179626465  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6156973838806152  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6161503791809082  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6161503791809082  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6161942481994629  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6229939460754395  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([34, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6237239837646484  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6237239837646484  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6237888336181641  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6342945098876953  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6346311569213867  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6346311569213867  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6346616744995117  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6398191452026367  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([264, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6461477279663086  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6461477279663086  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6466512680053711  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7370977401733398  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 264, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.715416431427002  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7158479690551758  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7162795066833496  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7158260345458984  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([2895, 40])
input nodes number: 6044
output nodes number: 2895
edges number: 25290
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.715904712677002  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7159051895141602  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.013432979583740234  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

pseudo mini batch 5 input nodes size: 12597
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.011996746063232422  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.011996746063232422  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.018003463745117188  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.018024921417236328  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.012013435363769531  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.012506484985351562  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.012506484985351562  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.012506484985351562  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([12597, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.012506484985351562  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

m.shape torch.Size([328, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.032970428466796875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.032970428466796875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 328, 128]), torch.Size([1, 328, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.033283233642578125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.035785675048828125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 328, 128])
m.shape torch.Size([408, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03601837158203125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03601837158203125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 408, 128]), torch.Size([1, 408, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.036407470703125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.04224395751953125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 408, 128])
m.shape torch.Size([419, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0426487922668457  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0426487922668457  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 419, 128]), torch.Size([1, 419, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.04304838180541992  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.051839351654052734  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 419, 128])
m.shape torch.Size([438, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0524749755859375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0524749755859375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 438, 128]), torch.Size([1, 438, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.05289268493652344  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.06500625610351562  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 438, 128])
m.shape torch.Size([412, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0657796859741211  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0657796859741211  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 412, 128]), torch.Size([1, 412, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.06617259979248047  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.08031749725341797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 412, 128])
m.shape torch.Size([406, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0812826156616211  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0812826156616211  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 406, 128]), torch.Size([1, 406, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.08166980743408203  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.09831905364990234  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 406, 128])
m.shape torch.Size([352, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.09964752197265625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.09964752197265625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 352, 128]), torch.Size([1, 352, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.09998321533203125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.11676788330078125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 352, 128])
m.shape torch.Size([318, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1178131103515625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1178131103515625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 318, 128]), torch.Size([1, 318, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.11811637878417969  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.13540267944335938  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 318, 128])
m.shape torch.Size([243, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.13629388809204102  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.13629388809204102  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 243, 128]), torch.Size([1, 243, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.13652563095092773  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.15135717391967773  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 243, 128])
m.shape torch.Size([2562, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.16345787048339844  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.16345787048339844  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 1281, 128]), torch.Size([1, 1281, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.16467952728271484  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2514171600341797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst 0 shape torch.Size([1, 1281, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2514171600341797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2514171600341797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 1281, 128]), torch.Size([1, 1281, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2526388168334961  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.33876562118530273  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst 1 shape torch.Size([1, 1281, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3210725784301758  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.32668590545654297  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.33229923248291016  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3266420364379883  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([5886, 256])
first layer input nodes number: 12597
first layer output nodes number: 5886
edges number: 41464
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.332395076751709  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.33800840377807617  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3394637107849121  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3394637107849121  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

m.shape torch.Size([253, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3634810447692871  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3634810447692871  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.36396360397338867  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.36782407760620117  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([267, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.36809635162353516  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.36809635162353516  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3686056137084961  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.37841224670410156  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([258, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.37890195846557617  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.37890195846557617  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3793940544128418  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3920588493347168  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([220, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.39265871047973633  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.39265871047973633  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3930783271789551  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.40524721145629883  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([221, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.40648984909057617  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.40648984909057617  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.40691137313842773  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.422086238861084  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([219, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4231386184692383  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4231386184692383  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4235563278198242  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.44151782989501953  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([167, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4424929618835449  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4424929618835449  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4428114891052246  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.458737850189209  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([145, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.45969390869140625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.45969390869140625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.45997047424316406  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4757347106933594  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([106, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4765133857727051  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4765133857727051  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4767155647277832  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4896550178527832  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([123, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.49126386642456055  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.49126386642456055  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4914984703063965  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.508155345916748  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([107, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5091695785522461  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5091695785522461  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.509373664855957  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5252923965454102  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([68, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5259747505187988  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5259747505187988  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5261044502258301  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5371289253234863  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([76, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5380139350891113  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5380139350891113  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5381588935852051  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5514950752258301  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([76, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5524454116821289  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5524454116821289  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5525903701782227  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5669412612915039  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5674457550048828  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5674457550048828  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5675220489501953  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5756092071533203  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([45, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.576263427734375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.576263427734375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5763492584228516  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5860481262207031  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([58, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5869531631469727  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5869531631469727  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5870637893676758  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6003389358520508  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.600837230682373  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.600837230682373  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.600898265838623  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.608649730682373  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6090579032897949  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6090579032897949  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6091036796569824  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6152377128601074  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([40, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6159839630126953  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6159839630126953  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6160602569580078  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6268177032470703  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([32, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6274256706237793  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6274256706237793  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6274867057800293  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6365199089050293  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6369547843933105  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6369547843933105  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6369967460632324  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.643500804901123  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6438779830932617  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6438779830932617  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6439123153686523  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6494741439819336  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6499876976013184  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6499876976013184  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.650031566619873  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6574454307556152  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([197, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6621570587158203  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6621570587158203  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6625328063964844  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7286643981933594  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 197, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7083010673522949  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7087240219116211  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7091469764709473  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.708702564239502  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([2837, 40])
input nodes number: 5886
output nodes number: 2837
edges number: 24603
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7087593078613281  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7087597846984863  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.013432979583740234  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

pseudo mini batch 6 input nodes size: 13841
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.012004852294921875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.012004852294921875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.018604755401611328  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.01862621307373047  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.012598037719726562  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.013056755065917969  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.013056755065917969  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.013056755065917969  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([13841, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.013056755065917969  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

m.shape torch.Size([463, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03333902359008789  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03333902359008789  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 463, 128]), torch.Size([1, 463, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.033780574798583984  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.037312984466552734  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 463, 128])
m.shape torch.Size([576, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03764152526855469  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03764152526855469  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 576, 128]), torch.Size([1, 576, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03819084167480469  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.04694414138793945  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 576, 128])
m.shape torch.Size([543, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.047446250915527344  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.047446250915527344  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 543, 128]), torch.Size([1, 543, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.04796409606933594  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.060004234313964844  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 543, 128])
m.shape torch.Size([520, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.06073713302612305  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.06073713302612305  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 520, 128]), torch.Size([1, 520, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0612330436706543  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0762171745300293  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 520, 128])
m.shape torch.Size([415, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07695865631103516  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07695865631103516  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 415, 128]), torch.Size([1, 415, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07735443115234375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.09160232543945312  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 415, 128])
m.shape torch.Size([406, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.09256601333618164  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.09256601333618164  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 406, 128]), torch.Size([1, 406, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.09295320510864258  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.10960245132446289  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 406, 128])
m.shape torch.Size([337, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1105337142944336  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1105337142944336  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 337, 128]), torch.Size([1, 337, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1108551025390625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1269245147705078  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 337, 128])
m.shape torch.Size([312, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.12795400619506836  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.12795400619506836  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 312, 128]), torch.Size([1, 312, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1282515525817871  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.14521169662475586  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 312, 128])
m.shape torch.Size([282, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.14627313613891602  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.14627313613891602  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 282, 128]), torch.Size([1, 282, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.14654207229614258  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.16375398635864258  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 282, 128])
m.shape torch.Size([2229, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.17424821853637695  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.17424821853637695  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 1114, 128]), torch.Size([1, 1114, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.17531061172485352  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.25196027755737305  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst 0 shape torch.Size([1, 1114, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.25196027755737305  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.25196027755737305  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 1115, 128]), torch.Size([1, 1115, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.253023624420166  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.32917070388793945  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst 1 shape torch.Size([1, 1115, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.311887264251709  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3176884651184082  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3234896659851074  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3176426887512207  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([6083, 256])
first layer input nodes number: 13841
first layer output nodes number: 6083
edges number: 39518
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3235950469970703  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.32939624786376953  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.33114004135131836  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.33114004135131836  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

m.shape torch.Size([332, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.35265684127807617  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.35265684127807617  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 332, 256]), torch.Size([1, 332, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3532900810241699  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3584780693054199  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 332, 256])
m.shape torch.Size([368, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3588690757751465  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3588690757751465  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 368, 256]), torch.Size([1, 368, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3595709800720215  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3701925277709961  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 368, 256])
m.shape torch.Size([296, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3706951141357422  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3706951141357422  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 296, 256]), torch.Size([1, 296, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3712596893310547  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3837604522705078  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 296, 256])
m.shape torch.Size([265, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.38449716567993164  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.38449716567993164  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.38500261306762695  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.399660587310791  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([201, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4003739356994629  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4003739356994629  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4007573127746582  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.41455888748168945  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([183, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4154229164123535  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4154229164123535  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4157719612121582  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.43078088760375977  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([146, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.43158864974975586  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.43158864974975586  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4318671226501465  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.44579076766967773  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([132, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4466667175292969  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4466667175292969  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4469184875488281  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4612693786621094  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([121, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4621906280517578  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4621906280517578  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4624214172363281  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4771919250488281  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([99, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4780282974243164  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4780282974243164  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.47821712493896484  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4916238784790039  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([103, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4926185607910156  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4926185607910156  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4928150177001953  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5081386566162109  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([89, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5090670585632324  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5090670585632324  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5092368125915527  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5236659049987793  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([70, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5244560241699219  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5244560241699219  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5245895385742188  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5368728637695312  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5373983383178711  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5373983383178711  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5374822616577148  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5457906723022461  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5463833808898926  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5463833808898926  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5464673042297363  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5553631782531738  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([27, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5557365417480469  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5557365417480469  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5557880401611328  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5616073608398438  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5621376037597656  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5621376037597656  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5622024536132812  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5699844360351562  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.570488452911377  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.570488452911377  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5705475807189941  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.578056812286377  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.578484058380127  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.578484058380127  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5785317420959473  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5849213600158691  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5854744911193848  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5854744911193848  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5855317115783691  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.593599796295166  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5939950942993164  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5939950942993164  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5940351486206055  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5999631881713867  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6003875732421875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6003875732421875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6004276275634766  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6066360473632812  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6068816184997559  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6068816184997559  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6069045066833496  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6106123924255371  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6109471321105957  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6109471321105957  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6109757423400879  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6158108711242676  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([163, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.619713306427002  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.619713306427002  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6200242042541504  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6747422218322754  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 163, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.656346321105957  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6567745208740234  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6572027206420898  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6567530632019043  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([2872, 40])
input nodes number: 6083
output nodes number: 2872
edges number: 21920
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6568255424499512  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6568260192871094  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.013957977294921875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

pseudo mini batch 7 input nodes size: 17268
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.012603282928466797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.012603282928466797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.02083730697631836  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.020859241485595703  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.01423788070678711  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.014770030975341797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.014770030975341797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.014770030975341797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([17268, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.014770030975341797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

m.shape torch.Size([494, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03794527053833008  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03794527053833008  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 494, 128]), torch.Size([1, 494, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.038416385650634766  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.042185306549072266  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 494, 128])
m.shape torch.Size([541, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0424656867980957  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0424656867980957  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 541, 128]), torch.Size([1, 541, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.042981624603271484  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.05107402801513672  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 541, 128])
m.shape torch.Size([549, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.051601409912109375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.051601409912109375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 549, 128]), torch.Size([1, 549, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.052124977111816406  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0636434555053711  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 549, 128])
m.shape torch.Size([461, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.06426095962524414  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.06426095962524414  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 461, 128]), torch.Size([1, 461, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.06470060348510742  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07745027542114258  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 461, 128])
m.shape torch.Size([456, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07831764221191406  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07831764221191406  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 456, 128]), torch.Size([1, 456, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07875251770019531  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.09440803527832031  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 456, 128])
m.shape torch.Size([350, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.09519195556640625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.09519195556640625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 350, 128]), torch.Size([1, 350, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.09552574157714844  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1098785400390625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 350, 128])
m.shape torch.Size([318, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.11077308654785156  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.11077308654785156  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 318, 128]), torch.Size([1, 318, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.11107635498046875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.12623977661132812  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 318, 128])
m.shape torch.Size([304, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.12724781036376953  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.12724781036376953  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 304, 128]), torch.Size([1, 304, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.12753772735595703  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.14406299591064453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 304, 128])
m.shape torch.Size([264, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1450510025024414  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1450510025024414  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 264, 128]), torch.Size([1, 264, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.14530277252197266  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.16141605377197266  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 264, 128])
m.shape torch.Size([3035, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.17576217651367188  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.17576217651367188  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 1517, 128]), torch.Size([1, 1517, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.17720890045166016  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2799263000488281  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst 0 shape torch.Size([1, 1517, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2799263000488281  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2799263000488281  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 1518, 128]), torch.Size([1, 1518, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2813739776611328  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3834357261657715  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst 1 shape torch.Size([1, 1518, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3634767532348633  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3699350357055664  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.37639331817626953  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3698844909667969  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([6772, 256])
first layer input nodes number: 17268
first layer output nodes number: 6772
edges number: 46831
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3765239715576172  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.38313865661621094  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3847532272338867  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3847532272338867  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

m.shape torch.Size([338, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4088277816772461  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4088277816772461  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 338, 256]), torch.Size([1, 338, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4094724655151367  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4172391891479492  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 338, 256])
m.shape torch.Size([341, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4175724983215332  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4175724983215332  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 341, 256]), torch.Size([1, 341, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.41822290420532227  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.43317747116088867  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 341, 256])
m.shape torch.Size([295, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4337029457092285  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4337029457092285  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4342656135559082  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.44686365127563477  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([238, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4474973678588867  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4474973678588867  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4479513168334961  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.46111583709716797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([209, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.461942195892334  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.461942195892334  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4623408317565918  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.47669172286987305  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([154, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.47738075256347656  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.47738075256347656  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4776744842529297  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.49030494689941406  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([137, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.49107980728149414  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.49107980728149414  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.49134111404418945  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5044064521789551  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([122, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5052142143249512  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5052142143249512  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5054469108581543  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5187106132507324  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([105, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5195026397705078  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5195026397705078  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5197029113769531  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5325202941894531  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([108, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5334582328796387  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5334582328796387  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5336642265319824  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5482897758483887  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([76, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5489907264709473  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5489907264709473  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.549135684967041  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5604424476623535  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([78, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5612697601318359  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5612697601318359  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5614185333251953  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5740642547607422  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([69, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.574852466583252  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.574852466583252  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.574984073638916  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5870919227600098  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([57, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5877933502197266  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5877933502197266  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5879020690917969  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5986652374267578  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([53, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5993752479553223  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5993752479553223  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5994763374328613  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.610191822052002  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6105718612670898  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6105718612670898  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6106252670288086  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6166601181030273  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6171727180480957  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6171727180480957  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6172356605529785  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.624788761138916  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6252593994140625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6252593994140625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6253147125244141  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6323394775390625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6327319145202637  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6327319145202637  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6327757835388184  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6386542320251465  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6391324996948242  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6391324996948242  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6391820907592773  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.646174430847168  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6466341018676758  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6466341018676758  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6466798782348633  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6534547805786133  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([29, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6540451049804688  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6540451049804688  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6541004180908203  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6626739501953125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.662867546081543  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.662867546081543  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6628866195678711  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6659765243530273  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6664285659790039  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6664285659790039  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6664667129516602  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6729135513305664  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([285, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6797428131103516  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6797428131103516  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6802864074707031  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7780270576477051  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 285, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7569971084594727  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7574276924133301  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7578582763671875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7574057579040527  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([2887, 40])
input nodes number: 6772
output nodes number: 2887
edges number: 24513
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7574806213378906  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7574810981750488  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.015800952911376953  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

pseudo mini batch 8 input nodes size: 17856
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.014240264892578125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.014240264892578125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.022754669189453125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.02277660369873047  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.014520645141601562  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.015067100524902344  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.015067100524902344  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.015067100524902344  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([17856, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.015067100524902344  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

m.shape torch.Size([542, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03979301452636719  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03979301452636719  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 542, 128]), torch.Size([1, 542, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.040309906005859375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.04499483108520508  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 542, 128])
m.shape torch.Size([689, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.04539346694946289  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.04539346694946289  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 689, 128]), torch.Size([1, 689, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0460505485534668  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.05590677261352539  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 689, 128])
m.shape torch.Size([624, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.05647087097167969  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.05647087097167969  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 624, 128]), torch.Size([1, 624, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.05706596374511719  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07015800476074219  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 624, 128])
m.shape torch.Size([613, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0710296630859375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0710296630859375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 613, 128]), torch.Size([1, 613, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07161426544189453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.08918952941894531  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 613, 128])
m.shape torch.Size([538, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0901799201965332  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0901799201965332  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 538, 128]), torch.Size([1, 538, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.09069299697875977  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.10945844650268555  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 538, 128])
m.shape torch.Size([459, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.11051511764526367  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.11051511764526367  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 459, 128]), torch.Size([1, 459, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.11095285415649414  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1297755241394043  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 459, 128])
m.shape torch.Size([418, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1309518814086914  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1309518814086914  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 418, 128]), torch.Size([1, 418, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.13135051727294922  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.15128231048583984  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 418, 128])
m.shape torch.Size([423, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1526966094970703  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1526966094970703  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 423, 128]), torch.Size([1, 423, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.15310001373291016  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.17609405517578125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 423, 128])
m.shape torch.Size([351, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.177398681640625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.177398681640625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 351, 128]), torch.Size([1, 351, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1777334213256836  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1991567611694336  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 351, 128])
m.shape torch.Size([2877, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2127079963684082  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2127079963684082  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 1438, 128]), torch.Size([1, 1438, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2140793800354004  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.31277036666870117  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst 0 shape torch.Size([1, 1438, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.31277036666870117  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.31277036666870117  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 1439, 128]), torch.Size([1, 1439, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.31414270401000977  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.41249704360961914  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst 1 shape torch.Size([1, 1439, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3914494514465332  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3986344337463379  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4058194160461426  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3985781669616699  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([7534, 256])
first layer input nodes number: 17856
first layer output nodes number: 7534
edges number: 49927
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.40595436096191406  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.41313934326171875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4149355888366699  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4149355888366699  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

m.shape torch.Size([358, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.43777894973754883  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.43777894973754883  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4384617805480957  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4447140693664551  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([367, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.44507837295532227  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.44507837295532227  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 367, 256]), torch.Size([1, 367, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.44577836990356445  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.45723962783813477  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 367, 256])
m.shape torch.Size([271, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4576711654663086  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4576711654663086  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4581880569458008  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.47023963928222656  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([242, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.47091197967529297  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.47091197967529297  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4713735580444336  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4847593307495117  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([216, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4855666160583496  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4855666160583496  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4859786033630371  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5008101463317871  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([158, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5015153884887695  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5015153884887695  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5018167495727539  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.514775276184082  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([140, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5155668258666992  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5155668258666992  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.515833854675293  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5291852951049805  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([167, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5310816764831543  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5310816764831543  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.531400203704834  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5495562553405762  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([103, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.550288200378418  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.550288200378418  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5504846572875977  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5630578994750977  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([96, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5638823509216309  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5638823509216309  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5640654563903809  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5770659446716309  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([82, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5778417587280273  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5778417587280273  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.577998161315918  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5901975631713867  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([74, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.590972900390625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.590972900390625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5911140441894531  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6031112670898438  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6036529541015625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6036529541015625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6037464141845703  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6123447418212891  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([64, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6131591796875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6131591796875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.61328125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6253662109375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([49, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.626011848449707  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.626011848449707  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6261053085327148  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.636012077331543  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([43, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6366267204284668  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6366267204284668  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6367087364196777  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6459765434265137  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.646425724029541  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.646425724029541  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6464829444885254  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6533493995666504  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6538052558898926  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6538052558898926  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6538586616516113  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6606411933898926  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6611623764038086  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6611623764038086  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.661219596862793  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6688871383666992  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6692814826965332  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6692814826965332  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6693234443664551  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6752400398254395  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6757845878601074  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6757845878601074  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6758379936218262  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6837420463562012  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6842441558837891  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6842441558837891  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6842918395996094  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6916828155517578  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6921677589416504  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6921677589416504  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6922116279602051  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6993184089660645  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6996426582336426  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6996426582336426  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6996712684631348  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7045063972473145  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([215, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.709658145904541  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.709658145904541  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7100682258605957  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7822422981262207  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 215, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7625274658203125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7629590034484863  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7633905410766602  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.762937068939209  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([2895, 40])
input nodes number: 7534
output nodes number: 2895
edges number: 23276
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7630162239074707  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7630167007446289  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.016122817993164062  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

pseudo mini batch 9 input nodes size: 19249
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.014521598815917969  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.014521598815917969  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.023700237274169922  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.023721694946289062  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.015185356140136719  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.015723228454589844  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.015723228454589844  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.015723228454589844  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([19249, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.015723228454589844  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

m.shape torch.Size([714, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.04063224792480469  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.04063224792480469  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 714, 128]), torch.Size([1, 714, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.04131317138671875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.04737091064453125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 714, 128])
m.shape torch.Size([768, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.04776287078857422  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.04776287078857422  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 768, 128]), torch.Size([1, 768, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.04849529266357422  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.05948162078857422  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 768, 128])
m.shape torch.Size([722, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.060408592224121094  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.060408592224121094  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 722, 128]), torch.Size([1, 722, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.061097145080566406  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07624530792236328  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 722, 128])
m.shape torch.Size([632, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07710647583007812  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07710647583007812  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 632, 128]), torch.Size([1, 632, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07770919799804688  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.09518814086914062  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 632, 128])
m.shape torch.Size([569, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.09624338150024414  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.09624338150024414  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 569, 128]), torch.Size([1, 569, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0967860221862793  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.11635923385620117  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 569, 128])
m.shape torch.Size([498, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.11751270294189453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.11751270294189453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 498, 128]), torch.Size([1, 498, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.11798763275146484  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.13840961456298828  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 498, 128])
m.shape torch.Size([403, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.13951730728149414  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.13951730728149414  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 403, 128]), torch.Size([1, 403, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.13990163803100586  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1591181755065918  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 403, 128])
m.shape torch.Size([406, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1604747772216797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1604747772216797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 406, 128]), torch.Size([1, 406, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.16086196899414062  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.18293190002441406  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 406, 128])
m.shape torch.Size([345, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1842188835144043  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1842188835144043  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 345, 128]), torch.Size([1, 345, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.18454790115356445  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.20560503005981445  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 345, 128])
m.shape torch.Size([2816, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.21886825561523438  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.21886825561523438  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 1408, 128]), torch.Size([1, 1408, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.22021102905273438  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3188662528991699  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst 0 shape torch.Size([1, 1408, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3188662528991699  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3188662528991699  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 1408, 128]), torch.Size([1, 1408, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3202090263366699  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4178042411804199  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst 1 shape torch.Size([1, 1408, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.39684009552001953  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.40434837341308594  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.41185665130615234  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.40428924560546875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([7873, 256])
first layer input nodes number: 19249
first layer output nodes number: 7873
edges number: 50111
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4120020866394043  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4195103645324707  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4221482276916504  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4221482276916504  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

m.shape torch.Size([425, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4437747001647949  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4437747001647949  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 425, 256]), torch.Size([1, 425, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.44458532333374023  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.45195817947387695  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 425, 256])
m.shape torch.Size([396, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4523143768310547  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4523143768310547  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 396, 256]), torch.Size([1, 396, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.45306968688964844  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.46462392807006836  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 396, 256])
m.shape torch.Size([302, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4651174545288086  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4651174545288086  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.46569347381591797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4793729782104492  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 302, 256])
m.shape torch.Size([244, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4800233840942383  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4800233840942383  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 244, 256]), torch.Size([1, 244, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.48048877716064453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4939851760864258  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 244, 256])
m.shape torch.Size([207, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.49477672576904297  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.49477672576904297  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.49517154693603516  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5093851089477539  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([170, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5101680755615234  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5101680755615234  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5104923248291016  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5244350433349609  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([113, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5250334739685059  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5250334739685059  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5252490043640137  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5360255241394043  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([112, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5367789268493652  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5367789268493652  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5369925498962402  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5491690635681152  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([100, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5499277114868164  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5499277114868164  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5501184463500977  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5623254776000977  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([87, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5630664825439453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5630664825439453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.563232421875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5750141143798828  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([59, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5755553245544434  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5755553245544434  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5756678581237793  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5844454765319824  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5850701332092285  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5850701332092285  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5851826667785645  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5947480201721191  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([58, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5954165458679199  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5954165458679199  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.595527172088623  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6057047843933105  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.606255054473877  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.606255054473877  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6063408851623535  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6148381233215332  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([52, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6155452728271484  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6155452728271484  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6156444549560547  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6261577606201172  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6265387535095215  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6265387535095215  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6265921592712402  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.632627010345459  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6331887245178223  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6331887245178223  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6332573890686035  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6414971351623535  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([38, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.642120361328125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.642120361328125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6421928405761719  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.651397705078125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.651909351348877  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.651909351348877  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6519665718078613  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6596341133117676  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6601247787475586  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6601247787475586  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6601762771606445  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6674375534057617  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6677956581115723  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6677956581115723  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6678318977355957  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6731953620910645  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.673515796661377  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.673515796661377  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.673546314239502  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.678276538848877  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([24, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6787919998168945  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6787919998168945  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.678837776184082  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.686253547668457  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6866693496704102  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6866693496704102  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6867055892944336  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6928300857543945  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([208, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.697810173034668  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.697810173034668  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.698206901550293  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.768031120300293  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 208, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7495737075805664  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.750002384185791  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7504310607910156  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7499809265136719  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([2874, 40])
input nodes number: 7873
output nodes number: 2874
edges number: 21945
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.750058650970459  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7500591278076172  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.01677560806274414  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

pseudo mini batch 10 input nodes size: 8504
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0151824951171875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0151824951171875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.019237518310546875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.01925945281982422  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.010059356689453125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.010361671447753906  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.010361671447753906  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.010361671447753906  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([8504, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.010361671447753906  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

m.shape torch.Size([801, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.023158550262451172  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.023158550262451172  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 801, 128]), torch.Size([1, 801, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.023922443389892578  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03015422821044922  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 801, 128])
m.shape torch.Size([819, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.030553340911865234  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.030553340911865234  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 819, 128]), torch.Size([1, 819, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03133440017700195  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.043050289154052734  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 819, 128])
m.shape torch.Size([690, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.043646812438964844  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.043646812438964844  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 690, 128]), torch.Size([1, 690, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.044304847717285156  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.05952644348144531  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 690, 128])
m.shape torch.Size([558, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.06026172637939453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.06026172637939453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 558, 128]), torch.Size([1, 558, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.06079387664794922  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07671451568603516  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 558, 128])
m.shape torch.Size([478, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07758808135986328  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07758808135986328  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 478, 128]), torch.Size([1, 478, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07804393768310547  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.09445476531982422  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 478, 128])
m.shape torch.Size([375, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.09529972076416016  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.09529972076416016  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 375, 128]), torch.Size([1, 375, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0956573486328125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.11103534698486328  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 375, 128])
m.shape torch.Size([295, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.11184120178222656  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.11184120178222656  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 295, 128]), torch.Size([1, 295, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1121225357055664  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1261892318725586  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 295, 128])
m.shape torch.Size([214, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.12686491012573242  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.12686491012573242  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 214, 128]), torch.Size([1, 214, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.12706899642944336  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1387019157409668  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 214, 128])
m.shape torch.Size([193, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.13942813873291016  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.13942813873291016  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 193, 128]), torch.Size([1, 193, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.13961219787597656  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.15139198303222656  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 193, 128])
m.shape torch.Size([832, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.15526723861694336  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.15526723861694336  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 416, 128]), torch.Size([1, 416, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.15566396713256836  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.18383169174194336  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst 0 shape torch.Size([1, 416, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.18383169174194336  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.18383169174194336  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 416, 128]), torch.Size([1, 416, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.18422842025756836  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.21219778060913086  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst 1 shape torch.Size([1, 416, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2023773193359375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.20738887786865234  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2124004364013672  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.20734930038452148  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([5255, 256])
first layer input nodes number: 8504
first layer output nodes number: 5255
edges number: 25215
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.21246576309204102  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.21747732162475586  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2194681167602539  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2194681167602539  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

m.shape torch.Size([536, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.23485279083251953  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.23485279083251953  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 536, 256]), torch.Size([1, 536, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.23587512969970703  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.24450397491455078  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 536, 256])
m.shape torch.Size([471, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.24489831924438477  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.24489831924438477  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 471, 256]), torch.Size([1, 471, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.24579668045043945  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.25927209854125977  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 471, 256])
m.shape torch.Size([404, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2602500915527344  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2602500915527344  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2610206604003906  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.27805376052856445  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([296, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2788066864013672  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2788066864013672  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 296, 256]), torch.Size([1, 296, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2793712615966797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2961711883544922  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 296, 256])
m.shape torch.Size([256, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.297119140625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.297119140625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.297607421875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.315185546875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([192, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.31604862213134766  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.31604862213134766  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.31641483306884766  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.33216190338134766  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([137, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3329005241394043  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3329005241394043  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3331618309020996  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.34622716903686523  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([116, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3469886779785156  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3469886779785156  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3472099304199219  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3598213195800781  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3605327606201172  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3605327606201172  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3607139587402344  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3723106384277344  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([73, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3729219436645508  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3729219436645508  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3730611801147461  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3829469680786133  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([51, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.38341665267944336  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.38341665267944336  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3835139274597168  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3911013603210449  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([55, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.39168739318847656  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.39168739318847656  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.39179229736328125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4007091522216797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([35, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4010944366455078  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4010944366455078  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.40116119384765625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4073028564453125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4077944755554199  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4077944755554199  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4078688621520996  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.41523313522338867  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([28, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4155998229980469  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4155998229980469  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4156532287597656  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4213142395019531  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([23, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.42164134979248047  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.42164134979248047  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.42168521881103516  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.42664241790771484  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([22, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.42698001861572266  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.42698001861572266  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.42702198028564453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.43205738067626953  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([14, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4322786331176758  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4322786331176758  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.43230533599853516  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4356966018676758  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([11, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4358844757080078  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4358844757080078  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.43590545654296875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4387168884277344  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([5, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.43880271911621094  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.43880271911621094  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.438812255859375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4401569366455078  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([13, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4404149055480957  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4404149055480957  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.44043970108032227  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4441094398498535  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.44422435760498047  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.44422435760498047  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.44423580169677734  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.44600963592529297  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([5, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.44611454010009766  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.44611454010009766  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4461240768432617  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.44766902923583984  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4478721618652344  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4478721618652344  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4478893280029297  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4507904052734375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([35, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.45162296295166016  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.45162296295166016  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4516897201538086  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4634389877319336  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 35, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.45243072509765625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4528670310974121  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.45330333709716797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.45284509658813477  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([2927, 40])
input nodes number: 5255
output nodes number: 2927
edges number: 15334
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4529142379760742  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4529147148132324  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0110015869140625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

pseudo mini batch 11 input nodes size: 10242
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.010066986083984375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.010066986083984375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.014950752258300781  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.014972209930419922  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.010895252227783203  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.011191844940185547  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.011191844940185547  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.011191844940185547  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([10242, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.011191844940185547  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

m.shape torch.Size([816, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.02363109588623047  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.02363109588623047  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 816, 128]), torch.Size([1, 816, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.02440929412841797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03063488006591797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 816, 128])
m.shape torch.Size([778, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03098773956298828  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03098773956298828  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 778, 128]), torch.Size([1, 778, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.031729698181152344  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.043084144592285156  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 778, 128])
m.shape torch.Size([642, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.043631553649902344  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.043631553649902344  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 642, 128]), torch.Size([1, 642, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.044243812561035156  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.058116912841796875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 642, 128])
m.shape torch.Size([514, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.058791160583496094  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.058791160583496094  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 514, 128]), torch.Size([1, 514, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.059281349182128906  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07367229461669922  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 514, 128])
m.shape torch.Size([386, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07434749603271484  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07434749603271484  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 386, 128]), torch.Size([1, 386, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07471561431884766  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0879678726196289  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 386, 128])
m.shape torch.Size([298, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.08863639831542969  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.08863639831542969  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 298, 128]), torch.Size([1, 298, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.08892059326171875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.10114097595214844  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 298, 128])
m.shape torch.Size([230, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.10176658630371094  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.10176658630371094  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 230, 128]), torch.Size([1, 230, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.10198593139648438  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.11295318603515625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 230, 128])
m.shape torch.Size([210, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.11364459991455078  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.11364459991455078  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 210, 128]), torch.Size([1, 210, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1138448715209961  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1252603530883789  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 210, 128])
m.shape torch.Size([160, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.12584686279296875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.12584686279296875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 160, 128]), torch.Size([1, 160, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.12599945068359375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.13576507568359375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 160, 128])
m.shape torch.Size([967, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.14029979705810547  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.14029979705810547  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 483, 128]), torch.Size([1, 483, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1407604217529297  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.17346477508544922  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst 0 shape torch.Size([1, 483, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.17346477508544922  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.17346477508544922  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 484, 128]), torch.Size([1, 484, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.17392635345458984  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2064681053161621  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst 1 shape torch.Size([1, 484, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.19684934616088867  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.20161867141723633  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.20638799667358398  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.20158100128173828  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([5001, 256])
first layer input nodes number: 10242
first layer output nodes number: 5001
edges number: 24472
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2064666748046875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.21123600006103516  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.21336650848388672  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.21336650848388672  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

m.shape torch.Size([616, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.22896528244018555  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.22896528244018555  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 616, 256]), torch.Size([1, 616, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.23014020919799805  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.23957443237304688  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 616, 256])
m.shape torch.Size([513, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.24010086059570312  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.24010086059570312  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 513, 256]), torch.Size([1, 513, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.24107933044433594  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2557563781738281  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 513, 256])
m.shape torch.Size([376, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2563514709472656  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2563514709472656  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2570686340332031  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2738227844238281  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([287, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2745676040649414  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2745676040649414  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2751150131225586  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2913064956665039  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([201, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.29199886322021484  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.29199886322021484  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.29238224029541016  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3061838150024414  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([157, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3068976402282715  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3068976402282715  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.30719709396362305  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.32007360458374023  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([111, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.32067108154296875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.32067108154296875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.32088279724121094  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3314685821533203  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([81, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3319859504699707  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3319859504699707  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3321404457092285  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.34094667434692383  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([78, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.34154415130615234  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.34154415130615234  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3416929244995117  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3512144088745117  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([67, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.35178422927856445  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.35178422927856445  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3519120216369629  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.36098527908325195  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([41, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3613553047180176  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3613553047180176  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3614335060119629  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.36753320693969727  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([41, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3679671287536621  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3679671287536621  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3680453300476074  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.374692440032959  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([38, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.37512826919555664  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.37512826919555664  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3752007484436035  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.381868839263916  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([32, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.38226318359375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.38226318359375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.38232421875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.38836669921875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([26, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.38871145248413086  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.38871145248413086  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.388761043548584  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.39401769638061523  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([23, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3943467140197754  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3943467140197754  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3943905830383301  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.39934778213500977  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3997507095336914  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3997507095336914  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.39980030059814453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.40575122833251953  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([16, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.406003475189209  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.406003475189209  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.406033992767334  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.409909725189209  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([14, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.41015052795410156  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.41015052795410156  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.41017723083496094  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4137554168701172  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([13, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.41399240493774414  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.41399240493774414  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4140172004699707  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.417513370513916  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([7, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.41764259338378906  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.41764259338378906  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.41765594482421875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4196319580078125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.41979455947875977  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.41979455947875977  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.41980981826782227  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.42217493057250977  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4223442077636719  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4223442077636719  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4223594665527344  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4248313903808594  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4250316619873047  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4250316619873047  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.425048828125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4279499053955078  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([75, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.42974376678466797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.42974376678466797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4298868179321289  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4550638198852539  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 75, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4428844451904297  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4433112144470215  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4437379837036133  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.44328975677490234  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([2864, 40])
input nodes number: 5001
output nodes number: 2864
edges number: 15159
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.44333934783935547  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.44333982467651367  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.011815071105957031  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

pseudo mini batch 12 input nodes size: 16830
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.01088571548461914  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.01088571548461914  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.019673824310302734  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.019695758819580078  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.014790534973144531  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.015302658081054688  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.015302658081054688  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.015302658081054688  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([16830, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.015302658081054688  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

m.shape torch.Size([655, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03968667984008789  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03968667984008789  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 655, 128]), torch.Size([1, 655, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.040311336517333984  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.045308589935302734  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 655, 128])
m.shape torch.Size([683, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.045647621154785156  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.045647621154785156  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 683, 128]), torch.Size([1, 683, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.046298980712890625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.056069374084472656  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 683, 128])
m.shape torch.Size([674, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.05670785903930664  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.05670785903930664  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 674, 128]), torch.Size([1, 674, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.05735063552856445  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07163667678833008  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 674, 128])
m.shape torch.Size([591, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07245111465454102  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07245111465454102  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 591, 128]), torch.Size([1, 591, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07301473617553711  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.08935976028442383  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 591, 128])
m.shape torch.Size([537, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.09035825729370117  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.09035825729370117  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 537, 128]), torch.Size([1, 537, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.09087038040161133  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.10993385314941406  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 537, 128])
m.shape torch.Size([435, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.11092233657836914  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.11092233657836914  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 435, 128]), torch.Size([1, 435, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.11133718490600586  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.12917566299438477  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 435, 128])
m.shape torch.Size([408, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.13033008575439453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.13033008575439453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 408, 128]), torch.Size([1, 408, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.13071918487548828  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.15017414093017578  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 408, 128])
m.shape torch.Size([372, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1513986587524414  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1513986587524414  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 372, 128]), torch.Size([1, 372, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.15175342559814453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.17197513580322266  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 372, 128])
m.shape torch.Size([327, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1732010841369629  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1732010841369629  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 327, 128]), torch.Size([1, 327, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.17351293563842773  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.19347143173217773  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 327, 128])
m.shape torch.Size([2674, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.20606613159179688  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.20606613159179688  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 1337, 128]), torch.Size([1, 1337, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.20734119415283203  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2981562614440918  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst 0 shape torch.Size([1, 1337, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2981562614440918  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2981562614440918  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 1337, 128]), torch.Size([1, 1337, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.29943132400512695  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.38932323455810547  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst 1 shape torch.Size([1, 1337, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.36861085891723633  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3756260871887207  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3826413154602051  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.37557125091552734  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([7356, 256])
first layer input nodes number: 16830
first layer output nodes number: 7356
edges number: 47217
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3827686309814453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3897838592529297  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3915376663208008  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3915376663208008  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

m.shape torch.Size([428, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.41269493103027344  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.41269493103027344  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 428, 256]), torch.Size([1, 428, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4135112762451172  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4201850891113281  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 428, 256])
m.shape torch.Size([352, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4204535484313965  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4204535484313965  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 352, 256]), torch.Size([1, 352, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4211249351501465  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.43322134017944336  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 352, 256])
m.shape torch.Size([340, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.433866024017334  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.433866024017334  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 340, 256]), torch.Size([1, 340, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.43451452255249023  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4499382972717285  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 340, 256])
m.shape torch.Size([273, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.45066404342651367  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.45066404342651367  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 273, 256]), torch.Size([1, 273, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4511847496032715  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4673190116882324  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 273, 256])
m.shape torch.Size([225, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4688754081726074  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4688754081726074  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.46930456161499023  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4847540855407715  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([145, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.48537588119506836  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.48537588119506836  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.48565244674682617  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4975447654724121  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([153, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.49843597412109375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.49843597412109375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.49872779846191406  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5133190155029297  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([122, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5141115188598633  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5141115188598633  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5143442153930664  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5276079177856445  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([100, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5283570289611816  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5283570289611816  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5285477638244629  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5407547950744629  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([92, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5415439605712891  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5415439605712891  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5417194366455078  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5541782379150391  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([72, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5548520088195801  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5548520088195801  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5549893379211426  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5657010078430176  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.566347599029541  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.566347599029541  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5664658546447754  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5765175819396973  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([58, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5771832466125488  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5771832466125488  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.577293872833252  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5874714851379395  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5880489349365234  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5880489349365234  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5881385803222656  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5970134735107422  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([46, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5976319313049316  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5976319313049316  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.597719669342041  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6070199012756348  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([48, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6077141761779785  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6077141761779785  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6078057289123535  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6181511878967285  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6186285018920898  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6186285018920898  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6186895370483398  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6260137557983398  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([21, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6263465881347656  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6263465881347656  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6263866424560547  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6314735412597656  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6319470405578613  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6319470405578613  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6319985389709473  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6388993263244629  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6394314765930176  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6394314765930176  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6394867897033691  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6472859382629395  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([15, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6475610733032227  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6475610733032227  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6475896835327148  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6518239974975586  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6520214080810547  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6520214080810547  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6520404815673828  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6549968719482422  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6552748680114746  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6552748680114746  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6552996635437012  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6593165397644043  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6595582962036133  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6595582962036133  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6595792770385742  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6631250381469727  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([193, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6677522659301758  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6677522659301758  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6681203842163086  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7329092025756836  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 193, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7149734497070312  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7154078483581543  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7158422470092773  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.715385913848877  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([2914, 40])
input nodes number: 7356
output nodes number: 2914
edges number: 21450
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7154703140258789  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7154707908630371  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.016305923461914062  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

pseudo mini batch 13 input nodes size: 14118
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.014798164367675781  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.014798164367675781  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0215301513671875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.021552085876464844  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.012742042541503906  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.013184547424316406  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.013184547424316406  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.013184547424316406  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([14118, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.013184547424316406  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

m.shape torch.Size([585, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03237438201904297  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03237438201904297  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 585, 128]), torch.Size([1, 585, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.032932281494140625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03743410110473633  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 585, 128])
m.shape torch.Size([681, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.037804603576660156  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.037804603576660156  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 681, 128]), torch.Size([1, 681, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03845405578613281  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.048195838928222656  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 681, 128])
m.shape torch.Size([648, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0487980842590332  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0487980842590332  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 648, 128]), torch.Size([1, 648, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.04941606521606445  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.06331396102905273  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 648, 128])
m.shape torch.Size([567, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0640864372253418  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0640864372253418  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 567, 128]), torch.Size([1, 567, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.06462717056274414  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.08100271224975586  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 567, 128])
m.shape torch.Size([516, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.08196258544921875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.08196258544921875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 516, 128]), torch.Size([1, 516, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.08245468139648438  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.10086441040039062  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 516, 128])
m.shape torch.Size([430, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.10184860229492188  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.10184860229492188  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 430, 128]), torch.Size([1, 430, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.10225868225097656  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.11989212036132812  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 430, 128])
m.shape torch.Size([346, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.12084197998046875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.12084197998046875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 346, 128]), torch.Size([1, 346, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.12117195129394531  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.13767051696777344  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 346, 128])
m.shape torch.Size([327, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.13875293731689453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.13875293731689453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 327, 128]), torch.Size([1, 327, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.13906478881835938  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.15684032440185547  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 327, 128])
m.shape torch.Size([268, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.15783452987670898  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.15783452987670898  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 268, 128]), torch.Size([1, 268, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.15809011459350586  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.17444753646850586  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 268, 128])
m.shape torch.Size([1977, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1837468147277832  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1837468147277832  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 988, 128]), torch.Size([1, 988, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.18468904495239258  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2539639472961426  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst 0 shape torch.Size([1, 988, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2539639472961426  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2539639472961426  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 989, 128]), torch.Size([1, 989, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.25490713119506836  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3234066963195801  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst 1 shape torch.Size([1, 989, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.30745697021484375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3135080337524414  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.31955909729003906  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3134603500366211  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([6345, 256])
first layer input nodes number: 14118
first layer output nodes number: 6345
edges number: 38539
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.31966638565063477  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3259410858154297  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.32723045349121094  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.32723045349121094  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

m.shape torch.Size([393, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.34758472442626953  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.34758472442626953  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 393, 256]), torch.Size([1, 393, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.34833431243896484  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3543581962585449  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 393, 256])
m.shape torch.Size([404, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.35476016998291016  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.35476016998291016  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3555307388305664  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3679032325744629  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([333, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.36847829818725586  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.36847829818725586  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 333, 256]), torch.Size([1, 333, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3691134452819824  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3830866813659668  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 333, 256])
m.shape torch.Size([253, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3837418556213379  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3837418556213379  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.38422441482543945  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.39821863174438477  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([228, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.39907312393188477  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.39907312393188477  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.399507999420166  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.415163516998291  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([177, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4159669876098633  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4159669876098633  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4163045883178711  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.43082141876220703  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([138, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4315814971923828  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4315814971923828  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.43184471130371094  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4450054168701172  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([125, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4458351135253906  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4458351135253906  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4460735321044922  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.45966339111328125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([119, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.460573673248291  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.460573673248291  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4608006477355957  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4753270149230957  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([103, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4762258529663086  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4762258529663086  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4764223098754883  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4903707504272461  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([97, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.49129819869995117  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.49129819869995117  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.491483211517334  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5059142112731934  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5065140724182129  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5065140724182129  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5066285133361816  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5163559913635254  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([62, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5170736312866211  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5170736312866211  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5171918869018555  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.528071403503418  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([52, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.528712272644043  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.528712272644043  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5288114547729492  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.538630485534668  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5391864776611328  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5391864776611328  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5392665863037109  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5477581024169922  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5481486320495605  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5481486320495605  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5482020378112793  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.554236888885498  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([19, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5545210838317871  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5545210838317871  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5545573234558105  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.558906078338623  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5592169761657715  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5592169761657715  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5592532157897949  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5638556480407715  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5643672943115234  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5643672943115234  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.564422607421875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5718345642089844  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5722298622131348  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5722298622131348  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5722718238830566  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.578188419342041  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5784907341003418  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5784907341003418  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5785212516784668  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5830378532409668  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5833821296691895  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5833821296691895  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5834145545959473  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5884404182434082  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5888004302978516  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5888004302978516  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5888328552246094  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.594085693359375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5943465232849121  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5943465232849121  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5943694114685059  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5982375144958496  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([149, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.601806640625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.601806640625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6020908355712891  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6521091461181641  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 149, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.634979248046875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.635413646697998  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6358480453491211  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6353917121887207  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([2914, 40])
input nodes number: 6345
output nodes number: 2914
edges number: 20650
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6354613304138184  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6354618072509766  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.014062881469726562  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

pseudo mini batch 14 input nodes size: 11137
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.012742042541503906  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.012742042541503906  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.01805257797241211  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.01807403564453125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.011320114135742188  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.011714935302734375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.011714935302734375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.011714935302734375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([11137, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.011714935302734375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

m.shape torch.Size([647, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.028171062469482422  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.028171062469482422  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 647, 128]), torch.Size([1, 647, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.028788089752197266  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03387022018432617  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 647, 128])
m.shape torch.Size([638, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03417015075683594  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03417015075683594  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 638, 128]), torch.Size([1, 638, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.034778594970703125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.04455280303955078  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 638, 128])
m.shape torch.Size([583, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.04508256912231445  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.04508256912231445  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 583, 128]), torch.Size([1, 583, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0456385612487793  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.058582305908203125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 583, 128])
m.shape torch.Size([531, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.05931711196899414  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.05931711196899414  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 531, 128]), torch.Size([1, 531, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.05982351303100586  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07461786270141602  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 531, 128])
m.shape torch.Size([429, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07538747787475586  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07538747787475586  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 429, 128]), torch.Size([1, 429, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07579660415649414  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.09052515029907227  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 429, 128])
m.shape torch.Size([377, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0913991928100586  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0913991928100586  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 377, 128]), torch.Size([1, 377, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.09175872802734375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.10721874237060547  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 377, 128])
m.shape torch.Size([317, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.10809707641601562  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.10809707641601562  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 317, 128]), torch.Size([1, 317, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1083993911743164  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.12351512908935547  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 317, 128])
m.shape torch.Size([291, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.12447404861450195  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.12447404861450195  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 291, 128]), torch.Size([1, 291, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.12475156784057617  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.14057016372680664  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 291, 128])
m.shape torch.Size([260, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.14154720306396484  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.14154720306396484  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 260, 128]), torch.Size([1, 260, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.14179515838623047  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.15766429901123047  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 260, 128])
m.shape torch.Size([1580, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.16507434844970703  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.16507434844970703  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 790, 128]), torch.Size([1, 790, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.16582775115966797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.21931934356689453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst 0 shape torch.Size([1, 790, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.21931934356689453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.21931934356689453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 790, 128]), torch.Size([1, 790, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.22007274627685547  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.27318763732910156  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst 1 shape torch.Size([1, 790, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.25997114181518555  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2653622627258301  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2707533836364746  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.26531982421875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([5653, 256])
first layer input nodes number: 11137
first layer output nodes number: 5653
edges number: 32890
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.27083873748779297  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2762298583984375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.277679443359375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.277679443359375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

m.shape torch.Size([438, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2979092597961426  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2979092597961426  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 438, 256]), torch.Size([1, 438, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.29874467849731445  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.30544424057006836  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 438, 256])
m.shape torch.Size([369, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.30573606491088867  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.30573606491088867  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 369, 256]), torch.Size([1, 369, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3064398765563965  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.31780099868774414  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 369, 256])
m.shape torch.Size([318, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.31836605072021484  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.31836605072021484  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3189725875854492  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.332855224609375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([262, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3335847854614258  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3335847854614258  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.33408451080322266  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3486309051513672  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([197, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.34932804107666016  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.34932804107666016  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3497037887573242  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.36323070526123047  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([176, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3640580177307129  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3640580177307129  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3643937110900879  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3788285255432129  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([147, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.38013362884521484  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.38013362884521484  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3804140090942383  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.39443302154541016  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([127, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.39526939392089844  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.39526939392089844  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3955116271972656  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4093189239501953  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([129, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.41031408309936523  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.41031408309936523  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.41056013107299805  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.42630720138549805  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([90, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4270496368408203  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4270496368408203  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.42722129821777344  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4394092559814453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([77, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4401378631591797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4401378631591797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.44028472900390625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4517402648925781  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.45238208770751953  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.45238208770751953  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4525003433227539  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4625520706176758  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([66, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.46331787109375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.46331787109375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4634437561035156  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4750251770019531  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([49, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.47562170028686523  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.47562170028686523  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.47571516036987305  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4849677085876465  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.48552656173706055  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.48552656173706055  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.48560667037963867  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4940981864929199  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4945964813232422  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4945964813232422  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4946632385253906  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5022068023681641  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5026636123657227  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5026636123657227  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.502720832824707  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.509587287902832  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5101122856140137  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5101122856140137  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5101733207702637  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5179247856140137  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5183510780334473  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5183510780334473  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5183987617492676  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5247883796691895  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5252261161804199  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5252261161804199  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5252718925476074  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5317263603210449  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5321273803710938  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5321273803710938  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5321674346923828  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5380954742431641  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5384349822998047  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5384349822998047  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5384674072265625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5434932708740234  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5438532829284668  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5438532829284668  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5438857078552246  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5491385459899902  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5494222640991211  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5494222640991211  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5494470596313477  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5536375045776367  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([112, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5563163757324219  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5563163757324219  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5565299987792969  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5941276550292969  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 112, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5771574974060059  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5775861740112305  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5780148506164551  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5775647163391113  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([2875, 40])
input nodes number: 5653
output nodes number: 2875
edges number: 20009
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5776228904724121  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5776233673095703  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.012497425079345703  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

pseudo mini batch 15 input nodes size: 11575
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.01131439208984375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.01131439208984375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.016833782196044922  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.016855716705322266  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.011523723602294922  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.011840343475341797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.011840343475341797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.011840343475341797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([11575, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.011840343475341797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

m.shape torch.Size([853, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.026340961456298828  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.026340961456298828  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 853, 128]), torch.Size([1, 853, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.02715444564819336  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03366231918334961  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 853, 128])
m.shape torch.Size([846, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03406238555908203  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03406238555908203  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 846, 128]), torch.Size([1, 846, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03486919403076172  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.04697132110595703  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 846, 128])
m.shape torch.Size([697, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.04763078689575195  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.04763078689575195  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 697, 128]), torch.Size([1, 697, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.04829549789428711  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.06291913986206055  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 697, 128])
m.shape torch.Size([541, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.06361865997314453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.06361865997314453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 541, 128]), torch.Size([1, 541, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.06413459777832031  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07989025115966797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 541, 128])
m.shape torch.Size([463, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.08073616027832031  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.08073616027832031  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 463, 128]), torch.Size([1, 463, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0811777114868164  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.09707355499267578  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 463, 128])
m.shape torch.Size([347, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.09784555435180664  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.09784555435180664  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 347, 128]), torch.Size([1, 347, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.09817647933959961  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.11240625381469727  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 347, 128])
m.shape torch.Size([294, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.11322212219238281  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.11322212219238281  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 294, 128]), torch.Size([1, 294, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.11350250244140625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.12752151489257812  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 294, 128])
m.shape torch.Size([236, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1282815933227539  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1282815933227539  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 236, 128]), torch.Size([1, 236, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.12850666046142578  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.14133548736572266  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 236, 128])
m.shape torch.Size([205, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.14210271835327148  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.14210271835327148  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 205, 128]), torch.Size([1, 205, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.14229822158813477  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.15481042861938477  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 205, 128])
m.shape torch.Size([1069, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.15981006622314453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.15981006622314453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 534, 128]), torch.Size([1, 534, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.16031932830810547  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1967015266418457  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst 0 shape torch.Size([1, 534, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1967015266418457  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1967015266418457  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 535, 128]), torch.Size([1, 535, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.19721174240112305  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.23348379135131836  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst 1 shape torch.Size([1, 535, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2220926284790039  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.227386474609375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2326803207397461  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.22734498977661133  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([5551, 256])
first layer input nodes number: 11575
first layer output nodes number: 5551
edges number: 27678
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.23276853561401367  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.23806238174438477  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.23938608169555664  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.23938608169555664  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

m.shape torch.Size([617, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.25417518615722656  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.25417518615722656  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 617, 256]), torch.Size([1, 617, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2553520202636719  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2660837173461914  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 617, 256])
m.shape torch.Size([497, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2664508819580078  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2664508819580078  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 497, 256]), torch.Size([1, 497, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2673988342285156  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2816181182861328  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 497, 256])
m.shape torch.Size([395, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.28247642517089844  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.28247642517089844  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 395, 256]), torch.Size([1, 395, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2832298278808594  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3000822067260742  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 395, 256])
m.shape torch.Size([274, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3011140823364258  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3011140823364258  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3016366958618164  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.31679248809814453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([234, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3176560401916504  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3176560401916504  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3181023597717285  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.334169864654541  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([167, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.33490991592407227  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.33490991592407227  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.33522844314575195  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3489251136779785  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([139, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3497014045715332  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3497014045715332  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.34996652603149414  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.363222599029541  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([117, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.36398983001708984  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.36398983001708984  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3642129898071289  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.37693309783935547  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([79, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3775053024291992  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3775053024291992  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3776559829711914  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3872995376586914  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([63, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3878297805786133  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3878297805786133  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.38794994354248047  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3964815139770508  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([44, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.39688682556152344  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.39688682556152344  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3969707489013672  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4035167694091797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([35, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.40387868881225586  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.40387868881225586  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4039454460144043  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4096198081970215  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([34, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.41001129150390625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.41001129150390625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4100761413574219  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4160423278808594  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([27, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.41637325286865234  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.41637325286865234  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4164247512817383  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4215230941772461  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.42193031311035156  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.42193031311035156  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.42198753356933594  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4280529022216797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([15, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4282550811767578  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4282550811767578  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.42828369140625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4315166473388672  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([17, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4317803382873535  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4317803382873535  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.43181276321411133  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.43570375442504883  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4360165596008301  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4360165596008301  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4360527992248535  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4406552314758301  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([11, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4408383369445801  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4408383369445801  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.440859317779541  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.44367074966430664  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([7, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.44379520416259766  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.44379520416259766  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.44380855560302734  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4456911087036133  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([9, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.44586610794067383  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.44586610794067383  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.44588327407836914  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4484238624572754  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4485635757446289  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4485635757446289  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4485769271850586  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.45064640045166016  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([7, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.45079469680786133  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.45079469680786133  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.450808048248291  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4529709815979004  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([4, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.45305681228637695  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.45305681228637695  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4530644416809082  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.45435380935668945  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([53, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4556236267089844  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4556236267089844  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.45572471618652344  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.47351646423339844  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 53, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4625368118286133  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4629693031311035  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.46340179443359375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.46294736862182617  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([2901, 40])
input nodes number: 5551
output nodes number: 2901
edges number: 14633
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4630146026611328  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.463015079498291  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.012514591217041016  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

pseudo mini batch 16 input nodes size: 19204
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.011527538299560547  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.011527538299560547  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.02068471908569336  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.020706653594970703  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.015165328979492188  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.01564502716064453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.01564502716064453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.01564502716064453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([19204, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.01564502716064453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

m.shape torch.Size([800, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03879737854003906  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03879737854003906  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 800, 128]), torch.Size([1, 800, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03956031799316406  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.04566383361816406  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 800, 128])
m.shape torch.Size([867, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.04610919952392578  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.04610919952392578  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 867, 128]), torch.Size([1, 867, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.04693603515625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.05933856964111328  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 867, 128])
m.shape torch.Size([760, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.060231685638427734  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.060231685638427734  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 760, 128]), torch.Size([1, 760, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.060956478118896484  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07775068283081055  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 760, 128])
m.shape torch.Size([654, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07863569259643555  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07863569259643555  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 654, 128]), torch.Size([1, 654, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07925939559936523  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.09756040573120117  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 654, 128])
m.shape torch.Size([609, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.09870052337646484  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.09870052337646484  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 609, 128]), torch.Size([1, 609, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.09928131103515625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.12075948715209961  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 609, 128])
m.shape torch.Size([493, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.12187957763671875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.12187957763671875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 493, 128]), torch.Size([1, 493, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.12234973907470703  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.14256668090820312  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 493, 128])
m.shape torch.Size([431, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1437702178955078  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1437702178955078  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 431, 128]), torch.Size([1, 431, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1441812515258789  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1647329330444336  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 431, 128])
m.shape torch.Size([383, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.16598844528198242  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.16598844528198242  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 383, 128]), torch.Size([1, 383, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.16635370254516602  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.18717336654663086  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 383, 128])
m.shape torch.Size([292, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.18824386596679688  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.18824386596679688  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 292, 128]), torch.Size([1, 292, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1885223388671875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2063446044921875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 292, 128])
m.shape torch.Size([2427, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.21777820587158203  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.21777820587158203  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 1213, 128]), torch.Size([1, 1213, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2189350128173828  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3010683059692383  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst 0 shape torch.Size([1, 1213, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3010683059692383  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3010683059692383  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 1214, 128]), torch.Size([1, 1214, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.30222606658935547  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3838486671447754  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst 1 shape torch.Size([1, 1214, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3646688461303711  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3720273971557617  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.37938594818115234  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.37196969985961914  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([7716, 256])
first layer input nodes number: 19204
first layer output nodes number: 7716
edges number: 46412
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3795313835144043  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3868899345397949  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3887295722961426  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3887295722961426  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

m.shape torch.Size([537, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4065566062927246  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4065566062927246  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 537, 256]), torch.Size([1, 537, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4075808525085449  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.41713857650756836  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 537, 256])
m.shape torch.Size([461, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4175128936767578  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4175128936767578  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 461, 256]), torch.Size([1, 461, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4183921813964844  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.43190574645996094  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 461, 256])
m.shape torch.Size([350, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4324812889099121  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4324812889099121  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 350, 256]), torch.Size([1, 350, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4331488609313965  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.44783544540405273  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 350, 256])
m.shape torch.Size([268, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4485321044921875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4485321044921875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.44904327392578125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.46419286727905273  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([231, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.46504783630371094  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.46504783630371094  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4654884338378906  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4813499450683594  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([179, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.48299455642700195  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.48299455642700195  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4833359718322754  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4980168342590332  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([136, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4987611770629883  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4987611770629883  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4990205764770508  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5119905471801758  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([107, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5126838684082031  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5126838684082031  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5128879547119141  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5245208740234375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([82, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5251283645629883  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5251283645629883  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5252847671508789  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5352945327758789  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([77, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.535956859588623  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.535956859588623  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5361037254333496  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5465312004089355  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([59, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5470819473266602  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5470819473266602  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5471944808959961  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5559720993041992  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([49, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5564813613891602  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5564813613891602  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.556574821472168  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.564518928527832  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([35, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5649099349975586  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5649099349975586  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.564976692199707  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5711183547973633  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([33, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5715293884277344  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5715293884277344  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5715923309326172  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5778236389160156  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([31, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5782394409179688  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5782394409179688  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5782985687255859  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5845661163330078  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5850133895874023  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5850133895874023  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5850725173950195  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5917539596557617  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([21, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5920677185058594  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5920677185058594  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5921077728271484  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5969142913818359  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5973095893859863  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5973095893859863  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5973553657531738  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6031689643859863  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([20, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6035113334655762  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6035113334655762  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6035494804382324  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6086611747741699  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([13, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6088924407958984  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6088924407958984  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.608917236328125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6124134063720703  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([10, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6126031875610352  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6126031875610352  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6126222610473633  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6154451370239258  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6156682968139648  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6156682968139648  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6156892776489258  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6189413070678711  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([7, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6190857887268066  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6190857887268066  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6190991401672363  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6212620735168457  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6214861869812012  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6214861869812012  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6215052604675293  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6247286796569824  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([134, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6279392242431641  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6279392242431641  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6281948089599609  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6731777191162109  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 134, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6587085723876953  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6591434478759766  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6595783233642578  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6591215133666992  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([2916, 40])
input nodes number: 7716
output nodes number: 2916
edges number: 17873
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6592035293579102  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6592040061950684  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.01661062240600586  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

pseudo mini batch 17 input nodes size: 17011
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.015167713165283203  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.015167713165283203  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.023279190063476562  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.023301124572753906  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.01412200927734375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.014544486999511719  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.014544486999511719  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.014544486999511719  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([17011, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.014544486999511719  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

m.shape torch.Size([746, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03499269485473633  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03499269485473633  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 746, 128]), torch.Size([1, 746, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.03570413589477539  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.04139566421508789  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 746, 128])
m.shape torch.Size([828, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.041829586029052734  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.041829586029052734  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 828, 128]), torch.Size([1, 828, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.04261922836303711  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0552978515625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 828, 128])
m.shape torch.Size([750, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.055975914001464844  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.055975914001464844  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 750, 128]), torch.Size([1, 750, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.05669116973876953  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07328414916992188  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 750, 128])
m.shape torch.Size([627, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07412242889404297  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07412242889404297  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 627, 128]), torch.Size([1, 627, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07472038269042969  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.09294986724853516  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 627, 128])
m.shape torch.Size([536, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.09392881393432617  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.09392881393432617  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 536, 128]), torch.Size([1, 536, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.09443998336791992  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.11284208297729492  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 536, 128])
m.shape torch.Size([438, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.11430883407592773  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.11430883407592773  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 438, 128]), torch.Size([1, 438, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.11472654342651367  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.13268804550170898  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 438, 128])
m.shape torch.Size([389, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.13377761840820312  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.13377761840820312  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 389, 128]), torch.Size([1, 389, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.13414859771728516  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.15269756317138672  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 389, 128])
m.shape torch.Size([340, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1538090705871582  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1538090705871582  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 340, 128]), torch.Size([1, 340, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.15413331985473633  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.17261552810668945  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 340, 128])
m.shape torch.Size([284, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.17367219924926758  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.17367219924926758  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 284, 128]), torch.Size([1, 284, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.17394304275512695  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.19127702713012695  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 284, 128])
m.shape torch.Size([1937, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2003779411315918  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2003779411315918  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 968, 128]), torch.Size([1, 968, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.20130109786987305  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.26778697967529297  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst 0 shape torch.Size([1, 968, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.26778697967529297  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.26778697967529297  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 969, 128]), torch.Size([1, 969, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2687110900878906  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3338613510131836  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst 1 shape torch.Size([1, 969, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.31701135635375977  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.32356786727905273  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3301243782043457  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3235163688659668  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([6875, 256])
first layer input nodes number: 17011
first layer output nodes number: 6875
edges number: 39837
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.33025312423706055  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3368096351623535  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.33844900131225586  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.33844900131225586  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

m.shape torch.Size([525, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.35514163970947266  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.35514163970947266  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 525, 256]), torch.Size([1, 525, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3561429977416992  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3641538619995117  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 525, 256])
m.shape torch.Size([475, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3645663261413574  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3645663261413574  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 475, 256]), torch.Size([1, 475, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.36547231674194336  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3798537254333496  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 475, 256])
m.shape torch.Size([362, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.38045787811279297  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.38045787811279297  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 362, 256]), torch.Size([1, 362, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3811483383178711  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.39667463302612305  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 362, 256])
m.shape torch.Size([272, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3973865509033203  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3973865509033203  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3979053497314453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4141840934753418  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([234, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.41504955291748047  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.41504955291748047  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4154958724975586  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4315633773803711  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([146, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.43218231201171875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.43218231201171875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4324607849121094  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.44443511962890625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([151, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4453120231628418  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4453120231628418  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4456000328063965  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.46000051498413086  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([117, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4607563018798828  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4607563018798828  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4609794616699219  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.47369956970214844  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([104, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4744877815246582  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4744877815246582  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4746861457824707  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4873814582824707  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([84, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.48809003829956055  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.48809003829956055  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4882502555847168  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.49962568283081055  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([71, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5002965927124023  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5002965927124023  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.500432014465332  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5109949111938477  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([50, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5115041732788086  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5115041732788086  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5115995407104492  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5197057723999023  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([42, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5201830863952637  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5201830863952637  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5202631950378418  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5276331901550293  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([32, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5280237197875977  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5280237197875977  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5280847549438477  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5341272354125977  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5345869064331055  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5345869064331055  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5346517562866211  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5415258407592773  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5419855117797852  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5419855117797852  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5420465469360352  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5489435195922852  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([22, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5492725372314453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5492725372314453  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5493144989013672  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5543498992919922  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([21, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.554692268371582  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.554692268371582  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5547323226928711  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.559819221496582  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([12, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5600185394287109  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5600185394287109  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5600414276123047  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5631084442138672  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([12, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5633277893066406  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5633277893066406  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5633506774902344  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5665779113769531  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([8, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5667281150817871  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5667281150817871  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5667433738708496  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5690016746520996  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5691633224487305  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5691633224487305  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.569178581237793  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5715436935424805  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5716691017150879  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5716691017150879  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5716805458068848  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5735344886779785  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5737133026123047  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5737133026123047  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5737285614013672  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5763072967529297  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([78, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5781741142272949  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5781741142272949  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5783228874206543  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6045069694519043  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 78, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5911960601806641  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5916295051574707  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5920629501342773  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5916075706481934  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([2906, 40])
input nodes number: 6875
output nodes number: 2906
edges number: 16705
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.591679573059082  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5916800498962402  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.015404701232910156  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

pseudo mini batch 18 input nodes size: 21195
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.01412057876586914  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.01412057876586914  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.024227142333984375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.02424907684326172  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.016115665435791016  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.016637325286865234  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.016637325286865234  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.016637325286865234  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([21195, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.016637325286865234  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

m.shape torch.Size([755, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.041956424713134766  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.041956424713134766  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 755, 128]), torch.Size([1, 755, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.042676448822021484  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.048436641693115234  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 755, 128])
m.shape torch.Size([781, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.048821449279785156  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.048821449279785156  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 781, 128]), torch.Size([1, 781, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.04956626892089844  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.06155061721801758  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 781, 128])
m.shape torch.Size([774, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0623021125793457  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.0623021125793457  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 774, 128]), torch.Size([1, 774, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.06304025650024414  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.07961130142211914  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 774, 128])
m.shape torch.Size([653, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.08055543899536133  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.08055543899536133  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 653, 128]), torch.Size([1, 653, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.08117818832397461  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.09923791885375977  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 653, 128])
m.shape torch.Size([650, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.10047626495361328  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.10047626495361328  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 650, 128]), torch.Size([1, 650, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.10109615325927734  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.12402534484863281  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 650, 128])
m.shape torch.Size([526, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.12522029876708984  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.12522029876708984  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 526, 128]), torch.Size([1, 526, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.12572193145751953  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1477212905883789  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 526, 128])
m.shape torch.Size([438, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.14893245697021484  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.14893245697021484  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 438, 128]), torch.Size([1, 438, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.14935016632080078  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.17023563385009766  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 438, 128])
m.shape torch.Size([402, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.17156028747558594  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.17156028747558594  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 402, 128]), torch.Size([1, 402, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.17194366455078125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.19379615783691406  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 402, 128])
m.shape torch.Size([308, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.19492626190185547  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.19492626190185547  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 308, 128]), torch.Size([1, 308, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.1952199935913086  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2140188217163086  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 308, 128])
m.shape torch.Size([2818, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2273092269897461  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2273092269897461  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 1409, 128]), torch.Size([1, 1409, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.2286529541015625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3269338607788086  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst 0 shape torch.Size([1, 1409, 128])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3269338607788086  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.3269338607788086  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 1409, 128]), torch.Size([1, 1409, 128])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.328277587890625  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4258866310119629  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst 1 shape torch.Size([1, 1409, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4046516418457031  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4123811721801758  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.42011070251464844  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.412320613861084  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([8105, 256])
first layer input nodes number: 21195
first layer output nodes number: 8105
edges number: 50891
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4202709197998047  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4282493591308594  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.43022966384887695  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.43022966384887695  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

m.shape torch.Size([501, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.44913148880004883  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.44913148880004883  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 501, 256]), torch.Size([1, 501, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4500870704650879  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.45777416229248047  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 501, 256])
m.shape torch.Size([370, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4580078125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4580078125  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 370, 256]), torch.Size([1, 370, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4587135314941406  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4700918197631836  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 370, 256])
m.shape torch.Size([339, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4707164764404297  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4707164764404297  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 339, 256]), torch.Size([1, 339, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4713630676269531  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4856891632080078  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 339, 256])
m.shape torch.Size([246, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4863119125366211  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.4863119125366211  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.48678112030029297  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5003881454467773  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([265, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.501427173614502  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.501427173614502  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5019326210021973  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5201735496520996  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([194, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5210399627685547  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5210399627685547  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5214099884033203  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5373210906982422  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([135, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5380444526672363  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5380444526672363  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.538301944732666  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5511765480041504  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([137, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5527949333190918  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5527949333190918  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5530562400817871  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5679507255554199  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([91, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5686073303222656  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5686073303222656  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5687808990478516  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5798892974853516  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([75, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5805234909057617  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5805234909057617  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5806665420532227  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5908231735229492  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([42, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5911960601806641  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5911960601806641  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5912761688232422  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5975246429443359  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5982112884521484  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5982112884521484  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.5983314514160156  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6085453033447266  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([54, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6091599464416504  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6091599464416504  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6092629432678223  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6187386512756348  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([50, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6193599700927734  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6193599700927734  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6194553375244141  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6288967132568359  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([33, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6293249130249023  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6293249130249023  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6293878555297852  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6360597610473633  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([27, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6364436149597168  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6364436149597168  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6364951133728027  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6423144340515137  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([22, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6426482200622559  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6426482200622559  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6426901817321777  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6477255821228027  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([23, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6481027603149414  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6481027603149414  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6481466293334961  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6537179946899414  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.654116153717041  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.654116153717041  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6541600227355957  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6600384712219238  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.660362720489502  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.660362720489502  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6603970527648926  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6652379035949707  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.665442943572998  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.665442943572998  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.665463924407959  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6685690879821777  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6688337326049805  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6688337326049805  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.668858528137207  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6727018356323242  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6729550361633301  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6729550361633301  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6729779243469238  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6766858100891113  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6769514083862305  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6769514083862305  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6769742965698242  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.680842399597168  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([139, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.684171199798584  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.684171199798584  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.6844363212585449  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7310976982116699  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 139, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7155027389526367  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7159342765808105  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7163658142089844  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7159123420715332  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([2895, 40])
input nodes number: 8105
output nodes number: 2895
edges number: 19029
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7159929275512695  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.7159934043884277  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.01767253875732422  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

pseudo mini batch 19 input nodes size: 25845
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.016113758087158203  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.016113758087158203  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.02843761444091797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.028459548950195312  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.018331050872802734  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.018996715545654297  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.018996715545654297  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.018996715545654297  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([25845, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.018996715545654297  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

m.shape torch.Size([623, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.051424503326416016  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.051424503326416016  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 623, 128]), torch.Size([1, 623, 128])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.05201864242553711  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.05765676498413086  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 623, 128])
m.shape torch.Size([701, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.058028221130371094  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.058028221130371094  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 701, 128]), torch.Size([1, 701, 128])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.058696746826171875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.0687246322631836  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 701, 128])
m.shape torch.Size([608, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.0692601203918457  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.0692601203918457  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 608, 128]), torch.Size([1, 608, 128])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.0698399543762207  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.0825963020324707  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 608, 128])
m.shape torch.Size([627, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.08350229263305664  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.08350229263305664  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 627, 128]), torch.Size([1, 627, 128])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.08410024642944336  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.1014409065246582  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 627, 128])
m.shape torch.Size([583, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.10253190994262695  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.10253190994262695  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 583, 128]), torch.Size([1, 583, 128])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.1030879020690918  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.12342643737792969  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 583, 128])
m.shape torch.Size([546, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.1247105598449707  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.1247105598449707  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 546, 128]), torch.Size([1, 546, 128])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.12523126602172852  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.14794206619262695  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 546, 128])
m.shape torch.Size([483, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.1492938995361328  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.1492938995361328  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 483, 128]), torch.Size([1, 483, 128])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.14975452423095703  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.17278575897216797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 483, 128])
m.shape torch.Size([436, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.17485332489013672  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.17485332489013672  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 436, 128]), torch.Size([1, 436, 128])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.17526912689208984  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.19896984100341797  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 436, 128])
m.shape torch.Size([368, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.20034122467041016  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.20034122467041016  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 368, 128]), torch.Size([1, 368, 128])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.20069217681884766  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.22315311431884766  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 368, 128])
m.shape torch.Size([4289, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.24342918395996094  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.24342918395996094  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 2144, 128]), torch.Size([1, 2144, 128])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.2464151382446289  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.39269351959228516  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst 0 shape torch.Size([1, 2144, 128])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.39269351959228516  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.39269351959228516  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 2145, 128]), torch.Size([1, 2145, 128])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.39484548568725586  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5422663688659668  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst 1 shape torch.Size([1, 2145, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5132570266723633  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5220918655395508  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5309267044067383  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5220227241516113  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

torch.Size([9264, 256])
first layer input nodes number: 25845
first layer output nodes number: 9264
edges number: 65619
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5311212539672852  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5399560928344727  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5421648025512695  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5421648025512695  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

m.shape torch.Size([400, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5653295516967773  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5653295516967773  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 400, 256]), torch.Size([1, 400, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5660924911499023  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5736665725708008  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 400, 256])
m.shape torch.Size([374, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5740041732788086  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5740041732788086  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 374, 256]), torch.Size([1, 374, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5747175216674805  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.586428165435791  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 374, 256])
m.shape torch.Size([270, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5868501663208008  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5868501663208008  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5873651504516602  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5992708206176758  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([239, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5999321937561035  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5999321937561035  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6003880500793457  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6136078834533691  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([212, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6143989562988281  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6143989562988281  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6148033142089844  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6293601989746094  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([170, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6301383972167969  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6301383972167969  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.630462646484375  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6444053649902344  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([155, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6452860832214355  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6452860832214355  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6455817222595215  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6603636741638184  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([124, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6611695289611816  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6611695289611816  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6614060401916504  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6748871803283691  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([107, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6756949424743652  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6756949424743652  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6758990287780762  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6889605522155762  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([91, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6897335052490234  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6897335052490234  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6899070739746094  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7022304534912109  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([77, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7029581069946289  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7029581069946289  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7031049728393555  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7145605087280273  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([70, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7152948379516602  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7152948379516602  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.715428352355957  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7267770767211914  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7273602485656738  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7273602485656738  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7274594306945801  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7365841865539551  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([54, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7372612953186035  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7372612953186035  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7373642921447754  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.747560977935791  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([46, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7481727600097656  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7481727600097656  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.748260498046875  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7575607299804688  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([44, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7581934928894043  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7581934928894043  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.758277416229248  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7677607536315918  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7682747840881348  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7682747840881348  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7683396339416504  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7761216163635254  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([23, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7764873504638672  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7764873504638672  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7765312194824219  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7821025848388672  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7825741767883301  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7825741767883301  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.782625675201416  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7895264625549316  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7899045944213867  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7899045944213867  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7899446487426758  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7955923080444336  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7959961891174316  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7959961891174316  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7960362434387207  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.801964282989502  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.8024306297302246  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.8024306297302246  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.8024744987487793  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.8092741966247559  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.8094954490661621  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.8094954490661621  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.809516429901123  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.8129153251647949  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.8132739067077637  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.8132739067077637  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.8133044242858887  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.8184618949890137  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([264, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.8247904777526855  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.8247904777526855  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.825294017791748  GigaBytes
Max Memory Allocated: 0.8367857933044434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.915557861328125  GigaBytes
Max Memory Allocated: 0.9218521118164062  GigaBytes

rst.shape  torch.Size([1, 264, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.8955469131469727  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.8959832191467285  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.8964195251464844  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.8959612846374512  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

torch.Size([2925, 40])
input nodes number: 9264
output nodes number: 2925
edges number: 23566
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.89605712890625  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.8960576057434082  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.020277023315429688  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

pseudo mini batch 20 input nodes size: 32589
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.018335819244384766  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.018335819244384766  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.033875465393066406  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.033896446228027344  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.021550655364990234  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.022361278533935547  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.022361278533935547  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.022361278533935547  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

torch.Size([32589, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.022361278533935547  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

m.shape torch.Size([668, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.06506681442260742  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.06506681442260742  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

 h.shape torch.Size([1, 668, 128]), torch.Size([1, 668, 128])
----------------------------------------3
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.0657038688659668  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.07119369506835938  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

rst.shape  torch.Size([1, 668, 128])
m.shape torch.Size([812, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.07164955139160156  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.07164955139160156  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

 h.shape torch.Size([1, 812, 128]), torch.Size([1, 812, 128])
----------------------------------------3
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.07242393493652344  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.08403968811035156  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

rst.shape  torch.Size([1, 812, 128])
m.shape torch.Size([713, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.08509588241577148  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.08509588241577148  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

 h.shape torch.Size([1, 713, 128]), torch.Size([1, 713, 128])
----------------------------------------3
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.08577585220336914  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.10103464126586914  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

rst.shape  torch.Size([1, 713, 128])
m.shape torch.Size([647, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.1019287109375  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.1019287109375  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

 h.shape torch.Size([1, 647, 128]), torch.Size([1, 647, 128])
----------------------------------------3
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.10254573822021484  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.12070465087890625  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

rst.shape  torch.Size([1, 647, 128])
m.shape torch.Size([617, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.12186717987060547  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.12186717987060547  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

 h.shape torch.Size([1, 617, 128]), torch.Size([1, 617, 128])
----------------------------------------3
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.12245559692382812  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.14381742477416992  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

rst.shape  torch.Size([1, 617, 128])
m.shape torch.Size([525, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.14502525329589844  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.14502525329589844  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

 h.shape torch.Size([1, 525, 128]), torch.Size([1, 525, 128])
----------------------------------------3
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.14552593231201172  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.1673593521118164  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

rst.shape  torch.Size([1, 525, 128])
m.shape torch.Size([478, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.16870450973510742  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.16870450973510742  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

 h.shape torch.Size([1, 478, 128]), torch.Size([1, 478, 128])
----------------------------------------3
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.1691603660583496  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.19195318222045898  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

rst.shape  torch.Size([1, 478, 128])
m.shape torch.Size([444, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.1934189796447754  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.1934189796447754  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

 h.shape torch.Size([1, 444, 128]), torch.Size([1, 444, 128])
----------------------------------------3
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.19384241104125977  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.21797800064086914  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

rst.shape  torch.Size([1, 444, 128])
m.shape torch.Size([377, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.21938419342041016  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.21938419342041016  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

 h.shape torch.Size([1, 377, 128]), torch.Size([1, 377, 128])
----------------------------------------3
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.2197437286376953  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.2427539825439453  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

rst.shape  torch.Size([1, 377, 128])
m.shape torch.Size([6307, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.27264833450317383  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.27264833450317383  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

 h.shape torch.Size([1, 3153, 128]), torch.Size([1, 3153, 128])
----------------------------------------3
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.27577733993530273  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.4898662567138672  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

rst 0 shape torch.Size([1, 3153, 128])
----------------------------------------1
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.4898662567138672  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.4898662567138672  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

 h.shape torch.Size([1, 3154, 128]), torch.Size([1, 3154, 128])
----------------------------------------3
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.4928741455078125  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 0.7084450721740723  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

rst 1 shape torch.Size([1, 3154, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 0.6709423065185547  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 0.6819934844970703  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 0.6930446624755859  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 0.6819067001342773  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

torch.Size([11588, 256])
first layer input nodes number: 32589
first layer output nodes number: 11588
edges number: 86615
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 0.6932897567749023  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 0.704340934753418  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.7080154418945312  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.7080154418945312  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

m.shape torch.Size([411, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.7301850318908691  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.7301850318908691  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

 h.shape torch.Size([1, 411, 256]), torch.Size([1, 411, 256])
----------------------------------------3
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.7309689521789551  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.7372403144836426  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

rst.shape  torch.Size([1, 411, 256])
m.shape torch.Size([398, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.7376136779785156  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.7376136779785156  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

 h.shape torch.Size([1, 398, 256]), torch.Size([1, 398, 256])
----------------------------------------3
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.738372802734375  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.7507305145263672  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

rst.shape  torch.Size([1, 398, 256])
m.shape torch.Size([299, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.751213550567627  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.751213550567627  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.7517838478088379  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.7663969993591309  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

rst.shape  torch.Size([1, 299, 256])
m.shape torch.Size([222, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.766965389251709  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.766965389251709  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.7673888206481934  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.7796683311462402  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([198, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.7804083824157715  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.7804083824157715  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.7807860374450684  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.7943816184997559  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([144, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.7950234413146973  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.7950234413146973  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.7952980995178223  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.8071084022521973  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([113, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.8077316284179688  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.8077316284179688  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.8079471588134766  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.8187236785888672  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([97, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.8193621635437012  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.8193621635437012  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.819547176361084  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.8300929069519043  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([77, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.8306665420532227  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.8306665420532227  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.8308134078979492  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.8402128219604492  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([79, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.8408989906311035  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.8408989906311035  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.8410496711730957  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.851747989654541  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.8523073196411133  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.8523073196411133  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.852421760559082  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.8613481521606445  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([58, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.8619599342346191  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.8619599342346191  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.8620705604553223  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.8714737892150879  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([38, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.8718934059143066  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.8718934059143066  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.8719658851623535  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.878633975982666  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.8791899681091309  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.8791899681091309  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.8792738914489746  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.8875823020935059  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.8881893157958984  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.8881893157958984  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.888275146484375  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.8973731994628906  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.897791862487793  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.897791862487793  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.8978490829467773  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9043149948120117  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9047279357910156  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9047279357910156  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9047794342041016  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9109592437744141  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9114527702331543  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9114527702331543  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9115099906921387  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9187769889831543  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9192051887512207  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9192051887512207  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.919252872467041  GigaBytes
Max Memory Allocated: 0.9236817359924316  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9256424903869629  GigaBytes
Max Memory Allocated: 0.9260954856872559  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9259071350097656  GigaBytes
Max Memory Allocated: 0.9260954856872559  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9259071350097656  GigaBytes
Max Memory Allocated: 0.9260954856872559  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9259357452392578  GigaBytes
Max Memory Allocated: 0.9260954856872559  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9299697875976562  GigaBytes
Max Memory Allocated: 0.9302558898925781  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9303998947143555  GigaBytes
Max Memory Allocated: 0.9304018020629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9303998947143555  GigaBytes
Max Memory Allocated: 0.9304018020629883  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9304418563842773  GigaBytes
Max Memory Allocated: 0.9304418563842773  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9366521835327148  GigaBytes
Max Memory Allocated: 0.9370927810668945  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9369697570800781  GigaBytes
Max Memory Allocated: 0.9370927810668945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9369697570800781  GigaBytes
Max Memory Allocated: 0.9370927810668945  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9370002746582031  GigaBytes
Max Memory Allocated: 0.9370927810668945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9417304992675781  GigaBytes
Max Memory Allocated: 0.9420661926269531  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9419364929199219  GigaBytes
Max Memory Allocated: 0.9420661926269531  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9419364929199219  GigaBytes
Max Memory Allocated: 0.9420661926269531  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.94195556640625  GigaBytes
Max Memory Allocated: 0.9420661926269531  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9450454711914062  GigaBytes
Max Memory Allocated: 0.9452648162841797  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9454050064086914  GigaBytes
Max Memory Allocated: 0.945406436920166  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9454050064086914  GigaBytes
Max Memory Allocated: 0.945406436920166  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9454355239868164  GigaBytes
Max Memory Allocated: 0.9454355239868164  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9505929946899414  GigaBytes
Max Memory Allocated: 0.9509592056274414  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([297, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9577145576477051  GigaBytes
Max Memory Allocated: 0.9577426910400391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9577145576477051  GigaBytes
Max Memory Allocated: 0.9577426910400391  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9582810401916504  GigaBytes
Max Memory Allocated: 0.9582810401916504  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4608154296875 GB
    Memory Allocated: 1.063215732574463  GigaBytes
Max Memory Allocated: 1.0702967643737793  GigaBytes

rst.shape  torch.Size([1, 297, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.4608154296875 GB
    Memory Allocated: 1.044018268585205  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.4608154296875 GB
    Memory Allocated: 1.044431209564209  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.4608154296875 GB
    Memory Allocated: 1.044844150543213  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.4608154296875 GB
    Memory Allocated: 1.044410228729248  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

torch.Size([2771, 40])
input nodes number: 11588
output nodes number: 2771
edges number: 22144
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4608154296875 GB
    Memory Allocated: 1.04449462890625  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.4608154296875 GB
    Memory Allocated: 1.0444951057434082  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.023848533630371094  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

pseudo mini batch 21 input nodes size: 32043
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.02152729034423828  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.02152729034423828  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.03715229034423828  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.03717327117919922  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.02161264419555664  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.02227640151977539  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.02227640151977539  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.02227640151977539  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

torch.Size([32043, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.02227640151977539  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

m.shape torch.Size([886, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.05814838409423828  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.05814838409423828  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 886, 128]), torch.Size([1, 886, 128])
----------------------------------------3
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.05899333953857422  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.06575298309326172  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 886, 128])
m.shape torch.Size([898, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.06618690490722656  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.06618690490722656  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 898, 128]), torch.Size([1, 898, 128])
----------------------------------------3
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.06704330444335938  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.07988929748535156  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 898, 128])
m.shape torch.Size([734, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.08113431930541992  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.08113431930541992  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 734, 128]), torch.Size([1, 734, 128])
----------------------------------------3
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.08183431625366211  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.09758901596069336  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 734, 128])
m.shape torch.Size([650, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.09847879409790039  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.09847879409790039  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 650, 128]), torch.Size([1, 650, 128])
----------------------------------------3
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.09909868240356445  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.11722803115844727  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 650, 128])
m.shape torch.Size([570, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.11827707290649414  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.11827707290649414  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 570, 128]), torch.Size([1, 570, 128])
----------------------------------------3
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.1188206672668457  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.13872861862182617  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 570, 128])
m.shape torch.Size([495, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.13987302780151367  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.13987302780151367  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 495, 128]), torch.Size([1, 495, 128])
----------------------------------------3
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.14034509658813477  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.1606440544128418  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 495, 128])
m.shape torch.Size([412, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.16178321838378906  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.16178321838378906  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 412, 128]), torch.Size([1, 412, 128])
----------------------------------------3
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.16217613220214844  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.1818218231201172  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 412, 128])
m.shape torch.Size([406, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.18317413330078125  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.18317413330078125  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 406, 128]), torch.Size([1, 406, 128])
----------------------------------------3
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.1835613250732422  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.20563125610351562  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 406, 128])
m.shape torch.Size([327, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.20684099197387695  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.20684099197387695  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 327, 128]), torch.Size([1, 327, 128])
----------------------------------------3
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.2071528434753418  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.2271113395690918  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 327, 128])
m.shape torch.Size([5000, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.2507972717285156  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.2507972717285156  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 2500, 128]), torch.Size([1, 2500, 128])
----------------------------------------3
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.2535381317138672  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.42700910568237305  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst 0 shape torch.Size([1, 2500, 128])
----------------------------------------1
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.42700910568237305  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.42700910568237305  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 2500, 128]), torch.Size([1, 2500, 128])
----------------------------------------3
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.42939329147338867  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.6011404991149902  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst 1 shape torch.Size([1, 2500, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.5697240829467773  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.5796213150024414  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.5895185470581055  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.5795435905456543  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

torch.Size([10378, 256])
first layer input nodes number: 32043
first layer output nodes number: 10378
edges number: 72379
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.589759349822998  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.5996565818786621  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.6021308898925781  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.6021308898925781  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

m.shape torch.Size([592, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.6188182830810547  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.6188182830810547  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 592, 256]), torch.Size([1, 592, 256])
----------------------------------------3
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.6199474334716797  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.6294126510620117  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 592, 256])
m.shape torch.Size([479, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.6297688484191895  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.6297688484191895  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 479, 256]), torch.Size([1, 479, 256])
----------------------------------------3
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.6306824684143066  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.6449041366577148  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 479, 256])
m.shape torch.Size([318, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.6453642845153809  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.6453642845153809  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.6459708213806152  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.6611418724060059  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([254, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.6618151664733887  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.6618151664733887  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.662299633026123  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.6763491630554199  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([184, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.6769914627075195  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.6769914627075195  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.677342414855957  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.689976692199707  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([136, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.6905856132507324  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.6905856132507324  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.6908450126647949  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7019991874694824  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([103, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7025628089904785  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7025628089904785  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7027592658996582  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7125821113586426  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([108, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7133145332336426  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7133145332336426  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7135205268859863  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7252621650695801  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([67, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7257390022277832  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7257390022277832  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7258667945861816  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7340455055236816  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([59, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7345490455627441  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7345490455627441  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7346615791320801  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7426514625549316  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([62, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.743250846862793  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.743250846862793  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7433691024780273  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7525930404663086  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([46, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7530646324157715  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7530646324157715  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7531523704528809  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7606101036071777  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([38, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7610411643981934  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7610411643981934  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7611136436462402  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7677817344665527  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([16, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7679610252380371  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7679610252380371  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7679915428161621  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7710127830505371  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([31, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7714447975158691  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7714447975158691  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7715039253234863  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7777714729309082  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([19, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7780342102050781  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7780342102050781  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7780704498291016  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.78216552734375  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([20, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7824745178222656  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7824745178222656  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7825126647949219  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7870903015136719  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([14, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7873134613037109  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7873134613037109  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7873401641845703  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7907314300537109  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([10, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.790900707244873  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.790900707244873  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7909197807312012  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7934756278991699  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.793889045715332  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.793889045715332  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7939310073852539  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.7998476028442383  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([13, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.8000893592834473  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.8000893592834473  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.8001141548156738  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.8037838935852051  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.803898811340332  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.803898811340332  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.8039102554321289  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.8056840896606445  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([3, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.8057451248168945  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.8057451248168945  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.805750846862793  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.8066778182983398  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.8069291114807129  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.8069291114807129  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.8069500923156738  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.8104958534240723  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([157, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.8142580986022949  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.8142580986022949  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.8145575523376465  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.8672614097595215  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 157, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.8538098335266113  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.854222297668457  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.8546347618103027  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.8542013168334961  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

torch.Size([2768, 40])
input nodes number: 10378
output nodes number: 2768
edges number: 16640
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.8542995452880859  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.8543000221252441  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.023567676544189453  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

pseudo mini batch 22 input nodes size: 32318
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.021612167358398438  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.021612167358398438  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.03702259063720703  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.03704357147216797  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.02139759063720703  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.022283554077148438  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.022283554077148438  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.022283554077148438  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

torch.Size([32318, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.022283554077148438  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

m.shape torch.Size([656, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.06908464431762695  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.06908464431762695  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 656, 128]), torch.Size([1, 656, 128])
----------------------------------------3
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.06971025466918945  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.07502365112304688  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 656, 128])
m.shape torch.Size([670, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.07534980773925781  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.07534980773925781  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 670, 128]), torch.Size([1, 670, 128])
----------------------------------------3
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.07598876953125  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.08591365814208984  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 670, 128])
m.shape torch.Size([593, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.08644247055053711  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.08644247055053711  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 593, 128]), torch.Size([1, 593, 128])
----------------------------------------3
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.08700799942016602  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.10025453567504883  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 593, 128])
m.shape torch.Size([584, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.10108566284179688  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.10108566284179688  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 584, 128]), torch.Size([1, 584, 128])
----------------------------------------3
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.10164260864257812  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.11801338195800781  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 584, 128])
m.shape torch.Size([586, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.11913204193115234  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.11913204193115234  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 586, 128]), torch.Size([1, 586, 128])
----------------------------------------3
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.1196908950805664  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.14064788818359375  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 586, 128])
m.shape torch.Size([540, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.14191341400146484  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.14191341400146484  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 540, 128]), torch.Size([1, 540, 128])
----------------------------------------3
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.14242839813232422  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.16528987884521484  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 540, 128])
m.shape torch.Size([483, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.16664457321166992  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.16664457321166992  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 483, 128]), torch.Size([1, 483, 128])
----------------------------------------3
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.16710519790649414  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.19013643264770508  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 483, 128])
m.shape torch.Size([513, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.1918630599975586  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.1918630599975586  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 513, 128]), torch.Size([1, 513, 128])
----------------------------------------3
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.192352294921875  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.22189760208129883  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 513, 128])
m.shape torch.Size([433, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.2235112190246582  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.2235112190246582  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 433, 128]), torch.Size([1, 433, 128])
----------------------------------------3
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.2239241600036621  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.2503523826599121  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 433, 128])
m.shape torch.Size([7137, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.2841777801513672  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.2841777801513672  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 3568, 128]), torch.Size([1, 3568, 128])
----------------------------------------3
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.2875804901123047  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.5345010757446289  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst 0 shape torch.Size([1, 3568, 128])
----------------------------------------1
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.5345010757446289  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.5345010757446289  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 3569, 128]), torch.Size([1, 3569, 128])
----------------------------------------3
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.5387206077575684  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.7819337844848633  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst 1 shape torch.Size([1, 3569, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.7407059669494629  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.7524819374084473  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.7641119956970215  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.7522449493408203  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

torch.Size([12195, 256])
first layer input nodes number: 32318
first layer output nodes number: 12195
edges number: 95033
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.7642087936401367  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.7759847640991211  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.7791056632995605  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.7791056632995605  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

m.shape torch.Size([414, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.8023958206176758  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.8023958206176758  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 414, 256]), torch.Size([1, 414, 256])
----------------------------------------3
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.8031854629516602  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.810175895690918  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 414, 256])
m.shape torch.Size([345, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.8104443550109863  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.8104443550109863  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 345, 256]), torch.Size([1, 345, 256])
----------------------------------------3
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.8111023902893066  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.821042537689209  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 345, 256])
m.shape torch.Size([244, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.8214173316955566  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.8214173316955566  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 244, 256]), torch.Size([1, 244, 256])
----------------------------------------3
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.8218827247619629  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.8321213722229004  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 244, 256])
m.shape torch.Size([184, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.8325963020324707  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.8325963020324707  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.8329472541809082  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.8431248664855957  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([176, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.8437952995300293  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.8437952995300293  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.8441309928894043  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.8562159538269043  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([165, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.8569998741149902  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.8569998741149902  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.8573145866394043  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.870847225189209  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([124, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.8715243339538574  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.8715243339538574  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.8717608451843262  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.8835864067077637  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([116, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.8843603134155273  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.8843603134155273  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.8845815658569336  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.8971929550170898  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([89, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.8978524208068848  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.8978524208068848  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.8980221748352051  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.9088864326477051  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([83, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.9095993041992188  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.9095993041992188  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.9097576141357422  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.9209976196289062  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([89, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.9218597412109375  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.9218597412109375  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.9220294952392578  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.9352703094482422  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.935877799987793  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.935877799987793  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.9359922409057617  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.9457197189331055  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([41, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.9461750984191895  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.9461750984191895  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.9462532997131348  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.9534478187561035  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.9539337158203125  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.9539337158203125  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.9540081024169922  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.9613723754882812  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.9617681503295898  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.9617681503295898  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.9618253707885742  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.967890739440918  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.9684619903564453  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.9684619903564453  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.968536376953125  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.9769420623779297  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.9775094985961914  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.9775094985961914  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.9775800704956055  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.986048698425293  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.9865498542785645  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.9865498542785645  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.9866089820861816  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.9941182136535645  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.9946551322937012  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.9946551322937012  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.9947142601013184  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.0026373863220215  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.003108024597168  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.003108024597168  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.003157615661621  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.0101499557495117  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.0106096267700195  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.0106096267700195  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.010655403137207  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.017430305480957  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.0177884101867676  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.0177884101867676  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.0178227424621582  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.023144245147705  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.0234370231628418  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.0234370231628418  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.0234637260437012  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.02778959274292  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.0283069610595703  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.0283069610595703  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.028350830078125  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.0357646942138672  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([316, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.0433359146118164  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.0433359146118164  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

 h.shape torch.Size([1, 316, 256]), torch.Size([1, 316, 256])
----------------------------------------3
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.0439386367797852  GigaBytes
Max Memory Allocated: 1.0708670616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.1536760330200195  GigaBytes
Max Memory Allocated: 1.161210060119629  GigaBytes

rst.shape  torch.Size([1, 316, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.1333427429199219  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.133753776550293  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.134164810180664  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.133732795715332  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

torch.Size([2758, 40])
input nodes number: 12195
output nodes number: 2758
edges number: 23691
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.1338434219360352  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.1338438987731934  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.023891448974609375  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

pseudo mini batch 23 input nodes size: 39788
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.021396160125732422  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.021396160125732422  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.04092741012573242  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.04094839096069336  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.025516986846923828  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.026733875274658203  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.026733875274658203  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.026733875274658203  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

torch.Size([39788, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.026733875274658203  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

m.shape torch.Size([558, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.09156179428100586  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.09156179428100586  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

 h.shape torch.Size([1, 558, 128]), torch.Size([1, 558, 128])
----------------------------------------3
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.09209394454956055  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.09675264358520508  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

rst.shape  torch.Size([1, 558, 128])
m.shape torch.Size([631, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.09708833694458008  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.09708833694458008  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

 h.shape torch.Size([1, 631, 128]), torch.Size([1, 631, 128])
----------------------------------------3
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.09769010543823242  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.10671663284301758  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

rst.shape  torch.Size([1, 631, 128])
m.shape torch.Size([560, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.10721683502197266  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.10721683502197266  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

 h.shape torch.Size([1, 560, 128]), torch.Size([1, 560, 128])
----------------------------------------3
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.10775089263916016  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.11973285675048828  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

rst.shape  torch.Size([1, 560, 128])
m.shape torch.Size([520, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.12045764923095703  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.12045764923095703  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

 h.shape torch.Size([1, 520, 128]), torch.Size([1, 520, 128])
----------------------------------------3
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.12095355987548828  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.13557910919189453  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

rst.shape  torch.Size([1, 520, 128])
m.shape torch.Size([512, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.1365518569946289  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.1365518569946289  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

 h.shape torch.Size([1, 512, 128]), torch.Size([1, 512, 128])
----------------------------------------3
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.1370401382446289  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.1546182632446289  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

rst.shape  torch.Size([1, 512, 128])
m.shape torch.Size([464, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.1557016372680664  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.1557016372680664  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

 h.shape torch.Size([1, 464, 128]), torch.Size([1, 464, 128])
----------------------------------------3
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.1561441421508789  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.1751718521118164  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

rst.shape  torch.Size([1, 464, 128])
m.shape torch.Size([489, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.17658281326293945  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.17658281326293945  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

 h.shape torch.Size([1, 489, 128]), torch.Size([1, 489, 128])
----------------------------------------3
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.1770491600036621  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.20036649703979492  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

rst.shape  torch.Size([1, 489, 128])
m.shape torch.Size([479, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.20196056365966797  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.20196056365966797  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

 h.shape torch.Size([1, 479, 128]), torch.Size([1, 479, 128])
----------------------------------------3
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.20241737365722656  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.2284555435180664  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

rst.shape  torch.Size([1, 479, 128])
m.shape torch.Size([495, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.23090171813964844  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.23090171813964844  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

 h.shape torch.Size([1, 495, 128]), torch.Size([1, 495, 128])
----------------------------------------3
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.23137378692626953  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.26158618927001953  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

rst.shape  torch.Size([1, 495, 128])
m.shape torch.Size([10946, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.314084529876709  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.314084529876709  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

 h.shape torch.Size([1, 5473, 128]), torch.Size([1, 5473, 128])
----------------------------------------3
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.3193039894104004  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.6922950744628906  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

rst 0 shape torch.Size([1, 5473, 128])
----------------------------------------1
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.6922950744628906  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.6922950744628906  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

 h.shape torch.Size([1, 5473, 128]), torch.Size([1, 5473, 128])
----------------------------------------3
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.697514533996582  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7537841796875 GB
    Memory Allocated: 1.064896583557129  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

rst 1 shape torch.Size([1, 5473, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.7537841796875 GB
    Memory Allocated: 1.0064659118652344  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.7537841796875 GB
    Memory Allocated: 1.0213947296142578  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.7537841796875 GB
    Memory Allocated: 1.0363235473632812  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.7537841796875 GB
    Memory Allocated: 1.021277904510498  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

torch.Size([15654, 256])
first layer input nodes number: 39788
first layer output nodes number: 15654
edges number: 132094
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.7537841796875 GB
    Memory Allocated: 1.0366220474243164  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.7537841796875 GB
    Memory Allocated: 1.0515508651733398  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.7537841796875 GB
    Memory Allocated: 1.0554237365722656  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.7537841796875 GB
    Memory Allocated: 1.0554237365722656  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

m.shape torch.Size([353, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.0858893394470215  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.0858893394470215  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

 h.shape torch.Size([1, 353, 256]), torch.Size([1, 353, 256])
----------------------------------------3
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.0865626335144043  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.0926451683044434  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

rst.shape  torch.Size([1, 353, 256])
m.shape torch.Size([275, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.0928373336791992  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.0928373336791992  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.0933618545532227  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.102464199066162  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([226, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.102853775024414  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.102853775024414  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.1032848358154297  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.1127681732177734  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([161, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.1131720542907715  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.1131720542907715  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.1134791374206543  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.1223845481872559  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([143, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.1229186058044434  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.1229186058044434  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.1231913566589355  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.1330103874206543  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([119, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.1335606575012207  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.1335606575012207  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.1337876319885254  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.143547534942627  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([87, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.144019603729248  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.144019603729248  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.1441855430603027  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.152482509613037  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([73, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.152961254119873  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.152961254119873  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.1531004905700684  GigaBytes
Max Memory Allocated: 1.16127347946167  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.1610369682312012  GigaBytes
Max Memory Allocated: 1.1615939140319824  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([83, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.1616854667663574  GigaBytes
Max Memory Allocated: 1.1616883277893066  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.1616854667663574  GigaBytes
Max Memory Allocated: 1.1616883277893066  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.1618437767028809  GigaBytes
Max Memory Allocated: 1.1618437767028809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.1719756126403809  GigaBytes
Max Memory Allocated: 1.1726880073547363  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([60, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.172473430633545  GigaBytes
Max Memory Allocated: 1.1726880073547363  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.172473430633545  GigaBytes
Max Memory Allocated: 1.1726880073547363  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.1725878715515137  GigaBytes
Max Memory Allocated: 1.1726880073547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.180713176727295  GigaBytes
Max Memory Allocated: 1.1812853813171387  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([68, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.1813750267028809  GigaBytes
Max Memory Allocated: 1.18137788772583  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.1813750267028809  GigaBytes
Max Memory Allocated: 1.18137788772583  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.181504726409912  GigaBytes
Max Memory Allocated: 1.181504726409912  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.1916213035583496  GigaBytes
Max Memory Allocated: 1.1923346519470215  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([57, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.192214012145996  GigaBytes
Max Memory Allocated: 1.1923346519470215  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.192214012145996  GigaBytes
Max Memory Allocated: 1.1923346519470215  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.1923227310180664  GigaBytes
Max Memory Allocated: 1.1923346519470215  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.201563835144043  GigaBytes
Max Memory Allocated: 1.2022161483764648  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2021470069885254  GigaBytes
Max Memory Allocated: 1.2022161483764648  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2021470069885254  GigaBytes
Max Memory Allocated: 1.2022161483764648  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2022442817687988  GigaBytes
Max Memory Allocated: 1.2022442817687988  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.211193561553955  GigaBytes
Max Memory Allocated: 1.2118258476257324  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([41, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2116966247558594  GigaBytes
Max Memory Allocated: 1.2118258476257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2116966247558594  GigaBytes
Max Memory Allocated: 1.2118258476257324  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2117748260498047  GigaBytes
Max Memory Allocated: 1.2118258476257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2195167541503906  GigaBytes
Max Memory Allocated: 1.2200641632080078  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([29, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.219895839691162  GigaBytes
Max Memory Allocated: 1.2200641632080078  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.219895839691162  GigaBytes
Max Memory Allocated: 1.2200641632080078  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2199511528015137  GigaBytes
Max Memory Allocated: 1.2200641632080078  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2258143424987793  GigaBytes
Max Memory Allocated: 1.226229190826416  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2262945175170898  GigaBytes
Max Memory Allocated: 1.2262969017028809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2262945175170898  GigaBytes
Max Memory Allocated: 1.2262969017028809  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2263574600219727  GigaBytes
Max Memory Allocated: 1.2263574600219727  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2334699630737305  GigaBytes
Max Memory Allocated: 1.233973503112793  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2339286804199219  GigaBytes
Max Memory Allocated: 1.233973503112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2339286804199219  GigaBytes
Max Memory Allocated: 1.233973503112793  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2339859008789062  GigaBytes
Max Memory Allocated: 1.2339859008789062  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2408523559570312  GigaBytes
Max Memory Allocated: 1.2413387298583984  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.241429328918457  GigaBytes
Max Memory Allocated: 1.241431713104248  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.241429328918457  GigaBytes
Max Memory Allocated: 1.241431713104248  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2414960861206055  GigaBytes
Max Memory Allocated: 1.2414960861206055  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.249974250793457  GigaBytes
Max Memory Allocated: 1.250575065612793  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([37, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2506165504455566  GigaBytes
Max Memory Allocated: 1.2506194114685059  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2506165504455566  GigaBytes
Max Memory Allocated: 1.2506194114685059  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2506871223449707  GigaBytes
Max Memory Allocated: 1.2506871223449707  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.260143756866455  GigaBytes
Max Memory Allocated: 1.2608141899108887  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2606663703918457  GigaBytes
Max Memory Allocated: 1.2608141899108887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2606663703918457  GigaBytes
Max Memory Allocated: 1.2608141899108887  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2607216835021973  GigaBytes
Max Memory Allocated: 1.2608141899108887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2685208320617676  GigaBytes
Max Memory Allocated: 1.2690739631652832  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2689170837402344  GigaBytes
Max Memory Allocated: 1.2690739631652832  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2689170837402344  GigaBytes
Max Memory Allocated: 1.2690739631652832  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2689571380615234  GigaBytes
Max Memory Allocated: 1.2690739631652832  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2748851776123047  GigaBytes
Max Memory Allocated: 1.2753057479858398  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2754364013671875  GigaBytes
Max Memory Allocated: 1.2754387855529785  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2754364013671875  GigaBytes
Max Memory Allocated: 1.2754387855529785  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2754878997802734  GigaBytes
Max Memory Allocated: 1.2754878997802734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2834701538085938  GigaBytes
Max Memory Allocated: 1.284036636352539  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2839531898498535  GigaBytes
Max Memory Allocated: 1.284036636352539  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2839531898498535  GigaBytes
Max Memory Allocated: 1.284036636352539  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2839970588684082  GigaBytes
Max Memory Allocated: 1.284036636352539  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2911038398742676  GigaBytes
Max Memory Allocated: 1.2916083335876465  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2915897369384766  GigaBytes
Max Memory Allocated: 1.2916083335876465  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2915897369384766  GigaBytes
Max Memory Allocated: 1.2916083335876465  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2916316986083984  GigaBytes
Max Memory Allocated: 1.2916316986083984  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.2987232208251953  GigaBytes
Max Memory Allocated: 1.2992267608642578  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([675, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.3149213790893555  GigaBytes
Max Memory Allocated: 1.3149843215942383  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.3149213790893555  GigaBytes
Max Memory Allocated: 1.3149843215942383  GigaBytes

 h.shape torch.Size([1, 675, 256]), torch.Size([1, 675, 256])
----------------------------------------3
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.316208839416504  GigaBytes
Max Memory Allocated: 1.316208839416504  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9393310546875 GB
    Memory Allocated: 1.5434613227844238  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

rst.shape  torch.Size([1, 675, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9393310546875 GB
    Memory Allocated: 1.5156068801879883  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9393310546875 GB
    Memory Allocated: 1.5160179138183594  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9393310546875 GB
    Memory Allocated: 1.5164289474487305  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.9393310546875 GB
    Memory Allocated: 1.5159969329833984  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

torch.Size([2758, 40])
input nodes number: 15654
output nodes number: 2758
edges number: 31216
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9393310546875 GB
    Memory Allocated: 1.5161347389221191  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.9393310546875 GB
    Memory Allocated: 1.5161352157592773  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.028862476348876953  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

pseudo mini batch 24 input nodes size: 51325
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.025516986846923828  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.025516986846923828  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.05090761184692383  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.050928592681884766  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.03137636184692383  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.03280305862426758  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.03280305862426758  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.03280305862426758  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

torch.Size([51325, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.03280305862426758  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

m.shape torch.Size([634, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.1119070053100586  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.1119070053100586  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

 h.shape torch.Size([1, 634, 128]), torch.Size([1, 634, 128])
----------------------------------------3
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.11251163482666016  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.11737775802612305  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

rst.shape  torch.Size([1, 634, 128])
m.shape torch.Size([703, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.11774587631225586  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.11774587631225586  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

 h.shape torch.Size([1, 703, 128]), torch.Size([1, 703, 128])
----------------------------------------3
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.11841630935668945  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.12847280502319336  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

rst.shape  torch.Size([1, 703, 128])
m.shape torch.Size([657, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.12907743453979492  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.12907743453979492  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

 h.shape torch.Size([1, 657, 128]), torch.Size([1, 657, 128])
----------------------------------------3
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.12970399856567383  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.14349031448364258  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

rst.shape  torch.Size([1, 657, 128])
m.shape torch.Size([594, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.14487075805664062  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.14487075805664062  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

 h.shape torch.Size([1, 594, 128]), torch.Size([1, 594, 128])
----------------------------------------3
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.14543724060058594  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.16225433349609375  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

rst.shape  torch.Size([1, 594, 128])
m.shape torch.Size([636, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.16348743438720703  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.16348743438720703  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

 h.shape torch.Size([1, 636, 128]), torch.Size([1, 636, 128])
----------------------------------------3
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.1640939712524414  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.18738842010498047  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

rst.shape  torch.Size([1, 636, 128])
m.shape torch.Size([604, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.1888132095336914  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.1888132095336914  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

 h.shape torch.Size([1, 604, 128]), torch.Size([1, 604, 128])
----------------------------------------3
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.18938922882080078  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.21493244171142578  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

rst.shape  torch.Size([1, 604, 128])
m.shape torch.Size([561, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.2167959213256836  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.2167959213256836  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

 h.shape torch.Size([1, 561, 128]), torch.Size([1, 561, 128])
----------------------------------------3
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.2173309326171875  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.24472618103027344  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

rst.shape  torch.Size([1, 561, 128])
m.shape torch.Size([566, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.24661779403686523  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.24661779403686523  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

 h.shape torch.Size([1, 566, 128]), torch.Size([1, 566, 128])
----------------------------------------3
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.24715757369995117  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.27829694747924805  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

rst.shape  torch.Size([1, 566, 128])
m.shape torch.Size([603, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.28061485290527344  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.28061485290527344  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

 h.shape torch.Size([1, 603, 128]), torch.Size([1, 603, 128])
----------------------------------------3
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.2811899185180664  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.3188643455505371  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

rst.shape  torch.Size([1, 603, 128])
m.shape torch.Size([13417, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.3830299377441406  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.3830299377441406  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

 h.shape torch.Size([1, 6708, 128]), torch.Size([1, 6708, 128])
----------------------------------------3
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.38942718505859375  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.8473663330078125  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

rst 0 shape torch.Size([1, 6708, 128])
----------------------------------------1
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.8473663330078125  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.8473663330078125  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

 h.shape torch.Size([1, 6709, 128]), torch.Size([1, 6709, 128])
----------------------------------------3
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.8541035652160645  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.3127670288085938  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

rst 1 shape torch.Size([1, 6709, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.2410316467285156  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.2591276168823242  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.2772235870361328  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.258985996246338  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

torch.Size([18975, 256])
first layer input nodes number: 51325
first layer output nodes number: 18975
edges number: 161243
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.2776079177856445  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.2957038879394531  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.3002281188964844  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.3002281188964844  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

m.shape torch.Size([338, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.3296375274658203  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.3296375274658203  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

 h.shape torch.Size([1, 338, 256]), torch.Size([1, 338, 256])
----------------------------------------3
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.330282211303711  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.3360939025878906  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

rst.shape  torch.Size([1, 338, 256])
m.shape torch.Size([328, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.336402416229248  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.336402416229248  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

 h.shape torch.Size([1, 328, 256]), torch.Size([1, 328, 256])
----------------------------------------3
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.3370280265808105  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.3482170104980469  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

rst.shape  torch.Size([1, 328, 256])
m.shape torch.Size([222, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.3485445976257324  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.3485445976257324  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.3489680290222168  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.358283519744873  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([159, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.3586831092834473  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.3586831092834473  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.3589863777160645  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.367781162261963  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([150, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.3683505058288574  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.3683505058288574  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.3686366081237793  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.3789362907409668  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([122, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.3794970512390137  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.3794970512390137  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.3797297477722168  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.3897356986999512  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([97, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.3902721405029297  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.3902721405029297  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.3904571533203125  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.3997077941894531  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([80, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.4002304077148438  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.4002304077148438  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.4003829956054688  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.4090805053710938  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([63, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.4095492362976074  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.4095492362976074  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.4096693992614746  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.4173598289489746  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([48, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.4177613258361816  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.4177613258361816  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.4178528785705566  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.4243531227111816  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([57, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.424910068511963  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.424910068511963  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.4250187873840332  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.4334988594055176  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.434171199798584  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.434171199798584  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.4342913627624512  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.444505214691162  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([58, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.4451699256896973  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.4451699256896973  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.4452805519104004  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.455458164215088  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([40, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.4559412002563477  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.4559412002563477  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.4560174942016602  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.4635705947875977  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([51, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.4642677307128906  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.4642677307128906  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.464365005493164  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.4746761322021484  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([50, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.4753966331481934  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.4753966331481934  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.475492000579834  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.4862685203552246  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([43, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.4869236946105957  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.4869236946105957  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.4870057106018066  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.4968476295471191  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([42, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.4975333213806152  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.4975333213806152  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.4976134300231934  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.5077872276306152  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.508185863494873  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.508185863494873  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.5082316398620605  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.5143656730651855  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([37, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.5150542259216309  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.5150542259216309  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.515124797821045  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.5250754356384277  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([39, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.525827407836914  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.525827407836914  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.5259017944335938  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.5369110107421875  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.537381649017334  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.537381649017334  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.5374274253845215  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.544522762298584  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([24, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.5450305938720703  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.5450305938720703  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.5450763702392578  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.5524921417236328  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.553138256072998  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.553138256072998  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.5531935691833496  GigaBytes
Max Memory Allocated: 1.5595545768737793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.5625414848327637  GigaBytes
Max Memory Allocated: 1.5632052421569824  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([578, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.576402187347412  GigaBytes
Max Memory Allocated: 1.576456069946289  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.576402187347412  GigaBytes
Max Memory Allocated: 1.576456069946289  GigaBytes

 h.shape torch.Size([1, 578, 256]), torch.Size([1, 578, 256])
----------------------------------------3
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 1.5775046348571777  GigaBytes
Max Memory Allocated: 1.5775046348571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2264404296875 GB
    Memory Allocated: 1.7719569206237793  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 578, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2264404296875 GB
    Memory Allocated: 1.745236873626709  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2264404296875 GB
    Memory Allocated: 1.7456493377685547  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2264404296875 GB
    Memory Allocated: 1.7460618019104004  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2264404296875 GB
    Memory Allocated: 1.7456283569335938  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

torch.Size([2766, 40])
input nodes number: 18975
output nodes number: 2766
edges number: 30134
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2264404296875 GB
    Memory Allocated: 1.7457923889160156  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2264404296875 GB
    Memory Allocated: 1.7457928657531738  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.03529548645019531  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

pseudo mini batch 25 input nodes size: 49433
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.03137779235839844  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.03137779235839844  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.054949283599853516  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.05497026443481445  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.029558658599853516  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.030931949615478516  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.030931949615478516  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.030931949615478516  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

torch.Size([49433, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.030931949615478516  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

m.shape torch.Size([617, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.10672378540039062  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.10672378540039062  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 617, 128]), torch.Size([1, 617, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.10731220245361328  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.11266183853149414  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 617, 128])
m.shape torch.Size([690, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.11302566528320312  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.11302566528320312  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 690, 128]), torch.Size([1, 690, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.11368370056152344  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.12434816360473633  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 690, 128])
m.shape torch.Size([630, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.12492036819458008  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.12492036819458008  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 630, 128]), torch.Size([1, 630, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.12552118301391602  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.13907098770141602  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 630, 128])
m.shape torch.Size([632, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.13997602462768555  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.13997602462768555  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 632, 128]), torch.Size([1, 632, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1405787467956543  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.15981626510620117  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 632, 128])
m.shape torch.Size([612, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.16097402572631836  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.16097402572631836  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 612, 128]), torch.Size([1, 612, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.16155767440795898  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.18349027633666992  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 612, 128])
m.shape torch.Size([586, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1848750114440918  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1848750114440918  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 586, 128]), torch.Size([1, 586, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.18543386459350586  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.21075963973999023  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 586, 128])
m.shape torch.Size([574, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.21239614486694336  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.21239614486694336  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 574, 128]), torch.Size([1, 574, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.21294355392456055  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.24149560928344727  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 574, 128])
m.shape torch.Size([571, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.24340009689331055  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.24340009689331055  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 571, 128]), torch.Size([1, 571, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.24394464492797852  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.2761549949645996  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 571, 128])
m.shape torch.Size([558, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.2782773971557617  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.2782773971557617  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 558, 128]), torch.Size([1, 558, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.2788095474243164  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.31420326232910156  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 558, 128])
m.shape torch.Size([12788, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.37491512298583984  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.37491512298583984  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 6394, 128]), torch.Size([1, 6394, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.381439208984375  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.814763069152832  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst 0 shape torch.Size([1, 6394, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.814763069152832  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.814763069152832  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 6394, 128]), torch.Size([1, 6394, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.8208608627319336  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2522773742675781  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst 1 shape torch.Size([1, 6394, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.184617519378662  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2020297050476074  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2194418907165527  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2018933296203613  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

torch.Size([18258, 256])
first layer input nodes number: 49433
first layer output nodes number: 18258
edges number: 154479
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2198123931884766  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2372245788574219  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2415776252746582  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2415776252746582  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

m.shape torch.Size([367, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2707037925720215  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2707037925720215  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 367, 256]), torch.Size([1, 367, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2714037895202637  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.278306484222412  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 367, 256])
m.shape torch.Size([308, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2785487174987793  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2785487174987793  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 308, 256]), torch.Size([1, 308, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2791361808776855  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2883257865905762  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 308, 256])
m.shape torch.Size([213, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2886462211608887  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2886462211608887  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2890524864196777  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.297990322113037  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([160, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2984023094177246  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2984023094177246  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2987074851989746  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3075575828552246  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([160, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3081741333007812  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3081741333007812  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3084793090820312  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3194656372070312  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([115, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3199763298034668  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3199763298034668  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3201956748962402  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.329627513885498  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([96, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3301639556884766  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3301639556884766  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3303470611572266  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3395023345947266  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([98, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3401646614074707  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3401646614074707  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3403515815734863  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.351006031036377  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([82, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3516221046447754  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3516221046447754  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.351778507232666  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.361788272857666  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([60, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3622870445251465  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3622870445251465  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3624014854431152  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3705267906188965  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([53, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.371030330657959  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.371030330657959  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.371131420135498  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.379016399383545  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([49, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3795313835144043  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3795313835144043  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.379624843597412  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3875689506530762  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([55, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3882098197937012  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3882098197937012  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3883147239685059  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.397965908050537  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3984251022338867  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3984251022338867  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3984975814819336  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4056730270385742  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([33, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4061126708984375  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4061126708984375  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4061756134033203  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4128475189208984  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.413400650024414  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.413400650024414  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.413473129272461  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4216632843017578  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4220685958862305  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4220685958862305  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4221200942993164  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.428299903869629  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([37, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4289145469665527  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4289145469665527  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4289851188659668  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4379477500915527  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.438460350036621  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.438460350036621  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4385175704956055  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4461851119995117  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4467525482177734  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4467525482177734  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4468116760253906  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.455148696899414  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([34, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.455805778503418  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.455805778503418  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4558706283569336  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.465468406677246  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4658589363098145  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4658589363098145  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4658970832824707  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4718098640441895  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4723658561706543  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4723658561706543  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4724154472351074  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4804491996765137  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4809551239013672  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4809551239013672  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4809989929199219  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.488412857055664  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([605, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.5029282569885254  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.5029282569885254  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 605, 256]), torch.Size([1, 605, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.504082202911377  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.7151002883911133  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 605, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.688654899597168  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.689065933227539  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.6894769668579102  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.6890449523925781  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

torch.Size([2758, 40])
input nodes number: 18258
output nodes number: 2758
edges number: 29811
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.6892008781433105  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.6892013549804688  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.033335208892822266  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

pseudo mini batch 26 input nodes size: 45633
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.029557228088378906  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.029557228088378906  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.05131673812866211  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.05133771896362305  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.02774524688720703  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.028821945190429688  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.028821945190429688  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.028821945190429688  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

torch.Size([45633, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.028821945190429688  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

m.shape torch.Size([730, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.08839035034179688  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.08839035034179688  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 730, 128]), torch.Size([1, 730, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.08908653259277344  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.09494161605834961  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 730, 128])
m.shape torch.Size([807, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.09536314010620117  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.09536314010620117  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 807, 128]), torch.Size([1, 807, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.09613275527954102  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.10852336883544922  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 807, 128])
m.shape torch.Size([726, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1091771125793457  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1091771125793457  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 726, 128]), torch.Size([1, 726, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.10986948013305664  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.12547063827514648  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 726, 128])
m.shape torch.Size([666, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.12639474868774414  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.12639474868774414  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 666, 128]), torch.Size([1, 666, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1270298957824707  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1466050148010254  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 666, 128])
m.shape torch.Size([665, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1478729248046875  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1478729248046875  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 665, 128]), torch.Size([1, 665, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.14850711822509766  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.17164134979248047  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 665, 128])
m.shape torch.Size([545, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1728835105895996  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1728835105895996  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 545, 128]), torch.Size([1, 545, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.17340326309204102  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.19653892517089844  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 545, 128])
m.shape torch.Size([524, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1980280876159668  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1980280876159668  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 524, 128]), torch.Size([1, 524, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.19852781295776367  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.2247614860534668  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 524, 128])
m.shape torch.Size([496, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.22640371322631836  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.22640371322631836  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 496, 128]), torch.Size([1, 496, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.22687673568725586  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.25383901596069336  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 496, 128])
m.shape torch.Size([480, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.2556624412536621  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.2556624412536621  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 480, 128]), torch.Size([1, 480, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.2561202049255371  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.2854170799255371  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 480, 128])
m.shape torch.Size([9536, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.3306593894958496  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.3306593894958496  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 4768, 128]), torch.Size([1, 4768, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.3352065086364746  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.6581435203552246  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst 0 shape torch.Size([1, 4768, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.6581435203552246  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.6581435203552246  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 4768, 128]), torch.Size([1, 4768, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.6626906394958496  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.9832625389099121  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst 1 shape torch.Size([1, 4768, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.9301915168762207  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.9446635246276855  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.9591355323791504  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.9445500373840332  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

torch.Size([15175, 256])
first layer input nodes number: 45633
first layer output nodes number: 15175
edges number: 121097
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.9594779014587402  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.9739499092102051  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.9784970283508301  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.9784970283508301  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

m.shape torch.Size([444, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.001349925994873  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.001349925994873  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 444, 256]), torch.Size([1, 444, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0021967887878418  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0095515251159668  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 444, 256])
m.shape torch.Size([381, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0098605155944824  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0098605155944824  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 381, 256]), torch.Size([1, 381, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.010587215423584  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0222511291503906  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 381, 256])
m.shape torch.Size([274, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0226778984069824  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0226778984069824  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.023200511932373  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0373406410217285  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([228, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0379562377929688  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0379562377929688  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.03839111328125  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0510025024414062  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([183, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0516648292541504  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0516648292541504  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.052013874053955  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0645794868469238  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([109, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0650339126586914  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0650339126586914  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.065241813659668  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0741815567016602  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([131, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0749592781066895  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0749592781066895  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.075209140777588  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0877022743225098  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([96, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.088315486907959  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.088315486907959  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.088498592376709  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.098935604095459  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([87, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0995969772338867  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0995969772338867  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0997629165649414  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1103830337524414  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([63, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.110905647277832  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.110905647277832  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1110258102416992  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1195573806762695  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([55, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1200790405273438  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1200790405273438  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1201839447021484  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.128366470336914  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([49, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1288795471191406  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1288795471191406  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1289730072021484  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1369171142578125  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1375079154968262  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1375079154968262  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1376051902770996  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1465544700622559  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([34, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1469635963439941  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1469635963439941  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1470284461975098  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1534485816955566  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1539063453674316  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1539063453674316  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1539711952209473  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1608452796936035  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1612896919250488  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1612896919250488  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.161348819732666  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1680302619934082  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([21, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1683440208435059  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1683440208435059  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.168384075164795  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1731905937194824  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([37, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1738109588623047  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1738109588623047  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1738815307617188  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1828441619873047  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.183283805847168  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.183283805847168  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.183333396911621  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1899785995483398  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([35, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.190626621246338  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.190626621246338  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1906933784484863  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.200106143951416  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2004566192626953  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2004566192626953  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2004928588867188  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2058563232421875  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.206049919128418  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.206049919128418  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.206068992614746  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2090253829956055  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2094359397888184  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2094359397888184  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2094721794128418  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2153429985046387  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2156248092651367  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2156248092651367  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2156496047973633  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2198400497436523  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([347, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2288579940795898  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2288579940795898  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 347, 256]), torch.Size([1, 347, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2295198440551758  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3479065895080566  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 347, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.328023910522461  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3284378051757812  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3288516998291016  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3284168243408203  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

torch.Size([2777, 40])
input nodes number: 15175
output nodes number: 2777
edges number: 23205
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3285541534423828  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.328554630279541  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.03078746795654297  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

pseudo mini batch 27 input nodes size: 45130
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.02774810791015625  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.02774810791015625  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.04926776885986328  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.04928874969482422  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.027508258819580078  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.028487682342529297  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.028487682342529297  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.028487682342529297  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

torch.Size([45130, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.028487682342529297  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

m.shape torch.Size([744, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.08292198181152344  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.08292198181152344  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 744, 128]), torch.Size([1, 744, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.08363151550292969  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.08980655670166016  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 744, 128])
m.shape torch.Size([810, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.0902242660522461  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.0902242660522461  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 810, 128]), torch.Size([1, 810, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.09099674224853516  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1025838851928711  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 810, 128])
m.shape torch.Size([722, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.10335350036621094  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.10335350036621094  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 722, 128]), torch.Size([1, 722, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.10404205322265625  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.11972427368164062  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 722, 128])
m.shape torch.Size([674, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1206655502319336  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1206655502319336  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 674, 128]), torch.Size([1, 674, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1213083267211914  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.13994884490966797  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 674, 128])
m.shape torch.Size([639, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.14115095138549805  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.14115095138549805  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 639, 128]), torch.Size([1, 639, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.14176034927368164  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.16448068618774414  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 639, 128])
m.shape torch.Size([583, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.16584396362304688  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.16584396362304688  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 583, 128]), torch.Size([1, 583, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.16639995574951172  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.19134092330932617  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 583, 128])
m.shape torch.Size([535, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.19284868240356445  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.19284868240356445  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 535, 128]), torch.Size([1, 535, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1933588981628418  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.21934795379638672  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 535, 128])
m.shape torch.Size([438, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.2207636833190918  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.2207636833190918  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 438, 128]), torch.Size([1, 438, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.22118139266967773  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.24499082565307617  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 438, 128])
m.shape torch.Size([458, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.24674749374389648  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.24674749374389648  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 458, 128]), torch.Size([1, 458, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.24718427658081055  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.27513837814331055  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 458, 128])
m.shape torch.Size([8409, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.3150172233581543  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.3150172233581543  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 4204, 128]), torch.Size([1, 4204, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.31989336013793945  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.6045622825622559  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst 0 shape torch.Size([1, 4204, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.6045622825622559  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.6045622825622559  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 4205, 128]), torch.Size([1, 4205, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.6085724830627441  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.8912920951843262  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst 1 shape torch.Size([1, 4205, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.8429656028747559  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.8563284873962402  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.8696913719177246  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.8562240600585938  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

torch.Size([14012, 256])
first layer input nodes number: 45130
first layer output nodes number: 14012
edges number: 109380
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.8700299263000488  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.8833928108215332  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.8868832588195801  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.8868832588195801  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

m.shape torch.Size([460, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.9090991020202637  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.9090991020202637  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.9099764823913574  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.9173331260681152  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([412, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.9176864624023438  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.9176864624023438  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 412, 256]), torch.Size([1, 412, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.9184722900390625  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.9304256439208984  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 412, 256])
m.shape torch.Size([275, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.9308257102966309  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.9308257102966309  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.9313502311706543  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.9467258453369141  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([235, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.9473671913146973  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.9473671913146973  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.9478154182434082  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.9608139991760254  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([195, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.9615273475646973  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.9615273475646973  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.9618992805480957  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.9752888679504395  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([141, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.9759163856506348  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.9759163856506348  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.9761853218078613  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.9877495765686035  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([114, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.9883823394775391  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.9883823394775391  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.9885997772216797  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.9994716644287109  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([90, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0000553131103516  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0000553131103516  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0002269744873047  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0100116729736328  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([59, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0104365348815918  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0104365348815918  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0105490684509277  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0177512168884277  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([76, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.018425464630127  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.018425464630127  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0185704231262207  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.028862476348877  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([56, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0293822288513184  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0293822288513184  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0294890403747559  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0378203392028809  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([55, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0384016036987305  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0384016036987305  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0385065078735352  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0474233627319336  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([35, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0478086471557617  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0478086471557617  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0478754043579102  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0540170669555664  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0545086860656738  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0545086860656738  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0545830726623535  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0619473457336426  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0624003410339355  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0624003410339355  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0624651908874512  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0693392753601074  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0698299407958984  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0698299407958984  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.069894790649414  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0772228240966797  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0777950286865234  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0777950286865234  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0778656005859375  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.086334228515625  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0868353843688965  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0868353843688965  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0868945121765137  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0944037437438965  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0949406623840332  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0949406623840332  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0949997901916504  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1029229164123535  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([13, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1031436920166016  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1031436920166016  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1031684875488281  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1066646575927734  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1069955825805664  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1069955825805664  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1070280075073242  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1118268966674805  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1120858192443848  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1120858192443848  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1121106147766113  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1159539222717285  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1162734031677246  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1162734031677246  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1163020133972168  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1209368705749512  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1212458610534668  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1212458610534668  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1212725639343262  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1257853507995605  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([302, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1339497566223145  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1339497566223145  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1345257759094238  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.243088722229004  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 302, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.223897933959961  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2243127822875977  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2247276306152344  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2242918014526367  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

torch.Size([2783, 40])
input nodes number: 14012
output nodes number: 2783
edges number: 21920
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2244181632995605  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2244186401367188  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.030313968658447266  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

pseudo mini batch 28 input nodes size: 38613
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.027509212493896484  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.027509212493896484  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.04592132568359375  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.04594230651855469  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.02440166473388672  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.025630950927734375  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.025630950927734375  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.025630950927734375  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

torch.Size([38613, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.025630950927734375  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

m.shape torch.Size([563, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.0919489860534668  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.0919489860534668  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 563, 128]), torch.Size([1, 563, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.09248590469360352  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.09682655334472656  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 563, 128])
m.shape torch.Size([625, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.09715414047241211  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.09715414047241211  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 625, 128]), torch.Size([1, 625, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.09775018692016602  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.10669088363647461  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 625, 128])
m.shape torch.Size([576, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.10721683502197266  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.10721683502197266  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 576, 128]), torch.Size([1, 576, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.10776615142822266  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1200723648071289  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 576, 128])
m.shape torch.Size([509, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.12076854705810547  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.12076854705810547  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 509, 128]), torch.Size([1, 509, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.12125396728515625  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1353311538696289  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 509, 128])
m.shape torch.Size([519, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.13632583618164062  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.13632583618164062  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 519, 128]), torch.Size([1, 519, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.13682079315185547  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1562800407409668  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 519, 128])
m.shape torch.Size([487, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1574258804321289  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1574258804321289  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 487, 128]), torch.Size([1, 487, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.15789031982421875  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.17786121368408203  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 487, 128])
m.shape torch.Size([442, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.17910432815551758  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.17910432815551758  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 442, 128]), torch.Size([1, 442, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.17952585220336914  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.20060205459594727  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 442, 128])
m.shape torch.Size([448, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.20210027694702148  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.20210027694702148  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 448, 128]), torch.Size([1, 448, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.20252752304077148  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.22688055038452148  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 448, 128])
m.shape torch.Size([433, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.22852516174316406  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.22852516174316406  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 433, 128]), torch.Size([1, 433, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.22893810272216797  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.25536632537841797  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 433, 128])
m.shape torch.Size([11264, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.308870792388916  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.308870792388916  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 5632, 128]), torch.Size([1, 5632, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.31485939025878906  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.7015781402587891  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst 0 shape torch.Size([1, 5632, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.7015781402587891  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.7015781402587891  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 5632, 128]), torch.Size([1, 5632, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.7069492340087891  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.090982437133789  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst 1 shape torch.Size([1, 5632, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0296449661254883  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0447759628295898  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0599069595336914  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0446577072143555  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

torch.Size([15866, 256])
first layer input nodes number: 38613
first layer output nodes number: 15866
edges number: 134309
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.060196876525879  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0753278732299805  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0791106224060059  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0791106224060059  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

m.shape torch.Size([349, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.109093189239502  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.109093189239502  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 349, 256]), torch.Size([1, 349, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1097588539123535  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1164612770080566  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 349, 256])
m.shape torch.Size([278, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1166629791259766  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1166629791259766  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1171932220458984  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1275787353515625  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([222, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1279540061950684  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1279540061950684  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1283774375915527  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.137692928314209  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([172, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1381425857543945  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1381425857543945  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1384706497192383  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.147984504699707  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([157, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1485753059387207  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1485753059387207  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1488747596740723  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1596550941467285  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([128, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1602435111999512  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1602435111999512  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1604876518249512  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1709856986999512  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([84, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.17142915725708  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.17142915725708  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1715893745422363  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1796002388000488  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([77, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.180112361907959  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.180112361907959  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1802592277526855  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1886305809020996  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([75, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1892061233520508  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1892061233520508  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1893491744995117  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1985044479370117  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([76, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1991634368896484  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1991634368896484  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1993083953857422  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2096004486083984  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([63, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2101941108703613  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2101941108703613  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2103142738342285  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2196869850158691  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([57, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2202844619750977  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2202844619750977  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.220393180847168  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2296342849731445  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2301549911499023  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2301549911499023  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2302427291870117  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2383146286010742  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([33, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2387151718139648  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2387151718139648  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2387781143188477  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.245009422302246  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2455406188964844  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2455406188964844  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.245615005493164  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.253499984741211  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2540626525878906  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2540626525878906  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2541370391845703  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.262542724609375  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([45, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2632408142089844  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2632408142089844  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.263326644897461  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2736263275146484  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([39, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2742581367492676  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2742581367492676  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2743325233459473  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2837796211242676  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2841811180114746  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2841811180114746  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.284226894378662  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.290360927581787  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([37, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2910494804382324  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2910494804382324  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2911200523376465  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3010706901550293  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3015403747558594  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3015403747558594  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3015880584716797  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.308645248413086  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.308980941772461  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.308980941772461  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3090133666992188  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3140392303466797  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.314509391784668  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.314509391784668  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3145513534545898  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3213491439819336  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3218588829040527  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3218588829040527  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3219027519226074  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3293166160583496  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([631, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.344456672668457  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.344456672668457  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 631, 256]), torch.Size([1, 631, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3456602096557617  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.5590095520019531  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 631, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.5316715240478516  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.5320825576782227  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.5324935913085938  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.5320615768432617  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

torch.Size([2758, 40])
input nodes number: 15866
output nodes number: 2758
edges number: 30492
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.5321969985961914  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.5321974754333496  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.02775859832763672  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

pseudo mini batch 29 input nodes size: 43617
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.024397850036621094  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.024397850036621094  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.045882225036621094  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.04590320587158203  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.027470111846923828  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.028716564178466797  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.028716564178466797  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.028716564178466797  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

torch.Size([43617, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.028716564178466797  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

m.shape torch.Size([647, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.09671735763549805  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.09671735763549805  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 647, 128]), torch.Size([1, 647, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.09733438491821289  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.10227060317993164  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 647, 128])
m.shape torch.Size([654, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1025857925415039  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1025857925415039  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 654, 128]), torch.Size([1, 654, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1032094955444336  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1130971908569336  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 654, 128])
m.shape torch.Size([642, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.11370372772216797  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.11370372772216797  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 642, 128]), torch.Size([1, 642, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.11431598663330078  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.12848377227783203  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 642, 128])
m.shape torch.Size([579, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.12928199768066406  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.12928199768066406  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 579, 128]), torch.Size([1, 579, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.12983417510986328  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.14652252197265625  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 579, 128])
m.shape torch.Size([573, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1476125717163086  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1476125717163086  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 573, 128]), torch.Size([1, 573, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.14815902709960938  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.16831350326538086  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 573, 128])
m.shape torch.Size([526, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1699228286743164  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1699228286743164  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 526, 128]), torch.Size([1, 526, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1704244613647461  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.19267749786376953  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 526, 128])
m.shape torch.Size([476, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1940155029296875  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1940155029296875  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 476, 128]), torch.Size([1, 476, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.19446945190429688  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.21716690063476562  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 476, 128])
m.shape torch.Size([460, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.21869468688964844  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.21869468688964844  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 460, 128]), torch.Size([1, 460, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.2191333770751953  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.2441387176513672  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 460, 128])
m.shape torch.Size([457, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.2458806037902832  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.2458806037902832  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 457, 128]), torch.Size([1, 457, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.24631643295288086  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.27420949935913086  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 457, 128])
m.shape torch.Size([11514, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.32889461517333984  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.32889461517333984  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 5757, 128]), torch.Size([1, 5757, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.3343849182128906  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.7261872291564941  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst 0 shape torch.Size([1, 5757, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.7261872291564941  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.7261872291564941  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 5757, 128]), torch.Size([1, 5757, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.7319927215576172  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1230568885803223  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst 1 shape torch.Size([1, 5757, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0631804466247559  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0789427757263184  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0947051048278809  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0788192749023438  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

torch.Size([16528, 256])
first layer input nodes number: 43617
first layer output nodes number: 16528
edges number: 138483
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.0950322151184082  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1107945442199707  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1147351264953613  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1147351264953613  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

m.shape torch.Size([377, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1428332328796387  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1428332328796387  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 377, 256]), torch.Size([1, 377, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.143552303314209  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1494193077087402  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 377, 256])
m.shape torch.Size([283, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1496038436889648  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1496038436889648  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 283, 256]), torch.Size([1, 283, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1501436233520508  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.161181926727295  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 283, 256])
m.shape torch.Size([233, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1615839004516602  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1615839004516602  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1620283126831055  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1718053817749023  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([169, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1722331047058105  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1722331047058105  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1725554466247559  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.18190336227417  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([156, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1824922561645508  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1824922561645508  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1827898025512695  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1935014724731445  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([128, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1940908432006836  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1940908432006836  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.1943349838256836  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2048330307006836  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([116, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.205491542816162  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.205491542816162  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2057127952575684  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2167754173278809  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([77, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.217257022857666  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.217257022857666  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2174038887023926  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2257752418518066  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([97, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2265410423278809  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2265410423278809  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2267260551452637  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2385668754577637  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([72, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2391667366027832  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2391667366027832  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2393040657043457  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2490544319152832  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([57, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2495884895324707  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2495884895324707  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.249697208404541  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2581772804260254  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([51, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.258711338043213  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.258711338043213  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2588086128234863  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2670769691467285  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2676033973693848  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2676033973693848  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2676911354064941  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2757630348205566  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2762846946716309  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2762846946716309  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.276364803314209  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2842955589294434  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([46, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2849187850952148  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2849187850952148  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2850065231323242  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.294306755065918  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2948627471923828  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2948627471923828  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2949371337890625  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3033428192138672  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3038287162780762  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3038287162780762  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3038897514343262  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3112139701843262  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([38, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3118410110473633  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3118410110473633  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3119134902954102  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3211183547973633  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([37, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3217577934265137  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3217577934265137  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3218283653259277  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.331284999847412  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3318076133728027  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3318076133728027  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3318629264831543  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3396620750427246  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3401594161987305  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3401594161987305  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3402090072631836  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.347548484802246  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3479890823364258  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3479890823364258  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3480310440063477  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3545351028442383  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3550667762756348  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3550667762756348  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.355114459991455  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3628392219543457  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3630695343017578  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3630695343017578  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3630905151367188  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3666362762451172  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([549, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3798174858093262  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3798174858093262  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 549, 256]), torch.Size([1, 549, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3808646202087402  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.574094295501709  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 549, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.5493922233581543  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.5498032569885254  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.5502142906188965  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.5497822761535645  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

torch.Size([2758, 40])
input nodes number: 16528
output nodes number: 2758
edges number: 28731
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.5499267578125  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.5499272346496582  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.03090524673461914  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

pseudo mini batch 30 input nodes size: 49492
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.027470111846923828  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.027470111846923828  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.05106973648071289  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.05109071731567383  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.02958536148071289  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.030960559844970703  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.030960559844970703  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.030960559844970703  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

torch.Size([49492, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.030960559844970703  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

m.shape torch.Size([673, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.10713005065917969  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.10713005065917969  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 673, 128]), torch.Size([1, 673, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1077718734741211  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.11341381072998047  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 673, 128])
m.shape torch.Size([643, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.11370611190795898  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.11370611190795898  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 643, 128]), torch.Size([1, 643, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1143193244934082  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.12384653091430664  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 643, 128])
m.shape torch.Size([659, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.12448263168334961  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.12448263168334961  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 659, 128]), torch.Size([1, 659, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.12511110305786133  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1394963264465332  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 659, 128])
m.shape torch.Size([621, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1403665542602539  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1403665542602539  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 621, 128]), torch.Size([1, 621, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1409587860107422  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1588296890258789  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 621, 128])
m.shape torch.Size([511, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.15975189208984375  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.15975189208984375  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 511, 128]), torch.Size([1, 511, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.16023921966552734  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.17778301239013672  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 511, 128])
m.shape torch.Size([547, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.17910432815551758  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.17910432815551758  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 547, 128]), torch.Size([1, 547, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1796259880065918  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.20266151428222656  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 547, 128])
m.shape torch.Size([550, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.20472955703735352  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.20472955703735352  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 550, 128]), torch.Size([1, 550, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.20525407791137695  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.2316594123840332  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 550, 128])
m.shape torch.Size([527, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.23340749740600586  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.23340749740600586  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 527, 128]), torch.Size([1, 527, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.23391008377075195  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.26332807540893555  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 527, 128])
m.shape torch.Size([529, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.2653470039367676  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.2653470039367676  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 529, 128]), torch.Size([1, 529, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.2658514976501465  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.2995901107788086  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 529, 128])
m.shape torch.Size([13011, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.36137914657592773  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.36137914657592773  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 6505, 128]), torch.Size([1, 6505, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.3675827980041504  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.816556453704834  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst 0 shape torch.Size([1, 6505, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.816556453704834  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.816556453704834  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 6506, 128]), torch.Size([1, 6506, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.8236808776855469  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2697033882141113  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst 1 shape torch.Size([1, 6506, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2014613151550293  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.218885898590088  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2363104820251465  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2187495231628418  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

torch.Size([18271, 256])
first layer input nodes number: 49492
first layer output nodes number: 18271
edges number: 155194
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2366814613342285  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.254106044769287  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2584624290466309  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2584624290466309  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

m.shape torch.Size([387, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.287041187286377  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.287041187286377  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 387, 256]), torch.Size([1, 387, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2877793312072754  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2953224182128906  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 387, 256])
m.shape torch.Size([303, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2955360412597656  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2955360412597656  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.2961139678955078  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3058929443359375  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([233, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3062758445739746  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3062758445739746  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.30672025680542  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3164973258972168  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([189, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3170018196105957  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3170018196105957  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3173623085021973  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3278164863586426  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([139, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3283042907714844  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3283042907714844  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3285694122314453  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.338113784790039  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([115, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3386445045471191  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3386445045471191  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3388638496398926  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3482956886291504  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([94, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3488187789916992  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3488187789916992  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3489980697631836  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3579626083374023  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([71, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3584189414978027  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3584189414978027  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3585543632507324  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3662734031677246  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([71, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3668198585510254  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3668198585510254  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.366955280303955  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.375622272491455  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([73, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3762564659118652  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3762564659118652  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3763957023620605  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3862814903259277  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([54, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3867831230163574  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3867831230163574  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3868861198425293  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3949198722839355  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([58, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3955373764038086  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3955373764038086  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.3956480026245117  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4050512313842773  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([47, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.405583381652832  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.405583381652832  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4056730270385742  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4139204025268555  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4144678115844727  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4144678115844727  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4145517349243164  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4228601455688477  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4233808517456055  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4233808517456055  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4234552383422852  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.431340217590332  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4317951202392578  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4317951202392578  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4318561553955078  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4387531280517578  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4391474723815918  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4391474723815918  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.439197063446045  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.44514799118042  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4456944465637207  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4456944465637207  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4457573890686035  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4537510871887207  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4541945457458496  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4541945457458496  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4542441368103027  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4608893394470215  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([40, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4616336822509766  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4616336822509766  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.461709976196289  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4724674224853516  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.473055362701416  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.473055362701416  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4731144905090332  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.481865406036377  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4823222160339355  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4823222160339355  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4823660850524902  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4891657829284668  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.489586353302002  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.489586353302002  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4896245002746582  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.4958043098449707  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.496269702911377  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.496269702911377  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.496309757232666  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.5030789375305176  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([589, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.5172119140625  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.5172119140625  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 589, 256]), torch.Size([1, 589, 256])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.5183353424072266  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.7223401069641113  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 589, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.6964731216430664  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.6968841552734375  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.6972951889038086  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.6968631744384766  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

torch.Size([2758, 40])
input nodes number: 18271
output nodes number: 2758
edges number: 29218
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.6970205307006836  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.6970210075378418  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.03336381912231445  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

pseudo mini batch 31 input nodes size: 42865
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.02958536148071289  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.02958536148071289  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.050024986267089844  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.05004692077636719  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.026426315307617188  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.02791881561279297  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.02791881561279297  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.02791881561279297  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

torch.Size([42865, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.02791881561279297  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

m.shape torch.Size([431, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.10692501068115234  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.10692501068115234  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 431, 128]), torch.Size([1, 431, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.10733604431152344  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.11062431335449219  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 431, 128])
m.shape torch.Size([461, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.11085844039916992  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.11085844039916992  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 461, 128]), torch.Size([1, 461, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1112980842590332  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.11789274215698242  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 461, 128])
m.shape torch.Size([456, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.11832523345947266  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.11832523345947266  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 456, 128]), torch.Size([1, 456, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1187601089477539  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1283273696899414  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 456, 128])
m.shape torch.Size([480, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.12902545928955078  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.12902545928955078  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 480, 128]), torch.Size([1, 480, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.12948322296142578  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.14275836944580078  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 480, 128])
m.shape torch.Size([432, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.14357423782348633  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.14357423782348633  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 432, 128]), torch.Size([1, 432, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.14398622512817383  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.15881776809692383  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 432, 128])
m.shape torch.Size([491, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.16001653671264648  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.16001653671264648  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 491, 128]), torch.Size([1, 491, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.16048479080200195  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1806197166442871  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 491, 128])
m.shape torch.Size([509, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1820845603942871  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1820845603942871  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 509, 128]), torch.Size([1, 509, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.1825699806213379  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.20684099197387695  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 509, 128])
m.shape torch.Size([456, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.20833778381347656  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.20833778381347656  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 456, 128]), torch.Size([1, 456, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.2087726593017578  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.23356056213378906  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 456, 128])
m.shape torch.Size([491, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.23545026779174805  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.23545026779174805  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 491, 128]), torch.Size([1, 491, 128])
----------------------------------------3
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.23591852188110352  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.2658867835998535  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 491, 128])
m.shape torch.Size([13992, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.33237171173095703  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.33237171173095703  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 6996, 128]), torch.Size([1, 6996, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.33904361724853516  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.8156156539916992  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst 0 shape torch.Size([1, 6996, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.8156156539916992  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.8156156539916992  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 6996, 128]), torch.Size([1, 6996, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.8222875595092773  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2933988571166992  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst 1 shape torch.Size([1, 6996, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2213969230651855  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.238752841949463  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2561087608337402  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.238616943359375  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

torch.Size([18199, 256])
first layer input nodes number: 42865
first layer output nodes number: 18199
edges number: 161297
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2564301490783691  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2737860679626465  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.278125286102295  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.278125286102295  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

m.shape torch.Size([269, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3158602714538574  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3158602714538574  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.316373348236084  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.321268081665039  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([205, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3214058876037598  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3214058876037598  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3217968940734863  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3276619911193848  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([152, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3279051780700684  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3279051780700684  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3281950950622559  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3345732688903809  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([146, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3349900245666504  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3349900245666504  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.335268497467041  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3433442115783691  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([112, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3437433242797852  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3437433242797852  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3439569473266602  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3516473770141602  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([117, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.35221529006958  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.35221529006958  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3524384498596191  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3620343208312988  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([100, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.362595558166504  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.362595558166504  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3627862930297852  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3723230361938477  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([70, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3727660179138184  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3727660179138184  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3728995323181152  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.380509853363037  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([84, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3811697959899902  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3811697959899902  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3813300132751465  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3915839195251465  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([84, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3923115730285645  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3923115730285645  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3924717903137207  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4038472175598145  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([74, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4045495986938477  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4045495986938477  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4046907424926758  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4156999588012695  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([87, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.417069911956787  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.417069911956787  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4172358512878418  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4313406944274902  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([71, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.432145118713379  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.432145118713379  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4322805404663086  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4447393417358398  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([61, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4454927444458008  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4454927444458008  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4456090927124023  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.457127571105957  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([50, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4577903747558594  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4577903747558594  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4578857421875  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4679946899414062  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([44, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4686236381530762  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4686236381530762  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.46870756149292  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4781908988952637  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([44, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.478868007659912  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.478868007659912  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4789519309997559  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4890227317810059  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([45, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4897594451904297  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4897594451904297  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4898452758789062  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.5007457733154297  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([57, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.5021796226501465  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.5021796226501465  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.5022883415222168  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.5168566703796387  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([33, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.5174369812011719  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.5174369812011719  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.5174999237060547  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.5263748168945312  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([48, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.5273122787475586  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.5273122787475586  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.5274038314819336  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.5409536361694336  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([37, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.5416903495788574  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.5416903495788574  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.5417609214782715  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.5526995658874512  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.5532169342041016  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.5532169342041016  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.5532646179199219  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.5609893798828125  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([40, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.5618882179260254  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.5618882179260254  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.561964511871338  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.5748581886291504  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([851, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.5952682495117188  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.5952682495117188  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

 h.shape torch.Size([1, 851, 256]), torch.Size([1, 851, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.5968914031982422  GigaBytes
Max Memory Allocated: 1.7857375144958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.8844118118286133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 851, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.8493223190307617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.8497557640075684  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes
[04:47:33] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28846524 edges into 32 parts and get 9174394 edge cuts

----------------------------------------after rst
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.850189208984375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.849733829498291  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2906, 40])
input nodes number: 18199
output nodes number: 2906
edges number: 38859
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.8499140739440918  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.84991455078125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.03048419952392578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.036034584045410156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.036034584045410156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008752033114433289 |0.012314625084400177 |0.133622407913208 |9.308755397796631e-05 |0.09676259756088257 |0.005838632583618164 |
----------------------------------------------------------pseudo_mini_loss sum 5.335347652435303
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1144565
Number of first layer input nodes during this epoch:  821548
Number of first layer output nodes during this epoch:  323017
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.03603410720825195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.024286508560180664
global_2_local spend time (sec) 0.04419589042663574
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.003972530364990234
A = g.adjacency_matrix() spent  0.011455535888671875
auxiliary_graph
Graph(num_nodes=154728, num_edges=28937465,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08053755760192871
remove nodes length
63787
auxiliary_graph.remove_nodes spent  1.3678536415100098
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28937465,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.2106938362121582

the counter of shared neighbor distribution
Counter({1.0: 23292734, 2.0: 4025850, 3.0: 1012928, 4.0: 306592, 5.0: 111950, 6.0: 47874, 7.0: 22518, 8.0: 11474, 9.0: 6096, 10.0: 3464, 11.0: 1990, 12.0: 1176, 13.0: 670, 14.0: 384, 15.0: 282, 16.0: 210, 17.0: 182, 18.0: 86, 19.0: 48, 21.0: 8, 20.0: 8})
28846524
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28846521, 28846522, 28846523])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23292734, 2.0: 4025850, 3.0: 1012928, 4.0: 306592, 5.0: 111950, 6.0: 47874, 7.0: 22518, 8.0: 11474, 9.0: 6096, 10.0: 3464, 11.0: 1990, 12.0: 1176, 13.0: 670, 14.0: 384, 15.0: 282, 16.0: 210, 17.0: 182, 18.0: 86, 19.0: 48, 21.0: 8, 20.0: 8})
Convert a graph into a bidirected graph: 1.283 seconds
Metis partitioning: 5.620 seconds
Split the graph: 0.590 seconds
Construct subgraphs: 0.079 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  7.584981203079224
2758
2847
2778
2758
2780
2905
2826
2758
2924
2788
2871
2921
2770
2758
2788
2758
2904
2913
2760
2871
2799
2883
2758
2813
2897
2916
2924
2877
2927
2927
2898
2886
total k batches seeds list generation spend  17.572665452957153
after graph partition
graph partition algorithm spend time 17.66868233680725
2758
2847
2778
2758
2780
2905
2826
2758
2924
2788
2871
2921
2770
2758
2788
2758
2904
2913
2760
2871
2799
2883
2758
2813
2897
2916
2924
2877
2927
2927
2898
2886
partition_len_list
[16486, 16826, 18061, 17780, 16948, 19199, 13734, 13969, 7054, 7496, 8446, 6672, 12880, 9522, 10316, 14817, 6721, 5905, 5990, 5563, 7106, 7665, 6772, 7858, 5166, 5675, 6148, 6780, 7504, 8835, 7733, 6524]
shared_neighbor_graph_partition_s0 selection method  spend 17.77133846282959
time for parepare:  0.018398761749267578
local_output_nid generation:  0.0008728504180908203
local_in_edges_tensor generation:  0.001051187515258789
mini_batch_src_global generation:  0.0014908313751220703
r_  generation:  0.00869131088256836
local_output_nid generation:  0.0009315013885498047
local_in_edges_tensor generation:  0.0009808540344238281
mini_batch_src_global generation:  0.0018069744110107422
r_  generation:  0.014120817184448242
local_output_nid generation:  0.0009214878082275391
local_in_edges_tensor generation:  0.0008642673492431641
mini_batch_src_global generation:  0.0012819766998291016
r_  generation:  0.009217977523803711
local_output_nid generation:  0.0009503364562988281
local_in_edges_tensor generation:  0.0008363723754882812
mini_batch_src_global generation:  0.0012025833129882812
r_  generation:  0.013055801391601562
local_output_nid generation:  0.0010197162628173828
local_in_edges_tensor generation:  0.0008111000061035156
mini_batch_src_global generation:  0.0011436939239501953
r_  generation:  0.008653879165649414
local_output_nid generation:  0.0010287761688232422
local_in_edges_tensor generation:  0.0008370876312255859
mini_batch_src_global generation:  0.0011754035949707031
r_  generation:  0.013215065002441406
local_output_nid generation:  0.0010581016540527344
local_in_edges_tensor generation:  0.0007801055908203125
mini_batch_src_global generation:  0.001062631607055664
r_  generation:  0.008383035659790039
local_output_nid generation:  0.00102996826171875
local_in_edges_tensor generation:  0.0007710456848144531
mini_batch_src_global generation:  0.0009403228759765625
r_  generation:  0.007563591003417969
local_output_nid generation:  0.001070261001586914
local_in_edges_tensor generation:  0.0007646083831787109
mini_batch_src_global generation:  0.0008046627044677734
r_  generation:  0.0067751407623291016
local_output_nid generation:  0.0010085105895996094
local_in_edges_tensor generation:  0.0007152557373046875
mini_batch_src_global generation:  0.0006806850433349609
r_  generation:  0.0057697296142578125
local_output_nid generation:  0.0010323524475097656
local_in_edges_tensor generation:  0.0007185935974121094
mini_batch_src_global generation:  0.0007300376892089844
r_  generation:  0.006379604339599609
local_output_nid generation:  0.0010213851928710938
local_in_edges_tensor generation:  0.0007185935974121094
mini_batch_src_global generation:  0.0006511211395263672
r_  generation:  0.005850315093994141
local_output_nid generation:  0.0009286403656005859
local_in_edges_tensor generation:  0.0007338523864746094
mini_batch_src_global generation:  0.0008831024169921875
r_  generation:  0.007625102996826172
local_output_nid generation:  0.0009400844573974609
local_in_edges_tensor generation:  0.0006878376007080078
mini_batch_src_global generation:  0.0006849765777587891
r_  generation:  0.00548243522644043
local_output_nid generation:  0.0009334087371826172
local_in_edges_tensor generation:  0.000698089599609375
mini_batch_src_global generation:  0.0006759166717529297
r_  generation:  0.006106853485107422
local_output_nid generation:  0.0009088516235351562
local_in_edges_tensor generation:  0.0007617473602294922
mini_batch_src_global generation:  0.0010271072387695312
r_  generation:  0.00986623764038086
local_output_nid generation:  0.0010406970977783203
local_in_edges_tensor generation:  0.0007574558258056641
mini_batch_src_global generation:  0.0009098052978515625
r_  generation:  0.007342338562011719
local_output_nid generation:  0.0010275840759277344
local_in_edges_tensor generation:  0.0007863044738769531
mini_batch_src_global generation:  0.0008342266082763672
r_  generation:  0.007892131805419922
local_output_nid generation:  0.0009419918060302734
local_in_edges_tensor generation:  0.0007240772247314453
mini_batch_src_global generation:  0.0007517337799072266
r_  generation:  0.006582498550415039
local_output_nid generation:  0.0009887218475341797
local_in_edges_tensor generation:  0.0007579326629638672
mini_batch_src_global generation:  0.0007610321044921875
r_  generation:  0.006665945053100586
local_output_nid generation:  0.0009455680847167969
local_in_edges_tensor generation:  0.0007429122924804688
mini_batch_src_global generation:  0.0007903575897216797
r_  generation:  0.0072574615478515625
local_output_nid generation:  0.0010089874267578125
local_in_edges_tensor generation:  0.0007793903350830078
mini_batch_src_global generation:  0.0008563995361328125
r_  generation:  0.007910013198852539
local_output_nid generation:  0.0009274482727050781
local_in_edges_tensor generation:  0.0007250308990478516
mini_batch_src_global generation:  0.0007638931274414062
r_  generation:  0.006826877593994141
local_output_nid generation:  0.0009853839874267578
local_in_edges_tensor generation:  0.0007207393646240234
mini_batch_src_global generation:  0.0007312297821044922
r_  generation:  0.00646519660949707
local_output_nid generation:  0.0009706020355224609
local_in_edges_tensor generation:  0.0007104873657226562
mini_batch_src_global generation:  0.00061798095703125
r_  generation:  0.005540132522583008
local_output_nid generation:  0.0009975433349609375
local_in_edges_tensor generation:  0.0007293224334716797
mini_batch_src_global generation:  0.0006072521209716797
r_  generation:  0.005801677703857422
local_output_nid generation:  0.0009865760803222656
local_in_edges_tensor generation:  0.0007026195526123047
mini_batch_src_global generation:  0.0006914138793945312
r_  generation:  0.006339073181152344
local_output_nid generation:  0.0009417533874511719
local_in_edges_tensor generation:  0.0007126331329345703
mini_batch_src_global generation:  0.00072479248046875
r_  generation:  0.006794452667236328
local_output_nid generation:  0.0009512901306152344
local_in_edges_tensor generation:  0.0007529258728027344
mini_batch_src_global generation:  0.0008752346038818359
r_  generation:  0.007893562316894531
local_output_nid generation:  0.0009696483612060547
local_in_edges_tensor generation:  0.0007185935974121094
mini_batch_src_global generation:  0.0008003711700439453
r_  generation:  0.006903171539306641
local_output_nid generation:  0.0009500980377197266
local_in_edges_tensor generation:  0.0007104873657226562
mini_batch_src_global generation:  0.0007240772247314453
r_  generation:  0.006471157073974609
local_output_nid generation:  0.0009369850158691406
local_in_edges_tensor generation:  0.0007007122039794922
mini_batch_src_global generation:  0.0007367134094238281
r_  generation:  0.007098197937011719
----------------------check_connections_block total spend ----------------------------- 0.4222109317779541
generate_one_block  0.02364969253540039
generate_one_block  0.018610715866088867
generate_one_block  0.016104459762573242
generate_one_block  0.0166165828704834
generate_one_block  0.014597177505493164
generate_one_block  0.01685023307800293
generate_one_block  0.012984991073608398
generate_one_block  0.011922121047973633
generate_one_block  0.009180068969726562
generate_one_block  0.008151769638061523
generate_one_block  0.00934743881225586
generate_one_block  0.007824420928955078
generate_one_block  0.012844085693359375
generate_one_block  0.011043787002563477
generate_one_block  0.009384632110595703
generate_one_block  0.014670133590698242
generate_one_block  0.01486968994140625
generate_one_block  0.011063575744628906
generate_one_block  0.009188652038574219
generate_one_block  0.009106159210205078
generate_one_block  0.010473966598510742
generate_one_block  0.01761794090270996
generate_one_block  0.009709835052490234
generate_one_block  0.009171485900878906
generate_one_block  0.007485866546630859
generate_one_block  0.007727146148681641
generate_one_block  0.008612871170043945
generate_one_block  0.009844303131103516
generate_one_block  0.01121211051940918
generate_one_block  0.009909391403198242
generate_one_block  0.009075641632080078
generate_one_block  0.00951075553894043
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04011130332946777
gen group dst list time:  0.009646177291870117
time for parepare:  0.022913217544555664
local_output_nid generation:  0.0036978721618652344
local_in_edges_tensor generation:  0.007016897201538086
mini_batch_src_global generation:  0.004775524139404297
r_  generation:  0.046356916427612305
local_output_nid generation:  0.0057430267333984375
local_in_edges_tensor generation:  0.0057811737060546875
mini_batch_src_global generation:  0.007063865661621094
r_  generation:  0.04910540580749512
local_output_nid generation:  0.006216526031494141
local_in_edges_tensor generation:  0.005339384078979492
mini_batch_src_global generation:  0.006982326507568359
r_  generation:  0.05411839485168457
local_output_nid generation:  0.010105371475219727
local_in_edges_tensor generation:  0.00791788101196289
mini_batch_src_global generation:  0.006338596343994141
r_  generation:  0.052712202072143555
local_output_nid generation:  0.005961179733276367
local_in_edges_tensor generation:  0.004220008850097656
mini_batch_src_global generation:  0.008628606796264648
r_  generation:  0.050377845764160156
local_output_nid generation:  0.0064809322357177734
local_in_edges_tensor generation:  0.005624055862426758
mini_batch_src_global generation:  0.0067751407623291016
r_  generation:  0.06157875061035156
local_output_nid generation:  0.007390737533569336
local_in_edges_tensor generation:  0.0036690235137939453
mini_batch_src_global generation:  0.00429224967956543
r_  generation:  0.03930950164794922
local_output_nid generation:  0.005281209945678711
local_in_edges_tensor generation:  0.003900766372680664
mini_batch_src_global generation:  0.003939151763916016
r_  generation:  0.03855299949645996
local_output_nid generation:  0.0028171539306640625
local_in_edges_tensor generation:  0.0018270015716552734
mini_batch_src_global generation:  0.0019638538360595703
r_  generation:  0.016190052032470703
local_output_nid generation:  0.002928018569946289
local_in_edges_tensor generation:  0.0020437240600585938
mini_batch_src_global generation:  0.001390218734741211
r_  generation:  0.016843080520629883
local_output_nid generation:  0.0030808448791503906
local_in_edges_tensor generation:  0.002229452133178711
mini_batch_src_global generation:  0.0015993118286132812
r_  generation:  0.02025890350341797
local_output_nid generation:  0.002379179000854492
local_in_edges_tensor generation:  0.0015950202941894531
mini_batch_src_global generation:  0.0012826919555664062
r_  generation:  0.0142669677734375
local_output_nid generation:  0.004255533218383789
local_in_edges_tensor generation:  0.0030221939086914062
mini_batch_src_global generation:  0.002540111541748047
r_  generation:  0.03409123420715332
local_output_nid generation:  0.003422975540161133
local_in_edges_tensor generation:  0.0023348331451416016
mini_batch_src_global generation:  0.002515077590942383
r_  generation:  0.023471593856811523
local_output_nid generation:  0.003610849380493164
local_in_edges_tensor generation:  0.0026526451110839844
mini_batch_src_global generation:  0.0021097660064697266
r_  generation:  0.026160478591918945
local_output_nid generation:  0.005079507827758789
local_in_edges_tensor generation:  0.0034067630767822266
mini_batch_src_global generation:  0.0038344860076904297
r_  generation:  0.04165768623352051
local_output_nid generation:  0.0027039051055908203
local_in_edges_tensor generation:  0.0017762184143066406
mini_batch_src_global generation:  0.002078533172607422
r_  generation:  0.016416549682617188
local_output_nid generation:  0.0022504329681396484
local_in_edges_tensor generation:  0.001424551010131836
mini_batch_src_global generation:  0.0012753009796142578
r_  generation:  0.014369964599609375
local_output_nid generation:  0.0021598339080810547
local_in_edges_tensor generation:  0.0014073848724365234
mini_batch_src_global generation:  0.0012035369873046875
r_  generation:  0.014026403427124023
local_output_nid generation:  0.002001047134399414
local_in_edges_tensor generation:  0.0012743473052978516
mini_batch_src_global generation:  0.0013206005096435547
r_  generation:  0.010820150375366211
local_output_nid generation:  0.002457857131958008
local_in_edges_tensor generation:  0.0015850067138671875
mini_batch_src_global generation:  0.0013217926025390625
r_  generation:  0.017197132110595703
local_output_nid generation:  0.002488374710083008
local_in_edges_tensor generation:  0.0016636848449707031
mini_batch_src_global generation:  0.0014886856079101562
r_  generation:  0.018213987350463867
local_output_nid generation:  0.002153158187866211
local_in_edges_tensor generation:  0.0014526844024658203
mini_batch_src_global generation:  0.0013442039489746094
r_  generation:  0.015837907791137695
local_output_nid generation:  0.0025310516357421875
local_in_edges_tensor generation:  0.0016312599182128906
mini_batch_src_global generation:  0.0013720989227294922
r_  generation:  0.017548322677612305
local_output_nid generation:  0.001680612564086914
local_in_edges_tensor generation:  0.0011184215545654297
mini_batch_src_global generation:  0.0010986328125
r_  generation:  0.008771896362304688
local_output_nid generation:  0.0019490718841552734
local_in_edges_tensor generation:  0.0012562274932861328
mini_batch_src_global generation:  0.0010859966278076172
r_  generation:  0.010177373886108398
local_output_nid generation:  0.002018451690673828
local_in_edges_tensor generation:  0.0013432502746582031
mini_batch_src_global generation:  0.0010466575622558594
r_  generation:  0.013020038604736328
local_output_nid generation:  0.0021326541900634766
local_in_edges_tensor generation:  0.0014262199401855469
mini_batch_src_global generation:  0.0010654926300048828
r_  generation:  0.015084505081176758
local_output_nid generation:  0.002496004104614258
local_in_edges_tensor generation:  0.0016672611236572266
mini_batch_src_global generation:  0.0014858245849609375
r_  generation:  0.018204212188720703
local_output_nid generation:  0.002761363983154297
local_in_edges_tensor generation:  0.001909494400024414
mini_batch_src_global generation:  0.0016756057739257812
r_  generation:  0.02155327796936035
local_output_nid generation:  0.0024788379669189453
local_in_edges_tensor generation:  0.001886606216430664
mini_batch_src_global generation:  0.0062596797943115234
r_  generation:  0.01657891273498535
local_output_nid generation:  0.0020780563354492188
local_in_edges_tensor generation:  0.0014562606811523438
mini_batch_src_global generation:  0.001220703125
r_  generation:  0.014414548873901367
----------------------check_connections_block total spend ----------------------------- 1.3370318412780762
generate_one_block  0.06639266014099121
generate_one_block  0.07770228385925293
generate_one_block  0.07225990295410156
generate_one_block  0.07050848007202148
generate_one_block  0.07351899147033691
generate_one_block  0.08134055137634277
generate_one_block  0.05020570755004883
generate_one_block  0.051912784576416016
generate_one_block  0.02098560333251953
generate_one_block  0.022231578826904297
generate_one_block  0.02585887908935547
generate_one_block  0.019221067428588867
generate_one_block  0.047855377197265625
generate_one_block  0.03202509880065918
generate_one_block  0.03574347496032715
generate_one_block  0.05892062187194824
generate_one_block  0.021678924560546875
generate_one_block  0.01899099349975586
generate_one_block  0.018415212631225586
generate_one_block  0.015821218490600586
generate_one_block  0.021320819854736328
generate_one_block  0.024916410446166992
generate_one_block  0.022445201873779297
generate_one_block  0.023038148880004883
generate_one_block  0.012733936309814453
generate_one_block  0.014100313186645508
generate_one_block  0.015377283096313477
generate_one_block  0.020906448364257812
generate_one_block  0.025282859802246094
generate_one_block  0.02949237823486328
generate_one_block  0.022294282913208008
generate_one_block  0.018949270248413086
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.03603410720825195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

connection checking time:  1.7592427730560303
block generation total time  1.5108084678649902
average batch blocks generation time:  0.047212764620780945
block dataloader generation time/epoch 21.344977855682373
pseudo mini batch 0 input nodes size: 44444
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.0319981575012207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.0319981575012207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.0534825325012207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.05350351333618164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.033041954040527344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.034295082092285156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.034295082092285156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.034295082092285156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([44444, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.034295082092285156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([565, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.10263633728027344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.10263633728027344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 565, 128]), torch.Size([1, 565, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.10317516326904297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.10835552215576172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 565, 128])
m.shape torch.Size([624, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.10868120193481445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.10868120193481445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 624, 128]), torch.Size([1, 624, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.10927629470825195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.11820268630981445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 624, 128])
m.shape torch.Size([600, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.11876344680786133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.11876344680786133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 600, 128]), torch.Size([1, 600, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.11933565139770508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.13205766677856445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 600, 128])
m.shape torch.Size([540, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.13280153274536133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.13280153274536133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 540, 128]), torch.Size([1, 540, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.1333165168762207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.14886903762817383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 540, 128])
m.shape torch.Size([552, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.15003061294555664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.15003061294555664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 552, 128]), torch.Size([1, 552, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.1505570411682129  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.1696457862854004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 552, 128])
m.shape torch.Size([563, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.17099332809448242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.17099332809448242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 563, 128]), torch.Size([1, 563, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.17153024673461914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.1951451301574707  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 563, 128])
m.shape torch.Size([528, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.1966390609741211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.1966390609741211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 528, 128]), torch.Size([1, 528, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.1971426010131836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.22353076934814453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 528, 128])
m.shape torch.Size([499, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.22518253326416016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.22518253326416016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 499, 128]), torch.Size([1, 499, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.22565841674804688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.25278377532958984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 499, 128])
m.shape torch.Size([473, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.2545757293701172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.2545757293701172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 473, 128]), torch.Size([1, 473, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.25502681732177734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.28389644622802734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 473, 128])
m.shape torch.Size([11542, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.33870744705200195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.33870744705200195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 5771, 128]), torch.Size([1, 5771, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.3442111015319824  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.7360444068908691  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 5771, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.7360444068908691  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.7360444068908691  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 5771, 128]), torch.Size([1, 5771, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.741816520690918  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1336631774902344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 5771, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.0733723640441895  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.089094638824463  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1048169136047363  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.0889716148376465  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([16486, 256])
first layer input nodes number: 44444
first layer output nodes number: 16486
edges number: 139276
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1051502227783203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1208724975585938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1254029273986816  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1254029273986816  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([340, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1535043716430664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1535043716430664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 340, 256]), torch.Size([1, 340, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1541528701782227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1597185134887695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 340, 256])
m.shape torch.Size([297, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1599655151367188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1599655151367188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.160531997680664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1711630821228027  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([226, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1715316772460938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1715316772460938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1719627380371094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1814460754394531  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([169, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1818804740905762  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1818804740905762  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1822028160095215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1915507316589355  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([155, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1921348571777344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1921348571777344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1924304962158203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.203073501586914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([125, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2036466598510742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2036466598510742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2038850784301758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.214137077331543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([104, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2147178649902344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2147178649902344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2149162292480469  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2248344421386719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([79, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2253427505493164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2253427505493164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2254934310913086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2340822219848633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([89, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2347769737243652  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2347769737243652  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2349467277526855  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2458109855651855  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([82, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2465143203735352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2465143203735352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2466707229614258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2577753067016602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([73, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2584691047668457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2584691047668457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.258608341217041  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2694687843322754  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([76, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2702760696411133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2702760696411133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.270421028137207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2827425003051758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([62, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.283444881439209  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.283444881439209  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2835631370544434  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2944426536560059  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([48, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.295029640197754  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.295029640197754  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.295121192932129  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.304184913635254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([46, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.304802417755127  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.304802417755127  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3048901557922363  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.31419038772583  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([43, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3148078918457031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3148078918457031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.314889907836914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.32415771484375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([39, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.324754238128662  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.324754238128662  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3248286247253418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3337550163269043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([41, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3344273567199707  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3344273567199707  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.334505558013916  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3444371223449707  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([37, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3450736999511719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3450736999511719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.345144271850586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3546009063720703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.355027198791504  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.355027198791504  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3550729751586914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.361527442932129  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3620095252990723  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3620095252990723  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3620572090148926  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3691143989562988  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.369661808013916  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.369661808013916  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.369713306427002  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3776955604553223  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([27, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3782668113708496  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3782668113708496  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3783183097839355  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3866610527038574  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3870506286621094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3870506286621094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3870849609375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3928871154785156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([506, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4050283432006836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4050283432006836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 506, 256]), torch.Size([1, 506, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4059934616088867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.5915522575378418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 506, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.5662956237792969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.566706657409668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.567117691040039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.566685676574707  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2758, 40])
input nodes number: 16486
output nodes number: 2758
edges number: 28771
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.5668072700500488  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.5668082237243652  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.03647327423095703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 1 input nodes size: 39016
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.0330204963684082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.0330204963684082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.0525517463684082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.052573204040527344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.031067848205566406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.032459259033203125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.032459259033203125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.032459259033203125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([39016, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.032459259033203125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([417, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.1051182746887207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.1051182746887207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 417, 128]), torch.Size([1, 417, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.10551595687866211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.10869741439819336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 417, 128])
m.shape torch.Size([435, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.10891342163085938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.10891342163085938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 435, 128]), torch.Size([1, 435, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.1093282699584961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.11555099487304688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 435, 128])
m.shape torch.Size([440, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.11597299575805664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.11597299575805664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 440, 128]), torch.Size([1, 440, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.11639261245727539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.1256241798400879  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 440, 128])
m.shape torch.Size([476, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.12632226943969727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.12632226943969727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 476, 128]), torch.Size([1, 476, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.12677621841430664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.13994073867797852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 476, 128])
m.shape torch.Size([465, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.1408224105834961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.1408224105834961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 465, 128]), torch.Size([1, 465, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.141265869140625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.15723037719726562  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 465, 128])
m.shape torch.Size([457, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.15831613540649414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.15831613540649414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 457, 128]), torch.Size([1, 457, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.1587519645690918  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.17749261856079102  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 457, 128])
m.shape torch.Size([438, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.17873668670654297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.17873668670654297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 438, 128]), torch.Size([1, 438, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.1791543960571289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.20003986358642578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 438, 128])
m.shape torch.Size([429, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.20146751403808594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.20146751403808594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 429, 128]), torch.Size([1, 429, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.20187664031982422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.22519683837890625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 429, 128])
m.shape torch.Size([456, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.22694921493530273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.22694921493530273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 456, 128]), torch.Size([1, 456, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.22738409042358398  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.255216121673584  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 456, 128])
m.shape torch.Size([12813, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.31609582901000977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.31609582901000977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 6406, 128]), torch.Size([1, 6406, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.3225064277648926  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.7575640678405762  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 6406, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.7575640678405762  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.7575640678405762  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 6407, 128]), torch.Size([1, 6407, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.763674259185791  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1982426643371582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 6407, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1321697235107422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1482162475585938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1642627716064453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1480908393859863  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([16826, 256])
first layer input nodes number: 39016
first layer output nodes number: 16826
edges number: 148310
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.164555549621582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1806020736694336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1846137046813965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1846137046813965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([257, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2218341827392578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2218341827392578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2223243713378906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.226816177368164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([178, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2269134521484375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2269134521484375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2272529602050781  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2323455810546875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([167, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2326574325561523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2326574325561523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.232975959777832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2399835586547852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([148, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2403936386108398  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2403936386108398  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.240675926208496  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2488622665405273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([125, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2493219375610352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2493219375610352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2495603561401367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.258143424987793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([110, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2586588859558105  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2586588859558105  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.25886869430542  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.267890453338623  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([76, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2682971954345703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2682971954345703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.268442153930664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2756900787353516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([82, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2762484550476074  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2762484550476074  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.276404857635498  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2853198051452637  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([85, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2859768867492676  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2859768867492676  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2861390113830566  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2965149879455566  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([84, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2972416877746582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2972416877746582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2974019050598145  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3087773323059082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3094377517700195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3094377517700195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3095712661743164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3199853897094727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([68, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3207030296325684  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3207030296325684  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3208327293395996  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3318572044372559  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([58, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.332517147064209  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.332517147064209  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.332627773284912  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3428053855895996  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([53, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.34346342086792  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.34346342086792  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.343564510345459  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3535723686218262  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([51, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3542571067810059  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3542571067810059  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3543543815612793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3646655082702637  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([60, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.36553955078125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.36553955078125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3656539916992188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3785858154296875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([52, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.379378318786621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.379378318786621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3794775009155273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3913793563842773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([39, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3920044898986816  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3920044898986816  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3920788764953613  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4015259742736816  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([54, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4026975631713867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4026975631713867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4028005599975586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4166021347045898  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([44, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4173965454101562  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4173965454101562  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.41748046875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4293136596679688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([49, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4304804801940918  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4304804801940918  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4305739402770996  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4444060325622559  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([31, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4450149536132812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4450149536132812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4450740814208984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4542388916015625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([36, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.455005168914795  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.455005168914795  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4550738334655762  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4661974906921387  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([34, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4669475555419922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4669475555419922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4670124053955078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4779720306396484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([836, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4980273246765137  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4980273246765137  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 836, 256]), torch.Size([1, 836, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.499621868133545  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.7925519943237305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 836, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.758007526397705  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.7584319114685059  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.7588562965393066  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.7584104537963867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2847, 40])
input nodes number: 16826
output nodes number: 2847
edges number: 38338
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.758570671081543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.7585711479187012  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.034850120544433594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 2 input nodes size: 48960
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.031081199645996094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.031081199645996094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.054518699645996094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.05453968048095703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.03498697280883789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.0363459587097168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.0363459587097168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.0363459587097168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([48960, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.0363459587097168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([643, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.11127233505249023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.11127233505249023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 643, 128]), torch.Size([1, 643, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.11188554763793945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.1167912483215332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 643, 128])
m.shape torch.Size([665, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.11711883544921875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.11711883544921875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 665, 128]), torch.Size([1, 665, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.1177530288696289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.12764358520507812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 665, 128])
m.shape torch.Size([620, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.12821340560913086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.12821340560913086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 620, 128]), torch.Size([1, 620, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.12880468368530273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.14245939254760742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 620, 128])
m.shape torch.Size([615, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.14333677291870117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.14333677291870117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 615, 128]), torch.Size([1, 615, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.14392328262329102  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.16093206405639648  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 615, 128])
m.shape torch.Size([632, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.16214561462402344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.16214561462402344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 632, 128]), torch.Size([1, 632, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.1627483367919922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.1850147247314453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 632, 128])
m.shape torch.Size([579, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.1863698959350586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.1863698959350586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 579, 128]), torch.Size([1, 579, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.1869220733642578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.2119274139404297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 579, 128])
m.shape torch.Size([581, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.2135906219482422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.2135906219482422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 581, 128]), torch.Size([1, 581, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.21414470672607422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.24289274215698242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 581, 128])
m.shape torch.Size([525, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.24461841583251953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.24461841583251953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 525, 128]), torch.Size([1, 525, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.2451190948486328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.2745389938354492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 525, 128])
m.shape torch.Size([532, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.27657175064086914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.27657175064086914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 532, 128]), torch.Size([1, 532, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.27707910537719727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.31031084060668945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 532, 128])
m.shape torch.Size([12669, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.3704676628112793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.3704676628112793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 6334, 128]), torch.Size([1, 6334, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.3765082359313965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.8059124946594238  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 6334, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.8059124946594238  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.8059124946594238  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 6335, 128]), torch.Size([1, 6335, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.8119540214538574  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2380390167236328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 6335, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1717000007629395  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1889243125915527  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.206148624420166  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1887893676757812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([18061, 256])
first layer input nodes number: 48960
first layer output nodes number: 18061
edges number: 152672
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2065153121948242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2237396240234375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2281694412231445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2281694412231445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([394, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2571964263916016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2571964263916016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 394, 256]), torch.Size([1, 394, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2579479217529297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2661476135253906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 394, 256])
m.shape torch.Size([298, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2663450241088867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2663450241088867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2669134140014648  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.276270866394043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 298, 256])
m.shape torch.Size([205, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2765779495239258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2765779495239258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2769689559936523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2855710983276367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([175, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.286048412322998  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.286048412322998  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2863821983337402  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2960619926452637  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([155, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.296640396118164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.296640396118164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.29693603515625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3075790405273438  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([116, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3081002235412598  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3081002235412598  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.308321475982666  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3178353309631348  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([111, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.318471908569336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.318471908569336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3186836242675781  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3292694091796875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([85, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.329817295074463  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.329817295074463  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.329979419708252  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3392205238342285  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([75, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3397884368896484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3397884368896484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3399314880371094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3490867614746094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([79, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3497748374938965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3497748374938965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3499255180358887  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.360623836517334  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([42, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3609929084777832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3609929084777832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3610730171203613  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.367321491241455  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([55, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3679161071777344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3679161071777344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.368021011352539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3769378662109375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.377535343170166  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.377535343170166  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3776345252990723  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3867592811584473  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3872346878051758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3872346878051758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3873090744018555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3946733474731445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3952274322509766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3952274322509766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3953056335449219  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.403594970703125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4040327072143555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4040327072143555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4040918350219727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4107732772827148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.411332130432129  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.411332130432129  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4114007949829102  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4196405410766602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([37, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4202466011047363  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4202466011047363  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4203171730041504  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4292798042297363  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4297380447387695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4297380447387695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4297895431518555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.436690330505371  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([32, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4372797012329102  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4372797012329102  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4373407363891602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4459466934204102  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4465422630310059  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4465422630310059  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.446601390838623  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4553523063659668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4557456970214844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4557456970214844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4557838439941406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4616966247558594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4619207382202148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4619207382202148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4619417190551758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4653406143188477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.465907096862793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.465907096862793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4659547805786133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.474013328552246  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([606, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4885506629943848  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4885506629943848  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 606, 256]), torch.Size([1, 606, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4897065162658691  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.7015337944030762  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 606, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.6752309799194336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.675645351409912  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.6760597229003906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.6756243705749512  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2778, 40])
input nodes number: 18061
output nodes number: 2778
edges number: 29678
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.6757702827453613  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.6757707595825195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.03871774673461914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 3 input nodes size: 43444
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.034976959228515625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.034976959228515625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.056461334228515625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.05648231506347656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.033023834228515625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.03443145751953125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.03443145751953125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.03443145751953125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([43444, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.03443145751953125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([544, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.11034631729125977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.11034631729125977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 544, 128]), torch.Size([1, 544, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.11086511611938477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.11501550674438477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 544, 128])
m.shape torch.Size([513, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.11524534225463867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.11524534225463867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 513, 128]), torch.Size([1, 513, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.11573457717895508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.1232767105102539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 513, 128])
m.shape torch.Size([521, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.12377738952636719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.12377738952636719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 521, 128]), torch.Size([1, 521, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.12427425384521484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.13606929779052734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 521, 128])
m.shape torch.Size([520, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.13681268692016602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.13681268692016602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 520, 128]), torch.Size([1, 520, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.13730859756469727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.15249300003051758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 520, 128])
m.shape torch.Size([487, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.15340614318847656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.15340614318847656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 487, 128]), torch.Size([1, 487, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.1538705825805664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.17059040069580078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 487, 128])
m.shape torch.Size([508, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.17181158065795898  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.17181158065795898  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 508, 128]), torch.Size([1, 508, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.17229604721069336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.19312810897827148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 508, 128])
m.shape torch.Size([467, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.1944446563720703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.1944446563720703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 467, 128]), torch.Size([1, 467, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.19489002227783203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.21715831756591797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 467, 128])
m.shape torch.Size([439, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.21952199935913086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.21952199935913086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 439, 128]), torch.Size([1, 439, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.2199406623840332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.2438044548034668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 439, 128])
m.shape torch.Size([454, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.2455434799194336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.2455434799194336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 454, 128]), torch.Size([1, 454, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.24597644805908203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.27368640899658203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 454, 128])
m.shape torch.Size([13327, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.3379230499267578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.3379230499267578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 6663, 128]), torch.Size([1, 6663, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.34427738189697266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.805199146270752  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 6663, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.805199146270752  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.805199146270752  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 6664, 128]), torch.Size([1, 6664, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.8120217323303223  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2656545639038086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 6664, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1962103843688965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2131667137145996  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2301230430603027  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2130341529846191  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([17780, 256])
first layer input nodes number: 43444
first layer output nodes number: 17780
edges number: 154833
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2304487228393555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2474050521850586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2516441345214844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2516441345214844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([326, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2855377197265625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2855377197265625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 326, 256]), torch.Size([1, 326, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2861595153808594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2932052612304688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 326, 256])
m.shape torch.Size([237, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2933502197265625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2933502197265625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.293802261352539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3005828857421875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([192, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.300910472869873  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.300910472869873  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.301276683807373  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.309333324432373  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([155, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.309746265411377  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.309746265411377  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.310041904449463  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.318615436553955  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([124, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.319063663482666  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.319063663482666  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3193001747131348  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3278145790100098  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([109, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3283252716064453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3283252716064453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3285331726074219  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.337472915649414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([88, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.337961196899414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.337961196899414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3381290435791016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3465213775634766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([65, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.346937656402588  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.346937656402588  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3470616340637207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.354128360748291  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([74, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3547067642211914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3547067642211914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3548479080200195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3638811111450195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([69, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.364473819732666  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.364473819732666  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.36460542678833  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3739495277404785  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([68, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3746027946472168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3746027946472168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.374732494354248  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3848490715026855  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([55, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3854188919067383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3854188919067383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.385523796081543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3944406509399414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([63, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3951754570007324  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3951754570007324  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3952956199645996  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4063506126403809  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4069099426269531  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4069099426269531  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4069976806640625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4156837463378906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4161300659179688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4161300659179688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4161949157714844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4230690002441406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([41, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4236674308776855  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4236674308776855  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4237456321716309  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4325823783874512  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4331316947937012  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4331316947937012  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4332003593444824  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4414401054382324  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([43, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4421501159667969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4421501159667969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4422321319580078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4526481628417969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4530820846557617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4530820846557617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4531316757202148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4597768783569336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([34, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4604058265686035  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4604058265686035  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4604706764221191  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4696145057678223  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.470167636871338  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.470167636871338  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4702229499816895  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4784092903137207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4787836074829102  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4787836074829102  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4788198471069336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4844369888305664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4849276542663574  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4849276542663574  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.484971523284912  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4920783042907715  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4927945137023926  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4927945137023926  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.4928555488586426  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.5031704902648926  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([770, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.521641731262207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.521641731262207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 770, 256]), torch.Size([1, 770, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.5231103897094727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.7988309860229492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 770, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.7677431106567383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.7681541442871094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.7685651779174805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.7681331634521484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2758, 40])
input nodes number: 17780
output nodes number: 2758
edges number: 33933
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.7682833671569824  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.7682838439941406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.03684234619140625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 4 input nodes size: 47720
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.0330204963684082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.0330204963684082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.0564579963684082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.05647897720336914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.0349736213684082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.0362248420715332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.0362248420715332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.0362248420715332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([47720, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.0362248420715332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([694, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.10529136657714844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.10529136657714844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 694, 128]), torch.Size([1, 694, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.10595321655273438  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.11124801635742188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 694, 128])
m.shape torch.Size([693, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.11157798767089844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.11157798767089844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 693, 128]), torch.Size([1, 693, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.11223888397216797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.12215232849121094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 693, 128])
m.shape torch.Size([653, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.1227560043334961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.1227560043334961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 653, 128]), torch.Size([1, 653, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.12337875366210938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.13757896423339844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 653, 128])
m.shape torch.Size([615, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.13844060897827148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.13844060897827148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 615, 128]), torch.Size([1, 615, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.13902711868286133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.1560359001159668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 615, 128])
m.shape torch.Size([647, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.15728521347045898  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.15728521347045898  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 647, 128]), torch.Size([1, 647, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.15790224075317383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.1812753677368164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 647, 128])
m.shape torch.Size([582, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.1826319694519043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.1826319694519043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 582, 128]), torch.Size([1, 582, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.18318700790405273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.20805883407592773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 582, 128])
m.shape torch.Size([533, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.21035242080688477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.21035242080688477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 533, 128]), torch.Size([1, 533, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.2108607292175293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.23673200607299805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 533, 128])
m.shape torch.Size([560, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.23861408233642578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.23861408233642578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 560, 128]), torch.Size([1, 560, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.23914813995361328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.2706422805786133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 560, 128])
m.shape torch.Size([539, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.2726883888244629  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.2726883888244629  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 539, 128]), torch.Size([1, 539, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.27320241928100586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.3071250915527344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 539, 128])
m.shape torch.Size([11432, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.36138010025024414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.36138010025024414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 5716, 128]), torch.Size([1, 5716, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.36683130264282227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.7565789222717285  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 5716, 128])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.7565789222717285  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.7565789222717285  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 5716, 128]), torch.Size([1, 5716, 128])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.7620301246643066  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.152172565460205  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 5716, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.090303897857666  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1064667701721191  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1226296424865723  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1063404083251953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([16948, 256])
first layer input nodes number: 47720
first layer output nodes number: 16948
edges number: 140608
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1238646507263184  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1400275230407715  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1449456214904785  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1449456214904785  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([419, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.171555995941162  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.171555995941162  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 419, 256]), torch.Size([1, 419, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1723551750183105  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.17885160446167  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 419, 256])
m.shape torch.Size([331, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1790885925292969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1790885925292969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 331, 256]), torch.Size([1, 331, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1797199249267578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.192582130432129  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 331, 256])
m.shape torch.Size([244, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1929702758789062  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1929702758789062  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 244, 256]), torch.Size([1, 244, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.1934356689453125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.20367431640625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 244, 256])
m.shape torch.Size([197, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2041993141174316  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2041993141174316  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2045750617980957  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2154717445373535  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([176, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2161297798156738  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2161297798156738  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2164654731750488  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2285504341125488  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([124, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.229097843170166  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.229097843170166  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2293343544006348  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.239504337310791  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([95, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.240025520324707  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.240025520324707  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2402067184448242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2492666244506836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([90, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.249868392944336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.249868392944336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.250040054321289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2598247528076172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([75, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.260387897491455  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.260387897491455  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.260530948638916  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.269686222076416  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([66, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.270249366760254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.270249366760254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2703752517700195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.279313087463379  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([59, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.279874324798584  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.279874324798584  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.27998685836792  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.288764476776123  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([36, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.28912353515625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.28912353515625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2891921997070312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2950286865234375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([40, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.295494556427002  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.295494556427002  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.2955708503723145  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3025898933410645  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([41, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3031034469604492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3031034469604492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3031816482543945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3109235763549805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3115334510803223  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3115334510803223  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3116192817687988  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3207173347473145  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3211822509765625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3211822509765625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3212451934814453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3283576965332031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3287510871887207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3287510871887207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3288006782531738  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3347516059875488  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3352112770080566  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3352112770080566  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3352646827697754  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3420472145080566  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3424592018127441  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3424592018127441  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3425049781799316  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3486390113830566  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3491740226745605  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3491740226745605  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.349229335784912  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3570284843444824  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.357485294342041  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.357485294342041  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3575310707092285  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3643059730529785  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.36472749710083  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.36472749710083  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3647675514221191  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3709759712219238  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3713760375976562  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3713760375976562  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3714122772216797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3772830963134766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3777494430541992  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3777494430541992  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3777894973754883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3845586776733398  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([517, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3969612121582031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3969612121582031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 517, 256]), torch.Size([1, 517, 256])
----------------------------------------3
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.3979473114013672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.5848217010498047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 517, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.561028003692627  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.5614423751831055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.561856746673584  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.5614213943481445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2780, 40])
input nodes number: 16948
output nodes number: 2780
edges number: 27137
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.5615720748901367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 1.561572551727295  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.03844928741455078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 5 input nodes size: 49937
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.034976959228515625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.034976959228515625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.05878877639770508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.05881071090698242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.035352230072021484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.0368504524230957  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.0368504524230957  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.0368504524230957  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([49937, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.3240966796875 GB
    Memory Allocated: 0.0368504524230957  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([549, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.11915159225463867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.11915159225463867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 549, 128]), torch.Size([1, 549, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1196751594543457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.12439537048339844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 549, 128])
m.shape torch.Size([611, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.12471628189086914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.12471628189086914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 611, 128]), torch.Size([1, 611, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.12529897689819336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.13403940200805664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 611, 128])
m.shape torch.Size([563, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1345534324645996  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1345534324645996  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 563, 128]), torch.Size([1, 563, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.13509035110473633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.14738702774047852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 563, 128])
m.shape torch.Size([558, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.14818286895751953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.14818286895751953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 558, 128]), torch.Size([1, 558, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.14871501922607422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.16414737701416016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 558, 128])
m.shape torch.Size([585, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.16527605056762695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.16527605056762695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 585, 128]), torch.Size([1, 585, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1658339500427246  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.18620014190673828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 585, 128])
m.shape torch.Size([569, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.18754911422729492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.18754911422729492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 569, 128]), torch.Size([1, 569, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.18809175491333008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.2124314308166504  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 569, 128])
m.shape torch.Size([541, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.21396589279174805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.21396589279174805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 541, 128]), torch.Size([1, 541, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.21448183059692383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.2408285140991211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 541, 128])
m.shape torch.Size([554, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.24268388748168945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.24268388748168945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 554, 128]), torch.Size([1, 554, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.24321222305297852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.2733273506164551  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 554, 128])
m.shape torch.Size([589, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.2755908966064453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.2755908966064453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 589, 128]), torch.Size([1, 589, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.2761526107788086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.31240320205688477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 589, 128])
m.shape torch.Size([14080, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3792610168457031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3792610168457031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 7040, 128]), torch.Size([1, 7040, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3859748840332031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8634529113769531  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 7040, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8634529113769531  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8634529113769531  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 7040, 128]), torch.Size([1, 7040, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8701667785644531  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.3439826965332031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 7040, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.2701935768127441  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.2885031700134277  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.3068127632141113  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.2883601188659668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([19199, 256])
first layer input nodes number: 49937
first layer output nodes number: 19199
edges number: 166351
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.3071870803833008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.3254966735839844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.3300743103027344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.3300743103027344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([304, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.364199161529541  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.364199161529541  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.364778995513916  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.369844913482666  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([276, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.3700857162475586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.3700857162475586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.3706121444702148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.3799428939819336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([208, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.380279541015625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.380279541015625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.38067626953125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.389404296875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([154, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.3897981643676758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.3897981643676758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.390091896057129  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.3986101150512695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([151, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.3991889953613281  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.3991889953613281  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.3994770050048828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.4098453521728516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([112, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.4103474617004395  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.4103474617004395  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.4105610847473145  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.4197468757629395  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([98, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.4202995300292969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.4202995300292969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.4204864501953125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.4298324584960938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([87, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.430408000946045  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.430408000946045  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.4305739402770996  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.4400324821472168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([76, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.4406070709228516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.4406070709228516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.4407520294189453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.4500293731689453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([70, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.450629711151123  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.450629711151123  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.45076322555542  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.460242748260498  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([79, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.4610114097595215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.4610114097595215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.4611620903015137  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.4729151725769043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([69, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.4736356735229492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.4736356735229492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.4737672805786133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.4849538803100586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.4855003356933594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.4855003356933594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.4855937957763672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.494192123413086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([53, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.494858741760254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.494858741760254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.494959831237793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.5049676895141602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([60, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.5057826042175293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.5057826042175293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.505897045135498  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.5180277824401855  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([55, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.5188164710998535  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.5188164710998535  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.5189213752746582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.530775547027588  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([42, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.531409740447998  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.531409740447998  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.5314898490905762  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.5411028861999512  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([56, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.5420317649841309  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.5420317649841309  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.5421385765075684  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.5557036399841309  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([49, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.5565452575683594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.5565452575683594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.5566387176513672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.569162368774414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([41, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.56990385055542  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.56990385055542  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.5699820518493652  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.5810084342956543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([50, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.581986427307129  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.581986427307129  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.5820817947387695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.596196174621582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([30, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.59678316116333  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.59678316116333  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.5968403816223145  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.6057095527648926  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.606344223022461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.606344223022461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.6064014434814453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.615671157836914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([34, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.616426944732666  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.616426944732666  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.6164917945861816  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.6274514198303223  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([672, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.6436595916748047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.6436595916748047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 672, 256]), torch.Size([1, 672, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.6449413299560547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.8794856071472168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 672, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.8480958938598633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.8485288619995117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.8489618301391602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.8485069274902344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2905, 40])
input nodes number: 19199
output nodes number: 2905
edges number: 34634
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.8486905097961426  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.8486909866333008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.039460182189941406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 6 input nodes size: 39135
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.035370826721191406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.035370826721191406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.054902076721191406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.05492353439331055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.03108978271484375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.032067298889160156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.032067298889160156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.032067298889160156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([39135, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.032067298889160156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([683, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.08446168899536133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.08446168899536133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 683, 128]), torch.Size([1, 683, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.0851130485534668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.09100103378295898  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 683, 128])
m.shape torch.Size([835, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.09147167205810547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.09147167205810547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 835, 128]), torch.Size([1, 835, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.09226799011230469  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.10421276092529297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 835, 128])
m.shape torch.Size([790, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1049647331237793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1049647331237793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 790, 128]), torch.Size([1, 790, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.10571813583374023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.12229299545288086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 790, 128])
m.shape torch.Size([682, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.12321710586547852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.12321710586547852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 682, 128]), torch.Size([1, 682, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.12386751174926758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.14342355728149414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 682, 128])
m.shape torch.Size([662, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.14467668533325195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.14467668533325195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 662, 128]), torch.Size([1, 662, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1453080177307129  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.16812467575073242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 662, 128])
m.shape torch.Size([549, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.16937971115112305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.16937971115112305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 549, 128]), torch.Size([1, 549, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.16990327835083008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1929917335510254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 549, 128])
m.shape torch.Size([500, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1943988800048828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1943988800048828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 500, 128]), torch.Size([1, 500, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.19487571716308594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.2187175750732422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 500, 128])
m.shape torch.Size([494, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.22036361694335938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.22036361694335938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 494, 128]), torch.Size([1, 494, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.22083473205566406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.24768829345703125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 494, 128])
m.shape torch.Size([457, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.24941396713256836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.24941396713256836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 457, 128]), torch.Size([1, 457, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.24984979629516602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.277742862701416  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 457, 128])
m.shape torch.Size([8082, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.31606292724609375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.31606292724609375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 4041, 128]), torch.Size([1, 4041, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3204936981201172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5969719886779785  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 4041, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5969719886779785  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5969719886779785  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 4041, 128]), torch.Size([1, 4041, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6010880470275879  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8754034042358398  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 4041, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8287444114685059  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8418421745300293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8549399375915527  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8417396545410156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([13734, 256])
first layer input nodes number: 39135
first layer output nodes number: 13734
edges number: 106440
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8552336692810059  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8683314323425293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8724474906921387  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8724474906921387  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([393, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8966770172119141  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8966770172119141  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 393, 256]), torch.Size([1, 393, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8974266052246094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9048938751220703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 393, 256])
m.shape torch.Size([368, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9052267074584961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9052267074584961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 368, 256]), torch.Size([1, 368, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9059286117553711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9172425270080566  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 368, 256])
m.shape torch.Size([303, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9177656173706055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9177656173706055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9183435440063477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9324121475219727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([210, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9329309463500977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9329309463500977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9333314895629883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9449472427368164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([206, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9465594291687012  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9465594291687012  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9469523429870605  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.961097240447998  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([130, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9616508483886719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9616508483886719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9618988037109375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9725608825683594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([114, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9732041358947754  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9732041358947754  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.973421573638916  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9842934608459473  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([99, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9849462509155273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9849462509155273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9851350784301758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9958982467651367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([76, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9964613914489746  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9964613914489746  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9966063499450684  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0058836936950684  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([74, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0065226554870605  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0065226554870605  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0066637992858887  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0166850090026855  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([71, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0173654556274414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0173654556274414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.017500877380371  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0280637741088867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0287113189697266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0287113189697266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.028829574584961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0388813018798828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([45, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0393848419189453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0393848419189453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0394706726074219  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0473670959472656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0478358268737793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0478358268737793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0479083061218262  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0550837516784668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([43, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0556678771972656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0556678771972656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0557498931884766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.064443588256836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.064864158630371  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.064864158630371  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0649213790893555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0713872909545898  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0717835426330566  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0717835426330566  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0718331336975098  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0777840614318848  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0782785415649414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0782785415649414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0783357620239258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0856027603149414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0860676765441895  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0860676765441895  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0861191749572754  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.093019962310791  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0935134887695312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0935134887695312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0935649871826172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1008262634277344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1012849807739258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1012849807739258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1013307571411133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1081056594848633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1084003448486328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1084003448486328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.108428955078125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.112863540649414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1130704879760742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1130704879760742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1130895614624023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1161794662475586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1164240837097168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1164240837097168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1164450645446777  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1199908256530762  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([394, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1294474601745605  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1294474601745605  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 394, 256]), torch.Size([1, 394, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1301989555358887  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.2666540145874023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 394, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.2453598976135254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.245781421661377  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.2462029457092285  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.2457599639892578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2826, 40])
input nodes number: 13734
output nodes number: 2826
edges number: 24682
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.2458724975585938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.245872974395752  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.03384971618652344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 7 input nodes size: 43543
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.031078338623046875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.031078338623046875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.052562713623046875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.05258369445800781  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.03303098678588867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.0340123176574707  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.0340123176574707  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.0340123176574707  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([43543, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.0340123176574707  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([734, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.08843708038330078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.08843708038330078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 734, 128]), torch.Size([1, 734, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.08913707733154297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.09473705291748047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 734, 128])
m.shape torch.Size([771, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.0951223373413086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.0951223373413086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 771, 128]), torch.Size([1, 771, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.09585762023925781  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.10705280303955078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 771, 128])
m.shape torch.Size([790, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.10781526565551758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.10781526565551758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 790, 128]), torch.Size([1, 790, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.10856866836547852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.12522077560424805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 790, 128])
m.shape torch.Size([659, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.12610101699829102  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.12610101699829102  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 659, 128]), torch.Size([1, 659, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.12672948837280273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.14586877822875977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 659, 128])
m.shape torch.Size([651, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1472177505493164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1472177505493164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 651, 128]), torch.Size([1, 651, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.14783859252929688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1707324981689453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 651, 128])
m.shape torch.Size([604, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1721501350402832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1721501350402832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 604, 128]), torch.Size([1, 604, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.17272615432739258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.19773149490356445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 604, 128])
m.shape torch.Size([497, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.19910240173339844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.19910240173339844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 497, 128]), torch.Size([1, 497, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.19957637786865234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.22327518463134766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 497, 128])
m.shape torch.Size([508, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.2249760627746582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.2249760627746582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 508, 128]), torch.Size([1, 508, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.22546052932739258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.25307512283325195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 508, 128])
m.shape torch.Size([460, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.2548069953918457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.2548069953918457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 460, 128]), torch.Size([1, 460, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.2552456855773926  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.2833218574523926  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 460, 128])
m.shape torch.Size([8295, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.32265615463256836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.32265615463256836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 4147, 128]), torch.Size([1, 4147, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.32697439193725586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6077713966369629  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 4147, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6077713966369629  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6077713966369629  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 4148, 128]), torch.Size([1, 4148, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.611727237701416  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8906145095825195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 4148, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8422946929931641  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.855616569519043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8689384460449219  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8555121421813965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([13969, 256])
first layer input nodes number: 43543
first layer output nodes number: 13969
edges number: 108794
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.869265079498291  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8825869560241699  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8859176635742188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8859176635742188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([440, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9083876609802246  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9083876609802246  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 440, 256]), torch.Size([1, 440, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9092268943786621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9160504341125488  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 440, 256])
m.shape torch.Size([385, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9163713455200195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9163713455200195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 385, 256]), torch.Size([1, 385, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9171056747436523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9296884536743164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 385, 256])
m.shape torch.Size([306, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.930203914642334  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.930203914642334  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9307875633239746  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9484038352966309  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([224, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9489731788635254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9489731788635254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9494004249572754  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9617905616760254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([152, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9623074531555176  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9623074531555176  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9625973701477051  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9730343818664551  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([158, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9738006591796875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9738006591796875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9741020202636719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.987060546875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([100, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9875826835632324  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9875826835632324  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9877734184265137  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9973101615905762  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([95, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9979453086853027  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9979453086853027  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9981265068054199  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0084547996520996  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([71, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0089783668518066  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0089783668518066  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0091137886047363  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0177807807922363  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([59, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0182805061340332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0182805061340332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0183930397033691  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0263829231262207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([51, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0268659591674805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0268659591674805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.026963233947754  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.034550666809082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([56, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0351481437683105  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0351481437683105  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.035254955291748  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0443339347839355  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([42, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0448055267333984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0448055267333984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0448856353759766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.052255630493164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([30, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.052619457244873  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.052619457244873  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0526766777038574  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0583415031433105  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([31, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.058760166168213  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.058760166168213  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.05881929397583  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.065086841583252  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([29, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0655035972595215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0655035972595215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.065558910369873  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0718092918395996  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.07222318649292  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.07222318649292  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0722746849060059  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0784544944763184  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([36, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0790519714355469  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0790519714355469  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0791206359863281  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0878410339355469  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0882635116577148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0882635116577148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0883111953735352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.094700813293457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0952539443969727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0952539443969727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.095311164855957  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.103379249572754  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1036739349365234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1036739349365234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1037044525146484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1082210540771484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([26, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1087555885314941  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1087555885314941  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1088051795959473  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1164917945861816  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1169095039367676  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1169095039367676  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1169476509094238  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1231274604797363  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1234545707702637  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1234545707702637  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1234831809997559  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1283183097839355  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([334, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1365289688110352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1365289688110352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 334, 256]), torch.Size([1, 334, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1371660232543945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.25836181640625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 334, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.2388496398925781  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.2392606735229492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.2396717071533203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.2392396926879883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2758, 40])
input nodes number: 13969
output nodes number: 2758
edges number: 22809
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.2393546104431152  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.2393550872802734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.035823822021484375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 8 input nodes size: 15386
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.0330204963684082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.0330204963684082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.040357112884521484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.04037904739379883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.01887369155883789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.019342899322509766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.019342899322509766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.019342899322509766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([15386, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.019342899322509766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([711, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.04056072235107422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.04056072235107422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 711, 128]), torch.Size([1, 711, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.04123878479003906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.04697704315185547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 711, 128])
m.shape torch.Size([761, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.0473637580871582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.0473637580871582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 761, 128]), torch.Size([1, 761, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.04808950424194336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.0589756965637207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 761, 128])
m.shape torch.Size([691, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.05980730056762695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.05980730056762695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 691, 128]), torch.Size([1, 691, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.06046628952026367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.07533788681030273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 691, 128])
m.shape torch.Size([615, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.07618141174316406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.07618141174316406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 615, 128]), torch.Size([1, 615, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.0767679214477539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.09392356872558594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 615, 128])
m.shape torch.Size([567, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.09498214721679688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.09498214721679688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 567, 128]), torch.Size([1, 567, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.09552288055419922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.11552000045776367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 567, 128])
m.shape torch.Size([480, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1166229248046875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1166229248046875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 480, 128]), torch.Size([1, 480, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1170806884765625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1367645263671875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 480, 128])
m.shape torch.Size([410, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.13790416717529297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.13790416717529297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 410, 128]), torch.Size([1, 410, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.13829517364501953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.15784549713134766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 410, 128])
m.shape torch.Size([352, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1590566635131836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1590566635131836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 352, 128]), torch.Size([1, 352, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1593923568725586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1785268783569336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 352, 128])
m.shape torch.Size([286, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.17958641052246094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.17958641052246094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 286, 128]), torch.Size([1, 286, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.17985916137695312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.19731521606445312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 286, 128])
m.shape torch.Size([2181, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.2075786590576172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.2075786590576172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1090, 128]), torch.Size([1, 1090, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.2086181640625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.2824230194091797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 1090, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.2824230194091797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.2824230194091797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1091, 128]), torch.Size([1, 1091, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.2834634780883789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.35774707794189453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 1091, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3401618003845215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.34688901901245117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.35361623764038086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3468360900878906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([7054, 256])
first layer input nodes number: 15386
first layer output nodes number: 7054
edges number: 42551
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3537330627441406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3604602813720703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3625049591064453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3625049591064453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([458, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.38275814056396484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.38275814056396484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 458, 256]), torch.Size([1, 458, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.38363170623779297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.39062023162841797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 458, 256])
m.shape torch.Size([391, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.39093542098999023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.39093542098999023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 391, 256]), torch.Size([1, 391, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3916811943054199  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.40299272537231445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 391, 256])
m.shape torch.Size([297, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4034762382507324  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4034762382507324  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.40404272079467773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.41704702377319336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([269, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4178304672241211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4178304672241211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.41834354400634766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4339027404785156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([241, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.43480443954467773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.43480443954467773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.43526411056518555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4518122673034668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([180, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4526205062866211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4526205062866211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.45296382904052734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4677267074584961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([155, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.46895265579223633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.46895265579223633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.46924829483032227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.48403024673461914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([127, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.48485898971557617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.48485898971557617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.48510122299194336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.49890851974487305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([105, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4996957778930664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4996957778930664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4998960494995117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5127134323120117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([81, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5133919715881348  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5133919715881348  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5135464668273926  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5245156288146973  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([58, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5250515937805176  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5250515937805176  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5251622200012207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5337910652160645  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([65, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5344858169555664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5344858169555664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5346097946166992  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5451478958129883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([62, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.545860767364502  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.545860767364502  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5459790229797363  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5568585395812988  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([57, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5575666427612305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5575666427612305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5576753616333008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5684385299682617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5689034461975098  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5689034461975098  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.568972110748291  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5762505531311035  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5767240524291992  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5767240524291992  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.576786994934082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5838994979858398  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5844073295593262  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5844073295593262  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.584470272064209  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5920233726501465  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5925631523132324  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5925631523132324  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5926260948181152  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6006197929382324  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6011180877685547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6011180877685547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6011734008789062  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6085853576660156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6088848114013672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6088848114013672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.608917236328125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6134891510009766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6136951446533203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6136951446533203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6137161254882812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6168212890625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6171283721923828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6171283721923828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.617156982421875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6215915679931641  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6218647956848145  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6218647956848145  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.621889591217041  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6259064674377441  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6261940002441406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6261940002441406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6262187957763672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6304092407226562  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([145, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6338810920715332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6338810920715332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.634157657623291  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.682833194732666  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 145, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6658773422241211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6663131713867188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6667490005493164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6662912368774414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2924, 40])
input nodes number: 7054
output nodes number: 2924
edges number: 20281
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6663908958435059  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6663913726806641  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.02029561996459961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 9 input nodes size: 20545
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.018898487091064453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.018898487091064453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.028695106506347656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.028716087341308594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.02135753631591797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.021826744079589844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.021826744079589844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.021826744079589844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([20545, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.021826744079589844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([752, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.044612884521484375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.044612884521484375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 752, 128]), torch.Size([1, 752, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.045330047607421875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.0517582893371582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 752, 128])
m.shape torch.Size([812, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.05217409133911133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.05217409133911133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 812, 128]), torch.Size([1, 812, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.0529484748840332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.06456422805786133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 812, 128])
m.shape torch.Size([726, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.0652155876159668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.0652155876159668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 726, 128]), torch.Size([1, 726, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.06590795516967773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.08114004135131836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 726, 128])
m.shape torch.Size([649, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.0820317268371582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.0820317268371582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 649, 128]), torch.Size([1, 649, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.08265066146850586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.10088396072387695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 649, 128])
m.shape torch.Size([546, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.10187625885009766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.10187625885009766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 546, 128]), torch.Size([1, 546, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.10239696502685547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.12231254577636719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 546, 128])
m.shape torch.Size([475, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.12341117858886719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.12341117858886719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 475, 128]), torch.Size([1, 475, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.12386417388916016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1433429718017578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 475, 128])
m.shape torch.Size([436, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.14457178115844727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.14457178115844727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 436, 128]), torch.Size([1, 436, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1449875831604004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.16577768325805664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 436, 128])
m.shape torch.Size([375, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.16700029373168945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.16700029373168945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 375, 128]), torch.Size([1, 375, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1673579216003418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1877427101135254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 375, 128])
m.shape torch.Size([314, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.18891143798828125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.18891143798828125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 314, 128]), torch.Size([1, 314, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1892108917236328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.2083759307861328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 314, 128])
m.shape torch.Size([2411, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.21972274780273438  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.21972274780273438  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1205, 128]), torch.Size([1, 1205, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.2208719253540039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3024635314941406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 1205, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3024635314941406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3024635314941406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1206, 128]), torch.Size([1, 1206, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.30361366271972656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.38469839096069336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 1206, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3657522201538086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.37290096282958984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3800497055053711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3728446960449219  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([7496, 256])
first layer input nodes number: 20545
first layer output nodes number: 7496
edges number: 45718
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3802051544189453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.38735389709472656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.38918113708496094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.38918113708496094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([503, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.406186580657959  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.406186580657959  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 503, 256]), torch.Size([1, 503, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.40714597702026367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4156002998352051  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 503, 256])
m.shape torch.Size([436, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.41595888137817383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.41595888137817383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 436, 256]), torch.Size([1, 436, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4167904853820801  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.43071413040161133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 436, 256])
m.shape torch.Size([330, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.43125009536743164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.43125009536743164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 330, 256]), torch.Size([1, 330, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.43187952041625977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.44727563858032227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 330, 256])
m.shape torch.Size([259, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.44796085357666016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.44796085357666016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 259, 256]), torch.Size([1, 259, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4484548568725586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4630861282348633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 259, 256])
m.shape torch.Size([205, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.463834285736084  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.463834285736084  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.46422529220581055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4783015251159668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([168, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.47907495498657227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.47907495498657227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.47939538955688477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.49317407608032227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([126, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.49386167526245117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.49386167526245117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.49410200119018555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5061182975769043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([114, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5068750381469727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5068750381469727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5070924758911133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5194864273071289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([100, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5202431678771973  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5202431678771973  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5204339027404785  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5326409339904785  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([73, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5332474708557129  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5332474708557129  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5333867073059082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5432724952697754  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([61, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5438480377197266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5438480377197266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5439643859863281  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.55303955078125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([50, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.553558349609375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.553558349609375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5536537170410156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5617599487304688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([43, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5622496604919434  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5622496604919434  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5623316764831543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5698771476745605  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([34, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5702939033508301  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5702939033508301  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5703587532043457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5767788887023926  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([26, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5771217346191406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5771217346191406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5771713256835938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.582427978515625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5829262733459473  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5829262733459473  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5829911231994629  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5903191566467285  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5907115936279297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5907115936279297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5907611846923828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5967121124267578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([18, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5969991683959961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5969991683959961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5970335006713867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6013936996459961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.601870059967041  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.601870059967041  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.601921558380127  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6088223457336426  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6091618537902832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6091618537902832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6091980934143066  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6143078804016113  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6145725250244141  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6145725250244141  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6145992279052734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6185512542724609  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([7, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6186861991882324  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6186861991882324  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6186995506286621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6207690238952637  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6208953857421875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6208953857421875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6209068298339844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6227607727050781  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6229395866394043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6229395866394043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6229548454284668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6255335807800293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([101, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.627953052520752  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.627953052520752  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.628145694732666  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.662050724029541  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 101, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6482715606689453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6486873626708984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6491031646728516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6486663818359375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2788, 40])
input nodes number: 7496
output nodes number: 2788
edges number: 17060
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6487236022949219  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6487240791320801  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.022757530212402344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 10 input nodes size: 22925
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.021337509155273438  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.021337509155273438  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.03305625915527344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.03307771682739258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.023260116577148438  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.02381420135498047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.02381420135498047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.02381420135498047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([22925, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.02381420135498047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([739, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.05100536346435547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.05100536346435547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 739, 128]), torch.Size([1, 739, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.05171012878417969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.05734825134277344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 739, 128])
m.shape torch.Size([839, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.05779600143432617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.05779600143432617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 839, 128]), torch.Size([1, 839, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.058596134185791016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.07059812545776367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 839, 128])
m.shape torch.Size([765, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.07143163681030273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.07143163681030273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 765, 128]), torch.Size([1, 765, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.07216119766235352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.0882115364074707  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 765, 128])
m.shape torch.Size([616, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.08906936645507812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.08906936645507812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 616, 128]), torch.Size([1, 616, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.08965682983398438  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.10670089721679688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 616, 128])
m.shape torch.Size([575, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.10777807235717773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.10777807235717773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 575, 128]), torch.Size([1, 575, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.10832643508911133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.12881898880004883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 575, 128])
m.shape torch.Size([486, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.12993526458740234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.12993526458740234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 486, 128]), torch.Size([1, 486, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.13039875030517578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1503286361694336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 486, 128])
m.shape torch.Size([437, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.15155553817749023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.15155553817749023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 437, 128]), torch.Size([1, 437, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.15197229385375977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.17281007766723633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 437, 128])
m.shape torch.Size([398, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1741199493408203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1741199493408203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 398, 128]), torch.Size([1, 398, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.17449951171875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1961345672607422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 398, 128])
m.shape torch.Size([363, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.19750261306762695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.19750261306762695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 363, 128]), torch.Size([1, 363, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.19784879684448242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.22000455856323242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 363, 128])
m.shape torch.Size([3228, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.2354564666748047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.2354564666748047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1614, 128]), torch.Size([1, 1614, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.23699569702148438  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.34679508209228516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 1614, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.34679508209228516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.34679508209228516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1614, 128]), torch.Size([1, 1614, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.34833431243896484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4568500518798828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 1614, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4339461326599121  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4420008659362793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4500555992126465  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4419379234313965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([8446, 256])
first layer input nodes number: 22925
first layer output nodes number: 8446
edges number: 54757
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4502286911010742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4582834243774414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.46046924591064453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.46046924591064453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([495, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.48075008392333984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.48075008392333984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 495, 256]), torch.Size([1, 495, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.48169422149658203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4894981384277344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 495, 256])
m.shape torch.Size([442, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.48987579345703125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.48987579345703125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 442, 256]), torch.Size([1, 442, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4907188415527344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5033645629882812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 442, 256])
m.shape torch.Size([331, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5038976669311523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5038976669311523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 331, 256]), torch.Size([1, 331, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5045289993286133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5192632675170898  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 331, 256])
m.shape torch.Size([250, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5199089050292969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5199089050292969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5203857421875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5342140197753906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([200, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5349369049072266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5349369049072266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5353183746337891  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5490512847900391  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([139, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5496625900268555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5496625900268555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5499277114868164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5613279342651367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([136, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.562110424041748  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.562110424041748  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5623698234558105  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5753397941589355  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([104, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5760097503662109  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5760097503662109  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5762081146240234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5875148773193359  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([98, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5882635116577148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5882635116577148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5884504318237305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6004133224487305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([79, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6010794639587402  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6010794639587402  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6012301445007324  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6119284629821777  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([61, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6124982833862305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6124982833862305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.612614631652832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6216897964477539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([64, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6223697662353516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6223697662353516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6224918365478516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6328678131103516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([39, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6332941055297852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6332941055297852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6333684921264648  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6402120590209961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6407670974731445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6407670974731445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6408510208129883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6491594314575195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6496801376342773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6496801376342773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.649754524230957  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6576395034790039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6580328941345215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6580328941345215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6580862998962402  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.664121150970459  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6645684242248535  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6645684242248535  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6646237373352051  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6712613105773926  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6717357635498047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6717357635498047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6717910766601562  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6788158416748047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6791720390319824  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6791720390319824  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6792120933532715  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6845793724060059  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6849632263183594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6849632263183594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6850032806396484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6906509399414062  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6910347938537598  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6910347938537598  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.691072940826416  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.696718692779541  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.696932315826416  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.696932315826416  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.696953296661377  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7002053260803223  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7004380226135254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7004380226135254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7004590034484863  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7038578987121582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7040319442749023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7040319442749023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7040472030639648  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7066259384155273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([172, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7107515335083008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7107515335083008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7110795974731445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7688188552856445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 172, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7517876625061035  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7522158622741699  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7526440620422363  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7521944046020508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2871, 40])
input nodes number: 8446
output nodes number: 2871
edges number: 19498
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.752291202545166  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7522916793823242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.02491903305053711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 11 input nodes size: 16050
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.02327251434326172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.02327251434326172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.030925750732421875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.03094768524169922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.019207477569580078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.019617557525634766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.019617557525634766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.019617557525634766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([16050, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.019617557525634766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([736, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.038664817810058594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.038664817810058594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 736, 128]), torch.Size([1, 736, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.039366722106933594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.044981956481933594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 736, 128])
m.shape torch.Size([806, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.04539966583251953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.04539966583251953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 806, 128]), torch.Size([1, 806, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.04616832733154297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.05769824981689453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 806, 128])
m.shape torch.Size([749, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.05840492248535156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.05840492248535156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 749, 128]), torch.Size([1, 749, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.059119224548339844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.07512378692626953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 749, 128])
m.shape torch.Size([658, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.07602453231811523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.07602453231811523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 658, 128]), torch.Size([1, 658, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.07665205001831055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.09522151947021484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 658, 128])
m.shape torch.Size([559, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.09624052047729492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.09624052047729492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 559, 128]), torch.Size([1, 559, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.09677362442016602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.11618900299072266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 559, 128])
m.shape torch.Size([410, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.11804533004760742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.11804533004760742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 410, 128]), torch.Size([1, 410, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.11843633651733398  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.13524961471557617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 410, 128])
m.shape torch.Size([352, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1362290382385254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1362290382385254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 352, 128]), torch.Size([1, 352, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1365647315979004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1533493995666504  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 352, 128])
m.shape torch.Size([315, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.15438318252563477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.15438318252563477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 315, 128]), torch.Size([1, 315, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.15468358993530273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.17180681228637695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 315, 128])
m.shape torch.Size([263, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.17278528213500977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.17278528213500977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 263, 128]), torch.Size([1, 263, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1730360984802246  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1890883445739746  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 263, 128])
m.shape torch.Size([1824, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1976604461669922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1976604461669922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 912, 128]), torch.Size([1, 912, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1985301971435547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.2602825164794922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 912, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.2602825164794922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.2602825164794922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 912, 128]), torch.Size([1, 912, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.2611522674560547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.32246971130371094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 912, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3069295883178711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3132925033569336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3196554183959961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.31324243545532227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([6672, 256])
first layer input nodes number: 16050
first layer output nodes number: 6672
edges number: 38073
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3197770118713379  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3261399269104004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3278489112854004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3278489112854004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([516, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3446063995361328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3446063995361328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 516, 256]), torch.Size([1, 516, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.34559059143066406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.35346412658691406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 516, 256])
m.shape torch.Size([460, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.35385656356811523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.35385656356811523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.354733943939209  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.36806249618530273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([375, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.36884546279907227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.36884546279907227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 375, 256]), torch.Size([1, 375, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.36956071853637695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3863406181335449  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 375, 256])
m.shape torch.Size([296, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.38712120056152344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.38712120056152344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 296, 256]), torch.Size([1, 296, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.38768577575683594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4055156707763672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 296, 256])
m.shape torch.Size([255, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.40645885467529297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.40645885467529297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.40694522857666016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4244546890258789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([163, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4251518249511719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4251518249511719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4254627227783203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4388313293457031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([130, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.43955087661743164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.43955087661743164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.43979883193969727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4521965980529785  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([108, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.45290327072143555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.45290327072143555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4531092643737793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.46485090255737305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([107, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.46567392349243164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.46567392349243164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4658780097961426  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4789395332336426  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([77, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.47957801818847656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.47957801818847656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4797248840332031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.49015235900878906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([63, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.49074506759643555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.49074506759643555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.49086523056030273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5002379417419434  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([49, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5007433891296387  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5007433891296387  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5008368492126465  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5087809562683105  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5093717575073242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5093717575073242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5094690322875977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5184183120727539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5188813209533691  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5188813209533691  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.518953800201416  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5261292457580566  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([28, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5264968872070312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5264968872070312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.52655029296875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5322113037109375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5326151847839355  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5326151847839355  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5326685905456543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.538703441619873  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([17, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5389547348022461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5389547348022461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5389871597290039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5428781509399414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([18, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5431737899780273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5431737899780273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.543208122253418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5475683212280273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([13, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5477886199951172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5477886199951172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5478134155273438  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5511360168457031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5514121055603027  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5514121055603027  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5514407157897949  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5554747581481934  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([8, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5556221008300781  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5556221008300781  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5556373596191406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5578956604003906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5580153465270996  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5580153465270996  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5580267906188965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5598006248474121  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([7, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5599498748779297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5599498748779297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5599632263183594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5621261596679688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5624194145202637  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5624194145202637  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5624442100524902  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5666346549987793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([80, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.568544864654541  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.568544864654541  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.568697452545166  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.595552921295166  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 80, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5821819305419922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5826172828674316  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5830526351928711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5825953483581543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2921, 40])
input nodes number: 6672
output nodes number: 2921
edges number: 16782
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.582674503326416  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5826749801635742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.020463943481445312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 12 input nodes size: 34092
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.019214630126953125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.019214630126953125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.03547096252441406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.035491943359375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.0278167724609375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.028759002685546875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.028759002685546875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.028759002685546875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([34092, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.028759002685546875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([630, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.07890558242797852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.07890558242797852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 630, 128]), torch.Size([1, 630, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.07950639724731445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.08443307876586914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 630, 128])
m.shape torch.Size([665, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.08476686477661133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.08476686477661133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 665, 128]), torch.Size([1, 665, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.08540105819702148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.09537887573242188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 665, 128])
m.shape torch.Size([587, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.0959014892578125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.0959014892578125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 587, 128]), torch.Size([1, 587, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.09646129608154297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.10967540740966797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 587, 128])
m.shape torch.Size([582, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.11050558090209961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.11050558090209961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 582, 128]), torch.Size([1, 582, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.11106061935424805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.12772703170776367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 582, 128])
m.shape torch.Size([613, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.12891101837158203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.12891101837158203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 613, 128]), torch.Size([1, 613, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.12949562072753906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.15077543258666992  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 613, 128])
m.shape torch.Size([551, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.15205955505371094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.15205955505371094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 551, 128]), torch.Size([1, 551, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.15258502960205078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.17554950714111328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 551, 128])
m.shape torch.Size([513, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.17699909210205078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.17699909210205078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 513, 128]), torch.Size([1, 513, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1774883270263672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.20202302932739258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 513, 128])
m.shape torch.Size([500, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.20368576049804688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.20368576049804688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 500, 128]), torch.Size([1, 500, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.20416259765625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.23134231567382812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 500, 128])
m.shape torch.Size([484, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.23318099975585938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.23318099975585938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 484, 128]), torch.Size([1, 484, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.233642578125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.26318359375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 484, 128])
m.shape torch.Size([7755, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.29993152618408203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.29993152618408203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 3877, 128]), torch.Size([1, 3877, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.30362892150878906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5694923400878906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 3877, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5694923400878906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5694923400878906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 3878, 128]), torch.Size([1, 3878, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5731906890869141  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8339247703552246  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 3878, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7895073890686035  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.801790714263916  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8140740394592285  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.801694393157959  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([12880, 256])
first layer input nodes number: 34092
first layer output nodes number: 12880
edges number: 101917
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8143301010131836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8266134262084961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8296842575073242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8296842575073242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([413, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.853825569152832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.853825569152832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 413, 256]), torch.Size([1, 413, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8546133041381836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8610067367553711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 413, 256])
m.shape torch.Size([327, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8612418174743652  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8612418174743652  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 327, 256]), torch.Size([1, 327, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8618655204772949  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8715605735778809  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 327, 256])
m.shape torch.Size([254, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.871981143951416  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.871981143951416  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8724656105041504  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8831238746643066  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([172, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8835430145263672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8835430145263672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8838710784912109  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8933849334716797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([188, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8941245079040527  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8941245079040527  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8944830894470215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9073920249938965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([153, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9080953598022461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9080953598022461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9083871841430664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9209356307983398  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([130, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9216647148132324  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9216647148132324  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.921912670135498  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9343104362487793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([113, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9350557327270508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9350557327270508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9352712631225586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9475564956665039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([82, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9481582641601562  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9481582641601562  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9483146667480469  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9583244323730469  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([88, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9590921401977539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9590921401977539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9592599868774414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9711771011352539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([89, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9720344543457031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9720344543457031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9722042083740234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9854450225830078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([69, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9861559867858887  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9861559867858887  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9862875938415527  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.997474193572998  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([36, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9978585243225098  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9978585243225098  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.997927188873291  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.004244327545166  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([34, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0046677589416504  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0046677589416504  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.004732608795166  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.011152744293213  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0117692947387695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0117692947387695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.011855125427246  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0209531784057617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0214638710021973  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0214638710021973  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0215325355529785  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0292916297912598  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.029829502105713  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.029829502105713  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0298962593078613  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0379071235656738  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.038444995880127  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.038444995880127  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0385079383850098  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.046501636505127  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0469636917114258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0469636917114258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0470151901245117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0539159774780273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0543708801269531  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0543708801269531  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0544185638427734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0611419677734375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0615220069885254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0615220069885254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0615601539611816  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0672059059143066  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0676097869873047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0676097869873047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.067647933959961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0735607147216797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0738515853881836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0738515853881836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.073878288269043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0782041549682617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.078721523284912  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.078721523284912  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0787653923034668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.086179256439209  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([344, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0944232940673828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0944232940673828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 344, 256]), torch.Size([1, 344, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0950794219970703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.217397689819336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 344, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.196638584136963  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1970515251159668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1974644660949707  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1970305442810059  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2770, 40])
input nodes number: 12880
output nodes number: 2770
edges number: 24345
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1971254348754883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1971259117126465  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.030435562133789062  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 13 input nodes size: 29154
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.027794361114501953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.027794361114501953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.04169607162475586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.0417170524597168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.025439739227294922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.026039600372314453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.026039600372314453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.026039600372314453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([29154, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.026039600372314453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([844, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.05853605270385742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.05853605270385742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 844, 128]), torch.Size([1, 844, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.0593409538269043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.06589365005493164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 844, 128])
m.shape torch.Size([851, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.06630277633666992  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.06630277633666992  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 851, 128]), torch.Size([1, 851, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.06711435317993164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.07967138290405273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 851, 128])
m.shape torch.Size([733, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.08031415939331055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.08031415939331055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 733, 128]), torch.Size([1, 733, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.08101320266723633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.09705066680908203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 733, 128])
m.shape torch.Size([638, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.09791803359985352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.09791803359985352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 638, 128]), torch.Size([1, 638, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.0985264778137207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1163945198059082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 638, 128])
m.shape torch.Size([569, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1174468994140625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1174468994140625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 569, 128]), torch.Size([1, 569, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.11798954010009766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.13914918899536133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 569, 128])
m.shape torch.Size([474, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.14023399353027344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.14023399353027344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 474, 128]), torch.Size([1, 474, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.14068603515625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1601238250732422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 474, 128])
m.shape torch.Size([433, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.16134309768676758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.16134309768676758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 433, 128]), torch.Size([1, 433, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.16175603866577148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1824030876159668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 433, 128])
m.shape torch.Size([375, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.18362712860107422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.18362712860107422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 375, 128]), torch.Size([1, 375, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.18398475646972656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.20436954498291016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 375, 128])
m.shape torch.Size([346, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.20567560195922852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.20567560195922852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 346, 128]), torch.Size([1, 346, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.20600557327270508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.22712373733520508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 346, 128])
m.shape torch.Size([4259, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.2472672462463379  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.2472672462463379  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 2129, 128]), torch.Size([1, 2129, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.2501039505004883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.39806699752807617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 2129, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.39806699752807617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.39806699752807617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 2130, 128]), torch.Size([1, 2130, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4000983238220215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5449399948120117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 2130, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5167975425720215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5258784294128418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5349593162536621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5258073806762695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([9522, 256])
first layer input nodes number: 29154
first layer output nodes number: 9522
edges number: 64721
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5351786613464355  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5442595481872559  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5465297698974609  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5465297698974609  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([580, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5622987747192383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5622987747192383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 580, 256]), torch.Size([1, 580, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5634050369262695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5723943710327148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 580, 256])
m.shape torch.Size([476, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.572756290435791  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.572756290435791  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 476, 256]), torch.Size([1, 476, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5736641883850098  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5873160362243652  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 476, 256])
m.shape torch.Size([322, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5877909660339355  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5877909660339355  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 322, 256]), torch.Size([1, 322, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5884051322937012  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6023073196411133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 322, 256])
m.shape torch.Size([262, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6030235290527344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6030235290527344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6035232543945312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6180152893066406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([220, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6191701889038086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6191701889038086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6195898056030273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6346960067749023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([143, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6353111267089844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6353111267089844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6355838775634766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6473121643066406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([120, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6479835510253906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6479835510253906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6482124328613281  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6596565246582031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([102, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6603264808654785  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6603264808654785  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6605210304260254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6716103553771973  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([79, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6721968650817871  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6721968650817871  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6723475456237793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6819911003112793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([53, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6824254989624023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6824254989624023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6825265884399414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6897039413452148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([44, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6901187896728516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6901187896728516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6902027130126953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6967487335205078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([40, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6971683502197266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6971683502197266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6972446441650391  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7037296295166016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([42, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.704216480255127  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.704216480255127  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7042965888977051  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7116665840148926  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([25, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7119631767272949  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7119631767272949  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7120108604431152  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7167315483093262  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([13, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.716895580291748  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.716895580291748  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7169203758239746  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7195487022399902  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([21, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7198596000671387  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7198596000671387  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7198996543884277  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7244257926940918  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([20, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7247328758239746  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7247328758239746  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7247710227966309  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7293486595153809  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([15, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7295894622802734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7295894622802734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7296180725097656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7332515716552734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([10, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7334198951721191  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7334198951721191  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7334389686584473  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.735994815826416  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7362737655639648  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7362737655639648  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.736302375793457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7403364181518555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7406048774719238  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7406048774719238  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7406315803527832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7445836067199707  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([4, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7446551322937012  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7446551322937012  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7446627616882324  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7458453178405762  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7460627555847168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7460627555847168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7460818290710449  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7491717338562012  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7493929862976074  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7493929862976074  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7494120597839355  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7526354789733887  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([118, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7554616928100586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7554616928100586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7556867599487305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7952985763549805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 118, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7827749252319336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7831859588623047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7835969924926758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7831649780273438  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2758, 40])
input nodes number: 9522
output nodes number: 2758
edges number: 15694
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7832551002502441  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7832555770874023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.027217388153076172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 14 input nodes size: 33174
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.02543783187866211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.02543783187866211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.04125642776489258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.041277408599853516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.027354717254638672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.028033733367919922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.028033733367919922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.028033733367919922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([33174, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.028033733367919922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([794, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.06401968002319336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.06401968002319336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 794, 128]), torch.Size([1, 794, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.06477689743041992  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.07107973098754883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 794, 128])
m.shape torch.Size([798, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.07146215438842773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.07146215438842773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 798, 128]), torch.Size([1, 798, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.07222318649291992  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.08434009552001953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 798, 128])
m.shape torch.Size([738, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.08501529693603516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.08501529693603516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 738, 128]), torch.Size([1, 738, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.08571910858154297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1016693115234375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 738, 128])
m.shape torch.Size([659, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.10257434844970703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.10257434844970703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 659, 128]), torch.Size([1, 659, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.10320281982421875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.12274456024169922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 659, 128])
m.shape torch.Size([666, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.12401819229125977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.12401819229125977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 666, 128]), torch.Size([1, 666, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.12465333938598633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.14780473709106445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 666, 128])
m.shape torch.Size([489, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.14888620376586914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.14888620376586914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 489, 128]), torch.Size([1, 489, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1493525505065918  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.16940546035766602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 489, 128])
m.shape torch.Size([430, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1706075668334961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1706075668334961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 430, 128]), torch.Size([1, 430, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.17101764678955078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.19152164459228516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 430, 128])
m.shape torch.Size([438, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.19298744201660156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.19298744201660156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 438, 128]), torch.Size([1, 438, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1934051513671875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.21721458435058594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 438, 128])
m.shape torch.Size([345, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.21848630905151367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.21848630905151367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 345, 128]), torch.Size([1, 345, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.21881532669067383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.23987245559692383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 345, 128])
m.shape torch.Size([4959, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.2633543014526367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.2633543014526367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 2479, 128]), torch.Size([1, 2479, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.26635074615478516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.439971923828125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 2479, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.439971923828125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.439971923828125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 2480, 128]), torch.Size([1, 2480, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.44295406341552734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6145777702331543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 2480, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5834426879882812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5932807922363281  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.603118896484375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5932035446166992  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([10316, 256])
first layer input nodes number: 33174
first layer output nodes number: 10316
edges number: 72713
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6033682823181152  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6132063865661621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6156659126281738  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6156659126281738  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([521, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6338777542114258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6338777542114258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 521, 256]), torch.Size([1, 521, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6348714828491211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6436195373535156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 521, 256])
m.shape torch.Size([427, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6439437866210938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6439437866210938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 427, 256]), torch.Size([1, 427, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6447582244873047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6574611663818359  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 427, 256])
m.shape torch.Size([311, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6579508781433105  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6579508781433105  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6585440635681152  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6717963218688965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([254, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6724762916564941  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6724762916564941  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6729607582092285  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6870102882385254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([244, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6879410743713379  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6879410743713379  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 244, 256]), torch.Size([1, 244, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6884064674377441  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7051606178283691  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 244, 256])
m.shape torch.Size([135, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7057065963745117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7057065963745117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7059640884399414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.717036247253418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([114, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.717674732208252  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.717674732208252  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7178921699523926  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7287640571594238  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([118, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7295627593994141  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7295627593994141  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7297878265380859  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7426166534423828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([74, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7431445121765137  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7431445121765137  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7432856559753418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7523188591003418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([66, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7528829574584961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7528829574584961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7530088424682617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7619466781616211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([50, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7624125480651855  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7624125480651855  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7625079154968262  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7699465751647949  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([43, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7703952789306641  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7703952789306641  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.770477294921875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7774486541748047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([44, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7779574394226074  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7779574394226074  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7780413627624512  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7857623100280762  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([32, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7861509323120117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7861509323120117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7862119674682617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7922544479370117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([32, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7926855087280273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7926855087280273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7927465438842773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7992162704467773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([16, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7994318008422852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7994318008422852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7994623184204102  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8029108047485352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([19, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8032064437866211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8032064437866211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8032426834106445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.807591438293457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8079023361206055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8079023361206055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8079385757446289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8125410079956055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.812924861907959  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.812924861907959  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8129668235778809  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8185896873474121  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8189339637756348  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8189339637756348  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8189702033996582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8240799903869629  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([10, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8242640495300293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8242640495300293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8242831230163574  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8271059989929199  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8273715972900391  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8273715972900391  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8273963928222656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8312397003173828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8314266204833984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8314266204833984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8314437866210938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8342247009277344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8345160484313965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8345160484313965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.834540843963623  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8387312889099121  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([183, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.843116283416748  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.843116283416748  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8434653282165527  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9048972129821777  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 183, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8901810646057129  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.890596866607666  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8910126686096191  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8905758857727051  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2788, 40])
input nodes number: 10316
output nodes number: 2788
edges number: 18297
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.890678882598877  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.8906793594360352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.029364585876464844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 15 input nodes size: 37030
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.027359485626220703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.027359485626220703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.04501676559448242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.04503774642944336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.029198169708251953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.030360698699951172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.030360698699951172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.030360698699951172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([37030, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.030360698699951172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([566, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.09159278869628906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.09159278869628906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 566, 128]), torch.Size([1, 566, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.092132568359375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.0972452163696289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 566, 128])
m.shape torch.Size([612, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.09755897521972656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.09755897521972656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 612, 128]), torch.Size([1, 612, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.09814262390136719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.10738325119018555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 612, 128])
m.shape torch.Size([525, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.10784244537353516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.10784244537353516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 525, 128]), torch.Size([1, 525, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.10834312438964844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.11939811706542969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 525, 128])
m.shape torch.Size([490, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.12008237838745117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.12008237838745117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 490, 128]), torch.Size([1, 490, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.12054967880249023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.13410139083862305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 490, 128])
m.shape torch.Size([465, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.13497638702392578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.13497638702392578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 465, 128]), torch.Size([1, 465, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1354198455810547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1513843536376953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 465, 128])
m.shape torch.Size([447, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.15244150161743164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.15244150161743164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 447, 128]), torch.Size([1, 447, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.15286779403686523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.17119836807250977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 447, 128])
m.shape torch.Size([455, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.17250394821166992  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.17250394821166992  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 455, 128]), torch.Size([1, 455, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.17293787002563477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.19463396072387695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 455, 128])
m.shape torch.Size([448, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.19612598419189453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.19612598419189453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 448, 128]), torch.Size([1, 448, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.19655323028564453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.22090625762939453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 448, 128])
m.shape torch.Size([466, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.22269248962402344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.22269248962402344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 466, 128]), torch.Size([1, 466, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.22313690185546875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.25157928466796875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 466, 128])
m.shape torch.Size([10343, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3006763458251953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3006763458251953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 5171, 128]), torch.Size([1, 5171, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.30655717849731445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6586694717407227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 5171, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6586694717407227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6586694717407227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 5172, 128]), torch.Size([1, 5172, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6636018753051758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.012794017791748  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 5172, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9570460319519043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9711766242980957  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9853072166442871  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9710659980773926  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([14817, 256])
first layer input nodes number: 37030
first layer output nodes number: 14817
edges number: 124725
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9855852127075195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.9997158050537109  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.003248691558838  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.003248691558838  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([349, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0336289405822754  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0336289405822754  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 349, 256]), torch.Size([1, 349, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.034294605255127  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0396556854248047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 349, 256])
m.shape torch.Size([307, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0399131774902344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0399131774902344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0404987335205078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0499086380004883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 307, 256])
m.shape torch.Size([229, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.050276279449463  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.050276279449463  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.050713062286377  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0603222846984863  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([158, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.06071138381958  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.06071138381958  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0610127449035645  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0697522163391113  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([124, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.070197582244873  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.070197582244873  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0704340934753418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0789484977722168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([109, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0794591903686523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0794591903686523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.079667091369629  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.088606834411621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([85, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0890750885009766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0890750885009766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0892372131347656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0973434448242188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([74, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0978317260742188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0978317260742188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.0979728698730469  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.10601806640625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([87, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1067004203796387  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1067004203796387  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1068663597106934  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1174864768981934  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([66, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1180381774902344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1180381774902344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1181640625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1271018981933594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.127673625946045  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.127673625946045  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1277880668640137  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1367144584655762  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([58, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1373262405395508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1373262405395508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.137436866760254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1468400955200195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([44, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1473345756530762  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1473345756530762  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.14741849899292  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.155139446258545  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.155716896057129  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.155716896057129  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1558046340942383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1644906997680664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([31, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1648941040039062  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1648941040039062  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1649532318115234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1712207794189453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.171729564666748  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.171729564666748  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1717963218688965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.17933988571167  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1797480583190918  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1797480583190918  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1797995567321777  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1859793663024902  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.186507225036621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.186507225036621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.186568260192871  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.194319725036621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([38, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1949834823608398  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1949834823608398  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.1950559616088867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.204768180847168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([32, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.2053470611572266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.2053470611572266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.2054080963134766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.2140140533447266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.2145085334777832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.2145085334777832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.2145581245422363  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.2218976020812988  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.2223381996154785  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.2223381996154785  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.2223801612854004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.228884220123291  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.2292613983154297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.2292613983154297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.2292957305908203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.2348575592041016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.2352328300476074  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.2352328300476074  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.2352652549743652  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.2407450675964355  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([684, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.257164478302002  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.257164478302002  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 684, 256]), torch.Size([1, 684, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.2584691047668457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.4889063835144043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 684, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.4611248970031738  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.461535930633545  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.461946964263916  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.461514949798584  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2758, 40])
input nodes number: 14817
output nodes number: 2758
edges number: 31132
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.461641788482666  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.4616422653198242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.032390594482421875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 16 input nodes size: 15664
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.029193401336669922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.029193401336669922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.03666257858276367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.036684513092041016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.01900625228881836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.019505023956298828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.019505023956298828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.019505023956298828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([15664, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.019505023956298828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([494, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.041814327239990234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.041814327239990234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 494, 128]), torch.Size([1, 494, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.04228544235229492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.04605436325073242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 494, 128])
m.shape torch.Size([622, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.046411991119384766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.046411991119384766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 622, 128]), torch.Size([1, 622, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.04700517654418945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.05659341812133789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 622, 128])
m.shape torch.Size([591, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.05714225769042969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.05714225769042969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 591, 128]), torch.Size([1, 591, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.05770587921142578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.0703744888305664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 591, 128])
m.shape torch.Size([543, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.07112836837768555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.07112836837768555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 543, 128]), torch.Size([1, 543, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.07164621353149414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.0868067741394043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 543, 128])
m.shape torch.Size([467, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.0876612663269043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.0876612663269043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 467, 128]), torch.Size([1, 467, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.08810663223266602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.10413980484008789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 467, 128])
m.shape torch.Size([406, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.10507869720458984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.10507869720458984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 406, 128]), torch.Size([1, 406, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.10546588897705078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1221151351928711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 406, 128])
m.shape torch.Size([370, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.12315654754638672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.12315654754638672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 370, 128]), torch.Size([1, 370, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.12350940704345703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.14115238189697266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 370, 128])
m.shape torch.Size([332, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.142242431640625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.142242431640625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 332, 128]), torch.Size([1, 332, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.14255905151367188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.16060638427734375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 332, 128])
m.shape torch.Size([287, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.16167974472045898  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.16167974472045898  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 287, 128]), torch.Size([1, 287, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.16195344924926758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.17947053909301758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 287, 128])
m.shape torch.Size([2609, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1917743682861328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1917743682861328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1304, 128]), torch.Size([1, 1304, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.19301795959472656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.2813129425048828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 1304, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.2813129425048828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.2813129425048828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1305, 128]), torch.Size([1, 1305, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.28255748748779297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.37183380126953125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 1305, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3527998924255371  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3592095375061035  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3656191825866699  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.359158992767334  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([6721, 256])
first layer input nodes number: 15664
first layer output nodes number: 6721
edges number: 44373
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3657379150390625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3724498748779297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3739175796508789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3739175796508789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([355, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3960394859313965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3960394859313965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 355, 256]), torch.Size([1, 355, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3967165946960449  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4035162925720215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 355, 256])
m.shape torch.Size([353, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4038567543029785  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4038567543029785  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 353, 256]), torch.Size([1, 353, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.40453004837036133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.41514110565185547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 353, 256])
m.shape torch.Size([312, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.41570425033569336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.41570425033569336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.41629934310913086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4297909736633301  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([267, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.43052005767822266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.43052005767822266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4310293197631836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4457979202270508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([197, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4464902877807617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4464902877807617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4468660354614258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.46039295196533203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([175, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4612312316894531  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4612312316894531  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4615650177001953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4759178161621094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([157, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4768075942993164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4768075942993164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.47710704803466797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4920797348022461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([130, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.49292993545532227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.49292993545532227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4931778907775879  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5073113441467285  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([112, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5081562995910645  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5081562995910645  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5083699226379395  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5220417976379395  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([95, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5228481292724609  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5228481292724609  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5230293273925781  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5358943939208984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([85, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5367026329040527  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5367026329040527  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5368647575378418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5495104789733887  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([68, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5502138137817383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5502138137817383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5503435134887695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5613679885864258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([64, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5621027946472168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5621027946472168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5622248649597168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5734553337097168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([56, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5741481781005859  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5741481781005859  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5742549896240234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5848293304443359  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.585352897644043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.585352897644043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5854291915893555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5935163497924805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([51, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5942625999450684  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5942625999450684  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5943598747253418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6053519248962402  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6058754920959473  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6058754920959473  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6059422492980957  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6139531135559082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([40, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6146121025085449  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6146121025085449  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6146883964538574  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6243777275085449  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6248693466186523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6248693466186523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6249246597290039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6323366165161133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([38, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6330394744873047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6330394744873047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6331119537353516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6433315277099609  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6438608169555664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6438608169555664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6439142227172852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6518182754516602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6521725654602051  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6521725654602051  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6522068977355957  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6575284004211426  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6578431129455566  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6578431129455566  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6578717231750488  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6625065803527832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.662907600402832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.662907600402832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6629419326782227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6687440872192383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([166, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6727156639099121  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6727156639099121  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.673032283782959  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.728757381439209  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 166, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.709810733795166  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7102437019348145  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7106766700744629  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7102217674255371  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2904, 40])
input nodes number: 6721
output nodes number: 2904
edges number: 22517
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7103161811828613  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.7103166580200195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.020494937896728516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 17 input nodes size: 12679
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.019028186798095703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.019028186798095703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.025074005126953125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.02509593963623047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.017604827880859375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.01810169219970703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.01810169219970703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.01810169219970703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([12679, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.01810169219970703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([361, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.038515567779541016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.038515567779541016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 361, 128]), torch.Size([1, 361, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.03885984420776367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.04161405563354492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 361, 128])
m.shape torch.Size([418, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.041840553283691406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.041840553283691406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 418, 128]), torch.Size([1, 418, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.04223918914794922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.048218727111816406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 418, 128])
m.shape torch.Size([431, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.04863595962524414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.04863595962524414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 431, 128]), torch.Size([1, 431, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.049046993255615234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.0580897331237793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 431, 128])
m.shape torch.Size([430, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.058704376220703125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.058704376220703125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 430, 128]), torch.Size([1, 430, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.05911445617675781  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.07100677490234375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 430, 128])
m.shape torch.Size([407, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.07177209854125977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.07177209854125977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 407, 128]), torch.Size([1, 407, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.07216024398803711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.08613348007202148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 407, 128])
m.shape torch.Size([397, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.08771753311157227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.08771753311157227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 397, 128]), torch.Size([1, 397, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.08809614181518555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.10437631607055664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 397, 128])
m.shape torch.Size([347, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.10534524917602539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.10534524917602539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 347, 128]), torch.Size([1, 347, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.10567617416381836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1222224235534668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 347, 128])
m.shape torch.Size([310, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.12323951721191406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.12323951721191406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 310, 128]), torch.Size([1, 310, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.12353515625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.14038658142089844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 310, 128])
m.shape torch.Size([249, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.14130735397338867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.14130735397338867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 249, 128]), torch.Size([1, 249, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.14154481887817383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.15674257278442383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 249, 128])
m.shape torch.Size([2555, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1688070297241211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.1688070297241211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1277, 128]), torch.Size([1, 1277, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.17002487182617188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.25649166107177734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 1277, 128])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.25649166107177734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.25649166107177734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1278, 128]), torch.Size([1, 1278, 128])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.25771045684814453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.34363603591918945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 1278, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3260197639465332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3316512107849121  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.337282657623291  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3316068649291992  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([5905, 256])
first layer input nodes number: 12679
first layer output nodes number: 5905
edges number: 41327
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.33737945556640625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.34301090240478516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3444948196411133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3444948196411133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([283, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3692288398742676  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3692288398742676  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 283, 256]), torch.Size([1, 283, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3697686195373535  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3750624656677246  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 283, 256])
m.shape torch.Size([274, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3753194808959961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3753194808959961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.3758420944213867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.38765573501586914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([256, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.38813257217407227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.38813257217407227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.38862085342407227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.39936304092407227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([218, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.39995718002319336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.39995718002319336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4003729820251465  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4124312400817871  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([220, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.41420793533325195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.41420793533325195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4146275520324707  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4297337532043457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([214, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.43150997161865234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.43150997161865234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4319181442260742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.44946956634521484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([183, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4512515068054199  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4512515068054199  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4516005516052246  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.469052791595459  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([142, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4699702262878418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.4699702262878418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.47024106979370117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.48567914962768555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([108, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.486478328704834  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.486478328704834  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.48668432235717773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.49986791610717773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([129, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5010051727294922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5010051727294922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.501251220703125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5187206268310547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([108, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5197868347167969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5197868347167969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5199928283691406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5360603332519531  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([74, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5368108749389648  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5368108749389648  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.536952018737793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5489492416381836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([74, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5498037338256836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5498037338256836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5499448776245117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5629301071166992  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([71, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5638151168823242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5638151168823242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5639505386352539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.577357292175293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5779819488525391  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5779819488525391  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5780735015869141  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5877780914306641  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([46, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.58843994140625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.58843994140625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5885276794433594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5984420776367188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([63, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5998129844665527  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5998129844665527  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.5999331474304199  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6143527030944824  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6148638725280762  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6148638725280762  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.614926815032959  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6229205131530762  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6234188079833984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6234188079833984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.62347412109375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6308860778808594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([37, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6315698623657227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6315698623657227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6316404342651367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6415910720825195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6421008110046387  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6421008110046387  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6421523094177246  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6497740745544434  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6502137184143066  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6502137184143066  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6502556800842285  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6567597389221191  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6571588516235352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6571588516235352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6571950912475586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6630659103393555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6636013984680176  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6636013984680176  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6636471748352051  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6713833808898926  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([211, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6770315170288086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.6770315170288086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.677433967590332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.748265266418457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 211, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7266616821289062  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7270960807800293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7275304794311523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.727074146270752  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2913, 40])
input nodes number: 5905
output nodes number: 2913
edges number: 25317
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7271418571472168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.727142333984375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.019050121307373047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 18 input nodes size: 14267
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.017606258392333984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.017606258392333984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.02440929412841797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.024430274963378906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.01836252212524414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.018806934356689453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.018806934356689453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.018806934356689453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([14267, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.018806934356689453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([510, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.03910255432128906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.03910255432128906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 510, 128]), torch.Size([1, 510, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.03958892822265625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04347991943359375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 510, 128])
m.shape torch.Size([570, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04378032684326172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04378032684326172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 570, 128]), torch.Size([1, 570, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04432392120361328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.053044795989990234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 570, 128])
m.shape torch.Size([543, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.053549766540527344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.053549766540527344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 543, 128]), torch.Size([1, 543, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.05406761169433594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.06568336486816406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 543, 128])
m.shape torch.Size([468, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.06631708145141602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.06631708145141602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 468, 128]), torch.Size([1, 468, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.06676340103149414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.07970666885375977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 468, 128])
m.shape torch.Size([402, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08044195175170898  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08044195175170898  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 402, 128]), torch.Size([1, 402, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0808253288269043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.09462690353393555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 402, 128])
m.shape torch.Size([348, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.09543085098266602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.09543085098266602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 348, 128]), torch.Size([1, 348, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.09576272964477539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.11003351211547852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 348, 128])
m.shape torch.Size([300, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.11086893081665039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.11086893081665039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 300, 128]), torch.Size([1, 300, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.11115503311157227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.12546014785766602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 300, 128])
m.shape torch.Size([301, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1264653205871582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1264653205871582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 301, 128]), torch.Size([1, 301, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.12675237655639648  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.14311456680297852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 301, 128])
m.shape torch.Size([267, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.14411687850952148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.14411687850952148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 267, 128]), torch.Size([1, 267, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.14437150955200195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.16066789627075195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 267, 128])
m.shape torch.Size([2281, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.17225933074951172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.17225933074951172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1140, 128]), torch.Size([1, 1140, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.17334651947021484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.25438642501831055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 1140, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.25438642501831055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.25438642501831055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1141, 128]), torch.Size([1, 1141, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.2554745674133301  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.33504629135131836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 1141, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.31770896911621094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3234214782714844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3291339874267578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3233766555786133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([5990, 256])
first layer input nodes number: 14267
first layer output nodes number: 5990
edges number: 38970
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3292422294616699  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.33495473861694336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.33734846115112305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.33734846115112305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([376, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3576183319091797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3576183319091797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3583354949951172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.364595890045166  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([358, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3649258613586426  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3649258613586426  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.36560869216918945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.376101016998291  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([320, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3766822814941406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3766822814941406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 320, 256]), torch.Size([1, 320, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3772926330566406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.39089488983154297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 320, 256])
m.shape torch.Size([249, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.39154720306396484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.39154720306396484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.39202213287353516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4057950973510742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([184, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.40644216537475586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.40644216537475586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.40679311752319336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.41942739486694336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([155, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.42014598846435547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.42014598846435547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4204416275024414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4331541061401367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([123, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4338340759277344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4338340759277344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4340686798095703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4457988739013672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([123, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4466276168823242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4466276168823242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.44686222076416016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4602346420288086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([116, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4612131118774414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4612131118774414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.46143436431884766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.47559452056884766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([83, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.47628164291381836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.47628164291381836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4764399528503418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.48767995834350586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([89, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4885420799255371  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4885420799255371  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4887118339538574  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5019526481628418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([70, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5026755332946777  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5026755332946777  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5028090476989746  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.514157772064209  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([64, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5148906707763672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5148906707763672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5150127410888672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5262432098388672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5268149375915527  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5268149375915527  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5269045829772949  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5357794761657715  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5362825393676758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5362825393676758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5363550186157227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5440378189086914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([27, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5444169044494629  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5444169044494629  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5444684028625488  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5502877235412598  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([25, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5506706237792969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5506706237792969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5507183074951172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5564403533935547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([21, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5567798614501953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5567798614501953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5568199157714844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5619068145751953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5623068809509277  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5623068809509277  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5623507499694824  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5682291984558105  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.568687915802002  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.568687915802002  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5687355995178223  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5754590034484863  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5758390426635742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5758390426635742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5758771896362305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5815229415893555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5819692611694336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5819692611694336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5820112228393555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5885152816772461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5887374877929688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5887374877929688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5887584686279297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5921573638916016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5924239158630371  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5924239158630371  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5924468040466309  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5963149070739746  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([179, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6006045341491699  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6006045341491699  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6009459495544434  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6610350608825684  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 179, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.643794059753418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6442055702209473  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6446170806884766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6441845893859863  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2760, 40])
input nodes number: 5990
output nodes number: 2760
edges number: 20588
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6442275047302246  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6442279815673828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.019654273986816406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 19 input nodes size: 11518
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.01833963394165039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.01833963394165039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.023831844329833984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.023853302001953125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.017029285430908203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.017428874969482422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.017428874969482422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.017428874969482422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([11518, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.017428874969482422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([652, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.03382444381713867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.03382444381713867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 652, 128]), torch.Size([1, 652, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.03444623947143555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.03942060470581055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 652, 128])
m.shape torch.Size([664, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.03974294662475586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.03974294662475586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 664, 128]), torch.Size([1, 664, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04037618637084961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04987478256225586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 664, 128])
m.shape torch.Size([567, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0503692626953125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0503692626953125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 567, 128]), torch.Size([1, 567, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.050909996032714844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.06295394897460938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 567, 128])
m.shape torch.Size([504, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0636448860168457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0636448860168457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 504, 128]), torch.Size([1, 504, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.06412553787231445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0780644416809082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 504, 128])
m.shape torch.Size([385, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.07874202728271484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.07874202728271484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 385, 128]), torch.Size([1, 385, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.07910919189453125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.09232711791992188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 385, 128])
m.shape torch.Size([329, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.09308481216430664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.09308481216430664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 329, 128]), torch.Size([1, 329, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0933985710144043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10689020156860352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 329, 128])
m.shape torch.Size([292, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10770797729492188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10770797729492188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 292, 128]), torch.Size([1, 292, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1079864501953125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.12191009521484375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 292, 128])
m.shape torch.Size([240, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.12268638610839844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.12268638610839844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 240, 128]), torch.Size([1, 240, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.12291526794433594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.13596153259277344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 240, 128])
m.shape torch.Size([218, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.13678264617919922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.13678264617919922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 218, 128]), torch.Size([1, 218, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.13699054718017578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.15029621124267578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 218, 128])
m.shape torch.Size([1712, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.158355712890625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.158355712890625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 856, 128]), torch.Size([1, 856, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.15917205810546875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.21947479248046875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 856, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.21947479248046875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.21947479248046875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 856, 128]), torch.Size([1, 856, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.2202911376953125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.2802848815917969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 856, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.26679277420043945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.2725067138671875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.27781200408935547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.27205657958984375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([5563, 256])
first layer input nodes number: 11518
first layer output nodes number: 5563
edges number: 32642
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.27749109268188477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.2832050323486328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.28412294387817383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.28412294387817383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([467, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3046860694885254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3046860694885254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 467, 256]), torch.Size([1, 467, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.30557680130004883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.31270265579223633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 467, 256])
m.shape torch.Size([404, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3130340576171875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3130340576171875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.31380462646484375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.326326847076416  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([317, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3268556594848633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3268556594848633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 317, 256]), torch.Size([1, 317, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.32746028900146484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3419804573059082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 317, 256])
m.shape torch.Size([258, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3427467346191406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3427467346191406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.34323883056640625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3575096130371094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([206, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.35825395584106445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.35825395584106445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.35864686965942383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.37279176712036133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([149, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.37345457077026367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.37345457077026367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.37373876571655273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3859591484069824  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([117, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.38660430908203125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.38660430908203125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3868274688720703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.39798545837402344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([104, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.39867353439331055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.39867353439331055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.39887189865112305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.41017866134643555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([103, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.41097068786621094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.41097068786621094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4111671447753906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4237403869628906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([65, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4242672920227051  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4242672920227051  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4243912696838379  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4331936836242676  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([74, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4339141845703125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4339141845703125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4340553283691406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4450645446777344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([79, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4459052085876465  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4459052085876465  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.44605588912963867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4588637351989746  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([45, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4593510627746582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4593510627746582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.45943689346313477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4673333168029785  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([37, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4677886962890625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4677886962890625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.46785926818847656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.47484588623046875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.47530078887939453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.47530078887939453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.47536563873291016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4822397232055664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4827456474304199  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4827456474304199  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.48281240463256836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4903559684753418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([42, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4910092353820801  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4910092353820801  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4910893440246582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5007023811340332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5012335777282715  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5012335777282715  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5012965202331543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5092902183532715  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.509697437286377  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.509697437286377  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5097432136535645  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5158772468566895  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([13, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5161046981811523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5161046981811523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5161294937133789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5196256637573242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5199971199035645  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5199971199035645  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5200333595275879  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5253968238830566  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5258016586303711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5258016586303711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5258398056030273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5317525863647461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5322861671447754  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5322861671447754  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5323338508605957  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5400586128234863  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5403809547424316  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5403809547424316  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5404095649719238  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5452446937561035  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([186, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5496997833251953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5496997833251953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5500545501708984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6124935150146484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 186, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5951495170593262  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5955777168273926  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.596005916595459  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5955562591552734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2871, 40])
input nodes number: 5563
output nodes number: 2871
edges number: 20793
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5956358909606934  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5956363677978516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.018243789672851562  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 20 input nodes size: 15073
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.017045974731445312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.017045974731445312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.024233341217041016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.024254322052001953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.01874065399169922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.01928997039794922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.01928997039794922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.01928997039794922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([15073, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.01928997039794922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([491, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04411745071411133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04411745071411133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 491, 128]), torch.Size([1, 491, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0445857048034668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04833173751831055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 491, 128])
m.shape torch.Size([519, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.048592567443847656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.048592567443847656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 519, 128]), torch.Size([1, 519, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0490875244140625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.05753946304321289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 519, 128])
m.shape torch.Size([526, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.05804443359375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.05804443359375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 526, 128]), torch.Size([1, 526, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.05854606628417969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.06958198547363281  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 526, 128])
m.shape torch.Size([461, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.07021045684814453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.07021045684814453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 461, 128]), torch.Size([1, 461, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.07065010070800781  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08339977264404297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 461, 128])
m.shape torch.Size([457, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08487939834594727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08487939834594727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 457, 128]), torch.Size([1, 457, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08531522750854492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10100507736206055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 457, 128])
m.shape torch.Size([372, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1018514633178711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1018514633178711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 372, 128]), torch.Size([1, 372, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10220623016357422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1174612045288086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 372, 128])
m.shape torch.Size([375, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.11853551864624023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.11853551864624023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 375, 128]), torch.Size([1, 375, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.11889314651489258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.13677453994750977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 375, 128])
m.shape torch.Size([332, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1378622055053711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1378622055053711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 332, 128]), torch.Size([1, 332, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.13817882537841797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.15622615814208984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 332, 128])
m.shape torch.Size([263, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1571965217590332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1571965217590332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 263, 128]), torch.Size([1, 263, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.15744733810424805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.17349958419799805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 263, 128])
m.shape torch.Size([3310, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.18915748596191406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.18915748596191406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1655, 128]), torch.Size([1, 1655, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1907358169555664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.30349159240722656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 1655, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.30349159240722656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.30349159240722656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1655, 128]), torch.Size([1, 1655, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3050699234008789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4175248146057129  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 1655, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.39639854431152344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.40317535400390625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.40995216369628906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4031219482421875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([7106, 256])
first layer input nodes number: 15073
first layer output nodes number: 7106
edges number: 50216
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4100666046142578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4168434143066406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4186382293701172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4186382293701172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([373, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.44156455993652344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.44156455993652344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 373, 256]), torch.Size([1, 373, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4422760009765625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.45044517517089844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 373, 256])
m.shape torch.Size([318, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4507007598876953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4507007598876953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4513072967529297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4625120162963867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([277, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.46300745010375977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.46300745010375977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.46353578567504883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.47596311569213867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 277, 256])
m.shape torch.Size([224, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.476560115814209  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.476560115814209  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.476987361907959  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.489377498626709  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([192, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.49008655548095703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.49008655548095703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.49045276641845703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.503636360168457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([145, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5042896270751953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5042896270751953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5045661926269531  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5164585113525391  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([143, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5172824859619141  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5172824859619141  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5175552368164062  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5311927795410156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([122, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5319948196411133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5319948196411133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5322275161743164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5454912185668945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5461797714233398  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5461797714233398  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5463571548461914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5577096939086914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([81, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5583996772766113  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5583996772766113  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5585541725158691  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5695233345031738  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([96, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5704994201660156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5704994201660156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5706825256347656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5849647521972656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([61, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5855770111083984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5855770111083984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.585693359375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5955829620361328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([62, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5962996482849121  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5962996482849121  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5964179039001465  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.607297420501709  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([65, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6081132888793945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6081132888793945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6082372665405273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6205110549926758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([53, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.621213436126709  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.621213436126709  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.621314525604248  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6320300102233887  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([53, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6327948570251465  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6327948570251465  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6328959465026855  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6443190574645996  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6448731422424316  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6448731422424316  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6449437141418457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6534123420715332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6538791656494141  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6538791656494141  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6539344787597656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6609592437744141  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6613335609436035  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6613335609436035  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6613755226135254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6669983863830566  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6675353050231934  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6675353050231934  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6675906181335449  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6753897666931152  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6759276390075684  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6759276390075684  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6759810447692871  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6838850975036621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6842179298400879  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6842179298400879  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6842503547668457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6892762184143066  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6898126602172852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6898126602172852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6898603439331055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6975851058959961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6980228424072266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6980228424072266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6980609893798828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7045078277587891  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([234, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7101116180419922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7101116180419922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7105579376220703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7891101837158203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 234, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7692155838012695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7696328163146973  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.770050048828125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7696118354797363  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2799, 40])
input nodes number: 7106
output nodes number: 2799
edges number: 23353
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7696752548217773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7696757316589355  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.020307064056396484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 21 input nodes size: 15472
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.018729686737060547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.018729686737060547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.026107311248779297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.02612924575805664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0189208984375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.01950550079345703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.01950550079345703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.01950550079345703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([15472, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.01950550079345703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([510, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04582786560058594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04582786560058594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 510, 128]), torch.Size([1, 510, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.046314239501953125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.050205230712890625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 510, 128])
m.shape torch.Size([605, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.05053901672363281  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.05053901672363281  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 605, 128]), torch.Size([1, 605, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.051115989685058594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.060649871826171875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 605, 128])
m.shape torch.Size([596, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.06121397018432617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.06121397018432617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 596, 128]), torch.Size([1, 596, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0617823600769043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.07458639144897461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 596, 128])
m.shape torch.Size([543, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.07533788681030273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.07533788681030273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 543, 128]), torch.Size([1, 543, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.07585573196411133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.09099721908569336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 543, 128])
m.shape torch.Size([539, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.09202337265014648  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.09202337265014648  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 539, 128]), torch.Size([1, 539, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.09253740310668945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.11116504669189453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 539, 128])
m.shape torch.Size([455, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.11220979690551758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.11220979690551758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 455, 128]), torch.Size([1, 455, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.11264371871948242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1313023567199707  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 455, 128])
m.shape torch.Size([398, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1324138641357422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1324138641357422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 398, 128]), torch.Size([1, 398, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.13279342651367188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.15177154541015625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 398, 128])
m.shape torch.Size([363, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.15296649932861328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.15296649932861328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 363, 128]), torch.Size([1, 363, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.15331268310546875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.17304515838623047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 363, 128])
m.shape torch.Size([332, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.17429685592651367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.17429685592651367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 332, 128]), torch.Size([1, 332, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.17461347579956055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.19487714767456055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 332, 128])
m.shape torch.Size([3324, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.21056890487670898  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.21056890487670898  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1662, 128]), torch.Size([1, 1662, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.21215391159057617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3246893882751465  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 1662, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3246893882751465  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3246893882751465  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1662, 128]), torch.Size([1, 1662, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.32627439498901367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4400620460510254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 1662, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.41738414764404297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4246940612792969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4320039749145508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4246368408203125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([7665, 256])
first layer input nodes number: 15472
first layer output nodes number: 7665
edges number: 53023
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.43212127685546875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.43943119049072266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.44165754318237305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.44165754318237305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([331, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.46640920639038086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.46640920639038086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 331, 256]), torch.Size([1, 331, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4670405387878418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.472567081451416  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 331, 256])
m.shape torch.Size([314, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4728550910949707  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4728550910949707  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.47345399856567383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.48351430892944336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 314, 256])
m.shape torch.Size([280, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4840226173400879  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4840226173400879  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4845566749572754  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.49723243713378906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 280, 256])
m.shape torch.Size([233, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.497861385345459  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.497861385345459  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4983057975769043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5111937522888184  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([210, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5126867294311523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5126867294311523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.513087272644043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5275068283081055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([161, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5282354354858398  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5282354354858398  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5285425186157227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5417470932006836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([139, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5425291061401367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5425291061401367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5427942276000977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5560503005981445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([125, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5568790435791016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5568790435791016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5571174621582031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5707073211669922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([121, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5716352462768555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5716352462768555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5718660354614258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5866365432739258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([103, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5875210762023926  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5875210762023926  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5877175331115723  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6016659736633301  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([69, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.602297306060791  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.602297306060791  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6024289131164551  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.612694263458252  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([70, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.613436222076416  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.613436222076416  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6135697364807129  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6249184608459473  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([61, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6256141662597656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6256141662597656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6257305145263672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6364345550537109  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([62, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6372108459472656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6372108459472656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6373291015625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6490364074707031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([49, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.649683952331543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.649683952331543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6497774124145508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6596841812133789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([29, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6600837707519531  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6600837707519531  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6601390838623047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6663894653320312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([48, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6671462059020996  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6671462059020996  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6672377586364746  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6782240867614746  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6787147521972656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6787147521972656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6787738800048828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6862831115722656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6866922378540039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6866922378540039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6867380142211914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6928720474243164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([40, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6936182975769043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6936182975769043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6936945915222168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7044520378112793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7049994468688965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7049994468688965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.705054759979248  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7132411003112793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7135519981384277  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7135519981384277  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7135825157165527  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7183127403259277  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7186737060546875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7186737060546875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7187061309814453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7239589691162109  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7243118286132812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7243118286132812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7243423461914062  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7294998168945312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([305, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7368135452270508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7368135452270508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7373952865600586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.8436069488525391  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 305, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.821876049041748  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.8223056793212891  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.8227353096008301  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.8222837448120117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2883, 40])
input nodes number: 7665
output nodes number: 2883
edges number: 25289
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.8223752975463867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.8223757743835449  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.020611286163330078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 22 input nodes size: 15313
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.01893329620361328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.01893329620361328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.026235103607177734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.026256084442138672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.018856525421142578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.019360065460205078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.019360065460205078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.019360065460205078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([15313, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.019360065460205078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([555, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04205799102783203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04205799102783203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 555, 128]), torch.Size([1, 555, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0425872802734375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.047369956970214844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 555, 128])
m.shape torch.Size([530, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04761075973510742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04761075973510742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 530, 128]), torch.Size([1, 530, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.048116207122802734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.055975914001464844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 530, 128])
m.shape torch.Size([548, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.056507110595703125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.056507110595703125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 548, 128]), torch.Size([1, 548, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.05702972412109375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.06888580322265625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 548, 128])
m.shape torch.Size([512, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.06960105895996094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.06960105895996094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 512, 128]), torch.Size([1, 512, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.07008934020996094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08424949645996094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 512, 128])
m.shape torch.Size([450, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08507823944091797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08507823944091797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 450, 128]), torch.Size([1, 450, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08550739288330078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10095691680908203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 450, 128])
m.shape torch.Size([389, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10185527801513672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10185527801513672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 389, 128]), torch.Size([1, 389, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10222625732421875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1181783676147461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 389, 128])
m.shape torch.Size([357, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.11918449401855469  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.11918449401855469  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 357, 128]), torch.Size([1, 357, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.11952495574951172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.13654804229736328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 357, 128])
m.shape torch.Size([328, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.13762903213500977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.13762903213500977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 328, 128]), torch.Size([1, 328, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.13794183731079102  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.15577173233032227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 328, 128])
m.shape torch.Size([262, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1567397117614746  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1567397117614746  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 262, 128]), torch.Size([1, 262, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.15698957443237305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.17298078536987305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 262, 128])
m.shape torch.Size([2841, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.18652772903442383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.18652772903442383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1420, 128]), torch.Size([1, 1420, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1878819465637207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.2870755195617676  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 1420, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.2870755195617676  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.2870755195617676  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1421, 128]), torch.Size([1, 1421, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.28843069076538086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3842148780822754  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 1421, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3648409843444824  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.37129926681518555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.37775754928588867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.371248722076416  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([6772, 256])
first layer input nodes number: 15313
first layer output nodes number: 6772
edges number: 45782
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.37787389755249023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.384488582611084  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.38640546798706055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.38640546798706055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([416, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.40857458114624023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.40857458114624023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.40936803817749023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.416257381439209  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 416, 256])
m.shape torch.Size([318, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4164719581604004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4164719581604004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.41707849502563477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.42682886123657227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([306, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.42740821838378906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.42740821838378906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4279918670654297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.44161033630371094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([227, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.44219160079956055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.44219160079956055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.442624568939209  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.45518064498901367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([189, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4558725357055664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4558725357055664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.45623302459716797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4692106246948242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([154, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.46991872787475586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.46991872787475586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.470212459564209  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.48284292221069336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([134, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4835977554321289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4835977554321289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4838533401489258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.49663257598876953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([110, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.49735069274902344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.49735069274902344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4975605010986328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5095195770263672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([92, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5102105140686035  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5102105140686035  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5103859901428223  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5216164588928223  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([93, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5224227905273438  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5224227905273438  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5226001739501953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5351943969726562  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([80, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5359516143798828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5359516143798828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5361042022705078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5480060577392578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([58, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5485987663269043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5485987663269043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5487093925476074  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.558112621307373  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5586695671081543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5586695671081543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5587630271911621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5673613548278809  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5679202079772949  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5679202079772949  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5680060386657715  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5765032768249512  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([47, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5771384239196777  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5771384239196777  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5772280693054199  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5867304801940918  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([29, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5871319770812988  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5871319770812988  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5871872901916504  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.593437671661377  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5940146446228027  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5940146446228027  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5940852165222168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6025538444519043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6030206680297852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6030206680297852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6030759811401367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6101007461547852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6105847358703613  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6105847358703613  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6106381416320801  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6177945137023926  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6183061599731445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6183061599731445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6183595657348633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.625889778137207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6262264251708984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6262264251708984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6262607574462891  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6313419342041016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6316208839416504  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6316208839416504  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6316475868225098  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6357865333557129  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6360831260681152  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6360831260681152  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6361098289489746  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6404356956481934  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6407685279846191  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6407685279846191  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6407971382141113  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.645632266998291  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([228, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6510968208312988  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6510968208312988  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6515316963195801  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7280697822570801  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 228, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.708928108215332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7093391418457031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7097501754760742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7093181610107422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2758, 40])
input nodes number: 6772
output nodes number: 2758
edges number: 21646
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7093710899353027  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7093715667724609  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.02030467987060547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 23 input nodes size: 19053
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.018837928771972656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.018837928771972656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.027923107147216797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.027944087982177734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.020621299743652344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.02114105224609375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.02114105224609375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.02114105224609375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([19053, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.02114105224609375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([799, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04584836959838867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04584836959838867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 799, 128]), torch.Size([1, 799, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.046610355377197266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.05291748046875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 799, 128])
m.shape torch.Size([822, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.05332040786743164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.05332040786743164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 822, 128]), torch.Size([1, 822, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.05410432815551758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0666508674621582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 822, 128])
m.shape torch.Size([723, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0673685073852539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0673685073852539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 723, 128]), torch.Size([1, 723, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.06805801391601562  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08391380310058594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 723, 128])
m.shape torch.Size([599, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08471155166625977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08471155166625977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 599, 128]), torch.Size([1, 599, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08528280258178711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10190629959106445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 599, 128])
m.shape torch.Size([522, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10286521911621094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10286521911621094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 522, 128]), torch.Size([1, 522, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.103363037109375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.12221050262451172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 522, 128])
m.shape torch.Size([468, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.12372398376464844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.12372398376464844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 468, 128]), torch.Size([1, 468, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.12417030334472656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.14336204528808594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 468, 128])
m.shape torch.Size([359, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.14433717727661133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.14433717727661133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 359, 128]), torch.Size([1, 359, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.14467954635620117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.16179800033569336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 359, 128])
m.shape torch.Size([351, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1629657745361328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1629657745361328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 351, 128]), torch.Size([1, 351, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1633005142211914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.18238067626953125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 351, 128])
m.shape torch.Size([288, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.18344926834106445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.18344926834106445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 288, 128]), torch.Size([1, 288, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.18372392654418945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.20130205154418945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 288, 128])
m.shape torch.Size([2927, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.21512174606323242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.21512174606323242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1463, 128]), torch.Size([1, 1463, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.21651697158813477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.31557798385620117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 1463, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.31557798385620117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.31557798385620117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1464, 128]), torch.Size([1, 1464, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3169741630554199  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4162330627441406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 1464, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.39547252655029297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4029664993286133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4104604721069336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4029078483581543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([7858, 256])
first layer input nodes number: 19053
first layer output nodes number: 7858
edges number: 49609
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.41060447692871094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.41809844970703125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4206085205078125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4206085205078125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([521, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.440915584564209  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.440915584564209  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 521, 256]), torch.Size([1, 521, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4419093132019043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.45142698287963867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 521, 256])
m.shape torch.Size([436, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4517683982849121  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4517683982849121  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 436, 256]), torch.Size([1, 436, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.45260000228881836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.46593523025512695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 436, 256])
m.shape torch.Size([331, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4664740562438965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4664740562438965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 331, 256]), torch.Size([1, 331, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4671053886413574  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4817628860473633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 331, 256])
m.shape torch.Size([237, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.482358455657959  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.482358455657959  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.48281049728393555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.49591970443725586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([168, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.49650144577026367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.49650144577026367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.49682188034057617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5083575248718262  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([150, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5090627670288086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5090627670288086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5093488693237305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5216512680053711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([108, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5222349166870117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5222349166870117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5224409103393555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.532740592956543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([88, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5333142280578613  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5333142280578613  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5334820747375488  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5430493354797363  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([81, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5436663627624512  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5436663627624512  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.543820858001709  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.553708553314209  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([64, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5542464256286621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5542464256286621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5543684959411621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5630354881286621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([55, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5635561943054199  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5635561943054199  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5636610984802246  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5718436241149902  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([48, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5723447799682617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5723447799682617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5724363327026367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5802183151245117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([40, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5806727409362793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5806727409362793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5807490348815918  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5877680778503418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([25, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.588066577911377  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.588066577911377  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5881142616271973  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5928349494934082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([33, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5932869911193848  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5932869911193848  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5933499336242676  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6000218391418457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([27, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6004056930541992  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6004056930541992  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6004571914672852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6062765121459961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.606757640838623  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.606757640838623  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6068167686462402  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6139121055603027  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.614384651184082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.614384651184082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6144399642944336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.621464729309082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6219668388366699  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6219668388366699  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6220221519470215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6294341087341309  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6298103332519531  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6298103332519531  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6298503875732422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.635498046875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6360635757446289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6360635757446289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6361188888549805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6443052291870117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6445527076721191  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6445527076721191  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6445775032043457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6484208106994629  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6488509178161621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6488509178161621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6488890647888184  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6550688743591309  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6553268432617188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6553268432617188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6553497314453125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6592178344726562  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([217, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6644206047058105  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6644206047058105  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6648344993591309  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7376799583435059  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 217, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7205519676208496  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7209715843200684  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7213912010192871  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7209506034851074  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2813, 40])
input nodes number: 7858
output nodes number: 2813
edges number: 19969
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.721038818359375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7210392951965332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.022169113159179688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 24 input nodes size: 8710
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0206298828125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0206298828125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.02478313446044922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.024805068969726562  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.015698909759521484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.016006946563720703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.016006946563720703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.016006946563720703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([8710, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.016006946563720703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([759, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.02885913848876953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.02885913848876953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 759, 128]), torch.Size([1, 759, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.029582977294921875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.035497188568115234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 759, 128])
m.shape torch.Size([784, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.03588294982910156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.03588294982910156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 784, 128]), torch.Size([1, 784, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.03663063049316406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04802989959716797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 784, 128])
m.shape torch.Size([670, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.048614501953125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.048614501953125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 670, 128]), torch.Size([1, 670, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04925346374511719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.06415367126464844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 670, 128])
m.shape torch.Size([524, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0648336410522461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0648336410522461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 524, 128]), torch.Size([1, 524, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.06533336639404297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08043575286865234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 524, 128])
m.shape torch.Size([469, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08130407333374023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08130407333374023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 469, 128]), torch.Size([1, 469, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08175134658813477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.09785318374633789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 469, 128])
m.shape torch.Size([363, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.09866809844970703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.09866809844970703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 363, 128]), torch.Size([1, 363, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0990142822265625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.11390018463134766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 363, 128])
m.shape torch.Size([295, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.11471176147460938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.11471176147460938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 295, 128]), torch.Size([1, 295, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.11499309539794922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1290597915649414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 295, 128])
m.shape torch.Size([239, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.12983083724975586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.12983083724975586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 239, 128]), torch.Size([1, 239, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.13005876541137695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1430506706237793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 239, 128])
m.shape torch.Size([186, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.14373493194580078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.14373493194580078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 186, 128]), torch.Size([1, 186, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.14391231536865234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.15526485443115234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 186, 128])
m.shape torch.Size([877, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.15935802459716797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.15935802459716797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 438, 128]), torch.Size([1, 438, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1597757339477539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.18943309783935547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 438, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.18943309783935547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.18943309783935547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 439, 128]), torch.Size([1, 439, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1898517608642578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.21936798095703125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 439, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.2095651626586914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.2144918441772461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.21941852569580078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.21445322036743164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([5166, 256])
first layer input nodes number: 8710
first layer output nodes number: 5166
edges number: 25377
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.21948575973510742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.2244124412536621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.22599363327026367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.22599363327026367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([513, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.24236392974853516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.24236392974853516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 513, 256]), torch.Size([1, 513, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.24334239959716797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.2519669532775879  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 513, 256])
m.shape torch.Size([469, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.2523794174194336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.2523794174194336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 469, 256]), torch.Size([1, 469, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.25327396392822266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.2667684555053711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 469, 256])
m.shape torch.Size([390, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.26751089096069336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.26751089096069336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 390, 256]), torch.Size([1, 390, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.26825475692749023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.285184383392334  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 390, 256])
m.shape torch.Size([262, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.28582000732421875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.28582000732421875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.2863197326660156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.30104827880859375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([257, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3020339012145996  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3020339012145996  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3025240898132324  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.32071924209594727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([175, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3214836120605469  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3214836120605469  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.32181739807128906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3361701965332031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([145, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3369789123535156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3369789123535156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.33725547790527344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.35108375549316406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([126, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3519144058227539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3519144058227539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3521547317504883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.36585330963134766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([94, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.366546630859375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.366546630859375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3667259216308594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3782005310058594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([71, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.37879371643066406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.37879371643066406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.37892913818359375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.38854408264160156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([54, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.38904762268066406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.38904762268066406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.38915061950683594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3971843719482422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([66, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.39789438247680664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.39789438247680664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.39802026748657227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4087204933166504  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([39, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.40914487838745117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.40914487838745117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.40921926498413086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4160628318786621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([40, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4165639877319336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4165639877319336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4166402816772461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4241933822631836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.42471790313720703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.42471790313720703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4247922897338867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4326772689819336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([29, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4330863952636719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4330863952636719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.43314170837402344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.43939208984375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([22, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4397239685058594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4397239685058594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.43976593017578125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.44480133056640625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([12, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4449882507324219  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4449882507324219  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4450111389160156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4479179382324219  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([9, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4480710029602051  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4480710029602051  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4480881690979004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.45038843154907227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4505147933959961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4505147933959961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4505281448364258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4524106979370117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([15, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.45270681381225586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.45270681381225586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.45273542404174805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4569697380065918  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.45708274841308594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.45708274841308594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4570941925048828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.45886802673339844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([5, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4589729309082031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4589729309082031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4589824676513672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4605274200439453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.46073055267333984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.46073055267333984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.46074771881103516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.46364879608154297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([43, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4646735191345215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4646735191345215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4647555351257324  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4791903495788574  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 43, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.46620845794677734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4666404724121094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4670724868774414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.46661853790283203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2897, 40])
input nodes number: 5166
output nodes number: 2897
edges number: 15839
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4666914939880371  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4666919708251953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.016660213470458984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 25 input nodes size: 11664
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.015711307525634766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.015711307525634766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.021273136138916016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.02129507064819336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.017119884490966797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.017473697662353516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.017473697662353516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.017473697662353516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([11664, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.017473697662353516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([723, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.03279447555541992  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.03279447555541992  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 723, 128]), torch.Size([1, 723, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.03348398208618164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.039624691009521484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 723, 128])
m.shape torch.Size([795, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.040038108825683594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.040038108825683594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 795, 128]), torch.Size([1, 795, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04079627990722656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.052168846130371094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 795, 128])
m.shape torch.Size([651, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.05272102355957031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.05272102355957031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 651, 128]), torch.Size([1, 651, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.05334186553955078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.067291259765625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 651, 128])
m.shape torch.Size([570, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.06807565689086914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.06807565689086914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 570, 128]), torch.Size([1, 570, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0686192512512207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08438348770141602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 570, 128])
m.shape torch.Size([447, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08604574203491211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08604574203491211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 447, 128]), torch.Size([1, 447, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0864720344543457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10181856155395508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 447, 128])
m.shape torch.Size([380, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1026926040649414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1026926040649414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 380, 128]), torch.Size([1, 380, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10305500030517578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1186380386352539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 380, 128])
m.shape torch.Size([319, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1195216178894043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1195216178894043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 319, 128]), torch.Size([1, 319, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.11982583999633789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.13503694534301758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 319, 128])
m.shape torch.Size([256, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.13586139678955078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.13586139678955078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 256, 128]), torch.Size([1, 256, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.13610553741455078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.15002155303955078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 256, 128])
m.shape torch.Size([210, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1508007049560547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1508007049560547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 210, 128]), torch.Size([1, 210, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1510009765625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.163818359375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 210, 128])
m.shape torch.Size([1324, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.17003154754638672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.17003154754638672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 662, 128]), torch.Size([1, 662, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.17066287994384766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.21657037734985352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 662, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.21657037734985352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.21657037734985352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 662, 128]), torch.Size([1, 662, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.21720170974731445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.26171064376831055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 662, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.24945926666259766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.25501298904418945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.2604250907897949  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.25482892990112305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([5675, 256])
first layer input nodes number: 11664
first layer output nodes number: 5675
edges number: 30472
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.2603726387023926  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.2659263610839844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.26809263229370117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.26809263229370117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([520, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.28489017486572266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.28489017486572266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 520, 256]), torch.Size([1, 520, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.28588199615478516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.2945389747619629  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 520, 256])
m.shape torch.Size([490, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.294985294342041  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.294985294342041  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 490, 256]), torch.Size([1, 490, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.29591989517211914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3108057975769043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 490, 256])
m.shape torch.Size([343, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3113536834716797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3113536834716797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 343, 256]), torch.Size([1, 343, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3120079040527344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3274359703063965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 343, 256])
m.shape torch.Size([285, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3282046318054199  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3282046318054199  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3287482261657715  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3453211784362793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([237, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3461885452270508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3461885452270508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.34664058685302734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3629140853881836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([184, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.36374950408935547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.36374950408935547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.36410045623779297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.37919139862060547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([147, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3800692558288574  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3800692558288574  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.38034963607788086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.39436864852905273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([110, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.39507436752319336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.39507436752319336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.39528417587280273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4072432518005371  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([82, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.40784788131713867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.40784788131713867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4080042839050293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4180140495300293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([86, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4187626838684082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4187626838684082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4189267158508301  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4305729866027832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4311256408691406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4311256408691406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4312400817871094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4401664733886719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([48, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.44066286087036133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.44066286087036133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.44075441360473633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.44853639602661133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([35, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4489283561706543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4489283561706543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.44899511337280273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.455136775970459  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([36, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.45558786392211914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.45558786392211914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4556565284729004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.46245431900024414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.46291017532348633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.46291017532348633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.46297502517700195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4698491096496582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([26, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4702167510986328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4702167510986328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.47026634216308594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.47587013244628906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4762868881225586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4762868881225586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.47633838653564453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.48251819610595703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([20, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.48283863067626953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.48283863067626953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4828767776489258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.48772144317626953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([16, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4879946708679199  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4879946708679199  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4880251884460449  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4921145439147949  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([11, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4923110008239746  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4923110008239746  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.49233198165893555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.49529027938842773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([9, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.49546146392822266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.49546146392822266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.49547863006591797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4980192184448242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.49817991256713867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.49817991256713867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.49819517135620117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5005602836608887  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5007295608520508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5007295608520508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5007448196411133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5032167434692383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5033936500549316  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5033936500549316  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5034089088439941  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5059876441955566  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([86, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5080466270446777  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5080466270446777  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5082106590270996  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5370802879333496  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 86, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5236625671386719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5240974426269531  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5245323181152344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5240755081176758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2916, 40])
input nodes number: 5675
output nodes number: 2916
edges number: 16820
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5241427421569824  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5241432189941406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.018204212188720703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 26 input nodes size: 12041
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.017122745513916016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.017122745513916016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.022864341735839844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.022886276245117188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.017302513122558594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0177154541015625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0177154541015625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0177154541015625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([12041, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0177154541015625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([685, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.036127567291259766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.036127567291259766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 685, 128]), torch.Size([1, 685, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.03678083419799805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0420069694519043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 685, 128])
m.shape torch.Size([681, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04232978820800781  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04232978820800781  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 681, 128]), torch.Size([1, 681, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04297924041748047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.053479671478271484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 681, 128])
m.shape torch.Size([651, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.05408620834350586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.05408620834350586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 651, 128]), torch.Size([1, 651, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.05470705032348633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.06862306594848633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 651, 128])
m.shape torch.Size([585, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0694284439086914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0694284439086914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 585, 128]), torch.Size([1, 585, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.06998634338378906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0861654281616211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 585, 128])
m.shape torch.Size([491, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08756303787231445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08756303787231445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 491, 128]), torch.Size([1, 491, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08803129196166992  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1048884391784668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 491, 128])
m.shape torch.Size([393, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10577869415283203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10577869415283203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 393, 128]), torch.Size([1, 393, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10615348815917969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1222696304321289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 393, 128])
m.shape torch.Size([339, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1232137680053711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1232137680053711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 339, 128]), torch.Size([1, 339, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.12353706359863281  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.13970184326171875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 339, 128])
m.shape torch.Size([308, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1407151222229004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1407151222229004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 308, 128]), torch.Size([1, 308, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.14100885391235352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.15775156021118164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 308, 128])
m.shape torch.Size([272, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.15877199172973633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.15877199172973633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 272, 128]), torch.Size([1, 272, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.15903139114379883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.17563295364379883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 272, 128])
m.shape torch.Size([1743, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.18381452560424805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.18381452560424805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 871, 128]), torch.Size([1, 871, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1846451759338379  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.24532604217529297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 871, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.24532604217529297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.24532604217529297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 872, 128]), torch.Size([1, 872, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.24615764617919922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.30588483810424805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 872, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.2906990051269531  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.29656219482421875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3024253845214844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.29651594161987305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([6148, 256])
first layer input nodes number: 12041
first layer output nodes number: 6148
edges number: 35868
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3025174140930176  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3083806037902832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3098464012145996  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3098464012145996  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([449, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.32906675338745117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.32906675338745117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 449, 256]), torch.Size([1, 449, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.329923152923584  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3367743492126465  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 449, 256])
m.shape torch.Size([391, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3370981216430664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3370981216430664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 391, 256]), torch.Size([1, 391, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3378438949584961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.34996509552001953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 391, 256])
m.shape torch.Size([334, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.350555419921875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.350555419921875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 334, 256]), torch.Size([1, 334, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3511924743652344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3652076721191406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 334, 256])
m.shape torch.Size([278, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3661165237426758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3661165237426758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.36664676666259766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3825054168701172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([212, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3832688331604004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3832688331604004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.38367319107055664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.39823007583618164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([184, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.39908933639526367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.39908933639526367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.39944028854370117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.41453123092651367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([161, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4154391288757324  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4154391288757324  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.41574621200561523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.43110036849975586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([132, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.43198490142822266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.43198490142822266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4322366714477539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.44658756256103516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([114, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.44751691818237305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.44751691818237305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.44773435592651367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.46165037155151367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([93, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4624357223510742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4624357223510742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4626131057739258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4752073287963867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4758272171020508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4758272171020508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4759550094604492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.48592281341552734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([66, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4866204261779785  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4866204261779785  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.48674631118774414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.49744653701782227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([65, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4981961250305176  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4981961250305176  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4983201026916504  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5097260475158691  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([49, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5103235244750977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5103235244750977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5104169845581055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5196695327758789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5202574729919434  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5202574729919434  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5203413963317871  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5292372703552246  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5296874046325684  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5296874046325684  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5297484397888184  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5366454124450684  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5370726585388184  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5370726585388184  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5371260643005371  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5435347557067871  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5439410209655762  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5439410209655762  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5439887046813965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5500445365905762  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5504045486450195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5504045486450195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5504446029663086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.555811882019043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([20, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5561766624450684  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5561766624450684  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5562148094177246  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5615935325622559  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5619583129882812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5619583129882812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5619945526123047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5673580169677734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5676994323730469  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5676994323730469  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5677318572998047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5727577209472656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5730953216552734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5730953216552734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5731258392333984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5780696868896484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5783085823059082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5783085823059082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5783295631408691  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5818753242492676  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([96, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5841717720031738  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5841717720031738  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5843548774719238  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6165814399719238  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 96, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6006898880004883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6011257171630859  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6015615463256836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6011037826538086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2924, 40])
input nodes number: 6148
output nodes number: 2924
edges number: 19410
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.601172924041748  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6011734008789062  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.01853656768798828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 27 input nodes size: 15298
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.017303466796875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.017303466796875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.024598121643066406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.024619579315185547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.018856048583984375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.01933002471923828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.01933002471923828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.01933002471923828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([15298, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.01933002471923828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([637, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0404815673828125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0404815673828125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 637, 128]), torch.Size([1, 637, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04108905792236328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04672813415527344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 637, 128])
m.shape torch.Size([704, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04709577560424805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04709577560424805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 704, 128]), torch.Size([1, 704, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04776716232299805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.05783796310424805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 704, 128])
m.shape torch.Size([621, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.05839061737060547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.05839061737060547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 621, 128]), torch.Size([1, 621, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.05898284912109375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.07214689254760742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 621, 128])
m.shape torch.Size([549, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.07289791107177734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.07289791107177734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 549, 128]), torch.Size([1, 549, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.07342147827148438  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08916568756103516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 549, 128])
m.shape torch.Size([491, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.09007453918457031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.09007453918457031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 491, 128]), torch.Size([1, 491, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.09054279327392578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10739994049072266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 491, 128])
m.shape torch.Size([442, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10933685302734375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10933685302734375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 442, 128]), torch.Size([1, 442, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10975837707519531  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1278839111328125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 442, 128])
m.shape torch.Size([380, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.12894153594970703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.12894153594970703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 380, 128]), torch.Size([1, 380, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1293039321899414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.14742374420166016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 380, 128])
m.shape torch.Size([313, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1484365463256836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1484365463256836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 313, 128]), torch.Size([1, 313, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.14873504638671875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.16574954986572266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 313, 128])
m.shape torch.Size([288, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.16683626174926758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.16683626174926758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 288, 128]), torch.Size([1, 288, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.16711091995239258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.18468904495239258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 288, 128])
m.shape torch.Size([2355, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.19627046585083008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.19627046585083008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1177, 128]), torch.Size([1, 1177, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.19739294052124023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.27789735794067383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 1177, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.27789735794067383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.27789735794067383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1178, 128]), torch.Size([1, 1178, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.2790207862854004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3586101531982422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 1178, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3408775329589844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.34734344482421875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.35394287109375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3474264144897461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([6780, 256])
first layer input nodes number: 15298
first layer output nodes number: 6780
edges number: 42517
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.35405921936035156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.36052513122558594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.36237525939941406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.36237525939941406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([432, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3833475112915039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3833475112915039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 432, 256]), torch.Size([1, 432, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3841714859008789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3917551040649414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 432, 256])
m.shape torch.Size([405, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3921217918395996  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3921217918395996  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 405, 256]), torch.Size([1, 405, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.39289426803588867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4052252769470215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 405, 256])
m.shape torch.Size([295, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.40568971633911133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.40568971633911133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.406252384185791  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4187912940979004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([255, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.41949033737182617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.41949033737182617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.41997671127319336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4340815544128418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([202, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.43480920791625977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.43480920791625977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4351944923400879  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4490647315979004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([155, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4497661590576172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4497661590576172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4500617980957031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.46277427673339844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([154, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.46366262435913086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.46366262435913086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.463956356048584  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.47864294052124023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([114, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4793729782104492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4793729782104492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.47959041595458984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.49198436737060547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([101, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4927496910095215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4927496910095215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.49294233322143555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5052714347839355  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([104, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5061750411987305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5061750411987305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.506373405456543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5204572677612305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([100, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5214157104492188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5214157104492188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5216064453125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5364837646484375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([57, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.537045955657959  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.537045955657959  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5371546745300293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5463957786560059  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5469536781311035  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5469536781311035  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5470471382141113  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5556454658508301  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5561642646789551  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5561642646789551  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5562443733215332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5641751289367676  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5646686553955078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5646686553955078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5647392272949219  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5722198486328125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.572784423828125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.572784423828125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5728588104248047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5812644958496094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([19, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.581538200378418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.581538200378418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5815744400024414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5859231948852539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([23, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5863032341003418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5863032341003418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5863471031188965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5919184684753418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5924081802368164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5924081802368164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5924615859985352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5996179580688477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6000914573669434  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6000914573669434  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6001410484313965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6071333885192871  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([10, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6073107719421387  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6073107719421387  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6073298454284668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6101527214050293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6104817390441895  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6104817390441895  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6105122566223145  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6152424812316895  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6154704093933105  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6154704093933105  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6154913902282715  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6188902854919434  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6192030906677246  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6192030906677246  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.619229793548584  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6237425804138184  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([189, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6282706260681152  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6282706260681152  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6286311149597168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6920771598815918  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 189, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6742939949035645  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6747231483459473  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6751523017883301  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6747016906738281  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2877, 40])
input nodes number: 6780
output nodes number: 2877
edges number: 20879
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.674767017364502  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6747674942016602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.020252227783203125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 28 input nodes size: 19248
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.01884937286376953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.01884937286376953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.02802753448486328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.028049468994140625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.020733356475830078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.021329402923583984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.021329402923583984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.021329402923583984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([19248, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.021329402923583984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([471, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04790687561035156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04790687561035156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 471, 128]), torch.Size([1, 471, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.048356056213378906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.051949501037597656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 471, 128])
m.shape torch.Size([536, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.052236080169677734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.052236080169677734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 536, 128]), torch.Size([1, 536, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.052747249603271484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.06156778335571289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 536, 128])
m.shape torch.Size([521, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0620574951171875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0620574951171875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 521, 128]), torch.Size([1, 521, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.06255435943603516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0741872787475586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 521, 128])
m.shape torch.Size([478, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.07485055923461914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.07485055923461914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 478, 128]), torch.Size([1, 478, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.07530641555786133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08852624893188477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 478, 128])
m.shape torch.Size([478, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08943796157836914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08943796157836914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 478, 128]), torch.Size([1, 478, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08989381790161133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10630464553833008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 478, 128])
m.shape torch.Size([405, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10723543167114258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10723543167114258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 405, 128]), torch.Size([1, 405, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10762166976928711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.12422990798950195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 405, 128])
m.shape torch.Size([381, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.12530851364135742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.12530851364135742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 381, 128]), torch.Size([1, 381, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1256718635559082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.14383935928344727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 381, 128])
m.shape torch.Size([360, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.14503097534179688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.14503097534179688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 360, 128]), torch.Size([1, 360, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.14537429809570312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.16494369506835938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 360, 128])
m.shape torch.Size([303, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.16607236862182617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.16607236862182617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 303, 128]), torch.Size([1, 303, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.16636133193969727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.18485498428344727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 303, 128])
m.shape torch.Size([3571, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.20228862762451172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.20228862762451172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1785, 128]), torch.Size([1, 1785, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.20399093627929688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3251218795776367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 1785, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3251218795776367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3251218795776367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1786, 128]), torch.Size([1, 1786, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3268251419067383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.44695138931274414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 1786, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.42386722564697266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.43102359771728516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.43817996978759766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4309673309326172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([7504, 256])
first layer input nodes number: 19248
first layer output nodes number: 7504
edges number: 53822
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4383254051208496  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4454817771911621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4474806785583496  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4474806785583496  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([311, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4734930992126465  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4734930992126465  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.47408628463745117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.47978734970092773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([345, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.48015403747558594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.48015403747558594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 345, 256]), torch.Size([1, 345, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.48081207275390625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.49168968200683594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 345, 256])
m.shape torch.Size([261, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4921135902404785  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4921135902404785  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4926114082336426  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5051207542419434  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([235, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5057754516601562  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5057754516601562  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5062236785888672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5192222595214844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([202, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5199689865112305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5199689865112305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5203542709350586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5342245101928711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([162, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5349664688110352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5349664688110352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5352754592895508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5485620498657227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([157, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.549464225769043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.549464225769043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5497636795043945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5647363662719727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([138, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.565648078918457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.565648078918457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5659112930297852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5809144973754883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([104, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5816826820373535  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5816826820373535  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.581881046295166  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.594576358795166  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([113, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5961270332336426  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5961270332336426  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5963425636291504  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6116452217102051  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([74, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6123199462890625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6123199462890625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6124610900878906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6234703063964844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([72, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6242303848266602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6242303848266602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6243677139282227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6360406875610352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([63, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6367592811584473  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6367592811584473  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6368794441223145  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6479344367980957  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([61, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6486954689025879  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6486954689025879  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6488118171691895  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6603302955627441  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([60, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.661137580871582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.661137580871582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6612520217895508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6733827590942383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6738791465759277  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6738791465759277  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.673947811126709  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6817069053649902  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6823263168334961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6823263168334961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6824026107788086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6915578842163086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6920561790466309  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6920561790466309  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.692115306854248  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6996245384216309  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7001247406005859  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7001247406005859  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7001800537109375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7075920104980469  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7081413269042969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7081413269042969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7081985473632812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7162666320800781  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([30, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7168436050415039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7168436050415039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7169008255004883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7253694534301758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7259120941162109  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7259120941162109  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7259635925292969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7339458465576172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7341856956481934  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7341856956481934  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7342085838317871  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7379164695739746  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7383203506469727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7383203506469727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7383546829223633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7441568374633789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([316, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7517328262329102  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7517328262329102  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 316, 256]), torch.Size([1, 316, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7523355484008789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.8591470718383789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 316, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.8361730575561523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.8366093635559082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.8370456695556641  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.8365874290466309  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2927, 40])
input nodes number: 7504
output nodes number: 2927
edges number: 26023
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.8366727828979492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.8366732597351074  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.022472381591796875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 29 input nodes size: 23783
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.020740509033203125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.020740509033203125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.032459259033203125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.03248119354248047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.023281097412109375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.02389049530029297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.02389049530029297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.02389049530029297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([23783, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.02389049530029297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([653, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.054286956787109375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.054286956787109375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 653, 128]), torch.Size([1, 653, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.054909706115722656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.059891700744628906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 653, 128])
m.shape torch.Size([747, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.060292720794677734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.060292720794677734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 747, 128]), torch.Size([1, 747, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0610051155090332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.07254934310913086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 747, 128])
m.shape torch.Size([687, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.07317590713500977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.07317590713500977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 687, 128]), torch.Size([1, 687, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.07383108139038086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08838367462158203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 687, 128])
m.shape torch.Size([597, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08919477462768555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08919477462768555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 597, 128]), torch.Size([1, 597, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08976411819458008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10627508163452148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 597, 128])
m.shape torch.Size([604, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10743045806884766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10743045806884766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 604, 128]), torch.Size([1, 604, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10800647735595703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.12894153594970703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 604, 128])
m.shape torch.Size([520, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1301412582397461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1301412582397461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 520, 128]), torch.Size([1, 520, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.13063716888427734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.15304088592529297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 520, 128])
m.shape torch.Size([471, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.15436506271362305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.15436506271362305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 471, 128]), torch.Size([1, 471, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1548142433166504  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.17727327346801758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 471, 128])
m.shape torch.Size([429, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.17868518829345703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.17868518829345703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 429, 128]), torch.Size([1, 429, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1790943145751953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.20241451263427734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 429, 128])
m.shape torch.Size([354, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.20372915267944336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.20372915267944336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 354, 128]), torch.Size([1, 354, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.20406675338745117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.22567319869995117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 354, 128])
m.shape torch.Size([3773, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.24349546432495117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.24349546432495117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1886, 128]), torch.Size([1, 1886, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.24529409408569336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.37299680709838867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 1886, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.37299680709838867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.37299680709838867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1887, 128]), torch.Size([1, 1887, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.37479639053344727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5016674995422363  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 1887, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4755115509033203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.48393726348876953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.49236297607421875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4838709831237793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([8835, 256])
first layer input nodes number: 23783
first layer output nodes number: 8835
edges number: 60381
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4925422668457031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5009679794311523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5036478042602539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5036478042602539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([450, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5247511863708496  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5247511863708496  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 450, 256]), torch.Size([1, 450, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5256094932556152  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5334391593933105  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 450, 256])
m.shape torch.Size([386, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.53375244140625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.53375244140625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 386, 256]), torch.Size([1, 386, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5344886779785156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5459117889404297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 386, 256])
m.shape torch.Size([327, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5464868545532227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5464868545532227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 327, 256]), torch.Size([1, 327, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5471105575561523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5628871917724609  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 327, 256])
m.shape torch.Size([234, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5634751319885254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5634751319885254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5639214515686035  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5768647193908691  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([205, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5776591300964355  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5776591300964355  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5780501365661621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5921263694763184  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([191, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5930418968200684  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5930418968200684  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5934062004089355  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6090712547302246  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([131, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6097707748413086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6097707748413086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.610020637512207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6225137710571289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([122, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6233272552490234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6233272552490234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6235599517822266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6368236541748047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([107, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6376333236694336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6376333236694336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6378374099731445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6508989334106445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([92, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6516814231872559  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6516814231872559  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6518568992614746  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6643157005310059  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([63, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6648941040039062  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6648941040039062  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6650142669677734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6743869781494141  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([70, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6751346588134766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6751346588134766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6752681732177734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6866168975830078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([62, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6873250007629395  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6873250007629395  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6874432563781738  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6983227729797363  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([52, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6989636421203613  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6989636421203613  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6990628242492676  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7088818550109863  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([47, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.709510326385498  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.709510326385498  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7095999717712402  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7191023826599121  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([41, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7196884155273438  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7196884155273438  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7197666168212891  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7286033630371094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7290711402893066  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7290711402893066  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7291302680969238  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7362256050109863  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([23, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7365942001342773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7365942001342773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.736638069152832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7422094345092773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([20, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7425527572631836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7425527572631836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7425909042358398  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7477025985717773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7481451034545898  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7481451034545898  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7481908798217773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7546453475952148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7549457550048828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7549457550048828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7549762725830078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7594928741455078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7598586082458496  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7598586082458496  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7598929405212402  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7652144432067871  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7656173706054688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7656173706054688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7656536102294922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7715244293212891  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7717833518981934  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7717833518981934  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7718062400817871  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7756743431091309  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([184, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7800841331481934  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7800841331481934  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7804350852966309  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.8422026634216309  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 184, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.8243622779846191  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.824798583984375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.8252348899841309  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.8247766494750977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2927, 40])
input nodes number: 8835
output nodes number: 2927
edges number: 21372
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.8248648643493652  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.8248653411865234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.02506875991821289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 30 input nodes size: 18608
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.023281097412109375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.023281097412109375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.032154083251953125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.03217601776123047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.020435333251953125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.02093029022216797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.02093029022216797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.02093029022216797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([18608, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.02093029022216797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([823, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04420042037963867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04420042037963867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 823, 128]), torch.Size([1, 823, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.044985294342041016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.051264286041259766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 823, 128])
m.shape torch.Size([885, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.051715850830078125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.051715850830078125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 885, 128]), torch.Size([1, 885, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.052559852600097656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.06535911560058594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 885, 128])
m.shape torch.Size([767, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.06613922119140625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.06613922119140625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 767, 128]), torch.Size([1, 767, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.06687068939208984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0829629898071289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 767, 128])
m.shape torch.Size([650, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08385038375854492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08385038375854492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 650, 128]), torch.Size([1, 650, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08447027206420898  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10248327255249023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 650, 128])
m.shape torch.Size([538, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10345602035522461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10345602035522461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 538, 128]), torch.Size([1, 538, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10396909713745117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.12392091751098633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 538, 128])
m.shape torch.Size([485, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.12505197525024414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.12505197525024414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 485, 128]), torch.Size([1, 485, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.12551450729370117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.14540338516235352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 485, 128])
m.shape torch.Size([427, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.14659738540649414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.14659738540649414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 427, 128]), torch.Size([1, 427, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1470046043395996  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.16736555099487305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 427, 128])
m.shape torch.Size([363, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1685466766357422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1685466766357422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 363, 128]), torch.Size([1, 363, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.16889286041259766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.18862533569335938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 363, 128])
m.shape torch.Size([306, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.18976545333862305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.18976545333862305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 306, 128]), torch.Size([1, 306, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.19005727767944336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.20873403549194336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 306, 128])
m.shape torch.Size([2489, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.22045660018920898  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.22045660018920898  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1244, 128]), torch.Size([1, 1244, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.22164297103881836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3058919906616211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 1244, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3058919906616211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3058919906616211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1245, 128]), torch.Size([1, 1245, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3070793151855469  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3928098678588867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 1245, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3735184669494629  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3808932304382324  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.38826799392700195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.38083553314208984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([7733, 256])
first layer input nodes number: 18608
first layer output nodes number: 7733
edges number: 46631
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3884086608886719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3957834243774414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3976273536682129  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3976273536682129  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([514, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.41792964935302734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.41792964935302734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 514, 256]), torch.Size([1, 514, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.41891002655029297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4276132583618164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 514, 256])
m.shape torch.Size([427, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4279441833496094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4279441833496094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 427, 256]), torch.Size([1, 427, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4287586212158203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.44199705123901367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 427, 256])
m.shape torch.Size([335, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.44255590438842773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.44255590438842773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 335, 256]), torch.Size([1, 335, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4431948661804199  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.45897722244262695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 335, 256])
m.shape torch.Size([248, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4596114158630371  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4596114158630371  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4600844383239746  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4738020896911621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([199, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.47452211380004883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.47452211380004883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4749016761779785  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.48856592178344727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([188, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.48946046829223633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.48946046829223633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4898190498352051  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5052380561828613  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([129, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5059270858764648  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5059270858764648  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5061731338500977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5184755325317383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([95, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5190830230712891  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5190830230712891  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5192642211914062  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5295925140380859  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([100, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.530367374420166  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.530367374420166  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5305581092834473  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5427651405334473  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([74, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5433812141418457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5433812141418457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5435223579406738  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5535435676574707  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([63, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5541391372680664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5541391372680664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5542593002319336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5636320114135742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([48, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5641255378723145  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5641255378723145  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5642170906066895  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5719990730285645  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([44, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5725030899047852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5725030899047852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5725870132446289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5803079605102539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5807909965515137  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5807909965515137  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5808653831481934  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5882296562194824  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5887980461120605  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5887980461120605  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5888781547546387  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5973696708679199  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([21, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5976529121398926  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5976529121398926  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5976929664611816  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6022191047668457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([24, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6025915145874023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6025915145874023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6026372909545898  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6081304550170898  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([34, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6086959838867188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6086959838867188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6087608337402344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6169967651367188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([18, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6172933578491211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6172933578491211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6173276901245117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6219282150268555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([9, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6220841407775879  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6220841407775879  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6221013069152832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6245217323303223  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6248764991760254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6248764991760254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.624910831451416  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6299920082092285  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6302924156188965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6302924156188965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6303210258483887  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6347556114196777  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6352276802062988  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6352276802062988  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6352696418762207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6420674324035645  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6423463821411133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6423463821411133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6423711776733398  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6465616226196289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([179, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6508502960205078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6508502960205078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6511917114257812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.7112808227539062  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 179, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.694267749786377  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.694699764251709  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.695131778717041  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6946778297424316  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2898, 40])
input nodes number: 7733
output nodes number: 2898
edges number: 19687
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6947531700134277  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6947536468505859  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.02191305160522461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 31 input nodes size: 14128
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.020431041717529297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.020431041717529297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.027167797088623047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.02718973159790039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.018294811248779297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.01875925064086914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.01875925064086914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.01875925064086914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([14128, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.01875925064086914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([622, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.039139747619628906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.039139747619628906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 622, 128]), torch.Size([1, 622, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.039732933044433594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.044478416442871094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 622, 128])
m.shape torch.Size([688, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04483795166015625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04483795166015625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 688, 128]), torch.Size([1, 688, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04549407958984375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.055446624755859375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 688, 128])
m.shape torch.Size([605, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0559840202331543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.0559840202331543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 605, 128]), torch.Size([1, 605, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.05656099319458008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.06979608535766602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 605, 128])
m.shape torch.Size([571, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.07059669494628906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.07059669494628906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 571, 128]), torch.Size([1, 571, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.07114124298095703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08743667602539062  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 571, 128])
m.shape torch.Size([467, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08827781677246094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08827781677246094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 467, 128]), torch.Size([1, 467, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08872318267822266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10475635528564453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 467, 128])
m.shape torch.Size([392, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10642623901367188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10642623901367188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 392, 128]), torch.Size([1, 392, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10680007934570312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.12287521362304688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 392, 128])
m.shape torch.Size([340, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.12382316589355469  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.12382316589355469  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 340, 128]), torch.Size([1, 340, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.12414741516113281  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.14035987854003906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 340, 128])
m.shape torch.Size([349, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.14152908325195312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.14152908325195312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 349, 128]), torch.Size([1, 349, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1418619155883789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.16083335876464844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 349, 128])
m.shape torch.Size([287, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.16189861297607422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.16189861297607422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 287, 128]), torch.Size([1, 287, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1621723175048828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1796894073486328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 287, 128])
m.shape torch.Size([2203, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.19005727767944336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.19005727767944336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1101, 128]), torch.Size([1, 1101, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.19110727310180664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.2656569480895996  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 1101, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.2656569480895996  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.2656569480895996  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1102, 128]), torch.Size([1, 1102, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.2667078971862793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3426237106323242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 1102, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3255491256713867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3317708969116211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.33799266815185547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3317222595214844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([6524, 256])
first layer input nodes number: 14128
first layer output nodes number: 6524
edges number: 40569
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.33809995651245117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3451876640319824  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3460426330566406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3460426330566406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([409, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3682131767272949  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3682131767272949  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 409, 256]), torch.Size([1, 409, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.36899328231811523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.37523412704467773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 409, 256])
m.shape torch.Size([382, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3755784034729004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3755784034729004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 382, 256]), torch.Size([1, 382, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.37630701065063477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3882889747619629  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 382, 256])
m.shape torch.Size([293, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.38876962661743164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.38876962661743164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 293, 256]), torch.Size([1, 293, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3893284797668457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.40204763412475586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 293, 256])
m.shape torch.Size([258, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.40283679962158203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.40283679962158203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.40332889556884766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4180326461791992  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([221, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.41884899139404297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.41884899139404297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.41927051544189453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4344453811645508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([152, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.43511152267456055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.43511152267456055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.43540143966674805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.44786787033081055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([135, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.44863128662109375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.44863128662109375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.44888877868652344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4617633819580078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([149, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4627804756164551  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4627804756164551  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.46306467056274414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4792637825012207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.47994375228881836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.47994375228881836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.48012495040893555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.49172163009643555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([87, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.49246740341186523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.49246740341186523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4926333427429199  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5044150352478027  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5050406455993652  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5050406455993652  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5051684379577637  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5151362419128418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([67, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5158452987670898  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5158452987670898  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5159730911254883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5268354415893555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([68, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5276212692260742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5276212692260742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5277509689331055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5396833419799805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([49, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5402779579162598  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5402779579162598  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5403714179992676  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.549623966217041  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([43, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5501976013183594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5501976013183594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5502796173095703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5589733123779297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5595016479492188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5595016479492188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5595722198486328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5675468444824219  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5680184364318848  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5680184364318848  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.568077564239502  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5751729011535645  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5756278038024902  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5756278038024902  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.575681209564209  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5824637413024902  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5830035209655762  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5830035209655762  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5830626487731934  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5909857749938965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5914368629455566  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5914368629455566  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.591484546661377  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.598207950592041  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5988101959228516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5988101959228516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5988693237304688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6076202392578125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6080136299133301  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6080136299133301  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6080517768859863  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6139645576477051  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes
[04:48:02] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28957872 edges into 32 parts and get 9176149 edge cuts

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6142992973327637  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6142992973327637  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6143298149108887  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6192736625671387  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6195583343505859  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6195583343505859  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6195831298828125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6237735748291016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([179, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6280622482299805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6280622482299805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6284036636352539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6884927749633789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 179, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6695141792297363  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6699442863464355  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6703743934631348  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6699223518371582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2886, 40])
input nodes number: 6524
output nodes number: 2886
edges number: 21677
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6699910163879395  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6699914932250977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.019668102264404297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.019668102264404297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.019668102264404297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008533410727977753 |0.0018842220306396484 |0.11834411323070526 |8.552521467208862e-05 |0.09637632220983505 |0.0045926570892333984 |
----------------------------------------------------------pseudo_mini_loss sum 4.911620140075684
Total (block generation + training)time/epoch 28.719763040542603
* Pure training time/epoch 7.211747646331787
Training time/epoch 7.374476671218872
Training time without block to device /epoch 7.314181566238403
Training time without total dataloading part /epoch 6.87838339805603
load block tensor time/epoch 0.2730691432952881
block to device time/epoch 0.06029510498046875
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1125225
Number of first layer input nodes during this epoch:  807074
Number of first layer output nodes during this epoch:  318151
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.019667625427246094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.018630266189575195
global_2_local spend time (sec) 0.053548574447631836
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0043182373046875
A = g.adjacency_matrix() spent  0.013160467147827148
auxiliary_graph
Graph(num_nodes=154614, num_edges=29048813,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08590245246887207
remove nodes length
63673
auxiliary_graph.remove_nodes spent  1.3035762310028076
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29048813,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.164708137512207

the counter of shared neighbor distribution
Counter({1.0: 23402436, 2.0: 4027368, 3.0: 1011142, 4.0: 307344, 5.0: 112146, 6.0: 48448, 7.0: 22696, 8.0: 11506, 9.0: 6294, 10.0: 3494, 11.0: 1966, 12.0: 1128, 13.0: 656, 14.0: 434, 15.0: 300, 16.0: 212, 17.0: 164, 18.0: 68, 19.0: 54, 20.0: 10, 21.0: 6})
28957872
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28957869, 28957870, 28957871])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23402436, 2.0: 4027368, 3.0: 1011142, 4.0: 307344, 5.0: 112146, 6.0: 48448, 7.0: 22696, 8.0: 11506, 9.0: 6294, 10.0: 3494, 11.0: 1966, 12.0: 1128, 13.0: 656, 14.0: 434, 15.0: 300, 16.0: 212, 17.0: 164, 18.0: 68, 19.0: 54, 20.0: 10, 21.0: 6})
Convert a graph into a bidirected graph: 1.283 seconds
Metis partitioning: 5.569 seconds
Split the graph: 0.654 seconds
Construct subgraphs: 0.090 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  7.608098030090332
2921
2922
2926
2779
2909
2764
2758
2828
2879
2859
2926
2882
2908
2904
2909
2901
2784
2914
2902
2758
2924
2758
2794
2762
2758
2758
2761
2822
2834
2898
2771
2768
total k batches seeds list generation spend  17.798072814941406
after graph partition
graph partition algorithm spend time 17.88434100151062
2921
2922
2926
2779
2909
2764
2758
2828
2879
2859
2926
2882
2908
2904
2909
2901
2784
2914
2902
2758
2924
2758
2794
2762
2758
2758
2761
2822
2834
2898
2771
2768
partition_len_list
[6067, 6451, 7585, 6523, 7730, 8013, 6979, 6962, 7896, 6791, 8209, 5567, 5415, 5188, 5696, 6421, 8351, 6389, 8701, 7671, 9093, 11639, 9943, 14593, 16530, 17036, 18265, 17552, 18373, 18318, 14761, 15047]
shared_neighbor_graph_partition_s0 selection method  spend 17.996244430541992
time for parepare:  0.01746845245361328
local_output_nid generation:  0.0008032321929931641
local_in_edges_tensor generation:  0.0009808540344238281
mini_batch_src_global generation:  0.0011413097381591797
r_  generation:  0.007394313812255859
local_output_nid generation:  0.0008356571197509766
local_in_edges_tensor generation:  0.0008573532104492188
mini_batch_src_global generation:  0.0011527538299560547
r_  generation:  0.007892131805419922
local_output_nid generation:  0.0009052753448486328
local_in_edges_tensor generation:  0.0007929801940917969
mini_batch_src_global generation:  0.0009448528289794922
r_  generation:  0.007435321807861328
local_output_nid generation:  0.0008883476257324219
local_in_edges_tensor generation:  0.0007717609405517578
mini_batch_src_global generation:  0.0008556842803955078
r_  generation:  0.007033586502075195
local_output_nid generation:  0.0009438991546630859
local_in_edges_tensor generation:  0.0007817745208740234
mini_batch_src_global generation:  0.0008499622344970703
r_  generation:  0.007517337799072266
local_output_nid generation:  0.000885009765625
local_in_edges_tensor generation:  0.0007252693176269531
mini_batch_src_global generation:  0.0007493495941162109
r_  generation:  0.006125211715698242
local_output_nid generation:  0.0008854866027832031
local_in_edges_tensor generation:  0.0006823539733886719
mini_batch_src_global generation:  0.0007083415985107422
r_  generation:  0.006631612777709961
local_output_nid generation:  0.0009527206420898438
local_in_edges_tensor generation:  0.0007042884826660156
mini_batch_src_global generation:  0.0007789134979248047
r_  generation:  0.007085084915161133
local_output_nid generation:  0.0009555816650390625
local_in_edges_tensor generation:  0.0007853507995605469
mini_batch_src_global generation:  0.001001119613647461
r_  generation:  0.007115602493286133
local_output_nid generation:  0.0009477138519287109
local_in_edges_tensor generation:  0.0007171630859375
mini_batch_src_global generation:  0.0007224082946777344
r_  generation:  0.00640106201171875
local_output_nid generation:  0.0009737014770507812
local_in_edges_tensor generation:  0.0007190704345703125
mini_batch_src_global generation:  0.0007245540618896484
r_  generation:  0.006539106369018555
local_output_nid generation:  0.0009288787841796875
local_in_edges_tensor generation:  0.0006868839263916016
mini_batch_src_global generation:  0.0006251335144042969
r_  generation:  0.0054700374603271484
local_output_nid generation:  0.0009355545043945312
local_in_edges_tensor generation:  0.0006818771362304688
mini_batch_src_global generation:  0.0005578994750976562
r_  generation:  0.0051271915435791016
local_output_nid generation:  0.0009183883666992188
local_in_edges_tensor generation:  0.0006594657897949219
mini_batch_src_global generation:  0.0005435943603515625
r_  generation:  0.004995107650756836
local_output_nid generation:  0.0009763240814208984
local_in_edges_tensor generation:  0.0006744861602783203
mini_batch_src_global generation:  0.0006256103515625
r_  generation:  0.0059778690338134766
local_output_nid generation:  0.0008940696716308594
local_in_edges_tensor generation:  0.0006704330444335938
mini_batch_src_global generation:  0.0006995201110839844
r_  generation:  0.006411552429199219
local_output_nid generation:  0.0008597373962402344
local_in_edges_tensor generation:  0.0006241798400878906
mini_batch_src_global generation:  0.0006625652313232422
r_  generation:  0.0058286190032958984
local_output_nid generation:  0.0009565353393554688
local_in_edges_tensor generation:  0.0006721019744873047
mini_batch_src_global generation:  0.0006153583526611328
r_  generation:  0.005778312683105469
local_output_nid generation:  0.0009570121765136719
local_in_edges_tensor generation:  0.0006666183471679688
mini_batch_src_global generation:  0.0006792545318603516
r_  generation:  0.006105661392211914
local_output_nid generation:  0.0008912086486816406
local_in_edges_tensor generation:  0.0006392002105712891
mini_batch_src_global generation:  0.0006673336029052734
r_  generation:  0.00483250617980957
local_output_nid generation:  0.0009534358978271484
local_in_edges_tensor generation:  0.0006561279296875
mini_batch_src_global generation:  0.0006415843963623047
r_  generation:  0.0060520172119140625
local_output_nid generation:  0.0008604526519775391
local_in_edges_tensor generation:  0.0006763935089111328
mini_batch_src_global generation:  0.0009343624114990234
r_  generation:  0.0071735382080078125
local_output_nid generation:  0.0008940696716308594
local_in_edges_tensor generation:  0.0006501674652099609
mini_batch_src_global generation:  0.0006682872772216797
r_  generation:  0.005301475524902344
local_output_nid generation:  0.0008881092071533203
local_in_edges_tensor generation:  0.0009069442749023438
mini_batch_src_global generation:  0.0010073184967041016
r_  generation:  0.009445428848266602
local_output_nid generation:  0.0009407997131347656
local_in_edges_tensor generation:  0.0006957054138183594
mini_batch_src_global generation:  0.0010707378387451172
r_  generation:  0.007749080657958984
local_output_nid generation:  0.0009620189666748047
local_in_edges_tensor generation:  0.0007297992706298828
mini_batch_src_global generation:  0.001020669937133789
r_  generation:  0.00905919075012207
local_output_nid generation:  0.0009851455688476562
local_in_edges_tensor generation:  0.0007388591766357422
mini_batch_src_global generation:  0.0011444091796875
r_  generation:  0.011299848556518555
local_output_nid generation:  0.0010695457458496094
local_in_edges_tensor generation:  0.0008058547973632812
mini_batch_src_global generation:  0.0011401176452636719
r_  generation:  0.012087583541870117
local_output_nid generation:  0.0011317729949951172
local_in_edges_tensor generation:  0.0007600784301757812
mini_batch_src_global generation:  0.0013318061828613281
r_  generation:  0.009707927703857422
local_output_nid generation:  0.001096487045288086
local_in_edges_tensor generation:  0.0008738040924072266
mini_batch_src_global generation:  0.0011758804321289062
r_  generation:  0.009598731994628906
local_output_nid generation:  0.001050710678100586
local_in_edges_tensor generation:  0.0007488727569580078
mini_batch_src_global generation:  0.0010161399841308594
r_  generation:  0.007521152496337891
local_output_nid generation:  0.0010464191436767578
local_in_edges_tensor generation:  0.0007276535034179688
mini_batch_src_global generation:  0.0009026527404785156
r_  generation:  0.0076045989990234375
----------------------check_connections_block total spend ----------------------------- 0.3976616859436035
generate_one_block  0.017203569412231445
generate_one_block  0.012851476669311523
generate_one_block  0.012179374694824219
generate_one_block  0.010591745376586914
generate_one_block  0.011791467666625977
generate_one_block  0.009445667266845703
generate_one_block  0.009653568267822266
generate_one_block  0.010312318801879883
generate_one_block  0.010727643966674805
generate_one_block  0.009289264678955078
generate_one_block  0.009863138198852539
generate_one_block  0.007857084274291992
generate_one_block  0.007422447204589844
generate_one_block  0.007189750671386719
generate_one_block  0.008841276168823242
generate_one_block  0.009402751922607422
generate_one_block  0.013399124145507812
generate_one_block  0.008450508117675781
generate_one_block  0.009726762771606445
generate_one_block  0.007553577423095703
generate_one_block  0.009390592575073242
generate_one_block  0.011620521545410156
generate_one_block  0.008460521697998047
generate_one_block  0.014743328094482422
generate_one_block  0.01294088363647461
generate_one_block  0.014721393585205078
generate_one_block  0.01632094383239746
generate_one_block  0.01916193962097168
generate_one_block  0.01691913604736328
generate_one_block  0.015198469161987305
generate_one_block  0.011515617370605469
generate_one_block  0.011814117431640625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03154325485229492
gen group dst list time:  0.009600162506103516
time for parepare:  0.02004075050354004
local_output_nid generation:  0.0015254020690917969
local_in_edges_tensor generation:  0.010257959365844727
mini_batch_src_global generation:  0.0014812946319580078
r_  generation:  0.014744281768798828
local_output_nid generation:  0.001967191696166992
local_in_edges_tensor generation:  0.001909017562866211
mini_batch_src_global generation:  0.0016849040985107422
r_  generation:  0.015476703643798828
local_output_nid generation:  0.0025637149810791016
local_in_edges_tensor generation:  0.002228975296020508
mini_batch_src_global generation:  0.001514434814453125
r_  generation:  0.01820993423461914
local_output_nid generation:  0.001999378204345703
local_in_edges_tensor generation:  0.0017290115356445312
mini_batch_src_global generation:  0.001337289810180664
r_  generation:  0.026047229766845703
local_output_nid generation:  0.0031986236572265625
local_in_edges_tensor generation:  0.002770662307739258
mini_batch_src_global generation:  0.003797292709350586
r_  generation:  0.021005868911743164
local_output_nid generation:  0.002415180206298828
local_in_edges_tensor generation:  0.002145051956176758
mini_batch_src_global generation:  0.0015244483947753906
r_  generation:  0.01865673065185547
local_output_nid generation:  0.0020494461059570312
local_in_edges_tensor generation:  0.0018072128295898438
mini_batch_src_global generation:  0.0013728141784667969
r_  generation:  0.01647639274597168
local_output_nid generation:  0.0020017623901367188
local_in_edges_tensor generation:  0.0017778873443603516
mini_batch_src_global generation:  0.001360177993774414
r_  generation:  0.017014265060424805
local_output_nid generation:  0.002347230911254883
local_in_edges_tensor generation:  0.002167224884033203
mini_batch_src_global generation:  0.0014557838439941406
r_  generation:  0.01845073699951172
local_output_nid generation:  0.0020902156829833984
local_in_edges_tensor generation:  0.0018756389617919922
mini_batch_src_global generation:  0.001291036605834961
r_  generation:  0.015146017074584961
local_output_nid generation:  0.002455472946166992
local_in_edges_tensor generation:  0.002132415771484375
mini_batch_src_global generation:  0.0014078617095947266
r_  generation:  0.018512725830078125
local_output_nid generation:  0.001667022705078125
local_in_edges_tensor generation:  0.0015039443969726562
mini_batch_src_global generation:  0.0012116432189941406
r_  generation:  0.00963282585144043
local_output_nid generation:  0.0016558170318603516
local_in_edges_tensor generation:  0.0013966560363769531
mini_batch_src_global generation:  0.0010540485382080078
r_  generation:  0.009260177612304688
local_output_nid generation:  0.0015187263488769531
local_in_edges_tensor generation:  0.0012869834899902344
mini_batch_src_global generation:  0.0009081363677978516
r_  generation:  0.00851583480834961
local_output_nid generation:  0.001665353775024414
local_in_edges_tensor generation:  0.0014023780822753906
mini_batch_src_global generation:  0.0009489059448242188
r_  generation:  0.01204371452331543
local_output_nid generation:  0.0018291473388671875
local_in_edges_tensor generation:  0.0015864372253417969
mini_batch_src_global generation:  0.0010068416595458984
r_  generation:  0.014444589614868164
local_output_nid generation:  0.002498626708984375
local_in_edges_tensor generation:  0.0021963119506835938
mini_batch_src_global generation:  0.0015358924865722656
r_  generation:  0.020059823989868164
local_output_nid generation:  0.0019659996032714844
local_in_edges_tensor generation:  0.0017817020416259766
mini_batch_src_global generation:  0.001316070556640625
r_  generation:  0.015250444412231445
local_output_nid generation:  0.0027229785919189453
local_in_edges_tensor generation:  0.0027399063110351562
mini_batch_src_global generation:  0.0014815330505371094
r_  generation:  0.020439863204956055
local_output_nid generation:  0.002360105514526367
local_in_edges_tensor generation:  0.002129793167114258
mini_batch_src_global generation:  0.0014712810516357422
r_  generation:  0.016746044158935547
local_output_nid generation:  0.002722501754760742
local_in_edges_tensor generation:  0.002468109130859375
mini_batch_src_global generation:  0.0016646385192871094
r_  generation:  0.02162933349609375
local_output_nid generation:  0.004445552825927734
local_in_edges_tensor generation:  0.006703615188598633
mini_batch_src_global generation:  0.0028874874114990234
r_  generation:  0.0314633846282959
local_output_nid generation:  0.0032777786254882812
local_in_edges_tensor generation:  0.0031287670135498047
mini_batch_src_global generation:  0.0023508071899414062
r_  generation:  0.02611398696899414
local_output_nid generation:  0.004378795623779297
local_in_edges_tensor generation:  0.004056215286254883
mini_batch_src_global generation:  0.004026174545288086
r_  generation:  0.062363386154174805
local_output_nid generation:  0.006101369857788086
local_in_edges_tensor generation:  0.006077289581298828
mini_batch_src_global generation:  0.005072116851806641
r_  generation:  0.05123114585876465
local_output_nid generation:  0.006119966506958008
local_in_edges_tensor generation:  0.006011009216308594
mini_batch_src_global generation:  0.00993037223815918
r_  generation:  0.05891990661621094
local_output_nid generation:  0.005963563919067383
local_in_edges_tensor generation:  0.0059854984283447266
mini_batch_src_global generation:  0.00623631477355957
r_  generation:  0.05495476722717285
local_output_nid generation:  0.006560087203979492
local_in_edges_tensor generation:  0.006655693054199219
mini_batch_src_global generation:  0.006097078323364258
r_  generation:  0.05171561241149902
local_output_nid generation:  0.005781650543212891
local_in_edges_tensor generation:  0.005872488021850586
mini_batch_src_global generation:  0.006285190582275391
r_  generation:  0.0548710823059082
local_output_nid generation:  0.0059967041015625
local_in_edges_tensor generation:  0.0057849884033203125
mini_batch_src_global generation:  0.0060236454010009766
r_  generation:  0.0571439266204834
local_output_nid generation:  0.005070209503173828
local_in_edges_tensor generation:  0.00478672981262207
mini_batch_src_global generation:  0.004725933074951172
r_  generation:  0.042525529861450195
local_output_nid generation:  0.005240440368652344
local_in_edges_tensor generation:  0.005166292190551758
mini_batch_src_global generation:  0.004670858383178711
r_  generation:  0.044867515563964844
----------------------check_connections_block total spend ----------------------------- 1.4235446453094482
generate_one_block  0.020104408264160156
generate_one_block  0.03581976890563965
generate_one_block  0.026294469833374023
generate_one_block  0.021592378616333008
generate_one_block  0.024429798126220703
generate_one_block  0.02524590492248535
generate_one_block  0.03608393669128418
generate_one_block  0.028824329376220703
generate_one_block  0.0252077579498291
generate_one_block  0.020838499069213867
generate_one_block  0.024703025817871094
generate_one_block  0.01428079605102539
generate_one_block  0.012955427169799805
generate_one_block  0.01134800910949707
generate_one_block  0.014499187469482422
generate_one_block  0.018824338912963867
generate_one_block  0.027910947799682617
generate_one_block  0.01863861083984375
generate_one_block  0.02667069435119629
generate_one_block  0.022526979446411133
generate_one_block  0.028258085250854492
generate_one_block  0.044716596603393555
generate_one_block  0.05403447151184082
generate_one_block  0.05792999267578125
generate_one_block  0.06682157516479492
generate_one_block  0.07046794891357422
generate_one_block  0.07608580589294434
generate_one_block  0.07184076309204102
generate_one_block  0.07334733009338379
generate_one_block  0.0749208927154541
generate_one_block  0.05658698081970215
generate_one_block  0.058066606521606445
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.019667625427246094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

connection checking time:  1.8212063312530518
block generation total time  1.55643630027771
average batch blocks generation time:  0.048638634383678436
block dataloader generation time/epoch 21.473557114601135
pseudo mini batch 0 input nodes size: 12881
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.018291950225830078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.018291950225830078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.02443408966064453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.024456024169921875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.01769733428955078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.018204689025878906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.018204689025878906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.018204689025878906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([12881, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.018204689025878906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([356, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.03924369812011719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.03924369812011719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 356, 128]), torch.Size([1, 356, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.03958320617675781  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04229927062988281  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 356, 128])
m.shape torch.Size([422, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04253196716308594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04253196716308594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 422, 128]), torch.Size([1, 422, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.042934417724609375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04897117614746094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 422, 128])
m.shape torch.Size([426, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04937934875488281  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.04937934875488281  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 426, 128]), torch.Size([1, 426, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.049785614013671875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.05872344970703125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 426, 128])
m.shape torch.Size([458, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.059393882751464844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.059393882751464844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 458, 128]), torch.Size([1, 458, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.059830665588378906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.07249736785888672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 458, 128])
m.shape torch.Size([423, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.07344627380371094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.07344627380371094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 423, 128]), torch.Size([1, 423, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.07384967803955078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08837223052978516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 423, 128])
m.shape torch.Size([413, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08935213088989258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08935213088989258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 413, 128]), torch.Size([1, 413, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.08974599838256836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10668230056762695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 413, 128])
m.shape torch.Size([365, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10770368576049805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10770368576049805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 365, 128]), torch.Size([1, 365, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.10805177688598633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1254563331604004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 365, 128])
m.shape torch.Size([314, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1264801025390625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1264801025390625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 314, 128]), torch.Size([1, 314, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.12677955627441406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.14384841918945312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 314, 128])
m.shape torch.Size([262, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1456775665283203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.1456775665283203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 262, 128]), torch.Size([1, 262, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.14592742919921875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.16191864013671875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 262, 128])
m.shape torch.Size([2628, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.17432498931884766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.17432498931884766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1314, 128]), torch.Size([1, 1314, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.17557811737060547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.26455020904541016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 1314, 128])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.26455020904541016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.26455020904541016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1314, 128]), torch.Size([1, 1314, 128])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.26580333709716797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.35532379150390625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 1314, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.33715200424194336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3429379463195801  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3487238883972168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3428926467895508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([6067, 256])
first layer input nodes number: 12881
first layer output nodes number: 6067
edges number: 42608
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.34882211685180664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.35460805892944336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.35630178451538086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.35630178451538086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([271, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3810715675354004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3810715675354004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3815884590148926  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3860440254211426  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([294, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3863511085510254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3863511085510254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.38691186904907227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3962888717651367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([244, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3967123031616211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.3967123031616211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 244, 256]), torch.Size([1, 244, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.39717769622802734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.40741634368896484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 244, 256])
m.shape torch.Size([225, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4080491065979004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4080491065979004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4084782600402832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.42092370986938477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([219, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4224114418029785  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4224114418029785  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.42282915115356445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4378666877746582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([199, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4393606185913086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4393606185913086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4397401809692383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.45606136322021484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([183, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.45757532119750977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.45757532119750977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.45792436599731445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.47537660598754883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([155, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4763941764831543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.4763941764831543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.47668981552124023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.49354124069213867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([117, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.49440574645996094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.49440574645996094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.49462890625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5089111328125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([126, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5106978416442871  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5106978416442871  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5109381675720215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5280013084411621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([112, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5290656089782715  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5290656089782715  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5292792320251465  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5459418296813965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([75, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5467004776000977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5467004776000977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5468435287475586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5590028762817383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([73, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5598435401916504  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5598435401916504  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5599827766418457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5727925300598145  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([73, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5737051963806152  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5737051963806152  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5738444328308105  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5876288414001465  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5882515907287598  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5882515907287598  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5883431434631348  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5980477333068848  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([45, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5986943244934082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5986943244934082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.5987801551818848  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6084790229797363  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([61, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6094350814819336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6094350814819336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6095514297485352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6235132217407227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6240606307983398  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6240606307983398  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6241273880004883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6326055526733398  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6331019401550293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6331019401550293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6331572532653809  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6405692100524902  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([39, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.641291618347168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.641291618347168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6413660049438477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6518545150756836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6524028778076172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6524028778076172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6524581909179688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.66064453125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6610822677612305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6610822677612305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6611242294311523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.667628288269043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6679835319519043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6679835319519043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6680159568786621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6732687950134277  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6737604141235352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6737604141235352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.673802375793457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6808938980102539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([208, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6858711242675781  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6858711242675781  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 3.4080810546875 GB
    Memory Allocated: 0.6862678527832031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.7560920715332031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 208, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.7344150543212891  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.7348504066467285  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.735285758972168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.7348284721374512  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2921, 40])
input nodes number: 6067
output nodes number: 2921
edges number: 25367
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.734900951385498  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.7349019050598145  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.019173622131347656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 1 input nodes size: 13940
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.017703533172607422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.017703533172607422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.024350643157958984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.024372577667236328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.01820850372314453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.018741607666015625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.018741607666015625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.018741607666015625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([13940, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.018741607666015625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([399, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.04100179672241211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.04100179672241211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 399, 128]), torch.Size([1, 399, 128])
----------------------------------------3
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.0413823127746582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.04442644119262695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 399, 128])
m.shape torch.Size([477, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.04469108581542969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.04469108581542969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 477, 128]), torch.Size([1, 477, 128])
----------------------------------------3
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.04514598846435547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.05196952819824219  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 477, 128])
m.shape torch.Size([516, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.052480220794677734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.052480220794677734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 516, 128]), torch.Size([1, 516, 128])
----------------------------------------3
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.05297231674194336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.0639491081237793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 516, 128])
m.shape torch.Size([464, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.06458806991577148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.06458806991577148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 464, 128]), torch.Size([1, 464, 128])
----------------------------------------3
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.06503057479858398  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.07786321640014648  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 464, 128])
m.shape torch.Size([410, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.07861948013305664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.07861948013305664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 410, 128]), torch.Size([1, 410, 128])
----------------------------------------3
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.0790104866027832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.09308671951293945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 410, 128])
m.shape torch.Size([395, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.09402132034301758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.09402132034301758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 395, 128]), torch.Size([1, 395, 128])
----------------------------------------3
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.09439802169799805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.1105961799621582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 395, 128])
m.shape torch.Size([356, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.11159610748291016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.11159610748291016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 356, 128]), torch.Size([1, 356, 128])
----------------------------------------3
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.11193561553955078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.12891101837158203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 356, 128])
m.shape torch.Size([343, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.1300497055053711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.1300497055053711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 343, 128]), torch.Size([1, 343, 128])
----------------------------------------3
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.13037681579589844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.14902210235595703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 343, 128])
m.shape torch.Size([317, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.15021896362304688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.15021896362304688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 317, 128]), torch.Size([1, 317, 128])
----------------------------------------3
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.15052127838134766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.16986942291259766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 317, 128])
m.shape torch.Size([2774, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.18339014053344727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.18339014053344727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1387, 128]), torch.Size([1, 1387, 128])
----------------------------------------3
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.18471288681030273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.27951669692993164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 1387, 128])
----------------------------------------1
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.27951669692993164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.27951669692993164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1387, 128]), torch.Size([1, 1387, 128])
----------------------------------------3
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.2808394432067871  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.3754262924194336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 1387, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.35622739791870117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.3623795509338379  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.3685317039489746  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.3623313903808594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([6451, 256])
first layer input nodes number: 13940
first layer output nodes number: 6451
edges number: 45006
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.3686375617980957  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.3747897148132324  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.3764948844909668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.3764948844909668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([283, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.4024825096130371  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.4024825096130371  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 283, 256]), torch.Size([1, 283, 256])
----------------------------------------3
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.40302228927612305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.40751218795776367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 283, 256])
m.shape torch.Size([278, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.4077768325805664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.4077768325805664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.4083070755004883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.41735363006591797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([273, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.4178757667541504  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.4178757667541504  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 273, 256]), torch.Size([1, 273, 256])
----------------------------------------3
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.4183964729309082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.4304623603820801  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 273, 256])
m.shape torch.Size([217, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.43103647232055664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.43103647232055664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.43145036697387695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.443453311920166  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([181, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.44411659240722656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.44411659240722656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.4444618225097656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.4568901062011719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([169, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.45769214630126953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.45769214630126953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.45801448822021484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.4718751907348633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([150, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.47272348403930664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.47272348403930664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.4730095863342285  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.48731470108032227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([140, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.488248348236084  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.488248348236084  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.48851537704467773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.5037360191345215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([131, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.5047359466552734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.5047359466552734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.5049858093261719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.5209770202636719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([116, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.5219674110412598  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.5219674110412598  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.522188663482666  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.5378975868225098  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([127, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.5391297340393066  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.5391297340393066  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.5393719673156738  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.5582661628723145  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([98, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.5592756271362305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.5592756271362305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.5594625473022461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.5753507614135742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([88, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.5763568878173828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.5763568878173828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.5765247344970703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.5919666290283203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([63, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.5927305221557617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.5927305221557617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.5928506851196289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.6047468185424805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([54, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.6054654121398926  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.6054654121398926  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.6055684089660645  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.6164860725402832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([50, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.6172037124633789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.6172037124633789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.6172990798950195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.6280755996704102  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([39, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.6286654472351074  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.6286654472351074  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.6287398338317871  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.6376662254333496  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([40, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.6383213996887207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.6383213996887207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.6383976936340332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.6480870246887207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([34, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.6486701965332031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.6486701965332031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.6487350463867188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.6574249267578125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([45, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.6582579612731934  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.6582579612731934  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.6583437919616699  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.6704459190368652  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([32, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.6710491180419922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.6710491180419922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.6711101531982422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.6801433563232422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([28, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.6807050704956055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.6807050704956055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.6807584762573242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.6890363693237305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.689429759979248  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.689429759979248  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.6894659996032715  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.6953368186950684  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.6957802772521973  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.6957802772521973  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.6958184242248535  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.7022652626037598  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([247, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.7088279724121094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.7088279724121094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 3.4119873046875 GB
    Memory Allocated: 0.7092990875244141  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4139404296875 GB
    Memory Allocated: 0.7922153472900391  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 247, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4139404296875 GB
    Memory Allocated: 0.7693033218383789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4139404296875 GB
    Memory Allocated: 0.7697391510009766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7701749801635742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7697172164916992  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2922, 40])
input nodes number: 6451
output nodes number: 2922
edges number: 26472
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7697877883911133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7697882652282715  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.019754409790039062  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 2 input nodes size: 19331
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.018208980560302734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.018208980560302734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.027426719665527344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.027448654174804688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.02077960968017578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.021368026733398438  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.021368026733398438  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.021368026733398438  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([19331, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.021368026733398438  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([526, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04789447784423828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04789447784423828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 526, 128]), torch.Size([1, 526, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04839611053466797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05366039276123047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 526, 128])
m.shape torch.Size([577, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05395984649658203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05395984649658203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 577, 128]), torch.Size([1, 577, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05451011657714844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06276416778564453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 577, 128])
m.shape torch.Size([544, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06326723098754883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06326723098754883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 544, 128]), torch.Size([1, 544, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06378602981567383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07616472244262695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 544, 128])
m.shape torch.Size([514, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07688570022583008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07688570022583008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 514, 128]), torch.Size([1, 514, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07737588882446289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0922398567199707  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 514, 128])
m.shape torch.Size([461, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0930938720703125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0930938720703125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 461, 128]), torch.Size([1, 461, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09353351593017578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1093606948852539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 461, 128])
m.shape torch.Size([373, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11020803451538086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11020803451538086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 373, 128]), torch.Size([1, 373, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11056375503540039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12585973739624023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 373, 128])
m.shape torch.Size([381, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1269536018371582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1269536018371582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 381, 128]), torch.Size([1, 381, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12731695175170898  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14548444747924805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 381, 128])
m.shape torch.Size([353, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14672088623046875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14672088623046875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 353, 128]), torch.Size([1, 353, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14705753326416016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1662464141845703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 353, 128])
m.shape torch.Size([309, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1674041748046875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1674041748046875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 309, 128]), torch.Size([1, 309, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16769886016845703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.18655872344970703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 309, 128])
m.shape torch.Size([3547, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.20398950576782227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.20398950576782227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1773, 128]), torch.Size([1, 1773, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.20568037033081055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.32684898376464844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 1773, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.32684898376464844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.32684898376464844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1774, 128]), torch.Size([1, 1774, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3285408020019531  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4478144645690918  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 1774, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4248523712158203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4320859909057617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4393196105957031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.43202924728393555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([7585, 256])
first layer input nodes number: 19331
first layer output nodes number: 7585
edges number: 53653
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4394659996032715  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4466996192932129  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.44861316680908203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.44861316680908203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([354, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4732551574707031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4732551574707031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 354, 256]), torch.Size([1, 354, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.47393035888671875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4803495407104492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 354, 256])
m.shape torch.Size([347, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4806790351867676  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4806790351867676  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 347, 256]), torch.Size([1, 347, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4813408851623535  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4920353889465332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 347, 256])
m.shape torch.Size([283, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.492520809173584  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.492520809173584  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 283, 256]), torch.Size([1, 283, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4930605888366699  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5059089660644531  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 283, 256])
m.shape torch.Size([252, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5066080093383789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5066080093383789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5070886611938477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5210275650024414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([193, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5217151641845703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5217151641845703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5220832824707031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5353355407714844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([156, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5360512733459473  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5360512733459473  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.536348819732666  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5491433143615723  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([144, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5499634742736816  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5499634742736816  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5502381324768066  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5639710426330566  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([125, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5647950172424316  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5647950172424316  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5650334358215332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5786232948303223  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([104, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5794038772583008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5794038772583008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5796022415161133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5922975540161133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([101, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5931692123413086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5931692123413086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5933618545532227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6070394515991211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([74, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6077256202697754  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6077256202697754  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6078667640686035  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6188759803771973  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([78, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6197052001953125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6197052001953125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6198539733886719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6324996948242188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([61, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6331877708435059  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6331877708435059  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6333041191101074  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6440081596374512  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([53, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6446633338928223  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6446633338928223  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6447644233703613  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6547722816467285  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([53, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6554861068725586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6554861068725586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6555871963500977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6663026809692383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6667904853820801  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6667904853820801  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6668572425842285  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.674400806427002  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([39, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6750049591064453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6750049591064453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.675079345703125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6840057373046875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6845049858093262  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6845049858093262  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6845641136169434  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6920733451843262  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6926102638244629  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6926102638244629  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6926693916320801  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7005925178527832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7010436058044434  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7010436058044434  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7010912895202637  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7078146934509277  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7083563804626465  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7083563804626465  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7084097862243652  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7163138389587402  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([28, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7168793678283691  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7168793678283691  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7169327735900879  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7252106666564941  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7254495620727539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7254495620727539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7254724502563477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7291803359985352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7294921875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7294921875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7295188903808594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7340316772460938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([305, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7413473129272461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7413473129272461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7419290542602539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8490114212036133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 305, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8274521827697754  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8278884887695312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8283247947692871  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8278665542602539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2926, 40])
input nodes number: 7585
output nodes number: 2926
edges number: 25151
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8279457092285156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8279461860656738  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.02249288558959961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 3 input nodes size: 15185
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.020780086517333984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.020780086517333984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.028020858764648438  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.028041839599609375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.018802165985107422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.01931142807006836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.01931142807006836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.01931142807006836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([15185, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.01931142807006836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([484, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04160737991333008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04160737991333008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 484, 128]), torch.Size([1, 484, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0420689582824707  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0457615852355957  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 484, 128])
m.shape torch.Size([571, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04607534408569336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04607534408569336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 571, 128]), torch.Size([1, 571, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04661989212036133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.054909706115722656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 571, 128])
m.shape torch.Size([525, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.055388450622558594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.055388450622558594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 525, 128]), torch.Size([1, 525, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.055889129638671875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06743240356445312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 525, 128])
m.shape torch.Size([463, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06806516647338867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06806516647338867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 463, 128]), torch.Size([1, 463, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06850671768188477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08131170272827148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 463, 128])
m.shape torch.Size([413, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08207559585571289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08207559585571289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 413, 128]), torch.Size([1, 413, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08246946334838867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0966486930847168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 413, 128])
m.shape torch.Size([363, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09749031066894531  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09749031066894531  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 363, 128]), torch.Size([1, 363, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09783649444580078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11272239685058594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 363, 128])
m.shape torch.Size([330, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11365079879760742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11365079879760742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 330, 128]), torch.Size([1, 330, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11396551132202148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1297011375427246  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 330, 128])
m.shape torch.Size([308, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13071870803833008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13071870803833008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 308, 128]), torch.Size([1, 308, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1310124397277832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14775514602661133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 308, 128])
m.shape torch.Size([256, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14870691299438477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14870691299438477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 256, 128]), torch.Size([1, 256, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14895105361938477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16457605361938477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 256, 128])
m.shape torch.Size([2810, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.17812585830688477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.17812585830688477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1405, 128]), torch.Size([1, 1405, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.17946577072143555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2763786315917969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 1405, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2763786315917969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2763786315917969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1405, 128]), torch.Size([1, 1405, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.27771854400634766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3727278709411621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 1405, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.35355663299560547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.35977745056152344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3659982681274414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3597288131713867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([6523, 256])
first layer input nodes number: 15185
first layer output nodes number: 6523
edges number: 44474
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.36611366271972656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3732032775878906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3745603561401367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3745603561401367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([338, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3986234664916992  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3986234664916992  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 338, 256]), torch.Size([1, 338, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.39926815032958984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.40557193756103516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 338, 256])
m.shape torch.Size([337, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4058976173400879  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4058976173400879  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 337, 256]), torch.Size([1, 337, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4065403938293457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.41716814041137695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 337, 256])
m.shape torch.Size([273, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4176340103149414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4176340103149414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 273, 256]), torch.Size([1, 273, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4181547164916992  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4305601119995117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 273, 256])
m.shape torch.Size([230, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4311842918395996  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4311842918395996  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4316229820251465  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.44434499740600586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([185, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.44501495361328125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.44501495361328125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.44536781311035156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4580707550048828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([150, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.45875978469848633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.45875978469848633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4590458869934082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.47134828567504883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([131, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.47208690643310547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.47208690643310547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4723367691040039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4848299026489258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([117, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.48560476303100586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.48560476303100586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4858279228210449  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4985480308532715  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([107, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4993624687194824  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4993624687194824  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.49956655502319336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5126280784606934  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5132761001586914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5132761001586914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5134248733520508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5239877700805664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([64, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.524590015411377  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.524590015411377  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.524712085723877  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.534233570098877  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([78, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5350723266601562  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5350723266601562  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5352210998535156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5478668212890625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([54, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5484671592712402  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5484671592712402  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5485701560974121  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5580458641052246  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([65, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5588693618774414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5588693618774414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5589933395385742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5712671279907227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.571782112121582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.571782112121582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5718584060668945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5799455642700195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5804920196533203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5804920196533203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5805644989013672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5887546539306641  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([46, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.589470386505127  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.589470386505127  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5895581245422363  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6000866889953613  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([42, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6007695198059082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6007695198059082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6008496284484863  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6110234260559082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.611422061920166  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.611422061920166  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6114678382873535  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6176018714904785  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6180214881896973  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6180214881896973  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.618065357208252  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6242508888244629  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6247944831848145  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6247944831848145  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6248478889465332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6327519416809082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([28, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6333174705505371  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6333174705505371  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6333708763122559  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6416487693786621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([29, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6422634124755859  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6422634124755859  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6423187255859375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6512794494628906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6516671180725098  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6516671180725098  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6517014503479004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.657503604888916  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([256, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.663637638092041  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.663637638092041  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.664125919342041  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.750063419342041  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 256, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7289614677429199  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7293758392333984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.729790210723877  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7293548583984375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2779, 40])
input nodes number: 6523
output nodes number: 2779
edges number: 23789
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7294025421142578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.729403018951416  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.020267009735107422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 4 input nodes size: 15495
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.018780231475830078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.018780231475830078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0261688232421875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.026190757751464844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.018929004669189453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.01952505111694336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.01952505111694336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.01952505111694336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([15495, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.01952505111694336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([506, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.046170711517333984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.046170711517333984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 506, 128]), torch.Size([1, 506, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04665327072143555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05051374435424805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 506, 128])
m.shape torch.Size([591, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05083608627319336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05083608627319336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 591, 128]), torch.Size([1, 591, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05139970779418945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06131410598754883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 591, 128])
m.shape torch.Size([602, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.061893463134765625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.061893463134765625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 602, 128]), torch.Size([1, 602, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06246757507324219  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07537651062011719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 602, 128])
m.shape torch.Size([524, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07608890533447266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07608890533447266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 524, 128]), torch.Size([1, 524, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07658863067626953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09165668487548828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 524, 128])
m.shape torch.Size([536, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09268474578857422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09268474578857422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 536, 128]), torch.Size([1, 536, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09319591522216797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11188411712646484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 536, 128])
m.shape torch.Size([467, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11296463012695312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11296463012695312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 467, 128]), torch.Size([1, 467, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11340999603271484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13256072998046875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 467, 128])
m.shape torch.Size([388, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13454198837280273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13454198837280273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 388, 128]), torch.Size([1, 388, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13491201400756836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1534132957458496  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 388, 128])
m.shape torch.Size([357, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.15459012985229492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.15459012985229492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 357, 128]), torch.Size([1, 357, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.15493059158325195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.17433691024780273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 357, 128])
m.shape torch.Size([327, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.17557001113891602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.17557001113891602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 327, 128]), torch.Size([1, 327, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.17588186264038086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.19584035873413086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 327, 128])
m.shape torch.Size([3432, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2120494842529297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2120494842529297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1716, 128]), torch.Size([1, 1716, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2136859893798828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3333568572998047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 1716, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3333568572998047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3333568572998047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1716, 128]), torch.Size([1, 1716, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3349933624267578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4503669738769531  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 1716, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.42737722396850586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.43474912643432617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4421210289001465  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4346914291381836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([7730, 256])
first layer input nodes number: 15495
first layer output nodes number: 7730
edges number: 53907
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.44223880767822266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.44961071014404297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.45201826095581055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.45201826095581055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([318, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.47803592681884766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.47803592681884766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.47864246368408203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.48360157012939453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([323, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.483919620513916  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.483919620513916  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 323, 256]), torch.Size([1, 323, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.48453569412231445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.49524927139282227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 323, 256])
m.shape torch.Size([273, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4957284927368164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4957284927368164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 273, 256]), torch.Size([1, 273, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4962491989135742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5078306198120117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 273, 256])
m.shape torch.Size([237, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.508481502532959  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.508481502532959  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5089335441589355  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5220427513122559  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([214, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5228452682495117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5228452682495117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5232534408569336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5379476547241211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([168, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5387125015258789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5387125015258789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5390329360961914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5528116226196289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([137, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5535731315612793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5535731315612793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5538344383239746  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5668997764587402  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([119, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5676841735839844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5676841735839844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5679111480712891  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5808486938476562  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([122, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5817909240722656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5817909240722656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5820236206054688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5969161987304688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([95, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5977129936218262  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5977129936218262  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5978941917419434  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6107592582702637  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([75, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6114616394042969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6114616394042969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6116046905517578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6227626800537109  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([73, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6235332489013672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6235332489013672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6236724853515625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6355075836181641  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([66, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6362628936767578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6362628936767578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6363887786865234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6479701995849609  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([60, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6487150192260742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6487150192260742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.648829460144043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6601591110229492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([49, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6608085632324219  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6608085632324219  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6609020233154297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6708087921142578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([26, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6711621284484863  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6711621284484863  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6712117195129395  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6768155097961426  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([46, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6775426864624023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6775426864624023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6776304244995117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6881589889526367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([34, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6887035369873047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6887035369873047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6887683868408203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6970043182373047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6974468231201172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6974468231201172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6974964141845703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7041416168212891  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([44, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7049627304077148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7049627304077148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7050466537475586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7168798446655273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([30, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7174434661865234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7174434661865234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7175006866455078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7259693145751953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7263636589050293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7263636589050293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7264018058776855  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7323145866394043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7327156066894531  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7327156066894531  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7327518463134766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7386226654052734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7390432357788086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7390432357788086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.739079475402832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.745203971862793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([316, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7527790069580078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7527790069580078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 316, 256]), torch.Size([1, 316, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7533817291259766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8611240386962891  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 316, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8381333351135254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8385672569274902  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8390011787414551  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8385453224182129  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2909, 40])
input nodes number: 7730
output nodes number: 2909
edges number: 25949
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8386445045471191  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8386449813842773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.020656585693359375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 5 input nodes size: 19850
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.01894855499267578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.01894855499267578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.028413772583007812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.02843475341796875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.021024227142333984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.021567821502685547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.021567821502685547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.021567821502685547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([19850, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.021567821502685547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([685, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.047986507415771484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.047986507415771484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 685, 128]), torch.Size([1, 685, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.048639774322509766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05481290817260742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 685, 128])
m.shape torch.Size([760, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05521106719970703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05521106719970703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 760, 128]), torch.Size([1, 760, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05593585968017578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0672159194946289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 760, 128])
m.shape torch.Size([684, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06783199310302734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06783199310302734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 684, 128]), torch.Size([1, 684, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06848430633544922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08313846588134766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 684, 128])
m.shape torch.Size([574, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0839071273803711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0839071273803711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 574, 128]), torch.Size([1, 574, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08445453643798828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1008901596069336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 574, 128])
m.shape torch.Size([534, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10188961029052734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10188961029052734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 534, 128]), torch.Size([1, 534, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10239887237548828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12170600891113281  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 534, 128])
m.shape torch.Size([465, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1229848861694336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1229848861694336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 465, 128]), torch.Size([1, 465, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1234283447265625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14249706268310547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 465, 128])
m.shape torch.Size([400, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14361047744750977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14361047744750977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 400, 128]), torch.Size([1, 400, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14399194717407227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16306543350219727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 400, 128])
m.shape torch.Size([345, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16419076919555664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16419076919555664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 345, 128]), torch.Size([1, 345, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1645197868347168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1832737922668457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 345, 128])
m.shape torch.Size([328, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.18451690673828125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.18451690673828125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 328, 128]), torch.Size([1, 328, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1848297119140625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2048492431640625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 328, 128])
m.shape torch.Size([3238, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.22031784057617188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.22031784057617188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1619, 128]), torch.Size([1, 1619, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2218618392944336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3320198059082031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 1619, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3320198059082031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3320198059082031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1619, 128]), torch.Size([1, 1619, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.33356380462646484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.442415714263916  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 1619, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.41991758346557617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.42755937576293945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.43520116806030273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.42749929428100586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([8013, 256])
first layer input nodes number: 19850
first layer output nodes number: 8013
edges number: 52905
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4353513717651367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4429931640625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4455580711364746  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4455580711364746  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([465, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.46580982208251953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.46580982208251953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 465, 256]), torch.Size([1, 465, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.46669673919677734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.47449207305908203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 465, 256])
m.shape torch.Size([410, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4748368263244629  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4748368263244629  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 410, 256]), torch.Size([1, 410, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.475618839263916  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4873490333557129  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 410, 256])
m.shape torch.Size([333, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4879183769226074  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4879183769226074  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 333, 256]), torch.Size([1, 333, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.488553524017334  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5031642913818359  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 333, 256])
m.shape torch.Size([244, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5037851333618164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5037851333618164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 244, 256]), torch.Size([1, 244, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5042505264282227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5177469253540039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 244, 256])
m.shape torch.Size([183, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5183939933776855  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5183939933776855  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5187430381774902  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.531308650970459  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([154, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5320224761962891  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5320224761962891  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5323162078857422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5449466705322266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([122, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5456209182739258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5456209182739258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5458536148071289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5574884414672852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([85, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5580258369445801  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5580258369445801  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5581879615783691  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5674290657043457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([85, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5680832862854004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5680832862854004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5682454109191895  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5786213874816895  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([72, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5792326927185059  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5792326927185059  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5793700218200684  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5891203880310059  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([54, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.589622974395752  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.589622974395752  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5897259712219238  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5977597236633301  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([41, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5981812477111816  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5981812477111816  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.598259449005127  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6049065589904785  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([40, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6053676605224609  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6053676605224609  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6054439544677734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6124629974365234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([25, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6127614974975586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6127614974975586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6128091812133789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6175298690795898  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([23, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6178379058837891  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6178379058837891  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6178817749023438  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6225318908691406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6230945587158203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6230945587158203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6231670379638672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6313571929931641  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6318278312683105  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6318278312683105  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6318869590759277  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6389822959899902  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6394028663635254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6394028663635254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6394524574279785  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6457505226135254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6462373733520508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6462373733520508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6462907791137695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.653447151184082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6537857055664062  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6537857055664062  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6538219451904297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6589317321777344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6593780517578125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6593780517578125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6594219207763672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6659145355224609  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6662735939025879  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6662735939025879  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6663079261779785  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6716294288635254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6719884872436523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6719884872436523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6720209121704102  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6772737503051758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6775116920471191  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6775116920471191  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6775326728820801  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6810784339904785  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([217, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6862821578979492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6862821578979492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6866960525512695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7595415115356445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 217, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7423672676086426  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7427792549133301  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7431912422180176  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7427582740783691  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2764, 40])
input nodes number: 8013
output nodes number: 2764
edges number: 19893
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7428174018859863  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7428178787231445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0225982666015625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 6 input nodes size: 15753
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.02100229263305664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.02100229263305664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.02851390838623047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.028534889221191406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.019048690795898438  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.019559860229492188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.019559860229492188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.019559860229492188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([15753, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.019559860229492188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([592, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04281139373779297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04281139373779297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 592, 128]), torch.Size([1, 592, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04337596893310547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04871225357055664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 592, 128])
m.shape torch.Size([557, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04896116256713867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04896116256713867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 557, 128]), torch.Size([1, 557, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04949235916137695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.057486534118652344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 557, 128])
m.shape torch.Size([581, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05805206298828125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05805206298828125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 581, 128]), torch.Size([1, 581, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05860614776611328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07166194915771484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 581, 128])
m.shape torch.Size([520, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07237672805786133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07237672805786133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 520, 128]), torch.Size([1, 520, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07287263870239258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08759737014770508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 520, 128])
m.shape torch.Size([477, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0884866714477539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0884866714477539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 477, 128]), torch.Size([1, 477, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08894157409667969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10531806945800781  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 477, 128])
m.shape torch.Size([400, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10623502731323242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10623502731323242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 400, 128]), torch.Size([1, 400, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10661649703979492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12301969528198242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 400, 128])
m.shape torch.Size([351, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12400054931640625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12400054931640625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 351, 128]), torch.Size([1, 351, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12433528900146484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14107227325439453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 351, 128])
m.shape torch.Size([327, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1421523094177246  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1421523094177246  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 327, 128]), torch.Size([1, 327, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14246416091918945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16023969650268555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 327, 128])
m.shape torch.Size([258, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16119098663330078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16119098663330078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 258, 128]), torch.Size([1, 258, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1614370346069336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1771841049194336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 258, 128])
m.shape torch.Size([2916, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1909656524658203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1909656524658203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1458, 128]), torch.Size([1, 1458, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.19235610961914062  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2916736602783203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 1458, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2916736602783203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2916736602783203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1458, 128]), torch.Size([1, 1458, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2930641174316406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.39211368560791016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 1458, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.37225818634033203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.37891387939453125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.38556957244873047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3788614273071289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([6979, 256])
first layer input nodes number: 15753
first layer output nodes number: 6979
edges number: 46869
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.38568925857543945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.39234495162963867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.39406538009643555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.39406538009643555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([428, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4162459373474121  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4162459373474121  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 428, 256]), torch.Size([1, 428, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.41706228256225586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4252324104309082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 428, 256])
m.shape torch.Size([319, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.42543745040893555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.42543745040893555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.42604589462280273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4355158805847168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([303, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.43608570098876953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.43608570098876953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4366636276245117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.45043134689331055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([233, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4510383605957031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4510383605957031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.45148277282714844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4643707275390625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([202, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4651193618774414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4651193618774414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.46550464630126953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.47937488555908203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([150, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.48004770278930664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.48004770278930664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4803338050842285  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.49263620376586914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([130, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.49336814880371094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.49336814880371094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.49361610412597656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5060138702392578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([108, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5067205429077148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5067205429077148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5069265365600586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5186681747436523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([84, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.519291877746582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.519291877746582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5194520950317383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5297060012817383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([85, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5304431915283203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5304431915283203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5306053161621094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5421161651611328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([72, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5427966117858887  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5427966117858887  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5429339408874512  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5536456108093262  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([53, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5541882514953613  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5541882514953613  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5542893409729004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5628819465637207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.563443660736084  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.563443660736084  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5635371208190918  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5721354484558105  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5726542472839355  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5726542472839355  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5727343559265137  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.580665111541748  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([46, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5812883377075195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5812883377075195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5813760757446289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5906763076782227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5911245346069336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5911245346069336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5911855697631836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5980825424194336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5987057685852051  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5987057685852051  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5987820625305176  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6079373359680176  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6083664894104004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6083664894104004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6084179878234863  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6149582862854004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6154441833496094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6154441833496094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6154975891113281  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6226539611816406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6231851577758789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6231851577758789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6232404708862305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6310396194458008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6315169334411621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6315169334411621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6315646171569824  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6386218070983887  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6389575004577637  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6389575004577637  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6389899253845215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6440157890319824  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6442651748657227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6442651748657227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6442880630493164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6479959487915039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6483769416809082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6483769416809082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.648409366607666  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6538891792297363  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([227, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6601352691650391  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6601352691650391  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6605682373046875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7367706298828125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 227, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7176289558410645  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7180399894714355  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7184510231018066  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7180190086364746  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2758, 40])
input nodes number: 6979
output nodes number: 2758
edges number: 21588
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7180914878845215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7180919647216797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.020537853240966797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 7 input nodes size: 14731
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.01904773712158203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.01904773712158203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.026072025299072266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.026093482971191406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.01856088638305664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.01911020278930664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.01911020278930664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.01911020278930664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([14731, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.01911020278930664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([426, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04372215270996094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04372215270996094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 426, 128]), torch.Size([1, 426, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04412841796875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0473785400390625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 426, 128])
m.shape torch.Size([497, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.047649383544921875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.047649383544921875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 497, 128]), torch.Size([1, 497, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04812335968017578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.055233001708984375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 497, 128])
m.shape torch.Size([515, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05573272705078125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05573272705078125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 515, 128]), torch.Size([1, 515, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05622386932373047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06843376159667969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 515, 128])
m.shape torch.Size([436, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06901979446411133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06901979446411133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 436, 128]), torch.Size([1, 436, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06943559646606445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08149385452270508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 436, 128])
m.shape torch.Size([424, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08229684829711914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08229684829711914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 424, 128]), torch.Size([1, 424, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08270120620727539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09725809097290039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 424, 128])
m.shape torch.Size([394, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09818315505981445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09818315505981445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 394, 128]), torch.Size([1, 394, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09855890274047852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1147160530090332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 394, 128])
m.shape torch.Size([361, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11573314666748047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11573314666748047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 361, 128]), torch.Size([1, 361, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11607742309570312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13329124450683594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 361, 128])
m.shape torch.Size([346, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13443899154663086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13443899154663086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 346, 128]), torch.Size([1, 346, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13476896286010742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.15357732772827148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 346, 128])
m.shape torch.Size([271, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.15457534790039062  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.15457534790039062  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 271, 128]), torch.Size([1, 271, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.15483379364013672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.17137432098388672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 271, 128])
m.shape torch.Size([3292, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.18694257736206055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.18694257736206055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1646, 128]), torch.Size([1, 1646, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.18851232528686523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.29996442794799805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 1646, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.29996442794799805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.29996442794799805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1646, 128]), torch.Size([1, 1646, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.30153417587280273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4135899543762207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 1646, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.39221811294555664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.39885759353637695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.40549707412719727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3988056182861328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([6962, 256])
first layer input nodes number: 14731
first layer output nodes number: 6962
edges number: 49847
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.405609130859375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4122486114501953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.41412925720214844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.41412925720214844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([333, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4381899833679199  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4381899833679199  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 333, 256]), torch.Size([1, 333, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4388251304626465  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.44459962844848633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 333, 256])
m.shape torch.Size([312, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4448819160461426  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4448819160461426  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4454770088195801  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4556422233581543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([285, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.45616674423217773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.45616674423217773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4567103385925293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4688754081726074  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([210, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.46941137313842773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.46941137313842773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.46981191635131836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4814276695251465  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([188, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4821310043334961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4821310043334961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.48248958587646484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.49539852142333984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([173, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.49625730514526367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.49625730514526367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.49658727645874023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5107760429382324  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([149, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5116491317749023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5116491317749023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5119333267211914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5261430740356445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([137, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.527989387512207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.527989387512207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5282506942749023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5431451797485352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([105, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5439229011535645  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5439229011535645  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5441231727600098  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5569405555725098  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([96, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5577630996704102  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5577630996704102  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5579462051391602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5709466934204102  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([103, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5719442367553711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5719442367553711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5721406936645508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5874643325805664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([80, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5882887840270996  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5882887840270996  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5884413719177246  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6014113426208496  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([58, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6020598411560059  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6020598411560059  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.602170467376709  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6123480796813965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([63, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6131405830383301  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6131405830383301  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6132607460021973  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6251568794250488  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([63, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6260051727294922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6260051727294922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6261253356933594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6388626098632812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([50, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6395716667175293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6395716667175293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6396670341491699  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6504435539245605  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([39, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6510334014892578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6510334014892578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6511077880859375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6600341796875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([34, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6605854034423828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6605854034423828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6606502532958984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6688861846923828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([19, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6692008972167969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6692008972167969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6692371368408203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6740932464599609  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.674555778503418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.674555778503418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6746034622192383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6813268661499023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6818885803222656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6818885803222656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6819438934326172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6901302337646484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6904411315917969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6904411315917969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6904716491699219  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6952018737792969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6956510543823242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6956510543823242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6956911087036133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7021799087524414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7026443481445312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7026443481445312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7026844024658203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7094535827636719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([219, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.714695930480957  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.714695930480957  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.715113639831543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.788630485534668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 219, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7676095962524414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.768031120300293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7684526443481445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7680096626281738  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2828, 40])
input nodes number: 6962
output nodes number: 2828
edges number: 23707
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7680935859680176  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7680940628051758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.02014636993408203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 8 input nodes size: 19542
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.01857137680053711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.01857137680053711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.027889728546142578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.02791118621826172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.020865440368652344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.02144145965576172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.02144145965576172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.02144145965576172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([19542, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.02144145965576172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([546, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.047818660736083984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.047818660736083984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 546, 128]), torch.Size([1, 546, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0483393669128418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.053708553314208984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 546, 128])
m.shape torch.Size([668, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05408525466918945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05408525466918945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 668, 128]), torch.Size([1, 668, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05472230911254883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06427812576293945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 668, 128])
m.shape torch.Size([669, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06491661071777344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06491661071777344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 669, 128]), torch.Size([1, 669, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06555461883544922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07983684539794922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 669, 128])
m.shape torch.Size([620, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08070039749145508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08070039749145508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 620, 128]), torch.Size([1, 620, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08129167556762695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0989537239074707  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 620, 128])
m.shape torch.Size([520, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09989786148071289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09989786148071289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 520, 128]), torch.Size([1, 520, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10039377212524414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11870050430297852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 520, 128])
m.shape torch.Size([463, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11977720260620117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11977720260620117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 463, 128]), torch.Size([1, 463, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12021875381469727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1392054557800293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 463, 128])
m.shape torch.Size([426, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14040660858154297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14040660858154297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 426, 128]), torch.Size([1, 426, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14081287384033203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16112613677978516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 426, 128])
m.shape torch.Size([449, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16263580322265625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16263580322265625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 449, 128]), torch.Size([1, 449, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16306400299072266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1874713897705078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 449, 128])
m.shape torch.Size([369, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.18955755233764648  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.18955755233764648  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 369, 128]), torch.Size([1, 369, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1899094581604004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2124314308166504  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 369, 128])
m.shape torch.Size([3166, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.22788047790527344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.22788047790527344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1583, 128]), torch.Size([1, 1583, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.22939014434814453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.33710479736328125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 1583, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.33710479736328125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.33710479736328125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1583, 128]), torch.Size([1, 1583, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.33861446380615234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.44504594802856445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 1583, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4224848747253418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.43001508712768555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4375452995300293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.42995595932006836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([7896, 256])
first layer input nodes number: 19542
first layer output nodes number: 7896
edges number: 53302
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.43769311904907227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.445223331451416  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.447420597076416  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.447420597076416  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([362, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4715127944946289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4715127944946289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 362, 256]), torch.Size([1, 362, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.47220325469970703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4778299331665039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 362, 256])
m.shape torch.Size([335, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.47812891006469727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.47812891006469727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 335, 256]), torch.Size([1, 335, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.47876787185668945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.49007272720336914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 335, 256])
m.shape torch.Size([294, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4906010627746582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4906010627746582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4911618232727051  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.504610538482666  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([250, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5052914619445801  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5052914619445801  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5057682991027832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5195965766906738  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([208, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.520472526550293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.520472526550293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.520869255065918  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.535151481628418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([156, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5358529090881348  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5358529090881348  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5361504554748535  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5489449501037598  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([129, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5496644973754883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5496644973754883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5499105453491211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5622129440307617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([143, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5631895065307617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5631895065307617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5634622573852539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5790090560913086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([98, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5797204971313477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5797204971313477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5799074172973633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5918703079223633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.592526912689209  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.592526912689209  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5926756858825684  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.603238582611084  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([68, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6038832664489746  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6038832664489746  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6040129661560059  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6141295433044434  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([77, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6149530410766602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6149530410766602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6150999069213867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6275835037231445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([57, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6282224655151367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6282224655151367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.628331184387207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6383333206176758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([65, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6391539573669434  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6391539573669434  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6392779350280762  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6515517234802246  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([49, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6521964073181152  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6521964073181152  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.652289867401123  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6621966361999512  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([44, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6628265380859375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6628265380859375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6629104614257812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.672393798828125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.672858715057373  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.672858715057373  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6729178428649902  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6800131797790527  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([37, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6806240081787109  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6806240081787109  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.680694580078125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6896572113037109  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([40, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6903524398803711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6903524398803711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6904287338256836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7006521224975586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.701171875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.701171875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7012271881103516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7090263366699219  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.709564208984375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.709564208984375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7096176147460938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7175216674804688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7179813385009766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7179813385009766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7180252075195312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7248249053955078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.725245475769043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.725245475769043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7252836227416992  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7314634323120117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7317905426025391  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7317905426025391  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7318191528320312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7366542816162109  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([243, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7424788475036621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7424788475036621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7429423332214355  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8245158195495605  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 243, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8041520118713379  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8045811653137207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8050103187561035  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8045597076416016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2879, 40])
input nodes number: 7896
output nodes number: 2879
edges number: 23883
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8046479225158691  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8046483993530273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.022559165954589844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 9 input nodes size: 15762
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.020873069763183594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.020873069763183594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.02838897705078125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.02841043472290039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.01907062530517578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.01953887939453125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.01953887939453125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.01953887939453125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([15762, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.01953887939453125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([629, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04054403305053711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04054403305053711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 629, 128]), torch.Size([1, 629, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04114389419555664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04609966278076172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 629, 128])
m.shape torch.Size([703, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04647016525268555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04647016525268555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 703, 128]), torch.Size([1, 703, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04714059829711914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05765962600708008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 703, 128])
m.shape torch.Size([643, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05824422836303711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05824422836303711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 643, 128]), torch.Size([1, 643, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05885744094848633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07245683670043945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 643, 128])
m.shape torch.Size([579, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07325458526611328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07325458526611328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 579, 128]), torch.Size([1, 579, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0738067626953125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08988475799560547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 579, 128])
m.shape torch.Size([522, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09085321426391602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09085321426391602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 522, 128]), torch.Size([1, 522, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09135103225708008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11068296432495117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 522, 128])
m.shape torch.Size([451, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1117243766784668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1117243766784668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 451, 128]), torch.Size([1, 451, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11215448379516602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13064908981323242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 451, 128])
m.shape torch.Size([337, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13155889511108398  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13155889511108398  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 337, 128]), torch.Size([1, 337, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1318802833557129  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1479496955871582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 337, 128])
m.shape torch.Size([369, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14919662475585938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14919662475585938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 369, 128]), torch.Size([1, 369, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14954853057861328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16960716247558594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 369, 128])
m.shape torch.Size([276, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.17061567306518555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.17061567306518555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 276, 128]), torch.Size([1, 276, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.17087888717651367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.18772459030151367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 276, 128])
m.shape torch.Size([2282, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.19847440719604492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.19847440719604492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1141, 128]), torch.Size([1, 1141, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.19956254959106445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2798914909362793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 1141, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2798914909362793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2798914909362793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1141, 128]), torch.Size([1, 1141, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.28097963333129883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.35925769805908203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 1141, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3416891098022461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.34816551208496094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3546419143676758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3481144905090332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([6791, 256])
first layer input nodes number: 15762
first layer output nodes number: 6791
edges number: 42211
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.35476160049438477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3613400459289551  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3628573417663574  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3628573417663574  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([401, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3836522102355957  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3836522102355957  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 401, 256]), torch.Size([1, 401, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3844170570373535  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3906407356262207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 401, 256])
m.shape torch.Size([391, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3910102844238281  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3910102844238281  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 391, 256]), torch.Size([1, 391, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3917560577392578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.40377187728881836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 391, 256])
m.shape torch.Size([310, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4042930603027344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4042930603027344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 310, 256]), torch.Size([1, 310, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.40488433837890625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.41824913024902344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 310, 256])
m.shape torch.Size([254, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4189300537109375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4189300537109375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4194145202636719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.43346405029296875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([219, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.43427467346191406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.43427467346191406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4346923828125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.44972991943359375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([177, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.45054197311401367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.45054197311401367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4508795738220215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4653964042663574  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([123, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.46605539321899414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.46605539321899414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4662899971008301  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.47802019119262695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([141, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4789872169494629  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4789872169494629  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.47925615310668945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4945855140686035  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([94, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.49526453018188477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.49526453018188477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.49544382095336914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5069184303283691  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([110, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5078864097595215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5078864097595215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5080962181091309  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5229926109313965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([79, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5237231254577637  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5237231254577637  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5238738059997559  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5356268882751465  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([65, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5363016128540039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5363016128540039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5364255905151367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5469636917114258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5474767684936523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5474767684936523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5475645065307617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5556364059448242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5562252998352051  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5562252998352051  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5563149452209473  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5651898384094238  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5657796859741211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5657796859741211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5658636093139648  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5747594833374023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5752253532409668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5752253532409668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5752882957458496  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5824007987976074  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5828762054443359  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5828762054443359  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5829353332519531  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5900306701660156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.590416431427002  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.590416431427002  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5904622077941895  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.596275806427002  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5967645645141602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5967645645141602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5968179702758789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6039743423461914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6044669151306152  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6044669151306152  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6045184135437012  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6117796897888184  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([13, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6120166778564453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6120166778564453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6120414733886719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6157112121582031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.615973949432373  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.615973949432373  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6159987449645996  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6198420524597168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6202058792114258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6202058792114258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6202383041381836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6254911422729492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6257519721984863  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6257519721984863  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6257748603820801  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6296429634094238  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([160, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6334762573242188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6334762573242188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6337814331054688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6874923706054688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 160, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6698646545410156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6702909469604492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6707172393798828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6702694892883301  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2859, 40])
input nodes number: 6791
output nodes number: 2859
edges number: 20583
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6703391075134277  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6703395843505859  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.020461559295654297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 10 input nodes size: 20273
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.019067764282226562  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.019067764282226562  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.028734683990478516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.02875661849975586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.021219253540039062  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.021772384643554688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.021772384643554688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.021772384643554688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([20273, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.021772384643554688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([789, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04824638366699219  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04824638366699219  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 789, 128]), torch.Size([1, 789, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04899883270263672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05556535720825195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 789, 128])
m.shape torch.Size([827, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.055977821350097656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.055977821350097656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 827, 128]), torch.Size([1, 827, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.056766510009765625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06941890716552734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 827, 128])
m.shape torch.Size([718, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07005167007446289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07005167007446289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 718, 128]), torch.Size([1, 718, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07073640823364258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08669805526733398  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 718, 128])
m.shape torch.Size([584, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08746957778930664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08746957778930664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 584, 128]), torch.Size([1, 584, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08802652359008789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10510492324829102  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 584, 128])
m.shape torch.Size([568, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10618066787719727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10618066787719727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 568, 128]), torch.Size([1, 568, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10672235488891602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12750864028930664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 568, 128])
m.shape torch.Size([507, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12868833541870117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12868833541870117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 507, 128]), torch.Size([1, 507, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12917184829711914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1499629020690918  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 507, 128])
m.shape torch.Size([426, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.15114307403564453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.15114307403564453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 426, 128]), torch.Size([1, 426, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1515493392944336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.17186260223388672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 426, 128])
m.shape torch.Size([378, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.17310142517089844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.17310142517089844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 378, 128]), torch.Size([1, 378, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1734619140625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.19400978088378906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 378, 128])
m.shape torch.Size([326, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.19522857666015625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.19522857666015625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 326, 128]), torch.Size([1, 326, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1955394744873047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2154369354248047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 326, 128])
m.shape torch.Size([3086, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.23090648651123047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.23090648651123047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1543, 128]), torch.Size([1, 1543, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2323780059814453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3377656936645508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 1543, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3377656936645508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3377656936645508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1543, 128]), torch.Size([1, 1543, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3392372131347656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4429793357849121  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 1543, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4215087890625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4293375015258789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4371662139892578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4292759895324707  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([8209, 256])
first layer input nodes number: 20273
first layer output nodes number: 8209
edges number: 52615
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.437319278717041  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4451479911804199  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4480109214782715  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4480109214782715  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([491, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4691581726074219  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4691581726074219  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 491, 256]), torch.Size([1, 491, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4700946807861328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4775867462158203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 491, 256])
m.shape torch.Size([408, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.477902889251709  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.477902889251709  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 408, 256]), torch.Size([1, 408, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4786810874938965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.49225282669067383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 408, 256])
m.shape torch.Size([316, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.49277496337890625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.49277496337890625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 316, 256]), torch.Size([1, 316, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.493377685546875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5078873634338379  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 316, 256])
m.shape torch.Size([234, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5084857940673828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5084857940673828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5089321136474609  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5218753814697266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([200, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.522613525390625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.522613525390625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5229949951171875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5367279052734375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([176, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5376429557800293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5376429557800293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5379786491394043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5524134635925293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([140, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5531878471374512  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5531878471374512  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5534548759460449  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5668063163757324  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([99, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5674343109130859  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5674343109130859  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5676231384277344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5783863067626953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([98, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5791397094726562  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5791397094726562  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5793266296386719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5912895202636719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([81, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5919747352600098  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5919747352600098  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5921292304992676  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6030983924865723  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([59, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6036453247070312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6036453247070312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6037578582763672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6125354766845703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6131601333618164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6131601333618164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6132726669311523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.622838020324707  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6234440803527832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6234440803527832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6235451698303223  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.632845401763916  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([40, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6333332061767578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6333332061767578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6334095001220703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6409626007080078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([53, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6416888236999512  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6416888236999512  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6417899131774902  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6525053977966309  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([26, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6528549194335938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6528549194335938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6529045104980469  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.65850830078125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.659088134765625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.659088134765625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6591587066650391  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6676273345947266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([34, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6681804656982422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6681804656982422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6682453155517578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6764812469482422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([20, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.676814079284668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.676814079284668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6768522262573242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6819639205932617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6824831962585449  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6824831962585449  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6825366020202637  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6900668144226074  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6904034614562988  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6904034614562988  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6904377937316895  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.695518970489502  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6958613395690918  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6958613395690918  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6958937644958496  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7009196281433105  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7013897895812988  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7013897895812988  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7014317512512207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7082295417785645  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.708554744720459  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.708554744720459  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7085833549499512  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7134184837341309  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([202, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7182579040527344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7182579040527344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7186431884765625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7864532470703125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 202, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7685909271240234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7690272331237793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7694635391235352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.769005298614502  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2926, 40])
input nodes number: 8209
output nodes number: 2926
edges number: 21377
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7690987586975098  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.769099235534668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.022864818572998047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 11 input nodes size: 10465
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.021229267120361328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.021229267120361328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.02621936798095703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.026241302490234375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.016552448272705078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.01689004898071289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.01689004898071289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.01689004898071289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([10465, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.01689004898071289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([862, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03140068054199219  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03140068054199219  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 862, 128]), torch.Size([1, 862, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.032222747802734375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.038799285888671875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 862, 128])
m.shape torch.Size([822, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03917217254638672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03917217254638672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 822, 128]), torch.Size([1, 822, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.039956092834472656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.051943302154541016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 822, 128])
m.shape torch.Size([673, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.052514076232910156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.052514076232910156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 673, 128]), torch.Size([1, 673, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05315589904785156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06730461120605469  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 673, 128])
m.shape torch.Size([548, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06802892684936523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06802892684936523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 548, 128]), torch.Size([1, 548, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06855154037475586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08458852767944336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 548, 128])
m.shape torch.Size([441, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08559370040893555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08559370040893555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 441, 128]), torch.Size([1, 441, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0860142707824707  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10115480422973633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 441, 128])
m.shape torch.Size([338, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10191154479980469  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10191154479980469  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 338, 128]), torch.Size([1, 338, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10223388671875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11609458923339844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 338, 128])
m.shape torch.Size([258, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11679458618164062  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11679458618164062  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 258, 128]), torch.Size([1, 258, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11704063415527344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12934303283691406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 258, 128])
m.shape torch.Size([261, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13021564483642578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13021564483642578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 261, 128]), torch.Size([1, 261, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1304645538330078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1446523666381836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 261, 128])
m.shape torch.Size([197, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14537334442138672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14537334442138672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 197, 128]), torch.Size([1, 197, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14556121826171875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.15758514404296875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 197, 128])
m.shape torch.Size([1167, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1630558967590332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1630558967590332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 583, 128]), torch.Size([1, 583, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16361188888549805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.20472478866577148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 583, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.20472478866577148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.20472478866577148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 584, 128]), torch.Size([1, 584, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.20528173446655273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2451648712158203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 584, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.23375606536865234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.23946428298950195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.24477338790893555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.23902368545532227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([5567, 256])
first layer input nodes number: 10465
first layer output nodes number: 5567
edges number: 28287
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.24445438385009766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.25016260147094727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.25109100341796875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.25109100341796875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([591, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.26809263229370117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.26809263229370117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 591, 256]), torch.Size([1, 591, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.26921987533569336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2794370651245117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 591, 256])
m.shape torch.Size([474, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2797846794128418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2797846794128418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 474, 256]), torch.Size([1, 474, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2806887626647949  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2942500114440918  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 474, 256])
m.shape torch.Size([336, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.294766902923584  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.294766902923584  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 336, 256]), torch.Size([1, 336, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.295407772064209  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.30999088287353516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 336, 256])
m.shape torch.Size([265, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3108839988708496  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3108839988708496  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3113894462585449  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.32689905166625977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([205, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.32763195037841797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.32763195037841797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.32802295684814453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3420991897583008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([147, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.34275150299072266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.34275150299072266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3430318832397461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3550882339477539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([115, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.35572195053100586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.35572195053100586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3559412956237793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.36690855026245117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([107, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.36762189865112305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.36762189865112305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.367825984954834  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3794589042663574  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([86, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.38010120391845703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.38010120391845703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3802652359008789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3907632827758789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([84, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.39148902893066406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.39148902893066406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3916492462158203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.40302467346191406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([54, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4035158157348633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4035158157348633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.40361881256103516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4116525650024414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([53, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4122123718261719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4122123718261719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.41231346130371094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.42090606689453125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([42, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.42138051986694336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.42138051986694336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4214606285095215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.428830623626709  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.42935609817504883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.42935609817504883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.42943620681762695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.43736696243286133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([29, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4377450942993164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4377450942993164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.43780040740966797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4436635971069336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.44409751892089844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.44409751892089844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4441547393798828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4506206512451172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4510335922241211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4510335922241211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.45108509063720703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.45726490020751953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([20, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.45758533477783203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.45758533477783203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4576234817504883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.46246814727783203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([20, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4628143310546875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4628143310546875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.46285247802734375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.46796417236328125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([14, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4682145118713379  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4682145118713379  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.46824121475219727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.47200632095336914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.47223520278930664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.47223520278930664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4722580909729004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4756455421447754  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([9, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.47582483291625977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.47582483291625977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4758419990539551  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4785027503967285  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.478759765625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.478759765625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.47878265380859375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.48249053955078125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.48273324966430664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.48273324966430664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4827542304992676  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.486299991607666  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([97, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4886202812194824  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4886202812194824  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.48880529403686523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5213675498962402  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 97, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5077719688415527  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5082015991210938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5086312294006348  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5081796646118164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2882, 40])
input nodes number: 5567
output nodes number: 2882
edges number: 16962
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5082364082336426  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5082368850708008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.017583847045898438  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 12 input nodes size: 10803
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.016545772552490234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.016545772552490234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.021697044372558594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.021718978881835938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.01670694351196289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.017031192779541016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.017031192779541016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.017031192779541016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([10803, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.017031192779541016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([769, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03148984909057617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03148984909057617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 769, 128]), torch.Size([1, 769, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03222322463989258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03820085525512695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 769, 128])
m.shape torch.Size([776, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03857421875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03857421875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 776, 128]), torch.Size([1, 776, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03931427001953125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05099153518676758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 776, 128])
m.shape torch.Size([656, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0515599250793457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0515599250793457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 656, 128]), torch.Size([1, 656, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0521855354309082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0665135383605957  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 656, 128])
m.shape torch.Size([550, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06724977493286133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06724977493286133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 550, 128]), torch.Size([1, 550, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06777429580688477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08300065994262695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 550, 128])
m.shape torch.Size([455, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08382320404052734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08382320404052734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 455, 128]), torch.Size([1, 455, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08425712585449219  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09987831115722656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 455, 128])
m.shape torch.Size([357, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10085391998291016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10085391998291016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 357, 128]), torch.Size([1, 357, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10119438171386719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11583423614501953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 357, 128])
m.shape torch.Size([299, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11666202545166016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11666202545166016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 299, 128]), torch.Size([1, 299, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11694717407226562  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13120460510253906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 299, 128])
m.shape torch.Size([260, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13205385208129883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13205385208129883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 260, 128]), torch.Size([1, 260, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13230180740356445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14643526077270508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 260, 128])
m.shape torch.Size([214, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14722967147827148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14722967147827148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 214, 128]), torch.Size([1, 214, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14743375778198242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16049528121948242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 214, 128])
m.shape torch.Size([1079, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16553831100463867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16553831100463867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 539, 128]), torch.Size([1, 539, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16605234146118164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2037372589111328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 539, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2037372589111328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2037372589111328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 540, 128]), torch.Size([1, 540, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2042522430419922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.24112749099731445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 540, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.22966957092285156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2348337173461914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.23999786376953125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.23479318618774414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([5415, 256])
first layer input nodes number: 10803
first layer output nodes number: 5415
edges number: 27795
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2400803565979004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.24524450302124023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2472972869873047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2472972869873047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([554, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2637009620666504  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2637009620666504  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 554, 256]), torch.Size([1, 554, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2647576332092285  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2738943099975586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 554, 256])
m.shape torch.Size([457, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2742447853088379  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2742447853088379  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 457, 256]), torch.Size([1, 457, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2751164436340332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2885003089904785  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 457, 256])
m.shape torch.Size([379, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2893805503845215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2893805503845215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2901034355163574  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.30600690841674805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([288, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.30707693099975586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.30707693099975586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.30762624740600586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.32436513900756836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([239, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3252391815185547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3252391815185547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3256950378417969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3421058654785156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([177, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3428988456726074  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3428988456726074  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.34323644638061523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.35775327682495117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([157, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3586411476135254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3586411476135254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.35894060134887695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3739132881164551  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([123, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3747096061706543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3747096061706543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.37494421005249023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.38831663131713867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([91, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.38898658752441406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.38898658752441406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.38916015625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4002685546875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([82, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4009699821472168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4009699821472168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4011263847351074  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4122309684753418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([57, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.41275548934936523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.41275548934936523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.41286420822143555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4213442802429199  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([43, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4217863082885742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4217863082885742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.42186832427978516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.42883968353271484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([35, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.42923641204833984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.42923641204833984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4293031692504883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.43544483184814453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([33, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4358558654785156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4358558654785156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.43591880798339844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4421501159667969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.44265222549438477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.44265222549438477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.44272279739379883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.45020341873168945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([21, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.45049142837524414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.45049142837524414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4505314826965332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.45505762100219727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([20, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4553647041320801  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4553647041320801  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.45540285110473633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.45998048782348633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.46029043197631836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.46029043197631836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4603266716003418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.46492910385131836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([10, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.46509361267089844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.46509361267089844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.46511268615722656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4676685333251953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([9, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.467832088470459  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.467832088470459  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4678492546081543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.47026968002319336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.47040271759033203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.47040271759033203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4704160690307617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.47239208221435547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([3, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.47244930267333984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.47244930267333984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4724550247192383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4733419418334961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([7, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4734940528869629  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4734940528869629  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4735074043273926  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.47567033767700195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([5, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.47577905654907227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.47577905654907227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.47578859329223633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4774003028869629  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([55, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4787173271179199  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4787173271179199  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4788222312927246  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4972853660583496  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 55, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.48430633544921875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4847397804260254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.48517322540283203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.48471784591674805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2908, 40])
input nodes number: 5415
output nodes number: 2908
edges number: 15608
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4847841262817383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4847846031188965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.017711162567138672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 13 input nodes size: 9271
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.016710758209228516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.016710758209228516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.02170085906982422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.021722793579101562  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.01654958724975586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.016848087310791016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.016848087310791016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.016848087310791016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([9271, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.016848087310791016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([792, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.029439449310302734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.029439449310302734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 792, 128]), torch.Size([1, 792, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.030194759368896484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03657245635986328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 792, 128])
m.shape torch.Size([855, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03701019287109375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03701019287109375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 855, 128]), torch.Size([1, 855, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.037825584411621094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05050230026245117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 855, 128])
m.shape torch.Size([687, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05107736587524414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05107736587524414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 687, 128]), torch.Size([1, 687, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.051732540130615234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06642818450927734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 687, 128])
m.shape torch.Size([526, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06710386276245117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06710386276245117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 526, 128]), torch.Size([1, 526, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06760549545288086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08299970626831055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 526, 128])
m.shape torch.Size([473, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08443498611450195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08443498611450195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 473, 128]), torch.Size([1, 473, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08488607406616211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10112524032592773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 473, 128])
m.shape torch.Size([340, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10187244415283203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10187244415283203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 340, 128]), torch.Size([1, 340, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10219669342041016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11613941192626953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 340, 128])
m.shape torch.Size([270, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11687850952148438  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11687850952148438  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 270, 128]), torch.Size([1, 270, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11713600158691406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13001060485839844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 270, 128])
m.shape torch.Size([220, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1307210922241211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1307210922241211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 220, 128]), torch.Size([1, 220, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13093090057373047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14288997650146484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 220, 128])
m.shape torch.Size([171, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14351892471313477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14351892471313477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 171, 128]), torch.Size([1, 171, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14368200302124023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.15411901473999023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 171, 128])
m.shape torch.Size([854, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1581096649169922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1581096649169922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 427, 128]), torch.Size([1, 427, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.15851688385009766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.18742942810058594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 427, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.18742942810058594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.18742942810058594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 427, 128]), torch.Size([1, 427, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1878366470336914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.21654558181762695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 427, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.20710992813110352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.21205759048461914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.21700525283813477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.21201848983764648  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([5188, 256])
first layer input nodes number: 9271
first layer output nodes number: 5188
edges number: 24801
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.21707630157470703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.22202396392822266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2238473892211914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2238473892211914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([538, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.23906946182250977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.23906946182250977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 538, 256]), torch.Size([1, 538, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2400956153869629  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.24956941604614258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 538, 256])
m.shape torch.Size([522, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2502298355102539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2502298355102539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 522, 256]), torch.Size([1, 522, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.25122547149658203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2661600112915039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 522, 256])
m.shape torch.Size([386, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2673954963684082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2673954963684082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 386, 256]), torch.Size([1, 386, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.26813173294067383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2847871780395508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 386, 256])
m.shape torch.Size([269, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2863192558288574  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2863192558288574  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.286832332611084  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3017115592956543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([252, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3028225898742676  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3028225898742676  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.30330324172973633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.32060670852661133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([186, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.321439266204834  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.321439266204834  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3217940330505371  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3370490074157715  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([134, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.33777332305908203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.33777332305908203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3380289077758789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.35080814361572266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([107, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3515033721923828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3515033721923828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.35170745849609375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3633403778076172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([84, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3639650344848633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3639650344848633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.36412525177001953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.37437915802001953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([60, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3748760223388672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3748760223388672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.37499046325683594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3831157684326172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([55, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3836402893066406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3836402893066406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3837451934814453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.39192771911621094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.39255619049072266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.39255619049072266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3926687240600586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4022340774536133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([38, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4026527404785156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4026527404785156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4027252197265625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.409393310546875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([34, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.40981483459472656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.40981483459472656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4098796844482422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.41629981994628906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.41675758361816406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.41675758361816406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4168224334716797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.42369651794433594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([26, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.42406415939331055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.42406415939331055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.42411375045776367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4297175407409668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([19, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.43000364303588867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.43000364303588867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4300398826599121  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4343886375427246  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([11, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.43456125259399414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.43456125259399414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4345822334289551  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.43724679946899414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([7, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4373645782470703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4373645782470703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4373779296875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4391670227050781  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([5, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4392566680908203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4392566680908203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4392662048339844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4406108856201172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.44084835052490234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.44084835052490234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4408712387084961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4442586898803711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([9, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.44443798065185547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.44443798065185547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4444551467895508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4471158981323242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.44724035263061523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.44724035263061523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4472517967224121  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.44910573959350586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.44923877716064453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.44923877716064453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4492502212524414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4511842727661133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([45, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.45226001739501953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.45226001739501953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4523458480834961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4674520492553711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 45, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4556422233581543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.45607519149780273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.45650815963745117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4560532569885254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2904, 40])
input nodes number: 5188
output nodes number: 2904
edges number: 15162
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4561138153076172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4561142921447754  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.01747894287109375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 14 input nodes size: 11259
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.016549110412597656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.016549110412597656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.02191781997680664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.021939754486083984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.016927719116210938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.017320632934570312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.017320632934570312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.017320632934570312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([11259, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.017320632934570312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([610, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.033890724182128906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.033890724182128906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 610, 128]), torch.Size([1, 610, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03447246551513672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03992509841918945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 610, 128])
m.shape torch.Size([642, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04024648666381836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04024648666381836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 642, 128]), torch.Size([1, 642, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04085874557495117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05019569396972656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 642, 128])
m.shape torch.Size([598, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05074501037597656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05074501037597656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 598, 128]), torch.Size([1, 598, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0513153076171875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06392288208007812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 598, 128])
m.shape torch.Size([575, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06473445892333984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06473445892333984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 575, 128]), torch.Size([1, 575, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06528282165527344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0818490982055664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 575, 128])
m.shape torch.Size([453, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08265495300292969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08265495300292969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 453, 128]), torch.Size([1, 453, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08308696746826172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09863948822021484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 453, 128])
m.shape torch.Size([381, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09951353073120117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09951353073120117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 381, 128]), torch.Size([1, 381, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09987688064575195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11550092697143555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 381, 128])
m.shape torch.Size([306, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11634063720703125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11634063720703125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 306, 128]), torch.Size([1, 306, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11663246154785156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1312236785888672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 306, 128])
m.shape torch.Size([288, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13217639923095703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13217639923095703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 288, 128]), torch.Size([1, 288, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13245105743408203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14810657501220703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 288, 128])
m.shape torch.Size([254, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14991426467895508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14991426467895508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 254, 128]), torch.Size([1, 254, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.15015649795532227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16565942764282227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 254, 128])
m.shape torch.Size([1589, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.17311525344848633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.17311525344848633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 794, 128]), torch.Size([1, 794, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1738724708557129  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.22771883010864258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 794, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.22771883010864258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.22771883010864258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 795, 128]), torch.Size([1, 795, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.22847700119018555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.28200864791870117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 795, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2684206962585449  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2738528251647949  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2792849540710449  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.27381038665771484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([5696, 256])
first layer input nodes number: 11259
first layer output nodes number: 5696
edges number: 33161
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2793707847595215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2848029136657715  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.28666067123413086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.28666067123413086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([415, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3058815002441406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3058815002441406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 415, 256]), torch.Size([1, 415, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3066730499267578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3130054473876953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 415, 256])
m.shape torch.Size([380, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3133401870727539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3133401870727539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 380, 256]), torch.Size([1, 380, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.31406497955322266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.32508182525634766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 380, 256])
m.shape torch.Size([332, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.32567691802978516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.32567691802978516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 332, 256]), torch.Size([1, 332, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3263101577758789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3406534194946289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 332, 256])
m.shape torch.Size([286, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3414583206176758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3414583206176758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.34200382232666016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.35831594467163086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([205, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3590373992919922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3590373992919922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.35942840576171875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.373504638671875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([185, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3743762969970703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3743762969970703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3747291564941406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.38990211486816406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([164, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.39082908630371094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.39082908630371094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3911418914794922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4067821502685547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([137, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.40767955780029297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.40767955780029297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4079408645629883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4228353500366211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([133, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4238553047180176  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4238553047180176  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.42410898208618164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.44034433364868164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([89, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.441072940826416  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.441072940826416  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.44124269485473633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4532952308654785  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([73, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4539823532104492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4539823532104492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.45412158966064453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4649820327758789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([69, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.46570825576782227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.46570825576782227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.46583986282348633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.47702646255493164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([70, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.47783565521240234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.47783565521240234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4779691696166992  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4902524948120117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([51, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4908723831176758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4908723831176758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4909696578979492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5005998611450195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5011281967163086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5011281967163086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5012044906616211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5092916488647461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5098533630371094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5098533630371094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5099277496337891  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5183334350585938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5187864303588867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5187864303588867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5188436508178711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5257101058959961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5261659622192383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5261659622192383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.526219367980957  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5330018997192383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5334501266479492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5334501266479492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5334997177124023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5401449203491211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5404853820800781  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5404853820800781  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5405216217041016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5456314086914062  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([15, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5459160804748535  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5459160804748535  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5459446907043457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5501790046691895  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5505242347717285  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5505242347717285  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5505566596984863  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5555825233459473  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5558762550354004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5558762550354004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5559029579162598  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5602288246154785  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5605154037475586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5605154037475586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5605401992797852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5647306442260742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([79, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5666165351867676  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5666165351867676  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5667672157287598  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5932869911193848  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 79, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5780782699584961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5785121917724609  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5789461135864258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5784902572631836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2909, 40])
input nodes number: 5696
output nodes number: 2909
edges number: 19446
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5785555839538574  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5785560607910156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.018104076385498047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 15 input nodes size: 13411
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.016928672790527344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.016928672790527344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.023323535919189453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.023345470428466797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.01795482635498047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.018404006958007812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.018404006958007812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.018404006958007812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([13411, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.018404006958007812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([612, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03876829147338867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03876829147338867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 612, 128]), torch.Size([1, 612, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0393519401550293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0440211296081543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 612, 128])
m.shape torch.Size([711, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04440736770629883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04440736770629883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 711, 128]), torch.Size([1, 711, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04508543014526367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05572223663330078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 711, 128])
m.shape torch.Size([600, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.056241512298583984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.056241512298583984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 600, 128]), torch.Size([1, 600, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.056813716888427734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0697627067565918  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 600, 128])
m.shape torch.Size([549, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07052373886108398  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07052373886108398  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 549, 128]), torch.Size([1, 549, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07104730606079102  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08699178695678711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 549, 128])
m.shape torch.Size([506, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0879364013671875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0879364013671875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 506, 128]), torch.Size([1, 506, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08841896057128906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10579109191894531  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 506, 128])
m.shape torch.Size([407, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10768508911132812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10768508911132812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 407, 128]), torch.Size([1, 407, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10807323455810547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12476348876953125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 407, 128])
m.shape torch.Size([355, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12575435638427734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12575435638427734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 355, 128]), torch.Size([1, 355, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12609291076660156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1430206298828125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 355, 128])
m.shape torch.Size([304, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1440110206604004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1440110206604004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 304, 128]), torch.Size([1, 304, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1443009376525879  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1608262062072754  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 304, 128])
m.shape torch.Size([271, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16184425354003906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16184425354003906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 271, 128]), torch.Size([1, 271, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16210269927978516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.17864322662353516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 271, 128])
m.shape torch.Size([2106, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.18855619430541992  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.18855619430541992  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1053, 128]), torch.Size([1, 1053, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1895604133605957  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.26103734970092773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 1053, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.26103734970092773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.26103734970092773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1053, 128]), torch.Size([1, 1053, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2620415687561035  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3328390121459961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 1053, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.31574058532714844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.32186412811279297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3279876708984375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.32181596755981445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([6421, 256])
first layer input nodes number: 13411
first layer output nodes number: 6421
edges number: 39418
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.32808971405029297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3342132568359375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.33577919006347656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.33577919006347656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([424, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.35634946823120117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.35634946823120117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 424, 256]), torch.Size([1, 424, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.35715818405151367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.36363935470581055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 424, 256])
m.shape torch.Size([404, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3640117645263672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3640117645263672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.36478233337402344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.37680625915527344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([301, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3772892951965332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3772892951965332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.37786340713500977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.39142847061157227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 301, 256])
m.shape torch.Size([271, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.39269256591796875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.39269256591796875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.39320945739746094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4082469940185547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([236, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.40912294387817383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.40912294387817383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4095730781555176  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4257779121398926  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([159, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4264698028564453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4264698028564453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4267730712890625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.43981361389160156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([150, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.440671443939209  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.440671443939209  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.44095754623413086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4552626609802246  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([116, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4560117721557617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4560117721557617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.45623302459716797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4688444137573242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([101, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4696078300476074  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4696078300476074  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4698004722595215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4821295738220215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([83, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4828310012817383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4828310012817383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4829893112182617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4942293167114258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([84, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4950385093688965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4950385093688965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.49519872665405273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5076956748962402  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5083308219909668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5083308219909668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5084490776062012  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.518500804901123  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5190539360046387  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5190539360046387  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5191473960876465  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5277457237243652  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5283045768737793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5283045768737793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5283904075622559  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5368876457214355  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5374937057495117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5374937057495117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5375795364379883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5466775894165039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([41, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5472655296325684  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5472655296325684  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5473437309265137  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.556180477142334  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([20, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5564684867858887  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5564684867858887  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5565066337585449  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5610842704772949  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([21, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5614285469055176  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5614285469055176  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5614686012268066  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5665555000305176  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5670289993286133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5670289993286133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5670804977416992  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5739812850952148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5744748115539551  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5744748115539551  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.574526309967041  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5817875862121582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([15, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5820646286010742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5820646286010742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5820932388305664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5863275527954102  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5866093635559082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5866093635559082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5866360664367676  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5907750129699707  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5910272598266602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5910272598266602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5910501480102539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5947580337524414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5950236320495605  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5950236320495605  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5950465202331543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.598914623260498  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([182, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6032767295837402  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6032767295837402  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6036238670349121  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6647200584411621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 182, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6473608016967773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6477932929992676  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6482257843017578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6477713584899902  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2901, 40])
input nodes number: 6421
output nodes number: 2901
edges number: 20844
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6478400230407715  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6478404998779297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.019285202026367188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 16 input nodes size: 23897
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.01795339584350586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.01795339584350586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.02967214584350586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.029693126678466797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.023276329040527344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.023805618286132812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.023805618286132812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.023805618286132812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([23897, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.023805618286132812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([773, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05063438415527344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05063438415527344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 773, 128]), torch.Size([1, 773, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05137157440185547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05740070343017578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 773, 128])
m.shape torch.Size([860, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05785226821899414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05785226821899414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 860, 128]), torch.Size([1, 860, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.058672428131103516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07154321670532227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 860, 128])
m.shape torch.Size([738, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0721888542175293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0721888542175293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 738, 128]), torch.Size([1, 738, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07289266586303711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08895349502563477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 738, 128])
m.shape torch.Size([622, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08978796005249023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08978796005249023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 622, 128]), torch.Size([1, 622, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09038114547729492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10796117782592773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 622, 128])
m.shape torch.Size([558, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10899496078491211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10899496078491211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 558, 128]), torch.Size([1, 558, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1095271110534668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12869596481323242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 558, 128])
m.shape torch.Size([443, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12969732284545898  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12969732284545898  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 443, 128]), torch.Size([1, 443, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13011980056762695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1482863426208496  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 443, 128])
m.shape torch.Size([394, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14939022064208984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14939022064208984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 394, 128]), torch.Size([1, 394, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1497659683227539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16855335235595703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 394, 128])
m.shape torch.Size([367, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16976547241210938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16976547241210938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 367, 128]), torch.Size([1, 367, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.17011547088623047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1900653839111328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 367, 128])
m.shape torch.Size([321, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1912679672241211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1912679672241211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 321, 128]), torch.Size([1, 321, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1915740966796875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2111663818359375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 321, 128])
m.shape torch.Size([3275, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2266383171081543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2266383171081543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1637, 128]), torch.Size([1, 1637, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.22819948196411133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.33905553817749023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 1637, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.33905553817749023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.33905553817749023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1638, 128]), torch.Size([1, 1638, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.34061765670776367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4538908004760742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 1638, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.43119049072265625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.43915462493896484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.44711875915527344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.43909215927124023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([8351, 256])
first layer input nodes number: 23897
first layer output nodes number: 8351
edges number: 53976
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4472990036010742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4552631378173828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4572596549987793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4572596549987793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([526, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4741659164428711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4741659164428711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 526, 256]), torch.Size([1, 526, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.47516918182373047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.48319530487060547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 526, 256])
m.shape torch.Size([450, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.48355913162231445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.48355913162231445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 450, 256]), torch.Size([1, 450, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4844174385070801  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.498565673828125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 450, 256])
m.shape torch.Size([327, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.49907970428466797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.49907970428466797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 327, 256]), torch.Size([1, 327, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.49970340728759766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5151324272155762  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 327, 256])
m.shape torch.Size([284, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5160117149353027  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5160117149353027  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5165534019470215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5327115058898926  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 284, 256])
m.shape torch.Size([196, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5333828926086426  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5333828926086426  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5337567329406738  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5472149848937988  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([157, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5479335784912109  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5479335784912109  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5482330322265625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5611095428466797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([116, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5617403984069824  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5617403984069824  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5619616508483887  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5730242729187012  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([94, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.573636531829834  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.573636531829834  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5738158226013184  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5840353965759277  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5847678184509277  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5847678184509277  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5849490165710449  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5965456962585449  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([68, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5971088409423828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5971088409423828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5972385406494141  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6064472198486328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6070170402526855  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6070170402526855  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6071314811706543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6160578727722168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([42, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6164851188659668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6164851188659668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6165652275085449  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6233744621276855  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([44, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6238842010498047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6238842010498047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6239681243896484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6316890716552734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([29, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6320376396179199  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6320376396179199  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6320929527282715  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6375689506530762  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([26, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6379165649414062  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6379165649414062  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6379661560058594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6432228088378906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6436285972595215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6436285972595215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6436820030212402  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.649716854095459  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6501479148864746  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6501479148864746  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6502013206481934  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6566100120544434  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([21, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6569466590881348  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6569466590881348  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6569867134094238  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6620736122131348  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([18, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6623826026916504  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6623826026916504  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.662416934967041  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6670174598693848  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([13, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6672506332397461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6672506332397461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6672754287719727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.670771598815918  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([15, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6710619926452637  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6710619926452637  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6710906028747559  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6753249168395996  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([9, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6755013465881348  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6755013465881348  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6755185127258301  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6781792640686035  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6784138679504395  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6784138679504395  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6784348487854004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6818337440490723  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6820540428161621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6820540428161621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6820731163024902  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6852965354919434  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([117, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6880984306335449  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6880984306335449  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.688321590423584  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.727597713470459  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 117, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7139201164245605  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7143349647521973  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.714749813079834  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7143139839172363  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2784, 40])
input nodes number: 8351
output nodes number: 2784
edges number: 16931
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7143797874450684  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7143802642822266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.024841785430908203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 17 input nodes size: 16179
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.023258686065673828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.023258686065673828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.030973434448242188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03099536895751953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.019255638122558594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.01966094970703125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.01966094970703125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.01966094970703125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([16179, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.01966094970703125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([693, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.038263797760009766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.038263797760009766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 693, 128]), torch.Size([1, 693, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0389246940612793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.044672489166259766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 693, 128])
m.shape torch.Size([774, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04508018493652344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04508018493652344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 774, 128]), torch.Size([1, 774, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.045818328857421875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05689048767089844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 774, 128])
m.shape torch.Size([665, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05747270584106445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05747270584106445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 665, 128]), torch.Size([1, 665, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05810689926147461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07247543334960938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 665, 128])
m.shape torch.Size([585, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07327413558959961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07327413558959961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 585, 128]), torch.Size([1, 585, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07383203506469727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09133291244506836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 585, 128])
m.shape torch.Size([487, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09221506118774414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09221506118774414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 487, 128]), torch.Size([1, 487, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09267950057983398  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10939931869506836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 487, 128])
m.shape torch.Size([423, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11037731170654297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11037731170654297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 423, 128]), torch.Size([1, 423, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11078071594238281  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1281270980834961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 423, 128])
m.shape torch.Size([347, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12908363342285156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12908363342285156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 347, 128]), torch.Size([1, 347, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12941455841064453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14596080780029297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 347, 128])
m.shape torch.Size([318, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14700841903686523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14700841903686523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 318, 128]), torch.Size([1, 318, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14731168746948242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1645979881286621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 318, 128])
m.shape torch.Size([270, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1656050682067871  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1656050682067871  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 270, 128]), torch.Size([1, 270, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1658625602722168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1823420524597168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 270, 128])
m.shape torch.Size([1827, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.19092512130737305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.19092512130737305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 913, 128]), torch.Size([1, 913, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.19179582595825195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.254209041595459  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 913, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.254209041595459  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.254209041595459  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 914, 128]), torch.Size([1, 914, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2550806999206543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.31653308868408203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 914, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3012681007385254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3073611259460449  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.31345415115356445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3073134422302246  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([6389, 256])
first layer input nodes number: 16179
first layer output nodes number: 6389
edges number: 37222
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.31357669830322266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3196697235107422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3213481903076172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3213481903076172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([497, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.33843374252319336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.33843374252319336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 497, 256]), torch.Size([1, 497, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.33938169479370117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.34718799591064453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 497, 256])
m.shape torch.Size([473, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.347623348236084  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.347623348236084  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 473, 256]), torch.Size([1, 473, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3485255241394043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.36220788955688477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 473, 256])
m.shape torch.Size([346, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3629155158996582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3629155158996582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 346, 256]), torch.Size([1, 346, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.36357545852661133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.37903642654418945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 346, 256])
m.shape torch.Size([276, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.37998056411743164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.37998056411743164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3805069923400879  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3960127830505371  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([255, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.396975040435791  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.396975040435791  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3974614143371582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.41497087478637695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([160, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4156503677368164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4156503677368164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4159555435180664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4290781021118164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([124, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4297599792480469  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4297599792480469  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4299964904785156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4418220520019531  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([140, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4427804946899414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4427804946899414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.44304752349853516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4582681655883789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([96, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4589653015136719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4589653015136719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4591484069824219  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4708671569824219  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([88, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4716215133666992  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4716215133666992  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4717893600463867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4837064743041992  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([68, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4843416213989258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4843416213989258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.48447132110595703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.49458789825439453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([46, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.495053768157959  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.495053768157959  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.49514150619506836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5025992393493652  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([55, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5032429695129395  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5032429695129395  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5033478736877441  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5129990577697754  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.513458251953125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.513458251953125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5135307312011719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5207061767578125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5212178230285645  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5212178230285645  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5212903022766113  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5289731025695801  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5294289588928223  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5294289588928223  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5294899940490723  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5363869667053223  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([23, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5367326736450195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5367326736450195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5367765426635742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5420408248901367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([23, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.542417049407959  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.542417049407959  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5424609184265137  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.548032283782959  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([17, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5483212471008301  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5483212471008301  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5483536720275879  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5526986122131348  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5529708862304688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5529708862304688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5529994964599609  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5570335388183594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([8, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5571808815002441  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5571808815002441  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5571961402893066  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5594544410705566  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5595741271972656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5595741271972656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5595855712890625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5613594055175781  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([4, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5614423751831055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5614423751831055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5614500045776367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5626859664916992  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([7, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5628437995910645  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5628437995910645  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5628571510314941  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5651135444641113  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([79, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5670051574707031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5670051574707031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5671558380126953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5936756134033203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 79, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5799541473388672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5803885459899902  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5808229446411133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5803666114807129  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2914, 40])
input nodes number: 6389
output nodes number: 2914
edges number: 17144
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5804557800292969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5804562568664551  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.020510196685791016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 18 input nodes size: 23168
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.019275188446044922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.019275188446044922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.030993938446044922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.031015872955322266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.023279190063476562  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.023848533630371094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.023848533630371094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.023848533630371094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([23168, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.023848533630371094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([750, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05230426788330078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05230426788330078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 750, 128]), torch.Size([1, 750, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05301952362060547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05874156951904297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 750, 128])
m.shape torch.Size([841, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05918598175048828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05918598175048828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 841, 128]), torch.Size([1, 841, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05998802185058594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07201862335205078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 841, 128])
m.shape torch.Size([788, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07274484634399414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07274484634399414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 788, 128]), torch.Size([1, 788, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07349634170532227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09002923965454102  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 788, 128])
m.shape torch.Size([655, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09102487564086914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09102487564086914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 655, 128]), torch.Size([1, 655, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09164953231811523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11069536209106445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 655, 128])
m.shape torch.Size([626, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11187553405761719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11187553405761719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 626, 128]), torch.Size([1, 626, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1124725341796875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13463878631591797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 626, 128])
m.shape torch.Size([540, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13588523864746094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13588523864746094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 540, 128]), torch.Size([1, 540, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1364002227783203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.15950584411621094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 540, 128])
m.shape torch.Size([449, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16074705123901367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16074705123901367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 449, 128]), torch.Size([1, 449, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16117525100708008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1825852394104004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 449, 128])
m.shape torch.Size([394, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.18387413024902344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.18387413024902344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 394, 128]), torch.Size([1, 394, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1842498779296875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.20566749572753906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 394, 128])
m.shape torch.Size([327, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.20688295364379883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.20688295364379883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 327, 128]), torch.Size([1, 327, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.20719480514526367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.22715330123901367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 327, 128])
m.shape torch.Size([3331, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.24288082122802734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.24288082122802734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1665, 128]), torch.Size([1, 1665, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.24446868896484375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3614463806152344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 1665, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3614463806152344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3614463806152344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1666, 128]), torch.Size([1, 1666, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3630352020263672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.47737836837768555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 1666, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.453946590423584  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.46224451065063477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.47054243087768555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.46217966079711914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([8701, 256])
first layer input nodes number: 23168
first layer output nodes number: 8701
edges number: 56334
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4707169532775879  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.47901487350463867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4819369316101074  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4819369316101074  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([490, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5022163391113281  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5022163391113281  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 490, 256]), torch.Size([1, 490, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5031509399414062  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5106277465820312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 490, 256])
m.shape torch.Size([402, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5109333992004395  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5109333992004395  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 402, 256]), torch.Size([1, 402, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5117001533508301  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5233626365661621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 402, 256])
m.shape torch.Size([325, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5239167213439941  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5239167213439941  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5245366096496582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5381741523742676  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([246, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5388102531433105  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5388102531433105  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5392794609069824  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5528864860534668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([229, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5538783073425293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5538783073425293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5543150901794434  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5700392723083496  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([175, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5708398818969727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5708398818969727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5711736679077148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5855264663696289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([141, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.586308479309082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.586308479309082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5865774154663086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6000242233276367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([122, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6008281707763672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6008281707763672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6010608673095703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6143245697021484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([102, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6150908470153809  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6150908470153809  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6152853965759277  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6277365684509277  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([84, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6284470558166504  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6284470558166504  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6286072731018066  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6399827003479004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([52, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6404523849487305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6404523849487305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6405515670776367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6482877731323242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([48, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6487917900085449  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6487917900085449  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6488833427429199  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6566653251647949  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([63, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6574068069458008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6574068069458008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.657526969909668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6685819625854492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([53, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6692352294921875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6692352294921875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6693363189697266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6793441772460938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6797986030578613  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6797986030578613  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6798653602600098  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6869416236877441  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6873388290405273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6873388290405273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6873922348022461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6934270858764648  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([23, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6937766075134277  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6937766075134277  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6938204765319824  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6990847587585449  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([20, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.699409008026123  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.699409008026123  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6994471549987793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.704291820526123  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7047114372253418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7047114372253418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7047572135925293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7108912467956543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([16, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7111759185791016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7111759185791016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7112064361572266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7155094146728516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7157769203186035  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7157769203186035  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7158036231994629  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7197556495666504  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7199115753173828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7199115753173828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7199268341064453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7222919464111328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7226381301879883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7226381301879883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7226686477661133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7276124954223633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.727989673614502  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.727989673614502  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7280220985412598  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7335019111633301  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([169, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7375469207763672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7375469207763672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7378692626953125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7946014404296875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 169, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7776031494140625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7780356407165527  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.778468132019043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7780137062072754  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2902, 40])
input nodes number: 8701
output nodes number: 2902
edges number: 19849
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7780985832214355  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7780990600585938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.02496480941772461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 19 input nodes size: 21285
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.02327728271484375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.02327728271484375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.033426761627197266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0334477424621582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.02170705795288086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.022147655487060547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.022147655487060547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.022147655487060547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([21285, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.022147655487060547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([938, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04470539093017578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04470539093017578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 938, 128]), torch.Size([1, 938, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.045599937438964844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.052756309509277344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 938, 128])
m.shape torch.Size([864, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05313301086425781  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05313301086425781  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 864, 128]), torch.Size([1, 864, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05395698547363281  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06631660461425781  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 864, 128])
m.shape torch.Size([815, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06731224060058594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06731224060058594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 815, 128]), torch.Size([1, 815, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06808948516845703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08576059341430664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 815, 128])
m.shape torch.Size([677, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08666324615478516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08666324615478516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 677, 128]), torch.Size([1, 677, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08730888366699219  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10646533966064453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 677, 128])
m.shape torch.Size([571, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10750389099121094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10750389099121094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 571, 128]), torch.Size([1, 571, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1080484390258789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12820768356323242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 571, 128])
m.shape torch.Size([466, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12926864624023438  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12926864624023438  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 466, 128]), torch.Size([1, 466, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1297130584716797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14882278442382812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 466, 128])
m.shape torch.Size([394, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1499156951904297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1499156951904297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 394, 128]), torch.Size([1, 394, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.15029144287109375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16907882690429688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 394, 128])
m.shape torch.Size([341, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.17019176483154297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.17019176483154297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 341, 128]), torch.Size([1, 341, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1705169677734375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.18905353546142578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 341, 128])
m.shape torch.Size([256, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.18998956680297852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.18998956680297852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 256, 128]), torch.Size([1, 256, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.19023370742797852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.20585870742797852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 256, 128])
m.shape torch.Size([2349, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.21693754196166992  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.21693754196166992  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1174, 128]), torch.Size([1, 1174, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.21805715560913086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.29872751235961914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 1174, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.29872751235961914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.29872751235961914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1175, 128]), torch.Size([1, 1175, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2998480796813965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3788485527038574  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 1175, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.36031246185302734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3676280975341797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.37494373321533203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3675708770751953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([7671, 256])
first layer input nodes number: 21285
first layer output nodes number: 7671
edges number: 44750
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3751044273376465  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.38242006301879883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.384310245513916  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.384310245513916  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([629, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3986978530883789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3986978530883789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 629, 256]), torch.Size([1, 629, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.39989757537841797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.40959644317626953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 629, 256])
m.shape torch.Size([458, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.40987730026245117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.40987730026245117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 458, 256]), torch.Size([1, 458, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4107508659362793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.42580747604370117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 458, 256])
m.shape torch.Size([382, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4266376495361328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4266376495361328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 382, 256]), torch.Size([1, 382, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4273662567138672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.44368553161621094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 382, 256])
m.shape torch.Size([253, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4442939758300781  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4442939758300781  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4447765350341797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.458770751953125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([205, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4598093032836914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4598093032836914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.46020030975341797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4742765426635742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([152, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4749579429626465  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4749579429626465  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.475247859954834  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4877142906188965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([124, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4884037971496582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4884037971496582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.48864030838012695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5004658699035645  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([109, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5011858940124512  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5011858940124512  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5013937950134277  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5132441520690918  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([68, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5137286186218262  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5137286186218262  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5138583183288574  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5221590995788574  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([55, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5226230621337891  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5226230621337891  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5227279663085938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5301761627197266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([46, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5306100845336914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5306100845336914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5306978225708008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.537541389465332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([32, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5378665924072266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5378665924072266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5379276275634766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5431156158447266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([27, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5434226989746094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5434226989746094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5434741973876953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5482120513916016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([24, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5485095977783203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5485095977783203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5485553741455078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5530872344970703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([18, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5533242225646973  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5533242225646973  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5533585548400879  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5569977760314941  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([21, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5573039054870605  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5573039054870605  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5573439598083496  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5618700981140137  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([15, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5620951652526855  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5620951652526855  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5621237754821777  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5655570030212402  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([8, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5656814575195312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5656814575195312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5656967163085938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5676345825195312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([18, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5679559707641602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5679559707641602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5679903030395508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5725908279418945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([11, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5727853775024414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5727853775024414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5728063583374023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5757646560668945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([7, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5758957862854004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5758957862854004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5759091377258301  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5778851509094238  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([4, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5779633522033691  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5779633522033691  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5779709815979004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5791535377502441  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.579216480255127  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.579216480255127  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5792222023010254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5801491737365723  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([6, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5802850723266602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5802850723266602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.580296516418457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5822305679321289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([83, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5842194557189941  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5842194557189941  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5843777656555176  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6122403144836426  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 83, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6011676788330078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6015787124633789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.60198974609375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.601557731628418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2758, 40])
input nodes number: 7671
output nodes number: 2758
edges number: 14209
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6016144752502441  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6016149520874023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.023035526275634766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 20 input nodes size: 24390
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.02168560028076172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.02168560028076172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03340435028076172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03342628479003906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.02325582504272461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.023846149444580078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.023846149444580078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.023846149444580078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([24390, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.023846149444580078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([800, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.054317474365234375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.054317474365234375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 800, 128]), torch.Size([1, 800, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.055080413818359375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.061183929443359375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 800, 128])
m.shape torch.Size([850, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06161308288574219  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.06161308288574219  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 850, 128]), torch.Size([1, 850, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0624237060546875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07523918151855469  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 850, 128])
m.shape torch.Size([753, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07591104507446289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07591104507446289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 753, 128]), torch.Size([1, 753, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0766291618347168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09264564514160156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 753, 128])
m.shape torch.Size([687, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0935969352722168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0935969352722168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 687, 128]), torch.Size([1, 687, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09425210952758789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11398458480834961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 687, 128])
m.shape torch.Size([644, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11519241333007812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11519241333007812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 644, 128]), torch.Size([1, 644, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11580657958984375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1381988525390625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 644, 128])
m.shape torch.Size([502, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1393280029296875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1393280029296875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 502, 128]), torch.Size([1, 502, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13980674743652344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16039276123046875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 502, 128])
m.shape torch.Size([445, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16163873672485352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16163873672485352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 445, 128]), torch.Size([1, 445, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1620631217956543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.18328237533569336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 445, 128])
m.shape torch.Size([423, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.18522214889526367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.18522214889526367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 423, 128]), torch.Size([1, 423, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.18562555313110352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2086195945739746  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 423, 128])
m.shape torch.Size([347, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.20990705490112305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.20990705490112305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 347, 128]), torch.Size([1, 347, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.21023797988891602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.23141717910766602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 347, 128])
m.shape torch.Size([3642, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.24882984161376953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.24882984161376953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1821, 128]), torch.Size([1, 1821, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2505664825439453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3738679885864258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 1821, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3738679885864258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3738679885864258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 1821, 128]), torch.Size([1, 1821, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.37560462951660156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.49803781509399414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 1821, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4720325469970703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.48070430755615234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4893760681152344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4806361198425293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([9093, 256])
first layer input nodes number: 24390
first layer output nodes number: 9093
edges number: 59781
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4895601272583008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4982318878173828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5004196166992188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5004196166992188  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([517, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5195722579956055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5195722579956055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 517, 256]), torch.Size([1, 517, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5205583572387695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5290250778198242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 517, 256])
m.shape torch.Size([458, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5294127464294434  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5294127464294434  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 458, 256]), torch.Size([1, 458, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5302863121032715  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5450763702392578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 458, 256])
m.shape torch.Size([335, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5456056594848633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5456056594848633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 335, 256]), torch.Size([1, 335, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5462446212768555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5635251998901367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 335, 256])
m.shape torch.Size([257, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5643668174743652  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5643668174743652  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.564857006072998  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5794782638549805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([226, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5803194046020508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5803194046020508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5807504653930664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5962686538696289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([156, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5969529151916504  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5969529151916504  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5972504615783691  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6100449562072754  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([131, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6107778549194336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6107778549194336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.611027717590332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6235208511352539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([119, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6243109703063965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6243109703063965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6245379447937012  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6374754905700684  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([96, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6381926536560059  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6381926536560059  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6383757591247559  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6500945091247559  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([70, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6506757736206055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6506757736206055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6508092880249023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6602888107299805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([71, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.660973072052002  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.660973072052002  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6611084938049316  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6716713905334473  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([48, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6721572875976562  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6721572875976562  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6722488403320312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6800308227539062  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([37, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6804475784301758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6804475784301758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6805181503295898  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6870107650756836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([35, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6874465942382812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6874465942382812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6875133514404297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.694122314453125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([27, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6944785118103027  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6944785118103027  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6945300102233887  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.699988842010498  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7003936767578125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7003936767578125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7004470825195312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.70648193359375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([22, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7068147659301758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7068147659301758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7068567276000977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7118921279907227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7123041152954102  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7123041152954102  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7123517990112305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7184076309204102  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([18, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7187128067016602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7187128067016602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7187471389770508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7233476638793945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7237343788146973  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7237343788146973  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7237744331359863  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7294220924377441  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([15, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7297048568725586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7297048568725586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7297334671020508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7339677810668945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7342920303344727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7342920303344727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7343225479125977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7390527725219727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7392144203186035  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7392144203186035  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.739229679107666  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.741701602935791  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7419710159301758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7419710159301758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7419939041137695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7458620071411133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([176, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7500796318054199  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7500796318054199  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7504153251647949  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8094973564147949  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 176, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7936615943908691  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7940974235534668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7945332527160645  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7940754890441895  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2924, 40])
input nodes number: 9093
output nodes number: 2924
edges number: 19271
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7941904067993164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7941908836364746  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.025025367736816406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 21 input nodes size: 30001
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.023280620574951172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.023280620574951172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.037586212158203125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03760719299316406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.02586650848388672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.02672576904296875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.02672576904296875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.02672576904296875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([30001, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.02672576904296875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([605, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07177591323852539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07177591323852539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 605, 128]), torch.Size([1, 605, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07235288619995117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07806253433227539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 605, 128])
m.shape torch.Size([639, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0783834457397461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0783834457397461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 639, 128]), torch.Size([1, 639, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07899284362792969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0881338119506836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 639, 128])
m.shape torch.Size([529, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08858585357666016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08858585357666016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 529, 128]), torch.Size([1, 529, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08909034729003906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10055923461914062  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 529, 128])
m.shape torch.Size([524, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10130643844604492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10130643844604492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 524, 128]), torch.Size([1, 524, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1018061637878418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11697530746459961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 524, 128])
m.shape torch.Size([533, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1179962158203125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1179962158203125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 533, 128]), torch.Size([1, 533, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11850452423095703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1377415657043457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 533, 128])
m.shape torch.Size([503, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13892650604248047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13892650604248047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 503, 128]), torch.Size([1, 503, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1394062042236328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1600332260131836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 503, 128])
m.shape torch.Size([477, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16138553619384766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16138553619384766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 477, 128]), torch.Size([1, 477, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16184043884277344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1845855712890625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 477, 128])
m.shape torch.Size([464, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1861281394958496  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1861281394958496  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 464, 128]), torch.Size([1, 464, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1865706443786621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2117934226989746  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 464, 128])
m.shape torch.Size([433, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.21343040466308594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.21343040466308594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 433, 128]), torch.Size([1, 433, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.21384334564208984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.24027156829833984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 433, 128])
m.shape torch.Size([6932, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2732682228088379  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2732682228088379  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 3466, 128]), torch.Size([1, 3466, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.277310848236084  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5155978202819824  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 3466, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5155978202819824  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5155978202819824  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 3466, 128]), torch.Size([1, 3466, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5189032554626465  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7519364356994629  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 3466, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7134900093078613  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7245898246765137  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.735689640045166  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7245030403137207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([11639, 256])
first layer input nodes number: 30001
first layer output nodes number: 11639
edges number: 91517
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7359151840209961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7470149993896484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7500190734863281  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7500190734863281  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([416, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7741570472717285  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7741570472717285  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7749505043029785  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7813639640808105  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 416, 256])
m.shape torch.Size([345, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7816305160522461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7816305160522461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 345, 256]), torch.Size([1, 345, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7822885513305664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7923707962036133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 345, 256])
m.shape torch.Size([239, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7927312850952148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7927312850952148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.793187141418457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8032159805297852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([181, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8036842346191406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8036842346191406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8040294647216797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8140411376953125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([196, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8148107528686523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8148107528686523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8151845932006836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8286428451538086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([169, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8294305801391602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8294305801391602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8297529220581055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8436136245727539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([126, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8443002700805664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8443002700805664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8445405960083008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8565568923950195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([109, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8572750091552734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8572750091552734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.85748291015625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8693332672119141  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([84, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8699560165405273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8699560165405273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8701162338256836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8803701400756836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([89, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8811454772949219  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8811454772949219  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8813152313232422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8933677673339844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([74, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8940653800964355  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8940653800964355  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8942065238952637  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9052157402038574  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([56, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9057912826538086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9057912826538086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9058980941772461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9149770736694336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([47, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9155111312866211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9155111312866211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9156007766723633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9238481521606445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([34, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9242610931396484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9242610931396484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9243259429931641  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9307460784912109  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9312186241149902  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9312186241149902  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9312853813171387  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.938361644744873  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9388513565063477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9388513565063477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9389162063598633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9462442398071289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.946685791015625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.946685791015625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9467411041259766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9533786773681641  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9539046287536621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9539046287536621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9539656639099121  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9617171287536621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9622163772583008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9622163772583008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9622716903686523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9696836471557617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9701943397521973  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9701943397521973  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.970247745513916  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9777779579162598  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9782562255859375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9782562255859375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9783039093017578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9853610992431641  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9856548309326172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9856548309326172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9856834411621094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9901180267333984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9904356002807617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9904356002807617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9904642105102539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9950990676879883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.995661735534668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.995661735534668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9957094192504883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.003767967224121  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([326, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0122365951538086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0122365951538086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 326, 256]), torch.Size([1, 326, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0128583908081055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1265144348144531  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 326, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.105325698852539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1057367324829102  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1061477661132812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1057157516479492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2758, 40])
input nodes number: 11639
output nodes number: 2758
edges number: 23713
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1057987213134766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1057991981506348  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.02825307846069336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 22 input nodes size: 32386
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.025841712951660156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.025841712951660156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.041466712951660156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.041487693786621094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.027161121368408203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.027790546417236328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.027790546417236328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.027790546417236328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([32386, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.027790546417236328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([872, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.062293052673339844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.062293052673339844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 872, 128]), torch.Size([1, 872, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0631246566772461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0697774887084961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 872, 128])
m.shape torch.Size([883, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07020378112792969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.07020378112792969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 883, 128]), torch.Size([1, 883, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0710458755493164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08367729187011719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 883, 128])
m.shape torch.Size([759, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08493280410766602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08493280410766602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 759, 128]), torch.Size([1, 759, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.08565664291381836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10245656967163086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 759, 128])
m.shape torch.Size([637, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10330963134765625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10330963134765625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 637, 128]), torch.Size([1, 637, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10391712188720703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1231536865234375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 637, 128])
m.shape torch.Size([587, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12424945831298828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12424945831298828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 587, 128]), torch.Size([1, 587, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12480926513671875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1451096534729004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 587, 128])
m.shape torch.Size([476, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14619159698486328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14619159698486328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 476, 128]), torch.Size([1, 476, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14664554595947266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16616535186767578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 476, 128])
m.shape torch.Size([429, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16737031936645508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16737031936645508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 429, 128]), torch.Size([1, 429, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16777944564819336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.18823575973510742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 429, 128])
m.shape torch.Size([419, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.18962955474853516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.18962955474853516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 419, 128]), torch.Size([1, 419, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.19002914428710938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.21280574798583984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 419, 128])
m.shape torch.Size([342, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.21407365798950195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.21407365798950195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 342, 128]), torch.Size([1, 342, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2143998146057129  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2352738380432129  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 342, 128])
m.shape torch.Size([4539, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.25675439834594727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.25675439834594727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 2269, 128]), torch.Size([1, 2269, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.25963592529296875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4184403419494629  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 2269, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4184403419494629  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.4184403419494629  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 2270, 128]), torch.Size([1, 2270, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.42066097259521484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5736641883850098  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 2270, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.543881893157959  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5533642768859863  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.563413143157959  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.553856372833252  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([9943, 256])
first layer input nodes number: 32386
first layer output nodes number: 9943
edges number: 68077
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5636568069458008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5731391906738281  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.576380729675293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.576380729675293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([581, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.592719554901123  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.592719554901123  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 581, 256]), torch.Size([1, 581, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.5938277244567871  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6026930809020996  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 581, 256])
m.shape torch.Size([487, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6030755043029785  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6030755043029785  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 487, 256]), torch.Size([1, 487, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6040043830871582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6190042495727539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 487, 256])
m.shape torch.Size([320, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6194624900817871  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6194624900817871  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 320, 256]), torch.Size([1, 320, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6200728416442871  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6345400810241699  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 320, 256])
m.shape torch.Size([250, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6351962089538574  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6351962089538574  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6356730461120605  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6495013236999512  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([204, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6502432823181152  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6502432823181152  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.650632381439209  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.664639949798584  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([144, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.665276050567627  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.665276050567627  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.665550708770752  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.677361011505127  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([127, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6780781745910645  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6780781745910645  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6783204078674316  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.690432071685791  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([98, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6910648345947266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6910648345947266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6912517547607422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7019062042236328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([70, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.702418327331543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.702418327331543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7025518417358398  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7110967636108398  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([68, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7116837501525879  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7116837501525879  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7118134498596191  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7210221290588379  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([61, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7216024398803711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7216024398803711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7217187881469727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7307939529418945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([56, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.731381893157959  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.731381893157959  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7314887046813965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.740567684173584  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([35, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7409520149230957  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7409520149230957  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7410187721252441  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7471604347229004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([28, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7475042343139648  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7475042343139648  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7475576400756836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7528448104858398  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([23, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7531499862670898  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7531499862670898  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7531938552856445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7578439712524414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([18, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7580990791320801  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7580990791320801  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7581334114074707  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7620129585266113  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([19, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7623066902160645  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7623066902160645  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7623429298400879  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7666916847229004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7669157981872559  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7669157981872559  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7669425010681152  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7703337669372559  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([10, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.770503044128418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.770503044128418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7705221176147461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7730779647827148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7734146118164062  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7734146118164062  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7734489440917969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.778289794921875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7784948348999023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7784948348999023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7785158157348633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.781620979309082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7819066047668457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7819066047668457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7819333076477051  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7860722541809082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7862801551818848  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7862801551818848  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7862992286682129  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7893891334533691  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7896566390991211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7896566390991211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7896795272827148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7935476303100586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([116, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7963237762451172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7963237762451172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7965450286865234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8354854583740234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 116, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8232488632202148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8236656188964844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8240823745727539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8236446380615234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2794, 40])
input nodes number: 9943
output nodes number: 2794
edges number: 16287
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8237457275390625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8237462043762207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.029044151306152344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 23 input nodes size: 36878
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.02716684341430664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.02716684341430664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.044751644134521484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.04477262496948242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.029126644134521484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.030280590057373047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.030280590057373047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.030280590057373047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([36878, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.030280590057373047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([509, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09073448181152344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09073448181152344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 509, 128]), torch.Size([1, 509, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09121990203857422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09510326385498047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 509, 128])
m.shape torch.Size([600, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09543275833129883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09543275833129883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 600, 128]), torch.Size([1, 600, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09600496292114258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10539007186889648  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 600, 128])
m.shape torch.Size([512, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10583639144897461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10583639144897461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 512, 128]), torch.Size([1, 512, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10632467269897461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11706686019897461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 512, 128])
m.shape torch.Size([502, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11778020858764648  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11778020858764648  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 502, 128]), torch.Size([1, 502, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11825895309448242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1321425437927246  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 502, 128])
m.shape torch.Size([475, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13303565979003906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13303565979003906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 475, 128]), torch.Size([1, 475, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13348865509033203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1497964859008789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 475, 128])
m.shape torch.Size([435, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.15081453323364258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.15081453323364258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 435, 128]), torch.Size([1, 435, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1512293815612793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1690678596496582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 435, 128])
m.shape torch.Size([439, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.17032575607299805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.17032575607299805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 439, 128]), torch.Size([1, 439, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1707444190979004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.19167757034301758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 439, 128])
m.shape torch.Size([434, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.19312381744384766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.19312381744384766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 434, 128]), torch.Size([1, 434, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.19353771209716797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.21712970733642578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 434, 128])
m.shape torch.Size([460, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.21889686584472656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.21889686584472656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 460, 128]), torch.Size([1, 460, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.21933555603027344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.24741172790527344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 460, 128])
m.shape torch.Size([10227, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2959585189819336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2959585189819336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 5113, 128]), torch.Size([1, 5113, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.30083465576171875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6477923393249512  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 5113, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6477923393249512  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6477923393249512  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 5114, 128]), torch.Size([1, 5114, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6526694297790527  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9968905448913574  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 5114, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9423680305480957  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9562849998474121  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9702019691467285  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9561758041381836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([14593, 256])
first layer input nodes number: 36878
first layer output nodes number: 14593
edges number: 123193
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9704790115356445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9843959808349609  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9878754615783691  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9878754615783691  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([327, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0186700820922852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0186700820922852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 327, 256]), torch.Size([1, 327, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0192937850952148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0249857902526855  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 327, 256])
m.shape torch.Size([296, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0252432823181152  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0252432823181152  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 296, 256]), torch.Size([1, 296, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0258078575134277  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0363836288452148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 296, 256])
m.shape torch.Size([233, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0367732048034668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0367732048034668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.037217617034912  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.046994686126709  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([174, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0474414825439453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0474414825439453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0477733612060547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0573978424072266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([135, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0578808784484863  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0578808784484863  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.058138370513916  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0674080848693848  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([92, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.06781005859375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.06781005859375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0679855346679688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.075531005859375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([93, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0760693550109863  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0760693550109863  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.076246738433838  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.085115909576416  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([75, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.085604190826416  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.085604190826416  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.085747241973877  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0939011573791504  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([84, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0945563316345215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0945563316345215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0947165489196777  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1049704551696777  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([69, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1055536270141602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1055536270141602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1056852340698242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1150293350219727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([53, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1155242919921875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1155242919921875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1156253814697266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1235103607177734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1241750717163086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1241750717163086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.124293327331543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1343450546264648  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([43, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1348233222961426  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1348233222961426  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1349053382873535  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1424508094787598  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1430153846740723  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1430153846740723  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1431012153625488  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1515984535217285  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1519885063171387  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1519885063171387  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.152045726776123  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1581110954284668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1585745811462402  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1585745811462402  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1586356163024902  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1655325889587402  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1659269332885742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1659269332885742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1659765243530273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1719274520874023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([38, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.172560214996338  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.172560214996338  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1726326942443848  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.181837558746338  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([42, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1825685501098633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1825685501098633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1826486587524414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1933832168579102  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.193939208984375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.193939208984375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1939983367919922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2023353576660156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2027502059936523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2027502059936523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2027921676635742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2090024948120117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([26, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.209531307220459  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.209531307220459  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.209580898284912  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2172675132751465  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2176852226257324  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2176852226257324  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2177233695983887  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2239031791687012  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2243456840515137  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2243456840515137  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.22438383102417  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2308306694030762  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([694, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2474875450134277  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2474875450134277  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 694, 256]), torch.Size([1, 694, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2488112449645996  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4824213981628418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 694, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4542016983032227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4546136856079102  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4550256729125977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4545927047729492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2762, 40])
input nodes number: 14593
output nodes number: 2762
edges number: 31584
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4547181129455566  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4547185897827148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03229999542236328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 24 input nodes size: 47543
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.029121875762939453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.029121875762939453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05255937576293945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05258035659790039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03497457504272461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03617048263549805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03617048263549805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03617048263549805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([47543, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03617048263549805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([709, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10259056091308594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10259056091308594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 709, 128]), torch.Size([1, 709, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10326671600341797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10867595672607422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 709, 128])
m.shape torch.Size([784, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1090855598449707  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1090855598449707  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 784, 128]), torch.Size([1, 784, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1098332405090332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12123346328735352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 784, 128])
m.shape torch.Size([748, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12192964553833008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12192964553833008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 748, 128]), torch.Size([1, 748, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12264299392700195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1389298439025879  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 748, 128])
m.shape torch.Size([646, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13980531692504883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13980531692504883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 646, 128]), torch.Size([1, 646, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14042139053344727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.15833330154418945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 646, 128])
m.shape torch.Size([623, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.15951061248779297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.15951061248779297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 623, 128]), torch.Size([1, 623, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16010475158691406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1819138526916504  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 623, 128])
m.shape torch.Size([598, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.18332767486572266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.18332767486572266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 598, 128]), torch.Size([1, 598, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1838979721069336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.20906543731689453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 598, 128])
m.shape torch.Size([553, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.21062612533569336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.21062612533569336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 553, 128]), torch.Size([1, 553, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.21115350723266602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.23852825164794922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 553, 128])
m.shape torch.Size([501, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.24017572402954102  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.24017572402954102  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 501, 128]), torch.Size([1, 501, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.24065351486206055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.26788759231567383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 501, 128])
m.shape torch.Size([489, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.269747257232666  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.269747257232666  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 489, 128]), torch.Size([1, 489, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.27021360397338867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.30005979537963867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 489, 128])
m.shape torch.Size([10879, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.35256099700927734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.35256099700927734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 5439, 128]), torch.Size([1, 5439, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.35774803161621094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7275638580322266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 5439, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7275638580322266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7275638580322266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 5440, 128]), torch.Size([1, 5440, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7327518463134766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1017403602600098  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 5440, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0414977073669434  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0572619438171387  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.073026180267334  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.057138442993164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([16530, 256])
first layer input nodes number: 47543
first layer output nodes number: 16530
edges number: 134878
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0733823776245117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.089146614074707  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0930876731872559  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0930876731872559  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([424, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1181464195251465  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1181464195251465  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 424, 256]), torch.Size([1, 424, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.118955135345459  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1266789436340332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 424, 256])
m.shape torch.Size([342, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.126932144165039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.126932144165039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 342, 256]), torch.Size([1, 342, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.127584457397461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.137789249420166  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 342, 256])
m.shape torch.Size([274, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1382532119750977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1382532119750977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1387758255004883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.15228271484375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([193, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.152763843536377  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.152763843536377  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1531319618225098  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1638073921203613  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([163, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1644067764282227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1644067764282227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.164717674255371  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1759099960327148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([128, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.176492691040039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.176492691040039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.176736831665039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.187234878540039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([106, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.187826156616211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.187826156616211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.188028335571289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1981372833251953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([86, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.198697566986084  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.198697566986084  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1988615989685059  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2082114219665527  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([81, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2088303565979004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2088303565979004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2089848518371582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2188725471496582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([62, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2193913459777832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2193913459777832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2195096015930176  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2279057502746582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([51, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2283859252929688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2283859252929688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2284832000732422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2360706329345703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([51, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2366104125976562  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2366104125976562  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2367076873779297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2449760437011719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([45, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2454900741577148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2454900741577148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2455759048461914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2534723281860352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([30, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.253833293914795  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.253833293914795  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2538905143737793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2595553398132324  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2600460052490234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2600460052490234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2601146697998047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2673931121826172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([41, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2679896354675293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2679896354675293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2680678367614746  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.276904582977295  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2773394584655762  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2773394584655762  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2773947715759277  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2840323448181152  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2845239639282227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2845239639282227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.284581184387207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2918481826782227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2923860549926758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2923860549926758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.292445182800293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.300368309020996  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([38, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3010692596435547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3010692596435547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3011417388916016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.311361312866211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.311910629272461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.311910629272461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3119659423828125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3201522827148438  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3205056190490723  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3205056190490723  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.320539951324463  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3258614540100098  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3263087272644043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3263087272644043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3263487815856934  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3328375816345215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3331174850463867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3331174850463867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3331422805786133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3373327255249023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([436, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.34779691696167  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.34779691696167  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 436, 256]), torch.Size([1, 436, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3486285209655762  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.5062732696533203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 436, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4840798377990723  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4844908714294434  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4849019050598145  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4844698905944824  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2758, 40])
input nodes number: 16530
output nodes number: 2758
edges number: 25520
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4846134185791016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4846138954162598  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03831291198730469  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 25 input nodes size: 44492
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0349736213684082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0349736213684082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0564579963684082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05647897720336914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0330204963684082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03432893753051758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03432893753051758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03432893753051758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([44492, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03432893753051758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([571, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1055445671081543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1055445671081543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 571, 128]), torch.Size([1, 571, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10608911514282227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11044549942016602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 571, 128])
m.shape torch.Size([569, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11071586608886719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11071586608886719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 569, 128]), torch.Size([1, 569, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11125850677490234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11961174011230469  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 569, 128])
m.shape torch.Size([578, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12016725540161133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12016725540161133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 578, 128]), torch.Size([1, 578, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12071847915649414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13355684280395508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 578, 128])
m.shape torch.Size([578, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1343836784362793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1343836784362793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 578, 128]), torch.Size([1, 578, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1349349021911621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.15161466598510742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 578, 128])
m.shape torch.Size([563, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1526813507080078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1526813507080078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 563, 128]), torch.Size([1, 563, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.15321826934814453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1731734275817871  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 563, 128])
m.shape torch.Size([543, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1749591827392578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1749591827392578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 543, 128]), torch.Size([1, 543, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1754770278930664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.19807052612304688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 543, 128])
m.shape torch.Size([517, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1995372772216797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1995372772216797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 517, 128]), torch.Size([1, 517, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.20003032684326172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.22630643844604492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 517, 128])
m.shape torch.Size([475, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.22787189483642578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.22787189483642578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 475, 128]), torch.Size([1, 475, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.22832489013671875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.25414562225341797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 475, 128])
m.shape torch.Size([507, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.25609493255615234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.25609493255615234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 507, 128]), torch.Size([1, 507, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2565784454345703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2875232696533203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 507, 128])
m.shape torch.Size([12135, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.34514570236206055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.34514570236206055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 6067, 128]), torch.Size([1, 6067, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3518061637878418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7636313438415527  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 6067, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7636313438415527  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7636313438415527  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 6068, 128]), torch.Size([1, 6068, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7694182395935059  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1789169311523438  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 6068, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1142420768737793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1304888725280762  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.146735668182373  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.130361557006836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([17036, 256])
first layer input nodes number: 44492
first layer output nodes number: 17036
edges number: 145160
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1470694541931152  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.163316249847412  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1673779487609863  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1673779487609863  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([335, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1968607902526855  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1968607902526855  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 335, 256]), torch.Size([1, 335, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1974997520446777  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2033438682556152  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 335, 256])
m.shape torch.Size([254, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2035126686096191  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2035126686096191  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2039971351623535  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2112641334533691  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([196, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2115874290466309  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2115874290466309  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.211961269378662  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2201857566833496  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([165, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2206335067749023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2206335067749023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2209482192993164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2300748825073242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([164, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.230705738067627  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.230705738067627  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2310185432434082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2422795295715332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([138, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2429189682006836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2429189682006836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2431821823120117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.254500389099121  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([103, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2550621032714844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2550621032714844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.255258560180664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2650814056396484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([83, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2656216621398926  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2656216621398926  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.265779972076416  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.274803638458252  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.275529384613037  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.275529384613037  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2757067680358887  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2870593070983887  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([88, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2878165245056152  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2878165245056152  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2879843711853027  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2999014854431152  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([69, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3005471229553223  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3005471229553223  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3006787300109863  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3109440803527832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([66, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3116397857666016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3116397857666016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3117656707763672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3224658966064453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([60, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.323153018951416  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.323153018951416  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3232674598693848  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3337960243225098  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([52, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3344388008117676  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3344388008117676  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3345379829406738  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3443570137023926  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([51, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3450427055358887  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3450427055358887  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.345139980316162  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3554511070251465  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3559560775756836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3559560775756836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3560247421264648  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.363783836364746  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3643379211425781  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3643379211425781  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3644065856933594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3726463317871094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3732175827026367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3732175827026367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3732843399047852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3817625045776367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.382277011871338  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.382277011871338  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3823342323303223  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3900017738342285  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([35, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.390645980834961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.390645980834961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3907127380371094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.400125503540039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([36, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4008188247680664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4008188247680664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4008874893188477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4110498428344727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4113965034484863  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4113965034484863  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.411430835723877  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4167523384094238  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.417287826538086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.417287826538086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4173355102539062  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4250602722167969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4254751205444336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4254751205444336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.425511360168457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.431635856628418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([571, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.445338249206543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.445338249206543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 571, 256]), torch.Size([1, 571, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.446427345275879  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.6396355628967285  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 571, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.6128392219543457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.6132502555847168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.613661289215088  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.6132292747497559  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2758, 40])
input nodes number: 17036
output nodes number: 2758
edges number: 30211
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.613377571105957  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.6133780479431152  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03660917282104492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 26 input nodes size: 44402
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0330204963684082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0330204963684082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0545048713684082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05452585220336914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0330204963684082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.034464359283447266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.034464359283447266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.034464359283447266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([44402, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.034464359283447266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([528, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11263513565063477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11263513565063477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 528, 128]), torch.Size([1, 528, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11313867568969727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11723470687866211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 528, 128])
m.shape torch.Size([523, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11748170852661133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11748170852661133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 523, 128]), torch.Size([1, 523, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1179804801940918  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12546205520629883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 523, 128])
m.shape torch.Size([499, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12592649459838867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12592649459838867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 499, 128]), torch.Size([1, 499, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1264023780822754  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1368718147277832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 499, 128])
m.shape torch.Size([534, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13765239715576172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13765239715576172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 534, 128]), torch.Size([1, 534, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13816165924072266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.15358257293701172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 534, 128])
m.shape torch.Size([500, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.15452003479003906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.15452003479003906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 500, 128]), torch.Size([1, 500, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1549968719482422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1721630096435547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 500, 128])
m.shape torch.Size([506, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1733722686767578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1733722686767578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 506, 128]), torch.Size([1, 506, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.17385482788085938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.19460487365722656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 506, 128])
m.shape torch.Size([513, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1960759162902832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1960759162902832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 513, 128]), torch.Size([1, 513, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1965651512145996  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.22309494018554688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 513, 128])
m.shape torch.Size([489, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2247157096862793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2247157096862793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 489, 128]), torch.Size([1, 489, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.22518205642700195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.25176382064819336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 489, 128])
m.shape torch.Size([502, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.25368499755859375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.25368499755859375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 502, 128]), torch.Size([1, 502, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2541637420654297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2848033905029297  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 502, 128])
m.shape torch.Size([13671, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.34975242614746094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.34975242614746094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 6835, 128]), torch.Size([1, 6835, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3564729690551758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8230876922607422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 6835, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8230876922607422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8230876922607422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 6836, 128]), torch.Size([1, 6836, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8296070098876953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.289839267730713  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 6836, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2182793617248535  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2356982231140137  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2531170845031738  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2355618476867676  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([18265, 256])
first layer input nodes number: 44402
first layer output nodes number: 18265
edges number: 159474
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2534499168395996  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2708687782287598  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.275223731994629  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.275223731994629  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([321, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3086261749267578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3086261749267578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3092384338378906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3147010803222656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 321, 256])
m.shape torch.Size([236, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3148488998413086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3148488998413086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3152990341186523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3220510482788086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([187, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3223652839660645  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3223652839660645  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3227219581604004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.330568790435791  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([170, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3310441970825195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3310441970825195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3313684463500977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3407716751098633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([121, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.341191291809082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.341191291809082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3414220809936523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3497304916381836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([105, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3502206802368164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3502206802368164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3504209518432617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3590326309204102  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([84, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3594980239868164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3594980239868164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3596582412719727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3676691055297852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([70, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3681273460388184  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3681273460388184  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3682608604431152  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.375871181488037  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([82, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.376513957977295  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.376513957977295  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3766703605651855  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3866801261901855  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([66, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3872365951538086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3872365951538086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3873624801635742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3963003158569336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3969459533691406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3969459533691406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.397073745727539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4070415496826172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([58, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.407646656036377  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.407646656036377  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.40775728225708  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4171605110168457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.417680263519287  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.417680263519287  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4177680015563965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.425839900970459  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([36, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4262804985046387  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4262804985046387  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.42634916305542  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4331469535827637  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([32, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4335741996765137  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4335741996765137  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4336352348327637  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4401049613952637  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4406590461730957  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4406590461730957  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4407315254211426  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4489216804504395  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4493756294250488  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4493756294250488  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4494328498840332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4562993049621582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([38, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4569282531738281  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4569282531738281  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.457000732421875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4662055969238281  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4667539596557617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4667539596557617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4668149948120117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4749937057495117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([35, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4756360054016113  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4756360054016113  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4757027626037598  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4851155281066895  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([33, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.485748291015625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.485748291015625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4858112335205078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.495126724243164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([31, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.495750904083252  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.495750904083252  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4958100318908691  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.5049748420715332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([27, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.505542278289795  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.505542278289795  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.5055937767028809  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.5139365196228027  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.5146489143371582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.5146489143371582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.5147099494934082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.5250248908996582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([784, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.543832778930664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.543832778930664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 784, 256]), torch.Size([1, 784, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.545328140258789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.8215508460998535  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 784, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.7907633781433105  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.7911748886108398  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.7915863990783691  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.791153907775879  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2761, 40])
input nodes number: 18265
output nodes number: 2761
edges number: 34304
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.7913117408752441  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.7913122177124023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03693580627441406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 27 input nodes size: 40851
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.033020973205566406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.033020973205566406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.052552223205566406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05257368087768555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03106832504272461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03250741958618164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03250741958618164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03250741958618164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([40851, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03250741958618164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([446, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10862302780151367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10862302780151367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 446, 128]), torch.Size([1, 446, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10904836654663086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11245107650756836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 446, 128])
m.shape torch.Size([437, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1126551628112793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1126551628112793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 437, 128]), torch.Size([1, 437, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11307191848754883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1193232536315918  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 437, 128])
m.shape torch.Size([451, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11976003646850586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11976003646850586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 451, 128]), torch.Size([1, 451, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12019014358520508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1296525001525879  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 451, 128])
m.shape torch.Size([461, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13031673431396484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13031673431396484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 461, 128]), torch.Size([1, 461, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13075637817382812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14350605010986328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 461, 128])
m.shape torch.Size([461, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14438533782958984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14438533782958984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 461, 128]), torch.Size([1, 461, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14482498168945312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16065216064453125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 461, 128])
m.shape torch.Size([423, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16164255142211914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16164255142211914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 423, 128]), torch.Size([1, 423, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16204595565795898  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.17939233779907227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 423, 128])
m.shape torch.Size([463, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1809234619140625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1809234619140625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 463, 128]), torch.Size([1, 463, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1813650131225586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.20344257354736328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 463, 128])
m.shape torch.Size([432, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.20486974716186523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.20486974716186523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 432, 128]), torch.Size([1, 432, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.20528173446655273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.22876501083374023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 432, 128])
m.shape torch.Size([474, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.23059320449829102  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.23059320449829102  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 474, 128]), torch.Size([1, 474, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.23104524612426758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2599759101867676  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 474, 128])
m.shape torch.Size([13504, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3242030143737793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3242030143737793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 6752, 128]), torch.Size([1, 6752, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3306422233581543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7940821647644043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 6752, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7940821647644043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.7940821647644043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 6752, 128]), torch.Size([1, 6752, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8007349967956543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2570490837097168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 6752, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1882548332214355  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.204993724822998  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2217326164245605  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2048625946044922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([17552, 256])
first layer input nodes number: 40851
first layer output nodes number: 17552
edges number: 155363
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2220392227172852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2387781143188477  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2429628372192383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2429628372192383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([270, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2795591354370117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2795591354370117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.280074119567871  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2854795455932617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([191, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2855892181396484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2855892181396484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2859535217285156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2914180755615234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([181, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2917580604553223  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2917580604553223  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2921032905578613  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2996983528137207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([137, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3000526428222656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3000526428222656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.300313949584961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.307891845703125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([132, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3083958625793457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3083958625793457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.308647632598877  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.317711353302002  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([94, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3181276321411133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3181276321411133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3183069229125977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3260164260864258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([81, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3264718055725098  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3264718055725098  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3266263008117676  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3343510627746582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([69, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3348045349121094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3348045349121094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3349361419677734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.342437744140625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([77, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3430380821228027  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3430380821228027  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3431849479675293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3525843620300293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([71, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.353193759918213  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.353193759918213  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3533291816711426  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3629441261291504  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([68, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3635954856872559  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3635954856872559  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.363725185394287  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3738417625427246  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([73, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3746190071105957  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3746190071105957  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.374758243560791  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3865933418273926  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([62, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.387298583984375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.387298583984375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3874168395996094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3982963562011719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([56, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3989911079406738  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3989911079406738  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3990979194641113  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4096722602844238  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([55, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4104118347167969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4104118347167969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4105167388916016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4216365814208984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([43, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4222455024719238  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4222455024719238  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4223275184631348  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4315953254699707  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([52, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4324040412902832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4324040412902832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4325032234191895  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4444050788879395  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([54, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4452900886535645  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4452900886535645  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4453930854797363  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4584736824035645  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([46, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4592623710632324  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4592623710632324  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4593501091003418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.471107006072998  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([38, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4717936515808105  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4717936515808105  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4718661308288574  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4820857048034668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([34, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4827361106872559  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4827361106872559  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4828009605407715  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.492398738861084  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4930853843688965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4930853843688965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.493150234222412  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.503201961517334  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([29, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.5038108825683594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.5038108825683594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.503866195678711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.512826919555664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([36, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.5136299133300781  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.5136299133300781  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.5136985778808594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.5253028869628906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([839, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.5454282760620117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.5454282760620117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 839, 256]), torch.Size([1, 839, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.5470285415649414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.8364276885986328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 839, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.8025922775268555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.8030128479003906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.8034334182739258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.8029913902282715  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2822, 40])
input nodes number: 17552
output nodes number: 2822
edges number: 37674
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.8031530380249023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.8031535148620605  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.034967899322509766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 28 input nodes size: 47851
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03107738494873047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03107738494873047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05451488494873047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05453634262084961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03498363494873047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.036385536193847656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.036385536193847656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.036385536193847656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([47851, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.036385536193847656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([593, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.112823486328125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.112823486328125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 593, 128]), torch.Size([1, 593, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1133890151977539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11834383010864258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 593, 128])
m.shape torch.Size([668, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1186981201171875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1186981201171875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 668, 128]), torch.Size([1, 668, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11933517456054688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1288909912109375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 668, 128])
m.shape torch.Size([686, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12955379486083984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12955379486083984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 686, 128]), torch.Size([1, 686, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13020801544189453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14507675170898438  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 686, 128])
m.shape torch.Size([562, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14582157135009766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14582157135009766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 562, 128]), torch.Size([1, 562, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14635753631591797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16231632232666016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 562, 128])
m.shape torch.Size([634, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1635599136352539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1635599136352539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 634, 128]), torch.Size([1, 634, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16416454315185547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1866016387939453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 634, 128])
m.shape torch.Size([594, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.18834400177001953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.18834400177001953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 594, 128]), torch.Size([1, 594, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.18891048431396484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.21365833282470703  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 594, 128])
m.shape torch.Size([605, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2153944969177246  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2153944969177246  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 605, 128]), torch.Size([1, 605, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2159714698791504  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2451009750366211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 605, 128])
m.shape torch.Size([580, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2470250129699707  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2470250129699707  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 580, 128]), torch.Size([1, 580, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.24757814407348633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.27951860427856445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 580, 128])
m.shape torch.Size([533, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.28185129165649414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.28185129165649414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 533, 128]), torch.Size([1, 533, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.28235960006713867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.31534719467163086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 533, 128])
m.shape torch.Size([12918, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3766908645629883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3766908645629883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 6459, 128]), torch.Size([1, 6459, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.38285064697265625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.820195198059082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 6459, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.820195198059082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.820195198059082  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 6459, 128]), torch.Size([1, 6459, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.82635498046875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2645277976989746  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 6459, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.196366310119629  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.213888168334961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.231410026550293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2137508392333984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([18373, 256])
first layer input nodes number: 47851
first layer output nodes number: 18373
edges number: 155821
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2317686080932617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2492904663085938  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2536711692810059  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2536711692810059  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([336, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2850513458251953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2850513458251953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 336, 256]), torch.Size([1, 336, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2856922149658203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2915220260620117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 336, 256])
m.shape torch.Size([279, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2917380332946777  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2917380332946777  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2922701835632324  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3015809059143066  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([240, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3020071983337402  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3020071983337402  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3024649620056152  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3125357627868652  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([161, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3129262924194336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3129262924194336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3132333755493164  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.322138786315918  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([165, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3227782249450684  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3227782249450684  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3230929374694824  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3344225883483887  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([115, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3349285125732422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3349285125732422  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3351478576660156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3445796966552734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([93, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3450961112976074  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3450961112976074  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.345273494720459  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.354142665863037  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([81, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3546772003173828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3546772003173828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3548316955566406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.363637924194336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([72, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3641839027404785  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3641839027404785  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.364321231842041  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.373110294342041  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([65, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.373666763305664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.373666763305664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3737907409667969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3825931549072266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([54, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3831024169921875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3831024169921875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3832054138183594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3912391662597656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([64, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3919258117675781  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3919258117675781  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3920478820800781  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4024238586425781  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([55, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.403050422668457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.403050422668457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4031553268432617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.412806510925293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([53, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4134674072265625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4134674072265625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4135684967041016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4235763549804688  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([52, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4242758750915527  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4242758750915527  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.424375057220459  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4348883628845215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4354233741760254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4354233741760254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4354958534240723  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4436860084533691  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([41, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.444319725036621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.444319725036621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4443979263305664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.453782081604004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([39, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4544177055358887  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4544177055358887  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4544920921325684  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4639391899108887  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4644136428833008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4644136428833008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4644670486450195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.471623420715332  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4720773696899414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4720773696899414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4721250534057617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4788484573364258  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([40, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4796323776245117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4796323776245117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4797086715698242  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4910001754760742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4913849830627441  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4913849830627441  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4914231300354004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4973359107971191  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4976930618286133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4976930618286133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.497725486755371  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.5029783248901367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.5034699440002441  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.5034699440002441  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.503511905670166  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.510603427886963  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([679, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.52689790725708  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.52689790725708  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 679, 256]), torch.Size([1, 679, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.5281929969787598  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.7608966827392578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 679, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.7321891784667969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.7326116561889648  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.7330341339111328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.7325901985168457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2834, 40])
input nodes number: 18373
output nodes number: 2834
edges number: 32182
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.7327508926391602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.7327513694763184  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03883075714111328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 29 input nodes size: 48713
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03498554229736328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03498554229736328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05842304229736328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.058444976806640625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.034986019134521484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03639364242553711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03639364242553711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03639364242553711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([48713, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03639364242553711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([558, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11327219009399414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11327219009399414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 558, 128]), torch.Size([1, 558, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11380434036254883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1182403564453125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 558, 128])
m.shape torch.Size([677, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11861991882324219  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11861991882324219  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 677, 128]), torch.Size([1, 677, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11926555633544922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1289501190185547  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 677, 128])
m.shape torch.Size([576, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12945127487182617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12945127487182617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 576, 128]), torch.Size([1, 576, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13000059127807617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1427607536315918  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 576, 128])
m.shape torch.Size([592, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1436152458190918  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1436152458190918  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 592, 128]), torch.Size([1, 592, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1441798210144043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1611628532409668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 592, 128])
m.shape torch.Size([583, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16243696212768555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.16243696212768555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 583, 128]), torch.Size([1, 583, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1629929542541504  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1836075782775879  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 583, 128])
m.shape torch.Size([578, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1849832534790039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1849832534790039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 578, 128]), torch.Size([1, 578, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.18553447723388672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.21002674102783203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 578, 128])
m.shape torch.Size([544, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.21156692504882812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.21156692504882812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 544, 128]), torch.Size([1, 544, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.21208572387695312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.23839187622070312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 544, 128])
m.shape torch.Size([491, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2400054931640625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2400054931640625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 491, 128]), torch.Size([1, 491, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.24047374725341797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2671642303466797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 491, 128])
m.shape torch.Size([548, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.26928186416625977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.26928186416625977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 548, 128]), torch.Size([1, 548, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2698044776916504  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.30338335037231445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 548, 128])
m.shape torch.Size([13171, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.36592626571655273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.36592626571655273  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 6585, 128]), torch.Size([1, 6585, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3722062110900879  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8249964714050293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 6585, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8249964714050293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.8249964714050293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 6586, 128]), torch.Size([1, 6586, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.831967830657959  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2820463180541992  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 6586, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2115325927734375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2290019989013672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2464714050292969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.228865146636963  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([18318, 256])
first layer input nodes number: 48713
first layer output nodes number: 18318
edges number: 156769
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2468366622924805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2643060684204102  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2686734199523926  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2686734199523926  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([319, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.299983024597168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.299983024597168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3005914688110352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3058910369873047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([321, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3062043190002441  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3062043190002441  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.306816577911377  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.316817283630371  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 321, 256])
m.shape torch.Size([232, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3171801567077637  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3171801567077637  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3176226615905762  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3273577690124512  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([169, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3277864456176758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3277864456176758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.328108787536621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3374567031860352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([155, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.338040828704834  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.338040828704834  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.33833646774292  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3489794731140137  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([136, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3496160507202148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3496160507202148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3498754501342773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3610296249389648  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([91, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3615121841430664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3615121841430664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3616857528686523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3703641891479492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([78, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3708772659301758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3708772659301758  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3710260391235352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3795061111450195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([75, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3800806999206543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3800806999206543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3802237510681152  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3893790245056152  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3900575637817383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3900575637817383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3902063369750977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4007692337036133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([74, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.401477336883545  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.401477336883545  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.401618480682373  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4126276969909668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([61, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4132609367370605  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4132609367370605  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.413377285003662  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.423266887664795  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([59, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4239459037780762  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4239459037780762  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.424058437347412  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4344115257263184  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([48, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4350013732910156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4350013732910156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4350929260253906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4441566467285156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([53, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4448752403259277  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4448752403259277  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4449763298034668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4556918144226074  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([59, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4565486907958984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4565486907958984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4566612243652344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4693775177001953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([41, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4699912071228027  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4699912071228027  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.470069408416748  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4794535636901855  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([56, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4803833961486816  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4803833961486816  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4804902076721191  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4940552711486816  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([41, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4947509765625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4947509765625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.4948291778564453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.5053081512451172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([36, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.5059614181518555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.5059614181518555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.5060300827026367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.515711784362793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([46, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.516606330871582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.516606330871582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.5166940689086914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.529679298400879  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([26, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.5301852226257324  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.5301852226257324  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.5302348136901855  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.53792142868042  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([24, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.5384273529052734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.5384273529052734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.538473129272461  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.545888900756836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([33, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.5466275215148926  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.5466275215148926  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.5466904640197754  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.5573277473449707  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([587, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.5714011192321777  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.5714011192321777  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 587, 256]), torch.Size([1, 587, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.5725207328796387  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.7743706703186035  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 587, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.745865821838379  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.746297836303711  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.746729850769043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.7462759017944336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2898, 40])
input nodes number: 18318
output nodes number: 2898
edges number: 32125
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.7464442253112793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.7464447021484375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.038857460021972656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 30 input nodes size: 45160
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03499555587768555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03499555587768555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05652952194213867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.05655050277709961  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.033091068267822266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.034131526947021484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.034131526947021484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.034131526947021484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([45160, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.034131526947021484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([709, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09134292602539062  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09134292602539062  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 709, 128]), torch.Size([1, 709, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09201908111572266  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09797954559326172  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 709, 128])
m.shape torch.Size([836, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09843873977661133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09843873977661133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 836, 128]), torch.Size([1, 836, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09923601150512695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11119508743286133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 836, 128])
m.shape torch.Size([754, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11231231689453125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11231231689453125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 754, 128]), torch.Size([1, 754, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11303138732910156  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12885093688964844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 754, 128])
m.shape torch.Size([681, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1297903060913086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1297903060913086  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 681, 128]), torch.Size([1, 681, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.13043975830078125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1499338150024414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 681, 128])
m.shape torch.Size([665, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.15119457244873047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.15119457244873047  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 665, 128]), torch.Size([1, 665, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.15182876586914062  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.17496299743652344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 665, 128])
m.shape torch.Size([605, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1763768196105957  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1763768196105957  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 605, 128]), torch.Size([1, 605, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.17695379257202148  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.20261859893798828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 605, 128])
m.shape torch.Size([570, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.20423269271850586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.20423269271850586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 570, 128]), torch.Size([1, 570, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.20477628707885742  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.23294496536254883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 570, 128])
m.shape torch.Size([496, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.23456525802612305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.23456525802612305  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 496, 128]), torch.Size([1, 496, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.23503828048706055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.26200056076049805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 496, 128])
m.shape torch.Size([445, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2636737823486328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2636737823486328  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 445, 128]), torch.Size([1, 445, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2640981674194336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2912588119506836  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 445, 128])
m.shape torch.Size([9000, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3340153694152832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3340153694152832  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 4500, 128]), torch.Size([1, 4500, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3384208679199219  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6495456695556641  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 4500, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6495456695556641  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6495456695556641  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 4500, 128]), torch.Size([1, 4500, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6538372039794922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.95989990234375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 4500, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9082379341125488  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9223151206970215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9363923072814941  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9222049713134766  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([14761, 256])
first layer input nodes number: 45160
first layer output nodes number: 14761
edges number: 116285
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9367308616638184  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.950808048248291  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9543275833129883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9543275833129883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([422, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9772028923034668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9772028923034668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 422, 256]), torch.Size([1, 422, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9780077934265137  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9845137596130371  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 422, 256])
m.shape torch.Size([380, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9848418235778809  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9848418235778809  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 380, 256]), torch.Size([1, 380, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9855666160583496  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9964385032653809  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 380, 256])
m.shape torch.Size([267, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9968461990356445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9968461990356445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9973554611206055  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.008896827697754  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([227, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0095152854919434  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0095152854919434  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0099482536315918  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0225043296813965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([179, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0231480598449707  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0231480598449707  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0234894752502441  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.035780429840088  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([136, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0363941192626953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0363941192626953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0366535186767578  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0478076934814453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([135, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.048586368560791  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.048586368560791  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0488438606262207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.061718463897705  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([91, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0622897148132324  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0622897148132324  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0624632835388184  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0723567008972168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([78, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0729446411132812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0729446411132812  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0730934143066406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0826148986816406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([71, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0832233428955078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0832233428955078  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0833587646484375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0929737091064453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0935406684875488  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0935406684875488  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0936551094055176  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.10258150100708  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1032395362854004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1032395362854004  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1033577919006348  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1134095191955566  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([43, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1138877868652344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1138877868652344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1139698028564453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1215152740478516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([40, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1220126152038574  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1220126152038574  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.12208890914917  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1296420097351074  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1301088333129883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1301088333129883  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1301755905151367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.137251853942871  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([26, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1376185417175293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1376185417175293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1376681327819824  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1432719230651855  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1437864303588867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1437864303588867  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1438493728637695  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.151402473449707  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1519246101379395  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1519246101379395  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1519856452941895  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1597371101379395  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.160163402557373  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.160163402557373  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1602110862731934  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1666007041931152  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1669998168945312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1669998168945312  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1670417785644531  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1729583740234375  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1732606887817383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1732606887817383  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1732912063598633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1778078079223633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([9, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.177983283996582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.177983283996582  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1780004501342773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1806612014770508  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1809625625610352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1809625625610352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1809892654418945  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1853151321411133  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1855559349060059  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1855559349060059  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1855769157409668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1891226768493652  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([357, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.197690486907959  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.197690486907959  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 357, 256]), torch.Size([1, 357, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.198371410369873  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3198676109313965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 357, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2999262809753418  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3003392219543457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3007521629333496  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3003182411193848  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2771, 40])
input nodes number: 14761
output nodes number: 2771
edges number: 23248
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3004302978515625  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3004307746887207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0360255241394043  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

pseudo mini batch 31 input nodes size: 46002
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03307199478149414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03307199478149414  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0550074577331543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.055028438568115234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03347349166870117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.034558773040771484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.034558773040771484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.034558773040771484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([46002, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.034558773040771484  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([743, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09420204162597656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.09420204162597656  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 743, 128]), torch.Size([1, 743, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.0949106216430664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10066413879394531  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 743, 128])
m.shape torch.Size([688, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10096597671508789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10096597671508789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 688, 128]), torch.Size([1, 688, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.10162210464477539  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11146402359008789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 688, 128])
m.shape torch.Size([689, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11231231689453125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11231231689453125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 689, 128]), torch.Size([1, 689, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.11296939849853516  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1274251937866211  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 689, 128])
m.shape torch.Size([640, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12831735610961914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12831735610961914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 640, 128]), torch.Size([1, 640, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.12892770767211914  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14762544631958008  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 640, 128])
m.shape torch.Size([605, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14876270294189453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.14876270294189453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 605, 128]), torch.Size([1, 605, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1493396759033203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.17016983032226562  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 605, 128])
m.shape torch.Size([598, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.17159223556518555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.17159223556518555  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 598, 128]), torch.Size([1, 598, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.17216253280639648  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1978011131286621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 598, 128])
m.shape torch.Size([497, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1991748809814453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.1991748809814453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 497, 128]), torch.Size([1, 497, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.19964885711669922  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.22334766387939453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 497, 128])
m.shape torch.Size([493, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2249913215637207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2249913215637207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 493, 128]), torch.Size([1, 493, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.22546148300170898  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.252260684967041  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 493, 128])
m.shape torch.Size([469, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.25403833389282227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.25403833389282227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 469, 128]), torch.Size([1, 469, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2544856071472168  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.2831110954284668  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 469, 128])
m.shape torch.Size([9625, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3287830352783203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3287830352783203  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 4812, 128]), torch.Size([1, 4812, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.3333721160888672  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6591968536376953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 0 shape torch.Size([1, 4812, 128])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6591968536376953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6591968536376953  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 4813, 128]), torch.Size([1, 4813, 128])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.6637868881225586  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9873847961425781  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst 1 shape torch.Size([1, 4813, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9341611862182617  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9491024017333984  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9634523391723633  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9483985900878906  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([15047, 256])
first layer input nodes number: 46002
first layer output nodes number: 15047
edges number: 121253
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9637970924377441  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.978147029876709  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9817347526550293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.9817347526550293  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

m.shape torch.Size([452, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0059151649475098  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0059151649475098  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 452, 256]), torch.Size([1, 452, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.006777286529541  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.014416217803955  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 452, 256])
m.shape torch.Size([343, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0146446228027344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0146446228027344  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 343, 256]), torch.Size([1, 343, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.015298843383789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0288829803466797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 343, 256])
m.shape torch.Size([272, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0293402671813965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0293402671813965  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0298590660095215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0423479080200195  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([212, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0429039001464844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0429039001464844  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0433082580566406  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0550346374511719  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([168, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0556402206420898  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0556402206420898  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0559606552124023  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0674962997436523  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([129, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0680804252624512  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0680804252624512  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.068326473236084  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.078906536102295  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([112, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0795373916625977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0795373916625977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0797510147094727  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0904321670532227  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([89, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0910100936889648  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0910100936889648  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.0911798477172852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.100855827331543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([83, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1014890670776367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1014890670776367  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1016473770141602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1117792129516602  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([71, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1123828887939453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1123828887939453  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.112518310546875  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1221332550048828  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([65, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1227531433105469  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1227531433105469  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1228771209716797  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.132547378540039  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([49, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1330509185791016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1330509185791016  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1331443786621094  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1410884857177734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([56, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1417417526245117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1417417526245117  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1418485641479492  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1516752243041992  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([32, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.152052402496338  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.152052402496338  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.152113437652588  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.158155918121338  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.158644676208496  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.158644676208496  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1587133407592773  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1659917831420898  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1664958000183105  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1664958000183105  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.166562557220459  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1741061210632324  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1745142936706543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1745142936706543  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1745657920837402  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1807456016540527  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([20, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1810660362243652  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1810660362243652  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1811041831970215  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1859488487243652  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1864776611328125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1864776611328125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1865348815917969  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1942024230957031  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1945199966430664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1945199966430664  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.194554328918457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1993951797485352  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1998224258422852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.1998224258422852  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.199864387512207  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2060747146606445  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2064766883850098  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2064766883850098  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.206514835357666  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2124276161193848  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2128286361694336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2128286361694336  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.212864875793457  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.218735694885254  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.219156265258789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.219156265258789  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2191925048828125  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2253170013427734  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([389, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2346458435058594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2346458435058594  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

 h.shape torch.Size([1, 389, 256]), torch.Size([1, 389, 256])
----------------------------------------3
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.2353878021240234  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3690910339355469  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

rst.shape  torch.Size([1, 389, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3478479385375977  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3482604026794434  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.348672866821289  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3482394218444824  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

torch.Size([2768, 40])
input nodes number: 15047
output nodes number: 2768
edges number: 24217
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.348372459411621  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 1.3483729362487793  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03653669357299805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03653669357299805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 0.03653669357299805  GigaBytes
Max Memory Allocated: 1.9047012329101562  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00894957035779953 |0.0016690045595169067 |0.11832066625356674 |8.559226989746094e-05 |0.09654434025287628 |0.004639863967895508 |
----------------------------------------------------------pseudo_mini_loss sum 3.999495506286621
Total (block generation + training)time/epoch 28.853728413581848
* Pure training time/epoch 7.222853422164917
Training time/epoch 7.385246992111206
Training time without block to device /epoch 7.331838846206665
Training time without total dataloading part /epoch 6.883059024810791
load block tensor time/epoch 0.28638625144958496
block to device time/epoch 0.053408145904541016
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  1130905
Number of first layer input nodes during this epoch: Using backend: pytorch
 811150
Number of first layer output nodes during this epoch:  319755
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
