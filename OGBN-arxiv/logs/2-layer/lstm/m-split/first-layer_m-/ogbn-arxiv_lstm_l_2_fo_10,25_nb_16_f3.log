[04:45:39] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28871986 edges into 16 parts and get 6728000 edge cuts
main start at this time 1652849118.6255732
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

<class 'int'>
<class 'int'>
----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.027859210968017578
global_2_local spend time (sec) 0.03467512130737305
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0049741268157958984
A = g.adjacency_matrix() spent  0.0073451995849609375
auxiliary_graph
Graph(num_nodes=154611, num_edges=28962927,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08888578414916992
remove nodes length
63670
auxiliary_graph.remove_nodes spent  1.2751529216766357
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28962927,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1696970462799072

the counter of shared neighbor distribution
Counter({1.0: 23350590, 2.0: 4010844, 3.0: 1004314, 4.0: 300894, 5.0: 109354, 6.0: 47662, 7.0: 22182, 8.0: 11490, 9.0: 6150, 10.0: 3490, 11.0: 2010, 12.0: 1100, 13.0: 704, 14.0: 414, 15.0: 272, 16.0: 202, 17.0: 172, 18.0: 78, 19.0: 52, 21.0: 8, 20.0: 4})
28871986
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28871983, 28871984, 28871985])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23350590, 2.0: 4010844, 3.0: 1004314, 4.0: 300894, 5.0: 109354, 6.0: 47662, 7.0: 22182, 8.0: 11490, 9.0: 6150, 10.0: 3490, 11.0: 2010, 12.0: 1100, 13.0: 704, 14.0: 414, 15.0: 272, 16.0: 202, 17.0: 172, 18.0: 78, 19.0: 52, 21.0: 8, 20.0: 4})
Convert a graph into a bidirected graph: 1.201 seconds
Metis partitioning: 5.424 seconds
Split the graph: 1.205 seconds
Construct subgraphs: 0.098 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  7.949841499328613
5609
5595
5531
5846
5854
5832
5854
5854
5517
5789
5633
5579
5517
5854
5528
5549
total k batches seeds list generation spend  17.85066318511963
after graph partition
graph partition algorithm spend time 17.95117473602295
5609
5595
5531
5846
5854
5832
5854
5854
5517
5789
5633
5579
5517
5854
5528
5549
partition_len_list
[12393, 11946, 10459, 10861, 10969, 10041, 13548, 13982, 25103, 17458, 13913, 11351, 25260, 29576, 28836, 25312]
shared_neighbor_graph_partition_s0 selection method  spend 18.036415100097656
time for parepare:  0.017444849014282227
local_output_nid generation:  0.0011601448059082031
local_in_edges_tensor generation:  0.0014958381652832031
mini_batch_src_global generation:  0.0016028881072998047
r_  generation:  0.013802528381347656
local_output_nid generation:  0.001291036605834961
local_in_edges_tensor generation:  0.0013880729675292969
mini_batch_src_global generation:  0.0016067028045654297
r_  generation:  0.013578653335571289
local_output_nid generation:  0.0013453960418701172
local_in_edges_tensor generation:  0.0013179779052734375
mini_batch_src_global generation:  0.001367807388305664
r_  generation:  0.015342235565185547
local_output_nid generation:  0.002473115921020508
local_in_edges_tensor generation:  0.0013489723205566406
mini_batch_src_global generation:  0.0015544891357421875
r_  generation:  0.015260934829711914
local_output_nid generation:  0.0014355182647705078
local_in_edges_tensor generation:  0.0012576580047607422
mini_batch_src_global generation:  0.0012879371643066406
r_  generation:  0.0135955810546875
local_output_nid generation:  0.001422882080078125
local_in_edges_tensor generation:  0.0012104511260986328
mini_batch_src_global generation:  0.0012485980987548828
r_  generation:  0.010190486907958984
local_output_nid generation:  0.0014564990997314453
local_in_edges_tensor generation:  0.0012969970703125
mini_batch_src_global generation:  0.0013620853424072266
r_  generation:  0.01543116569519043
local_output_nid generation:  0.0014371871948242188
local_in_edges_tensor generation:  0.001538991928100586
mini_batch_src_global generation:  0.0013616085052490234
r_  generation:  0.01777362823486328
local_output_nid generation:  0.0014524459838867188
local_in_edges_tensor generation:  0.0012793540954589844
mini_batch_src_global generation:  0.0017096996307373047
r_  generation:  0.017210721969604492
local_output_nid generation:  0.0015332698822021484
local_in_edges_tensor generation:  0.001508474349975586
mini_batch_src_global generation:  0.001361846923828125
r_  generation:  0.014383554458618164
local_output_nid generation:  0.0015099048614501953
local_in_edges_tensor generation:  0.0012106895446777344
mini_batch_src_global generation:  0.0011510848999023438
r_  generation:  0.012455463409423828
local_output_nid generation:  0.0014870166778564453
local_in_edges_tensor generation:  0.0011553764343261719
mini_batch_src_global generation:  0.0012829303741455078
r_  generation:  0.010304689407348633
local_output_nid generation:  0.0014293193817138672
local_in_edges_tensor generation:  0.0012545585632324219
mini_batch_src_global generation:  0.0019214153289794922
r_  generation:  0.01818394660949707
local_output_nid generation:  0.0015683174133300781
local_in_edges_tensor generation:  0.0025920867919921875
mini_batch_src_global generation:  0.0027589797973632812
r_  generation:  0.026093482971191406
local_output_nid generation:  0.0016410350799560547
local_in_edges_tensor generation:  0.0013823509216308594
mini_batch_src_global generation:  0.0018591880798339844
r_  generation:  0.019139766693115234
local_output_nid generation:  0.0017445087432861328
local_in_edges_tensor generation:  0.001318216323852539
mini_batch_src_global generation:  0.0014493465423583984
r_  generation:  0.016211748123168945
----------------------check_connections_block total spend ----------------------------- 0.4103577136993408
generate_one_block  0.022943735122680664
generate_one_block  0.01937413215637207
generate_one_block  0.01873016357421875
generate_one_block  0.020571470260620117
generate_one_block  0.02545452117919922
generate_one_block  0.017802953720092773
generate_one_block  0.021376848220825195
generate_one_block  0.0216982364654541
generate_one_block  0.025500774383544922
generate_one_block  0.02020096778869629
generate_one_block  0.016602516174316406
generate_one_block  0.014554500579833984
generate_one_block  0.0254061222076416
generate_one_block  0.03995466232299805
generate_one_block  0.030858993530273438
generate_one_block  0.02247762680053711
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03946375846862793
gen group dst list time:  0.007776498794555664
time for parepare:  0.022718191146850586
local_output_nid generation:  0.0023207664489746094
local_in_edges_tensor generation:  0.019344329833984375
mini_batch_src_global generation:  0.002620697021484375
r_  generation:  0.026315689086914062
local_output_nid generation:  0.003277301788330078
local_in_edges_tensor generation:  0.010160684585571289
mini_batch_src_global generation:  0.0028214454650878906
r_  generation:  0.025813817977905273
local_output_nid generation:  0.002919435501098633
local_in_edges_tensor generation:  0.0022089481353759766
mini_batch_src_global generation:  0.002005338668823242
r_  generation:  0.022261857986450195
local_output_nid generation:  0.0030431747436523438
local_in_edges_tensor generation:  0.002294778823852539
mini_batch_src_global generation:  0.0020818710327148438
r_  generation:  0.023713111877441406
local_output_nid generation:  0.002997159957885742
local_in_edges_tensor generation:  0.0022504329681396484
mini_batch_src_global generation:  0.0018873214721679688
r_  generation:  0.022720813751220703
local_output_nid generation:  0.002760648727416992
local_in_edges_tensor generation:  0.0021119117736816406
mini_batch_src_global generation:  0.0016047954559326172
r_  generation:  0.01858234405517578
local_output_nid generation:  0.0037953853607177734
local_in_edges_tensor generation:  0.0031070709228515625
mini_batch_src_global generation:  0.020901203155517578
r_  generation:  0.033745527267456055
local_output_nid generation:  0.005032062530517578
local_in_edges_tensor generation:  0.007727622985839844
mini_batch_src_global generation:  0.01810002326965332
r_  generation:  0.032221078872680664
local_output_nid generation:  0.006469249725341797
local_in_edges_tensor generation:  0.008922338485717773
mini_batch_src_global generation:  0.0064198970794677734
r_  generation:  0.06920123100280762
local_output_nid generation:  0.004781007766723633
local_in_edges_tensor generation:  0.003968477249145508
mini_batch_src_global generation:  0.0051708221435546875
r_  generation:  0.04220175743103027
local_output_nid generation:  0.004038095474243164
local_in_edges_tensor generation:  0.0030889511108398438
mini_batch_src_global generation:  0.0031557083129882812
r_  generation:  0.031041860580444336
local_output_nid generation:  0.00319671630859375
local_in_edges_tensor generation:  0.0024161338806152344
mini_batch_src_global generation:  0.002167940139770508
r_  generation:  0.022977828979492188
local_output_nid generation:  0.006386518478393555
local_in_edges_tensor generation:  0.005307912826538086
mini_batch_src_global generation:  0.006158113479614258
r_  generation:  0.07143521308898926
local_output_nid generation:  0.008265972137451172
local_in_edges_tensor generation:  0.00841069221496582
mini_batch_src_global generation:  0.010050773620605469
r_  generation:  0.08704781532287598
local_output_nid generation:  0.007712125778198242
local_in_edges_tensor generation:  0.007173299789428711
mini_batch_src_global generation:  0.009291410446166992
r_  generation:  0.08334088325500488
local_output_nid generation:  0.007365703582763672
local_in_edges_tensor generation:  0.0064122676849365234
mini_batch_src_global generation:  0.008575439453125
r_  generation:  0.06943082809448242
----------------------check_connections_block total spend ----------------------------- 1.1813008785247803
generate_one_block  0.035494327545166016
generate_one_block  0.03420662879943848
generate_one_block  0.0571286678314209
generate_one_block  0.033626556396484375
generate_one_block  0.03213787078857422
generate_one_block  0.02366495132446289
generate_one_block  0.05070686340332031
generate_one_block  0.04179811477661133
generate_one_block  0.0933218002319336
generate_one_block  0.0571742057800293
generate_one_block  0.03975176811218262
generate_one_block  0.031467437744140625
generate_one_block  0.09606504440307617
generate_one_block  0.11681771278381348
generate_one_block  0.10968756675720215
generate_one_block  0.09433770179748535
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  1.591658592224121
block generation total time  1.3108954429626465
average batch blocks generation time:  0.0819309651851654
pseudo mini batch 0 input nodes size: 22258
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0311279296875 GB
    Memory Allocated: 0.01339101791381836  GigaBytes
Max Memory Allocated: 0.01339101791381836  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0311279296875 GB
    Memory Allocated: 0.013432979583740234  GigaBytes
Max Memory Allocated: 0.013432979583740234  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0311279296875 GB
    Memory Allocated: 0.013432979583740234  GigaBytes
Max Memory Allocated: 0.013432979583740234  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.014360904693603516  GigaBytes
Max Memory Allocated: 0.014360904693603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.014360904693603516  GigaBytes
Max Memory Allocated: 0.014360904693603516  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.014360904693603516  GigaBytes
Max Memory Allocated: 0.014360904693603516  GigaBytes

torch.Size([22258, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.014360904693603516  GigaBytes
Max Memory Allocated: 0.014360904693603516  GigaBytes

m.shape torch.Size([1111, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2401123046875 GB
    Memory Allocated: 0.055025577545166016  GigaBytes
Max Memory Allocated: 0.05566740036010742  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2401123046875 GB
    Memory Allocated: 0.055025577545166016  GigaBytes
Max Memory Allocated: 0.05566740036010742  GigaBytes

 h.shape torch.Size([1, 1111, 128]), torch.Size([1, 1111, 128])
----------------------------------------3
 Nvidia-smi: 1.2401123046875 GB
    Memory Allocated: 0.05608510971069336  GigaBytes
Max Memory Allocated: 0.05608510971069336  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.06456136703491211  GigaBytes
Max Memory Allocated: 0.06509113311767578  GigaBytes

rst.shape  torch.Size([1, 1111, 128])
m.shape torch.Size([1157, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.06513690948486328  GigaBytes
Max Memory Allocated: 0.06516361236572266  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.06513690948486328  GigaBytes
Max Memory Allocated: 0.06516361236572266  GigaBytes

 h.shape torch.Size([1, 1157, 128]), torch.Size([1, 1157, 128])
----------------------------------------3
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.06624031066894531  GigaBytes
Max Memory Allocated: 0.06624031066894531  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.08279132843017578  GigaBytes
Max Memory Allocated: 0.08389472961425781  GigaBytes

rst.shape  torch.Size([1, 1157, 128])
m.shape torch.Size([1087, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.08437967300415039  GigaBytes
Max Memory Allocated: 0.08441638946533203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.08437967300415039  GigaBytes
Max Memory Allocated: 0.08441638946533203  GigaBytes

 h.shape torch.Size([1, 1087, 128]), torch.Size([1, 1087, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.08541631698608398  GigaBytes
Max Memory Allocated: 0.08541631698608398  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.10896062850952148  GigaBytes
Max Memory Allocated: 0.11051559448242188  GigaBytes

rst.shape  torch.Size([1, 1087, 128])
m.shape torch.Size([933, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.11022186279296875  GigaBytes
Max Memory Allocated: 0.11051559448242188  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.11022186279296875  GigaBytes
Max Memory Allocated: 0.11051559448242188  GigaBytes

 h.shape torch.Size([1, 933, 128]), torch.Size([1, 933, 128])
----------------------------------------3
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.11111164093017578  GigaBytes
Max Memory Allocated: 0.11111164093017578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.1369152069091797  GigaBytes
Max Memory Allocated: 0.13869476318359375  GigaBytes

rst.shape  torch.Size([1, 933, 128])
m.shape torch.Size([873, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.1385517120361328  GigaBytes
Max Memory Allocated: 0.13869476318359375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.1385517120361328  GigaBytes
Max Memory Allocated: 0.13869476318359375  GigaBytes

 h.shape torch.Size([1, 873, 128]), torch.Size([1, 873, 128])
----------------------------------------3
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.13938426971435547  GigaBytes
Max Memory Allocated: 0.13938426971435547  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.16969728469848633  GigaBytes
Max Memory Allocated: 0.17177867889404297  GigaBytes

rst.shape  torch.Size([1, 873, 128])
m.shape torch.Size([710, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.1713123321533203  GigaBytes
Max Memory Allocated: 0.17177867889404297  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.1713123321533203  GigaBytes
Max Memory Allocated: 0.17177867889404297  GigaBytes

 h.shape torch.Size([1, 710, 128]), torch.Size([1, 710, 128])
----------------------------------------3
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.17198944091796875  GigaBytes
Max Memory Allocated: 0.17198944091796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4041748046875 GB
    Memory Allocated: 0.2017650604248047  GigaBytes
Max Memory Allocated: 0.20379638671875  GigaBytes

rst.shape  torch.Size([1, 710, 128])
m.shape torch.Size([651, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4041748046875 GB
    Memory Allocated: 0.2035994529724121  GigaBytes
Max Memory Allocated: 0.20379638671875  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4041748046875 GB
    Memory Allocated: 0.2035994529724121  GigaBytes
Max Memory Allocated: 0.20379638671875  GigaBytes

 h.shape torch.Size([1, 651, 128]), torch.Size([1, 651, 128])
----------------------------------------3
 Nvidia-smi: 1.4041748046875 GB
    Memory Allocated: 0.20422029495239258  GigaBytes
Max Memory Allocated: 0.20422029495239258  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4295654296875 GB
    Memory Allocated: 0.23526239395141602  GigaBytes
Max Memory Allocated: 0.23743534088134766  GigaBytes

rst.shape  torch.Size([1, 651, 128])
m.shape torch.Size([587, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4295654296875 GB
    Memory Allocated: 0.23719120025634766  GigaBytes
Max Memory Allocated: 0.23743534088134766  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4295654296875 GB
    Memory Allocated: 0.23719120025634766  GigaBytes
Max Memory Allocated: 0.23743534088134766  GigaBytes

 h.shape torch.Size([1, 587, 128]), torch.Size([1, 587, 128])
----------------------------------------3
 Nvidia-smi: 1.4295654296875 GB
    Memory Allocated: 0.23775100708007812  GigaBytes
Max Memory Allocated: 0.23775100708007812  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4744873046875 GB
    Memory Allocated: 0.27059459686279297  GigaBytes
Max Memory Allocated: 0.27283382415771484  GigaBytes

rst.shape  torch.Size([1, 587, 128])
m.shape torch.Size([474, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4744873046875 GB
    Memory Allocated: 0.27234888076782227  GigaBytes
Max Memory Allocated: 0.27283382415771484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4744873046875 GB
    Memory Allocated: 0.27234888076782227  GigaBytes
Max Memory Allocated: 0.27283382415771484  GigaBytes

 h.shape torch.Size([1, 474, 128]), torch.Size([1, 474, 128])
----------------------------------------3
 Nvidia-smi: 1.4744873046875 GB
    Memory Allocated: 0.27280092239379883  GigaBytes
Max Memory Allocated: 0.27283382415771484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5037841796875 GB
    Memory Allocated: 0.30173158645629883  GigaBytes
Max Memory Allocated: 0.30376577377319336  GigaBytes

rst.shape  torch.Size([1, 474, 128])
m.shape torch.Size([4810, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5272216796875 GB
    Memory Allocated: 0.32494306564331055  GigaBytes
Max Memory Allocated: 0.32548093795776367  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5272216796875 GB
    Memory Allocated: 0.32494306564331055  GigaBytes
Max Memory Allocated: 0.32548093795776367  GigaBytes

 h.shape torch.Size([1, 2405, 128]), torch.Size([1, 2405, 128])
----------------------------------------3
 Nvidia-smi: 1.5272216796875 GB
    Memory Allocated: 0.3272366523742676  GigaBytes
Max Memory Allocated: 0.3272366523742676  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.49068117141723633  GigaBytes
Max Memory Allocated: 0.5023999214172363  GigaBytes

rst 0 shape torch.Size([1, 2405, 128])
----------------------------------------1
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.49068117141723633  GigaBytes
Max Memory Allocated: 0.5023999214172363  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.49068117141723633  GigaBytes
Max Memory Allocated: 0.5023999214172363  GigaBytes

 h.shape torch.Size([1, 2405, 128]), torch.Size([1, 2405, 128])
----------------------------------------3
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.49297475814819336  GigaBytes
Max Memory Allocated: 0.5023999214172363  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.6552095413208008  GigaBytes
Max Memory Allocated: 0.6680750846862793  GigaBytes

rst 1 shape torch.Size([1, 2405, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.8826904296875 GB
    Memory Allocated: 0.6206703186035156  GigaBytes
Max Memory Allocated: 0.6718707084655762  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.8826904296875 GB
    Memory Allocated: 0.6324892044067383  GigaBytes
Max Memory Allocated: 0.6718707084655762  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.8826904296875 GB
    Memory Allocated: 0.6443080902099609  GigaBytes
Max Memory Allocated: 0.6718707084655762  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.8826904296875 GB
    Memory Allocated: 0.6323966979980469  GigaBytes
Max Memory Allocated: 0.6718707084655762  GigaBytes

torch.Size([12393, 256])
first layer input nodes number: 22258
first layer output nodes number: 12393
edges number: 80662
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.8826904296875 GB
    Memory Allocated: 0.6444759368896484  GigaBytes
Max Memory Allocated: 0.6718707084655762  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.8826904296875 GB
    Memory Allocated: 0.6562948226928711  GigaBytes
Max Memory Allocated: 0.6718707084655762  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.6599006652832031  GigaBytes
Max Memory Allocated: 0.6718707084655762  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.6599006652832031  GigaBytes
Max Memory Allocated: 0.6718707084655762  GigaBytes

m.shape torch.Size([813, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.9393310546875 GB
    Memory Allocated: 0.7029623985290527  GigaBytes
Max Memory Allocated: 0.7029657363891602  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9393310546875 GB
    Memory Allocated: 0.7029623985290527  GigaBytes
Max Memory Allocated: 0.7029657363891602  GigaBytes

 h.shape torch.Size([1, 813, 256]), torch.Size([1, 813, 256])
----------------------------------------3
 Nvidia-smi: 1.9412841796875 GB
    Memory Allocated: 0.7045130729675293  GigaBytes
Max Memory Allocated: 0.7045130729675293  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.7169184684753418  GigaBytes
Max Memory Allocated: 0.7176938056945801  GigaBytes

rst.shape  torch.Size([1, 813, 256])
m.shape torch.Size([699, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.7180066108703613  GigaBytes
Max Memory Allocated: 0.7180118560791016  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.7180066108703613  GigaBytes
Max Memory Allocated: 0.7180118560791016  GigaBytes

 h.shape torch.Size([1, 699, 256]), torch.Size([1, 699, 256])
----------------------------------------3
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.7193398475646973  GigaBytes
Max Memory Allocated: 0.7193398475646973  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9530029296875 GB
    Memory Allocated: 0.7395215034484863  GigaBytes
Max Memory Allocated: 0.7414660453796387  GigaBytes

rst.shape  torch.Size([1, 699, 256])
m.shape torch.Size([579, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.9530029296875 GB
    Memory Allocated: 0.7408127784729004  GigaBytes
Max Memory Allocated: 0.7414660453796387  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9530029296875 GB
    Memory Allocated: 0.7408127784729004  GigaBytes
Max Memory Allocated: 0.7414660453796387  GigaBytes

 h.shape torch.Size([1, 579, 256]), torch.Size([1, 579, 256])
----------------------------------------3
 Nvidia-smi: 1.9530029296875 GB
    Memory Allocated: 0.7419171333312988  GigaBytes
Max Memory Allocated: 0.7419171333312988  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.7672219276428223  GigaBytes
Max Memory Allocated: 0.7688784599304199  GigaBytes

rst.shape  torch.Size([1, 579, 256])
m.shape torch.Size([476, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.7684998512268066  GigaBytes
Max Memory Allocated: 0.7688784599304199  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.7684998512268066  GigaBytes
Max Memory Allocated: 0.7688784599304199  GigaBytes

 h.shape torch.Size([1, 476, 256]), torch.Size([1, 476, 256])
----------------------------------------3
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.7694077491760254  GigaBytes
Max Memory Allocated: 0.7694077491760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.7963242530822754  GigaBytes
Max Memory Allocated: 0.7981400489807129  GigaBytes

rst.shape  torch.Size([1, 476, 256])
m.shape torch.Size([381, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.797701358795166  GigaBytes
Max Memory Allocated: 0.7981400489807129  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.797701358795166  GigaBytes
Max Memory Allocated: 0.7981400489807129  GigaBytes

 h.shape torch.Size([1, 381, 256]), torch.Size([1, 381, 256])
----------------------------------------3
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.7984280586242676  GigaBytes
Max Memory Allocated: 0.7984280586242676  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0213623046875 GB
    Memory Allocated: 0.8245892524719238  GigaBytes
Max Memory Allocated: 0.8264060020446777  GigaBytes

rst.shape  torch.Size([1, 381, 256])
m.shape torch.Size([313, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0213623046875 GB
    Memory Allocated: 0.8260312080383301  GigaBytes
Max Memory Allocated: 0.8264060020446777  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0213623046875 GB
    Memory Allocated: 0.8260312080383301  GigaBytes
Max Memory Allocated: 0.8264060020446777  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 2.0213623046875 GB
    Memory Allocated: 0.8266282081604004  GigaBytes
Max Memory Allocated: 0.8266282081604004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.8533377647399902  GigaBytes
Max Memory Allocated: 0.8551287651062012  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([291, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.8558697700500488  GigaBytes
Max Memory Allocated: 0.8558773994445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.8558697700500488  GigaBytes
Max Memory Allocated: 0.8558773994445801  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.8564248085021973  GigaBytes
Max Memory Allocated: 0.8564248085021973  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0877685546875 GB
    Memory Allocated: 0.8848366737365723  GigaBytes
Max Memory Allocated: 0.8867793083190918  GigaBytes

rst.shape  torch.Size([1, 291, 256])
m.shape torch.Size([232, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.0877685546875 GB
    Memory Allocated: 0.8863430023193359  GigaBytes
Max Memory Allocated: 0.8867793083190918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0877685546875 GB
    Memory Allocated: 0.8863430023193359  GigaBytes
Max Memory Allocated: 0.8867793083190918  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 2.0877685546875 GB
    Memory Allocated: 0.8867855072021484  GigaBytes
Max Memory Allocated: 0.8867855072021484  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.9120082855224609  GigaBytes
Max Memory Allocated: 0.9137783050537109  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([197, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.9134912490844727  GigaBytes
Max Memory Allocated: 0.9137783050537109  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.9134912490844727  GigaBytes
Max Memory Allocated: 0.9137783050537109  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.9138669967651367  GigaBytes
Max Memory Allocated: 0.9138669967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1424560546875 GB
    Memory Allocated: 0.9379148483276367  GigaBytes
Max Memory Allocated: 0.939605712890625  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([170, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.1424560546875 GB
    Memory Allocated: 0.9393610954284668  GigaBytes
Max Memory Allocated: 0.939605712890625  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1424560546875 GB
    Memory Allocated: 0.9393610954284668  GigaBytes
Max Memory Allocated: 0.939605712890625  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 2.1424560546875 GB
    Memory Allocated: 0.9396853446960449  GigaBytes
Max Memory Allocated: 0.9396853446960449  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1619873046875 GB
    Memory Allocated: 0.9627070426940918  GigaBytes
Max Memory Allocated: 0.9643282890319824  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([159, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.1619873046875 GB
    Memory Allocated: 0.964226245880127  GigaBytes
Max Memory Allocated: 0.9643282890319824  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1619873046875 GB
    Memory Allocated: 0.964226245880127  GigaBytes
Max Memory Allocated: 0.9643282890319824  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 2.1619873046875 GB
    Memory Allocated: 0.9645295143127441  GigaBytes
Max Memory Allocated: 0.9645295143127441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1873779296875 GB
    Memory Allocated: 0.9881844520568848  GigaBytes
Max Memory Allocated: 0.9898524284362793  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([122, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.1873779296875 GB
    Memory Allocated: 0.9894399642944336  GigaBytes
Max Memory Allocated: 0.9898524284362793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1873779296875 GB
    Memory Allocated: 0.9894399642944336  GigaBytes
Max Memory Allocated: 0.9898524284362793  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 2.1873779296875 GB
    Memory Allocated: 0.9896726608276367  GigaBytes
Max Memory Allocated: 0.9898524284362793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2049560546875 GB
    Memory Allocated: 1.0094518661499023  GigaBytes
Max Memory Allocated: 1.010848045349121  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([104, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2049560546875 GB
    Memory Allocated: 1.0106353759765625  GigaBytes
Max Memory Allocated: 1.010848045349121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2049560546875 GB
    Memory Allocated: 1.0106353759765625  GigaBytes
Max Memory Allocated: 1.010848045349121  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 2.2049560546875 GB
    Memory Allocated: 1.010833740234375  GigaBytes
Max Memory Allocated: 1.010848045349121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2244873046875 GB
    Memory Allocated: 1.029083251953125  GigaBytes
Max Memory Allocated: 1.0303726196289062  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([105, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2244873046875 GB
    Memory Allocated: 1.0303969383239746  GigaBytes
Max Memory Allocated: 1.030402660369873  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2244873046875 GB
    Memory Allocated: 1.0303969383239746  GigaBytes
Max Memory Allocated: 1.030402660369873  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 2.2244873046875 GB
    Memory Allocated: 1.03059720993042  GigaBytes
Max Memory Allocated: 1.03059720993042  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2440185546875 GB
    Memory Allocated: 1.0504240989685059  GigaBytes
Max Memory Allocated: 1.051826000213623  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([93, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2440185546875 GB
    Memory Allocated: 1.0516648292541504  GigaBytes
Max Memory Allocated: 1.051826000213623  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2440185546875 GB
    Memory Allocated: 1.0516648292541504  GigaBytes
Max Memory Allocated: 1.051826000213623  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 2.2440185546875 GB
    Memory Allocated: 1.051842212677002  GigaBytes
Max Memory Allocated: 1.051842212677002  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 1.0706448554992676  GigaBytes
Max Memory Allocated: 1.0719752311706543  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([75, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 1.0717096328735352  GigaBytes
Max Memory Allocated: 1.0719752311706543  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 1.0717096328735352  GigaBytes
Max Memory Allocated: 1.0719752311706543  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 1.071852684020996  GigaBytes
Max Memory Allocated: 1.0719752311706543  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2772216796875 GB
    Memory Allocated: 1.088017463684082  GigaBytes
Max Memory Allocated: 1.0897960662841797  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([80, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2772216796875 GB
    Memory Allocated: 1.0897350311279297  GigaBytes
Max Memory Allocated: 1.0897960662841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2772216796875 GB
    Memory Allocated: 1.0897350311279297  GigaBytes
Max Memory Allocated: 1.0897960662841797  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 2.2772216796875 GB
    Memory Allocated: 1.0898876190185547  GigaBytes
Max Memory Allocated: 1.0898876190185547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3143310546875 GB
    Memory Allocated: 1.1081981658935547  GigaBytes
Max Memory Allocated: 1.1094951629638672  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([49, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 1.1089696884155273  GigaBytes
Max Memory Allocated: 1.1094951629638672  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 1.1089696884155273  GigaBytes
Max Memory Allocated: 1.1094951629638672  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 1.1090631484985352  GigaBytes
Max Memory Allocated: 1.1094951629638672  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 1.1209325790405273  GigaBytes
Max Memory Allocated: 1.1217737197875977  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([46, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 1.1217260360717773  GigaBytes
Max Memory Allocated: 1.1217737197875977  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 1.1217260360717773  GigaBytes
Max Memory Allocated: 1.1217737197875977  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 1.1218137741088867  GigaBytes
Max Memory Allocated: 1.1218137741088867  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3397216796875 GB
    Memory Allocated: 1.133570671081543  GigaBytes
Max Memory Allocated: 1.134404182434082  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([51, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.3416748046875 GB
    Memory Allocated: 1.134507179260254  GigaBytes
Max Memory Allocated: 1.1345109939575195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3416748046875 GB
    Memory Allocated: 1.134507179260254  GigaBytes
Max Memory Allocated: 1.1345109939575195  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 2.3416748046875 GB
    Memory Allocated: 1.1346044540405273  GigaBytes
Max Memory Allocated: 1.1346044540405273  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3553466796875 GB
    Memory Allocated: 1.148320198059082  GigaBytes
Max Memory Allocated: 1.1492929458618164  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([43, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.3553466796875 GB
    Memory Allocated: 1.1491398811340332  GigaBytes
Max Memory Allocated: 1.1492929458618164  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3553466796875 GB
    Memory Allocated: 1.1491398811340332  GigaBytes
Max Memory Allocated: 1.1492929458618164  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 2.3553466796875 GB
    Memory Allocated: 1.1492218971252441  GigaBytes
Max Memory Allocated: 1.1492929458618164  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3670654296875 GB
    Memory Allocated: 1.161360263824463  GigaBytes
Max Memory Allocated: 1.1622214317321777  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([29, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.3670654296875 GB
    Memory Allocated: 1.1619324684143066  GigaBytes
Max Memory Allocated: 1.1622214317321777  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3670654296875 GB
    Memory Allocated: 1.1619324684143066  GigaBytes
Max Memory Allocated: 1.1622214317321777  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.3670654296875 GB
    Memory Allocated: 1.1619877815246582  GigaBytes
Max Memory Allocated: 1.1622214317321777  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 1.1705613136291504  GigaBytes
Max Memory Allocated: 1.1711697578430176  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([32, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 1.171241283416748  GigaBytes
Max Memory Allocated: 1.1712441444396973  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 1.171241283416748  GigaBytes
Max Memory Allocated: 1.1712441444396973  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 1.171302318572998  GigaBytes
Max Memory Allocated: 1.171302318572998  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3865966796875 GB
    Memory Allocated: 1.181190013885498  GigaBytes
Max Memory Allocated: 1.181891918182373  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([38, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.3885498046875 GB
    Memory Allocated: 1.1820363998413086  GigaBytes
Max Memory Allocated: 1.1820402145385742  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3885498046875 GB
    Memory Allocated: 1.1820363998413086  GigaBytes
Max Memory Allocated: 1.1820402145385742  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.3885498046875 GB
    Memory Allocated: 1.1821088790893555  GigaBytes
Max Memory Allocated: 1.1821088790893555  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4002685546875 GB
    Memory Allocated: 1.1943578720092773  GigaBytes
Max Memory Allocated: 1.1952276229858398  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([432, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.4002685546875 GB
    Memory Allocated: 1.2047019004821777  GigaBytes
Max Memory Allocated: 1.204742431640625  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4002685546875 GB
    Memory Allocated: 1.2047019004821777  GigaBytes
Max Memory Allocated: 1.204742431640625  GigaBytes

 h.shape torch.Size([1, 432, 256]), torch.Size([1, 432, 256])
----------------------------------------3
 Nvidia-smi: 2.4002685546875 GB
    Memory Allocated: 1.2055258750915527  GigaBytes
Max Memory Allocated: 1.2055258750915527  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5623779296875 GB
    Memory Allocated: 1.3505454063415527  GigaBytes
Max Memory Allocated: 1.3608450889587402  GigaBytes

rst.shape  torch.Size([1, 432, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.5819091796875 GB
    Memory Allocated: 1.3136334419250488  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.5819091796875 GB
    Memory Allocated: 1.314469337463379  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 1.315305233001709  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 1.314427375793457  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

torch.Size([5609, 40])
input nodes number: 12393
output nodes number: 5609
edges number: 43756
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 1.3153977394104004  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 1.3153986930847168  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.019733428955078125  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

pseudo mini batch 1 input nodes size: 22595
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.017045021057128906  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.017045021057128906  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.028763771057128906  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.02880573272705078  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.01815032958984375  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.019021987915039062  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.019021987915039062  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.019021987915039062  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

torch.Size([22595, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.019021987915039062  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

m.shape torch.Size([1323, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.05615854263305664  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.05615854263305664  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 1323, 128]), torch.Size([1, 1323, 128])
----------------------------------------3
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.05742025375366211  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.06751394271850586  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 1323, 128])
m.shape torch.Size([1223, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.06804943084716797  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.06804943084716797  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 1223, 128]), torch.Size([1, 1223, 128])
----------------------------------------3
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.06921577453613281  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.08755111694335938  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 1223, 128])
m.shape torch.Size([1110, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.0893559455871582  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.0893559455871582  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 1110, 128]), torch.Size([1, 1110, 128])
----------------------------------------3
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.09041452407836914  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.11467218399047852  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 1110, 128])
m.shape torch.Size([929, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.11591482162475586  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.11591482162475586  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 929, 128]), torch.Size([1, 929, 128])
----------------------------------------3
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.11680078506469727  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.14327001571655273  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 929, 128])
m.shape torch.Size([810, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.1447582244873047  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.1447582244873047  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 810, 128]), torch.Size([1, 810, 128])
----------------------------------------3
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.14553070068359375  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.17412853240966797  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 810, 128])
m.shape torch.Size([685, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.17627906799316406  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.17627906799316406  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 685, 128]), torch.Size([1, 685, 128])
----------------------------------------3
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.17693233489990234  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.20502281188964844  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 685, 128])
m.shape torch.Size([583, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.20664215087890625  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.20664215087890625  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 583, 128]), torch.Size([1, 583, 128])
----------------------------------------3
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.2071981430053711  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.23525285720825195  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 583, 128])
m.shape torch.Size([502, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.23688983917236328  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.23688983917236328  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 502, 128]), torch.Size([1, 502, 128])
----------------------------------------3
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.23736858367919922  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.26465702056884766  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 502, 128])
m.shape torch.Size([437, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.2662930488586426  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.2662930488586426  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 437, 128]), torch.Size([1, 437, 128])
----------------------------------------3
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.2667098045349121  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.2933821678161621  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 437, 128])
m.shape torch.Size([4344, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.3138875961303711  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.3138875961303711  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 2172, 128]), torch.Size([1, 2172, 128])
----------------------------------------3
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.3159642219543457  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.4704608917236328  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst 0 shape torch.Size([1, 2172, 128])
----------------------------------------1
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.4704608917236328  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.4704608917236328  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 2172, 128]), torch.Size([1, 2172, 128])
----------------------------------------3
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.4725322723388672  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.6256752014160156  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst 1 shape torch.Size([1, 2172, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.5946083068847656  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.6060009002685547  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.6173934936523438  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.6059117317199707  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

torch.Size([11946, 256])
first layer input nodes number: 22595
first layer output nodes number: 11946
edges number: 74445
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.6175642013549805  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.6289567947387695  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.6324348449707031  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.6324348449707031  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

m.shape torch.Size([975, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.6743912696838379  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.6743912696838379  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 975, 256]), torch.Size([1, 975, 256])
----------------------------------------3
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.6762509346008301  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.6918282508850098  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 975, 256])
m.shape torch.Size([760, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.6928868293762207  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.6928868293762207  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 760, 256]), torch.Size([1, 760, 256])
----------------------------------------3
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.6943364143371582  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.7160801887512207  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 760, 256])
m.shape torch.Size([627, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.7174410820007324  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.7174410820007324  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 627, 256]), torch.Size([1, 627, 256])
----------------------------------------3
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.7186369895935059  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.7454438209533691  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 627, 256])
m.shape torch.Size([454, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.7469310760498047  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.7469310760498047  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 454, 256]), torch.Size([1, 454, 256])
----------------------------------------3
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.7477970123291016  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.7747344970703125  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 454, 256])
m.shape torch.Size([361, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.7760367393493652  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.7760367393493652  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 361, 256]), torch.Size([1, 361, 256])
----------------------------------------3
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.7767252922058105  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.8026108741760254  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 361, 256])
m.shape torch.Size([282, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.8038930892944336  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.8038930892944336  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.8044309616088867  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.8282651901245117  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([218, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.829463005065918  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.829463005065918  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.8298788070678711  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.8506689071655273  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([198, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.8519835472106934  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.8519835472106934  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.8523612022399902  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.8738875389099121  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([177, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.8752298355102539  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.8752298355102539  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.8755674362182617  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.8971738815307617  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([152, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.8984661102294922  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.8984661102294922  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.8987560272216797  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.9193401336669922  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([120, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.920464038848877  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.920464038848877  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.9206929206848145  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.9385457038879395  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([107, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.9396657943725586  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.9396657943725586  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.9398698806762695  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.9572172164916992  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([92, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.9582648277282715  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.9582648277282715  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.9584403038024902  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.9745841026306152  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([82, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.9755997657775879  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.9755997657775879  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.9757561683654785  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.9912400245666504  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([74, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.9922289848327637  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.9922289848327637  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.9923701286315918  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.007331371307373  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([55, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.0081067085266113  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.0081067085266113  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.008211612701416  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.0200657844543457  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([71, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.0211734771728516  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.0211734771728516  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.0213088989257812  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.0375595092773438  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([56, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.0384607315063477  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.0384607315063477  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.0385675430297852  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.0521326065063477  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([52, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.0530290603637695  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.0530290603637695  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.0531282424926758  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.0664186477661133  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([57, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.067464828491211  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.067464828491211  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.0675735473632812  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.0829029083251953  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([48, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.083817481994629  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.083817481994629  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.083909034729004  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.097458839416504  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([29, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.0980262756347656  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.0980262756347656  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.0980815887451172  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.1066551208496094  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([36, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.1074233055114746  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.1074233055114746  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.1074919700622559  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.1186156272888184  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.1191349029541016  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.1191349029541016  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.119180679321289  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.1269168853759766  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([488, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.1386198997497559  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.1386198997497559  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 488, 256]), torch.Size([1, 488, 256])
----------------------------------------3
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.1395506858825684  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6795654296875 GB
    Memory Allocated: 1.310227870941162  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 488, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.6795654296875 GB
    Memory Allocated: 1.274500846862793  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.6795654296875 GB
    Memory Allocated: 1.2753348350524902  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.6795654296875 GB
    Memory Allocated: 1.2761688232421875  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.6795654296875 GB
    Memory Allocated: 1.2752928733825684  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

torch.Size([5595, 40])
input nodes number: 11946
output nodes number: 5595
edges number: 42443
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6795654296875 GB
    Memory Allocated: 1.2754220962524414  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.6795654296875 GB
    Memory Allocated: 1.2754225730895996  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.020708084106445312  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

pseudo mini batch 2 input nodes size: 19317
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.018148422241210938  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.018148422241210938  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.027359485626220703  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.027400970458984375  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.0156402587890625  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.01644420623779297  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.01644420623779297  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.01644420623779297  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

torch.Size([19317, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.01644420623779297  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

m.shape torch.Size([1009, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.04847574234008789  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.04847574234008789  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 1009, 128]), torch.Size([1, 1009, 128])
----------------------------------------3
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.0494379997253418  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.05771923065185547  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 1009, 128])
m.shape torch.Size([1133, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.0583186149597168  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.0583186149597168  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 1133, 128]), torch.Size([1, 1133, 128])
----------------------------------------3
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.05939912796020508  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.07652044296264648  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 1133, 128])
m.shape torch.Size([1061, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.07749795913696289  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.07749795913696289  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 1061, 128]), torch.Size([1, 1061, 128])
----------------------------------------3
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.07850980758666992  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.10085296630859375  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 1061, 128])
m.shape torch.Size([922, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.10210561752319336  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.10210561752319336  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 922, 128]), torch.Size([1, 922, 128])
----------------------------------------3
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.10298490524291992  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.1287856101989746  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 922, 128])
m.shape torch.Size([703, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.13029146194458008  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.13029146194458008  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 703, 128]), torch.Size([1, 703, 128])
----------------------------------------3
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.13096189498901367  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.15585660934448242  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 703, 128])
m.shape torch.Size([638, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.1573467254638672  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.1573467254638672  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 638, 128]), torch.Size([1, 638, 128])
----------------------------------------3
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.15795516967773438  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.18474292755126953  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 638, 128])
m.shape torch.Size([548, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.18626785278320312  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.18626785278320312  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 548, 128]), torch.Size([1, 548, 128])
----------------------------------------3
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.18679046630859375  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.2132129669189453  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 548, 128])
m.shape torch.Size([502, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.21486663818359375  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.21486663818359375  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 502, 128]), torch.Size([1, 502, 128])
----------------------------------------3
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.2153453826904297  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.24263381958007812  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 502, 128])
m.shape torch.Size([439, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.2442784309387207  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.2442784309387207  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 439, 128]), torch.Size([1, 439, 128])
----------------------------------------3
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.24469709396362305  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.27149152755737305  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 439, 128])
m.shape torch.Size([3504, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.2879905700683594  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.2879905700683594  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 1752, 128]), torch.Size([1, 1752, 128])
----------------------------------------3
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.2896614074707031  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.4082908630371094  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst 0 shape torch.Size([1, 1752, 128])
----------------------------------------1
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.4082908630371094  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.4082908630371094  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 1752, 128]), torch.Size([1, 1752, 128])
----------------------------------------3
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.4099617004394531  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.5277557373046875  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst 1 shape torch.Size([1, 1752, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.5010323524475098  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.5110068321228027  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.5209813117980957  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.5109286308288574  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

torch.Size([10459, 256])
first layer input nodes number: 19317
first layer output nodes number: 10459
edges number: 64332
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.5211272239685059  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.5311017036437988  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.5339245796203613  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.5339245796203613  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

m.shape torch.Size([721, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.5765633583068848  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.5765633583068848  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 721, 256]), torch.Size([1, 721, 256])
----------------------------------------3
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.5779385566711426  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.5891575813293457  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 721, 256])
m.shape torch.Size([716, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.5900535583496094  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.5900535583496094  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 716, 256]), torch.Size([1, 716, 256])
----------------------------------------3
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.5914192199707031  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.6124534606933594  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 716, 256])
m.shape torch.Size([582, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.6134490966796875  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.6134490966796875  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 582, 256]), torch.Size([1, 582, 256])
----------------------------------------3
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.6145591735839844  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.6415700912475586  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 582, 256])
m.shape torch.Size([491, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.6429028511047363  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.6429028511047363  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 491, 256]), torch.Size([1, 491, 256])
----------------------------------------3
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.6438393592834473  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.6713814735412598  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 491, 256])
m.shape torch.Size([384, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.6727585792541504  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.6727585792541504  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 384, 256]), torch.Size([1, 384, 256])
----------------------------------------3
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.6734910011291504  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.700232982635498  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 384, 256])
m.shape torch.Size([321, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.7017183303833008  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.7017183303833008  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.7023305892944336  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.7287282943725586  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 321, 256])
m.shape torch.Size([252, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.7301177978515625  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.7301177978515625  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.7305984497070312  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.7546310424804688  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([224, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.7561130523681641  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.7561130523681641  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.7565402984619141  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.7808933258056641  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([217, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.7825570106506348  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.7825570106506348  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.7829709053039551  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.8094601631164551  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([161, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.8108010292053223  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.8108010292053223  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.8111081123352051  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.8329110145568848  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([152, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.8343648910522461  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.8343648910522461  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.8346548080444336  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.8572683334350586  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([155, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.8589115142822266  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.8589115142822266  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.8592071533203125  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.8843364715576172  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([124, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.8862276077270508  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.8862276077270508  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.8864641189575195  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.9082231521606445  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([93, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.9093565940856934  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.9093565940856934  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.9095339775085449  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.9270949363708496  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([78, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.9281730651855469  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.9281730651855469  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.9283218383789062  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.944091796875  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([64, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.9450016021728516  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.9450016021728516  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.9451236724853516  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.9589176177978516  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([66, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.9600424766540527  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.9600424766540527  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.9601683616638184  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.9752745628356934  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([66, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.976353645324707  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.976353645324707  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.9764795303344727  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.992466926574707  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([56, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.9934267997741699  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.9934267997741699  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.9935336112976074  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 1.0078463554382324  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([45, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 1.0086584091186523  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 1.0086584091186523  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 1.008744239807129  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 1.0208463668823242  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([48, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 1.0217723846435547  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 1.0217723846435547  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 1.0218639373779297  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6932373046875 GB
    Memory Allocated: 1.0354137420654297  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([37, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.6932373046875 GB
    Memory Allocated: 1.0361504554748535  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6932373046875 GB
    Memory Allocated: 1.0361504554748535  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 2.6932373046875 GB
    Memory Allocated: 1.0362210273742676  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.0471596717834473  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([39, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.0479869842529297  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.0479869842529297  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.0480613708496094  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7166748046875 GB
    Memory Allocated: 1.0601119995117188  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.7166748046875 GB
    Memory Allocated: 1.060743808746338  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7166748046875 GB
    Memory Allocated: 1.060743808746338  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.7166748046875 GB
    Memory Allocated: 1.0607991218566895  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 1.0701470375061035  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([410, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 1.0799713134765625  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 1.0799713134765625  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 410, 256]), torch.Size([1, 410, 256])
----------------------------------------3
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 1.0807533264160156  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7518310546875 GB
    Memory Allocated: 1.2223129272460938  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 410, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.7518310546875 GB
    Memory Allocated: 1.1856794357299805  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.7518310546875 GB
    Memory Allocated: 1.1865038871765137  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.7537841796875 GB
    Memory Allocated: 1.1873283386230469  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.7537841796875 GB
    Memory Allocated: 1.18646240234375  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

torch.Size([5531, 40])
input nodes number: 10459
output nodes number: 5531
edges number: 43407
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7537841796875 GB
    Memory Allocated: 1.186572551727295  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.7537841796875 GB
    Memory Allocated: 1.1865730285644531  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.01800394058227539  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

pseudo mini batch 3 input nodes size: 21332
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.015630722045898438  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.015630722045898438  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.0258026123046875  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.025846481323242188  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.01659393310546875  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.017492294311523438  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.017492294311523438  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.017492294311523438  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

torch.Size([21332, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.017492294311523438  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

m.shape torch.Size([851, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.052969932556152344  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.052969932556152344  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 851, 128]), torch.Size([1, 851, 128])
----------------------------------------3
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.05378150939941406  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.06034374237060547  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 851, 128])
m.shape torch.Size([981, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.06087350845336914  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.06087350845336914  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 981, 128]), torch.Size([1, 981, 128])
----------------------------------------3
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.06180906295776367  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.07633447647094727  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 981, 128])
m.shape torch.Size([910, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.07741355895996094  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.07741355895996094  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 910, 128]), torch.Size([1, 910, 128])
----------------------------------------3
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.07828140258789062  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.09737396240234375  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 910, 128])
m.shape torch.Size([847, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.0985555648803711  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.0985555648803711  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 847, 128]), torch.Size([1, 847, 128])
----------------------------------------3
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.09936332702636719  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.12317562103271484  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 847, 128])
m.shape torch.Size([775, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.1246194839477539  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.1246194839477539  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 775, 128]), torch.Size([1, 775, 128])
----------------------------------------3
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.12535858154296875  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.15229082107543945  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 775, 128])
m.shape torch.Size([719, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.1539783477783203  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.1539783477783203  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 719, 128]), torch.Size([1, 719, 128])
----------------------------------------3
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.1546640396118164  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.1845703125  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 719, 128])
m.shape torch.Size([588, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.18619012832641602  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.18619012832641602  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 588, 128]), torch.Size([1, 588, 128])
----------------------------------------3
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.1867508888244629  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.2155900001525879  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 588, 128])
m.shape torch.Size([560, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.21744585037231445  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.21744585037231445  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 560, 128]), torch.Size([1, 560, 128])
----------------------------------------3
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.21797990798950195  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.2495121955871582  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 560, 128])
m.shape torch.Size([454, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.2511935234069824  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.2511935234069824  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 454, 128]), torch.Size([1, 454, 128])
----------------------------------------3
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.25162649154663086  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.27933645248413086  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 454, 128])
m.shape torch.Size([4176, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.29903268814086914  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.29903268814086914  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 2088, 128]), torch.Size([1, 2088, 128])
----------------------------------------3
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.30104589462280273  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.4465470314025879  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst 0 shape torch.Size([1, 2088, 128])
----------------------------------------1
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.4465470314025879  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.4465470314025879  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 2088, 128]), torch.Size([1, 2088, 128])
----------------------------------------3
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.44915246963500977  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.5938363075256348  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst 1 shape torch.Size([1, 2088, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.5636844635009766  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.5740423202514648  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.5844001770019531  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.5739612579345703  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

torch.Size([10861, 256])
first layer input nodes number: 21332
first layer output nodes number: 10861
edges number: 71562
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.5845613479614258  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.5949192047119141  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.5975089073181152  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.5975089073181152  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

m.shape torch.Size([632, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.645592212677002  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.645592212677002  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 632, 256]), torch.Size([1, 632, 256])
----------------------------------------3
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.6467976570129395  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.6564412117004395  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 632, 256])
m.shape torch.Size([626, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.6574316024780273  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.6574316024780273  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 626, 256]), torch.Size([1, 626, 256])
----------------------------------------3
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.658625602722168  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.6765356063842773  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 626, 256])
m.shape torch.Size([559, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.6779427528381348  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.6779427528381348  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 559, 256]), torch.Size([1, 559, 256])
----------------------------------------3
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.679008960723877  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.7025980949401855  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 559, 256])
m.shape torch.Size([473, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.7040705680847168  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.7040705680847168  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 473, 256]), torch.Size([1, 473, 256])
----------------------------------------3
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.7049727439880371  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.7313408851623535  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 473, 256])
m.shape torch.Size([430, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.7329564094543457  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.7329564094543457  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 430, 256]), torch.Size([1, 430, 256])
----------------------------------------3
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.7337765693664551  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.7633023262023926  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 430, 256])
m.shape torch.Size([394, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.7651643753051758  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.7651643753051758  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 394, 256]), torch.Size([1, 394, 256])
----------------------------------------3
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.7659158706665039  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.7984247207641602  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 394, 256])
m.shape torch.Size([310, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.8010635375976562  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.8010635375976562  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 310, 256]), torch.Size([1, 310, 256])
----------------------------------------3
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.8016548156738281  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.8321933746337891  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 310, 256])
m.shape torch.Size([268, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.833958625793457  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.833958625793457  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.8344697952270508  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.8644013404846191  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([223, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.8660750389099121  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.8660750389099121  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.8665003776550293  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.8937220573425293  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([232, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.8957395553588867  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.8957395553588867  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.8961820602416992  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.9275999069213867  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([211, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.9296097755432129  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.9296097755432129  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.9300122261047363  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.9614033699035645  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([133, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.9627361297607422  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.9627361297607422  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.9629898071289062  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.9845523834228516  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([147, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.986262321472168  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.986262321472168  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 0.9865427017211914  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.0123376846313477  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([125, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.0138797760009766  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.0138797760009766  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.0141181945800781  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.0377216339111328  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([94, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.0390591621398926  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.0390591621398926  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.039238452911377  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.0582432746887207  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([104, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.0597529411315918  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.0597529411315918  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.0599513053894043  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.0823664665222168  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([95, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.08381986618042  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.08381986618042  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.084001064300537  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.1057448387145996  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([81, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.1070556640625  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.1070556640625  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.1072101593017578  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.1268310546875  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([48, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.1276307106018066  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.1276307106018066  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.1277222633361816  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.1399903297424316  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([84, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.1415596008300781  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.1415596008300781  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.1417198181152344  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.1643104553222656  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([65, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.1655426025390625  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.1655426025390625  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.1656665802001953  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.1840152740478516  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([44, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.1848840713500977  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.1848840713500977  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.1849679946899414  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.1979761123657227  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([33, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.1986637115478516  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.1986637115478516  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.1987266540527344  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.20892333984375  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([42, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.2098608016967773  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.2098608016967773  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.2099409103393555  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.2234792709350586  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([393, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.2328824996948242  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.2328824996948242  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

 h.shape torch.Size([1, 393, 256]), torch.Size([1, 393, 256])
----------------------------------------3
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.2336320877075195  GigaBytes
Max Memory Allocated: 1.3662004470825195  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.365727424621582  GigaBytes
Max Memory Allocated: 1.3750972747802734  GigaBytes

rst.shape  torch.Size([1, 393, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.3239259719848633  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.3247971534729004  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.3256683349609375  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.3247532844543457  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

torch.Size([5846, 40])
input nodes number: 10861
output nodes number: 5846
edges number: 48850
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.3249249458312988  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.324925422668457  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.019269943237304688  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

pseudo mini batch 4 input nodes size: 19208
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.016640663146972656  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.016640663146972656  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.02579975128173828  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.02584362030029297  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.01562786102294922  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.016414642333984375  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.016414642333984375  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.016414642333984375  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

torch.Size([19208, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.016414642333984375  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

m.shape torch.Size([1158, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.048418521881103516  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.048418521881103516  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 1158, 128]), torch.Size([1, 1158, 128])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.04952287673950195  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.05870866775512695  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 1158, 128])
m.shape torch.Size([1240, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.059339046478271484  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.059339046478271484  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 1240, 128]), torch.Size([1, 1240, 128])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.060521602630615234  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.07879924774169922  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 1240, 128])
m.shape torch.Size([1168, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.08046627044677734  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.08046627044677734  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 1168, 128]), torch.Size([1, 1168, 128])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.08158016204833984  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.10652828216552734  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 1168, 128])
m.shape torch.Size([1046, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.1085042953491211  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.1085042953491211  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 1046, 128]), torch.Size([1, 1046, 128])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.10950183868408203  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.13843059539794922  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 1046, 128])
m.shape torch.Size([860, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.1399822235107422  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.1399822235107422  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 860, 128]), torch.Size([1, 860, 128])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.14080238342285156  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.17034149169921875  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 860, 128])
m.shape torch.Size([748, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.1720714569091797  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.1720714569091797  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 748, 128]), torch.Size([1, 748, 128])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.17278480529785156  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.20360755920410156  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 748, 128])
m.shape torch.Size([629, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.20535039901733398  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.20535039901733398  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 629, 128]), torch.Size([1, 629, 128])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.20595026016235352  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.23634052276611328  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 629, 128])
m.shape torch.Size([575, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.2382340431213379  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.2382340431213379  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 575, 128]), torch.Size([1, 575, 128])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.23878240585327148  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.27098894119262695  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 575, 128])
m.shape torch.Size([482, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.2727832794189453  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.2727832794189453  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 482, 128]), torch.Size([1, 482, 128])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.2732429504394531  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.3026618957519531  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 482, 128])
m.shape torch.Size([3063, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.31703758239746094  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.31703758239746094  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 1531, 128]), torch.Size([1, 1531, 128])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.3184976577758789  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.4221630096435547  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst 0 shape torch.Size([1, 1531, 128])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.4221630096435547  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.4221630096435547  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 1532, 128]), torch.Size([1, 1532, 128])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.42362403869628906  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.5266270637512207  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst 1 shape torch.Size([1, 1532, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.5003581047058105  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.5108189582824707  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.5212798118591309  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.5107369422912598  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

torch.Size([10969, 256])
first layer input nodes number: 19208
first layer output nodes number: 10969
edges number: 64085
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.5214252471923828  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.531886100769043  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.5347433090209961  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.5347433090209961  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

m.shape torch.Size([771, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.5754823684692383  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.5754823684692383  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 771, 256]), torch.Size([1, 771, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.5769529342651367  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.5901932716369629  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 771, 256])
m.shape torch.Size([769, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.5914688110351562  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.5914688110351562  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 769, 256]), torch.Size([1, 769, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.5929355621337891  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.6154766082763672  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 769, 256])
m.shape torch.Size([650, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.6167569160461426  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.6167569160461426  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 650, 256]), torch.Size([1, 650, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.6179966926574707  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.6452717781066895  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 650, 256])
m.shape torch.Size([564, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.6469583511352539  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.6469583511352539  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 564, 256]), torch.Size([1, 564, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.6480340957641602  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.6797494888305664  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 564, 256])
m.shape torch.Size([430, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.6812782287597656  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.6812782287597656  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 430, 256]), torch.Size([1, 430, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.682098388671875  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.7145500183105469  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 430, 256])
m.shape torch.Size([354, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.716181755065918  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.716181755065918  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 354, 256]), torch.Size([1, 354, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.7168569564819336  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.7472686767578125  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 354, 256])
m.shape torch.Size([317, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.7490639686584473  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.7490639686584473  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 317, 256]), torch.Size([1, 317, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.7496685981750488  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.7801032066345215  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 317, 256])
m.shape torch.Size([270, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.7818770408630371  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.7818770408630371  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.7823920249938965  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8121542930603027  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([238, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8139557838439941  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8139557838439941  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8144097328186035  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8434624671936035  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([209, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8452444076538086  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8452444076538086  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8456430435180664  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8739461898803711  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([177, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8756184577941895  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8756184577941895  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8759560585021973  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.9022889137268066  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([137, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.9037003517150879  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.9037003517150879  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.9039616584777832  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.9261727333068848  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([128, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.9276413917541504  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.9276413917541504  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.9278855323791504  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.9503464698791504  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([96, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.9515161514282227  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.9515161514282227  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.9516992568969727  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.9698266983032227  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([93, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.9710760116577148  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.9710760116577148  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.9712533950805664  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.990056037902832  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([79, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.9911823272705078  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.9911823272705078  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.9913330078125  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.0083599090576172  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([51, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.0091180801391602  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.0091180801391602  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.0092153549194336  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.020888328552246  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([45, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.021618366241455  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.021618366241455  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.0217041969299316  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.032604694366455  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([56, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.0335845947265625  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.0335845947265625  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.03369140625  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.048004150390625  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([46, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.048835277557373  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.048835277557373  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.0489230155944824  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.0612940788269043  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([32, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.0618963241577148  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.0618963241577148  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.0619573593139648  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.0709905624389648  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([30, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.0715947151184082  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.0715947151184082  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.0716519355773926  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.0805211067199707  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.081155776977539  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.081155776977539  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.0812129974365234  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.0904827117919922  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.0910077095031738  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.0910077095031738  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.0910534858703613  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.0987896919250488  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([258, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.104966163635254  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.104966163635254  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.1054582595825195  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.195054054260254  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 258, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.1608119010925293  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.161684513092041  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.1625571250915527  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.1616406440734863  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

torch.Size([5854, 40])
input nodes number: 10969
output nodes number: 5854
edges number: 41367
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.1617679595947266  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 1.1617684364318848  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.01796722412109375  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

pseudo mini batch 5 input nodes size: 17255
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.015629291534423828  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.015629291534423828  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.02385711669921875  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.023900985717773438  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.014698028564453125  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.015288352966308594  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.015288352966308594  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.015288352966308594  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

torch.Size([17255, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.015288352966308594  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

m.shape torch.Size([1565, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.04021883010864258  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.04021883010864258  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 1565, 128]), torch.Size([1, 1565, 128])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.04171133041381836  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.054157257080078125  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 1565, 128])
m.shape torch.Size([1571, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.05490922927856445  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.05490922927856445  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 1571, 128]), torch.Size([1, 1571, 128])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.05640745162963867  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.07888078689575195  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 1571, 128])
m.shape torch.Size([1309, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.08086109161376953  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.08086109161376953  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 1309, 128]), torch.Size([1, 1309, 128])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.08210945129394531  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.10976219177246094  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 1309, 128])
m.shape torch.Size([1012, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.1110682487487793  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.1110682487487793  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 1012, 128]), torch.Size([1, 1012, 128])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.11203336715698242  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.14094114303588867  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 1012, 128])
m.shape torch.Size([862, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.14251375198364258  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.14251375198364258  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 862, 128]), torch.Size([1, 862, 128])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.14333581924438477  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.17367887496948242  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 862, 128])
m.shape torch.Size([643, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.17510747909545898  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.17510747909545898  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 643, 128]), torch.Size([1, 643, 128])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.1757206916809082  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.20258474349975586  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 643, 128])
m.shape torch.Size([546, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.2041006088256836  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.2041006088256836  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 546, 128]), torch.Size([1, 546, 128])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.2046213150024414  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.23070907592773438  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 546, 128])
m.shape torch.Size([424, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.23227596282958984  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.23227596282958984  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 424, 128]), torch.Size([1, 424, 128])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.2326803207397461  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.25572872161865234  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 424, 128])
m.shape torch.Size([361, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.25707578659057617  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.25707578659057617  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 361, 128]), torch.Size([1, 361, 128])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.25742006301879883  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.27945375442504883  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 361, 128])
m.shape torch.Size([1748, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.2876167297363281  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.2876167297363281  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 874, 128]), torch.Size([1, 874, 128])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.2884502410888672  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.3476295471191406  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst 0 shape torch.Size([1, 874, 128])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.3476295471191406  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.3476295471191406  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 874, 128]), torch.Size([1, 874, 128])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.3484630584716797  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.4072256088256836  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst 1 shape torch.Size([1, 874, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.38796424865722656  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.3975400924682617  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.4071159362792969  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.39746522903442383  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

torch.Size([10041, 256])
first layer input nodes number: 17255
first layer output nodes number: 10041
edges number: 48793
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.4076261520385742  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.4172019958496094  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.41997575759887695  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.41997575759887695  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

m.shape torch.Size([1140, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.45052671432495117  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.45052671432495117  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 1140, 256]), torch.Size([1, 1140, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.4529147148132324  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.4724397659301758  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 1140, 256])
m.shape torch.Size([975, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.47322702407836914  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.47322702407836914  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 975, 256]), torch.Size([1, 975, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.47508668899536133  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.5038609504699707  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 975, 256])
m.shape torch.Size([792, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.5052151679992676  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.5052151679992676  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 792, 256]), torch.Size([1, 792, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.5067257881164551  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.5399594306945801  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 792, 256])
m.shape torch.Size([565, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.5416092872619629  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.5416092872619629  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 565, 256]), torch.Size([1, 565, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.542686939239502  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.5739388465881348  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 565, 256])
m.shape torch.Size([487, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.5757408142089844  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.5757408142089844  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 487, 256]), torch.Size([1, 487, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.5766696929931641  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.6110296249389648  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 487, 256])
m.shape torch.Size([359, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.612635612487793  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.612635612487793  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.6133203506469727  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.643275260925293  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([278, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.644803524017334  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.644803524017334  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.6453337669372559  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.6728944778442383  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([227, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.6752066612243652  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.6752066612243652  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.6756396293640137  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.7003188133239746  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([174, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.7016077041625977  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.7016077041625977  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.701939582824707  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.723179817199707  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([132, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.7242827415466309  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.7242827415466309  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.7245345115661621  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.7424101829528809  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([105, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.7433948516845703  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.7433948516845703  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.7435951232910156  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.75921630859375  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([98, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.760246753692627  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.760246753692627  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.7604336738586426  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.7763218879699707  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([69, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.7770910263061523  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.7770910263061523  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.7772226333618164  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.7893304824829102  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([64, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.790125846862793  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.790125846862793  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.790247917175293  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.802332878112793  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([63, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8031802177429199  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8031802177429199  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8033003807067871  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.816037654876709  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([46, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8166851997375488  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8166851997375488  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8167729377746582  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8266873359680176  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([41, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8273134231567383  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8273134231567383  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8273916244506836  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8367757797241211  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([34, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8373250961303711  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8373250961303711  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8373899459838867  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8456258773803711  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8460502624511719  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8460502624511719  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8460979461669922  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8524875640869141  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([13, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8527140617370605  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8527140617370605  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8527388572692871  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8562350273132324  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8566064834594727  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8566064834594727  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8566427230834961  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8620061874389648  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8622632026672363  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8622632026672363  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8622879981994629  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8661313056945801  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.866340160369873  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.866340160369873  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8663592338562012  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8694491386413574  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8697628974914551  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8697628974914551  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8697896003723145  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8743023872375488  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([89, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8764276504516602  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8764276504516602  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8765974044799805  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.9064741134643555  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 89, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8827190399169922  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8835883140563965  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8844575881958008  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8835444450378418  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

torch.Size([5832, 40])
input nodes number: 10041
output nodes number: 5832
edges number: 30288
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.883659839630127  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.8836603164672852  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.016520977020263672  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

pseudo mini batch 6 input nodes size: 31977
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.014694690704345703  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.014694690704345703  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.02994251251220703  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.02998638153076172  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.02171468734741211  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.022770404815673828  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.022770404815673828  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.022770404815673828  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

torch.Size([31977, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.022770404815673828  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

m.shape torch.Size([1071, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.06854820251464844  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.06854820251464844  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 1071, 128]), torch.Size([1, 1071, 128])
----------------------------------------3
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.06956958770751953  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.07870340347290039  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 1071, 128])
m.shape torch.Size([1141, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.07928085327148438  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.07928085327148438  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 1141, 128]), torch.Size([1, 1141, 128])
----------------------------------------3
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.0803689956665039  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.09669113159179688  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 1141, 128])
m.shape torch.Size([1046, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.09807252883911133  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.09807252883911133  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 1046, 128]), torch.Size([1, 1046, 128])
----------------------------------------3
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.09907007217407227  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.12101602554321289  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 1046, 128])
m.shape torch.Size([966, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.1223597526550293  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.1223597526550293  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 966, 128]), torch.Size([1, 966, 128])
----------------------------------------3
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.12328100204467773  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.1506190299987793  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 966, 128])
m.shape torch.Size([866, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.1522231101989746  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.1522231101989746  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 866, 128]), torch.Size([1, 866, 128])
----------------------------------------3
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.15304899215698242  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.18287229537963867  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 866, 128])
m.shape torch.Size([745, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.18459081649780273  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.18459081649780273  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 745, 128]), torch.Size([1, 745, 128])
----------------------------------------3
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.1853013038635254  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.21596956253051758  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 745, 128])
m.shape torch.Size([681, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.21788740158081055  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.21788740158081055  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 681, 128]), torch.Size([1, 681, 128])
----------------------------------------3
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.2185368537902832  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.2519712448120117  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 681, 128])
m.shape torch.Size([635, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.25406885147094727  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.25406885147094727  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 635, 128]), torch.Size([1, 635, 128])
----------------------------------------3
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.25467443466186523  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.2895350456237793  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 635, 128])
m.shape torch.Size([556, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.29161834716796875  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.29161834716796875  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 556, 128]), torch.Size([1, 556, 128])
----------------------------------------3
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.2921485900878906  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.32655906677246094  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 556, 128])
m.shape torch.Size([5841, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.35414600372314453  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.35414600372314453  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 2920, 128]), torch.Size([1, 2920, 128])
----------------------------------------3
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.3569307327270508  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.55572509765625  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst 0 shape torch.Size([1, 2920, 128])
----------------------------------------1
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.55572509765625  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.55572509765625  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 2921, 128]), torch.Size([1, 2921, 128])
----------------------------------------3
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.5585479736328125  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.755253791809082  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst 1 shape torch.Size([1, 2921, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.7159953117370605  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.7290663719177246  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.7419867515563965  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.7288146018981934  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

torch.Size([13548, 256])
first layer input nodes number: 31977
first layer output nodes number: 13548
edges number: 92416
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.7422270774841309  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.7552981376647949  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.7583775520324707  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.7583775520324707  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

m.shape torch.Size([768, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 0.8067092895507812  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 0.8067092895507812  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 768, 256]), torch.Size([1, 768, 256])
----------------------------------------3
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 0.8081741333007812  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 0.8210954666137695  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 768, 256])
m.shape torch.Size([700, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 0.8222122192382812  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 0.8222122192382812  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 700, 256]), torch.Size([1, 700, 256])
----------------------------------------3
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 0.82354736328125  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 0.84368896484375  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 700, 256])
m.shape torch.Size([578, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 0.8454246520996094  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 0.8454246520996094  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 578, 256]), torch.Size([1, 578, 256])
----------------------------------------3
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 0.846527099609375  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 0.8707809448242188  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 578, 256])
m.shape torch.Size([478, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 0.8720674514770508  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 0.8720674514770508  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 478, 256]), torch.Size([1, 478, 256])
----------------------------------------3
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 0.8729791641235352  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 0.8999528884887695  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 478, 256])
m.shape torch.Size([398, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 0.9014101028442383  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 0.9014101028442383  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 398, 256]), torch.Size([1, 398, 256])
----------------------------------------3
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 0.9021692276000977  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 0.9304227828979492  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 398, 256])
m.shape torch.Size([300, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 0.9317736625671387  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 0.9317736625671387  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 0.9323458671569824  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 0.9575762748718262  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([288, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 0.9596705436706543  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 0.9596705436706543  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 0.9602198600769043  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 0.9885401725769043  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([242, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 0.9901266098022461  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 0.9901266098022461  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 0.9905881881713867  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.0168981552124023  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([208, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.0184669494628906  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.0184669494628906  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.0188636779785156  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.0442543029785156  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([197, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.0459494590759277  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.0459494590759277  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.0463252067565918  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.0730032920837402  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([145, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.0743484497070312  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.0743484497070312  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.074625015258789  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.0961971282958984  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([145, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.097731590270996  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.097731590270996  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.098008155822754  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.121516227722168  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([129, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.1229901313781738  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.1229901313781738  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.1232361793518066  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.1458725929260254  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([117, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.1473240852355957  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.1473240852355957  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.1475472450256348  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.169640064239502  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([105, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.1710424423217773  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.1710424423217773  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.1712427139282227  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.1924715042114258  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([71, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.194162368774414  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.194162368774414  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.1942977905273438  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.2096004486083984  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([73, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.2107257843017578  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.2107257843017578  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.2108650207519531  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.2275733947753906  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([69, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.2286977767944336  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.2286977767944336  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.2288293838500977  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.2455434799194336  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([59, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.2465553283691406  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.2465553283691406  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.2466678619384766  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.2617473602294922  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([56, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.2627677917480469  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.2627677917480469  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.2628746032714844  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.2779350280761719  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([46, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.2788105010986328  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.2788105010986328  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.2788982391357422  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.2918834686279297  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([46, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.2928123474121094  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.2928123474121094  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.2929000854492188  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.3064994812011719  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.3070306777954102  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.3070306777954102  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.3070802688598633  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.3151140213012695  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([37, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.3159427642822266  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.3159427642822266  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.3160133361816406  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.3279399871826172  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([573, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.3416728973388672  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.3416728973388672  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

 h.shape torch.Size([1, 573, 256]), torch.Size([1, 573, 256])
----------------------------------------3
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.3427658081054688  GigaBytes
Max Memory Allocated: 1.3820977210998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.5351181030273438  GigaBytes
Max Memory Allocated: 1.5487794876098633  GigaBytes

rst.shape  torch.Size([1, 573, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.4930377006530762  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.493910312652588  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.4947829246520996  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.4938664436340332  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

torch.Size([5854, 40])
input nodes number: 13548
output nodes number: 5854
edges number: 49272
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.4940147399902344  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.9471435546875 GB
    Memory Allocated: 1.4940152168273926  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.024804115295410156  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

pseudo mini batch 7 input nodes size: 30030
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.02171802520751953  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.02171802520751953  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.036037445068359375  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.03608131408691406  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.020789623260498047  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.02182626724243164  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.02182626724243164  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.02182626724243164  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

torch.Size([30030, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.02182626724243164  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

m.shape torch.Size([1165, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.06724071502685547  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.06724071502685547  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 1165, 128]), torch.Size([1, 1165, 128])
----------------------------------------3
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.06835174560546875  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.07800769805908203  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 1165, 128])
m.shape torch.Size([1308, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.07869958877563477  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.07869958877563477  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 1308, 128]), torch.Size([1, 1308, 128])
----------------------------------------3
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.07994699478149414  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.09915018081665039  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 1308, 128])
m.shape torch.Size([1200, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.10024309158325195  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.10024309158325195  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 1200, 128]), torch.Size([1, 1200, 128])
----------------------------------------3
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.10138750076293945  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.1272740364074707  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 1200, 128])
m.shape torch.Size([1093, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.12878656387329102  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.12878656387329102  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 1093, 128]), torch.Size([1, 1093, 128])
----------------------------------------3
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.12982892990112305  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.16158151626586914  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 1093, 128])
m.shape torch.Size([969, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.16337060928344727  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.16337060928344727  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 969, 128]), torch.Size([1, 969, 128])
----------------------------------------3
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.16429471969604492  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.1981496810913086  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 969, 128])
m.shape torch.Size([812, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.2000107765197754  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.2000107765197754  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 812, 128]), torch.Size([1, 812, 128])
----------------------------------------3
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.20078516006469727  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.2350296974182129  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 812, 128])
m.shape torch.Size([741, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.23711585998535156  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.23711585998535156  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 741, 128]), torch.Size([1, 741, 128])
----------------------------------------3
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.2378225326538086  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.27321529388427734  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 741, 128])
m.shape torch.Size([721, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.27561235427856445  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.27561235427856445  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 721, 128]), torch.Size([1, 721, 128])
----------------------------------------3
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.27629995346069336  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.31577157974243164  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 721, 128])
m.shape torch.Size([622, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.3180971145629883  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.3180971145629883  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 622, 128]), torch.Size([1, 622, 128])
----------------------------------------3
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.31869029998779297  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.3577613830566406  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 622, 128])
m.shape torch.Size([5351, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.3829803466796875  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.3829803466796875  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 2675, 128]), torch.Size([1, 2675, 128])
----------------------------------------3
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.3855314254760742  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.5698385238647461  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst 0 shape torch.Size([1, 2675, 128])
----------------------------------------1
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.5698385238647461  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.5698385238647461  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 2676, 128]), torch.Size([1, 2676, 128])
----------------------------------------3
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.5727882385253906  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.7554497718811035  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst 1 shape torch.Size([1, 2676, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.716926097869873  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.7302603721618652  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.7435946464538574  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.7301559448242188  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

torch.Size([13982, 256])
first layer input nodes number: 30030
first layer output nodes number: 13982
edges number: 91533
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.7438206672668457  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.7571549415588379  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.7613739967346191  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.7613739967346191  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

m.shape torch.Size([773, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.807978630065918  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.807978630065918  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 773, 256]), torch.Size([1, 773, 256])
----------------------------------------3
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.809453010559082  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.8212480545043945  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 773, 256])
m.shape torch.Size([728, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.8221268653869629  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.8221268653869629  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 728, 256]), torch.Size([1, 728, 256])
----------------------------------------3
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.8235154151916504  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.8456292152404785  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 728, 256])
m.shape torch.Size([564, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.847498893737793  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.847498893737793  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 564, 256]), torch.Size([1, 564, 256])
----------------------------------------3
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.8485746383666992  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.8722410202026367  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 564, 256])
m.shape torch.Size([513, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.8738255500793457  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.8738255500793457  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 513, 256]), torch.Size([1, 513, 256])
----------------------------------------3
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.8748040199279785  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.9037184715270996  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 513, 256])
m.shape torch.Size([423, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.9052624702453613  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.9052624702453613  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 423, 256]), torch.Size([1, 423, 256])
----------------------------------------3
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.906069278717041  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.9354195594787598  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 423, 256])
m.shape torch.Size([304, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.9367694854736328  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.9367694854736328  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.9373493194580078  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.9641704559326172  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([276, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.9657378196716309  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.9657378196716309  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.9662642478942871  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.9932670593261719  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([278, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.9951415061950684  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.9951415061950684  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.9956717491149902  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.026383876800537  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([202, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.0278663635253906  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.0278663635253906  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.0282516479492188  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.0529098510742188  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([180, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.0544476509094238  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.0544476509094238  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.05479097366333  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.0791668891906738  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([142, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.0804967880249023  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.0804967880249023  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.0807676315307617  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.101893424987793  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([145, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.1034307479858398  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.1034307479858398  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.1037073135375977  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.1272153854370117  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([120, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.1285767555236816  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.1285767555236816  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.1288056373596191  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.1498627662658691  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([114, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.1512823104858398  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.1512823104858398  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.1514997482299805  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.1730260848999023  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([101, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.1743736267089844  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.1743736267089844  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.1745662689208984  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.194986343383789  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([78, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.1961336135864258  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.1961336135864258  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.1962823867797852  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.2130937576293945  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([78, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.2142939567565918  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.2142939567565918  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.2144427299499512  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.2322955131530762  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([70, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.2334322929382324  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.2334322929382324  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.2335658073425293  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.2505221366882324  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([60, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.2515511512756348  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.2515511512756348  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.2516655921936035  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.267000675201416  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([59, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.2680778503417969  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.2680778503417969  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.2681903839111328  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.2840576171875  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([50, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.2850160598754883  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.2850160598754883  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.285111427307129  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.2992258071899414  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([54, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.3003201484680176  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.3003201484680176  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.3004231452941895  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.31638765335083  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([49, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.3174195289611816  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.3174195289611816  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.3175129890441895  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.332653522491455  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([34, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.3333911895751953  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.3333911895751953  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.333456039428711  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.3444156646728516  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([459, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.355412483215332  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.355412483215332  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 459, 256]), torch.Size([1, 459, 256])
----------------------------------------3
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.356287956237793  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.5125007629394531  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 459, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.4722480773925781  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.4731206893920898  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.4739933013916016  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.4730768203735352  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

torch.Size([5854, 40])
input nodes number: 13982
output nodes number: 5854
edges number: 47469
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.4732251167297363  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 1.4732255935668945  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.02382040023803711  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

pseudo mini batch 8 input nodes size: 57577
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.020789623260498047  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.020789623260498047  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.048244476318359375  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.04828596115112305  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.033922672271728516  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.03578615188598633  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.03578615188598633  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.03578615188598633  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

torch.Size([57577, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.0428466796875 GB
    Memory Allocated: 0.03578615188598633  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

m.shape torch.Size([1327, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.1405029296875 GB
    Memory Allocated: 0.13324213027954102  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1405029296875 GB
    Memory Allocated: 0.13324213027954102  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 1327, 128]), torch.Size([1, 1327, 128])
----------------------------------------3
 Nvidia-smi: 3.1405029296875 GB
    Memory Allocated: 0.1345076560974121  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1405029296875 GB
    Memory Allocated: 0.14463186264038086  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 1327, 128])
m.shape torch.Size([1446, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.1405029296875 GB
    Memory Allocated: 0.14537811279296875  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1405029296875 GB
    Memory Allocated: 0.14537811279296875  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 1446, 128]), torch.Size([1, 1446, 128])
----------------------------------------3
 Nvidia-smi: 3.1405029296875 GB
    Memory Allocated: 0.1467571258544922  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1405029296875 GB
    Memory Allocated: 0.16812896728515625  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 1446, 128])
m.shape torch.Size([1196, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.1405029296875 GB
    Memory Allocated: 0.1700749397277832  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1405029296875 GB
    Memory Allocated: 0.1700749397277832  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 1196, 128]), torch.Size([1, 1196, 128])
----------------------------------------3
 Nvidia-smi: 3.1405029296875 GB
    Memory Allocated: 0.17121553421020508  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1405029296875 GB
    Memory Allocated: 0.19662141799926758  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 1196, 128])
m.shape torch.Size([1096, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.1405029296875 GB
    Memory Allocated: 0.19814157485961914  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1405029296875 GB
    Memory Allocated: 0.19814157485961914  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 1096, 128]), torch.Size([1, 1096, 128])
----------------------------------------3
 Nvidia-smi: 3.1405029296875 GB
    Memory Allocated: 0.1991868019104004  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1405029296875 GB
    Memory Allocated: 0.23096323013305664  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 1096, 128])
m.shape torch.Size([1065, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.1405029296875 GB
    Memory Allocated: 0.23297977447509766  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1405029296875 GB
    Memory Allocated: 0.23297977447509766  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 1065, 128]), torch.Size([1, 1065, 128])
----------------------------------------3
 Nvidia-smi: 3.1405029296875 GB
    Memory Allocated: 0.2339954376220703  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1405029296875 GB
    Memory Allocated: 0.2713007926940918  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 1065, 128])
m.shape torch.Size([989, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.1405029296875 GB
    Memory Allocated: 0.2736225128173828  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1405029296875 GB
    Memory Allocated: 0.2736225128173828  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 989, 128]), torch.Size([1, 989, 128])
----------------------------------------3
 Nvidia-smi: 3.1405029296875 GB
    Memory Allocated: 0.2745656967163086  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1405029296875 GB
    Memory Allocated: 0.31638622283935547  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 989, 128])
m.shape torch.Size([908, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.1405029296875 GB
    Memory Allocated: 0.31894540786743164  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1405029296875 GB
    Memory Allocated: 0.31894540786743164  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 908, 128]), torch.Size([1, 908, 128])
----------------------------------------3
 Nvidia-smi: 3.1405029296875 GB
    Memory Allocated: 0.3198113441467285  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1405029296875 GB
    Memory Allocated: 0.363588809967041  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 908, 128])
m.shape torch.Size([878, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.1405029296875 GB
    Memory Allocated: 0.36710023880004883  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1405029296875 GB
    Memory Allocated: 0.36710023880004883  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 878, 128]), torch.Size([1, 878, 128])
----------------------------------------3
 Nvidia-smi: 3.1405029296875 GB
    Memory Allocated: 0.3679375648498535  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1405029296875 GB
    Memory Allocated: 0.4156651496887207  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 878, 128])
m.shape torch.Size([833, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.1405029296875 GB
    Memory Allocated: 0.4188213348388672  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1405029296875 GB
    Memory Allocated: 0.4188213348388672  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 833, 128]), torch.Size([1, 833, 128])
----------------------------------------3
 Nvidia-smi: 3.1405029296875 GB
    Memory Allocated: 0.4196157455444336  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1405029296875 GB
    Memory Allocated: 0.4709749221801758  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst.shape  torch.Size([1, 833, 128])
m.shape torch.Size([15365, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2147216796875 GB
    Memory Allocated: 0.5447964668273926  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2147216796875 GB
    Memory Allocated: 0.5447964668273926  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 7682, 128]), torch.Size([1, 7682, 128])
----------------------------------------3
 Nvidia-smi: 3.2147216796875 GB
    Memory Allocated: 0.5521225929260254  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2147216796875 GB
    Memory Allocated: 1.072277545928955  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

rst 0 shape torch.Size([1, 7682, 128])
----------------------------------------1
 Nvidia-smi: 3.2147216796875 GB
    Memory Allocated: 1.072277545928955  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2147216796875 GB
    Memory Allocated: 1.072277545928955  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

 h.shape torch.Size([1, 7683, 128]), torch.Size([1, 7683, 128])
----------------------------------------3
 Nvidia-smi: 3.2147216796875 GB
    Memory Allocated: 1.0796046257019043  GigaBytes
Max Memory Allocated: 1.5513405799865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3494873046875 GB
    Memory Allocated: 1.6010184288024902  GigaBytes
Max Memory Allocated: 1.6417908668518066  GigaBytes

rst 1 shape torch.Size([1, 7683, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.3494873046875 GB
    Memory Allocated: 1.5144457817077637  GigaBytes
Max Memory Allocated: 1.6417908668518066  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.3494873046875 GB
    Memory Allocated: 1.5383858680725098  GigaBytes
Max Memory Allocated: 1.6417908668518066  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.3494873046875 GB
    Memory Allocated: 1.5623259544372559  GigaBytes
Max Memory Allocated: 1.6417908668518066  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.3494873046875 GB
    Memory Allocated: 1.538198471069336  GigaBytes
Max Memory Allocated: 1.6417908668518066  GigaBytes

torch.Size([25103, 256])
first layer input nodes number: 57577
first layer output nodes number: 25103
edges number: 197977
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.3494873046875 GB
    Memory Allocated: 1.5627570152282715  GigaBytes
Max Memory Allocated: 1.6417908668518066  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.3494873046875 GB
    Memory Allocated: 1.5866971015930176  GigaBytes
Max Memory Allocated: 1.6417908668518066  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.3748779296875 GB
    Memory Allocated: 1.5926823616027832  GigaBytes
Max Memory Allocated: 1.6417908668518066  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.3748779296875 GB
    Memory Allocated: 1.5926823616027832  GigaBytes
Max Memory Allocated: 1.6417908668518066  GigaBytes

m.shape torch.Size([864, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.6437292098999023  GigaBytes
Max Memory Allocated: 1.6437325477600098  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.6437292098999023  GigaBytes
Max Memory Allocated: 1.6437325477600098  GigaBytes

 h.shape torch.Size([1, 864, 256]), torch.Size([1, 864, 256])
----------------------------------------3
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.6453771591186523  GigaBytes
Max Memory Allocated: 1.6453771591186523  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.6585607528686523  GigaBytes
Max Memory Allocated: 1.6593847274780273  GigaBytes

rst.shape  torch.Size([1, 864, 256])
m.shape torch.Size([731, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.65919828414917  GigaBytes
Max Memory Allocated: 1.6593847274780273  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.65919828414917  GigaBytes
Max Memory Allocated: 1.6593847274780273  GigaBytes

 h.shape torch.Size([1, 731, 256]), torch.Size([1, 731, 256])
----------------------------------------3
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.6605925559997559  GigaBytes
Max Memory Allocated: 1.6605925559997559  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.6818785667419434  GigaBytes
Max Memory Allocated: 1.6833348274230957  GigaBytes

rst.shape  torch.Size([1, 731, 256])
m.shape torch.Size([509, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.6826491355895996  GigaBytes
Max Memory Allocated: 1.6833348274230957  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.6826491355895996  GigaBytes
Max Memory Allocated: 1.6833348274230957  GigaBytes

 h.shape torch.Size([1, 509, 256]), torch.Size([1, 509, 256])
----------------------------------------3
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.6836199760437012  GigaBytes
Max Memory Allocated: 1.6836199760437012  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.7079100608825684  GigaBytes
Max Memory Allocated: 1.709367275238037  GigaBytes

rst.shape  torch.Size([1, 509, 256])
m.shape torch.Size([342, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.7088923454284668  GigaBytes
Max Memory Allocated: 1.709367275238037  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.7088923454284668  GigaBytes
Max Memory Allocated: 1.709367275238037  GigaBytes

 h.shape torch.Size([1, 342, 256]), torch.Size([1, 342, 256])
----------------------------------------3
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.7095446586608887  GigaBytes
Max Memory Allocated: 1.7095446586608887  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.7294588088989258  GigaBytes
Max Memory Allocated: 1.7307634353637695  GigaBytes

rst.shape  torch.Size([1, 342, 256])
m.shape torch.Size([313, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.7306370735168457  GigaBytes
Max Memory Allocated: 1.7307634353637695  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.7306370735168457  GigaBytes
Max Memory Allocated: 1.7307634353637695  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.731234073638916  GigaBytes
Max Memory Allocated: 1.731234073638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.752993106842041  GigaBytes
Max Memory Allocated: 1.7544856071472168  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([260, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.7541942596435547  GigaBytes
Max Memory Allocated: 1.7544856071472168  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.7541942596435547  GigaBytes
Max Memory Allocated: 1.7544856071472168  GigaBytes

 h.shape torch.Size([1, 260, 256]), torch.Size([1, 260, 256])
----------------------------------------3
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.754690170288086  GigaBytes
Max Memory Allocated: 1.754690170288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.7796659469604492  GigaBytes
Max Memory Allocated: 1.781153678894043  GigaBytes

rst.shape  torch.Size([1, 260, 256])
m.shape torch.Size([207, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.780810832977295  GigaBytes
Max Memory Allocated: 1.781153678894043  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.780810832977295  GigaBytes
Max Memory Allocated: 1.781153678894043  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.781205654144287  GigaBytes
Max Memory Allocated: 1.781205654144287  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.8009467124938965  GigaBytes
Max Memory Allocated: 1.8023285865783691  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([160, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.8019795417785645  GigaBytes
Max Memory Allocated: 1.8023285865783691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.8019795417785645  GigaBytes
Max Memory Allocated: 1.8023285865783691  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.8022847175598145  GigaBytes
Max Memory Allocated: 1.8023285865783691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.8196797370910645  GigaBytes
Max Memory Allocated: 1.8209004402160645  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([154, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.820859432220459  GigaBytes
Max Memory Allocated: 1.8209004402160645  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.820859432220459  GigaBytes
Max Memory Allocated: 1.8209004402160645  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.821153163909912  GigaBytes
Max Memory Allocated: 1.821153163909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.839951992034912  GigaBytes
Max Memory Allocated: 1.8412737846374512  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([139, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.8411412239074707  GigaBytes
Max Memory Allocated: 1.8412737846374512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.8411412239074707  GigaBytes
Max Memory Allocated: 1.8412737846374512  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.8414063453674316  GigaBytes
Max Memory Allocated: 1.8414063453674316  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.8602299690246582  GigaBytes
Max Memory Allocated: 1.861555576324463  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([127, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.8614401817321777  GigaBytes
Max Memory Allocated: 1.861555576324463  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.8614401817321777  GigaBytes
Max Memory Allocated: 1.861555576324463  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.861682415008545  GigaBytes
Max Memory Allocated: 1.861682415008545  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.8805766105651855  GigaBytes
Max Memory Allocated: 1.881908893585205  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([102, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.881680965423584  GigaBytes
Max Memory Allocated: 1.881908893585205  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.881680965423584  GigaBytes
Max Memory Allocated: 1.881908893585205  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.8818755149841309  GigaBytes
Max Memory Allocated: 1.881908893585205  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.8984122276306152  GigaBytes
Max Memory Allocated: 1.8996281623840332  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([87, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.8995394706726074  GigaBytes
Max Memory Allocated: 1.8996281623840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.8995394706726074  GigaBytes
Max Memory Allocated: 1.8996281623840332  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.899705410003662  GigaBytes
Max Memory Allocated: 1.899705410003662  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.9149718284606934  GigaBytes
Max Memory Allocated: 1.9161877632141113  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([74, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.9161128997802734  GigaBytes
Max Memory Allocated: 1.9161877632141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.9161128997802734  GigaBytes
Max Memory Allocated: 1.9161877632141113  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.9162540435791016  GigaBytes
Max Memory Allocated: 1.9162540435791016  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.930227279663086  GigaBytes
Max Memory Allocated: 1.9312152862548828  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([67, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.9311227798461914  GigaBytes
Max Memory Allocated: 1.9312152862548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.9311227798461914  GigaBytes
Max Memory Allocated: 1.9312152862548828  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.9312505722045898  GigaBytes
Max Memory Allocated: 1.9312505722045898  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.9447965621948242  GigaBytes
Max Memory Allocated: 1.9457550048828125  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([59, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.9456400871276855  GigaBytes
Max Memory Allocated: 1.9457550048828125  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.9456400871276855  GigaBytes
Max Memory Allocated: 1.9457550048828125  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.9457526206970215  GigaBytes
Max Memory Allocated: 1.9457550048828125  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.9584689140319824  GigaBytes
Max Memory Allocated: 1.95936918258667  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([48, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.9591970443725586  GigaBytes
Max Memory Allocated: 1.95936918258667  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.9591970443725586  GigaBytes
Max Memory Allocated: 1.95936918258667  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.9592885971069336  GigaBytes
Max Memory Allocated: 1.95936918258667  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.9702749252319336  GigaBytes
Max Memory Allocated: 1.971053123474121  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([55, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.9711809158325195  GigaBytes
Max Memory Allocated: 1.9711847305297852  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.9711809158325195  GigaBytes
Max Memory Allocated: 1.9711847305297852  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.9712858200073242  GigaBytes
Max Memory Allocated: 1.9712858200073242  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.9846086502075195  GigaBytes
Max Memory Allocated: 1.9855527877807617  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([50, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.9854693412780762  GigaBytes
Max Memory Allocated: 1.9855527877807617  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.9854693412780762  GigaBytes
Max Memory Allocated: 1.9855527877807617  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.9855647087097168  GigaBytes
Max Memory Allocated: 1.9855647087097168  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.9983439445495605  GigaBytes
Max Memory Allocated: 1.9992499351501465  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([43, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.9991230964660645  GigaBytes
Max Memory Allocated: 1.9992499351501465  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.9991230964660645  GigaBytes
Max Memory Allocated: 1.9992499351501465  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 1.9992051124572754  GigaBytes
Max Memory Allocated: 1.9992499351501465  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 2.0107693672180176  GigaBytes
Max Memory Allocated: 2.011589527130127  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([35, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 2.011435031890869  GigaBytes
Max Memory Allocated: 2.011589527130127  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 2.011435031890869  GigaBytes
Max Memory Allocated: 2.011589527130127  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 2.0115017890930176  GigaBytes
Max Memory Allocated: 2.011589527130127  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 2.0213818550109863  GigaBytes
Max Memory Allocated: 2.022082805633545  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 2.0220675468444824  GigaBytes
Max Memory Allocated: 2.022082805633545  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 2.0220675468444824  GigaBytes
Max Memory Allocated: 2.022082805633545  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 2.022132396697998  GigaBytes
Max Memory Allocated: 2.022132396697998  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 2.03218412399292  GigaBytes
Max Memory Allocated: 2.032897472381592  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([33, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 2.032881259918213  GigaBytes
Max Memory Allocated: 2.032897472381592  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 2.032881259918213  GigaBytes
Max Memory Allocated: 2.032897472381592  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 2.0329442024230957  GigaBytes
Max Memory Allocated: 2.0329442024230957  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 2.0431408882141113  GigaBytes
Max Memory Allocated: 2.0438647270202637  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([33, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 2.0438709259033203  GigaBytes
Max Memory Allocated: 2.0438742637634277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 2.0438709259033203  GigaBytes
Max Memory Allocated: 2.0438742637634277  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 2.043933868408203  GigaBytes
Max Memory Allocated: 2.043933868408203  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 2.0545711517333984  GigaBytes
Max Memory Allocated: 2.055326461791992  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([991, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 2.078664779663086  GigaBytes
Max Memory Allocated: 2.0787572860717773  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 2.078664779663086  GigaBytes
Max Memory Allocated: 2.0787572860717773  GigaBytes

 h.shape torch.Size([1, 991, 256]), torch.Size([1, 991, 256])
----------------------------------------3
 Nvidia-smi: 3.4256591796875 GB
    Memory Allocated: 2.080554962158203  GigaBytes
Max Memory Allocated: 2.080554962158203  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7440185546875 GB
    Memory Allocated: 2.4221420288085938  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 991, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7440185546875 GB
    Memory Allocated: 2.3767342567443848  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7440185546875 GB
    Memory Allocated: 2.377556800842285  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7440185546875 GB
    Memory Allocated: 2.3783793449401855  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7440185546875 GB
    Memory Allocated: 2.3775153160095215  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

torch.Size([5517, 40])
input nodes number: 25103
output nodes number: 5517
edges number: 52013
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7440185546875 GB
    Memory Allocated: 2.3776941299438477  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7440185546875 GB
    Memory Allocated: 2.377694606781006  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.039041996002197266  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

pseudo mini batch 9 input nodes size: 39146
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.03387260437011719  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.03387260437011719  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.05340385437011719  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.05344724655151367  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.025950908660888672  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.02716684341430664  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.02716684341430664  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.02716684341430664  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

torch.Size([39146, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.02716684341430664  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

m.shape torch.Size([1427, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.08718347549438477  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.08718347549438477  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 1427, 128]), torch.Size([1, 1427, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.08854436874389648  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.09943151473999023  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 1427, 128])
m.shape torch.Size([1494, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.10017585754394531  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.10017585754394531  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 1494, 128]), torch.Size([1, 1494, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.10160064697265625  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.12329292297363281  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 1494, 128])
m.shape torch.Size([1222, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.1247091293334961  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.1247091293334961  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 1222, 128]), torch.Size([1, 1222, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.12587451934814453  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.15151309967041016  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 1222, 128])
m.shape torch.Size([1129, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.15308380126953125  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.15308380126953125  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 1129, 128]), torch.Size([1, 1129, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.1541604995727539  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.18613243103027344  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 1129, 128])
m.shape torch.Size([1023, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.1880331039428711  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.1880331039428711  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 1023, 128]), torch.Size([1, 1023, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.1890087127685547  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.224212646484375  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 1023, 128])
m.shape torch.Size([894, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.22628259658813477  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.22628259658813477  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 894, 128]), torch.Size([1, 894, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.22713518142700195  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.264681339263916  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 894, 128])
m.shape torch.Size([801, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.26692867279052734  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.26692867279052734  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 801, 128]), torch.Size([1, 801, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.26769256591796875  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.30588722229003906  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 801, 128])
m.shape torch.Size([778, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.3084731101989746  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.3084731101989746  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 778, 128]), torch.Size([1, 778, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.30921506881713867  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.3518996238708496  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 778, 128])
m.shape torch.Size([645, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.3542966842651367  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.3542966842651367  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 645, 128]), torch.Size([1, 645, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.35491180419921875  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.3947162628173828  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 645, 128])
m.shape torch.Size([8045, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.4334712028503418  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.4334712028503418  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 4022, 128]), torch.Size([1, 4022, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.4376969337463379  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.7139115333557129  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst 0 shape torch.Size([1, 4022, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.7139115333557129  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.7139115333557129  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 4023, 128]), torch.Size([1, 4023, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.7181005477905273  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9920635223388672  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst 1 shape torch.Size([1, 4023, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9400143623352051  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9566636085510254  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9733128547668457  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9565334320068359  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

torch.Size([17458, 256])
first layer input nodes number: 39146
first layer output nodes number: 17458
edges number: 121162
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9736065864562988  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9902558326721191  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9944405555725098  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9944405555725098  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

m.shape torch.Size([977, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.035966396331787  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.035966396331787  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 977, 256]), torch.Size([1, 977, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.037829875946045  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.0541110038757324  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 977, 256])
m.shape torch.Size([799, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.0551090240478516  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.0551090240478516  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 799, 256]), torch.Size([1, 799, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.0566329956054688  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.0794925689697266  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 799, 256])
m.shape torch.Size([602, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.0808072090148926  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.0808072090148926  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 602, 256]), torch.Size([1, 602, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.0819554328918457  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1096062660217285  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 602, 256])
m.shape torch.Size([468, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.111067295074463  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.111067295074463  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 468, 256]), torch.Size([1, 468, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1119599342346191  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1388130187988281  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 468, 256])
m.shape torch.Size([429, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1404285430908203  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1404285430908203  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 429, 256]), torch.Size([1, 429, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1412467956542969  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.171675682067871  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 429, 256])
m.shape torch.Size([334, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1731929779052734  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1731929779052734  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 334, 256]), torch.Size([1, 334, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1738300323486328  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.2013797760009766  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 334, 256])
m.shape torch.Size([276, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.202918529510498  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.202918529510498  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.2034449577331543  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.230623722076416  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([251, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.2322907447814941  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.2322907447814941  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.23276948928833  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.2600579261779785  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 251, 256])
m.shape torch.Size([188, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.2614450454711914  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.2614450454711914  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.2618036270141602  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.2847528457641602  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([164, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.2869014739990234  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.2869014739990234  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.2872142791748047  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3094234466552734  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([142, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3107686042785645  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3107686042785645  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3110394477844238  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.332165241241455  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([118, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3333911895751953  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3333911895751953  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3336162567138672  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3527469635009766  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([89, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3537468910217285  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3537468910217285  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3539166450500488  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3695340156555176  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([63, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3702969551086426  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3702969551086426  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3704171180725098  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3823132514953613  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([68, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3832335472106934  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3832335472106934  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3833632469177246  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.397111415863037  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([66, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3981022834777832  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3981022834777832  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.3982281684875488  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4124531745910645  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([55, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4132890701293945  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4132890701293945  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4133939743041992  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4259824752807617  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([57, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4269165992736816  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4269165992736816  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.427025318145752  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4408326148986816  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([48, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.441655158996582  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.441655158996582  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.441746711730957  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.454014778137207  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([46, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4548535346984863  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4548535346984863  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4549412727355957  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4673123359680176  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([34, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4679551124572754  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4679551124572754  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.468019962310791  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4776177406311035  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.478261947631836  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.478261947631836  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.478322982788086  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.487783432006836  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4881291389465332  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4881291389465332  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.488161563873291  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4934144020080566  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([35, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4942059516906738  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4942059516906738  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.4942727088928223  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5055546760559082  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([431, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5158777236938477  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5158777236938477  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 431, 256]), torch.Size([1, 431, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.5166997909545898  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6613836288452148  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 431, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.626328468322754  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6271915435791016  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6280546188354492  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.627148151397705  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

torch.Size([5789, 40])
input nodes number: 17458
output nodes number: 5789
edges number: 41984
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6273622512817383  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.6273627281188965  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.029484272003173828  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

pseudo mini batch 10 input nodes size: 32661
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.025991439819335938  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.025991439819335938  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04161643981933594  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.041658878326416016  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.02208423614501953  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.02297496795654297  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.02297496795654297  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.02297496795654297  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

torch.Size([32661, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.02297496795654297  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

m.shape torch.Size([1523, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.06492805480957031  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.06492805480957031  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 1523, 128]), torch.Size([1, 1523, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.06638050079345703  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.07800006866455078  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 1523, 128])
m.shape torch.Size([1566, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.07876729965209961  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.07876729965209961  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 1566, 128]), torch.Size([1, 1566, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.0802607536315918  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.10267972946166992  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 1566, 128])
m.shape torch.Size([1380, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.1046910285949707  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.1046910285949707  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 1380, 128]), torch.Size([1, 1380, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.10600709915161133  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.13595247268676758  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 1380, 128])
m.shape torch.Size([1092, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.13737726211547852  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.13737726211547852  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 1092, 128]), torch.Size([1, 1092, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.13841867446899414  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.16861963272094727  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 1092, 128])
m.shape torch.Size([1056, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.17061662673950195  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.17061662673950195  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 1056, 128]), torch.Size([1, 1056, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.17162370681762695  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.20877885818481445  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 1056, 128])
m.shape torch.Size([836, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.21066713333129883  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.21066713333129883  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 836, 128]), torch.Size([1, 836, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.21146440505981445  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.24614381790161133  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 836, 128])
m.shape torch.Size([738, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.24820852279663086  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.24820852279663086  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 738, 128]), torch.Size([1, 738, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.24891233444213867  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.28451967239379883  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 738, 128])
m.shape torch.Size([642, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.28661680221557617  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.28661680221557617  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 642, 128]), torch.Size([1, 642, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.287229061126709  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.32230615615844727  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 642, 128])
m.shape torch.Size([523, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.32424449920654297  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.32424449920654297  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 523, 128]), torch.Size([1, 523, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.32474327087402344  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.3576321601867676  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 523, 128])
m.shape torch.Size([4557, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.37911224365234375  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.37911224365234375  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 2278, 128]), torch.Size([1, 2278, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.38190650939941406  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.5371065139770508  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst 0 shape torch.Size([1, 2278, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.5371065139770508  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.5371065139770508  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 2279, 128]), torch.Size([1, 2279, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.5392799377441406  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.6925067901611328  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst 1 shape torch.Size([1, 2279, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.6577138900756836  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.6709823608398438  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.6842508316040039  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.6708784103393555  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

torch.Size([13913, 256])
first layer input nodes number: 32661
first layer output nodes number: 13913
edges number: 84038
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.6844964027404785  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.6977648735046387  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.7019686698913574  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.7019686698913574  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

m.shape torch.Size([1058, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.737302303314209  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.737302303314209  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 1058, 256]), torch.Size([1, 1058, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.7394165992736816  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.7557530403137207  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 1058, 256])
m.shape torch.Size([853, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.7568817138671875  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.7568817138671875  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 853, 256]), torch.Size([1, 853, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.7585086822509766  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.7831215858459473  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 853, 256])
m.shape torch.Size([660, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.7845497131347656  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.7845497131347656  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 660, 256]), torch.Size([1, 660, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.7858085632324219  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.8151493072509766  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 660, 256])
m.shape torch.Size([466, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.8167610168457031  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.8167610168457031  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 466, 256]), torch.Size([1, 466, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.8176498413085938  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.8441495895385742  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 466, 256])
m.shape torch.Size([464, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.8459353446960449  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.8459353446960449  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 464, 256]), torch.Size([1, 464, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.8468203544616699  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.8786807060241699  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 464, 256])
m.shape torch.Size([338, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.8801875114440918  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.8801875114440918  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 338, 256]), torch.Size([1, 338, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.8808321952819824  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9091982841491699  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 338, 256])
m.shape torch.Size([282, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9107732772827148  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9107732772827148  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.911311149597168  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9384279251098633  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([210, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9397740364074707  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9397740364074707  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9401745796203613  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.963005542755127  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([179, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9643540382385254  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9643540382385254  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9646954536437988  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9865460395812988  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([124, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9875674247741699  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9875674247741699  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9878039360046387  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.00459623336792  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([104, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.005577564239502  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.005577564239502  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.0057759284973145  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.0212483406066895  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([106, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.022371768951416  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.022371768951416  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.0225739479064941  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.0397591590881348  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([90, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.0407829284667969  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.0407829284667969  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.04095458984375  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.0567474365234375  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([87, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.0578327178955078  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.0578327178955078  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.0579986572265625  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.0744266510009766  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([61, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.075223445892334  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.075223445892334  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.0753397941589355  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.0876727104187012  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([46, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.0883221626281738  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.0883221626281738  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.0884099006652832  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.0983242988586426  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.0989017486572266  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.0989017486572266  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.0989742279052734  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1076717376708984  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([36, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1082587242126465  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1082587242126465  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1083273887634277  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1170477867126465  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1175613403320312  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1175613403320312  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1176185607910156  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1252861022949219  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([37, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1259689331054688  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1259689331054688  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1260395050048828  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1359901428222656  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1364192962646484  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1364192962646484  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1364631652832031  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1429557800292969  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1432933807373047  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1432933807373047  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1433258056640625  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1483516693115234  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1487998962402344  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1487998962402344  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1488399505615234  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1553287506103516  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1557931900024414  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1557931900024414  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1558332443237305  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.162602424621582  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([282, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.169358730316162  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.169358730316162  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.1698966026306152  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.2669873237609863  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 282, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.2381443977355957  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.2389841079711914  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.239823818206787  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.2389416694641113  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

torch.Size([5633, 40])
input nodes number: 13913
output nodes number: 5633
edges number: 35414
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.2390646934509277  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.239065170288086  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.024725914001464844  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

pseudo mini batch 11 input nodes size: 24260
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.022060871124267578  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.022060871124267578  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.03377962112426758  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.03382158279418945  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.018154144287109375  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.01883983612060547  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.01883983612060547  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.01883983612060547  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

torch.Size([24260, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.01883983612060547  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

m.shape torch.Size([1427, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.049474239349365234  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.049474239349365234  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 1427, 128]), torch.Size([1, 1427, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.05083513259887695  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.0617222785949707  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 1427, 128])
m.shape torch.Size([1606, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.06257343292236328  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.06257343292236328  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 1606, 128]), torch.Size([1, 1606, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.06410503387451172  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.08707904815673828  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 1606, 128])
m.shape torch.Size([1346, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.08884239196777344  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.08884239196777344  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 1346, 128]), torch.Size([1, 1346, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.09012603759765625  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.11900901794433594  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 1346, 128])
m.shape torch.Size([1071, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.12040996551513672  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.12040996551513672  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 1071, 128]), torch.Size([1, 1071, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.12143135070800781  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.15105152130126953  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 1071, 128])
m.shape torch.Size([981, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.1528797149658203  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.1528797149658203  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 981, 128]), torch.Size([1, 981, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.15381526947021484  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.18815135955810547  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 981, 128])
m.shape torch.Size([707, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.18970632553100586  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.18970632553100586  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 707, 128]), torch.Size([1, 707, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.19038057327270508  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.22025108337402344  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 707, 128])
m.shape torch.Size([603, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.22192668914794922  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.22192668914794922  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 603, 128]), torch.Size([1, 603, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.2225017547607422  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.2518172264099121  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 603, 128])
m.shape torch.Size([519, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.253509521484375  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.253509521484375  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 519, 128]), torch.Size([1, 519, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.25400447845458984  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.282376766204834  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 519, 128])
m.shape torch.Size([434, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.28399181365966797  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.28399181365966797  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 434, 128]), torch.Size([1, 434, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.2844057083129883  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.3108949661254883  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 434, 128])
m.shape torch.Size([2657, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.32335758209228516  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.32335758209228516  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 1328, 128]), torch.Size([1, 1328, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.32462406158447266  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.4147148132324219  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst 0 shape torch.Size([1, 1328, 128])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.4147148132324219  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.4147148132324219  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 1329, 128]), torch.Size([1, 1329, 128])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.4159822463989258  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.5053367614746094  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst 1 shape torch.Size([1, 1329, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.48082876205444336  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.4916539192199707  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.502479076385498  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.49156904220581055  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

torch.Size([11351, 256])
first layer input nodes number: 24260
first layer output nodes number: 11351
edges number: 60957
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.502662181854248  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.5134873390197754  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.5167808532714844  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.5167808532714844  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

m.shape torch.Size([1048, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.5485048294067383  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.5485048294067383  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 1048, 256]), torch.Size([1, 1048, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.5520792007446289  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.5712075233459473  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 1048, 256])
m.shape torch.Size([944, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.5712218284606934  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.5712218284606934  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 944, 256]), torch.Size([1, 944, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.5730223655700684  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.6000304222106934  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 944, 256])
m.shape torch.Size([690, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.6011199951171875  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.6011199951171875  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 690, 256]), torch.Size([1, 690, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.6024360656738281  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.6313896179199219  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 690, 256])
m.shape torch.Size([535, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.6327886581420898  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.6327886581420898  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 535, 256]), torch.Size([1, 535, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.6338090896606445  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.6639738082885742  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 535, 256])
m.shape torch.Size([475, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.6657466888427734  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.6657466888427734  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 475, 256]), torch.Size([1, 475, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.6666526794433594  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.6992683410644531  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 475, 256])
m.shape torch.Size([313, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.7006254196166992  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.7006254196166992  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.7012224197387695  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.7289609909057617  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([255, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.7303781509399414  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.7303781509399414  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.7308645248413086  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.755183219909668  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([209, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.7565474510192871  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.7565474510192871  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.7569460868835449  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.7796683311462402  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([198, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.781181812286377  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.781181812286377  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.7815594673156738  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.8057293891906738  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([149, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.807131290435791  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.807131290435791  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.8074154853820801  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.8275933265686035  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([118, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.8286991119384766  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.8286991119384766  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.8289241790771484  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.8464794158935547  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([84, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.8473358154296875  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.8473358154296875  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.8474960327148438  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.861114501953125  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([80, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.8621487617492676  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.8621487617492676  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.8623013496398926  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.8763394355773926  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([63, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.8771109580993652  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.8771109580993652  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.8772311210632324  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.889127254486084  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([51, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.8898024559020996  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.8898024559020996  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.889899730682373  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9002108573913574  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([51, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9009466171264648  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9009466171264648  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9010438919067383  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9120359420776367  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([39, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9126248359680176  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9126248359680176  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9126992225646973  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9216256141662598  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9221596717834473  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9221596717834473  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9222226142883301  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9302163124084473  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([20, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9305500984191895  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9305500984191895  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9305882453918457  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9356999397277832  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9360847473144531  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9360847473144531  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9361248016357422  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9417724609375  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9421968460083008  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9421968460083008  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9422388076782227  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9484491348266602  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9487032890319824  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9487032890319824  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.948728084564209  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9525713920593262  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9528689384460449  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9528689384460449  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9528956413269043  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.957221508026123  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9575080871582031  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9575080871582031  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9575328826904297  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9617233276367188  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([141, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9650993347167969  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9650993347167969  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9653682708740234  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 1.0127010345458984  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 141, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9874930381774902  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9883246421813965  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9891562461853027  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9882826805114746  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

torch.Size([5579, 40])
input nodes number: 11351
output nodes number: 5579
edges number: 30901
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9884014129638672  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.9884018898010254  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.02024698257446289  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

pseudo mini batch 12 input nodes size: 54844
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.018146038055419922  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.018146038055419922  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04429769515991211  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.04433917999267578  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.032578468322753906  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.03450489044189453  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.03450489044189453  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.03450489044189453  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

torch.Size([54844, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8455810546875 GB
    Memory Allocated: 0.03450489044189453  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

m.shape torch.Size([1270, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.13523578643798828  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.13523578643798828  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 1270, 128]), torch.Size([1, 1270, 128])
----------------------------------------3
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.13644695281982422  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.14613628387451172  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 1270, 128])
m.shape torch.Size([1217, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.14669132232666016  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.14669132232666016  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 1217, 128]), torch.Size([1, 1217, 128])
----------------------------------------3
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.14785194396972656  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.16558265686035156  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 1217, 128])
m.shape torch.Size([1144, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.16663885116577148  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.16663885116577148  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 1144, 128]), torch.Size([1, 1144, 128])
----------------------------------------3
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.16772985458374023  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.19254064559936523  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 1144, 128])
m.shape torch.Size([1038, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.19397497177124023  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.19397497177124023  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 1038, 128]), torch.Size([1, 1038, 128])
----------------------------------------3
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.19496488571166992  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.22367238998413086  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 1038, 128])
m.shape torch.Size([985, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.2255258560180664  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.2255258560180664  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 985, 128]), torch.Size([1, 985, 128])
----------------------------------------3
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.22646522521972656  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.2610030174255371  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 985, 128])
m.shape torch.Size([897, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.26309967041015625  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.26309967041015625  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 897, 128]), torch.Size([1, 897, 128])
----------------------------------------3
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.26395511627197266  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.3011035919189453  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 897, 128])
m.shape torch.Size([836, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.3034663200378418  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.3034663200378418  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 836, 128]), torch.Size([1, 836, 128])
----------------------------------------3
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.3042635917663574  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.3449225425720215  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 836, 128])
m.shape torch.Size([757, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.3474116325378418  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.3474116325378418  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 757, 128]), torch.Size([1, 757, 128])
----------------------------------------3
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.34813356399536133  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.390592098236084  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 757, 128])
m.shape torch.Size([747, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.39343690872192383  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.39343690872192383  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 747, 128]), torch.Size([1, 747, 128])
----------------------------------------3
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.3941493034362793  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.4411754608154297  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 747, 128])
m.shape torch.Size([16369, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.5188727378845215  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.5188727378845215  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 8184, 128]), torch.Size([1, 8184, 128])
----------------------------------------3
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 0.5266776084899902  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.0812430381774902  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst 0 shape torch.Size([1, 8184, 128])
----------------------------------------1
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.0812430381774902  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.0812430381774902  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 8185, 128]), torch.Size([1, 8185, 128])
----------------------------------------3
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.0890860557556152  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.6397452354431152  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst 1 shape torch.Size([1, 8185, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.5497007369995117  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.5737905502319336  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.5978803634643555  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.5736021995544434  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

torch.Size([25260, 256])
first layer input nodes number: 54844
first layer output nodes number: 25260
edges number: 203916
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.5982909202575684  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.6223807334899902  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.6292147636413574  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.6292147636413574  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

m.shape torch.Size([841, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.6826319694519043  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.6826319694519043  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 841, 256]), torch.Size([1, 841, 256])
----------------------------------------3
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.6842360496520996  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.699204921722412  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 841, 256])
m.shape torch.Size([644, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.6997671127319336  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.6997671127319336  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 644, 256]), torch.Size([1, 644, 256])
----------------------------------------3
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.7009954452514648  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.7194204330444336  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 644, 256])
m.shape torch.Size([476, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.7202820777893066  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.7202820777893066  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 476, 256]), torch.Size([1, 476, 256])
----------------------------------------3
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.7211899757385254  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.7425265312194824  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 476, 256])
m.shape torch.Size([374, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.74354887008667  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.74354887008667  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 374, 256]), torch.Size([1, 374, 256])
----------------------------------------3
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.7442622184753418  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.765418529510498  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 374, 256])
m.shape torch.Size([297, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.7664895057678223  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.7664895057678223  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.7670559883117676  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.7881646156311035  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([268, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.7894272804260254  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.7894272804260254  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.7899384498596191  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.8126578330993652  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([196, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.8137211799621582  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.8137211799621582  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.8140950202941895  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.832787036895752  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([152, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.8337688446044922  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.8337688446044922  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.8340587615966797  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.8505840301513672  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([167, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.8520488739013672  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.8520488739013672  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.8523674011230469  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.8727531433105469  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([128, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.873824119567871  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.873824119567871  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.874068260192871  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.891402244567871  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([112, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.8924646377563477  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.8924646377563477  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.8926782608032227  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.9093408584594727  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([111, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.9105143547058105  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.9105143547058105  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.9107260704040527  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.9287219047546387  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([87, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.9297032356262207  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.9297032356262207  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.9298691749572754  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.9451355934143066  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([72, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.946021556854248  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.946021556854248  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.9461588859558105  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.959754467010498  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([75, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.9607672691345215  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.9607672691345215  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.9609103202819824  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.9760737419128418  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([69, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.9770636558532715  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.9770636558532715  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.9771952629089355  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.9920668601989746  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([72, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.993177890777588  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.993177890777588  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 1.9933152198791504  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.0097947120666504  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([64, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.010833263397217  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.010833263397217  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.010955333709717  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.026458263397217  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([65, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.0275845527648926  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.0275845527648926  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.0277085304260254  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.0443215370178223  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([59, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.045393943786621  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.045393943786621  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.045506477355957  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.061373710632324  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([51, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.062346935272217  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.062346935272217  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.0624442100524902  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.076840877532959  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([38, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.0775961875915527  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.0775961875915527  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.0776686668395996  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.0889029502868652  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([40, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.0897512435913086  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.0897512435913086  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.089827537536621  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.102187156677246  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([40, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.103071689605713  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.103071689605713  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.1031479835510254  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.116041660308838  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([1019, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.140488624572754  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.140488624572754  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

 h.shape torch.Size([1, 1019, 256]), torch.Size([1, 1019, 256])
----------------------------------------3
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.14243221282959  GigaBytes
Max Memory Allocated: 2.4457693099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.4847517013549805  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

rst.shape  torch.Size([1, 1019, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.436955451965332  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.4377779960632324  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.438600540161133  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.4377365112304688  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

torch.Size([5517, 40])
input nodes number: 25260
output nodes number: 5517
edges number: 54502
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.437957286834717  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9432373046875 GB
    Memory Allocated: 2.437957763671875  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9959716796875 GB
    Memory Allocated: 0.03786516189575195  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

pseudo mini batch 13 input nodes size: 53852
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9959716796875 GB
    Memory Allocated: 0.03256940841674805  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9959716796875 GB
    Memory Allocated: 0.03256940841674805  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9959716796875 GB
    Memory Allocated: 0.058248043060302734  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9959716796875 GB
    Memory Allocated: 0.05829191207885742  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9959716796875 GB
    Memory Allocated: 0.03209877014160156  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9959716796875 GB
    Memory Allocated: 0.03463459014892578  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9959716796875 GB
    Memory Allocated: 0.03463459014892578  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9959716796875 GB
    Memory Allocated: 0.03463459014892578  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

torch.Size([53852, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9959716796875 GB
    Memory Allocated: 0.03463459014892578  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

m.shape torch.Size([764, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.16108942031860352  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.16108942031860352  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

 h.shape torch.Size([1, 764, 128]), torch.Size([1, 764, 128])
----------------------------------------3
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.1618180274963379  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.16813230514526367  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

rst.shape  torch.Size([1, 764, 128])
m.shape torch.Size([843, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.16857194900512695  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.16857194900512695  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

 h.shape torch.Size([1, 843, 128]), torch.Size([1, 843, 128])
----------------------------------------3
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.16937589645385742  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.18219995498657227  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

rst.shape  torch.Size([1, 843, 128])
m.shape torch.Size([867, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.18303823471069336  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.18303823471069336  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

 h.shape torch.Size([1, 867, 128]), torch.Size([1, 867, 128])
----------------------------------------3
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.18386507034301758  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.20265769958496094  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

rst.shape  torch.Size([1, 867, 128])
m.shape torch.Size([877, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.2039170265197754  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.2039170265197754  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

 h.shape torch.Size([1, 877, 128]), torch.Size([1, 877, 128])
----------------------------------------3
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.20475339889526367  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.2290959358215332  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

rst.shape  torch.Size([1, 877, 128])
m.shape torch.Size([828, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.23065185546875  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.23065185546875  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

 h.shape torch.Size([1, 828, 128]), torch.Size([1, 828, 128])
----------------------------------------3
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.23144149780273438  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.26032447814941406  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

rst.shape  torch.Size([1, 828, 128])
m.shape torch.Size([846, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.26235008239746094  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.26235008239746094  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

 h.shape torch.Size([1, 846, 128]), torch.Size([1, 846, 128])
----------------------------------------3
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.2631568908691406  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.29817962646484375  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

rst.shape  torch.Size([1, 846, 128])
m.shape torch.Size([890, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.3007469177246094  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.3007469177246094  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

 h.shape torch.Size([1, 890, 128]), torch.Size([1, 890, 128])
----------------------------------------3
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.30159568786621094  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.3453207015991211  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

rst.shape  torch.Size([1, 890, 128])
m.shape torch.Size([838, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.34809303283691406  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.34809303283691406  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

 h.shape torch.Size([1, 838, 128]), torch.Size([1, 838, 128])
----------------------------------------3
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.3488922119140625  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.39479637145996094  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

rst.shape  torch.Size([1, 838, 128])
m.shape torch.Size([869, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.39812612533569336  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.39812612533569336  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

 h.shape torch.Size([1, 869, 128]), torch.Size([1, 869, 128])
----------------------------------------3
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.3989548683166504  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.4531116485595703  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

rst.shape  torch.Size([1, 869, 128])
m.shape torch.Size([21954, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.2264404296875 GB
    Memory Allocated: 0.5581660270690918  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2264404296875 GB
    Memory Allocated: 0.5581660270690918  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

 h.shape torch.Size([1, 10977, 128]), torch.Size([1, 10977, 128])
----------------------------------------3
 Nvidia-smi: 4.2264404296875 GB
    Memory Allocated: 0.5694098472595215  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2264404296875 GB
    Memory Allocated: 1.3135337829589844  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

rst 0 shape torch.Size([1, 10977, 128])
----------------------------------------1
 Nvidia-smi: 4.2264404296875 GB
    Memory Allocated: 1.3135337829589844  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2264404296875 GB
    Memory Allocated: 1.3135337829589844  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

 h.shape torch.Size([1, 10977, 128]), torch.Size([1, 10977, 128])
----------------------------------------3
 Nvidia-smi: 4.2264404296875 GB
    Memory Allocated: 1.3240022659301758  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6873779296875 GB
    Memory Allocated: 2.0729784965515137  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

rst 1 shape torch.Size([1, 10977, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.6873779296875 GB
    Memory Allocated: 1.9582324028015137  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.6873779296875 GB
    Memory Allocated: 1.986438274383545  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.6873779296875 GB
    Memory Allocated: 2.014644145965576  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.6873779296875 GB
    Memory Allocated: 1.9862174987792969  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

torch.Size([29576, 256])
first layer input nodes number: 53852
first layer output nodes number: 29576
edges number: 258070
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.6873779296875 GB
    Memory Allocated: 2.015047550201416  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.6873779296875 GB
    Memory Allocated: 2.0432534217834473  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.6873779296875 GB
    Memory Allocated: 2.050304889678955  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.6873779296875 GB
    Memory Allocated: 2.050304889678955  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

m.shape torch.Size([434, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.1299266815185547  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.1299266815185547  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

 h.shape torch.Size([1, 434, 256]), torch.Size([1, 434, 256])
----------------------------------------3
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.1307544708251953  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.1375699043273926  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

rst.shape  torch.Size([1, 434, 256])
m.shape torch.Size([386, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.1378984451293945  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.1378984451293945  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

 h.shape torch.Size([1, 386, 256]), torch.Size([1, 386, 256])
----------------------------------------3
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.13863468170166  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.1504383087158203  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

rst.shape  torch.Size([1, 386, 256])
m.shape torch.Size([328, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.1510162353515625  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.1510162353515625  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

 h.shape torch.Size([1, 328, 256]), torch.Size([1, 328, 256])
----------------------------------------3
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.151641845703125  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.1665663719177246  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

rst.shape  torch.Size([1, 328, 256])
m.shape torch.Size([275, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.1673569679260254  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.1673569679260254  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.167881488800049  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.1846413612365723  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([240, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.1861186027526855  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.1861186027526855  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.1865763664245605  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.2030558586120605  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([206, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.2040152549743652  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.2040152549743652  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.2044081687927246  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.2213034629821777  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([179, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.222311496734619  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.222311496734619  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.2226529121398926  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.2397236824035645  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([154, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.2410173416137695  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.2410173416137695  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.2413110733032227  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.258053779602051  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([163, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.259316921234131  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.259316921234131  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.2596278190612793  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.2795252799987793  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([166, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.2818117141723633  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.2818117141723633  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.28212833404541  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.3046083450317383  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([152, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.3060574531555176  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.3060574531555176  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.306347370147705  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.32896089553833  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([155, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.331064224243164  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.331064224243164  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.33135986328125  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.3564891815185547  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([135, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.3580284118652344  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.3580284118652344  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.358285903930664  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.3819751739501953  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([106, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.3840126991271973  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.3840126991271973  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.3842148780822754  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.4042305946350098  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([99, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.405557155609131  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.405557155609131  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.4057459831237793  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.4257616996765137  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([108, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.4280924797058105  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.4280924797058105  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.4282984733581543  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.451575756072998  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([91, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.4529600143432617  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.4529600143432617  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.4531335830688477  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.47396183013916  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([102, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.4762420654296875  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.4762420654296875  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.4764366149902344  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.5011444091796875  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([96, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.502800464630127  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.502800464630127  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.502983570098877  GigaBytes
Max Memory Allocated: 2.5090465545654297  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.527519702911377  GigaBytes
Max Memory Allocated: 2.530233860015869  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([94, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.5301566123962402  GigaBytes
Max Memory Allocated: 2.530233860015869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.5301566123962402  GigaBytes
Max Memory Allocated: 2.530233860015869  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.5303359031677246  GigaBytes
Max Memory Allocated: 2.5303359031677246  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.5556159019470215  GigaBytes
Max Memory Allocated: 2.5574088096618652  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([108, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.557706356048584  GigaBytes
Max Memory Allocated: 2.5577149391174316  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.557706356048584  GigaBytes
Max Memory Allocated: 2.5577149391174316  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.5579123497009277  GigaBytes
Max Memory Allocated: 2.5579123497009277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.5883994102478027  GigaBytes
Max Memory Allocated: 2.5906901359558105  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([69, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.5905985832214355  GigaBytes
Max Memory Allocated: 2.5906901359558105  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.5905985832214355  GigaBytes
Max Memory Allocated: 2.5906901359558105  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.5907301902770996  GigaBytes
Max Memory Allocated: 2.5907301902770996  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.6111292839050293  GigaBytes
Max Memory Allocated: 2.612576961517334  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([79, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.6128101348876953  GigaBytes
Max Memory Allocated: 2.6128172874450684  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.6128101348876953  GigaBytes
Max Memory Allocated: 2.6128172874450684  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.6129608154296875  GigaBytes
Max Memory Allocated: 2.6129608154296875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.637371063232422  GigaBytes
Max Memory Allocated: 2.639103889465332  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([76, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.6390490531921387  GigaBytes
Max Memory Allocated: 2.639103889465332  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.6390490531921387  GigaBytes
Max Memory Allocated: 2.639103889465332  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 2.6391940116882324  GigaBytes
Max Memory Allocated: 2.6391940116882324  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7772216796875 GB
    Memory Allocated: 2.663691997528076  GigaBytes
Max Memory Allocated: 2.665431499481201  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([1853, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.7772216796875 GB
    Memory Allocated: 2.708143711090088  GigaBytes
Max Memory Allocated: 2.7083163261413574  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7772216796875 GB
    Memory Allocated: 2.708143711090088  GigaBytes
Max Memory Allocated: 2.7083163261413574  GigaBytes

 h.shape torch.Size([1, 1853, 256]), torch.Size([1, 1853, 256])
----------------------------------------3
 Nvidia-smi: 4.7772216796875 GB
    Memory Allocated: 2.7116780281066895  GigaBytes
Max Memory Allocated: 2.7116780281066895  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 3.335197925567627  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1853, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 3.260481834411621  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8240966796875 GB
    Memory Allocated: 3.261354446411133  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8260498046875 GB
    Memory Allocated: 3.2622270584106445  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.8260498046875 GB
    Memory Allocated: 3.261310577392578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([5854, 40])
input nodes number: 29576
output nodes number: 5854
edges number: 82161
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8260498046875 GB
    Memory Allocated: 3.261625289916992  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.8260498046875 GB
    Memory Allocated: 3.2616257667541504  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.03896284103393555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

pseudo mini batch 14 input nodes size: 63129
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.03214883804321289  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.03214883804321289  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.06225109100341797  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.06229257583618164  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.036570072174072266  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.03873109817504883  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.03873109817504883  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.03873109817504883  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([63129, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.03873109817504883  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([1236, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.15366268157958984  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.15366268157958984  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1236, 128]), torch.Size([1, 1236, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.15484142303466797  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.16427135467529297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1236, 128])
m.shape torch.Size([1358, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1649770736694336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1649770736694336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1358, 128]), torch.Size([1, 1358, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.16627216339111328  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1856985092163086  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1358, 128])
m.shape torch.Size([1281, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.18688344955444336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.18688344955444336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1281, 128]), torch.Size([1, 1281, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.18810510635375977  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2149815559387207  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1281, 128])
m.shape torch.Size([1214, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.21668624877929688  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.21668624877929688  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1214, 128]), torch.Size([1, 1214, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.21784400939941406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2514190673828125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1214, 128])
m.shape torch.Size([1184, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2536630630493164  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2536630630493164  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1184, 128]), torch.Size([1, 1184, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2547922134399414  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2954416275024414  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1184, 128])
m.shape torch.Size([1077, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2979583740234375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2979583740234375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1077, 128]), torch.Size([1, 1077, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.29898548126220703  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.34351301193237305  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1077, 128])
m.shape torch.Size([1027, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.34642744064331055  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.34642744064331055  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1027, 128]), torch.Size([1, 1027, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.34740686416625977  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.39681053161621094  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1027, 128])
m.shape torch.Size([995, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.4001164436340332  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.4001164436340332  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 995, 128]), torch.Size([1, 995, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.4010653495788574  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.4561276435852051  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 995, 128])
m.shape torch.Size([957, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.4597601890563965  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.4597601890563965  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 957, 128]), torch.Size([1, 957, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.46067285537719727  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5193977355957031  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 957, 128])
m.shape torch.Size([18507, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6071896553039551  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6071896553039551  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 9253, 128]), torch.Size([1, 9253, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6160140037536621  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2425427436828613  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 0 shape torch.Size([1, 9253, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2425427436828613  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2425427436828613  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 9254, 128]), torch.Size([1, 9254, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2513680458068848  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8735523223876953  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 1 shape torch.Size([1, 9254, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7708287239074707  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7983288764953613  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.825829029083252  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7981138229370117  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([28836, 256])
first layer input nodes number: 63129
first layer output nodes number: 28836
edges number: 233865
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8263015747070312  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8538017272949219  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.861541748046875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.861541748046875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([711, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9162564277648926  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9162564277648926  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 711, 256]), torch.Size([1, 711, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9176125526428223  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9294071197509766  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 711, 256])
m.shape torch.Size([651, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.930006980895996  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.930006980895996  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 651, 256]), torch.Size([1, 651, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.931248664855957  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.949873924255371  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 651, 256])
m.shape torch.Size([491, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9508552551269531  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9508552551269531  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 491, 256]), torch.Size([1, 491, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.951791763305664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.972463607788086  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 491, 256])
m.shape torch.Size([382, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9737253189086914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9737253189086914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 382, 256]), torch.Size([1, 382, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9744539260864258  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.000528335571289  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 382, 256])
m.shape torch.Size([338, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0020594596862793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0020594596862793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 338, 256]), torch.Size([1, 338, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.00270414352417  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.030622959136963  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 338, 256])
m.shape torch.Size([261, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0321950912475586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0321950912475586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0326929092407227  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0664639472961426  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([195, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.068108081817627  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.068108081817627  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0684800148010254  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0870766639709473  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([173, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0887837409973145  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0887837409973145  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.089113712310791  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.107922077178955  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([130, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.1096487045288086  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.1096487045288086  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.109896659851074  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.125765800476074  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([137, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.127534866333008  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.127534866333008  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.127796173095703  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.1463489532470703  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([119, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.148110866546631  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.148110866546631  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.1483378410339355  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.166041851043701  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([97, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.1678199768066406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.1678199768066406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.1680049896240234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.1837310791015625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([94, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.185530662536621  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.185530662536621  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.1857099533081055  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.202204704284668  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([92, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2033534049987793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2033534049987793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.203528881072998  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2209010124206543  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([97, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2222118377685547  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2222118377685547  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2223968505859375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2420082092285156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([81, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.243161678314209  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.243161678314209  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.243316173553467  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2607741355895996  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([73, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2619242668151855  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2619242668151855  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.262063503265381  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2787718772888184  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([81, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2801036834716797  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2801036834716797  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2802581787109375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2998790740966797  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([62, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.301018238067627  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.301018238067627  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3011364936828613  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3169827461242676  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([59, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3180580139160156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3180580139160156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3181705474853516  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3340377807617188  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([55, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.335092067718506  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.335092067718506  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3351969718933105  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3507227897644043  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([48, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.352285385131836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.352285385131836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.352376937866211  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.366567611694336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([32, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.367229461669922  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.367229461669922  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.367290496826172  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.377178192138672  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([42, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3781166076660156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3781166076660156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3781967163085938  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.391735076904297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([1027, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.416372299194336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.416372299194336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1027, 256]), torch.Size([1, 1027, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.4183311462402344  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.778273105621338  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1027, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.729517936706543  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.730341911315918  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.731165885925293  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.7303004264831543  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([5528, 40])
input nodes number: 28836
output nodes number: 5528
edges number: 55980
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.730508327484131  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.730508804321289  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.042439937591552734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

pseudo mini batch 15 input nodes size: 65001
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.03652143478393555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.03652143478393555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.06751632690429688  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.06755781173706055  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.0374140739440918  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.03919649124145508  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.03919649124145508  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.03919649124145508  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([65001, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.03919649124145508  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([1421, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1350545883178711  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1350545883178711  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1421, 128]), torch.Size([1, 1421, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.13640975952148438  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.14746713638305664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1421, 128])
m.shape torch.Size([1485, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.14820575714111328  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.14820575714111328  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1485, 128]), torch.Size([1, 1485, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.14962196350097656  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.17125415802001953  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1485, 128])
m.shape torch.Size([1417, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.17257308959960938  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.17257308959960938  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1417, 128]), torch.Size([1, 1417, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.17392444610595703  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.20456218719482422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1417, 128])
m.shape torch.Size([1281, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.20674753189086914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.20674753189086914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1281, 128]), torch.Size([1, 1281, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.20796918869018555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.24532747268676758  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1281, 128])
m.shape torch.Size([1234, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.24765872955322266  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.24765872955322266  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1234, 128]), torch.Size([1, 1234, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.24883556365966797  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2921161651611328  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1234, 128])
m.shape torch.Size([1093, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.29465484619140625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.29465484619140625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1093, 128]), torch.Size([1, 1093, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2956972122192383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.34128761291503906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1093, 128])
m.shape torch.Size([978, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.34403085708618164  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.34403085708618164  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 978, 128]), torch.Size([1, 978, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.34496355056762695  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.39247560501098633  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 978, 128])
m.shape torch.Size([974, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3957247734069824  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3957247734069824  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 974, 128]), torch.Size([1, 974, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3966536521911621  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.4514918327331543  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 974, 128])
m.shape torch.Size([855, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.4546966552734375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.4546966552734375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 855, 128]), torch.Size([1, 855, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.45551204681396484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5076971054077148  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 855, 128])
m.shape torch.Size([14574, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5767836570739746  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5767836570739746  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 7287, 128]), torch.Size([1, 7287, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.583733081817627  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0771422386169434  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 0 shape torch.Size([1, 7287, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0771422386169434  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0771422386169434  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 7287, 128]), torch.Size([1, 7287, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0840916633605957  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.574026107788086  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 1 shape torch.Size([1, 7287, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.489363193511963  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.513502597808838  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.537642002105713  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5133137702941895  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([25312, 256])
first layer input nodes number: 65001
first layer output nodes number: 25312
edges number: 194567
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.53812837600708  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.562267780303955  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5683026313781738  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5683026313781738  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([902, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6126961708068848  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6126961708068848  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 902, 256]), torch.Size([1, 902, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6144165992736816  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6281800270080566  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 902, 256])
m.shape torch.Size([725, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6288337707519531  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6288337707519531  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 725, 256]), torch.Size([1, 725, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6302165985107422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6512622833251953  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 725, 256])
m.shape torch.Size([590, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6527419090270996  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6527419090270996  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 590, 256]), torch.Size([1, 590, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.653867244720459  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6811251640319824  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 590, 256])
m.shape torch.Size([464, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6827340126037598  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6827340126037598  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 464, 256]), torch.Size([1, 464, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6836190223693848  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7139363288879395  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 464, 256])
m.shape torch.Size([372, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7156658172607422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7156658172607422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 372, 256]), torch.Size([1, 372, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7163753509521484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.751260757446289  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 372, 256])
m.shape torch.Size([261, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7530755996704102  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7530755996704102  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7535734176635742  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.77724027633667  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([225, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.779160976409912  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.779160976409912  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.779590129852295  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8010478019714355  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([224, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.803004264831543  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.803004264831543  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.803431510925293  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.827784538269043  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([161, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8297395706176758  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8297395706176758  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8300466537475586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8496999740600586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([159, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8517160415649414  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8517160415649414  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8520193099975586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.873551368713379  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([118, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8755674362182617  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8755674362182617  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8757925033569336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8933477401733398  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([122, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8954038619995117  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8954038619995117  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8956365585327148  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9154157638549805  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([81, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9164695739746094  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9164695739746094  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9166240692138672  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.930837631225586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([81, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9318504333496094  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9318504333496094  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9320049285888672  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9472999572753906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([70, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9483070373535156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9483070373535156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9484405517578125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9625930786132812  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([59, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9634337425231934  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9634337425231934  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9635462760925293  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9762625694274902  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([59, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.977170467376709  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.977170467376709  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.977283000946045  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9907870292663574  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([50, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9915962219238281  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9915962219238281  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9916915893554688  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.003803253173828  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([63, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.004906177520752  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.004906177520752  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.005026340484619  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0211281776428223  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([37, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0217795372009277  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0217795372009277  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.021850109100342  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0318007469177246  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([38, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0325326919555664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0325326919555664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0326051712036133  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.043332099914551  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0437822341918945  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0437822341918945  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.043826103210449  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.050625801086426  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([28, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0512232780456543  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0512232780456543  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.051276683807373  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0599284172058105  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0604324340820312  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0604324340820312  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.060476303100586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.067890167236328  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([614, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0826215744018555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0826215744018555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 614, 256]), torch.Size([1, 614, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0837926864624023  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2965598106384277  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 614, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.258175849914551  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.259003162384033  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2598304748535156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2589616775512695  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([5549, 40])
input nodes number: 25312
output nodes number: 5549
edges number: 44443
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.259195327758789  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2591958045959473  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.04242753982543945  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.04797792434692383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.04797792434692383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014005079865455627 |0.023298919200897217 |0.1508008986711502 |9.450316429138184e-05 |0.07902048528194427 |0.005860805511474609 |
----------------------------------------------------------pseudo_mini_loss sum 5.330712795257568
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  845450
Number of first layer input nodes during this epoch:  574442
Number of first layer output nodes during this epoch:  271008
----------------------------------------before generate dataloader block 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.047977447509765625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.024324893951416016
global_2_local spend time (sec) 0.04723763465881348
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.003954410552978516
A = g.adjacency_matrix() spent  0.01426076889038086
auxiliary_graph
Graph(num_nodes=154728, num_edges=28937465,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.09124565124511719
remove nodes length
63787
auxiliary_graph.remove_nodes spent  1.3164341449737549
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28937465,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})[04:46:05] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28846524 edges into 16 parts and get 6577143 edge cuts

auxiliary_graph_no_diag generation spent  1.333284854888916

the counter of shared neighbor distribution
Counter({1.0: 23292734, 2.0: 4025850, 3.0: 1012928, 4.0: 306592, 5.0: 111950, 6.0: 47874, 7.0: 22518, 8.0: 11474, 9.0: 6096, 10.0: 3464, 11.0: 1990, 12.0: 1176, 13.0: 670, 14.0: 384, 15.0: 282, 16.0: 210, 17.0: 182, 18.0: 86, 19.0: 48, 21.0: 8, 20.0: 8})
28846524
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28846521, 28846522, 28846523])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23292734, 2.0: 4025850, 3.0: 1012928, 4.0: 306592, 5.0: 111950, 6.0: 47874, 7.0: 22518, 8.0: 11474, 9.0: 6096, 10.0: 3464, 11.0: 1990, 12.0: 1176, 13.0: 670, 14.0: 384, 15.0: 282, 16.0: 210, 17.0: 182, 18.0: 86, 19.0: 48, 21.0: 8, 20.0: 8})
Convert a graph into a bidirected graph: 1.260 seconds
Metis partitioning: 5.541 seconds
Split the graph: 0.955 seconds
Construct subgraphs: 0.051 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  7.820696592330933
5845
5596
5671
5517
5854
5854
5853
5853
5517
5517
5568
5854
5854
5517
5523
5548
total k batches seeds list generation spend  18.210238456726074
after graph partition
graph partition algorithm spend time 18.30504298210144
5845
5596
5671
5517
5854
5854
5853
5853
5517
5517
5568
5854
5854
5517
5523
5548
partition_len_list
[12110, 11014, 12698, 12245, 12773, 14321, 11302, 11512, 19138, 23144, 14399, 12535, 28397, 25235, 24119, 28244]
shared_neighbor_graph_partition_s0 selection method  spend 18.41084051132202
time for parepare:  0.0213320255279541
local_output_nid generation:  0.001495361328125
local_in_edges_tensor generation:  0.0015447139739990234
mini_batch_src_global generation:  0.0018525123596191406
r_  generation:  0.016192913055419922
local_output_nid generation:  0.0015664100646972656
local_in_edges_tensor generation:  0.0013880729675292969
mini_batch_src_global generation:  0.0014913082122802734
r_  generation:  0.01349020004272461
local_output_nid generation:  0.0016837120056152344
local_in_edges_tensor generation:  0.001321554183959961
mini_batch_src_global generation:  0.0014116764068603516
r_  generation:  0.01527547836303711
local_output_nid generation:  0.0017385482788085938
local_in_edges_tensor generation:  0.0012664794921875
mini_batch_src_global generation:  0.0015349388122558594
r_  generation:  0.014986038208007812
local_output_nid generation:  0.0037555694580078125
local_in_edges_tensor generation:  0.0013217926025390625
mini_batch_src_global generation:  0.0018880367279052734
r_  generation:  0.01556539535522461
local_output_nid generation:  0.001852273941040039
local_in_edges_tensor generation:  0.0012772083282470703
mini_batch_src_global generation:  0.0015077590942382812
r_  generation:  0.016628265380859375
local_output_nid generation:  0.0019180774688720703
local_in_edges_tensor generation:  0.0012426376342773438
mini_batch_src_global generation:  0.0011496543884277344
r_  generation:  0.012389421463012695
local_output_nid generation:  0.0019121170043945312
local_in_edges_tensor generation:  0.0012352466583251953
mini_batch_src_global generation:  0.0011289119720458984
r_  generation:  0.014078140258789062
local_output_nid generation:  0.0018472671508789062
local_in_edges_tensor generation:  0.001190185546875
mini_batch_src_global generation:  0.0011851787567138672
r_  generation:  0.015038728713989258
local_output_nid generation:  0.0026090145111083984
local_in_edges_tensor generation:  0.0013267993927001953
mini_batch_src_global generation:  0.017769813537597656
r_  generation:  0.01566147804260254
local_output_nid generation:  0.0019178390502929688
local_in_edges_tensor generation:  0.0012180805206298828
mini_batch_src_global generation:  0.0012013912200927734
r_  generation:  0.013375997543334961
local_output_nid generation:  0.0019278526306152344
local_in_edges_tensor generation:  0.0012691020965576172
mini_batch_src_global generation:  0.0011239051818847656
r_  generation:  0.014625787734985352
local_output_nid generation:  0.0020406246185302734
local_in_edges_tensor generation:  0.0019676685333251953
mini_batch_src_global generation:  0.007558107376098633
r_  generation:  0.0282440185546875
local_output_nid generation:  0.002105236053466797
local_in_edges_tensor generation:  0.0017499923706054688
mini_batch_src_global generation:  0.002709627151489258
r_  generation:  0.021581411361694336
local_output_nid generation:  0.0021238327026367188
local_in_edges_tensor generation:  0.0013072490692138672
mini_batch_src_global generation:  0.0016617774963378906
r_  generation:  0.01688528060913086
local_output_nid generation:  0.0020232200622558594
local_in_edges_tensor generation:  0.0013306140899658203
mini_batch_src_global generation:  0.0019774436950683594
r_  generation:  0.02248525619506836
----------------------check_connections_block total spend ----------------------------- 0.4744899272918701
generate_one_block  0.027810335159301758
generate_one_block  0.021640777587890625
generate_one_block  0.023654937744140625
generate_one_block  0.023331403732299805
generate_one_block  0.02067875862121582
generate_one_block  0.022754907608032227
generate_one_block  0.016353368759155273
generate_one_block  0.018527984619140625
generate_one_block  0.020945072174072266
generate_one_block  0.023820877075195312
generate_one_block  0.018615007400512695
generate_one_block  0.017116785049438477
generate_one_block  0.03846454620361328
generate_one_block  0.031157493591308594
generate_one_block  0.02149176597595215
generate_one_block  0.02847766876220703
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04959845542907715
gen group dst list time:  0.008206844329833984
time for parepare:  0.02399301528930664
local_output_nid generation:  0.002602815628051758
local_in_edges_tensor generation:  0.011287450790405273
mini_batch_src_global generation:  0.0025544166564941406
r_  generation:  0.035765886306762695
local_output_nid generation:  0.004812479019165039
local_in_edges_tensor generation:  0.0035648345947265625
mini_batch_src_global generation:  0.0027146339416503906
r_  generation:  0.02316451072692871
local_output_nid generation:  0.004935026168823242
local_in_edges_tensor generation:  0.003520965576171875
mini_batch_src_global generation:  0.0025238990783691406
r_  generation:  0.029087066650390625
local_output_nid generation:  0.0048444271087646484
local_in_edges_tensor generation:  0.003238677978515625
mini_batch_src_global generation:  0.002571582794189453
r_  generation:  0.02756357192993164
local_output_nid generation:  0.0049703121185302734
local_in_edges_tensor generation:  0.003313779830932617
mini_batch_src_global generation:  0.0024557113647460938
r_  generation:  0.02942347526550293
local_output_nid generation:  0.0055065155029296875
local_in_edges_tensor generation:  0.004717111587524414
mini_batch_src_global generation:  0.0033740997314453125
r_  generation:  0.046441078186035156
local_output_nid generation:  0.007147550582885742
local_in_edges_tensor generation:  0.00538182258605957
mini_batch_src_global generation:  0.003190279006958008
r_  generation:  0.023302793502807617
local_output_nid generation:  0.004514932632446289
local_in_edges_tensor generation:  0.003033161163330078
mini_batch_src_global generation:  0.0021424293518066406
r_  generation:  0.02439594268798828
local_output_nid generation:  0.0070149898529052734
local_in_edges_tensor generation:  0.0050907135009765625
mini_batch_src_global generation:  0.004692554473876953
r_  generation:  0.047872304916381836
local_output_nid generation:  0.007525205612182617
local_in_edges_tensor generation:  0.006472349166870117
mini_batch_src_global generation:  0.008218050003051758
r_  generation:  0.064453125
local_output_nid generation:  0.005291461944580078
local_in_edges_tensor generation:  0.003587484359741211
mini_batch_src_global generation:  0.004342794418334961
r_  generation:  0.036472320556640625
local_output_nid generation:  0.004591941833496094
local_in_edges_tensor generation:  0.004475831985473633
mini_batch_src_global generation:  0.003255128860473633
r_  generation:  0.027787446975708008
local_output_nid generation:  0.008489131927490234
local_in_edges_tensor generation:  0.007658243179321289
mini_batch_src_global generation:  0.008931875228881836
r_  generation:  0.0842902660369873
local_output_nid generation:  0.008162498474121094
local_in_edges_tensor generation:  0.006829261779785156
mini_batch_src_global generation:  0.009715080261230469
r_  generation:  0.07434821128845215
local_output_nid generation:  0.008342266082763672
local_in_edges_tensor generation:  0.0058634281158447266
mini_batch_src_global generation:  0.010110139846801758
r_  generation:  0.06577634811401367
local_output_nid generation:  0.008791685104370117
local_in_edges_tensor generation:  0.00673365592956543
mini_batch_src_global generation:  0.014050006866455078
r_  generation:  0.08417654037475586
----------------------check_connections_block total spend ----------------------------- 1.2059764862060547
generate_one_block  0.05043935775756836
generate_one_block  0.03228354454040527
generate_one_block  0.037136077880859375
generate_one_block  0.036580801010131836
generate_one_block  0.03711891174316406
generate_one_block  0.045929908752441406
generate_one_block  0.029138565063476562
generate_one_block  0.031004905700683594
generate_one_block  0.06448721885681152
generate_one_block  0.08902263641357422
generate_one_block  0.044443368911743164
generate_one_block  0.03422832489013672
generate_one_block  0.11518430709838867
generate_one_block  0.09539675712585449
generate_one_block  0.09001421928405762
generate_one_block  0.1114661693572998
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.047977447509765625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

connection checking time:  1.6804664134979248
block generation total time  1.3187167644500732
average batch blocks generation time:  0.08241979777812958
block dataloader generation time/epoch 21.641205072402954
pseudo mini batch 0 input nodes size: 24976
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.04296684265136719  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.04296684265136719  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.05487632751464844  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.054920196533203125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.023883819580078125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.024843215942382812  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.024843215942382812  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.024843215942382812  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([24976, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.024843215942382812  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([954, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.06541824340820312  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.06541824340820312  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 954, 128]), torch.Size([1, 954, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.06632804870605469  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.07360649108886719  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 954, 128])
m.shape torch.Size([1092, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.07491397857666016  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.07491397857666016  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1092, 128]), torch.Size([1, 1092, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.07595539093017578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.09158802032470703  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1092, 128])
m.shape torch.Size([1069, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.09259653091430664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.09259653091430664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1069, 128]), torch.Size([1, 1069, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.09361600875854492  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.11604452133178711  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1069, 128])
m.shape torch.Size([957, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.11743688583374023  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.11743688583374023  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 957, 128]), torch.Size([1, 957, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.11834955215454102  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.14519834518432617  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 957, 128])
m.shape torch.Size([801, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.14758968353271484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.14758968353271484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 801, 128]), torch.Size([1, 801, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.14835357666015625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.17620086669921875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 801, 128])
m.shape torch.Size([716, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.17786741256713867  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.17786741256713867  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 716, 128]), torch.Size([1, 716, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.17855024337768555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.20914793014526367  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 716, 128])
m.shape torch.Size([653, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.21098613739013672  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.21098613739013672  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 653, 128]), torch.Size([1, 653, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.21160888671875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2436661720275879  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 653, 128])
m.shape torch.Size([602, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2456512451171875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2456512451171875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 602, 128]), torch.Size([1, 602, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.24622535705566406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2791481018066406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 602, 128])
m.shape torch.Size([520, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.28109264373779297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.28109264373779297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 520, 128]), torch.Size([1, 520, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2815885543823242  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3142881393432617  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 520, 128])
m.shape torch.Size([4746, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3374776840209961  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3374776840209961  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 2373, 128]), torch.Size([1, 2373, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3397407531738281  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5027799606323242  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 0 shape torch.Size([1, 2373, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5027799606323242  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5027799606323242  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 2373, 128]), torch.Size([1, 2373, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5050430297851562  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6669507026672363  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 1 shape torch.Size([1, 2373, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6322970390319824  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6438460350036621  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6553950309753418  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6437554359436035  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([12110, 256])
first layer input nodes number: 24976
first layer output nodes number: 12110
edges number: 80001
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.655583381652832  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6671323776245117  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6700196266174316  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6700196266174316  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([704, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7181687355041504  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7181687355041504  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 704, 256]), torch.Size([1, 704, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7195115089416504  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7304553985595703  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 704, 256])
m.shape torch.Size([665, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.732001781463623  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.732001781463623  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 665, 256]), torch.Size([1, 665, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7332701683044434  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7527422904968262  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 665, 256])
m.shape torch.Size([621, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7543854713439941  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7543854713439941  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 621, 256]), torch.Size([1, 621, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7555699348449707  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.782167911529541  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 621, 256])
m.shape torch.Size([483, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7834329605102539  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7834329605102539  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 483, 256]), torch.Size([1, 483, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7843542098999023  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8113870620727539  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 483, 256])
m.shape torch.Size([382, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8127622604370117  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8127622604370117  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 382, 256]), torch.Size([1, 382, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8134908676147461  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8403081893920898  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 382, 256])
m.shape torch.Size([320, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8417892456054688  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8417892456054688  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 320, 256]), torch.Size([1, 320, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8423995971679688  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8687820434570312  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 320, 256])
m.shape torch.Size([274, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8703203201293945  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8703203201293945  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8708429336547852  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8981647491455078  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([251, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8998336791992188  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8998336791992188  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9003124237060547  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9276008605957031  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 251, 256])
m.shape torch.Size([233, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9293770790100098  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9293770790100098  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9298214912414551  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9582638740539551  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([205, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9600124359130859  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9600124359130859  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9604034423828125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9881649017333984  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([199, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9900736808776855  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9900736808776855  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9904532432556152  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0200591087341309  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([149, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0220494270324707  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0220494270324707  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0223336219787598  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.04649019241333  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([139, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0480852127075195  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0480852127075195  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0483503341674805  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0727415084838867  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([106, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.07403564453125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.07403564453125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0742378234863281  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0942535400390625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([106, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0956807136535645  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0956807136535645  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0958828926086426  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1173138618469238  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([92, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1186275482177734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1186275482177734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1188030242919922  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.138631820678711  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([78, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1398186683654785  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1398186683654785  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.139967441558838  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.157820224761963  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([71, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1589741706848145  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1589741706848145  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1591095924377441  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1763081550598145  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([62, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.177372932434082  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.177372932434082  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1774911880493164  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1933374404907227  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([75, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1947202682495117  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1947202682495117  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1948633193969727  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2150335311889648  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([58, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2161331176757812  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2161331176757812  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2162437438964844  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2326164245605469  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([43, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2334704399108887  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2334704399108887  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2335524559020996  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.246264934539795  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([35, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2469978332519531  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2469978332519531  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2470645904541016  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2578792572021484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([34, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2586302757263184  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2586302757263184  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.258695125579834  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2696547508239746  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([460, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2806754112243652  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2806754112243652  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.281552791595459  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4375996589660645  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 460, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3957347869873047  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3966059684753418  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.397477149963379  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.396562099456787  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([5845, 40])
input nodes number: 12110
output nodes number: 5845
edges number: 48629
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.396740436553955  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3967413902282715  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.026733875274658203  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

pseudo mini batch 1 input nodes size: 21405
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.02392864227294922  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.02392864227294922  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.03413534164428711  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.034177303314208984  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.022223949432373047  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.023021221160888672  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.023021221160888672  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.023021221160888672  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([21405, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.023021221160888672  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([1149, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.05657815933227539  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.05657815933227539  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1149, 128]), torch.Size([1, 1149, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.05767393112182617  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.0670785903930664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1149, 128])
m.shape torch.Size([1167, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.06804275512695312  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.06804275512695312  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1167, 128]), torch.Size([1, 1167, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.06915569305419922  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.08647346496582031  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1167, 128])
m.shape torch.Size([1059, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.0874319076538086  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.0874319076538086  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1059, 128]), torch.Size([1, 1059, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.08844184875488281  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.11066055297851562  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1059, 128])
m.shape torch.Size([951, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1119694709777832  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1119694709777832  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 951, 128]), torch.Size([1, 951, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.11287641525268555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.14008569717407227  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 951, 128])
m.shape torch.Size([778, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.14148712158203125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.14148712158203125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 778, 128]), torch.Size([1, 778, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1422290802001953  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.17002248764038086  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 778, 128])
m.shape torch.Size([721, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.17171430587768555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.17171430587768555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 721, 128]), torch.Size([1, 721, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.17240190505981445  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.20296430587768555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 721, 128])
m.shape torch.Size([593, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.20459985733032227  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.20459985733032227  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 593, 128]), torch.Size([1, 593, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.20516538619995117  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2347698211669922  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 593, 128])
m.shape torch.Size([545, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.23656606674194336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.23656606674194336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 545, 128]), torch.Size([1, 545, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.23708581924438477  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2670741081237793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 545, 128])
m.shape torch.Size([408, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.26856517791748047  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.26856517791748047  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 408, 128]), torch.Size([1, 408, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2689542770385742  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2938566207885742  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 408, 128])
m.shape torch.Size([3643, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3110332489013672  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3110332489013672  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1821, 128]), torch.Size([1, 1821, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.31276988983154297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.43686485290527344  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 0 shape torch.Size([1, 1821, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.43686485290527344  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.43686485290527344  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1822, 128]), torch.Size([1, 1822, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.4386024475097656  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.561103343963623  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 1 shape torch.Size([1, 1822, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5335640907287598  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5440678596496582  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5545716285705566  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5439853668212891  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([11014, 256])
first layer input nodes number: 21405
first layer output nodes number: 11014
edges number: 67293
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5547332763671875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5652370452880859  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5678629875183105  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5678629875183105  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([878, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.607022762298584  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.607022762298584  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 878, 256]), torch.Size([1, 878, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6086974143981934  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6220946311950684  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 878, 256])
m.shape torch.Size([734, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6234235763549805  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6234235763549805  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 734, 256]), torch.Size([1, 734, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6248235702514648  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6465291976928711  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 734, 256])
m.shape torch.Size([586, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6479978561401367  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6479978561401367  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 586, 256]), torch.Size([1, 586, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6491155624389648  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6741890907287598  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 586, 256])
m.shape torch.Size([488, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6758003234863281  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6758003234863281  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 488, 256]), torch.Size([1, 488, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6767311096191406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7064275741577148  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 488, 256])
m.shape torch.Size([403, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7087469100952148  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7087469100952148  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 403, 256]), torch.Size([1, 403, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7095155715942383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7374067306518555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 403, 256])
m.shape torch.Size([372, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7391676902770996  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7391676902770996  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 372, 256]), torch.Size([1, 372, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7398772239685059  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7705245018005371  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 372, 256])
m.shape torch.Size([296, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7721614837646484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7721614837646484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 296, 256]), torch.Size([1, 296, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7727260589599609  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8016490936279297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 296, 256])
m.shape torch.Size([235, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8039751052856445  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8039751052856445  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8044233322143555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8299722671508789  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([177, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8312792778015137  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8312792778015137  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8316168785095215  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8532233238220215  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([190, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8548808097839355  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8548808097839355  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8552432060241699  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8809733390808105  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([152, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8823995590209961  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8823995590209961  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8826894760131836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9053030014038086  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([114, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9064731597900391  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9064731597900391  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9066905975341797  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9251728057861328  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([111, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9264512062072754  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9264512062072754  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9266629219055176  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9461407661437988  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([98, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9473538398742676  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9473538398742676  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9475407600402832  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9660458564758301  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([64, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9668750762939453  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9668750762939453  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9669971466064453  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9799365997314453  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([63, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9808444976806641  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9808444976806641  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9809646606445312  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9945430755615234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([79, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9957737922668457  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9957737922668457  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9959244728088379  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0140061378479004  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([54, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0148653984069824  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0148653984069824  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0149683952331543  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0280489921569824  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([43, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.028782844543457  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.028782844543457  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.028864860534668  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0398550033569336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([47, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.040717601776123  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.040717601776123  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0408072471618652  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0534472465515137  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0541496276855469  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0541496276855469  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.054220199584961  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0646648406982422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([28, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0652217864990234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0652217864990234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0652751922607422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0735530853271484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([24, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0740571022033691  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0740571022033691  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0741028785705566  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0815186500549316  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([31, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0822110176086426  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0822110176086426  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0822701454162598  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0922627449035645  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([292, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0992498397827148  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0992498397827148  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.099806785583496  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2003555297851562  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 292, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1674985885620117  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.168332576751709  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1691665649414062  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.168290615081787  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([5596, 40])
input nodes number: 11014
output nodes number: 5596
edges number: 39632
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1683778762817383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1683783531188965  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.024547576904296875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

pseudo mini batch 2 input nodes size: 22736
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.022186756134033203  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.022186756134033203  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.0339055061340332  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.03394794464111328  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.023699283599853516  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.024654865264892578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.024654865264892578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.024654865264892578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([22736, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.024654865264892578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([1077, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.06579017639160156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.06579017639160156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1077, 128]), torch.Size([1, 1077, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.0668172836303711  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.07503414154052734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1077, 128])
m.shape torch.Size([1199, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.0759115219116211  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.0759115219116211  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1199, 128]), torch.Size([1, 1199, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.07705497741699219  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.0949563980102539  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1199, 128])
m.shape torch.Size([1116, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.09598112106323242  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.09598112106323242  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1116, 128]), torch.Size([1, 1116, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.0970454216003418  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.12136030197143555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1116, 128])
m.shape torch.Size([959, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.12265729904174805  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.12265729904174805  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 959, 128]), torch.Size([1, 959, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.12357187271118164  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.15048742294311523  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 959, 128])
m.shape torch.Size([899, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.15285110473632812  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.15285110473632812  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 899, 128]), torch.Size([1, 899, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.15370845794677734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.18476581573486328  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 899, 128])
m.shape torch.Size([754, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1864943504333496  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1864943504333496  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 754, 128]), torch.Size([1, 754, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.18721342086791992  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.21843671798706055  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 754, 128])
m.shape torch.Size([671, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.22031688690185547  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.22031688690185547  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 671, 128]), torch.Size([1, 671, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.22095680236816406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.25328636169433594  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 671, 128])
m.shape torch.Size([604, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.25527048110961914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.25527048110961914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 604, 128]), torch.Size([1, 604, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2558465003967285  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2887711524963379  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 604, 128])
m.shape torch.Size([510, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.29067182540893555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.29067182540893555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 510, 128]), torch.Size([1, 510, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.29115819931030273  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.32228612899780273  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 510, 128])
m.shape torch.Size([4909, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.34548044204711914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.34548044204711914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 2454, 128]), torch.Size([1, 2454, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3478207588195801  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5204529762268066  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 0 shape torch.Size([1, 2454, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5204529762268066  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5204529762268066  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 2455, 128]), torch.Size([1, 2455, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.522794246673584  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6950740814208984  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 1 shape torch.Size([1, 2455, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6601920127868652  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6723017692565918  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6844115257263184  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6722068786621094  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([12698, 256])
first layer input nodes number: 22736
first layer output nodes number: 12698
edges number: 82887
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6845831871032715  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.696692943572998  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7001991271972656  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7001991271972656  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([756, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7446384429931641  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7446384429931641  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 756, 256]), torch.Size([1, 756, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7460803985595703  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7579030990600586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 756, 256])
m.shape torch.Size([708, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7585597038269043  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7585597038269043  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 708, 256]), torch.Size([1, 708, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7599101066589355  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7801661491394043  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 708, 256])
m.shape torch.Size([600, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.781280517578125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.781280517578125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 600, 256]), torch.Size([1, 600, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7824249267578125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8081483840942383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 600, 256])
m.shape torch.Size([462, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8094267845153809  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8094267845153809  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 462, 256]), torch.Size([1, 462, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8103079795837402  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8363776206970215  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 462, 256])
m.shape torch.Size([396, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8378400802612305  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8378400802612305  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 396, 256]), torch.Size([1, 396, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8385953903198242  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8662939071655273  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 396, 256])
m.shape torch.Size([317, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8677444458007812  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8677444458007812  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 317, 256]), torch.Size([1, 317, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8683490753173828  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8950290679931641  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 317, 256])
m.shape torch.Size([291, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8966846466064453  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8966846466064453  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8972396850585938  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9255685806274414  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 291, 256])
m.shape torch.Size([236, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9271059036254883  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9271059036254883  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.927556037902832  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9532136917114258  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([208, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9547882080078125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9547882080078125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9551849365234375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9805755615234375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([176, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9820690155029297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9820690155029297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9824047088623047  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0062389373779297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([166, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.007826328277588  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.007826328277588  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0081429481506348  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.032839298248291  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([125, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0341229438781738  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0341229438781738  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0343613624572754  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0546269416809082  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([110, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0567331314086914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0567331314086914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0569429397583008  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0762453079223633  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([105, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0775532722473145  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0775532722473145  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0777535438537598  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0975804328918457  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([93, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0988211631774902  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0988211631774902  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0989985466003418  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1178011894226074  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([80, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1189427375793457  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1189427375793457  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1190953254699707  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1363377571105957  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([85, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.137650489807129  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.137650489807129  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.137812614440918  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1572675704956055  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([53, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1581034660339355  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1581034660339355  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1582045555114746  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1710429191589355  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([43, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1717777252197266  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1717777252197266  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1718597412109375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1828498840332031  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([59, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.183943271636963  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.183943271636963  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1840558052062988  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.199923038482666  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([43, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.200735092163086  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.200735092163086  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2008171081542969  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2129554748535156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([28, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2135066986083984  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2135066986083984  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2135601043701172  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2218379974365234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([34, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2225632667541504  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2225632667541504  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.222628116607666  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2331337928771973  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([40, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2340240478515625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2340240478515625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.234100341796875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2469940185546875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([457, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.257936954498291  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.257936954498291  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 457, 256]), torch.Size([1, 457, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2588086128234863  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4147849082946777  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 457, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3766651153564453  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3775105476379395  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3783559799194336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3774681091308594  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([5671, 40])
input nodes number: 12698
output nodes number: 5671
edges number: 45242
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3776168823242188  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.377617359161377  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.026478290557861328  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

pseudo mini batch 3 input nodes size: 24823
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.02371072769165039  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.02371072769165039  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.03554725646972656  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.035588741302490234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.023827552795410156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.02474689483642578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.02474689483642578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.02474689483642578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([24823, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.02474689483642578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([1187, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.06369447708129883  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.06369447708129883  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1187, 128]), torch.Size([1, 1187, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.06482648849487305  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.0738825798034668  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1187, 128])
m.shape torch.Size([1206, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.07504510879516602  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.07504510879516602  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1206, 128]), torch.Size([1, 1206, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.07619524002075195  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.09377336502075195  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1206, 128])
m.shape torch.Size([1110, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.09503364562988281  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.09503364562988281  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1110, 128]), torch.Size([1, 1110, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.09609222412109375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.119781494140625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1110, 128])
m.shape torch.Size([928, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.12102222442626953  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.12102222442626953  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 928, 128]), torch.Size([1, 928, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.12190723419189453  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1479959487915039  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 928, 128])
m.shape torch.Size([812, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1494894027709961  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1494894027709961  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 812, 128]), torch.Size([1, 812, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.15026378631591797  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.17814159393310547  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 812, 128])
m.shape torch.Size([755, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1799144744873047  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1799144744873047  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 755, 128]), torch.Size([1, 755, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1806344985961914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.21162033081054688  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 755, 128])
m.shape torch.Size([609, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.21329307556152344  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.21329307556152344  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 609, 128]), torch.Size([1, 609, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.21387386322021484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.24386262893676758  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 609, 128])
m.shape torch.Size([551, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.24567413330078125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.24567413330078125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 551, 128]), torch.Size([1, 551, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2461996078491211  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2772960662841797  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 551, 128])
m.shape torch.Size([477, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2790803909301758  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2790803909301758  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 477, 128]), torch.Size([1, 477, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.27953529357910156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.30864906311035156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 477, 128])
m.shape torch.Size([4610, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.33040380477905273  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.33040380477905273  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 2305, 128]), torch.Size([1, 2305, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3329582214355469  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.49495649337768555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 0 shape torch.Size([1, 2305, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.49495649337768555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.49495649337768555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 2305, 128]), torch.Size([1, 2305, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.49715471267700195  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6597466468811035  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 1 shape torch.Size([1, 2305, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6260709762573242  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6377487182617188  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6494264602661133  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6376571655273438  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([12245, 256])
first layer input nodes number: 24823
first layer output nodes number: 12245
edges number: 78295
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6496133804321289  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6612911224365234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6642107963562012  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6642107963562012  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([836, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7085437774658203  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7085437774658203  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 836, 256]), torch.Size([1, 836, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7101383209228516  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7228946685791016  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 836, 256])
m.shape torch.Size([686, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7235832214355469  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7235832214355469  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 686, 256]), torch.Size([1, 686, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7248916625976562  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7451262474060059  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 686, 256])
m.shape torch.Size([590, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7462301254272461  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7462301254272461  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 590, 256]), torch.Size([1, 590, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7473554611206055  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7721128463745117  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 590, 256])
m.shape torch.Size([436, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7735090255737305  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7735090255737305  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 436, 256]), torch.Size([1, 436, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7743406295776367  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7994046211242676  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 436, 256])
m.shape torch.Size([371, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8007717132568359  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8007717132568359  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 371, 256]), torch.Size([1, 371, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8014793395996094  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8274850845336914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 371, 256])
m.shape torch.Size([298, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8288497924804688  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8288497924804688  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8294181823730469  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8546791076660156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 298, 256])
m.shape torch.Size([223, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8558955192565918  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8558955192565918  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.856320858001709  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8775877952575684  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([207, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8789668083190918  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8789668083190918  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.879361629486084  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9018664360046387  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([185, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9032697677612305  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9032697677612305  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9036226272583008  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9262056350708008  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([147, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9274420738220215  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9274420738220215  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9277224540710449  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.947629451751709  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([123, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9487900733947754  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9487900733947754  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9490246772766113  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9673237800598145  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([136, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9687752723693848  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9687752723693848  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9690346717834473  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9910836219787598  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([102, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9922285079956055  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9922285079956055  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9924230575561523  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0103216171264648  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([93, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.01163911819458  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.01163911819458  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0118165016174316  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0293774604797363  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([76, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0303845405578613  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0303845405578613  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.030529499053955  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0458950996398926  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([60, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0467453002929688  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0467453002929688  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0468597412109375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0597915649414062  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([74, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.060943603515625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.060943603515625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0610847473144531  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0780220031738281  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([74, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0792317390441895  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0792317390441895  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0793728828430176  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0972981452941895  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([56, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0982813835144043  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0982813835144043  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0983881950378418  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1127009391784668  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([49, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1135897636413574  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1135897636413574  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1136832237243652  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1268610954284668  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([64, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1281061172485352  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1281061172485352  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1282281875610352  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1462945938110352  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([38, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1470375061035156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1470375061035156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1471099853515625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1583442687988281  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([51, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.159435749053955  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.159435749053955  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1595330238342285  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1752915382385254  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([27, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1758661270141602  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1758661270141602  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.175917625427246  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1846208572387695  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([515, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.196969985961914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.196969985961914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 515, 256]), torch.Size([1, 515, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1979522705078125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3708343505859375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 515, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3325152397155762  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3333377838134766  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.334160327911377  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.333296298980713  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([5517, 40])
input nodes number: 12245
output nodes number: 5517
edges number: 44940
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3334064483642578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.333406925201416  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.026501178741455078  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

pseudo mini batch 4 input nodes size: 26773
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.023804664611816406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.023804664611816406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.03657102584838867  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.03661489486694336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.024736881256103516  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.025653362274169922  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.025653362274169922  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.025653362274169922  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([26773, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.025653362274169922  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([1261, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.0648045539855957  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.0648045539855957  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1261, 128]), torch.Size([1, 1261, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.06600713729858398  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.0760812759399414  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1261, 128])
m.shape torch.Size([1375, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.07706308364868164  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.07706308364868164  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1375, 128]), torch.Size([1, 1375, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.07837438583374023  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.09804391860961914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1375, 128])
m.shape torch.Size([1224, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.09913921356201172  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.09913921356201172  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1224, 128]), torch.Size([1, 1224, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.10030651092529297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1266164779663086  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1224, 128])
m.shape torch.Size([1091, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1281137466430664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1281137466430664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1091, 128]), torch.Size([1, 1091, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.12915420532226562  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.15932750701904297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1091, 128])
m.shape torch.Size([916, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.16194677352905273  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.16194677352905273  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 916, 128]), torch.Size([1, 916, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.16282033920288086  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1945204734802246  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 916, 128])
m.shape torch.Size([804, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.19638395309448242  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.19638395309448242  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 804, 128]), torch.Size([1, 804, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.19715070724487305  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.23036527633666992  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 804, 128])
m.shape torch.Size([689, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.23228168487548828  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.23228168487548828  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 689, 128]), torch.Size([1, 689, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2329387664794922  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.26659631729125977  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 689, 128])
m.shape torch.Size([639, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2687053680419922  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2687053680419922  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 639, 128]), torch.Size([1, 639, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2693147659301758  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.30428504943847656  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 639, 128])
m.shape torch.Size([526, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.30623769760131836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.30623769760131836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 526, 128]), torch.Size([1, 526, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.30673933029174805  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3391690254211426  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 526, 128])
m.shape torch.Size([4248, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3591742515563965  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3591742515563965  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 2124, 128]), torch.Size([1, 2124, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.36141538619995117  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5076708793640137  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 0 shape torch.Size([1, 2124, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5076708793640137  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5076708793640137  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 2124, 128]), torch.Size([1, 2124, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5096964836120605  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6542296409606934  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 1 shape torch.Size([1, 2124, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6212944984436035  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6334757804870605  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6456570625305176  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6333804130554199  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([12773, 256])
first layer input nodes number: 26773
first layer output nodes number: 12773
edges number: 78600
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6458587646484375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6580400466918945  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6613664627075195  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6613664627075195  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([837, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7057070732116699  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7057070732116699  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 837, 256]), torch.Size([1, 837, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.707303524017334  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7210392951965332  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 837, 256])
m.shape torch.Size([776, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7225666046142578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7225666046142578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 776, 256]), torch.Size([1, 776, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7240467071533203  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7462482452392578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 776, 256])
m.shape torch.Size([600, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7472386360168457  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7472386360168457  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 600, 256]), torch.Size([1, 600, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7483830451965332  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7735600471496582  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 600, 256])
m.shape torch.Size([527, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7751703262329102  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7751703262329102  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 527, 256]), torch.Size([1, 527, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7761754989624023  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8056497573852539  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 527, 256])
m.shape torch.Size([421, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8071703910827637  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8071703910827637  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 421, 256]), torch.Size([1, 421, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8079733848571777  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8373799324035645  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 421, 256])
m.shape torch.Size([331, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8388876914978027  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8388876914978027  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 331, 256]), torch.Size([1, 331, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8395190238952637  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.867917537689209  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 331, 256])
m.shape torch.Size([289, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8695464134216309  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8695464134216309  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8700976371765137  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8984789848327637  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 289, 256])
m.shape torch.Size([256, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9001717567443848  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9001717567443848  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9006600379943848  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9284920692443848  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([207, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9300389289855957  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9300389289855957  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9304337501525879  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9557023048400879  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([178, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9572157859802246  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9572157859802246  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9575552940368652  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9816603660583496  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([140, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.98297119140625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.98297119140625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9832382202148438  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0040664672851562  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([130, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0054326057434082  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0054326057434082  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0056805610656738  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.026756763458252  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([118, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0281071662902832  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0281071662902832  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.028332233428955  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0490384101867676  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([109, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0509047508239746  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0509047508239746  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0511126518249512  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0716948509216309  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([93, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0729317665100098  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0729317665100098  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0731091499328613  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.091911792755127  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([65, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.092844009399414  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.092844009399414  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0929679870605469  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1069774627685547  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([61, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.107912540435791  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.107912540435791  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1080288887023926  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.12199068069458  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([65, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1230573654174805  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1230573654174805  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1231813430786133  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1389265060424805  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([59, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1399421691894531  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1399421691894531  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.140054702758789  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1551342010498047  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([47, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1559815406799316  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1559815406799316  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1560711860656738  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1687111854553223  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([46, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1695952415466309  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1695952415466309  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1696829795837402  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1826682090759277  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([41, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1834917068481445  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1834917068481445  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1835699081420898  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1956911087036133  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([42, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1965808868408203  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1965808868408203  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1966609954833984  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2096385955810547  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.210336685180664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.210336685180664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.210397720336914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.220712661743164  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([384, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2299089431762695  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2299089431762695  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 384, 256]), torch.Size([1, 384, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2306413650512695  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3620014190673828  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 384, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3241219520568848  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3249945640563965  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3258671760559082  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3249506950378418  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([5854, 40])
input nodes number: 12773
output nodes number: 5854
edges number: 44167
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3251399993896484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3251404762268066  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.027501583099365234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

pseudo mini batch 5 input nodes size: 33124
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.024786949157714844  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.024786949157714844  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.040581703186035156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.040625572204589844  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.02781534194946289  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.028923511505126953  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.028923511505126953  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.028923511505126953  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([33124, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.028923511505126953  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([1072, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.07758235931396484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.07758235931396484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1072, 128]), torch.Size([1, 1072, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.07860469818115234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.08678340911865234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1072, 128])
m.shape torch.Size([1165, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.08796405792236328  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.08796405792236328  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1165, 128]), torch.Size([1, 1165, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.08907508850097656  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1067037582397461  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1165, 128])
m.shape torch.Size([1131, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.10776615142822266  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.10776615142822266  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1131, 128]), torch.Size([1, 1131, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.10884475708007812  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.13350677490234375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1131, 128])
m.shape torch.Size([1007, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1348881721496582  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1348881721496582  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1007, 128]), torch.Size([1, 1007, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1358485221862793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.16395807266235352  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1007, 128])
m.shape torch.Size([963, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.16577386856079102  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.16577386856079102  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 963, 128]), torch.Size([1, 963, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.16669225692749023  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.20098876953125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 963, 128])
m.shape torch.Size([800, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2028183937072754  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2028183937072754  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 800, 128]), torch.Size([1, 800, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2035813331604004  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.23726129531860352  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 800, 128])
m.shape torch.Size([744, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2393631935119629  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2393631935119629  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 744, 128]), torch.Size([1, 744, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.24007272720336914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.27556848526000977  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 744, 128])
m.shape torch.Size([678, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2778000831604004  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2778000831604004  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 678, 128]), torch.Size([1, 678, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.27844667434692383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3154778480529785  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 678, 128])
m.shape torch.Size([581, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.31764793395996094  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.31764793395996094  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 581, 128]), torch.Size([1, 581, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.31820201873779297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.35468482971191406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 581, 128])
m.shape torch.Size([6180, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.38387632369995117  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.38387632369995117  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 3090, 128]), torch.Size([1, 3090, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3868231773376465  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5997138023376465  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 0 shape torch.Size([1, 3090, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5997138023376465  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5997138023376465  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 3090, 128]), torch.Size([1, 3090, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6030373573303223  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8145575523376465  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 1 shape torch.Size([1, 3090, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.772763729095459  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7864212989807129  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8000788688659668  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7863144874572754  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([14321, 256])
first layer input nodes number: 33124
first layer output nodes number: 14321
edges number: 98099
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8003277778625488  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8139853477478027  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8173999786376953  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8173999786376953  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([695, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8675079345703125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8675079345703125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 695, 256]), torch.Size([1, 695, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8688335418701172  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8800296783447266  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 695, 256])
m.shape torch.Size([662, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8807592391967773  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8807592391967773  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 662, 256]), torch.Size([1, 662, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8820219039916992  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9033050537109375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 662, 256])
m.shape torch.Size([549, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9042568206787109  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9042568206787109  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 549, 256]), torch.Size([1, 549, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.905303955078125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9284777641296387  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 549, 256])
m.shape torch.Size([464, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9297380447387695  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9297380447387695  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 464, 256]), torch.Size([1, 464, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9306230545043945  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9562883377075195  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 464, 256])
m.shape torch.Size([402, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9577779769897461  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9577779769897461  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 402, 256]), torch.Size([1, 402, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9585447311401367  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9861478805541992  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 402, 256])
m.shape torch.Size([334, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9876909255981445  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9876909255981445  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 334, 256]), torch.Size([1, 334, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9883279800415039  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0162100791931152  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 334, 256])
m.shape torch.Size([297, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0178899765014648  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0178899765014648  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0184564590454102  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0471887588500977  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([260, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0489048957824707  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0489048957824707  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 260, 256]), torch.Size([1, 260, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.049400806427002  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0780463218688965  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 260, 256])
m.shape torch.Size([226, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0797533988952637  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0797533988952637  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0801844596862793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1077723503112793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([217, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.109642505645752  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.109642505645752  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1100564002990723  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1394429206848145  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([139, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1407055854797363  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1407055854797363  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1409707069396973  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1616501808166504  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([154, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1632938385009766  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1632938385009766  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1635875701904297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1885547637939453  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([128, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.190007209777832  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.190007209777832  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.190251350402832  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.212712287902832  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([127, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2143917083740234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2143917083740234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2146339416503906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2386150360107422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([114, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2401375770568848  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2401375770568848  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2403550148010254  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2634034156799316  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([89, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2646636962890625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2646636962890625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2648334503173828  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2840156555175781  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([91, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2854180335998535  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2854180335998535  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2855916023254395  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.306419849395752  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([63, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3074231147766113  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3074231147766113  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3075432777404785  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3228039741516113  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([56, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3237667083740234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3237667083740234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.323873519897461  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.338186264038086  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([64, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3393630981445312  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3393630981445312  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3394851684570312  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3566970825195312  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([49, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3576292991638184  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3576292991638184  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3577227592468262  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3715548515319824  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([51, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.372586727142334  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.372586727142334  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3726840019226074  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3877615928649902  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([34, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3884649276733398  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3884649276733398  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3885297775268555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3990354537963867  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([36, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3998336791992188  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3998336791992188  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.39990234375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4115066528320312  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([553, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.424760341644287  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.424760341644287  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 553, 256]), torch.Size([1, 553, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4258151054382324  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6154227256774902  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 553, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5715246200561523  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.572397232055664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5732698440551758  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5723533630371094  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([5854, 40])
input nodes number: 14321
output nodes number: 5854
edges number: 50499
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5725040435791016  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5725045204162598  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.031041622161865234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

pseudo mini batch 6 input nodes size: 21497
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.02781534194946289  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.02781534194946289  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.03806591033935547  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.038109779357910156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.022271156311035156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.02296733856201172  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.02296733856201172  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.02296733856201172  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([21497, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.02296733856201172  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([1484, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.05301189422607422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.05301189422607422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1484, 128]), torch.Size([1, 1484, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.054427146911621094  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.06590557098388672  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1484, 128])
m.shape torch.Size([1565, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.06669044494628906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.06669044494628906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1565, 128]), torch.Size([1, 1565, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.06818294525146484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.09057044982910156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1565, 128])
m.shape torch.Size([1375, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.09258794784545898  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.09258794784545898  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1375, 128]), torch.Size([1, 1375, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.09389925003051758  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1233067512512207  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1375, 128])
m.shape torch.Size([1084, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.12471866607666016  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.12471866607666016  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1084, 128]), torch.Size([1, 1084, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.12575244903564453  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1557321548461914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1084, 128])
m.shape torch.Size([975, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.15753984451293945  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.15753984451293945  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 975, 128]), torch.Size([1, 975, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.15846967697143555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.19269132614135742  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 975, 128])
m.shape torch.Size([770, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1944293975830078  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1944293975830078  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 770, 128]), torch.Size([1, 770, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.19516372680664062  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.22717857360839844  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 770, 128])
m.shape torch.Size([644, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.22896099090576172  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.22896099090576172  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 644, 128]), torch.Size([1, 644, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.22957515716552734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2613410949707031  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 644, 128])
m.shape torch.Size([510, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.26297950744628906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.26297950744628906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 510, 128]), torch.Size([1, 510, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.26346588134765625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.29118919372558594  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 510, 128])
m.shape torch.Size([420, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.29274845123291016  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.29274845123291016  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 420, 128]), torch.Size([1, 420, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2931489944458008  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3187837600708008  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 420, 128])
m.shape torch.Size([2475, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3303852081298828  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3303852081298828  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1237, 128]), torch.Size([1, 1237, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.33156490325927734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.41794300079345703  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 0 shape torch.Size([1, 1237, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.41794300079345703  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.41794300079345703  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1238, 128]), torch.Size([1, 1238, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.41912364959716797  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5042843818664551  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 1 shape torch.Size([1, 1238, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.48040294647216797  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.4911813735961914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5019598007202148  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.49109697341918945  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([11302, 256])
first layer input nodes number: 21497
first layer output nodes number: 11302
edges number: 59688
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5021219253540039  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5129003524780273  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5159025192260742  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5159025192260742  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([1056, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5495820045471191  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5495820045471191  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1056, 256]), torch.Size([1, 1056, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5520062446594238  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5684733390808105  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1056, 256])
m.shape torch.Size([934, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5694766044616699  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5694766044616699  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 934, 256]), torch.Size([1, 934, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5712580680847168  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5979800224304199  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 934, 256])
m.shape torch.Size([716, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.599153995513916  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.599153995513916  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 716, 256]), torch.Size([1, 716, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6005196571350098  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6308274269104004  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 716, 256])
m.shape torch.Size([538, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6322131156921387  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6322131156921387  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 538, 256]), torch.Size([1, 538, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6332392692565918  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6633944511413574  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 538, 256])
m.shape torch.Size([502, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6652941703796387  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6652941703796387  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 502, 256]), torch.Size([1, 502, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6662516593933105  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.700721263885498  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 502, 256])
m.shape torch.Size([373, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7023935317993164  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7023935317993164  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 373, 256]), torch.Size([1, 373, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7031049728393555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7344999313354492  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 373, 256])
m.shape torch.Size([310, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7362298965454102  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7362298965454102  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 310, 256]), torch.Size([1, 310, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.736821174621582  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7674579620361328  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 310, 256])
m.shape torch.Size([241, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7690157890319824  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7690157890319824  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7694754600524902  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7956767082214355  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([185, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7970476150512695  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7970476150512695  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7974004745483398  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8199834823608398  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([145, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8212008476257324  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8212008476257324  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8214774131774902  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8411135673522949  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([106, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8421306610107422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8421306610107422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8423328399658203  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8581027984619141  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([110, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8592705726623535  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8592705726623535  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8594803810119629  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8773140907287598  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([75, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8781466484069824  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8781466484069824  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8782896995544434  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8914504051208496  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([76, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.892420768737793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.892420768737793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8925657272338867  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.906916618347168  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([65, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9077816009521484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9077816009521484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9079055786132812  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9210472106933594  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([56, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9218463897705078  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9218463897705078  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9219532012939453  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9340229034423828  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([46, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9347214698791504  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9347214698791504  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9348092079162598  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9453377723693848  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([48, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9461245536804199  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9461245536804199  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9462161064147949  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9578433036804199  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.958254337310791  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.958254337310791  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9583020210266113  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9646916389465332  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([20, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.965052604675293  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.965052604675293  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9650907516479492  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9704694747924805  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9708137512207031  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9708137512207031  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9708480834960938  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9759292602539062  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9762296676635742  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9762296676635742  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9762582778930664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9806928634643555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9809885025024414  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9809885025024414  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9810152053833008  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9853410720825195  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9857892990112305  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9857892990112305  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9858274459838867  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.992274284362793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([159, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9960761070251465  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9960761070251465  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9963793754577637  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0497546195983887  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 159, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0230259895324707  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0238986015319824  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0247712135314941  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0238547325134277  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([5853, 40])
input nodes number: 11302
output nodes number: 5853
edges number: 33587
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0239830017089844  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0239834785461426  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.02439403533935547  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

pseudo mini batch 7 input nodes size: 20943
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.022271156311035156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.022271156311035156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.0322575569152832  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.03230142593383789  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.022006988525390625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.022812843322753906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.022812843322753906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.022812843322753906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([20943, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.022812843322753906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([1260, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.056550025939941406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.056550025939941406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1260, 128]), torch.Size([1, 1260, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.05775165557861328  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.06747150421142578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1260, 128])
m.shape torch.Size([1290, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.0686030387878418  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.0686030387878418  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1290, 128]), torch.Size([1, 1290, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.06983327865600586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.0882868766784668  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1290, 128])
m.shape torch.Size([1198, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.08960580825805664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.08960580825805664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1198, 128]), torch.Size([1, 1198, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.09074831008911133  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.11588335037231445  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1198, 128])
m.shape torch.Size([1078, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.11755895614624023  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.11755895614624023  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1078, 128]), torch.Size([1, 1078, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.11858701705932617  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.14894628524780273  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1078, 128])
m.shape torch.Size([920, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.15062570571899414  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.15062570571899414  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 920, 128]), torch.Size([1, 920, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1515030860900879  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1842331886291504  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 920, 128])
m.shape torch.Size([749, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.18593740463256836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.18593740463256836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 749, 128]), torch.Size([1, 749, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.18665170669555664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.21814966201782227  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 749, 128])
m.shape torch.Size([642, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.21993541717529297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.21993541717529297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 642, 128]), torch.Size([1, 642, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.22054767608642578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.25116825103759766  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 642, 128])
m.shape torch.Size([539, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2529182434082031  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2529182434082031  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 539, 128]), torch.Size([1, 539, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2534322738647461  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.28373050689697266  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 539, 128])
m.shape torch.Size([486, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.28555917739868164  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.28555917739868164  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 486, 128]), torch.Size([1, 486, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2860226631164551  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3156857490539551  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 486, 128])
m.shape torch.Size([3350, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.33142805099487305  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.33142805099487305  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1675, 128]), torch.Size([1, 1675, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3330254554748535  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.44891786575317383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 0 shape torch.Size([1, 1675, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.44891786575317383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.44891786575317383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1675, 128]), torch.Size([1, 1675, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.4505152702331543  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5649442672729492  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 1 shape torch.Size([1, 1675, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5372166633605957  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5481953620910645  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5591740608215332  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5481095314025879  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([11512, 256])
first layer input nodes number: 20943
first layer output nodes number: 11512
edges number: 67520
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5593323707580566  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5703110694885254  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5733742713928223  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5733742713928223  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([843, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6137866973876953  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6137866973876953  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 843, 256]), torch.Size([1, 843, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6153945922851562  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6282577514648438  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 843, 256])
m.shape torch.Size([780, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6290631294250488  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6290631294250488  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 780, 256]), torch.Size([1, 780, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6305508613586426  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6528668403625488  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 780, 256])
m.shape torch.Size([656, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6542587280273438  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6542587280273438  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 656, 256]), torch.Size([1, 656, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6555099487304688  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6835947036743164  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 656, 256])
m.shape torch.Size([557, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6851105690002441  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6851105690002441  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 557, 256]), torch.Size([1, 557, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6861729621887207  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7173905372619629  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 557, 256])
m.shape torch.Size([450, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.719022274017334  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.719022274017334  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 450, 256]), torch.Size([1, 450, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7198805809020996  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7509989738464355  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 450, 256])
m.shape torch.Size([349, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7525825500488281  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7525825500488281  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 349, 256]), torch.Size([1, 349, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7532482147216797  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7828350067138672  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 349, 256])
m.shape torch.Size([326, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7846956253051758  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7846956253051758  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 326, 256]), torch.Size([1, 326, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7853174209594727  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8174200057983398  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 326, 256])
m.shape torch.Size([250, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8190317153930664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8190317153930664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8195085525512695  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8466882705688477  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([212, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8482837677001953  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8482837677001953  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8486881256103516  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8745670318603516  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([192, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8762102127075195  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8762102127075195  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8765764236450195  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9025774002075195  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([166, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9041495323181152  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9041495323181152  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9044661521911621  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9291625022888184  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([122, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9304113388061523  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9304113388061523  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9306440353393555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9504232406616211  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([125, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.951869010925293  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.951869010925293  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9521074295043945  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9740419387817383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([92, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.975161075592041  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.975161075592041  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9753365516662598  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.992708683013916  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([85, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9944701194763184  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9944701194763184  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9946322441101074  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.011817455291748  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([77, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.01292085647583  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.01292085647583  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0130677223205566  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0296635627746582  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([45, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0303254127502441  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0303254127502441  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0304112434387207  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0407109260559082  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([46, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.041463851928711  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.041463851928711  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0415515899658203  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.052694320678711  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([49, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0535454750061035  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0535454750061035  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0536389350891113  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0661625862121582  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([43, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0669426918029785  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0669426918029785  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0670247077941895  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0785889625549316  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0790929794311523  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0790929794311523  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0791444778442383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.086766242980957  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([35, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0874810218811035  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0874810218811035  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.087547779083252  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0978951454162598  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0984368324279785  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0984368324279785  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0984864234924316  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.106520175933838  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1070489883422852  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1070489883422852  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1070947647094727  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1148309707641602  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([276, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1214399337768555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1214399337768555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1219663619995117  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2165517807006836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 276, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.182680606842041  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1835532188415527  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1844258308410645  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.183509349822998  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([5853, 40])
input nodes number: 11512
output nodes number: 5853
edges number: 40558
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1836390495300293  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1836395263671875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.024400711059570312  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

pseudo mini batch 8 input nodes size: 44133
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.022006988525390625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.022006988525390625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.043491363525390625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.0435328483581543  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.03350257873535156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.03482246398925781  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.03482246398925781  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.03482246398925781  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([44133, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.03482246398925781  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([1458, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.10249042510986328  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.10249042510986328  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1458, 128]), torch.Size([1, 1458, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1038808822631836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.11564922332763672  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1458, 128])
m.shape torch.Size([1460, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.11634635925292969  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.11634635925292969  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1460, 128]), torch.Size([1, 1460, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.11773872375488281  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1386241912841797  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1460, 128])
m.shape torch.Size([1283, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.13990020751953125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.13990020751953125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1283, 128]), torch.Size([1, 1283, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.14112377166748047  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1689596176147461  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1283, 128])
m.shape torch.Size([1153, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1705470085144043  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1705470085144043  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1153, 128]), torch.Size([1, 1153, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1716465950012207  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2037653923034668  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1153, 128])
m.shape torch.Size([1073, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.20577383041381836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.20577383041381836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1073, 128]), torch.Size([1, 1073, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.20679712295532227  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.24365997314453125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1073, 128])
m.shape torch.Size([903, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.24573183059692383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.24573183059692383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 903, 128]), torch.Size([1, 903, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.24659299850463867  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2838311195373535  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 903, 128])
m.shape torch.Size([869, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2863011360168457  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2863011360168457  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 869, 128]), torch.Size([1, 869, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.28712987899780273  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3292999267578125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 869, 128])
m.shape torch.Size([801, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3319411277770996  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3319411277770996  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 801, 128]), torch.Size([1, 801, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.332705020904541  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.37627744674682617  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 801, 128])
m.shape torch.Size([693, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.37886953353881836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.37886953353881836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 693, 128]), torch.Size([1, 693, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3795304298400879  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.4226055145263672  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 693, 128])
m.shape torch.Size([9445, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.4673123359680176  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.4673123359680176  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 4722, 128]), torch.Size([1, 4722, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.4719119071960449  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7916426658630371  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 0 shape torch.Size([1, 4722, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7916426658630371  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7916426658630371  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 4723, 128]), torch.Size([1, 4723, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7961468696594238  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1136937141418457  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 1 shape torch.Size([1, 4723, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.054971694946289  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0732231140136719  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0914745330810547  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.073080062866211  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([19138, 256])
first layer input nodes number: 44133
first layer output nodes number: 19138
edges number: 136800
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0918054580688477  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1100568771362305  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1146197319030762  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1146197319030762  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([989, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1551575660705566  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1551575660705566  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 989, 256]), torch.Size([1, 989, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1570439338684082  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1735963821411133  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 989, 256])
m.shape torch.Size([797, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1745028495788574  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1745028495788574  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 797, 256]), torch.Size([1, 797, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.176023006439209  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1988301277160645  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 797, 256])
m.shape torch.Size([585, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1997570991516113  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1997570991516113  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 585, 256]), torch.Size([1, 585, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2008728981018066  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2260394096374512  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 585, 256])
m.shape torch.Size([440, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2271733283996582  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2271733283996582  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 440, 256]), torch.Size([1, 440, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2280125617980957  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2528843879699707  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 440, 256])
m.shape torch.Size([378, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2542815208435059  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2542815208435059  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 378, 256]), torch.Size([1, 378, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.255002498626709  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2819881439208984  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 378, 256])
m.shape torch.Size([300, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.283358097076416  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.283358097076416  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2839303016662598  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3133602142333984  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([250, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3147563934326172  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3147563934326172  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3152332305908203  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3390750885009766  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([205, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3404130935668945  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3404130935668945  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.340804100036621  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3630914688110352  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([166, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3644256591796875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3644256591796875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3647422790527344  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3850059509277344  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([160, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.386385440826416  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.386385440826416  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.386690616607666  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.408358097076416  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([135, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4097352027893066  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4097352027893066  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4099926948547363  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.430077075958252  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([91, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4314751625061035  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4314751625061035  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4316487312316895  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4464020729064941  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([72, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4472150802612305  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4472150802612305  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.447352409362793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.459986686706543  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([63, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4607658386230469  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4607658386230469  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.460886001586914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4727821350097656  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([56, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4735298156738281  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4735298156738281  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4736366271972656  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4849586486816406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([59, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4858126640319824  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4858126640319824  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4859251976013184  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4986414909362793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([56, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4995002746582031  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4995002746582031  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4996070861816406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5124244689941406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([42, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5130977630615234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5130977630615234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5131778717041016  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5233516693115234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([46, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5241518020629883  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5241518020629883  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5242395401000977  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.535996437072754  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([41, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.536740779876709  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.536740779876709  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5368189811706543  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5478453636169434  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.548553466796875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.548553466796875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.548624038696289  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5590686798095703  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([29, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5596466064453125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5596466064453125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.559701919555664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5682754516601562  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5687341690063477  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5687341690063477  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5687761306762695  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5755739212036133  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([30, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5762453079223633  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5762453079223633  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5763025283813477  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.585972785949707  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([468, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5971894264221191  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5971894264221191  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 468, 256]), torch.Size([1, 468, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5980820655822754  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7552475929260254  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 468, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7208800315856934  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7217025756835938  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7225251197814941  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.72166109085083  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([5517, 40])
input nodes number: 19138
output nodes number: 5517
edges number: 40194
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7217955589294434  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7217960357666016  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.03721332550048828  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

pseudo mini batch 9 input nodes size: 55216
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.033452510833740234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.033452510833740234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.059781551361083984  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.059823036193847656  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.038297176361083984  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.03994894027709961  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.03994894027709961  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.03994894027709961  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([55216, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.03994894027709961  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([1491, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.126434326171875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.126434326171875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1491, 128]), torch.Size([1, 1491, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.12785625457763672  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.13923168182373047  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1491, 128])
m.shape torch.Size([1522, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.14076948165893555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.14076948165893555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1522, 128]), torch.Size([1, 1522, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.14222097396850586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.16410017013549805  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1522, 128])
m.shape torch.Size([1290, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.16521978378295898  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.16521978378295898  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1290, 128]), torch.Size([1, 1290, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.16645002365112305  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.19351530075073242  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1290, 128])
m.shape torch.Size([1183, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.19516372680664062  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.19516372680664062  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1183, 128]), torch.Size([1, 1183, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.19629192352294922  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2291431427001953  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1183, 128])
m.shape torch.Size([1141, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.23129940032958984  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.23129940032958984  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1141, 128]), torch.Size([1, 1141, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.23238754272460938  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.27195167541503906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1141, 128])
m.shape torch.Size([926, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.27405691146850586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.27405691146850586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 926, 128]), torch.Size([1, 926, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.27494001388549805  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3136014938354492  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 926, 128])
m.shape torch.Size([856, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.31601715087890625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.31601715087890625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 856, 128]), torch.Size([1, 856, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.31683349609375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3576507568359375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 856, 128])
m.shape torch.Size([825, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.36038970947265625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.36038970947265625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 825, 128]), torch.Size([1, 825, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3611764907836914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.4070577621459961  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 825, 128])
m.shape torch.Size([773, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.40998172760009766  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.40998172760009766  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 773, 128]), torch.Size([1, 773, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.4107189178466797  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.459256649017334  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 773, 128])
m.shape torch.Size([13137, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5215301513671875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5215301513671875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 6568, 128]), torch.Size([1, 6568, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5277938842773438  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9806594848632812  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 0 shape torch.Size([1, 6568, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9806594848632812  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9806594848632812  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 6569, 128]), torch.Size([1, 6569, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9876632690429688  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4374332427978516  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 1 shape torch.Size([1, 6569, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3603639602661133  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3824357986450195  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4045076370239258  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.38226318359375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([23144, 256])
first layer input nodes number: 55216
first layer output nodes number: 23144
edges number: 175317
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.404921054840088  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4269928932189941  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4325108528137207  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4325108528137207  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([955, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4789190292358398  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4789190292358398  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 955, 256]), torch.Size([1, 955, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4807405471801758  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4953126907348633  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 955, 256])
m.shape torch.Size([788, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4959168434143066  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4959168434143066  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 788, 256]), torch.Size([1, 788, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.497419834136963  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5210232734680176  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 788, 256])
m.shape torch.Size([551, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5220999717712402  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5220999717712402  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 551, 256]), torch.Size([1, 551, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.52315092086792  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5476641654968262  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 551, 256])
m.shape torch.Size([433, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5490460395812988  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5490460395812988  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 433, 256]), torch.Size([1, 433, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5498719215393066  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5746121406555176  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 433, 256])
m.shape torch.Size([371, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5762615203857422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5762615203857422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 371, 256]), torch.Size([1, 371, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5769691467285156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.60260009765625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 371, 256])
m.shape torch.Size([248, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6036767959594727  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6036767959594727  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6041498184204102  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6244897842407227  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([182, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.625605583190918  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.625605583190918  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6259527206420898  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6433095932006836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([182, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6445355415344238  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6445355415344238  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6448826789855957  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6646695137023926  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([144, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.665848731994629  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.665848731994629  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.666123390197754  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.683701515197754  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([117, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6847195625305176  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6847195625305176  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6849427223205566  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.70078706741333  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([102, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7018322944641113  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7018322944641113  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7020268440246582  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7172017097473145  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([90, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7184553146362305  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7184553146362305  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7186269760131836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7332181930541992  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([71, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7340197563171387  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7340197563171387  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7341551780700684  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7466139793395996  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([74, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.747544288635254  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.747544288635254  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.747685432434082  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7616586685180664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([55, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7623810768127441  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7623810768127441  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7624859809875488  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7736058235168457  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([54, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7743840217590332  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7743840217590332  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.774487018585205  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.786125659942627  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([42, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7867608070373535  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7867608070373535  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7868409156799316  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7964539527893066  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([49, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7972617149353027  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7972617149353027  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7973551750183105  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8092246055603027  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([50, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8100910186767578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8100910186767578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8101863861083984  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8229656219482422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([45, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8237833976745605  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8237833976745605  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.823869228363037  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8359713554382324  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.836493968963623  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.836493968963623  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8365473747253418  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8444514274597168  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([33, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8451228141784668  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8451228141784668  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8451857566833496  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8549418449401855  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([24, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8554410934448242  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8554410934448242  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8554868698120117  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8629026412963867  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.863410472869873  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.863410472869873  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8634543418884277  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.87086820602417  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([806, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8902130126953125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8902130126953125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 806, 256]), torch.Size([1, 806, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8917503356933594  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.1742820739746094  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 806, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.1337337493896484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.134556293487549  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.135378837585449  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.134514808654785  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([5517, 40])
input nodes number: 23144
output nodes number: 5517
edges number: 46319
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.1347289085388184  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.1347293853759766  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.0429377555847168  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

pseudo mini batch 10 input nodes size: 33980
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.038297176361083984  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.038297176361083984  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.05450010299682617  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.054541587829589844  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.028171062469482422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.02911520004272461  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.02911520004272461  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.02911520004272461  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([33980, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.02911520004272461  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([1373, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.07398128509521484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.07398128509521484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1373, 128]), torch.Size([1, 1373, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.07529067993164062  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.08647537231445312  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1373, 128])
m.shape torch.Size([1484, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.08774900436401367  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.08774900436401367  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1484, 128]), torch.Size([1, 1484, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.08916425704956055  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.11160993576049805  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1484, 128])
m.shape torch.Size([1366, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.11285638809204102  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.11285638809204102  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1366, 128]), torch.Size([1, 1366, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.11415910720825195  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1434636116027832  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1366, 128])
m.shape torch.Size([1153, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.14501142501831055  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.14501142501831055  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1153, 128]), torch.Size([1, 1153, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.14611101150512695  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.17822980880737305  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1153, 128])
m.shape torch.Size([1048, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.18017864227294922  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.18017864227294922  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1048, 128]), torch.Size([1, 1048, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.18117809295654297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.21811580657958984  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1048, 128])
m.shape torch.Size([892, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2201681137084961  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2201681137084961  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 892, 128]), torch.Size([1, 892, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.22101879119873047  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2592296600341797  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 892, 128])
m.shape torch.Size([780, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.26140785217285156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.26140785217285156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 780, 128]), torch.Size([1, 780, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.26215171813964844  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2998390197753906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 780, 128])
m.shape torch.Size([695, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.30211830139160156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.30211830139160156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 695, 128]), torch.Size([1, 695, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3027811050415039  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3422107696533203  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 695, 128])
m.shape torch.Size([579, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3443641662597656  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3443641662597656  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 579, 128]), torch.Size([1, 579, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.34491634368896484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.381711483001709  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 579, 128])
m.shape torch.Size([5029, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.40541553497314453  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.40541553497314453  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 2514, 128]), torch.Size([1, 2514, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.40802478790283203  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.581974983215332  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 0 shape torch.Size([1, 2514, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.581974983215332  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.581974983215332  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 2515, 128]), torch.Size([1, 2515, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.584723949432373  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7565569877624512  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 1 shape torch.Size([1, 2515, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7186098098754883  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7323417663574219  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7460737228393555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7322344779968262  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([14399, 256])
first layer input nodes number: 33980
first layer output nodes number: 14399
edges number: 90164
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7463288307189941  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7600607872009277  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7634940147399902  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7634940147399902  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([960, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7996115684509277  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7996115684509277  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 960, 256]), torch.Size([1, 960, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8014426231384277  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8160910606384277  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 960, 256])
m.shape torch.Size([819, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8172249794006348  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8172249794006348  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 819, 256]), torch.Size([1, 819, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8187870979309082  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8428363800048828  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 819, 256])
m.shape torch.Size([659, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8442072868347168  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8442072868347168  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 659, 256]), torch.Size([1, 659, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8454642295837402  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8733811378479004  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 659, 256])
m.shape torch.Size([484, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8749046325683594  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8749046325683594  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 484, 256]), torch.Size([1, 484, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8758277893066406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9047994613647461  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 484, 256])
m.shape torch.Size([438, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9064431190490723  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9064431190490723  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 438, 256]), torch.Size([1, 438, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9072785377502441  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9375615119934082  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 438, 256])
m.shape torch.Size([323, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9390068054199219  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9390068054199219  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 323, 256]), torch.Size([1, 323, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9396228790283203  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9670515060424805  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 323, 256])
m.shape torch.Size([253, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9690380096435547  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9690380096435547  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9695205688476562  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9936485290527344  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([221, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9951066970825195  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9951066970825195  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9955282211303711  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0195550918579102  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([191, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0209965705871582  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0209965705871582  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0213608741760254  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0446763038635254  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([141, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0458498001098633  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0458498001098633  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0461187362670898  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0652132034301758  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([130, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.066453456878662  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.066453456878662  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0667014122009277  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0860419273376465  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([127, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0873827934265137  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0873827934265137  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0876250267028809  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1082148551940918  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([88, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1091933250427246  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1091933250427246  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.109361171722412  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.124803066253662  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([69, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.125648021697998  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.125648021697998  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.125779628753662  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1388087272644043  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([65, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1396803855895996  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1396803855895996  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1398043632507324  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1529459953308105  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([64, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1538681983947754  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1538681983947754  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1539902687072754  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1677842140197754  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([46, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1684751510620117  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1684751510620117  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.168562889099121  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.179091453552246  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([54, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1799821853637695  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1799821853637695  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1800851821899414  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1931657791137695  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([38, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1938085556030273  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1938085556030273  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1938810348510742  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2035932540893555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([34, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2042107582092285  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2042107582092285  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2042756080627441  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2134194374084473  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2138919830322266  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2138919830322266  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2139396667480469  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2209968566894531  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2214808464050293  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2214808464050293  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2215266227722168  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2286219596862793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.229151725769043  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.229151725769043  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2291994094848633  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.236924171447754  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.23740816116333  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.23740816116333  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.237450122833252  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2445416450500488  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([268, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.250960350036621  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.250960350036621  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2514715194702148  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3422317504882812  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 268, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.312467098236084  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3132967948913574  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3141264915466309  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3132553100585938  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([5568, 40])
input nodes number: 14399
output nodes number: 5568
edges number: 36382
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3134112358093262  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3134117126464844  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.030976295471191406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

pseudo mini batch 11 input nodes size: 28347
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.02817821502685547  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.02817821502685547  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.04185009002685547  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.041893959045410156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.025649547576904297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.026438236236572266  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.026438236236572266  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.026438236236572266  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([28347, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.026438236236572266  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([1445, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.061948299407958984  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.061948299407958984  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1445, 128]), torch.Size([1, 1445, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.06332635879516602  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.07488584518432617  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1445, 128])
m.shape torch.Size([1591, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.075714111328125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.075714111328125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1591, 128]), torch.Size([1, 1591, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.07723140716552734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.0999908447265625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1591, 128])
m.shape torch.Size([1377, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.10184717178344727  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.10184717178344727  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1377, 128]), torch.Size([1, 1377, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.10316038131713867  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1324477195739746  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1377, 128])
m.shape torch.Size([1203, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.13428401947021484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.13428401947021484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1203, 128]), torch.Size([1, 1203, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.13543128967285156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1687021255493164  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1203, 128])
m.shape torch.Size([987, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.17048168182373047  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.17048168182373047  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 987, 128]), torch.Size([1, 987, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.17142295837402344  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2058734893798828  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 987, 128])
m.shape torch.Size([766, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2075943946838379  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2075943946838379  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 766, 128]), torch.Size([1, 766, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.20832490921020508  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.24033117294311523  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 766, 128])
m.shape torch.Size([702, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2423090934753418  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2423090934753418  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 702, 128]), torch.Size([1, 702, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.24297857284545898  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.27738237380981445  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 702, 128])
m.shape torch.Size([606, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2793593406677246  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2793593406677246  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 606, 128]), torch.Size([1, 606, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2799372673034668  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.31340551376342773  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 606, 128])
m.shape torch.Size([521, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3153524398803711  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3153524398803711  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 521, 128]), torch.Size([1, 521, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.31584930419921875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.34890174865722656  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 521, 128])
m.shape torch.Size([3337, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.364565372467041  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.364565372467041  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1668, 128]), torch.Size([1, 1668, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.36615610122680664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.4813055992126465  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 0 shape torch.Size([1, 1668, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.4813055992126465  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.4813055992126465  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1669, 128]), torch.Size([1, 1669, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.4828972816467285  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5972685813903809  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 1 shape torch.Size([1, 1669, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5683917999267578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5803461074829102  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5923004150390625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5802526473999023  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([12535, 256])
first layer input nodes number: 28347
first layer output nodes number: 12535
edges number: 70922
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5925135612487793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6044678688049316  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6074566841125488  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6074566841125488  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([1018, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6427512168884277  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6427512168884277  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1018, 256]), torch.Size([1, 1018, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6446928977966309  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6609311103820801  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1018, 256])
m.shape torch.Size([939, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6617655754089355  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6617655754089355  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 939, 256]), torch.Size([1, 939, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6635565757751465  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6906447410583496  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 939, 256])
m.shape torch.Size([717, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6918168067932129  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6918168067932129  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 717, 256]), torch.Size([1, 717, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6931843757629395  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.723656177520752  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 717, 256])
m.shape torch.Size([559, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7251214981079102  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7251214981079102  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 559, 256]), torch.Size([1, 559, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7261877059936523  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7571077346801758  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 559, 256])
m.shape torch.Size([472, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.758842945098877  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.758842945098877  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 472, 256]), torch.Size([1, 472, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7597432136535645  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7933611869812012  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 472, 256])
m.shape torch.Size([328, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7948026657104492  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7948026657104492  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 328, 256]), torch.Size([1, 328, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7954282760620117  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8237919807434082  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 328, 256])
m.shape torch.Size([272, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8253092765808105  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8253092765808105  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8258280754089355  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.852147102355957  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([236, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8537025451660156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8537025451660156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8541526794433594  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8798103332519531  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([211, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8814105987548828  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8814105987548828  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8818130493164062  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9075698852539062  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([166, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9089641571044922  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9089641571044922  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9092807769775391  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9317607879638672  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([140, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9330830574035645  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9330830574035645  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9333500862121582  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9541783332824707  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([98, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9551753997802734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9551753997802734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9553623199462891  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9712505340576172  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([100, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9724068641662598  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9724068641662598  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.972597599029541  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.990145206451416  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([74, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9910459518432617  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9910459518432617  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9911870956420898  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0051603317260742  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([66, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0060415267944336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0060415267944336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0061674118041992  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0195112228393555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([54, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0202789306640625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0202789306640625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0203819274902344  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0320205688476562  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([51, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0328025817871094  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0328025817871094  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0328998565673828  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0445728302001953  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([36, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.04514741897583  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.04514741897583  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0452160835266113  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.05393648147583  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0545048713684082  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0545048713684082  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.054567813873291  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.063002109527588  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([32, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0635857582092285  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0635857582092285  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0636467933654785  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0722527503967285  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.072807788848877  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.072807788848877  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0728631019592285  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0810494422912598  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0813179016113281  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0813179016113281  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0813446044921875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0854835510253906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.085780143737793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.085780143737793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0858068466186523  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.090132713317871  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0905580520629883  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0905580520629883  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0905942916870117  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0967187881469727  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([176, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1009297370910645  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1009297370910645  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1012654304504395  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1603474617004395  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 176, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1318154335021973  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.132688045501709  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1335606575012207  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1326441764831543  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([5854, 40])
input nodes number: 12535
output nodes number: 5854
edges number: 34745
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.132824420928955  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1328248977661133  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.02808666229248047  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

pseudo mini batch 12 input nodes size: 51670
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.025692462921142578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.025692462921142578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.05108308792114258  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.051126956939697266  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.03741121292114258  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.03986215591430664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.03986215591430664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.03986215591430664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([51670, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.03986215591430664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([771, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1609334945678711  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1609334945678711  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 771, 128]), torch.Size([1, 771, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1616687774658203  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.16755104064941406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 771, 128])
m.shape torch.Size([864, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.16800737380981445  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.16800737380981445  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 864, 128]), torch.Size([1, 864, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.16883134841918945  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.18119096755981445  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 864, 128])
m.shape torch.Size([850, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.18199491500854492  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.18199491500854492  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 850, 128]), torch.Size([1, 850, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.18280553817749023  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.20165109634399414  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 850, 128])
m.shape torch.Size([843, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.20285367965698242  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.20285367965698242  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 843, 128]), torch.Size([1, 843, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2036576271057129  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.22742223739624023  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 843, 128])
m.shape torch.Size([820, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.22943687438964844  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.22943687438964844  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 820, 128]), torch.Size([1, 820, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.23021888732910156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.25837135314941406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 820, 128])
m.shape torch.Size([799, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2602663040161133  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2602663040161133  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 799, 128]), torch.Size([1, 799, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2610282897949219  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.29511070251464844  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 799, 128])
m.shape torch.Size([803, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2974100112915039  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2974100112915039  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 803, 128]), torch.Size([1, 803, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2981758117675781  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.33750486373901367  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 803, 128])
m.shape torch.Size([783, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.34010887145996094  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.34010887145996094  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 783, 128]), torch.Size([1, 783, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.34085559844970703  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.38353538513183594  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 783, 128])
m.shape torch.Size([804, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3866124153137207  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3866124153137207  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 804, 128]), torch.Size([1, 804, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.38737916946411133  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.43645143508911133  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 804, 128])
m.shape torch.Size([21060, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5364899635314941  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5364899635314941  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 10530, 128]), torch.Size([1, 10530, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5465579032897949  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.259838581085205  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 0 shape torch.Size([1, 10530, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.259838581085205  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.259838581085205  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 10530, 128]), torch.Size([1, 10530, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.269880771636963  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9795660972595215  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 1 shape torch.Size([1, 10530, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8697519302368164  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8968334197998047  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.923914909362793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8966217041015625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([28397, 256])
first layer input nodes number: 51670
first layer output nodes number: 28397
edges number: 247036
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.924302101135254  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9513835906982422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9581542015075684  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9581542015075684  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([479, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.037567138671875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.037567138671875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 479, 256]), torch.Size([1, 479, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.038480758666992  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0469584465026855  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 479, 256])
m.shape torch.Size([386, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.047244071960449  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.047244071960449  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 386, 256]), torch.Size([1, 386, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.047980308532715  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.059661865234375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 386, 256])
m.shape torch.Size([348, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0603528022766113  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0603528022766113  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 348, 256]), torch.Size([1, 348, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.06101655960083  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0761265754699707  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 348, 256])
m.shape torch.Size([284, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0769095420837402  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0769095420837402  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.077451229095459  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.096066951751709  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 284, 256])
m.shape torch.Size([236, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.09720516204834  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.09720516204834  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0976552963256836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.1138601303100586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([200, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.115044116973877  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.115044116973877  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.1154255867004395  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.131828784942627  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([171, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.133047103881836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.133047103881836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.133373260498047  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.1496810913085938  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([153, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.1509275436401367  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.1509275436401367  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.151219367980957  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.167853355407715  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([150, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.169118881225586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.169118881225586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.169404983520508  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.187715530395508  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([147, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.1889853477478027  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.1889853477478027  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.189265727996826  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2091727256774902  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([148, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.210597515106201  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.210597515106201  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2108798027038574  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.232898235321045  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([146, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2345709800720215  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2345709800720215  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.234849452972412  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2585196495056152  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([120, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2598800659179688  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2598800659179688  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2601089477539062  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2811660766601562  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([100, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2824602127075195  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2824602127075195  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.282650947570801  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3015336990356445  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([108, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3036012649536133  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3036012649536133  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.303807258605957  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3256425857543945  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([96, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3270158767700195  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3270158767700195  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3271989822387695  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3478899002075195  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([94, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3499836921691895  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3499836921691895  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.350162982940674  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.371677875518799  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([97, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3732666969299316  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3732666969299316  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3734517097473145  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3969483375549316  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([90, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3988418579101562  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3988418579101562  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3990135192871094  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.422016143798828  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([95, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.4237565994262695  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.4237565994262695  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.4239377975463867  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.44948673248291  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([89, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.452066421508789  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.452066421508789  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.4522361755371094  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.4773597717285156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([65, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.478649616241455  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.478649616241455  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.478773593902588  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.497990131378174  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([66, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.499387264251709  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.499387264251709  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.4995131492614746  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.519906520843506  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([71, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.521512985229492  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.521512985229492  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.521648406982422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.544534683227539  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([1915, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.5904812812805176  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.5904812812805176  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1915, 256]), torch.Size([1, 1915, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.594949245452881  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 3.240248203277588  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1915, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 3.1664280891418457  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 3.1673007011413574  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 3.168173313140869  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 3.1672568321228027  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([5854, 40])
input nodes number: 28397
output nodes number: 5854
edges number: 81898
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 3.1675124168395996  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 3.167512893676758  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.04400968551635742  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

pseudo mini batch 13 input nodes size: 53096
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.03741121292114258  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.03741121292114258  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.06280183792114258  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.06284332275390625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.03740882873535156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.039374351501464844  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.039374351501464844  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.039374351501464844  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([53096, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.039374351501464844  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([1106, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.14099740982055664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.14099740982055664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1106, 128]), torch.Size([1, 1106, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.14205217361450195  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.15102529525756836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1106, 128])
m.shape torch.Size([1153, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1515974998474121  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1515974998474121  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1153, 128]), torch.Size([1, 1153, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.15269708633422852  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1691908836364746  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1153, 128])
m.shape torch.Size([1039, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.17046356201171875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.17046356201171875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1039, 128]), torch.Size([1, 1039, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.17145442962646484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1932535171508789  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1039, 128])
m.shape torch.Size([956, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1945815086364746  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1945815086364746  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 956, 128]), torch.Size([1, 956, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.19549322128295898  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.22268247604370117  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 956, 128])
m.shape torch.Size([952, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.22508764266967773  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.22508764266967773  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 952, 128]), torch.Size([1, 952, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.22599554061889648  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2586798667907715  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 952, 128])
m.shape torch.Size([938, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2611403465270996  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2611403465270996  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 938, 128]), torch.Size([1, 938, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.26203489303588867  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3005213737487793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 938, 128])
m.shape torch.Size([830, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3028445243835449  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3028445243835449  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 830, 128]), torch.Size([1, 830, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3036360740661621  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.34447145462036133  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 830, 128])
m.shape torch.Size([800, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.34712743759155273  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.34712743759155273  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 800, 128]), torch.Size([1, 800, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.34789037704467773  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.39137792587280273  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 800, 128])
m.shape torch.Size([771, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3943052291870117  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3943052291870117  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 771, 128]), torch.Size([1, 771, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.39504051208496094  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.44251251220703125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 771, 128])
m.shape torch.Size([16690, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5222229957580566  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5222229957580566  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 8345, 128]), torch.Size([1, 8345, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5301814079284668  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.095228672027588  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 0 shape torch.Size([1, 8345, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.095228672027588  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.095228672027588  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 8345, 128]), torch.Size([1, 8345, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.103187084197998  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.664255142211914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 1 shape torch.Size([1, 8345, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.573225498199463  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5972914695739746  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6213574409484863  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5971031188964844  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([25235, 256])
first layer input nodes number: 53096
first layer output nodes number: 25235
edges number: 206790
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6217551231384277  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6458210945129395  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6518378257751465  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6518378257751465  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([735, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7075023651123047  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7075023651123047  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 735, 256]), torch.Size([1, 735, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7089042663574219  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7225513458251953  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 735, 256])
m.shape torch.Size([619, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7230806350708008  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7230806350708008  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 619, 256]), torch.Size([1, 619, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7242612838745117  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7423591613769531  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 619, 256])
m.shape torch.Size([428, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7430319786071777  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7430319786071777  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 428, 256]), torch.Size([1, 428, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7438483238220215  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7635130882263184  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 428, 256])
m.shape torch.Size([361, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7645220756530762  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7645220756530762  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 361, 256]), torch.Size([1, 361, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7652106285095215  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7876181602478027  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 361, 256])
m.shape torch.Size([322, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.788874626159668  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.788874626159668  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 322, 256]), torch.Size([1, 322, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7894887924194336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8121089935302734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 322, 256])
m.shape torch.Size([256, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.814199447631836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.814199447631836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.814687728881836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.835683822631836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([207, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8368325233459473  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8368325233459473  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8372273445129395  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8569684028625488  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([171, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8590140342712402  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8590140342712402  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8593401908874512  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8779311180114746  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([162, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8791694641113281  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8791694641113281  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8794784545898438  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8992538452148438  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([144, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.901334285736084  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.901334285736084  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.901608943939209  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.921109676361084  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([117, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9222097396850586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9222097396850586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9224328994750977  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9398393630981445  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([126, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9421262741088867  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9421262741088867  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.942366600036621  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.962794303894043  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([110, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9640488624572754  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9640488624572754  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9642586708068848  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9835610389709473  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([92, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.984694480895996  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.984694480895996  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9848699569702148  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.002242088317871  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([78, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0033211708068848  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0033211708068848  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.003469944000244  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.019239902496338  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([76, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.020395278930664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.020395278930664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.020540237426758  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0369205474853516  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([73, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.038041114807129  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.038041114807129  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.038180351257324  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0548887252807617  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([74, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0560994148254395  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0560994148254395  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0562405586242676  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0741658210754395  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([76, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0754833221435547  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0754833221435547  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0756282806396484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.095052719116211  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([58, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.096147060394287  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.096147060394287  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0962576866149902  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.111855983734131  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([64, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.1140480041503906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.1140480041503906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.1141700744628906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.1322364807128906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([33, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.13287353515625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.13287353515625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.132936477661133  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.1426925659179688  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([47, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.143767833709717  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.143767833709717  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.143857479095459  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.1583800315856934  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([45, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.159501075744629  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.159501075744629  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.1595869064331055  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.1740922927856445  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([1043, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.199110984802246  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.199110984802246  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1043, 256]), torch.Size([1, 1043, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2012939453125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.562208652496338  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1043, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.511415481567383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.512238025665283  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.5130605697631836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.5121965408325195  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([5517, 40])
input nodes number: 25235
output nodes number: 5517
edges number: 56948
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.512376308441162  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.5123767852783203  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.04273796081542969  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

pseudo mini batch 14 input nodes size: 62664
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.037358760833740234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.037358760833740234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.06723928451538086  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.06728076934814453  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.04184865951538086  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.043485164642333984  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.043485164642333984  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.043485164642333984  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([62664, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.043485164642333984  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([1596, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1316976547241211  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1316976547241211  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1596, 128]), torch.Size([1, 1596, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.13321971893310547  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.14539623260498047  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1596, 128])
m.shape torch.Size([1687, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.14624404907226562  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.14624404907226562  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1687, 128]), torch.Size([1, 1687, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.14785289764404297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.17198562622070312  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1687, 128])
m.shape torch.Size([1527, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1737995147705078  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1737995147705078  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1527, 128]), torch.Size([1, 1527, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.17525577545166016  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.20736217498779297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1527, 128])
m.shape torch.Size([1305, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2091231346130371  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2091231346130371  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1305, 128]), torch.Size([1, 1305, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.21036767959594727  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.24784040451049805  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1305, 128])
m.shape torch.Size([1267, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.25023889541625977  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.25023889541625977  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1267, 128]), torch.Size([1, 1267, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2514472007751465  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2953948974609375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1267, 128])
m.shape torch.Size([1050, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.29833269119262695  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.29833269119262695  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1050, 128]), torch.Size([1, 1050, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2993340492248535  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.34284257888793945  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1050, 128])
m.shape torch.Size([955, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.34552955627441406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.34552955627441406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 955, 128]), torch.Size([1, 955, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.34644031524658203  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.39266252517700195  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 955, 128])
m.shape torch.Size([943, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.39580440521240234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.39580440521240234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 943, 128]), torch.Size([1, 943, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.39670372009277344  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.4479646682739258  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 943, 128])
m.shape torch.Size([818, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.45102548599243164  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.45102548599243164  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 818, 128]), torch.Size([1, 818, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.45180559158325195  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5033278465270996  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 818, 128])
m.shape torch.Size([12971, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5647883415222168  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5647883415222168  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 6485, 128]), torch.Size([1, 6485, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5709729194641113  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.010077953338623  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 0 shape torch.Size([1, 6485, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.010077953338623  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.010077953338623  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 6486, 128]), torch.Size([1, 6486, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.016263484954834  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4630670547485352  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 1 shape torch.Size([1, 6486, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.3848309516906738  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4082684516906738  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4312701225280762  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4076528549194336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([24119, 256])
first layer input nodes number: 62664
first layer output nodes number: 24119
edges number: 178707
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.431739330291748  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.4547410011291504  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.46049165725708  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.46049165725708  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([1010, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5009326934814453  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5009326934814453  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1010, 256]), torch.Size([1, 1010, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.502859115600586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5188775062561035  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1010, 256])
m.shape torch.Size([837, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5202960968017578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5202960968017578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 837, 256]), torch.Size([1, 837, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5218925476074219  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5481624603271484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 837, 256])
m.shape torch.Size([609, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.549767017364502  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.549767017364502  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 609, 256]), torch.Size([1, 609, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5509285926818848  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.578402042388916  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 609, 256])
m.shape torch.Size([454, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5795669555664062  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5795669555664062  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 454, 256]), torch.Size([1, 454, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.5804328918457031  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6060104370117188  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 454, 256])
m.shape torch.Size([346, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6075572967529297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6075572967529297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 346, 256]), torch.Size([1, 346, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6082172393798828  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6333370208740234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 346, 256])
m.shape torch.Size([257, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.634901523590088  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.634901523590088  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6353917121887207  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6577095985412598  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([223, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6589651107788086  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6589651107788086  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6593904495239258  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6806573867797852  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([204, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6820135116577148  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6820135116577148  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.6824026107788086  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7045812606811523  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([169, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7058486938476562  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7058486938476562  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7061710357666016  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7268009185791016  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([124, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7283353805541992  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7283353805541992  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.728571891784668  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7453641891479492  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([108, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7463879585266113  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7463879585266113  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.746593952178955  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7626614570617676  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([108, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7638044357299805  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7638044357299805  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7640104293823242  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.781519889831543  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([82, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7824416160583496  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7824416160583496  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7825980186462402  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7969870567321777  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([68, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7978239059448242  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7978239059448242  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7979536056518555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8107938766479492  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([63, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8116374015808105  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8116374015808105  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8117575645446777  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8244948387145996  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8250041007995605  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8250041007995605  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8250746726989746  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8330492973327637  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([39, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8336515426635742  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8336515426635742  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.833725929260254  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8426523208618164  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([41, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8433246612548828  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8433246612548828  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8434028625488281  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8533344268798828  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([44, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8540992736816406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8540992736816406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8541831970214844  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8654289245605469  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([40, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8661561012268066  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8661561012268066  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8662323951721191  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8769898414611816  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.877577781677246  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.877577781677246  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8776369094848633  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.886387825012207  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([35, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.887098789215088  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.887098789215088  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8871655464172363  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8975129127502441  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8979220390319824  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8979220390319824  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8979601860046387  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9041399955749512  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([28, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9047670364379883  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9047670364379883  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.904820442199707  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9138460159301758  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([546, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9269390106201172  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9269390106201172  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 546, 256]), torch.Size([1, 546, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9279804229736328  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.130099296569824  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 546, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0957837104797363  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.096606731414795  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0974297523498535  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0965652465820312  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([5523, 40])
input nodes number: 24119
output nodes number: 5523
edges number: 40832
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0967869758605957  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.096787452697754  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.046495914459228516  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

pseudo mini batch 15 input nodes size: 60593
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.04184913635253906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.04184913635253906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.07074213027954102  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.07078361511230469  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.04086160659790039  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.0430445671081543  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.0430445671081543  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.0430445671081543  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([60593, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.0430445671081543  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([1142, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.15757989883422852  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.15757989883422852  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1142, 128]), torch.Size([1, 1142, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.15866899490356445  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.16738176345825195  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1142, 128])
m.shape torch.Size([1190, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.16797208786010742  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.16797208786010742  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1190, 128]), torch.Size([1, 1190, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.16910696029663086  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.18673038482666016  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1190, 128])
m.shape torch.Size([1158, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1878194808959961  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1878194808959961  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1158, 128]), torch.Size([1, 1158, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.18892383575439453  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.21389484405517578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1158, 128])
m.shape torch.Size([1043, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.21533203125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.21533203125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1043, 128]), torch.Size([1, 1043, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.21632671356201172  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.24517250061035156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1043, 128])
m.shape torch.Size([1110, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.24732160568237305  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.24732160568237305  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1110, 128]), torch.Size([1, 1110, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.24838018417358398  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.28769731521606445  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1110, 128])
m.shape torch.Size([1001, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.29003190994262695  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.29003190994262695  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1001, 128]), torch.Size([1, 1001, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2909865379333496  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3330683708190918  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1001, 128])
m.shape torch.Size([945, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.33574533462524414  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.33574533462524414  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 945, 128]), torch.Size([1, 945, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.33664655685424805  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3823885917663574  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 945, 128])
m.shape torch.Size([892, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.38534069061279297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.38534069061279297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 892, 128]), torch.Size([1, 892, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.38619136810302734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.43634700775146484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 892, 128])
m.shape torch.Size([916, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.4398527145385742  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.4398527145385742  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 916, 128]), torch.Size([1, 916, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.44072628021240234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.4969606399536133  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 916, 128])
m.shape torch.Size([18847, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5863933563232422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5863933563232422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 9423, 128]), torch.Size([1, 9423, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5953798294067383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.233419418334961  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 0 shape torch.Size([1, 9423, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.233419418334961  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.233419418334961  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 9424, 128]), torch.Size([1, 9424, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2424068450927734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8769898414611816  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 1 shape torch.Size([1, 9424, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.7742376327514648  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.801173210144043  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.828108787536621  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8009624481201172  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([28244, 256])
first layer input nodes number: 60593
first layer output nodes number: 28244
edges number: 233189
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8285622596740723  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.8554978370666504  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.862231731414795  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.862231731414795  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([677, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9204678535461426  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9204678535461426  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 677, 256]), torch.Size([1, 677, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9217591285705566  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9348702430725098  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 677, 256])
m.shape torch.Size([576, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9354605674743652  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9354605674743652  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 576, 256]), torch.Size([1, 576, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9365592002868652  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9530940055847168  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 576, 256])
m.shape torch.Size([462, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9538955688476562  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9538955688476562  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 462, 256]), torch.Size([1, 462, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9547767639160156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9744606018066406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 462, 256])
m.shape torch.Size([350, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9755373001098633  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9755373001098633  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 350, 256]), torch.Size([1, 350, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9762048721313477  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9982194900512695  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 350, 256])
m.shape torch.Size([332, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9996452331542969  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.9996452331542969  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 332, 256]), torch.Size([1, 332, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0002784729003906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0262160301208496  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 332, 256])
m.shape torch.Size([262, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0274696350097656  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0274696350097656  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0279693603515625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0595169067382812  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([181, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0608348846435547  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0608348846435547  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0611801147460938  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.078441619873047  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([164, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0798373222351074  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0798373222351074  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0801501274108887  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.09798002243042  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([150, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0993924140930176  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0993924140930176  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.0996785163879395  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.1179890632629395  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([150, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.119415760040283  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.119415760040283  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.119701862335205  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.140015125274658  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([132, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.1414413452148438  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.1414413452148438  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.141693115234375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.1613311767578125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([111, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.162773609161377  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.162773609161377  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.162985324859619  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.180981159210205  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([105, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.1824440956115723  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.1824440956115723  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.1826443672180176  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2010693550109863  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([88, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2025370597839355  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2025370597839355  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.202704906463623  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2193217277526855  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([102, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2208075523376465  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2208075523376465  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2210021018981934  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.241624355316162  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([89, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.243096351623535  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.243096351623535  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2432661056518555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.262448310852051  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([70, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2641196250915527  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2641196250915527  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2642531394958496  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.2802748680114746  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([81, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.281966209411621  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.281966209411621  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.282120704650879  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.301741600036621  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([66, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3034210205078125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3034210205078125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.303546905517578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.320415496826172  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([58, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.322108745574951  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.322108745574951  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3222193717956543  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.337817668914795  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([72, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3395209312438965  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3395209312438965  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.339658260345459  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.359982967376709  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([44, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3608450889587402  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3608450889587402  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.360929012298584  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3739371299743652  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([41, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3748016357421875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3748016357421875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.374879837036133  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3875484466552734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([43, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3892645835876465  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3892645835876465  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.3893465995788574  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.403207302093506  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 43, 256])[04:46:30] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28957872 edges into 16 parts and get 7651530 edge cuts

m.shape torch.Size([1142, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.4306068420410156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.4306068420410156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1142, 256]), torch.Size([1, 1142, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.433443069458008  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.824186325073242  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1142, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.770444393157959  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.771271228790283  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.7720980644226074  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.7712297439575195  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([5548, 40])
input nodes number: 28244
output nodes number: 5548
edges number: 59678
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.7714858055114746  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 2.771486282348633  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.04682302474975586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.04682302474975586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.04682302474975586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010762035846710205 |0.003582864999771118 |0.11975497007369995 |9.131431579589844e-05 |0.07847312092781067 |0.0047168731689453125 |
----------------------------------------------------------pseudo_mini_loss sum 4.759324073791504
Total (block generation + training)time/epoch 25.141699075698853
* Pure training time/epoch 3.407345771789551
Training time/epoch 3.5001676082611084
Training time without block to device /epoch 3.4428417682647705
Training time without total dataloading part /epoch 3.1778273582458496
load block tensor time/epoch 0.17219257354736328
block to device time/epoch 0.05732583999633789
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  859162
Number of first layer input nodes during this epoch:  585976
Number of first layer output nodes during this epoch:  273186
----------------------------------------before generate dataloader block 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.046822547912597656  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.021604299545288086
global_2_local spend time (sec) 0.048270225524902344
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.003939390182495117
A = g.adjacency_matrix() spent  0.013928890228271484
auxiliary_graph
Graph(num_nodes=154614, num_edges=29048813,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08418726921081543
remove nodes length
63673
auxiliary_graph.remove_nodes spent  1.301170825958252
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29048813,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1499278545379639

the counter of shared neighbor distribution
Counter({1.0: 23402436, 2.0: 4027368, 3.0: 1011142, 4.0: 307344, 5.0: 112146, 6.0: 48448, 7.0: 22696, 8.0: 11506, 9.0: 6294, 10.0: 3494, 11.0: 1966, 12.0: 1128, 13.0: 656, 14.0: 434, 15.0: 300, 16.0: 212, 17.0: 164, 18.0: 68, 19.0: 54, 20.0: 10, 21.0: 6})
28957872
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28957869, 28957870, 28957871])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23402436, 2.0: 4027368, 3.0: 1011142, 4.0: 307344, 5.0: 112146, 6.0: 48448, 7.0: 22696, 8.0: 11506, 9.0: 6294, 10.0: 3494, 11.0: 1966, 12.0: 1128, 13.0: 656, 14.0: 434, 15.0: 300, 16.0: 212, 17.0: 164, 18.0: 68, 19.0: 54, 20.0: 10, 21.0: 6})
Convert a graph into a bidirected graph: 1.237 seconds
Metis partitioning: 5.759 seconds
Split the graph: 0.935 seconds
Construct subgraphs: 0.127 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  8.071504354476929
5802
5767
5834
5808
5853
5592
5811
5821
5517
5615
5517
5585
5555
5552
5517
5795
total k batches seeds list generation spend  17.986207008361816
after graph partition
graph partition algorithm spend time 18.080984830856323
5802
5767
5834
5808
5853
5592
5811
5821
5517
5615
5517
5585
5555
5552
5517
5795
partition_len_list
[12182, 11165, 12066, 13716, 12629, 13281, 12411, 10960, 15013, 13689, 25414, 17304, 29595, 26337, 28650, 29288]
shared_neighbor_graph_partition_s0 selection method  spend 18.185287952423096
time for parepare:  0.01739645004272461
local_output_nid generation:  0.0013811588287353516
local_in_edges_tensor generation:  0.0014445781707763672
mini_batch_src_global generation:  0.005188941955566406
r_  generation:  0.013947486877441406
local_output_nid generation:  0.0022487640380859375
local_in_edges_tensor generation:  0.0025091171264648438
mini_batch_src_global generation:  0.0014815330505371094
r_  generation:  0.010735034942626953
local_output_nid generation:  0.001672506332397461
local_in_edges_tensor generation:  0.0014469623565673828
mini_batch_src_global generation:  0.002163410186767578
r_  generation:  0.014345884323120117
local_output_nid generation:  0.0017213821411132812
local_in_edges_tensor generation:  0.0013325214385986328
mini_batch_src_global generation:  0.0014264583587646484
r_  generation:  0.01644444465637207
local_output_nid generation:  0.0019235610961914062
local_in_edges_tensor generation:  0.0014019012451171875
mini_batch_src_global generation:  0.0016200542449951172
r_  generation:  0.017176151275634766
local_output_nid generation:  0.0018546581268310547
local_in_edges_tensor generation:  0.001253366470336914
mini_batch_src_global generation:  0.0012097358703613281
r_  generation:  0.01399540901184082
local_output_nid generation:  0.0018885135650634766
local_in_edges_tensor generation:  0.001369476318359375
mini_batch_src_global generation:  0.0013759136199951172
r_  generation:  0.015353679656982422
local_output_nid generation:  0.0019145011901855469
local_in_edges_tensor generation:  0.0013127326965332031
mini_batch_src_global generation:  0.0015881061553955078
r_  generation:  0.016492366790771484
local_output_nid generation:  0.0019290447235107422
local_in_edges_tensor generation:  0.0012090206146240234
mini_batch_src_global generation:  0.0010981559753417969
r_  generation:  0.01229715347290039
local_output_nid generation:  0.001834869384765625
local_in_edges_tensor generation:  0.0013303756713867188
mini_batch_src_global generation:  0.00138092041015625
r_  generation:  0.010984420776367188
local_output_nid generation:  0.0018808841705322266
local_in_edges_tensor generation:  0.0014438629150390625
mini_batch_src_global generation:  0.0014197826385498047
r_  generation:  0.01846170425415039
local_output_nid generation:  0.0020122528076171875
local_in_edges_tensor generation:  0.0012445449829101562
mini_batch_src_global generation:  0.0014276504516601562
r_  generation:  0.014374017715454102
local_output_nid generation:  0.001977682113647461
local_in_edges_tensor generation:  0.0013384819030761719
mini_batch_src_global generation:  0.0014503002166748047
r_  generation:  0.01900339126586914
local_output_nid generation:  0.0021004676818847656
local_in_edges_tensor generation:  0.001512765884399414
mini_batch_src_global generation:  0.001668691635131836
r_  generation:  0.01837611198425293
local_output_nid generation:  0.002088785171508789
local_in_edges_tensor generation:  0.0013837814331054688
mini_batch_src_global generation:  0.0015919208526611328
r_  generation:  0.020123958587646484
local_output_nid generation:  0.002305746078491211
local_in_edges_tensor generation:  0.0015535354614257812
mini_batch_src_global generation:  0.0024139881134033203
r_  generation:  0.025636911392211914
----------------------check_connections_block total spend ----------------------------- 0.42856717109680176
generate_one_block  0.02475452423095703
generate_one_block  0.01686239242553711
generate_one_block  0.0181581974029541
generate_one_block  0.021993637084960938
generate_one_block  0.02321648597717285
generate_one_block  0.01868724822998047
generate_one_block  0.020319700241088867
generate_one_block  0.022098541259765625
generate_one_block  0.01785755157470703
generate_one_block  0.015899658203125
generate_one_block  0.025290250778198242
generate_one_block  0.020644187927246094
generate_one_block  0.027837276458740234
generate_one_block  0.024499893188476562
generate_one_block  0.02825784683227539
generate_one_block  0.03868436813354492
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04074430465698242
gen group dst list time:  0.008462905883789062
time for parepare:  0.022671937942504883
local_output_nid generation:  0.0025513172149658203
local_in_edges_tensor generation:  0.008272171020507812
mini_batch_src_global generation:  0.002267599105834961
r_  generation:  0.025454282760620117
local_output_nid generation:  0.0031642913818359375
local_in_edges_tensor generation:  0.0026488304138183594
mini_batch_src_global generation:  0.0022382736206054688
r_  generation:  0.02154231071472168
local_output_nid generation:  0.003423929214477539
local_in_edges_tensor generation:  0.0029571056365966797
mini_batch_src_global generation:  0.0020155906677246094
r_  generation:  0.02713465690612793
local_output_nid generation:  0.003921985626220703
local_in_edges_tensor generation:  0.0035943984985351562
mini_batch_src_global generation:  0.0028231143951416016
r_  generation:  0.03216385841369629
local_output_nid generation:  0.0035910606384277344
local_in_edges_tensor generation:  0.002779245376586914
mini_batch_src_global generation:  0.0028069019317626953
r_  generation:  0.02940678596496582
local_output_nid generation:  0.0037851333618164062
local_in_edges_tensor generation:  0.0031280517578125
mini_batch_src_global generation:  0.0024023056030273438
r_  generation:  0.029808998107910156
local_output_nid generation:  0.003566265106201172
local_in_edges_tensor generation:  0.003227710723876953
mini_batch_src_global generation:  0.0024847984313964844
r_  generation:  0.02850961685180664
local_output_nid generation:  0.0031189918518066406
local_in_edges_tensor generation:  0.0029439926147460938
mini_batch_src_global generation:  0.002162933349609375
r_  generation:  0.025619983673095703
local_output_nid generation:  0.004198789596557617
local_in_edges_tensor generation:  0.003300189971923828
mini_batch_src_global generation:  0.00264739990234375
r_  generation:  0.03370332717895508
local_output_nid generation:  0.003885507583618164
local_in_edges_tensor generation:  0.0037870407104492188
mini_batch_src_global generation:  0.0026671886444091797
r_  generation:  0.03022146224975586
local_output_nid generation:  0.006687164306640625
local_in_edges_tensor generation:  0.0070989131927490234
mini_batch_src_global generation:  0.006850719451904297
r_  generation:  0.07335686683654785
local_output_nid generation:  0.005182981491088867
local_in_edges_tensor generation:  0.0042154788970947266
mini_batch_src_global generation:  0.005281686782836914
r_  generation:  0.04435563087463379
local_output_nid generation:  0.007925987243652344
local_in_edges_tensor generation:  0.0068967342376708984
mini_batch_src_global generation:  0.008460760116577148
r_  generation:  0.0840296745300293
local_output_nid generation:  0.0076291561126708984
local_in_edges_tensor generation:  0.009014129638671875
mini_batch_src_global generation:  0.008803606033325195
r_  generation:  0.07685375213623047
local_output_nid generation:  0.007905960083007812
local_in_edges_tensor generation:  0.006720542907714844
mini_batch_src_global generation:  0.010192155838012695
r_  generation:  0.08413004875183105
local_output_nid generation:  0.007781982421875
local_in_edges_tensor generation:  0.007474184036254883
mini_batch_src_global generation:  0.010388374328613281
r_  generation:  0.08726096153259277
----------------------check_connections_block total spend ----------------------------- 1.167853832244873
generate_one_block  0.04403853416442871
generate_one_block  0.02897953987121582
generate_one_block  0.03308987617492676
generate_one_block  0.04327511787414551
generate_one_block  0.03851675987243652
generate_one_block  0.03764057159423828
generate_one_block  0.035951852798461914
generate_one_block  0.03322768211364746
generate_one_block  0.0450444221496582
generate_one_block  0.041646480560302734
generate_one_block  0.09901094436645508
generate_one_block  0.06110239028930664
generate_one_block  0.11284804344177246
generate_one_block  0.0997157096862793
generate_one_block  0.11321854591369629
generate_one_block  0.11504125595092773
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.046822547912597656  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

connection checking time:  1.5964210033416748
block generation total time  1.3474094867706299
average batch blocks generation time:  0.08421309292316437
block dataloader generation time/epoch 21.48833167552948
pseudo mini batch 0 input nodes size: 24636
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.04086446762084961  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.04086446762084961  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.0526118278503418  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.05265522003173828  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.023720741271972656  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.024545669555664062  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.024545669555664062  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.024545669555664062  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([24636, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.024545669555664062  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([1354, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.060106754302978516  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.060106754302978516  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1354, 128]), torch.Size([1, 1354, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.06139802932739258  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.07233190536499023  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1354, 128])
m.shape torch.Size([1453, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.07361078262329102  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.07361078262329102  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1453, 128]), torch.Size([1, 1453, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.0749964714050293  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.09641504287719727  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1453, 128])
m.shape torch.Size([1251, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.09751176834106445  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.09751176834106445  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1251, 128]), torch.Size([1, 1251, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.09870481491088867  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1253366470336914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1251, 128])
m.shape torch.Size([1114, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.12686491012573242  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.12686491012573242  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1114, 128]), torch.Size([1, 1114, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.12792730331420898  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.15948820114135742  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1114, 128])
m.shape torch.Size([909, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.16112422943115234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.16112422943115234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 909, 128]), torch.Size([1, 909, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.16199111938476562  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1932201385498047  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 909, 128])
m.shape torch.Size([794, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.19505834579467773  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.19505834579467773  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 794, 128]), torch.Size([1, 794, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.1958155632019043  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.22857236862182617  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 794, 128])
m.shape torch.Size([690, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.23049688339233398  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.23049688339233398  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 690, 128]), torch.Size([1, 690, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2311549186706543  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2640986442565918  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 690, 128])
m.shape torch.Size([563, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2659173011779785  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2659173011779785  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 563, 128]), torch.Size([1, 563, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.26645421981811523  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2972869873046875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 563, 128])
m.shape torch.Size([510, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2992072105407715  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.2992072105407715  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 510, 128]), torch.Size([1, 510, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.29969358444213867  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.33082151412963867  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 510, 128])
m.shape torch.Size([3544, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.34747743606567383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.34747743606567383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1772, 128]), torch.Size([1, 1772, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.3491673469543457  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.46915102005004883  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 0 shape torch.Size([1, 1772, 128])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.46915102005004883  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.46915102005004883  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1772, 128]), torch.Size([1, 1772, 128])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.4708409309387207  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5899796485900879  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 1 shape torch.Size([1, 1772, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.560786247253418  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5724039077758789  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5840215682983398  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5723128318786621  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([12182, 256])
first layer input nodes number: 24636
first layer output nodes number: 12182
edges number: 71142
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5842070579528809  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.5958247184753418  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.598729133605957  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.598729133605957  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([893, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6377887725830078  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6377887725830078  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 893, 256]), torch.Size([1, 893, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6394920349121094  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6531181335449219  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 893, 256])
m.shape torch.Size([820, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6538815498352051  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6538815498352051  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 820, 256]), torch.Size([1, 820, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6554455757141113  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6798644065856934  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 820, 256])
m.shape torch.Size([644, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6812019348144531  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6812019348144531  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 644, 256]), torch.Size([1, 644, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.6824302673339844  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7110328674316406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 644, 256])
m.shape torch.Size([532, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7130670547485352  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7130670547485352  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 532, 256]), torch.Size([1, 532, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7140817642211914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7450857162475586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 532, 256])
m.shape torch.Size([415, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7465729713439941  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7465729713439941  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 415, 256]), torch.Size([1, 415, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7473645210266113  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7766537666320801  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 415, 256])
m.shape torch.Size([347, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.77825927734375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.77825927734375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 347, 256]), torch.Size([1, 347, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.7789211273193359  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8078384399414062  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 347, 256])
m.shape torch.Size([330, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8097281455993652  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8097281455993652  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 330, 256]), torch.Size([1, 330, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8103575706481934  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8426623344421387  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 330, 256])
m.shape torch.Size([229, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8441085815429688  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8441085815429688  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8445453643798828  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8694419860839844  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([220, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.871126651763916  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.871126651763916  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8715462684631348  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8984017372131348  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([176, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8998837471008301  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.8998837471008301  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9002194404602051  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9240536689758301  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([133, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9255256652832031  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9255256652832031  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9257793426513672  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9455661773681641  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([135, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9469966888427734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9469966888427734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9472541809082031  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9691410064697266  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([114, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9704370498657227  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9704370498657227  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9706544876098633  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9906587600708008  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([95, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.991828441619873  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.991828441619873  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 0.9920096397399902  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0099482536315918  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([90, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.011155605316162  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.011155605316162  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0113272666931152  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0295233726501465  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([57, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0303144454956055  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0303144454956055  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0304231643676758  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.042708396911621  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([59, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0436182022094727  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0436182022094727  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0437307357788086  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.057234764099121  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([45, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0579571723937988  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0579571723937988  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0580430030822754  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0689435005187988  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([48, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.069777488708496  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.069777488708496  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.069869041442871  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.082137107849121  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([37, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0828027725219727  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0828027725219727  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0828733444213867  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0928239822387695  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0934147834777832  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0934147834777832  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.0934739112854004  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1022248268127441  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([35, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.102935791015625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.102935791015625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1030025482177734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1133499145507812  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([34, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1140685081481934  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1140685081481934  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.114133358001709  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1246390342712402  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([30, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1252989768981934  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1252989768981934  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1253561973571777  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.135026454925537  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([253, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1410770416259766  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1410770416259766  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1415596008300781  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.2264900207519531  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 253, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.193984031677246  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9901123046875 GB
    Memory Allocated: 1.1948490142822266  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.195713996887207  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.19480562210083  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([5802, 40])
input nodes number: 12182
output nodes number: 5802
edges number: 39502
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1949782371520996  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.194979190826416  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.02622699737548828  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

pseudo mini batch 1 input nodes size: 20759
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.023759841918945312  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.023759841918945312  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.033658504486083984  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.03370189666748047  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.021911144256591797  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.02258920669555664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.02258920669555664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.02258920669555664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([20759, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.02258920669555664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([1463, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.05187654495239258  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.05187654495239258  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1463, 128]), torch.Size([1, 1463, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.05327177047729492  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.06443357467651367  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1463, 128])
m.shape torch.Size([1627, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.06555604934692383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.06555604934692383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1627, 128]), torch.Size([1, 1627, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.0671076774597168  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.09038209915161133  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1627, 128])
m.shape torch.Size([1333, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.09201526641845703  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.09201526641845703  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1333, 128]), torch.Size([1, 1333, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.09328651428222656  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.12221336364746094  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1333, 128])
m.shape torch.Size([1152, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.12398672103881836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.12398672103881836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1152, 128]), torch.Size([1, 1152, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.12508535385131836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.15718984603881836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1152, 128])
m.shape torch.Size([942, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.15888643264770508  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.15888643264770508  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 942, 128]), torch.Size([1, 942, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.15978479385375977  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.19212579727172852  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 942, 128])
m.shape torch.Size([751, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.19382524490356445  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.19382524490356445  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 751, 128]), torch.Size([1, 751, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.19454145431518555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2268080711364746  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 751, 128])
m.shape torch.Size([627, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.22854280471801758  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.22854280471801758  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 627, 128]), torch.Size([1, 627, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2291407585144043  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2597541809082031  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 627, 128])
m.shape torch.Size([530, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.261476993560791  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.261476993560791  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 530, 128]), torch.Size([1, 530, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.26198244094848633  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.29106760025024414  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 530, 128])
m.shape torch.Size([409, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2925701141357422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2925701141357422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 409, 128]), torch.Size([1, 409, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.29296016693115234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.31792354583740234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 409, 128])
m.shape torch.Size([2331, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3288435935974121  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3288435935974121  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1165, 128]), torch.Size([1, 1165, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3299546241760254  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.4090280532836914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 0 shape torch.Size([1, 1165, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.4090280532836914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.4090280532836914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1166, 128]), torch.Size([1, 1166, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.4101400375366211  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.48853540420532227  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 1 shape torch.Size([1, 1166, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.46535634994506836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.47600412368774414  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.4866518974304199  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.4759206771850586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([11165, 256])
first layer input nodes number: 20759
first layer output nodes number: 11165
edges number: 58160
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.48680877685546875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.49745655059814453  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5010161399841309  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5010161399841309  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([1015, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5336017608642578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5336017608642578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1015, 256]), torch.Size([1, 1015, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5355377197265625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.551116943359375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1015, 256])
m.shape torch.Size([958, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5519905090332031  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5519905090332031  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 958, 256]), torch.Size([1, 958, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5538177490234375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5812263488769531  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 958, 256])
m.shape torch.Size([713, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5825624465942383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5825624465942383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 713, 256]), torch.Size([1, 713, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5839223861694336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6143331527709961  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 713, 256])
m.shape torch.Size([551, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6157717704772949  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6157717704772949  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 551, 256]), torch.Size([1, 551, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6168227195739746  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6473002433776855  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 551, 256])
m.shape torch.Size([485, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6491055488586426  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6491055488586426  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 485, 256]), torch.Size([1, 485, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6500306129455566  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.683988094329834  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 485, 256])
m.shape torch.Size([368, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6856479644775391  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6856479644775391  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 368, 256]), torch.Size([1, 368, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6863498687744141  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.719576358795166  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 368, 256])
m.shape torch.Size([274, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7210688591003418  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7210688591003418  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7215914726257324  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7482790946960449  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([260, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7500171661376953  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7500171661376953  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 260, 256]), torch.Size([1, 260, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7505130767822266  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7793045043945312  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 260, 256])
m.shape torch.Size([170, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7805271148681641  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7805271148681641  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7808513641357422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8016033172607422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([154, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8029217720031738  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8029217720031738  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.803215503692627  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8240704536437988  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([120, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8251924514770508  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8251924514770508  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8254213333129883  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8432741165161133  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([103, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8443479537963867  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8443479537963867  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8445444107055664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8612432479858398  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([70, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8620200157165527  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8620200157165527  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8621535301208496  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8744368553161621  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([73, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8753523826599121  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8753523826599121  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8754916191101074  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8892760276794434  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([62, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8901004791259766  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8901004791259766  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8902187347412109  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9027538299560547  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([51, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9034790992736816  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9034790992736816  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9035763740539551  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9145684242248535  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([41, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9151897430419922  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9151897430419922  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9152679443359375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.924652099609375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([45, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.925391674041748  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.925391674041748  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9254775047302246  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.936378002166748  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9367551803588867  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9367551803588867  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9367990493774414  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9426774978637695  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9429826736450195  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9429826736450195  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9430150985717773  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9475870132446289  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9480552673339844  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9480552673339844  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9481010437011719  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9548759460449219  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9552125930786133  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9552125930786133  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9552450180053711  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.960270881652832  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9606528282165527  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9606528282165527  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9606871604919434  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9662489891052246  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9666471481323242  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9666471481323242  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9666814804077148  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9724836349487305  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([137, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9757585525512695  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9757585525512695  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9760198593139648  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0220098495483398  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 137, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.996121883392334  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9969816207885742  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9978413581848145  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9969382286071777  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([5767, 40])
input nodes number: 11165
output nodes number: 5767
edges number: 32642
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9970598220825195  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9970602989196777  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.023977279663085938  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

pseudo mini batch 2 input nodes size: 22703
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.021905899047851562  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.021905899047851562  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.03362464904785156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.03366851806640625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.023726463317871094  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.024566650390625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.024566650390625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.024566650390625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([22703, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.024566650390625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([1253, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.06045818328857422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.06045818328857422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1253, 128]), torch.Size([1, 1253, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.06165313720703125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.07163238525390625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1253, 128])
m.shape torch.Size([1359, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.07233095169067383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.07233095169067383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1359, 128]), torch.Size([1, 1359, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.07362699508666992  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.09352636337280273  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1359, 128])
m.shape torch.Size([1230, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.09463787078857422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.09463787078857422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1230, 128]), torch.Size([1, 1230, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.0958108901977539  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.12179946899414062  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1230, 128])
m.shape torch.Size([1056, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.12322711944580078  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.12322711944580078  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1056, 128]), torch.Size([1, 1056, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.12423419952392578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.15363788604736328  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1056, 128])
m.shape torch.Size([954, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1554088592529297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1554088592529297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 954, 128]), torch.Size([1, 954, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.15631866455078125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1891012191772461  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 954, 128])
m.shape torch.Size([787, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.19089794158935547  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.19089794158935547  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 787, 128]), torch.Size([1, 787, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1916484832763672  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.22435569763183594  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 787, 128])
m.shape torch.Size([659, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2261800765991211  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2261800765991211  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 659, 128]), torch.Size([1, 659, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2268085479736328  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2585868835449219  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 659, 128])
m.shape torch.Size([620, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2606377601623535  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2606377601623535  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 620, 128]), torch.Size([1, 620, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2612290382385254  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.29570627212524414  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 620, 128])
m.shape torch.Size([498, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2975478172302246  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2975478172302246  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 498, 128]), torch.Size([1, 498, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2980227470397949  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3284182548522949  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 498, 128])
m.shape torch.Size([3650, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.34558534622192383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.34558534622192383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1825, 128]), torch.Size([1, 1825, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.34732580184936523  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.4708981513977051  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 0 shape torch.Size([1, 1825, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.4708981513977051  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.4708981513977051  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1825, 128]), torch.Size([1, 1825, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.4726386070251465  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5953407287597656  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 1 shape torch.Size([1, 1825, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5656914710998535  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5771985054016113  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5887055397033691  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5771083831787109  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([12066, 256])
first layer input nodes number: 22703
first layer output nodes number: 12066
edges number: 71932
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5888767242431641  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6003837585449219  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6038541793823242  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6038541793823242  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([888, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6443095207214355  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6443095207214355  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 888, 256]), torch.Size([1, 888, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.646003246307373  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.659553050994873  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 888, 256])
m.shape torch.Size([792, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6608448028564453  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6608448028564453  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 792, 256]), torch.Size([1, 792, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6623554229736328  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6850147247314453  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 792, 256])
m.shape torch.Size([642, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6864008903503418  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6864008903503418  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 642, 256]), torch.Size([1, 642, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6876254081726074  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7145648002624512  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 642, 256])
m.shape torch.Size([523, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.716094970703125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.716094970703125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 523, 256]), torch.Size([1, 523, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7170925140380859  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7474813461303711  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 523, 256])
m.shape torch.Size([444, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7491164207458496  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7491164207458496  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 444, 256]), torch.Size([1, 444, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7499632835388184  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7815909385681152  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 444, 256])
m.shape torch.Size([339, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7831225395202637  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7831225395202637  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 339, 256]), torch.Size([1, 339, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7837691307067871  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8118948936462402  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 339, 256])
m.shape torch.Size([299, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8135833740234375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8135833740234375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8141536712646484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8436031341552734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 299, 256])
m.shape torch.Size([255, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8452787399291992  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8452787399291992  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8457651138305664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8734884262084961  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([214, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8750967979431152  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8750967979431152  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8755049705505371  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9016280174255371  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([180, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9031543731689453  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9031543731689453  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9034976959228516  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9278736114501953  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([167, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9303421974182129  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9303421974182129  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9306607246398926  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9555058479309082  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([128, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9568228721618652  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9568228721618652  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9570670127868652  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9778189659118652  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([99, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9789342880249023  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9789342880249023  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9791231155395508  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.996495246887207  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([83, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9975180625915527  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9975180625915527  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9976763725280762  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0133490562438965  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([89, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0145530700683594  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0145530700683594  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0147228240966797  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0327167510986328  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([76, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0338006019592285  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0338006019592285  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0339455604553223  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.050325870513916  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([50, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0510706901550293  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0510706901550293  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.05116605758667  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.062610149383545  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([46, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0633583068847656  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0633583068847656  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.063446044921875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0745887756347656  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([58, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0756216049194336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0756216049194336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0757322311401367  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0905561447143555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([53, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.091519832611084  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.091519832611084  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.091620922088623  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1058745384216309  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.106450080871582  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.106450080871582  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1065092086791992  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.115260124206543  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([28, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1158227920532227  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1158227920532227  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1158761978149414  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1241540908813477  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([28, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1247467994689941  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1247467994689941  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.124800205230713  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1334519386291504  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1338868141174316  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1338868141174316  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.133924961090088  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1403717994689941  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([302, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1476092338562012  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1476092338562012  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1481852531433105  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2500433921813965  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 302, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2161312103271484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.217000961303711  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2178707122802734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2169570922851562  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([5834, 40])
input nodes number: 12066
output nodes number: 5834
edges number: 40757
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2171010971069336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2171015739440918  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.02622699737548828  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

pseudo mini batch 3 input nodes size: 31994
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.02373647689819336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.02373647689819336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.03936147689819336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.039404869079589844  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.027642250061035156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.028682708740234375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.028682708740234375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.028682708740234375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([31994, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.028682708740234375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([1131, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.0743250846862793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.0743250846862793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1131, 128]), torch.Size([1, 1131, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.07540369033813477  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.08403253555297852  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1131, 128])
m.shape torch.Size([1150, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.08458995819091797  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.08458995819091797  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1150, 128]), torch.Size([1, 1150, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.08568668365478516  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1028890609741211  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1150, 128])
m.shape torch.Size([1135, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.10429763793945312  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.10429763793945312  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1135, 128]), torch.Size([1, 1135, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.10538005828857422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.13008785247802734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1135, 128])
m.shape torch.Size([1034, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.13151884078979492  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.13151884078979492  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1034, 128]), torch.Size([1, 1034, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.13250494003295898  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1611018180847168  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1034, 128])
m.shape torch.Size([907, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.16277122497558594  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.16277122497558594  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 907, 128]), torch.Size([1, 907, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1636362075805664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.19530439376831055  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 907, 128])
m.shape torch.Size([800, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1971607208251953  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1971607208251953  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 800, 128]), torch.Size([1, 800, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1979236602783203  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.23145103454589844  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 800, 128])
m.shape torch.Size([683, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.23334932327270508  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.23334932327270508  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 683, 128]), torch.Size([1, 683, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.23400068283081055  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.26688480377197266  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 683, 128])
m.shape torch.Size([615, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2689051628112793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2689051628112793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 615, 128]), torch.Size([1, 615, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.26949167251586914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.30463171005249023  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 615, 128])
m.shape torch.Size([559, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.30673742294311523  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.30673742294311523  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 559, 128]), torch.Size([1, 559, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.30727052688598633  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3423166275024414  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 559, 128])
m.shape torch.Size([5702, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.36923933029174805  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.36923933029174805  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 2851, 128]), torch.Size([1, 2851, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.37195825576782227  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5697236061096191  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 0 shape torch.Size([1, 2851, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5697236061096191  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5697236061096191  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 2851, 128]), torch.Size([1, 2851, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5728464126586914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7695183753967285  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 1 shape torch.Size([1, 2851, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.731295108795166  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7443757057189941  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7574563026428223  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7442731857299805  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([13716, 256])
first layer input nodes number: 31994
first layer output nodes number: 13716
edges number: 92059
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7576966285705566  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7707772254943848  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7740473747253418  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7740473747253418  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([787, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8206419944763184  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8206419944763184  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 787, 256]), torch.Size([1, 787, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8221430778503418  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8347764015197754  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 787, 256])
m.shape torch.Size([704, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.835665225982666  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.835665225982666  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 704, 256]), torch.Size([1, 704, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.837007999420166  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8571829795837402  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 704, 256])
m.shape torch.Size([580, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8581843376159668  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8581843376159668  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 580, 256]), torch.Size([1, 580, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.859290599822998  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8836283683776855  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 580, 256])
m.shape torch.Size([480, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.884920597076416  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.884920597076416  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 480, 256]), torch.Size([1, 480, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.885836124420166  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9135899543762207  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 480, 256])
m.shape torch.Size([405, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9150786399841309  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9150786399841309  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 405, 256]), torch.Size([1, 405, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9158511161804199  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9436936378479004  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 405, 256])
m.shape torch.Size([319, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9451470375061035  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9451470375061035  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9457554817199707  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9719185829162598  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([273, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9734511375427246  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9734511375427246  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 273, 256]), torch.Size([1, 273, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9739718437194824  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0001769065856934  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 273, 256])
m.shape torch.Size([241, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.00177001953125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.00177001953125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0022296905517578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0284309387207031  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([211, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0300264358520508  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0300264358520508  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0304288864135742  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0561857223510742  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([196, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.057868480682373  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.057868480682373  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0582423210144043  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.084784984588623  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([136, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.086036205291748  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.086036205291748  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0862956047058105  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1065287590026855  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([145, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1080718040466309  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1080718040466309  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1083483695983887  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1318564414978027  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([134, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1333928108215332  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1333928108215332  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.13364839553833  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1571621894836426  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([118, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1586222648620605  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1586222648620605  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1588473320007324  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.181128978729248  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([105, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.182530403137207  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.182530403137207  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1827306747436523  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2039594650268555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([67, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2048907279968262  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2048907279968262  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2050185203552246  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.219459056854248  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([74, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.220604419708252  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.220604419708252  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.22074556350708  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.237682819366455  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([65, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2387371063232422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2387371063232422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.238861083984375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2546062469482422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([56, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.255582332611084  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.255582332611084  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2556891441345215  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2700018882751465  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([50, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2709097862243652  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2709097862243652  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2710051536560059  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.284451961517334  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.285151481628418  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.285151481628418  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.285222053527832  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2956666946411133  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([47, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2966256141662598  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2966256141662598  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.296715259552002  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.310610294342041  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3110742568969727  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3110742568969727  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3111181259155273  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3182249069213867  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3189411163330078  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3189411163330078  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3190021514892578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3293170928955078  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([523, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3418536186218262  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3418536186218262  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 523, 256]), torch.Size([1, 523, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.342851161956787  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.519153118133545  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 523, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.4788446426391602  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.4797101020812988  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.4805755615234375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.4796667098999023  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([5808, 40])
input nodes number: 13716
output nodes number: 5808
edges number: 47444
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.4798083305358887  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.4798088073730469  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.030684471130371094  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

pseudo mini batch 4 input nodes size: 21505
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.027637958526611328  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.027637958526611328  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.03789234161376953  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.03793621063232422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.022267818450927734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.023295879364013672  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.023295879364013672  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.023295879364013672  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([21505, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.023295879364013672  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([933, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.06583642959594727  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.06583642959594727  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 933, 128]), torch.Size([1, 933, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.0667262077331543  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.07405853271484375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 933, 128])
m.shape torch.Size([1029, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.07507801055908203  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.07507801055908203  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1029, 128]), torch.Size([1, 1029, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.07605934143066406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.09108829498291016  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1029, 128])
m.shape torch.Size([1027, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.09206676483154297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.09206676483154297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1027, 128]), torch.Size([1, 1027, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.09304618835449219  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.11504125595092773  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1027, 128])
m.shape torch.Size([885, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1164703369140625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1164703369140625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 885, 128]), torch.Size([1, 885, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.11731433868408203  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.14222335815429688  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 885, 128])
m.shape torch.Size([877, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1438922882080078  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1438922882080078  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 877, 128]), torch.Size([1, 877, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1447286605834961  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.17551469802856445  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 877, 128])
m.shape torch.Size([776, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.17731666564941406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.17731666564941406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 776, 128]), torch.Size([1, 776, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1780567169189453  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.21070289611816406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 776, 128])
m.shape torch.Size([655, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.21251916885375977  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.21251916885375977  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 655, 128]), torch.Size([1, 655, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.21314382553100586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.24537181854248047  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 655, 128])
m.shape torch.Size([620, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.24742460250854492  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.24742460250854492  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 620, 128]), torch.Size([1, 620, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2480158805847168  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.28240537643432617  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 620, 128])
m.shape torch.Size([537, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.28441429138183594  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.28441429138183594  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 537, 128]), torch.Size([1, 537, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2849264144897461  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3182244300842285  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 537, 128])
m.shape torch.Size([5290, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.34335899353027344  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.34335899353027344  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 2645, 128]), torch.Size([1, 2645, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.34588146209716797  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5286531448364258  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 0 shape torch.Size([1, 2645, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5286531448364258  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5286531448364258  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 2645, 128]), torch.Size([1, 2645, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5317883491516113  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7139115333557129  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 1 shape torch.Size([1, 2645, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6774535179138184  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6894974708557129  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7015414237976074  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6894030570983887  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([12629, 256])
first layer input nodes number: 21505
first layer output nodes number: 12629
edges number: 85931
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7017040252685547  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7137479782104492  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.716759204864502  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.716759204864502  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([671, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7675213813781738  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7675213813781738  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 671, 256]), torch.Size([1, 671, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.768801212310791  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7790398597717285  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 671, 256])
m.shape torch.Size([609, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7795805931091309  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7795805931091309  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 609, 256]), torch.Size([1, 609, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7807421684265137  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7983651161193848  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 609, 256])
m.shape torch.Size([534, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7996335029602051  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7996335029602051  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 534, 256]), torch.Size([1, 534, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.800652027130127  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8231320381164551  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 534, 256])
m.shape torch.Size([455, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8244733810424805  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8244733810424805  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 455, 256]), torch.Size([1, 455, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8253412246704102  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8506097793579102  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 455, 256])
m.shape torch.Size([405, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8523654937744141  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8523654937744141  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 405, 256]), torch.Size([1, 405, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8531379699707031  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8810796737670898  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 405, 256])
m.shape torch.Size([337, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8826370239257812  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8826370239257812  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 337, 256]), torch.Size([1, 337, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8832798004150391  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9117550849914551  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 337, 256])
m.shape torch.Size([296, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9134254455566406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9134254455566406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 296, 256]), torch.Size([1, 296, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9139900207519531  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9425239562988281  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 296, 256])
m.shape torch.Size([271, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9443254470825195  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9443254470825195  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9448423385620117  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9745216369628906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([232, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9762701988220215  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9762701988220215  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.976712703704834  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.005033016204834  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([201, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0068602561950684  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0068602561950684  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0072436332702637  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0344634056091309  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([179, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0361642837524414  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0361642837524414  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0365056991577148  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.063136100769043  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([155, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.064753532409668  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.064753532409668  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.065049171447754  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0901784896850586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([126, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0916051864624023  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0916051864624023  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0918455123901367  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1139554977416992  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([136, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1156654357910156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1156654357910156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1159248352050781  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1416053771972656  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([119, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1431913375854492  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1431913375854492  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.143418312072754  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1674776077270508  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([83, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1686406135559082  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1686406135559082  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1687989234924316  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.18668794631958  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([94, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1881446838378906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1881446838378906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.188323974609375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2098388671875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([67, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2109084129333496  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2109084129333496  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.211036205291748  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2272658348083496  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([49, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2280969619750977  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2280969619750977  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2281904220581055  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2407140731811523  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([70, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2420129776000977  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2420129776000977  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2421464920043945  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.260972023010254  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([71, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.262338638305664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.262338638305664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2624740600585938  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2825164794921875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([37, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.283231258392334  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.283231258392334  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.283301830291748  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2942404747009277  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([40, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2950897216796875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2950897216796875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.295166015625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.307525634765625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([44, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3085026741027832  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3085026741027832  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.308586597442627  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3227696418762207  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([572, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3364720344543457  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3364720344543457  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 572, 256]), torch.Size([1, 572, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3375630378723145  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.5304923057556152  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 572, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.4859085083007812  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.486781120300293  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.4876537322998047  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.4867372512817383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([5853, 40])
input nodes number: 12629
output nodes number: 5853
edges number: 51896
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.4868826866149902  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.4868831634521484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.025228023529052734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

pseudo mini batch 5 input nodes size: 26684
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.02227497100830078  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.02227497100830078  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.03594684600830078  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.035988807678222656  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.025690555572509766  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.026601314544677734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.026601314544677734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.026601314544677734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([26684, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.026601314544677734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([1385, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.06789302825927734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.06789302825927734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1385, 128]), torch.Size([1, 1385, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.0692138671875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.08059453964233398  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1385, 128])
m.shape torch.Size([1383, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.0812530517578125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.0812530517578125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1383, 128]), torch.Size([1, 1383, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.08257198333740234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.10235595703125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1383, 128])
m.shape torch.Size([1258, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.10417509078979492  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.10417509078979492  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1258, 128]), torch.Size([1, 1258, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.10537481307983398  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.13176870346069336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1258, 128])
m.shape torch.Size([1051, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.13317346572875977  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.13317346572875977  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1051, 128]), torch.Size([1, 1051, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.13417577743530273  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.16324281692504883  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1051, 128])
m.shape torch.Size([940, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.16498279571533203  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.16498279571533203  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 940, 128]), torch.Size([1, 940, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1658792495727539  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1982412338256836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 940, 128])
m.shape torch.Size([757, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.19995880126953125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.19995880126953125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 757, 128]), torch.Size([1, 757, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.20068073272705078  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2326335906982422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 757, 128])
m.shape torch.Size([632, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.23438215255737305  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.23438215255737305  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 632, 128]), torch.Size([1, 632, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2349848747253418  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2654232978820801  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 632, 128])
m.shape torch.Size([597, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.26739931106567383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.26739931106567383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 597, 128]), torch.Size([1, 597, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.26796865463256836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.30129480361938477  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 597, 128])
m.shape torch.Size([486, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.30309581756591797  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.30309581756591797  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 486, 128]), torch.Size([1, 486, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3035593032836914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3332223892211914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 486, 128])
m.shape torch.Size([4792, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3564281463623047  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3564281463623047  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 2396, 128]), torch.Size([1, 2396, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3588829040527344  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5221872329711914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 0 shape torch.Size([1, 2396, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5221872329711914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5221872329711914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 2396, 128]), torch.Size([1, 2396, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5244722366333008  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6864347457885742  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 1 shape torch.Size([1, 2396, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6517510414123535  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6649494171142578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6776151657104492  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6643176078796387  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([13281, 256])
first layer input nodes number: 26684
first layer output nodes number: 13281
edges number: 82865
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6778159141540527  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6904816627502441  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6936483383178711  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6936483383178711  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([962, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7325668334960938  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7325668334960938  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 962, 256]), torch.Size([1, 962, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7344017028808594  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7491097450256348  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 962, 256])
m.shape torch.Size([791, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7497940063476562  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7497940063476562  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 791, 256]), torch.Size([1, 791, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7513027191162109  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7742900848388672  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 791, 256])
m.shape torch.Size([667, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7758359909057617  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7758359909057617  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 667, 256]), torch.Size([1, 667, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7771081924438477  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8050966262817383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 667, 256])
m.shape torch.Size([494, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.806490421295166  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.806490421295166  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 494, 256]), torch.Size([1, 494, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8074326515197754  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8357625007629395  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 494, 256])
m.shape torch.Size([392, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8378772735595703  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8378772735595703  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 392, 256]), torch.Size([1, 392, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8386249542236328  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8659987449645996  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 392, 256])
m.shape torch.Size([318, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8674588203430176  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8674588203430176  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.868065357208252  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8946309089660645  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([238, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8959293365478516  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8959293365478516  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8963832855224609  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9190807342529297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([192, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9203300476074219  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9203300476074219  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9206962585449219  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9415702819824219  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([175, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9429011344909668  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9429011344909668  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.943234920501709  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.964597225189209  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([156, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9659299850463867  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9659299850463867  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9662275314331055  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9873533248901367  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([123, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9885053634643555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9885053634643555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9887399673461914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0070390701293945  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([90, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0079655647277832  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0079655647277832  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0081372261047363  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.022728443145752  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([91, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.023794174194336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.023794174194336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0239677429199219  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0399360656738281  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([62, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0406837463378906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0406837463378906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.040802001953125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0525093078613281  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([68, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0534305572509766  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0534305572509766  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0535602569580078  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0673084259033203  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([69, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0683050155639648  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0683050155639648  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.068436622619629  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.083308219909668  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([65, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0843048095703125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0843048095703125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0844287872314453  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0993061065673828  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([45, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.100022792816162  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.100022792816162  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1001086235046387  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.111009120941162  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([53, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1119341850280762  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1119341850280762  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1120352745056152  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1255812644958496  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([41, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1263189315795898  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1263189315795898  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1263971328735352  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1374235153198242  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([32, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1380305290222168  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1380305290222168  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1380915641784668  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1471247673034668  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([26, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.14764404296875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.14764404296875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1476936340332031  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1553802490234375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([28, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1559748649597168  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1559748649597168  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1560282707214355  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.164680004119873  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.165137767791748  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.165137767791748  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.165177822113037  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1719470024108887  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([393, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1813702583312988  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1813702583312988  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 393, 256]), torch.Size([1, 393, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1821198463439941  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3149981498718262  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 393, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.282360553741455  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2831940650939941  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2840275764465332  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2831521034240723  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([5592, 40])
input nodes number: 13281
output nodes number: 5592
edges number: 39293
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2832541465759277  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.283254623413086  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.02832508087158203  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

pseudo mini batch 6 input nodes size: 25788
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.02565145492553711  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.02565145492553711  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.0379481315612793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.03799152374267578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.024277687072753906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.02519702911376953  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.02519702911376953  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.02519702911376953  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([25788, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.02519702911376953  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([1155, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.06425237655639648  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.06425237655639648  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1155, 128]), torch.Size([1, 1155, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.0653538703918457  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.07416582107543945  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1155, 128])
m.shape torch.Size([1272, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.07522964477539062  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.07522964477539062  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1272, 128]), torch.Size([1, 1272, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.07644271850585938  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.09467315673828125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1272, 128])
m.shape torch.Size([1184, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.09576034545898438  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.09576034545898438  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1184, 128]), torch.Size([1, 1184, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.09688949584960938  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.12264633178710938  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1184, 128])
m.shape torch.Size([994, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1239776611328125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1239776611328125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 994, 128]), torch.Size([1, 994, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.12492561340332031  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.15287399291992188  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 994, 128])
m.shape torch.Size([823, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.15436220169067383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.15436220169067383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 823, 128]), torch.Size([1, 823, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.15514707565307617  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1838550567626953  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 823, 128])
m.shape torch.Size([715, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.18550825119018555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.18550825119018555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 715, 128]), torch.Size([1, 715, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.18619012832641602  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.21564435958862305  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 715, 128])
m.shape torch.Size([641, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.21744298934936523  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.21744298934936523  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 641, 128]), torch.Size([1, 641, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.21805429458618164  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2490711212158203  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 641, 128])
m.shape torch.Size([661, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.25128698348999023  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.25128698348999023  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 661, 128]), torch.Size([1, 661, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.25191736221313477  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2884688377380371  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 661, 128])
m.shape torch.Size([533, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.29044103622436523  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.29044103622436523  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 533, 128]), torch.Size([1, 533, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.29094934463500977  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.32449913024902344  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 533, 128])
m.shape torch.Size([4433, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.34572935104370117  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.34572935104370117  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 2216, 128]), torch.Size([1, 2216, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3478426933288574  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5020594596862793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 0 shape torch.Size([1, 2216, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5020594596862793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5020594596862793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 2217, 128]), torch.Size([1, 2217, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.504173755645752  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6572585105895996  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 1 shape torch.Size([1, 2217, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6244316101074219  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6369876861572266  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6488237380981445  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6361751556396484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([12411, 256])
first layer input nodes number: 25788
first layer output nodes number: 12411
edges number: 78534
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6490178108215332  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6608538627624512  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6640195846557617  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6640195846557617  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([845, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7083702087402344  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7083702087402344  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 845, 256]), torch.Size([1, 845, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7099819183349609  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7228755950927734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 845, 256])
m.shape torch.Size([768, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.723546028137207  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.723546028137207  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 768, 256]), torch.Size([1, 768, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.725010871887207  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7470607757568359  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 768, 256])
m.shape torch.Size([632, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.748237133026123  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.748237133026123  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 632, 256]), torch.Size([1, 632, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7494425773620605  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7759623527526855  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 632, 256])
m.shape torch.Size([515, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7775115966796875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7775115966796875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 515, 256]), torch.Size([1, 515, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7784938812255859  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8074913024902344  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 515, 256])
m.shape torch.Size([400, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8089227676391602  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8089227676391602  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 400, 256]), torch.Size([1, 400, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8096857070922852  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8371515274047852  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 400, 256])
m.shape torch.Size([289, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8384370803833008  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8384370803833008  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8389883041381836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8631114959716797  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 289, 256])
m.shape torch.Size([254, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8645448684692383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8645448684692383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8650293350219727  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8892526626586914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([262, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8910250663757324  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8910250663757324  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8915247917175293  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9211955070495605  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([193, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9226155281066895  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9226155281066895  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9229836463928223  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9465432167053223  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([149, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.947791576385498  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.947791576385498  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9480757713317871  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9682536125183105  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([134, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9695286750793457  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9695286750793457  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9697842597961426  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9897198677062988  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([155, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9913802146911621  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9913802146911621  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.991675853729248  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0168051719665527  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([110, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0180320739746094  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0180320739746094  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0182418823242188  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0375442504882812  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([106, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0388660430908203  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0388660430908203  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0390682220458984  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0590839385986328  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([85, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0602083206176758  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0602083206176758  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0603704452514648  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0775556564331055  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([81, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.078768253326416  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.078768253326416  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0789227485656738  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0963807106018066  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([73, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.097496509552002  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.097496509552002  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0976357460021973  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1143441200256348  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([61, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1153302192687988  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1153302192687988  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1154465675354004  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1302227973937988  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([61, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1312789916992188  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1312789916992188  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1313953399658203  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1469860076904297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([37, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.147639274597168  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.147639274597168  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.147709846496582  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1576604843139648  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([58, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1587963104248047  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1587963104248047  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1589069366455078  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1752796173095703  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([37, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.17600679397583  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.17600679397583  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1760773658752441  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1870160102844238  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([47, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1880197525024414  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1880197525024414  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1881093978881836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.202631950378418  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2032561302185059  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2032561302185059  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2033114433288574  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2126593589782715  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([430, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.222963809967041  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.222963809967041  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 430, 256]), torch.Size([1, 430, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2237839698791504  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3686022758483887  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 430, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3306384086608887  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3315043449401855  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3323702812194824  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.331460952758789  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([5811, 40])
input nodes number: 12411
output nodes number: 5811
edges number: 44788
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3316292762756348  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.331629753112793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.027017593383789062  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

pseudo mini batch 7 input nodes size: 20276
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.02431011199951172  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.02431011199951172  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.03397846221923828  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.034021854400634766  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.021681785583496094  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.022613525390625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.022613525390625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.022613525390625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([20276, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.022613525390625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([727, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.05941963195800781  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.05941963195800781  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 727, 128]), torch.Size([1, 727, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.060112953186035156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.0665578842163086  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 727, 128])
m.shape torch.Size([907, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.06707620620727539  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.06707620620727539  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 907, 128]), torch.Size([1, 907, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.06794118881225586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.08091592788696289  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 907, 128])
m.shape torch.Size([884, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.08216571807861328  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.08216571807861328  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 884, 128]), torch.Size([1, 884, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.0830087661743164  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.10155582427978516  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 884, 128])
m.shape torch.Size([848, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1027517318725586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1027517318725586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 848, 128]), torch.Size([1, 848, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1035604476928711  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1274709701538086  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 848, 128])
m.shape torch.Size([738, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.12882614135742188  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.12882614135742188  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 738, 128]), torch.Size([1, 738, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1295299530029297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.15501785278320312  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 738, 128])
m.shape torch.Size([719, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1567230224609375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1567230224609375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 719, 128]), torch.Size([1, 719, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1574087142944336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.18743324279785156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 719, 128])
m.shape torch.Size([620, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.18915987014770508  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.18915987014770508  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 620, 128]), torch.Size([1, 620, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.18975114822387695  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2193293571472168  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 620, 128])
m.shape torch.Size([589, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.22128057479858398  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.22128057479858398  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 589, 128]), torch.Size([1, 589, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.22184228897094727  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.25512075424194336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 589, 128])
m.shape torch.Size([497, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2569727897644043  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2569727897644043  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 497, 128]), torch.Size([1, 497, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2574467658996582  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2877812385559082  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 497, 128])
m.shape torch.Size([4431, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.30902862548828125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.30902862548828125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 2215, 128]), torch.Size([1, 2215, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.31115293502807617  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.4649338722229004  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 0 shape torch.Size([1, 2215, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.4649338722229004  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.4649338722229004  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 2216, 128]), torch.Size([1, 2216, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.46756601333618164  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6201353073120117  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 1 shape torch.Size([1, 2216, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5886054039001465  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.599057674407959  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6095099449157715  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.598975658416748  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([10960, 256])
first layer input nodes number: 20276
first layer output nodes number: 10960
edges number: 74424
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6096630096435547  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6201152801513672  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6232795715332031  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6232795715332031  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([547, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6732468605041504  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6732468605041504  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 547, 256]), torch.Size([1, 547, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6742901802062988  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6826629638671875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 547, 256])
m.shape torch.Size([599, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6839165687561035  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6839165687561035  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 599, 256]), torch.Size([1, 599, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6850590705871582  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.702448844909668  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 599, 256])
m.shape torch.Size([540, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7041139602661133  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7041139602661133  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 540, 256]), torch.Size([1, 540, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.705143928527832  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7284173965454102  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 540, 256])
m.shape torch.Size([465, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7296905517578125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7296905517578125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 465, 256]), torch.Size([1, 465, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7305774688720703  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7563743591308594  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 465, 256])
m.shape torch.Size([416, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7579302787780762  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7579302787780762  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7587237358093262  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7877764701843262  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 416, 256])
m.shape torch.Size([385, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7896003723144531  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7896003723144531  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 385, 256]), torch.Size([1, 385, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7903347015380859  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8228435516357422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 385, 256])
m.shape torch.Size([328, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8246831893920898  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8246831893920898  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 328, 256]), torch.Size([1, 328, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8253087997436523  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.857722282409668  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 328, 256])
m.shape torch.Size([276, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8595318794250488  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8595318794250488  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8600583076477051  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8900647163391113  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([233, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8918170928955078  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8918170928955078  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8922615051269531  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9207038879394531  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([236, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9227499961853027  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9227499961853027  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9232001304626465  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9551596641540527  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([232, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9576001167297363  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9576001167297363  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9580426216125488  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9925580024719238  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([157, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.994147777557373  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.994147777557373  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9944472312927246  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0199007987976074  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([148, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0216007232666016  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0216007232666016  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0218830108642578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0478534698486328  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([135, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0495290756225586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0495290756225586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0497865676879883  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0752782821655273  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([98, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0765624046325684  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0765624046325684  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.076749324798584  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0965628623962402  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([96, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0979456901550293  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0979456901550293  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0981287956237793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1188197135925293  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([95, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1202807426452637  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1202807426452637  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1204619407653809  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1422057151794434  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([82, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1435341835021973  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1435341835021973  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.143690586090088  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1635537147521973  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([53, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1644434928894043  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1644434928894043  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1645445823669434  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1780905723571777  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([86, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1796932220458984  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1796932220458984  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1798572540283203  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2029857635498047  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([59, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2040948867797852  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2040948867797852  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.204207420349121  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2208623886108398  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([44, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2217369079589844  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2217369079589844  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2218208312988281  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2348289489746094  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([35, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2355608940124512  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2355608940124512  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2356276512145996  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2464423179626465  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([45, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2474546432495117  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2474546432495117  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2475404739379883  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2620458602905273  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([431, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2723593711853027  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2723593711853027  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 431, 256]), torch.Size([1, 431, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.273181438446045  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.418393611907959  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 431, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3745779991149902  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.37544584274292  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3763136863708496  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3754024505615234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([5821, 40])
input nodes number: 10960
output nodes number: 5821
edges number: 50517
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3755297660827637  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3755302429199219  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.02438640594482422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

pseudo mini batch 8 input nodes size: 37264
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.021683692932128906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.021683692932128906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.039452552795410156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.03949403762817383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.02978229522705078  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.030735015869140625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.030735015869140625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.030735015869140625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([37264, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.030735015869140625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([1532, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.07765388488769531  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.07765388488769531  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1532, 128]), torch.Size([1, 1532, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.07911491394042969  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.09080314636230469  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1532, 128])
m.shape torch.Size([1559, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.09183502197265625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.09183502197265625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1559, 128]), torch.Size([1, 1559, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.0933218002319336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.11562347412109375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1559, 128])
m.shape torch.Size([1434, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.11767816543579102  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.11767816543579102  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1434, 128]), torch.Size([1, 1434, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.11904573440551758  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1494126319885254  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1434, 128])
m.shape torch.Size([1188, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1514601707458496  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1514601707458496  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1188, 128]), torch.Size([1, 1188, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.15259313583374023  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.18607091903686523  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1188, 128])
m.shape torch.Size([1067, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1880483627319336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1880483627319336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1067, 128]), torch.Size([1, 1067, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.18906593322753906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2258763313293457  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1067, 128])
m.shape torch.Size([881, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2278881072998047  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2278881072998047  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 881, 128]), torch.Size([1, 881, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2287282943725586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.26520538330078125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 881, 128])
m.shape torch.Size([740, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2672553062438965  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2672553062438965  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 740, 128]), torch.Size([1, 740, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2679610252380371  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3034377098083496  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 740, 128])
m.shape torch.Size([669, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3056368827819824  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3056368827819824  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 669, 128]), torch.Size([1, 669, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3062748908996582  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3428645133972168  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 669, 128])
m.shape torch.Size([520, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.34477710723876953  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.34477710723876953  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 520, 128]), torch.Size([1, 520, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3452730178833008  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.378204345703125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 520, 128])
m.shape torch.Size([5423, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.40381526947021484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.40381526947021484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 2711, 128]), torch.Size([1, 2711, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.4064006805419922  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5917177200317383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 0 shape torch.Size([1, 2711, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5917177200317383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5917177200317383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 2712, 128]), torch.Size([1, 2712, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5944442749023438  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7777237892150879  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 1 shape torch.Size([1, 2712, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7383804321289062  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7526979446411133  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7670154571533203  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7525858879089355  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([15013, 256])
first layer input nodes number: 37264
first layer output nodes number: 15013
edges number: 93767
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7672953605651855  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7816128730773926  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7856259346008301  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7856259346008301  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([1070, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.819523811340332  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.819523811340332  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1070, 256]), torch.Size([1, 1070, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8215646743774414  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8386592864990234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1070, 256])
m.shape torch.Size([825, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8386802673339844  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8386802673339844  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 825, 256]), torch.Size([1, 825, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8402538299560547  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8659934997558594  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 825, 256])
m.shape torch.Size([661, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8672881126403809  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8672881126403809  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 661, 256]), torch.Size([1, 661, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8685488700866699  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8962855339050293  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 661, 256])
m.shape torch.Size([474, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.897550106048584  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.897550106048584  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 474, 256]), torch.Size([1, 474, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8984541893005371  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9254088401794434  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 474, 256])
m.shape torch.Size([449, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9271149635314941  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9271149635314941  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 449, 256]), torch.Size([1, 449, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.927971363067627  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9588017463684082  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 449, 256])
m.shape torch.Size([313, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9601788520812988  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9601788520812988  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9607758522033691  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9878339767456055  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([254, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9892444610595703  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9892444610595703  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9897289276123047  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0139522552490234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([204, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.016036033630371  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.016036033630371  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0164251327514648  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0386037826538086  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([170, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0398797988891602  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0398797988891602  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0402040481567383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0609560012817383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([151, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0622453689575195  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0622453689575195  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0625333786010742  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.082982063293457  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([106, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0839781761169434  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0839781761169434  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0841803550720215  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0999503135681152  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([103, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1010375022888184  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1010375022888184  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.101233959197998  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1179327964782715  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([92, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1189842224121094  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1189842224121094  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1191596984863281  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1353034973144531  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([78, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1363563537597656  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1363563537597656  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.136505126953125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1512336730957031  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([57, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1519813537597656  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1519813537597656  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.152090072631836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.163614273071289  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([49, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.164313793182373  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.164313793182373  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1644072532653809  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1749682426452637  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1755428314208984  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1755428314208984  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1756153106689453  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1843128204345703  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([38, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.184934139251709  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.184934139251709  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1850066184997559  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.194211483001709  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.194723129272461  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.194723129272461  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1947803497314453  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2024478912353516  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2029194831848145  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2029194831848145  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2029690742492676  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2099614143371582  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.210381031036377  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.210381031036377  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2104229927062988  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2166333198547363  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2169718742370605  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2169718742370605  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2170042991638184  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2220301628112793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2224783897399902  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2224783897399902  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2225184440612793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2290072441101074  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2295641899108887  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2295641899108887  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.229611873626709  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2376704216003418  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([244, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2435097694396973  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2435097694396973  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 244, 256]), torch.Size([1, 244, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2439751625061035  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3258843421936035  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 244, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.298424243927002  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2992467880249023  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3000693321228027  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2992053031921387  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([5517, 40])
input nodes number: 15013
output nodes number: 5517
edges number: 33940
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2993135452270508  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.299314022064209  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.03257322311401367  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

pseudo mini batch 9 input nodes size: 35028
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.029736995697021484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.029736995697021484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.04643964767456055  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.04648160934448242  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.0286712646484375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.029509544372558594  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.029509544372558594  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.029509544372558594  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([35028, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.029509544372558594  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([1549, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.07043075561523438  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.07043075561523438  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1549, 128]), torch.Size([1, 1549, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.07190799713134766  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.0837259292602539  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1549, 128])
m.shape torch.Size([1615, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.08452749252319336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.08452749252319336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1615, 128]), torch.Size([1, 1615, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.08606767654418945  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.10917043685913086  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1615, 128])
m.shape torch.Size([1406, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.11087799072265625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.11087799072265625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1406, 128]), torch.Size([1, 1406, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.11221885681152344  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.14215469360351562  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1406, 128])
m.shape torch.Size([1214, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.14396190643310547  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.14396190643310547  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1214, 128]), torch.Size([1, 1214, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.14511966705322266  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.17932796478271484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1214, 128])
m.shape torch.Size([999, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.18113088607788086  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.18113088607788086  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 999, 128]), torch.Size([1, 999, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1820836067199707  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.21734333038330078  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 999, 128])
m.shape torch.Size([790, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.21912717819213867  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.21912717819213867  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 790, 128]), torch.Size([1, 790, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2198805809020996  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2525019645690918  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 790, 128])
m.shape torch.Size([686, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.25441503524780273  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.25441503524780273  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 686, 128]), torch.Size([1, 686, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2550692558288574  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2879214286804199  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 686, 128])
m.shape torch.Size([600, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2898831367492676  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2898831367492676  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 600, 128]), torch.Size([1, 600, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.29045534133911133  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.324094295501709  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 600, 128])
m.shape torch.Size([547, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3261556625366211  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3261556625366211  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 547, 128]), torch.Size([1, 547, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3266773223876953  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.36045217514038086  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 547, 128])
m.shape torch.Size([4283, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3806142807006836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3806142807006836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 2141, 128]), torch.Size([1, 2141, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.38269662857055664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5294895172119141  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 0 shape torch.Size([1, 2141, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5294895172119141  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5294895172119141  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 2142, 128]), torch.Size([1, 2142, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5315322875976562  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.676424503326416  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 1 shape torch.Size([1, 2142, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6424727439880371  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6555275917053223  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6685824394226074  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6554255485534668  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([13689, 256])
first layer input nodes number: 35028
first layer output nodes number: 13689
edges number: 80943
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6688456535339355  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6819005012512207  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6851644515991211  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6851644515991211  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([1112, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7166361808776855  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7166361808776855  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1112, 256]), torch.Size([1, 1112, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7188119888305664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7367615699768066  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1112, 256])
m.shape torch.Size([918, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7379493713378906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7379493713378906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 918, 256]), torch.Size([1, 918, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7397003173828125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7661304473876953  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 918, 256])
m.shape torch.Size([695, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7677688598632812  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7677688598632812  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 695, 256]), torch.Size([1, 695, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7690944671630859  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7982578277587891  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 695, 256])
m.shape torch.Size([565, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7997674942016602  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7997674942016602  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 565, 256]), torch.Size([1, 565, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8008451461791992  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8322305679321289  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 565, 256])
m.shape torch.Size([437, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8337922096252441  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8337922096252441  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 437, 256]), torch.Size([1, 437, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8346257209777832  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8646321296691895  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 437, 256])
m.shape torch.Size([303, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8659629821777344  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8659629821777344  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8665409088134766  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8925976753234863  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([227, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8938360214233398  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8938360214233398  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.8942689895629883  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9159173965454102  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([212, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9173312187194824  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9173312187194824  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9177355766296387  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9407839775085449  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([195, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9422688484191895  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9422688484191895  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9426407814025879  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9664444923400879  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([145, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9676523208618164  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9676523208618164  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9679288864135742  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9875650405883789  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([108, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9888081550598145  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9888081550598145  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9890141487121582  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0050816535949707  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([89, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.006047248840332  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.006047248840332  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0062170028686523  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.020646095275879  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([93, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0217232704162598  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0217232704162598  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0219006538391113  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.038219928741455  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([62, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0389657020568848  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0389657020568848  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0390839576721191  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0507912635803223  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([54, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0515108108520508  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0515108108520508  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0516138076782227  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0625314712524414  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([56, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0633411407470703  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0633411407470703  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0634479522705078  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0755176544189453  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([43, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.076167106628418  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.076167106628418  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.076249122619629  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0860910415649414  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0865864753723145  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0865864753723145  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0866456031799316  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0941548347473145  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0946369171142578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0946369171142578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0946903228759766  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.101846694946289  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1023201942443848  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1023201942443848  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.102369785308838  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1093621253967285  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1098217964172363  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1098217964172363  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1098675727844238  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1166424751281738  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1168737411499023  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1168737411499023  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.116896629333496  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1204442977905273  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.120720386505127  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.120720386505127  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1207451820373535  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1247620582580566  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.125072956085205  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.125072956085205  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1250996589660645  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1296124458312988  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([153, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1332755088806152  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1332755088806152  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1335673332214355  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1849284172058105  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 153, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1599607467651367  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1607975959777832  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1616344451904297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1607556343078613  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([5615, 40])
input nodes number: 13689
output nodes number: 5615
edges number: 31394
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1609139442443848  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.160914421081543  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.03122711181640625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

pseudo mini batch 10 input nodes size: 57892
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.028685569763183594  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.028685569763183594  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.056290626525878906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.05633211135864258  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.03958749771118164  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.041478633880615234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.041478633880615234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.041478633880615234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([57892, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.041478633880615234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([1370, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.14031457901000977  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.14031457901000977  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1370, 128]), torch.Size([1, 1370, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.14162111282348633  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.15207338333129883  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1370, 128])
m.shape torch.Size([1475, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.15308523178100586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.15308523178100586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1475, 128]), torch.Size([1, 1475, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.15449190139770508  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1760573387145996  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1475, 128])
m.shape torch.Size([1195, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1772775650024414  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1772775650024414  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1195, 128]), torch.Size([1, 1195, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.17841720581054688  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2038116455078125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1195, 128])
m.shape torch.Size([1084, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.20530939102172852  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.20530939102172852  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1084, 128]), torch.Size([1, 1084, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2063431739807129  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2371659278869629  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1084, 128])
m.shape torch.Size([1088, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2392430305480957  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2392430305480957  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1088, 128]), torch.Size([1, 1088, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2402806282043457  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2782292366027832  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1088, 128])
m.shape torch.Size([916, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2803311347961426  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2803311347961426  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 916, 128]), torch.Size([1, 916, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2812047004699707  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3187680244445801  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 916, 128])
m.shape torch.Size([889, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.32129859924316406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.32129859924316406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 889, 128]), torch.Size([1, 889, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3221464157104492  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.36630773544311523  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 889, 128])
m.shape torch.Size([880, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.37015438079833984  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.37015438079833984  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 880, 128]), torch.Size([1, 880, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.37099361419677734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.41882991790771484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 880, 128])
m.shape torch.Size([844, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.42203235626220703  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.42203235626220703  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 844, 128]), torch.Size([1, 844, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.4228372573852539  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.47460269927978516  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 844, 128])
m.shape torch.Size([15673, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5489349365234375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5489349365234375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 7836, 128]), torch.Size([1, 7836, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5564079284667969  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1056041717529297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 0 shape torch.Size([1, 7836, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1056041717529297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1056041717529297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 7837, 128]), torch.Size([1, 7837, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1147747039794922  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.659463882446289  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 1 shape torch.Size([1, 7837, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.5690879821777344  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.5933246612548828  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.6175613403320312  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.593134880065918  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([25414, 256])
first layer input nodes number: 57892
first layer output nodes number: 25414
edges number: 200766
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.617994785308838  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.6422314643859863  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.6487679481506348  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.6487679481506348  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([878, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.7010116577148438  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.7010116577148438  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 878, 256]), torch.Size([1, 878, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.7026863098144531  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.7160835266113281  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 878, 256])
m.shape torch.Size([720, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.7167906761169434  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.7167906761169434  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 720, 256]), torch.Size([1, 720, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.7181639671325684  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.7387633323669434  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 720, 256])
m.shape torch.Size([503, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.7396950721740723  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.7396950721740723  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 503, 256]), torch.Size([1, 503, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.740654468536377  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.764101505279541  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 503, 256])
m.shape torch.Size([352, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.7654709815979004  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.7654709815979004  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 352, 256]), torch.Size([1, 352, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.7661423683166504  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.7886419296264648  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 352, 256])
m.shape torch.Size([319, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.789839267730713  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.789839267730713  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.79044771194458  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.8133797645568848  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([230, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.8144021034240723  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.8144021034240723  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.8148407936096191  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.8337044715881348  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([190, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.834763526916504  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.834763526916504  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.8351259231567383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.853245735168457  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([164, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.854325771331787  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.854325771331787  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.8546385765075684  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.8724684715270996  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([148, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.8735923767089844  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.8735923767089844  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.8738746643066406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.8919410705566406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([136, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.8932409286499023  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.8932409286499023  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.8935003280639648  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9119176864624023  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([107, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9129490852355957  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9129490852355957  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9131531715393066  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9290719032287598  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([98, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9301328659057617  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9301328659057617  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9303197860717773  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9462080001831055  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([75, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.947052001953125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.947052001953125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.947195053100586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9603557586669922  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([67, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9611859321594238  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9611859321594238  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9613137245178223  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9739651679992676  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([61, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9747810363769531  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9747810363769531  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9748973846435547  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9872303009033203  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([61, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9881105422973633  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9881105422973633  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9882268905639648  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0013742446899414  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([60, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0022964477539062  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0022964477539062  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.002410888671875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.016143798828125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([69, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.017305374145508  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.017305374145508  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.017436981201172  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.034151077270508  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([55, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0351614952087402  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0351614952087402  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.035266399383545  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.049323558807373  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([50, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.050232410430908  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.050232410430908  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.050327777862549  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.063774585723877  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([36, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.064453601837158  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.064453601837158  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0645222663879395  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0746846199035645  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([40, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.075496196746826  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.075496196746826  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0755724906921387  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.087398052215576  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([38, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.088200092315674  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.088200092315674  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0882725715637207  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1000142097473145  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([31, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1006932258605957  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1006932258605957  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.100752353668213  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1107449531555176  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([1029, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1362977027893066  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1362977027893066  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1029, 256]), torch.Size([1, 1029, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1384644508361816  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.4947328567504883  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1029, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.4481120109558105  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.448934555053711  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.4497570991516113  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.4488930702209473  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([5517, 40])
input nodes number: 25414
output nodes number: 5517
edges number: 52987
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.4491100311279297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.449110507965088  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.04481363296508789  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

pseudo mini batch 11 input nodes size: 38872
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.03957319259643555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.03957319259643555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.05810880661010742  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.0581507682800293  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.030504226684570312  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.03171253204345703  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.03171253204345703  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.03171253204345703  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([38872, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.03171253204345703  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([1369, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.09206819534301758  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.09206819534301758  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1369, 128]), torch.Size([1, 1369, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.09337377548217773  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.10381841659545898  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1369, 128])
m.shape torch.Size([1439, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1045379638671875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1045379638671875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1439, 128]), torch.Size([1, 1439, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1059103012084961  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.12723541259765625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1439, 128])
m.shape torch.Size([1154, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.12906217575073242  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.12906217575073242  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1154, 128]), torch.Size([1, 1154, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.13016271591186523  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.15483999252319336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1154, 128])
m.shape torch.Size([1074, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.15633821487426758  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.15633821487426758  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1074, 128]), torch.Size([1, 1074, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1573624610900879  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.18706560134887695  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1074, 128])
m.shape torch.Size([985, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1889019012451172  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1889019012451172  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 985, 128]), torch.Size([1, 985, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.18984127044677734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2243790626525879  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 985, 128])
m.shape torch.Size([865, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.22638416290283203  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.22638416290283203  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 865, 128]), torch.Size([1, 865, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.22720909118652344  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.26285839080810547  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 865, 128])
m.shape torch.Size([768, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.26500940322875977  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.26500940322875977  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 768, 128]), torch.Size([1, 768, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.26574182510375977  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.30316877365112305  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 768, 128])
m.shape torch.Size([720, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.30554914474487305  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.30554914474487305  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 720, 128]), torch.Size([1, 720, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.30623579025268555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.34644269943237305  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 720, 128])
m.shape torch.Size([624, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.34877729415893555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.34877729415893555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 624, 128]), torch.Size([1, 624, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.34937238693237305  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.38900327682495117  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 624, 128])
m.shape torch.Size([8306, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.428311824798584  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.428311824798584  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 4153, 128]), torch.Size([1, 4153, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.43227243423461914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7139840126037598  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 0 shape torch.Size([1, 4153, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7139840126037598  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7139840126037598  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 4153, 128]), torch.Size([1, 4153, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.7179446220397949  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9971675872802734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 1 shape torch.Size([1, 4153, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9449677467346191  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9614701271057129  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9779725074768066  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9613409042358398  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([17304, 256])
first layer input nodes number: 38872
first layer output nodes number: 17304
edges number: 121932
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.978264331817627  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9947667121887207  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9988923072814941  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.9988923072814941  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([960, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0394043922424316  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0394043922424316  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 960, 256]), torch.Size([1, 960, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0412354469299316  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0563158988952637  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 960, 256])
m.shape torch.Size([820, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0571212768554688  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0571212768554688  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 820, 256]), torch.Size([1, 820, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.058685302734375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.082376480102539  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 820, 256])
m.shape torch.Size([594, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0833163261413574  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.0833163261413574  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 594, 256]), torch.Size([1, 594, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.084449291229248  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.112647533416748  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 594, 256])
m.shape torch.Size([450, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1138114929199219  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1138114929199219  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 450, 256]), torch.Size([1, 450, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1146697998046875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1395606994628906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 450, 256])
m.shape torch.Size([399, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1410493850708008  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1410493850708008  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 399, 256]), torch.Size([1, 399, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.141810417175293  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.172004222869873  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 399, 256])
m.shape torch.Size([321, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1734752655029297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1734752655029297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.1740875244140625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2076268196105957  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 321, 256])
m.shape torch.Size([259, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2090635299682617  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2090635299682617  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 259, 256]), torch.Size([1, 259, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2095575332641602  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2347135543823242  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 259, 256])
m.shape torch.Size([220, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2361583709716797  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2361583709716797  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2365779876708984  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2604961395263672  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([170, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2617568969726562  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2617568969726562  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2620811462402344  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2828330993652344  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([150, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2842559814453125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2842559814453125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2845420837402344  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3048553466796875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([131, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3060975074768066  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3060975074768066  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.306347370147705  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3258366584777832  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([102, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3268885612487793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3268885612487793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3270831108093262  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3436198234558105  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([84, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3445725440979004  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3445725440979004  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3447327613830566  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3594727516174316  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([62, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.360227108001709  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.360227108001709  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3603453636169434  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3720526695251465  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([59, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3728442192077637  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3728442192077637  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3729567527770996  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.384885311126709  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([50, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3855981826782227  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3855981826782227  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3856935501098633  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.396470069885254  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([57, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3973541259765625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3973541259765625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3974628448486328  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.4105091094970703  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([50, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.4113202095031738  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.4113202095031738  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.4114155769348145  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.4235272407531738  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([52, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.4244294166564941  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.4244294166564941  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.4245285987854004  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.437819004058838  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([48, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.4386920928955078  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.4386920928955078  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.4387836456298828  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.4516925811767578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.4523940086364746  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.4523940086364746  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.4524645805358887  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.46290922164917  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([33, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.4635720252990723  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.4635720252990723  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.463634967803955  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.473391056060791  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.4737358093261719  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.4737358093261719  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.4737682342529297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.4790210723876953  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([36, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.4798355102539062  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.4798355102539062  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.4799041748046875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.4915084838867188  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([424, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.501662254333496  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.501662254333496  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 424, 256]), torch.Size([1, 424, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.5024709701538086  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.6455373764038086  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 424, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.611274242401123  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.6121068000793457  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.6129393577575684  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.6120648384094238  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([5585, 40])
input nodes number: 17304
output nodes number: 5585
edges number: 40191
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.612246036529541  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.6122465133666992  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.033971309661865234  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

pseudo mini batch 12 input nodes size: 66372
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.030514240264892578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.030514240264892578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.06216287612915039  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.06220436096191406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.04362678527832031  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.045828819274902344  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.045828819274902344  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.045828819274902344  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([66372, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.045828819274902344  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([1196, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.16394424438476562  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.16394424438476562  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1196, 128]), torch.Size([1, 1196, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1650848388671875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1751079559326172  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1196, 128])
m.shape torch.Size([1426, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.17589759826660156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.17589759826660156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1426, 128]), torch.Size([1, 1426, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.17725753784179688  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.19849586486816406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1426, 128])
m.shape torch.Size([1312, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1996927261352539  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1996927261352539  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1312, 128]), torch.Size([1, 1312, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2009439468383789  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2284708023071289  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1312, 128])
m.shape torch.Size([1227, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.23018550872802734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.23018550872802734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1227, 128]), torch.Size([1, 1227, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2313556671142578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2652902603149414  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1227, 128])
m.shape torch.Size([1221, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.26761627197265625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.26761627197265625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1221, 128]), torch.Size([1, 1221, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2687807083129883  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.31070613861083984  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1221, 128])
m.shape torch.Size([1139, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.313382625579834  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.313382625579834  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1139, 128]), torch.Size([1, 1139, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3144688606262207  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3611769676208496  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1139, 128])
m.shape torch.Size([1045, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3641219139099121  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3641219139099121  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1045, 128]), torch.Size([1, 1045, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.36511850357055664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.41510629653930664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1045, 128])
m.shape torch.Size([1018, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.4184913635253906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.4184913635253906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1018, 128]), torch.Size([1, 1018, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.4194622039794922  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.4749774932861328  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1018, 128])
m.shape torch.Size([979, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.47869348526000977  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.47869348526000977  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 979, 128]), torch.Size([1, 979, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.4796271324157715  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5410971641540527  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 979, 128])
m.shape torch.Size([19032, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6313819885253906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6313819885253906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 9516, 128]), torch.Size([1, 9516, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6408710479736328  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.285207748413086  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 0 shape torch.Size([1, 9516, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.285207748413086  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.285207748413086  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 9516, 128]), torch.Size([1, 9516, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2942829132080078  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.93408203125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 1 shape torch.Size([1, 9516, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.8287057876586914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.8569297790527344  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.8851537704467773  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.8567090034484863  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([29595, 256])
first layer input nodes number: 66372
first layer output nodes number: 29595
edges number: 240421
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.885650634765625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.913874626159668  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9209308624267578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9209308624267578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([713, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9749865531921387  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9749865531921387  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 713, 256]), torch.Size([1, 713, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.976346492767334  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9890685081481934  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 713, 256])
m.shape torch.Size([667, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9896759986877441  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9896759986877441  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 667, 256]), torch.Size([1, 667, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.99094820022583  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0135064125061035  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 667, 256])
m.shape torch.Size([509, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.014464855194092  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.014464855194092  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 509, 256]), torch.Size([1, 509, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0154356956481934  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0368714332580566  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 509, 256])
m.shape torch.Size([385, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0379905700683594  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0379905700683594  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 385, 256]), torch.Size([1, 385, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.038724899291992  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0624451637268066  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 385, 256])
m.shape torch.Size([351, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0639567375183105  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0639567375183105  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 351, 256]), torch.Size([1, 351, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0646262168884277  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0893235206604004  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 351, 256])
m.shape torch.Size([255, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0904593467712402  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0904593467712402  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0909457206726074  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1118597984313965  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([208, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1130199432373047  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1130199432373047  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1134166717529297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1332530975341797  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([168, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1344456672668457  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1344456672668457  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.134766101837158  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1530308723449707  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([143, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.154261589050293  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.154261589050293  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.154534339904785  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.171990394592285  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([134, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1732449531555176  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1732449531555176  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1735005378723145  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1916470527648926  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([145, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.193406105041504  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.193406105041504  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1936826705932617  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.215254783630371  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([117, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.216507911682129  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.216507911682129  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.216731071472168  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.2356996536254883  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([106, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.2369794845581055  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.2369794845581055  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.2371816635131836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.255782127380371  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([78, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.257070541381836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.257070541381836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.2572193145751953  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.2719478607177734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([92, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.2732648849487305  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.2732648849487305  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.273440361022949  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.2920408248901367  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([77, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.2933435440063477  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.2933435440063477  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.293490409851074  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.310086250305176  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([60, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.310993194580078  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.310993194580078  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.311107635498047  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.324840545654297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([71, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.326173782348633  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.326173782348633  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.3263092041015625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.343507766723633  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([64, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.34483003616333  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.34483003616333  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.34495210647583  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.36130952835083  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([53, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.362271785736084  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.362271785736084  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.362372875213623  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.376626491546631  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([60, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.3779664039611816  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.3779664039611816  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.3780808448791504  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.3950181007385254  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([46, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.3959336280822754  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.3959336280822754  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.3960213661193848  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.409620761871338  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([31, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.4102625846862793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.4102625846862793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.4103217124938965  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.419900417327881  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([39, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.4207706451416016  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.4207706451416016  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.4208450317382812  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.4334163665771484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([983, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.456998825073242  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.456998825073242  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 983, 256]), torch.Size([1, 983, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.458873748779297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.7897233963012695  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 983, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.741227626800537  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.7420554161071777  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.7428832054138184  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.742013931274414  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([5555, 40])
input nodes number: 29595
output nodes number: 5555
edges number: 54977
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.7422714233398438  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.742271900177002  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.04965639114379883  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

pseudo mini batch 13 input nodes size: 66682
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.04362201690673828  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.04362201690673828  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.07541847229003906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.07545995712280273  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.04376983642578125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.045673370361328125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.045673370361328125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.045673370361328125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([66682, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.045673370361328125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([1331, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1475982666015625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1475982666015625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1331, 128]), torch.Size([1, 1331, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.14886760711669922  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.15902233123779297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1331, 128])
m.shape torch.Size([1416, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.16002273559570312  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.16002273559570312  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1416, 128]), torch.Size([1, 1416, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.16137313842773438  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.18254470825195312  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1416, 128])
m.shape torch.Size([1325, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.18389606475830078  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.18389606475830078  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1325, 128]), torch.Size([1, 1325, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.18515968322753906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.21295928955078125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1325, 128])
m.shape torch.Size([1257, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.21472501754760742  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.21472501754760742  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1257, 128]), torch.Size([1, 1257, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.21592378616333008  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2506880760192871  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1257, 128])
m.shape torch.Size([1170, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.25287818908691406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.25287818908691406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1170, 128]), torch.Size([1, 1170, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2539939880371094  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2941703796386719  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1170, 128])
m.shape torch.Size([1101, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.29676246643066406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.29676246643066406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1101, 128]), torch.Size([1, 1101, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.29781246185302734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3435935974121094  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1101, 128])
m.shape torch.Size([1037, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3465299606323242  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3465299606323242  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1037, 128]), torch.Size([1, 1037, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3475189208984375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.39696693420410156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1037, 128])
m.shape torch.Size([937, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.40004682540893555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.40004682540893555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 937, 128]), torch.Size([1, 937, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.4009404182434082  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.45206308364868164  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 937, 128])
m.shape torch.Size([900, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.4554786682128906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.4554786682128906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 900, 128]), torch.Size([1, 900, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.45633697509765625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5119633674621582  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 900, 128])
m.shape torch.Size([15863, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5871748924255371  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5871748924255371  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 7931, 128]), torch.Size([1, 7931, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5953941345214844  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.146721363067627  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 0 shape torch.Size([1, 7931, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.146721363067627  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.146721363067627  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 7932, 128]), torch.Size([1, 7932, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.155529499053955  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.7018513679504395  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 1 shape torch.Size([1, 7932, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.609506607055664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.634897232055664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.6600141525268555  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.6344270706176758  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([26337, 256])
first layer input nodes number: 66682
first layer output nodes number: 26337
edges number: 207107
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.660512924194336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.685903549194336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.6919851303100586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.6919851303100586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([820, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.7402334213256836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.7402334213256836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 820, 256]), torch.Size([1, 820, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.7417974472045898  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.7543096542358398  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 820, 256])
m.shape torch.Size([718, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.7549633979797363  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.7549633979797363  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 718, 256]), torch.Size([1, 718, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.7563328742980957  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.77775239944458  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 718, 256])
m.shape torch.Size([540, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.778663158416748  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.778663158416748  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 540, 256]), torch.Size([1, 540, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.7796931266784668  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.8030085563659668  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 540, 256])
m.shape torch.Size([425, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.8041658401489258  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.8041658401489258  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 425, 256]), torch.Size([1, 425, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.804976463317871  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.8286542892456055  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 425, 256])
m.shape torch.Size([355, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.8299551010131836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.8299551010131836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 355, 256]), torch.Size([1, 355, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.830632209777832  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.8573684692382812  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 355, 256])
m.shape torch.Size([283, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.8586621284484863  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.8586621284484863  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 283, 256]), torch.Size([1, 283, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.8592019081115723  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.8841171264648438  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 283, 256])
m.shape torch.Size([243, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.8863086700439453  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.8863086700439453  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.8867721557617188  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9099464416503906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([201, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9112606048583984  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9112606048583984  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9116439819335938  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9334964752197266  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([184, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.934896469116211  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.934896469116211  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9352474212646484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9577083587646484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([137, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9588499069213867  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9588499069213867  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.959111213684082  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9776639938354492  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([121, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9788126945495605  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9788126945495605  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9790434837341309  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9970450401306152  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([108, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9981756210327148  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9981756210327148  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9983816146850586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0158910751342773  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([93, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0169501304626465  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0169501304626465  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.017127513885498  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.033446788787842  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([75, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0343799591064453  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0343799591064453  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0345230102539062  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.048685073852539  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([72, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0496745109558105  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0496745109558105  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.049811840057373  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.064368724822998  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([57, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0651769638061523  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0651769638061523  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0652856826782227  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.077570915222168  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([67, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.078611373901367  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.078611373901367  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0787391662597656  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.094074249267578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([66, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0951523780822754  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0951523780822754  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.095278263092041  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1112656593322754  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([57, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1129064559936523  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1129064559936523  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1130151748657227  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1275835037231445  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([60, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1286826133728027  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1286826133728027  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1287970542907715  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1449332237243652  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([42, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.145723819732666  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.145723819732666  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.145803928375244  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1576600074768066  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([37, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.158402442932129  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.158402442932129  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.158473014831543  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1694116592407227  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([28, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1699957847595215  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1699957847595215  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1700491905212402  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1787009239196777  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([34, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1794586181640625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1794586181640625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.179523468017578  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1904830932617188  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([729, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.2079672813415527  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.2079672813415527  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 729, 256]), torch.Size([1, 729, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.209357738494873  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.4544625282287598  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 729, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.4120655059814453  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.4128928184509277  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.41372013092041  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.412851333618164  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([5552, 40])
input nodes number: 26337
output nodes number: 5552
edges number: 48253
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.413088798522949  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.4130892753601074  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.04908466339111328  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

pseudo mini batch 14 input nodes size: 62323
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.04376935958862305  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.04376935958862305  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.0734872817993164  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.07352876663208008  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.041690826416015625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.043883323669433594  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.043883323669433594  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.043883323669433594  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([62323, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.043883323669433594  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([1184, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.15997982025146484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.15997982025146484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1184, 128]), torch.Size([1, 1184, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.16110897064208984  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.17075872421264648  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1184, 128])
m.shape torch.Size([1200, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.17133855819702148  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.17133855819702148  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1200, 128]), torch.Size([1, 1200, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.17248296737670898  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.18964910507202148  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1200, 128])
m.shape torch.Size([1205, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.19080066680908203  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.19080066680908203  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1205, 128]), torch.Size([1, 1205, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.19194984436035156  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.21827936172485352  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1205, 128])
m.shape torch.Size([1101, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2198047637939453  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2198047637939453  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1101, 128]), torch.Size([1, 1101, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2208547592163086  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.25130462646484375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1101, 128])
m.shape torch.Size([1045, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.25327110290527344  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.25327110290527344  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1045, 128]), torch.Size([1, 1045, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.25426769256591797  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2908921241760254  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1045, 128])
m.shape torch.Size([1017, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.29405975341796875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.29405975341796875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1017, 128]), torch.Size([1, 1017, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2950296401977539  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3369483947753906  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1017, 128])
m.shape torch.Size([973, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.33971118927001953  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.33971118927001953  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 973, 128]), torch.Size([1, 973, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3406391143798828  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.38800811767578125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 973, 128])
m.shape torch.Size([881, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.39090490341186523  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.39090490341186523  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 881, 128]), torch.Size([1, 881, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.39174509048461914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.4398055076599121  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 881, 128])
m.shape torch.Size([887, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.44379329681396484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.44379329681396484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 887, 128]), torch.Size([1, 887, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.4446392059326172  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5006198883056641  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 887, 128])
m.shape torch.Size([19157, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5915446281433105  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5915446281433105  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 9578, 128]), torch.Size([1, 9578, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.6006789207458496  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.249213695526123  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 0 shape torch.Size([1, 9578, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.249213695526123  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.249213695526123  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 9579, 128]), torch.Size([1, 9579, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2583489418029785  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9029836654663086  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 1 shape torch.Size([1, 9579, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.7988409996032715  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.8261637687683105  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.8534865379333496  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.8259501457214355  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([28650, 256])
first layer input nodes number: 62323
first layer output nodes number: 28650
edges number: 236342
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.8539528846740723  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.8812756538391113  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.888106346130371  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.888106346130371  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([726, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9446215629577637  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9446215629577637  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 726, 256]), torch.Size([1, 726, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9460062980651855  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9584174156188965  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 726, 256])
m.shape torch.Size([585, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9589948654174805  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9589948654174805  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 585, 256]), torch.Size([1, 585, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9601106643676758  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9776034355163574  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 585, 256])
m.shape torch.Size([463, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9784626960754395  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9784626960754395  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 463, 256]), torch.Size([1, 463, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9793457984924316  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.998945713043213  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 463, 256])
m.shape torch.Size([362, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.999934196472168  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.999934196472168  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 362, 256]), torch.Size([1, 362, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.000624656677246  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.021925926208496  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 362, 256])
m.shape torch.Size([301, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0234251022338867  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0234251022338867  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0239992141723633  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.046358108520508  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 301, 256])
m.shape torch.Size([238, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0474438667297363  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0474438667297363  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0478978157043457  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.067417621612549  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([205, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0690536499023438  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0690536499023438  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0694446563720703  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0889949798583984  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([161, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0900721549987793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0900721549987793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.090379238128662  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1078829765319824  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([173, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1092262268066406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1092262268066406  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.109556198120117  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.130674362182617  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([167, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.132251262664795  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.132251262664795  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1325697898864746  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1551852226257324  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([125, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1563477516174316  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1563477516174316  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.156586170196533  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.175182819366455  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([112, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1763553619384766  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1763553619384766  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1765689849853516  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1947269439697266  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([94, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.195892333984375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.195892333984375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1960716247558594  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.212566375732422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([98, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.214249610900879  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.214249610900879  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.2144365310668945  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.2329416275024414  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([83, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.2341203689575195  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.2341203689575195  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.234278678894043  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.2510595321655273  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([80, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.2522525787353516  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.2522525787353516  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.2524051666259766  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.2696475982666016  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([72, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.270843505859375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.270843505859375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.2709808349609375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.2874603271484375  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([64, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.288662910461426  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.288662910461426  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.288784980773926  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.304287910461426  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([67, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.3054990768432617  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.3054990768432617  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.30562686920166  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.322751045227051  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([59, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.3239588737487793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.3239588737487793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.3240714073181152  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.3399386405944824  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([62, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.3411550521850586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.3411550521850586  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.341273307800293  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.3587751388549805  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([37, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.3594985008239746  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.3594985008239746  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.3595690727233887  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.3705077171325684  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([50, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.371743679046631  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.371743679046631  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.3718390464782715  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.3872885704040527  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.387979030609131  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.387979030609131  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.388040065765381  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.398355007171631  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([1101, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.4247798919677734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.4247798919677734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1101, 256]), torch.Size([1, 1101, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.427114486694336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.8099288940429688  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1101, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.7588582038879395  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.75968074798584  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.7605032920837402  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.759639263153076  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([5517, 40])
input nodes number: 28650
output nodes number: 5517
edges number: 57842
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.759889602661133  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.759890079498291  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.04766988754272461  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

pseudo mini batch 15 input nodes size: 54994
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.041686058044433594  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.041686058044433594  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.06790924072265625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.06795263290405273  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.0381932258605957  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.04066038131713867  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.04066038131713867  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.04066038131713867  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([54994, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.04066038131713867  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([890, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.16474056243896484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.16474056243896484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 890, 128]), torch.Size([1, 890, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1655893325805664  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.17331266403198242  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 890, 128])
m.shape torch.Size([909, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.17375516891479492  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.17375516891479492  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 909, 128]), torch.Size([1, 909, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.1746220588684082  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.18762540817260742  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 909, 128])
m.shape torch.Size([916, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.18854427337646484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.18854427337646484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 916, 128]), torch.Size([1, 916, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.18941783905029297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.20863628387451172  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 916, 128])
m.shape torch.Size([863, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.20984554290771484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.20984554290771484  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 863, 128]), torch.Size([1, 863, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.21066856384277344  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.23453617095947266  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 863, 128])
m.shape torch.Size([887, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.23623943328857422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.23623943328857422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 887, 128]), torch.Size([1, 887, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.23708534240722656  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.26793670654296875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 887, 128])
m.shape torch.Size([848, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2699398994445801  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2699398994445801  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 848, 128]), torch.Size([1, 848, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.2707486152648926  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3055233955383301  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 848, 128])
m.shape torch.Size([873, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3080329895019531  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3080329895019531  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 873, 128]), torch.Size([1, 873, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3088655471801758  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.3511323928833008  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 873, 128])
m.shape torch.Size([812, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.35381364822387695  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.35381364822387695  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 812, 128]), torch.Size([1, 812, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.35458803176879883  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.40069103240966797  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 812, 128])
m.shape torch.Size([871, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.40404176712036133  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.40404176712036133  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 871, 128]), torch.Size([1, 871, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.40487241744995117  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.4588756561279297  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 871, 128])
m.shape torch.Size([21419, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5605940818786621  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5605940818786621  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 10709, 128]), torch.Size([1, 10709, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.5708069801330566  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2959227561950684  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 0 shape torch.Size([1, 10709, 128])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2959227561950684  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.2959227561950684  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 10710, 128]), torch.Size([1, 10710, 128])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.3061366081237793  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.028951644897461  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst 1 shape torch.Size([1, 10710, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9165868759155273  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9445180892944336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9724493026733398  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9442996978759766  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([29288, 256])
first layer input nodes number: 54994
first layer output nodes number: 29288
edges number: 253067
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 1.9728612899780273  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0007925033569336  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.00777530670166  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.00777530670166  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

m.shape torch.Size([541, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0833334922790527  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0833334922790527  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 541, 256]), torch.Size([1, 541, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0843653678894043  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.092780590057373  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 541, 256])
m.shape torch.Size([412, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0930566787719727  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0930566787719727  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 412, 256]), torch.Size([1, 412, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.0938425064086914  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1058168411254883  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 412, 256])
m.shape torch.Size([360, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1064906120300293  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1064906120300293  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 360, 256]), torch.Size([1, 360, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.107177257537842  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1238045692443848  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 360, 256])
m.shape torch.Size([292, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1246204376220703  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1246204376220703  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1251773834228516  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.143306255340576  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([249, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1442246437072754  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1442246437072754  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1446995735168457  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.161797046661377  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([223, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1628456115722656  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1628456115722656  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.163270950317383  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.181560516357422  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([167, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.182961940765381  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.182961940765381  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.1832804679870605  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.199206829071045  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([156, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.200247287750244  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.200247287750244  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.200544834136963  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.2175049781799316  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([145, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.2186107635498047  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.2186107635498047  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.2188873291015625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.2365875244140625  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([131, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.2382349967956543  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.2382349967956543  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.2384848594665527  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.256225109100342  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([136, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.257538318634033  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.257538318634033  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.2577977180480957  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.2780308723449707  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([140, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.2795162200927734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.2795162200927734  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.279783248901367  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.302480697631836  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([127, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.303934097290039  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.303934097290039  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.3041763305664062  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.3264617919921875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([106, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.3277673721313477  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.3277673721313477  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.327969551086426  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.34798526763916  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([95, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.3492541313171387  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.3492541313171387  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.349435329437256  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.3686423301696777  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([101, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.370105266571045  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.370105266571045  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.370297908782959  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.392066478729248  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([82, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.393310070037842  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.393310070037842  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.3934664726257324  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.4122347831726074  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([103, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.413938522338867  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.413938522338867  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.414134979248047  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.439085006713867  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([82, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.4404845237731934  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.4404845237731934  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.440640926361084  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.4615988731384277  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([94, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.464261054992676  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.464261054992676  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.46444034576416  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.489720344543457  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([91, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.4914674758911133  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.4914674758911133  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.491641044616699  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.517329216003418  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([63, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.5185747146606445  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.5185747146606445  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.5186948776245117  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.537320137023926  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([68, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.5387635231018066  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.5387635231018066  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.538893222808838  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.5599045753479004  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([75, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.561570167541504  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.561570167541504  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.561713218688965  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.5858888626098633  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([1756, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.6280107498168945  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.6280107498168945  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

 h.shape torch.Size([1, 1756, 256]), torch.Size([1, 1756, 256])
----------------------------------------3
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 2.6322226524353027  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 3.2231574058532715  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

rst.shape  torch.Size([1, 1756, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 3.1538758277893066  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 3.1547393798828125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 3.1556029319763184  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 3.154695987701416  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

torch.Size([5795, 40])
input nodes number: 29288
output nodes number: 5795
edges number: 77827
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 3.154998779296875  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 3.154999256134033  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.044879913330078125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.044879913330078125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.9920654296875 GB
    Memory Allocated: 0.044879913330078125  GigaBytes
Max Memory Allocated: 3.380119800567627  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01253858208656311 |0.002439141273498535 |0.12023948132991791 |8.748471736907959e-05 |0.0783570408821106 |0.004699230194091797 |
----------------------------------------------------------pseudo_mini_loss sum 3.818648099899292Using backend: pytorch

Total (block generation + training)time/epoch 24.99651527404785
* Pure training time/epoch 3.4232869148254395
Training time/epoch 3.515505313873291
Training time without block to device /epoch 3.4764790534973145
Training time without total dataloading part /epoch 3.183643341064453
load block tensor time/epoch 0.20061731338500977
block to device time/epoch 0.03902626037597656
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  897472
Number of first layer input nodes during this epoch:  613772
Number of first layer output nodes during this epoch:  283700
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
