[04:41:39] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28871986 edges into 2 parts and get 181976 edge cuts
main start at this time 1652848878.7347095
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

<class 'int'>
<class 'int'>
----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.026607990264892578
global_2_local spend time (sec) 0.03570818901062012
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004460334777832031
A = g.adjacency_matrix() spent  0.007918834686279297
auxiliary_graph
Graph(num_nodes=154611, num_edges=28962927,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07826685905456543
remove nodes length
63670
auxiliary_graph.remove_nodes spent  1.2839503288269043
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28962927,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.173595905303955

the counter of shared neighbor distribution
Counter({1.0: 23350590, 2.0: 4010844, 3.0: 1004314, 4.0: 300894, 5.0: 109354, 6.0: 47662, 7.0: 22182, 8.0: 11490, 9.0: 6150, 10.0: 3490, 11.0: 2010, 12.0: 1100, 13.0: 704, 14.0: 414, 15.0: 272, 16.0: 202, 17.0: 172, 18.0: 78, 19.0: 52, 21.0: 8, 20.0: 4})
28871986
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28871983, 28871984, 28871985])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23350590, 2.0: 4010844, 3.0: 1004314, 4.0: 300894, 5.0: 109354, 6.0: 47662, 7.0: 22182, 8.0: 11490, 9.0: 6150, 10.0: 3490, 11.0: 2010, 12.0: 1100, 13.0: 704, 14.0: 414, 15.0: 272, 16.0: 202, 17.0: 172, 18.0: 78, 19.0: 52, 21.0: 8, 20.0: 4})
Convert a graph into a bidirected graph: 1.298 seconds
Metis partitioning: 4.844 seconds
Split the graph: 4.630 seconds
Construct subgraphs: 0.063 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  10.848287343978882
46549
44392
total k batches seeds list generation spend  21.020190000534058
after graph partition
graph partition algorithm spend time 21.14687180519104
46549
44392
partition_len_list
[69964, 99796]
shared_neighbor_graph_partition_s0 selection method  spend 21.231806755065918
time for parepare:  0.018620014190673828
local_output_nid generation:  0.00494694709777832
local_in_edges_tensor generation:  0.006819486618041992
mini_batch_src_global generation:  0.012434244155883789
r_  generation:  0.1271989345550537
local_output_nid generation:  0.006054401397705078
local_in_edges_tensor generation:  0.01021718978881836
mini_batch_src_global generation:  0.01579427719116211
r_  generation:  0.14663219451904297
----------------------check_connections_block total spend ----------------------------- 0.42590856552124023
generate_one_block  0.1599588394165039
generate_one_block  0.19461870193481445
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.048364877700805664
gen group dst list time:  0.004698514938354492
time for parepare:  0.02228522300720215
local_output_nid generation:  0.008696556091308594
local_in_edges_tensor generation:  0.025466442108154297
mini_batch_src_global generation:  0.014829397201538086
r_  generation:  0.1453838348388672
local_output_nid generation:  0.01346731185913086
local_in_edges_tensor generation:  0.016567707061767578
mini_batch_src_global generation:  0.024596214294433594
r_  generation:  0.24605202674865723
----------------------check_connections_block total spend ----------------------------- 0.6106770038604736
generate_one_block  0.17928409576416016
generate_one_block  0.31051063537597656
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  1.0365855693817139
block generation total time  0.8443722724914551
average batch blocks generation time:  0.42218613624572754
pseudo mini batch 0 input nodes size: 88604
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0623779296875 GB
    Memory Allocated: 0.0457463264465332  GigaBytes
Max Memory Allocated: 0.0457463264465332  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0623779296875 GB
    Memory Allocated: 0.04609346389770508  GigaBytes
Max Memory Allocated: 0.04609346389770508  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0623779296875 GB
    Memory Allocated: 0.04609346389770508  GigaBytes
Max Memory Allocated: 0.04609346389770508  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1463623046875 GB
    Memory Allocated: 0.05153989791870117  GigaBytes
Max Memory Allocated: 0.05153989791870117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1463623046875 GB
    Memory Allocated: 0.05153989791870117  GigaBytes
Max Memory Allocated: 0.05153989791870117  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1463623046875 GB
    Memory Allocated: 0.05153989791870117  GigaBytes
Max Memory Allocated: 0.05153989791870117  GigaBytes

torch.Size([88604, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1463623046875 GB
    Memory Allocated: 0.05153989791870117  GigaBytes
Max Memory Allocated: 0.05153989791870117  GigaBytes

m.shape torch.Size([8912, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4451904296875 GB
    Memory Allocated: 0.25049734115600586  GigaBytes
Max Memory Allocated: 0.2509307861328125  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4451904296875 GB
    Memory Allocated: 0.25049734115600586  GigaBytes
Max Memory Allocated: 0.2509307861328125  GigaBytes

 h.shape torch.Size([1, 8912, 128]), torch.Size([1, 8912, 128])
----------------------------------------3
 Nvidia-smi: 1.4647216796875 GB
    Memory Allocated: 0.25899648666381836  GigaBytes
Max Memory Allocated: 0.25899648666381836  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5389404296875 GB
    Memory Allocated: 0.32872915267944336  GigaBytes
Max Memory Allocated: 0.3329787254333496  GigaBytes

rst.shape  torch.Size([1, 8912, 128])
m.shape torch.Size([8809, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5389404296875 GB
    Memory Allocated: 0.33288049697875977  GigaBytes
Max Memory Allocated: 0.33307790756225586  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5389404296875 GB
    Memory Allocated: 0.33288049697875977  GigaBytes
Max Memory Allocated: 0.33307790756225586  GigaBytes

 h.shape torch.Size([1, 8809, 128]), torch.Size([1, 8809, 128])
----------------------------------------3
 Nvidia-smi: 1.5389404296875 GB
    Memory Allocated: 0.34133052825927734  GigaBytes
Max Memory Allocated: 0.34133052825927734  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.4720020294189453  GigaBytes
Max Memory Allocated: 0.48040294647216797  GigaBytes

rst.shape  torch.Size([1, 8809, 128])
m.shape torch.Size([7577, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.4786405563354492  GigaBytes
Max Memory Allocated: 0.48040294647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.4786405563354492  GigaBytes
Max Memory Allocated: 0.48040294647216797  GigaBytes

 h.shape torch.Size([1, 7577, 128]), torch.Size([1, 7577, 128])
----------------------------------------3
 Nvidia-smi: 1.7030029296875 GB
    Memory Allocated: 0.4858665466308594  GigaBytes
Max Memory Allocated: 0.4858665466308594  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8865966796875 GB
    Memory Allocated: 0.6448383331298828  GigaBytes
Max Memory Allocated: 0.655677318572998  GigaBytes

rst.shape  torch.Size([1, 7577, 128])
m.shape torch.Size([6288, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.8865966796875 GB
    Memory Allocated: 0.6535305976867676  GigaBytes
Max Memory Allocated: 0.655677318572998  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8865966796875 GB
    Memory Allocated: 0.6535305976867676  GigaBytes
Max Memory Allocated: 0.655677318572998  GigaBytes

 h.shape torch.Size([1, 6288, 128]), torch.Size([1, 6288, 128])
----------------------------------------3
 Nvidia-smi: 1.8865966796875 GB
    Memory Allocated: 0.6601419448852539  GigaBytes
Max Memory Allocated: 0.6601419448852539  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1014404296875 GB
    Memory Allocated: 0.8343582153320312  GigaBytes
Max Memory Allocated: 0.8463516235351562  GigaBytes

rst.shape  torch.Size([1, 6288, 128])
m.shape torch.Size([5246, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.1014404296875 GB
    Memory Allocated: 0.843867301940918  GigaBytes
Max Memory Allocated: 0.8463516235351562  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1014404296875 GB
    Memory Allocated: 0.843867301940918  GigaBytes
Max Memory Allocated: 0.8463516235351562  GigaBytes

 h.shape torch.Size([1, 5246, 128]), torch.Size([1, 5246, 128])
----------------------------------------3
 Nvidia-smi: 2.1014404296875 GB
    Memory Allocated: 0.8490805625915527  GigaBytes
Max Memory Allocated: 0.8490805625915527  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3123779296875 GB
    Memory Allocated: 1.0296435356140137  GigaBytes
Max Memory Allocated: 1.0421509742736816  GigaBytes

rst.shape  torch.Size([1, 5246, 128])
m.shape torch.Size([4312, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.3123779296875 GB
    Memory Allocated: 1.0394787788391113  GigaBytes
Max Memory Allocated: 1.0421509742736816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3123779296875 GB
    Memory Allocated: 1.0394787788391113  GigaBytes
Max Memory Allocated: 1.0421509742736816  GigaBytes

 h.shape torch.Size([1, 4312, 128]), torch.Size([1, 4312, 128])
----------------------------------------3
 Nvidia-smi: 2.3123779296875 GB
    Memory Allocated: 1.0441718101501465  GigaBytes
Max Memory Allocated: 1.0441718101501465  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5018310546875 GB
    Memory Allocated: 1.2211337089538574  GigaBytes
Max Memory Allocated: 1.2334704399108887  GigaBytes

rst.shape  torch.Size([1, 4312, 128])
m.shape torch.Size([3604, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.5018310546875 GB
    Memory Allocated: 1.231107234954834  GigaBytes
Max Memory Allocated: 1.2334704399108887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5018310546875 GB
    Memory Allocated: 1.231107234954834  GigaBytes
Max Memory Allocated: 1.2334704399108887  GigaBytes

 h.shape torch.Size([1, 3604, 128]), torch.Size([1, 3604, 128])
----------------------------------------3
 Nvidia-smi: 2.5018310546875 GB
    Memory Allocated: 1.2346701622009277  GigaBytes
Max Memory Allocated: 1.2346701622009277  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7166748046875 GB
    Memory Allocated: 1.4096722602844238  GigaBytes
Max Memory Allocated: 1.4223294258117676  GigaBytes

rst.shape  torch.Size([1, 3604, 128])
m.shape torch.Size([3162, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.7166748046875 GB
    Memory Allocated: 1.4206109046936035  GigaBytes
Max Memory Allocated: 1.4223294258117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7166748046875 GB
    Memory Allocated: 1.4206109046936035  GigaBytes
Max Memory Allocated: 1.4223294258117676  GigaBytes

 h.shape torch.Size([1, 3162, 128]), torch.Size([1, 3162, 128])
----------------------------------------3
 Nvidia-smi: 2.7166748046875 GB
    Memory Allocated: 1.423658847808838  GigaBytes
Max Memory Allocated: 1.423658847808838  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8865966796875 GB
    Memory Allocated: 1.5983624458312988  GigaBytes
Max Memory Allocated: 1.610424518585205  GigaBytes

rst.shape  torch.Size([1, 3162, 128])
m.shape torch.Size([2667, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.8865966796875 GB
    Memory Allocated: 1.6081981658935547  GigaBytes
Max Memory Allocated: 1.610424518585205  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8865966796875 GB
    Memory Allocated: 1.6081981658935547  GigaBytes
Max Memory Allocated: 1.610424518585205  GigaBytes

 h.shape torch.Size([1, 2667, 128]), torch.Size([1, 2667, 128])
----------------------------------------3
 Nvidia-smi: 2.8865966796875 GB
    Memory Allocated: 1.611074447631836  GigaBytes
Max Memory Allocated: 1.611074447631836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0350341796875 GB
    Memory Allocated: 1.7852320671081543  GigaBytes
Max Memory Allocated: 1.7969508171081543  GigaBytes

rst.shape  torch.Size([1, 2667, 128])
m.shape torch.Size([19387, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.1307373046875 GB
    Memory Allocated: 1.87595796585083  GigaBytes
Max Memory Allocated: 1.8783988952636719  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1307373046875 GB
    Memory Allocated: 1.87595796585083  GigaBytes
Max Memory Allocated: 1.8783988952636719  GigaBytes

 h.shape torch.Size([1, 9693, 128]), torch.Size([1, 9693, 128])
----------------------------------------3
 Nvidia-smi: 3.1307373046875 GB
    Memory Allocated: 1.8852019309997559  GigaBytes
Max Memory Allocated: 1.8852019309997559  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8807373046875 GB
    Memory Allocated: 2.5415234565734863  GigaBytes
Max Memory Allocated: 2.5883984565734863  GigaBytes

rst 0 shape torch.Size([1, 9693, 128])
----------------------------------------1
 Nvidia-smi: 3.8807373046875 GB
    Memory Allocated: 2.5415234565734863  GigaBytes
Max Memory Allocated: 2.5883984565734863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8807373046875 GB
    Memory Allocated: 2.5415234565734863  GigaBytes
Max Memory Allocated: 2.5883984565734863  GigaBytes

 h.shape torch.Size([1, 9694, 128]), torch.Size([1, 9694, 128])
----------------------------------------3
 Nvidia-smi: 3.8807373046875 GB
    Memory Allocated: 2.5507683753967285  GigaBytes
Max Memory Allocated: 2.5883984565734863  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5721435546875 GB
    Memory Allocated: 3.20318603515625  GigaBytes
Max Memory Allocated: 3.254683017730713  GigaBytes

rst 1 shape torch.Size([1, 9694, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.6424560546875 GB
    Memory Allocated: 3.0405192375183105  GigaBytes
Max Memory Allocated: 3.299051284790039  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.6424560546875 GB
    Memory Allocated: 3.1072421073913574  GigaBytes
Max Memory Allocated: 3.299051284790039  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7108154296875 GB
    Memory Allocated: 3.1739649772644043  GigaBytes
Max Memory Allocated: 3.299051284790039  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.7108154296875 GB
    Memory Allocated: 3.106720447540283  GigaBytes
Max Memory Allocated: 3.299051284790039  GigaBytes

torch.Size([69964, 256])
first layer input nodes number: 88604
first layer output nodes number: 69964
edges number: 394912
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.7108154296875 GB
    Memory Allocated: 3.1746273040771484  GigaBytes
Max Memory Allocated: 3.299051284790039  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.7108154296875 GB
    Memory Allocated: 3.2413501739501953  GigaBytes
Max Memory Allocated: 3.299051284790039  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 3.258030891418457  GigaBytes
Max Memory Allocated: 3.324753761291504  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.7791748046875 GB
    Memory Allocated: 3.258030891418457  GigaBytes
Max Memory Allocated: 3.324753761291504  GigaBytes

m.shape torch.Size([6966, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.1014404296875 GB
    Memory Allocated: 3.5898385047912598  GigaBytes
Max Memory Allocated: 3.589864730834961  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1014404296875 GB
    Memory Allocated: 3.5898385047912598  GigaBytes
Max Memory Allocated: 3.589864730834961  GigaBytes

 h.shape torch.Size([1, 6966, 256]), torch.Size([1, 6966, 256])
----------------------------------------3
 Nvidia-smi: 5.1014404296875 GB
    Memory Allocated: 3.6031250953674316  GigaBytes
Max Memory Allocated: 3.6031250953674316  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1014404296875 GB
    Memory Allocated: 3.7094178199768066  GigaBytes
Max Memory Allocated: 3.7160611152648926  GigaBytes

rst.shape  torch.Size([1, 6966, 256])
m.shape torch.Size([6305, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.1014404296875 GB
    Memory Allocated: 3.7148947715759277  GigaBytes
Max Memory Allocated: 3.7160611152648926  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1014404296875 GB
    Memory Allocated: 3.7148947715759277  GigaBytes
Max Memory Allocated: 3.7160611152648926  GigaBytes

 h.shape torch.Size([1, 6305, 256]), torch.Size([1, 6305, 256])
----------------------------------------3
 Nvidia-smi: 5.1014404296875 GB
    Memory Allocated: 3.7269206047058105  GigaBytes
Max Memory Allocated: 3.7269206047058105  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3065185546875 GB
    Memory Allocated: 3.9073081016540527  GigaBytes
Max Memory Allocated: 3.9193339347839355  GigaBytes

rst.shape  torch.Size([1, 6305, 256])
m.shape torch.Size([5163, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.3221435546875 GB
    Memory Allocated: 3.9170360565185547  GigaBytes
Max Memory Allocated: 3.9193339347839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3221435546875 GB
    Memory Allocated: 3.9170360565185547  GigaBytes
Max Memory Allocated: 3.9193339347839355  GigaBytes

 h.shape torch.Size([1, 5163, 256]), torch.Size([1, 5163, 256])
----------------------------------------3
 Nvidia-smi: 5.3221435546875 GB
    Memory Allocated: 3.927267074584961  GigaBytes
Max Memory Allocated: 3.927267074584961  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5701904296875 GB
    Memory Allocated: 4.143915176391602  GigaBytes
Max Memory Allocated: 4.159540176391602  GigaBytes

rst.shape  torch.Size([1, 5163, 256])
m.shape torch.Size([4110, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.5877685546875 GB
    Memory Allocated: 4.154792308807373  GigaBytes
Max Memory Allocated: 4.159540176391602  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5877685546875 GB
    Memory Allocated: 4.154792308807373  GigaBytes
Max Memory Allocated: 4.159540176391602  GigaBytes

 h.shape torch.Size([1, 4110, 256]), torch.Size([1, 4110, 256])
----------------------------------------3
 Nvidia-smi: 5.5877685546875 GB
    Memory Allocated: 4.163057327270508  GigaBytes
Max Memory Allocated: 4.163057327270508  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 4.393530368804932  GigaBytes
Max Memory Allocated: 4.40920877456665  GigaBytes

rst.shape  torch.Size([1, 4110, 256])
m.shape torch.Size([3372, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 4.4054646492004395  GigaBytes
Max Memory Allocated: 4.40920877456665  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 4.4054646492004395  GigaBytes
Max Memory Allocated: 4.40920877456665  GigaBytes

 h.shape torch.Size([1, 3372, 256]), torch.Size([1, 3372, 256])
----------------------------------------3
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 4.412720680236816  GigaBytes
Max Memory Allocated: 4.412720680236816  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0506591796875 GB
    Memory Allocated: 4.65366268157959  GigaBytes
Max Memory Allocated: 4.669978141784668  GigaBytes

rst.shape  torch.Size([1, 3372, 256])
m.shape torch.Size([2717, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.0506591796875 GB
    Memory Allocated: 4.666883945465088  GigaBytes
Max Memory Allocated: 4.669978141784668  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0506591796875 GB
    Memory Allocated: 4.666883945465088  GigaBytes
Max Memory Allocated: 4.669978141784668  GigaBytes

 h.shape torch.Size([1, 2717, 256]), torch.Size([1, 2717, 256])
----------------------------------------3
 Nvidia-smi: 6.0506591796875 GB
    Memory Allocated: 4.672085762023926  GigaBytes
Max Memory Allocated: 4.672085762023926  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3006591796875 GB
    Memory Allocated: 4.896269798278809  GigaBytes
Max Memory Allocated: 4.911894798278809  GigaBytes

rst.shape  torch.Size([1, 2717, 256])
m.shape torch.Size([2263, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.3006591796875 GB
    Memory Allocated: 4.909421920776367  GigaBytes
Max Memory Allocated: 4.911894798278809  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3006591796875 GB
    Memory Allocated: 4.909421920776367  GigaBytes
Max Memory Allocated: 4.911894798278809  GigaBytes

 h.shape torch.Size([1, 2263, 256]), torch.Size([1, 2263, 256])
----------------------------------------3
 Nvidia-smi: 6.3006591796875 GB
    Memory Allocated: 4.914123058319092  GigaBytes
Max Memory Allocated: 4.914123058319092  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5311279296875 GB
    Memory Allocated: 5.133141040802002  GigaBytes
Max Memory Allocated: 5.148766040802002  GigaBytes

rst.shape  torch.Size([1, 2263, 256])
m.shape torch.Size([1934, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.5311279296875 GB
    Memory Allocated: 5.146313190460205  GigaBytes
Max Memory Allocated: 5.148766040802002  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5311279296875 GB
    Memory Allocated: 5.146313190460205  GigaBytes
Max Memory Allocated: 5.148766040802002  GigaBytes

 h.shape torch.Size([1, 1934, 256]), torch.Size([1, 1934, 256])
----------------------------------------3
 Nvidia-smi: 6.5311279296875 GB
    Memory Allocated: 5.150059223175049  GigaBytes
Max Memory Allocated: 5.150059223175049  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7615966796875 GB
    Memory Allocated: 5.362380504608154  GigaBytes
Max Memory Allocated: 5.378005504608154  GigaBytes

rst.shape  torch.Size([1, 1934, 256])
m.shape torch.Size([1637, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.7615966796875 GB
    Memory Allocated: 5.374696731567383  GigaBytes
Max Memory Allocated: 5.378005504608154  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7615966796875 GB
    Memory Allocated: 5.374696731567383  GigaBytes
Max Memory Allocated: 5.378005504608154  GigaBytes

 h.shape torch.Size([1, 1637, 256]), torch.Size([1, 1637, 256])
----------------------------------------3
 Nvidia-smi: 6.7615966796875 GB
    Memory Allocated: 5.377907752990723  GigaBytes
Max Memory Allocated: 5.378005504608154  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9530029296875 GB
    Memory Allocated: 5.588013648986816  GigaBytes
Max Memory Allocated: 5.60206413269043  GigaBytes

rst.shape  torch.Size([1, 1637, 256])
m.shape torch.Size([1443, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.9530029296875 GB
    Memory Allocated: 5.600308418273926  GigaBytes
Max Memory Allocated: 5.60206413269043  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9530029296875 GB
    Memory Allocated: 5.600308418273926  GigaBytes
Max Memory Allocated: 5.60206413269043  GigaBytes

 h.shape torch.Size([1, 1443, 256]), torch.Size([1, 1443, 256])
----------------------------------------3
 Nvidia-smi: 6.9530029296875 GB
    Memory Allocated: 5.603095054626465  GigaBytes
Max Memory Allocated: 5.603095054626465  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1639404296875 GB
    Memory Allocated: 5.8021087646484375  GigaBytes
Max Memory Allocated: 5.81587028503418  GigaBytes

rst.shape  torch.Size([1, 1443, 256])
m.shape torch.Size([1212, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.1639404296875 GB
    Memory Allocated: 5.813281536102295  GigaBytes
Max Memory Allocated: 5.81587028503418  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1639404296875 GB
    Memory Allocated: 5.813281536102295  GigaBytes
Max Memory Allocated: 5.81587028503418  GigaBytes

 h.shape torch.Size([1, 1212, 256]), torch.Size([1, 1212, 256])
----------------------------------------3
 Nvidia-smi: 7.1639404296875 GB
    Memory Allocated: 5.815627574920654  GigaBytes
Max Memory Allocated: 5.81587028503418  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3143310546875 GB
    Memory Allocated: 6.000497341156006  GigaBytes
Max Memory Allocated: 6.014169216156006  GigaBytes

rst.shape  torch.Size([1, 1212, 256])
m.shape torch.Size([1018, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.3143310546875 GB
    Memory Allocated: 6.0108842849731445  GigaBytes
Max Memory Allocated: 6.014169216156006  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3143310546875 GB
    Memory Allocated: 6.0108842849731445  GigaBytes
Max Memory Allocated: 6.014169216156006  GigaBytes

 h.shape torch.Size([1, 1018, 256]), torch.Size([1, 1018, 256])
----------------------------------------3
 Nvidia-smi: 7.3162841796875 GB
    Memory Allocated: 6.012825965881348  GigaBytes
Max Memory Allocated: 6.014169216156006  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4901123046875 GB
    Memory Allocated: 6.178555488586426  GigaBytes
Max Memory Allocated: 6.190274238586426  GigaBytes

rst.shape  torch.Size([1, 1018, 256])
m.shape torch.Size([887, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.4901123046875 GB
    Memory Allocated: 6.189389705657959  GigaBytes
Max Memory Allocated: 6.190274238586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4901123046875 GB
    Memory Allocated: 6.189389705657959  GigaBytes
Max Memory Allocated: 6.190274238586426  GigaBytes

 h.shape torch.Size([1, 887, 256]), torch.Size([1, 887, 256])
----------------------------------------3
 Nvidia-smi: 7.4901123046875 GB
    Memory Allocated: 6.191081523895264  GigaBytes
Max Memory Allocated: 6.191081523895264  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6854248046875 GB
    Memory Allocated: 6.3473429679870605  GigaBytes
Max Memory Allocated: 6.3590617179870605  GigaBytes

rst.shape  torch.Size([1, 887, 256])
m.shape torch.Size([765, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.6854248046875 GB
    Memory Allocated: 6.356791019439697  GigaBytes
Max Memory Allocated: 6.3590617179870605  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6854248046875 GB
    Memory Allocated: 6.356791019439697  GigaBytes
Max Memory Allocated: 6.3590617179870605  GigaBytes

 h.shape torch.Size([1, 765, 256]), torch.Size([1, 765, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 6.358250141143799  GigaBytes
Max Memory Allocated: 6.3590617179870605  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8533935546875 GB
    Memory Allocated: 6.503427982330322  GigaBytes
Max Memory Allocated: 6.513641834259033  GigaBytes

rst.shape  torch.Size([1, 765, 256])
m.shape torch.Size([679, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.8533935546875 GB
    Memory Allocated: 6.512487888336182  GigaBytes
Max Memory Allocated: 6.513641834259033  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8533935546875 GB
    Memory Allocated: 6.512487888336182  GigaBytes
Max Memory Allocated: 6.513641834259033  GigaBytes

 h.shape torch.Size([1, 679, 256]), torch.Size([1, 679, 256])
----------------------------------------3
 Nvidia-smi: 7.8533935546875 GB
    Memory Allocated: 6.513782978057861  GigaBytes
Max Memory Allocated: 6.513782978057861  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9920654296875 GB
    Memory Allocated: 6.6512227058410645  GigaBytes
Max Memory Allocated: 6.660935878753662  GigaBytes

rst.shape  torch.Size([1, 679, 256])
m.shape torch.Size([540, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.9920654296875 GB
    Memory Allocated: 6.658879280090332  GigaBytes
Max Memory Allocated: 6.660935878753662  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9920654296875 GB
    Memory Allocated: 6.658879280090332  GigaBytes
Max Memory Allocated: 6.660935878753662  GigaBytes

 h.shape torch.Size([1, 540, 256]), torch.Size([1, 540, 256])
----------------------------------------3
 Nvidia-smi: 7.9920654296875 GB
    Memory Allocated: 6.659909248352051  GigaBytes
Max Memory Allocated: 6.660935878753662  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1307373046875 GB
    Memory Allocated: 6.7767534255981445  GigaBytes
Max Memory Allocated: 6.7849931716918945  GigaBytes

rst.shape  torch.Size([1, 540, 256])
m.shape torch.Size([521, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.1307373046875 GB
    Memory Allocated: 6.7847514152526855  GigaBytes
Max Memory Allocated: 6.7849931716918945  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1307373046875 GB
    Memory Allocated: 6.7847514152526855  GigaBytes
Max Memory Allocated: 6.7849931716918945  GigaBytes

 h.shape torch.Size([1, 521, 256]), torch.Size([1, 521, 256])
----------------------------------------3
 Nvidia-smi: 8.1307373046875 GB
    Memory Allocated: 6.785745143890381  GigaBytes
Max Memory Allocated: 6.785745143890381  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.2518310546875 GB
    Memory Allocated: 6.905236721038818  GigaBytes
Max Memory Allocated: 6.9136834144592285  GigaBytes

rst.shape  torch.Size([1, 521, 256])
m.shape torch.Size([440, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.2518310546875 GB
    Memory Allocated: 6.912352085113525  GigaBytes
Max Memory Allocated: 6.9136834144592285  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.2518310546875 GB
    Memory Allocated: 6.912352085113525  GigaBytes
Max Memory Allocated: 6.9136834144592285  GigaBytes

 h.shape torch.Size([1, 440, 256]), torch.Size([1, 440, 256])
----------------------------------------3
 Nvidia-smi: 8.2518310546875 GB
    Memory Allocated: 6.913191318511963  GigaBytes
Max Memory Allocated: 6.9136834144592285  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3553466796875 GB
    Memory Allocated: 7.019773960113525  GigaBytes
Max Memory Allocated: 7.027327060699463  GigaBytes

rst.shape  torch.Size([1, 440, 256])
m.shape torch.Size([379, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.3553466796875 GB
    Memory Allocated: 7.026275634765625  GigaBytes
Max Memory Allocated: 7.027327060699463  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3553466796875 GB
    Memory Allocated: 7.026275634765625  GigaBytes
Max Memory Allocated: 7.027327060699463  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 8.3553466796875 GB
    Memory Allocated: 7.026998519897461  GigaBytes
Max Memory Allocated: 7.027327060699463  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4666748046875 GB
    Memory Allocated: 7.127121925354004  GigaBytes
Max Memory Allocated: 7.133989334106445  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([375, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.4666748046875 GB
    Memory Allocated: 7.133969306945801  GigaBytes
Max Memory Allocated: 7.133997440338135  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4666748046875 GB
    Memory Allocated: 7.133969306945801  GigaBytes
Max Memory Allocated: 7.133997440338135  GigaBytes

 h.shape torch.Size([1, 375, 256]), torch.Size([1, 375, 256])
----------------------------------------3
 Nvidia-smi: 8.4666748046875 GB
    Memory Allocated: 7.1346845626831055  GigaBytes
Max Memory Allocated: 7.1346845626831055  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5799560546875 GB
    Memory Allocated: 7.2400407791137695  GigaBytes
Max Memory Allocated: 7.247193336486816  GigaBytes

rst.shape  torch.Size([1, 375, 256])
m.shape torch.Size([333, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.5799560546875 GB
    Memory Allocated: 7.246404647827148  GigaBytes
Max Memory Allocated: 7.247193336486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5799560546875 GB
    Memory Allocated: 7.246404647827148  GigaBytes
Max Memory Allocated: 7.247193336486816  GigaBytes

 h.shape torch.Size([1, 333, 256]), torch.Size([1, 333, 256])
----------------------------------------3
 Nvidia-smi: 8.5799560546875 GB
    Memory Allocated: 7.247039794921875  GigaBytes
Max Memory Allocated: 7.247193336486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6541748046875 GB
    Memory Allocated: 7.343362808227539  GigaBytes
Max Memory Allocated: 7.350031852722168  GigaBytes

rst.shape  torch.Size([1, 333, 256])
m.shape torch.Size([261, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.6541748046875 GB
    Memory Allocated: 7.348564147949219  GigaBytes
Max Memory Allocated: 7.350031852722168  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6541748046875 GB
    Memory Allocated: 7.348564147949219  GigaBytes
Max Memory Allocated: 7.350031852722168  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 8.6541748046875 GB
    Memory Allocated: 7.349061965942383  GigaBytes
Max Memory Allocated: 7.350031852722168  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6815185546875 GB
    Memory Allocated: 7.429137229919434  GigaBytes
Max Memory Allocated: 7.434613227844238  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([242, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.6815185546875 GB
    Memory Allocated: 7.434237957000732  GigaBytes
Max Memory Allocated: 7.434613227844238  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6815185546875 GB
    Memory Allocated: 7.434237957000732  GigaBytes
Max Memory Allocated: 7.434613227844238  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 8.6815185546875 GB
    Memory Allocated: 7.434699535369873  GigaBytes
Max Memory Allocated: 7.434699535369873  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7596435546875 GB
    Memory Allocated: 7.509475231170654  GigaBytes
Max Memory Allocated: 7.5147833824157715  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([227, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.7596435546875 GB
    Memory Allocated: 7.514481067657471  GigaBytes
Max Memory Allocated: 7.5147833824157715  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7596435546875 GB
    Memory Allocated: 7.514481067657471  GigaBytes
Max Memory Allocated: 7.5147833824157715  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 8.7615966796875 GB
    Memory Allocated: 7.514914035797119  GigaBytes
Max Memory Allocated: 7.514914035797119  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8338623046875 GB
    Memory Allocated: 7.588085651397705  GigaBytes
Max Memory Allocated: 7.593281269073486  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([2760, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.9022216796875 GB
    Memory Allocated: 7.654789924621582  GigaBytes
Max Memory Allocated: 7.655047416687012  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.9022216796875 GB
    Memory Allocated: 7.654789924621582  GigaBytes
Max Memory Allocated: 7.655047416687012  GigaBytes

 h.shape torch.Size([1, 2760, 256]), torch.Size([1, 2760, 256])
----------------------------------------3
 Nvidia-smi: 8.9022216796875 GB
    Memory Allocated: 7.6600542068481445  GigaBytes
Max Memory Allocated: 7.6600542068481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9920654296875 GB
    Memory Allocated: 8.586567878723145  GigaBytes
Max Memory Allocated: 8.652974128723145  GigaBytes

rst.shape  torch.Size([1, 2760, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.0819091796875 GB
    Memory Allocated: 8.306777000427246  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.0819091796875 GB
    Memory Allocated: 8.313879013061523  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.0819091796875 GB
    Memory Allocated: 8.320815563201904  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.0819091796875 GB
    Memory Allocated: 8.313366413116455  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

torch.Size([46549, 40])
input nodes number: 69964
output nodes number: 46549
edges number: 335984
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0819091796875 GB
    Memory Allocated: 8.321171760559082  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.0819091796875 GB
    Memory Allocated: 8.321172714233398  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 0.07407522201538086  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

pseudo mini batch 1 input nodes size: 122695
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 0.05580615997314453  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 0.05580615997314453  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 0.11431169509887695  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 0.11464262008666992  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 0.07132673263549805  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 0.07958078384399414  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 0.07958078384399414  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 0.07958078384399414  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

torch.Size([122695, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7342529296875 GB
    Memory Allocated: 0.07958078384399414  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

m.shape torch.Size([8606, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 0.42345571517944336  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 0.42345571517944336  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

 h.shape torch.Size([1, 8606, 128]), torch.Size([1, 8606, 128])
----------------------------------------3
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 0.43166303634643555  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 0.49732160568237305  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

rst.shape  torch.Size([1, 8606, 128])
m.shape torch.Size([8498, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 0.5013222694396973  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 0.5013222694396973  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

 h.shape torch.Size([1, 8498, 128]), torch.Size([1, 8498, 128])
----------------------------------------3
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 0.5094265937805176  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 0.6309914588928223  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

rst.shape  torch.Size([1, 8498, 128])
m.shape torch.Size([7256, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 0.6373190879821777  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 0.6373190879821777  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

 h.shape torch.Size([1, 7256, 128]), torch.Size([1, 7256, 128])
----------------------------------------3
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 0.6443419456481934  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 0.7986388206481934  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

rst.shape  torch.Size([1, 7256, 128])
m.shape torch.Size([6283, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 0.8071627616882324  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 0.8071627616882324  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

 h.shape torch.Size([1, 6283, 128]), torch.Size([1, 6283, 128])
----------------------------------------3
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 0.8136186599731445  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 0.9873847961425781  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

rst.shape  torch.Size([1, 6283, 128])
m.shape torch.Size([5623, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 0.9980607032775879  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 0.9980607032775879  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

 h.shape torch.Size([1, 5623, 128]), torch.Size([1, 5623, 128])
----------------------------------------3
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 1.0035223960876465  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 1.1973013877868652  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

rst.shape  torch.Size([1, 5623, 128])
m.shape torch.Size([4778, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 1.208292007446289  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 1.208292007446289  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

 h.shape torch.Size([1, 4778, 128]), torch.Size([1, 4778, 128])
----------------------------------------3
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 1.213252067565918  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 1.4137678146362305  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

rst.shape  torch.Size([1, 4778, 128])
m.shape torch.Size([4328, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 1.4256086349487305  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 1.4256086349487305  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

 h.shape torch.Size([1, 4328, 128]), torch.Size([1, 4328, 128])
----------------------------------------3
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 1.4308195114135742  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 1.638819694519043  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

rst.shape  torch.Size([1, 4328, 128])
m.shape torch.Size([3920, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 1.6523809432983398  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 1.6523809432983398  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

 h.shape torch.Size([1, 3920, 128]), torch.Size([1, 3920, 128])
----------------------------------------3
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 1.6561193466186523  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 1.8717260360717773  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

rst.shape  torch.Size([1, 3920, 128])
m.shape torch.Size([3528, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 1.8849782943725586  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 1.8849782943725586  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

 h.shape torch.Size([1, 3528, 128]), torch.Size([1, 3528, 128])
----------------------------------------3
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 1.8883543014526367  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 2.1059579849243164  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

rst.shape  torch.Size([1, 3528, 128])
m.shape torch.Size([46976, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 2.328171730041504  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 2.328171730041504  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

 h.shape torch.Size([1, 23488, 128]), torch.Size([1, 23488, 128])
----------------------------------------3
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 2.350571632385254  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.2283935546875 GB
    Memory Allocated: 3.941330909729004  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

rst 0 shape torch.Size([1, 23488, 128])
----------------------------------------1
 Nvidia-smi: 11.2283935546875 GB
    Memory Allocated: 3.941330909729004  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.2283935546875 GB
    Memory Allocated: 3.941330909729004  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

 h.shape torch.Size([1, 23488, 128]), torch.Size([1, 23488, 128])
----------------------------------------3
 Nvidia-smi: 11.2283935546875 GB
    Memory Allocated: 3.963730812072754  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5994873046875 GB
    Memory Allocated: 5.546341896057129  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

rst 1 shape torch.Size([1, 23488, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.6483154296875 GB
    Memory Allocated: 5.2494988441467285  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.6483154296875 GB
    Memory Allocated: 5.344671726226807  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.6483154296875 GB
    Memory Allocated: 5.439844608306885  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.6483154296875 GB
    Memory Allocated: 5.34392786026001  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

torch.Size([99796, 256])
first layer input nodes number: 122695
first layer output nodes number: 99796
edges number: 692453
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 12.6483154296875 GB
    Memory Allocated: 5.440761089324951  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.6483154296875 GB
    Memory Allocated: 5.535933971405029  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.7440185546875 GB
    Memory Allocated: 5.560257434844971  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.7440185546875 GB
    Memory Allocated: 5.560257434844971  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

m.shape torch.Size([6462, 1, 256])
----------------------------------------1
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 5.960714340209961  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 5.960714340209961  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

 h.shape torch.Size([1, 6462, 256]), torch.Size([1, 6462, 256])
----------------------------------------3
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 5.973104476928711  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 6.074789047241211  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

rst.shape  torch.Size([1, 6462, 256])
m.shape torch.Size([5401, 2, 256])
----------------------------------------1
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 6.07934045791626  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 6.07934045791626  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

 h.shape torch.Size([1, 5401, 256]), torch.Size([1, 5401, 256])
----------------------------------------3
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 6.08964204788208  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 6.249453067779541  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

rst.shape  torch.Size([1, 5401, 256])
m.shape torch.Size([4114, 3, 256])
----------------------------------------1
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 6.25616455078125  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 6.25616455078125  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

 h.shape torch.Size([1, 4114, 256]), torch.Size([1, 4114, 256])
----------------------------------------3
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 6.264320373535156  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 6.4388837814331055  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

rst.shape  torch.Size([1, 4114, 256])
m.shape torch.Size([3210, 4, 256])
----------------------------------------1
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 6.4469828605651855  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 6.4469828605651855  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

 h.shape torch.Size([1, 3210, 256]), torch.Size([1, 3210, 256])
----------------------------------------3
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 6.453627109527588  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 6.638782501220703  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

rst.shape  torch.Size([1, 3210, 256])
m.shape torch.Size([2850, 5, 256])
----------------------------------------1
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 6.648641109466553  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 6.648641109466553  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

 h.shape torch.Size([1, 2850, 256]), torch.Size([1, 2850, 256])
----------------------------------------3
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 6.654355049133301  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 6.850049018859863  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

rst.shape  torch.Size([1, 2850, 256])
m.shape torch.Size([2151, 6, 256])
----------------------------------------1
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 6.859735488891602  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 6.859735488891602  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

 h.shape torch.Size([1, 2151, 256]), torch.Size([1, 2151, 256])
----------------------------------------3
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 6.863885879516602  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 7.044346809387207  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

rst.shape  torch.Size([1, 2151, 256])
m.shape torch.Size([1782, 7, 256])
----------------------------------------1
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 7.054145336151123  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 7.054145336151123  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

 h.shape torch.Size([1, 1782, 256]), torch.Size([1, 1782, 256])
----------------------------------------3
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 7.057715892791748  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 7.237216472625732  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

rst.shape  torch.Size([1, 1782, 256])
m.shape torch.Size([1538, 8, 256])
----------------------------------------1
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 7.247505187988281  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 7.247505187988281  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

 h.shape torch.Size([1, 1538, 256]), torch.Size([1, 1538, 256])
----------------------------------------3
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 7.250553131103516  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 7.419069290161133  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

rst.shape  torch.Size([1, 1538, 256])
m.shape torch.Size([1339, 9, 256])
----------------------------------------1
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 7.429057598114014  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 7.429057598114014  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

 h.shape torch.Size([1, 1339, 256]), torch.Size([1, 1339, 256])
----------------------------------------3
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 7.431766033172607  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 7.598342418670654  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

rst.shape  torch.Size([1, 1339, 256])
m.shape torch.Size([1156, 10, 256])
----------------------------------------1
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 7.607858657836914  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 7.607858657836914  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

 h.shape torch.Size([1, 1156, 256]), torch.Size([1, 1156, 256])
----------------------------------------3
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 7.610141754150391  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 7.775444984436035  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

rst.shape  torch.Size([1, 1156, 256])
m.shape torch.Size([991, 11, 256])
----------------------------------------1
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 7.784030437469482  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 7.784030437469482  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

 h.shape torch.Size([1, 991, 256]), torch.Size([1, 991, 256])
----------------------------------------3
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 7.7859206199646  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 7.940124988555908  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

rst.shape  torch.Size([1, 991, 256])
m.shape torch.Size([919, 12, 256])
----------------------------------------1
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 7.949779510498047  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 7.949779510498047  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

 h.shape torch.Size([1, 919, 256]), torch.Size([1, 919, 256])
----------------------------------------3
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 7.951532363891602  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 8.10158920288086  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

rst.shape  torch.Size([1, 919, 256])
m.shape torch.Size([769, 13, 256])
----------------------------------------1
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 8.110321521759033  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 8.110321521759033  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

 h.shape torch.Size([1, 769, 256]), torch.Size([1, 769, 256])
----------------------------------------3
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 8.111788272857666  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 8.247028827667236  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

rst.shape  torch.Size([1, 769, 256])
m.shape torch.Size([669, 14, 256])
----------------------------------------1
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 8.255297660827637  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 8.255297660827637  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

 h.shape torch.Size([1, 669, 256]), torch.Size([1, 669, 256])
----------------------------------------3
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 8.256573677062988  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 8.387273788452148  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

rst.shape  torch.Size([1, 669, 256])
m.shape torch.Size([610, 15, 256])
----------------------------------------1
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 8.395430088043213  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 8.395430088043213  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

 h.shape torch.Size([1, 610, 256]), torch.Size([1, 610, 256])
----------------------------------------3
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 8.396593570709229  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 8.524683475494385  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

rst.shape  torch.Size([1, 610, 256])
m.shape torch.Size([571, 16, 256])
----------------------------------------1
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 8.532882690429688  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 8.532882690429688  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

 h.shape torch.Size([1, 571, 256]), torch.Size([1, 571, 256])
----------------------------------------3
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 8.533971786499023  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 8.657173156738281  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

rst.shape  torch.Size([1, 571, 256])
m.shape torch.Size([509, 17, 256])
----------------------------------------1
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 8.664945602416992  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 8.664945602416992  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

 h.shape torch.Size([1, 509, 256]), torch.Size([1, 509, 256])
----------------------------------------3
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 8.665916442871094  GigaBytes
Max Memory Allocated: 8.718361854553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 8.784647941589355  GigaBytes
Max Memory Allocated: 8.792900085449219  GigaBytes

rst.shape  torch.Size([1, 509, 256])
m.shape torch.Size([508, 18, 256])
----------------------------------------1
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 8.792951107025146  GigaBytes
Max Memory Allocated: 8.792985439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 8.792951107025146  GigaBytes
Max Memory Allocated: 8.792985439300537  GigaBytes

 h.shape torch.Size([1, 508, 256]), torch.Size([1, 508, 256])
----------------------------------------3
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 8.793920040130615  GigaBytes
Max Memory Allocated: 8.793920040130615  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 8.917710781097412  GigaBytes
Max Memory Allocated: 8.92643117904663  GigaBytes

rst.shape  torch.Size([1, 508, 256])
m.shape torch.Size([457, 19, 256])
----------------------------------------1
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 8.925571918487549  GigaBytes
Max Memory Allocated: 8.92643117904663  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 8.925571918487549  GigaBytes
Max Memory Allocated: 8.92643117904663  GigaBytes

 h.shape torch.Size([1, 457, 256]), torch.Size([1, 457, 256])
----------------------------------------3
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 8.926443576812744  GigaBytes
Max Memory Allocated: 8.926443576812744  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 9.047114849090576  GigaBytes
Max Memory Allocated: 9.055395603179932  GigaBytes

rst.shape  torch.Size([1, 457, 256])
m.shape torch.Size([432, 20, 256])
----------------------------------------1
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 9.054983139038086  GigaBytes
Max Memory Allocated: 9.055395603179932  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 9.054983139038086  GigaBytes
Max Memory Allocated: 9.055395603179932  GigaBytes

 h.shape torch.Size([1, 432, 256]), torch.Size([1, 432, 256])
----------------------------------------3
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 9.055807113647461  GigaBytes
Max Memory Allocated: 9.055807113647461  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 9.172685623168945  GigaBytes
Max Memory Allocated: 9.180925369262695  GigaBytes

rst.shape  torch.Size([1, 432, 256])
m.shape torch.Size([384, 21, 256])
----------------------------------------1
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 9.180024147033691  GigaBytes
Max Memory Allocated: 9.180925369262695  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 9.180024147033691  GigaBytes
Max Memory Allocated: 9.180925369262695  GigaBytes

 h.shape torch.Size([1, 384, 256]), torch.Size([1, 384, 256])
----------------------------------------3
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 9.180756568908691  GigaBytes
Max Memory Allocated: 9.180925369262695  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 9.29199504852295  GigaBytes
Max Memory Allocated: 9.29968547821045  GigaBytes

rst.shape  torch.Size([1, 384, 256])
m.shape torch.Size([295, 22, 256])
----------------------------------------1
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 9.297866821289062  GigaBytes
Max Memory Allocated: 9.29968547821045  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 9.297866821289062  GigaBytes
Max Memory Allocated: 9.29968547821045  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 9.298429489135742  GigaBytes
Max Memory Allocated: 9.29968547821045  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 9.389145851135254  GigaBytes
Max Memory Allocated: 9.39533519744873  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([277, 23, 256])
----------------------------------------1
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 9.394988059997559  GigaBytes
Max Memory Allocated: 9.39533519744873  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 9.394988059997559  GigaBytes
Max Memory Allocated: 9.39533519744873  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 9.395516395568848  GigaBytes
Max Memory Allocated: 9.395516395568848  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 9.482999801635742  GigaBytes
Max Memory Allocated: 9.489075660705566  GigaBytes

rst.shape  torch.Size([1, 277, 256])
m.shape torch.Size([298, 24, 256])
----------------------------------------1
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 9.489609718322754  GigaBytes
Max Memory Allocated: 9.489636421203613  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 9.489609718322754  GigaBytes
Max Memory Allocated: 9.489636421203613  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 9.490178108215332  GigaBytes
Max Memory Allocated: 9.490178108215332  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 9.587986946105957  GigaBytes
Max Memory Allocated: 9.594807624816895  GigaBytes
[04:42:04] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28846524 edges into 2 parts and get 185409 edge cuts

rst.shape  torch.Size([1, 298, 256])
m.shape torch.Size([6700, 25, 256])
----------------------------------------1
 Nvidia-smi: 13.2947998046875 GB
    Memory Allocated: 9.749107360839844  GigaBytes
Max Memory Allocated: 9.749731540679932  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.2947998046875 GB
    Memory Allocated: 9.749107360839844  GigaBytes
Max Memory Allocated: 9.749731540679932  GigaBytes

 h.shape torch.Size([1, 6700, 256]), torch.Size([1, 6700, 256])
----------------------------------------3
 Nvidia-smi: 13.2947998046875 GB
    Memory Allocated: 9.761886596679688  GigaBytes
Max Memory Allocated: 9.761886596679688  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2596435546875 GB
    Memory Allocated: 12.016105651855469  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 6700, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.2596435546875 GB
    Memory Allocated: 11.659308910369873  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.2596435546875 GB
    Memory Allocated: 11.665924072265625  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.2596435546875 GB
    Memory Allocated: 11.672539234161377  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.2596435546875 GB
    Memory Allocated: 11.665593147277832  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

torch.Size([44392, 40])
input nodes number: 99796
output nodes number: 44392
edges number: 408266
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2596435546875 GB
    Memory Allocated: 11.666346549987793  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.2596435546875 GB
    Memory Allocated: 11.666347026824951  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.09443950653076172  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.0999898910522461  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.0999898910522461  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05714118480682373 |0.1660151481628418 |0.45348477363586426 |0.0001437664031982422 |0.16640400886535645 |0.00566554069519043 |
----------------------------------------------------------pseudo_mini_loss sum 5.316520690917969
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  381059
Number of first layer input nodes during this epoch:  211299
Number of first layer output nodes during this epoch:  169760
----------------------------------------before generate dataloader block 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.09998941421508789  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.016879558563232422
global_2_local spend time (sec) 0.04081869125366211
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0046198368072509766
A = g.adjacency_matrix() spent  0.0077362060546875
auxiliary_graph
Graph(num_nodes=154728, num_edges=28937465,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07798910140991211
remove nodes length
63787
auxiliary_graph.remove_nodes spent  1.3018176555633545
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28937465,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1735413074493408

the counter of shared neighbor distribution
Counter({1.0: 23292734, 2.0: 4025850, 3.0: 1012928, 4.0: 306592, 5.0: 111950, 6.0: 47874, 7.0: 22518, 8.0: 11474, 9.0: 6096, 10.0: 3464, 11.0: 1990, 12.0: 1176, 13.0: 670, 14.0: 384, 15.0: 282, 16.0: 210, 17.0: 182, 18.0: 86, 19.0: 48, 21.0: 8, 20.0: 8})
28846524
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28846521, 28846522, 28846523])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23292734, 2.0: 4025850, 3.0: 1012928, 4.0: 306592, 5.0: 111950, 6.0: 47874, 7.0: 22518, 8.0: 11474, 9.0: 6096, 10.0: 3464, 11.0: 1990, 12.0: 1176, 13.0: 670, 14.0: 384, 15.0: 282, 16.0: 210, 17.0: 182, 18.0: 86, 19.0: 48, 21.0: 8, 20.0: 8})
Convert a graph into a bidirected graph: 1.354 seconds
Metis partitioning: 4.743 seconds
Split the graph: 4.479 seconds
Construct subgraphs: 0.058 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  10.647080659866333
46483
44458
total k batches seeds list generation spend  20.634029626846313
after graph partition
graph partition algorithm spend time 20.755393505096436
46483
44458
partition_len_list
[71245, 99722]
shared_neighbor_graph_partition_s0 selection method  spend 20.845622301101685
time for parepare:  0.01721954345703125
local_output_nid generation:  0.0046579837799072266
local_in_edges_tensor generation:  0.006966114044189453
mini_batch_src_global generation:  0.011117219924926758
r_  generation:  0.11997628211975098
local_output_nid generation:  0.005901813507080078
local_in_edges_tensor generation:  0.009327411651611328
mini_batch_src_global generation:  0.018908023834228516
r_  generation:  0.14885473251342773
----------------------check_connections_block total spend ----------------------------- 0.41106534004211426
generate_one_block  0.17513346672058105
generate_one_block  0.1997830867767334
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03737998008728027
gen group dst list time:  0.004729032516479492
time for parepare:  0.022144317626953125
local_output_nid generation:  0.009491682052612305
local_in_edges_tensor generation:  0.027669429779052734
mini_batch_src_global generation:  0.01255655288696289
r_  generation:  0.15914320945739746
local_output_nid generation:  0.016113758087158203
local_in_edges_tensor generation:  0.018453598022460938
mini_batch_src_global generation:  0.023961305618286133
r_  generation:  0.2586863040924072
----------------------check_connections_block total spend ----------------------------- 0.6445190906524658
generate_one_block  0.19525647163391113
generate_one_block  0.3232462406158447
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.09998941421508789  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

connection checking time:  1.05558443069458
block generation total time  0.8934192657470703
average batch blocks generation time:  0.44670963287353516
block dataloader generation time/epoch 22.96258044242859
pseudo mini batch 0 input nodes size: 91762
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.07655477523803711  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.07655477523803711  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.12031030654907227  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.12065696716308594  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.06182050704956055  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.06812143325805664  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.06812143325805664  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.06812143325805664  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

torch.Size([91762, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.06812143325805664  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

m.shape torch.Size([8788, 1, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.2729153633117676  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.2729153633117676  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 8788, 128]), torch.Size([1, 8788, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.2812962532043457  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.35079240798950195  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 8788, 128])
m.shape torch.Size([8707, 2, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.3549056053161621  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.3549056053161621  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 8707, 128]), torch.Size([1, 8707, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.3632478713989258  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.49362754821777344  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 8707, 128])
m.shape torch.Size([7574, 3, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.5011944770812988  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.5011944770812988  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 7574, 128]), torch.Size([1, 7574, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.5089578628540039  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.6705188751220703  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 7574, 128])
m.shape torch.Size([6289, 4, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.6789026260375977  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.6789026260375977  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 6289, 128]), torch.Size([1, 6289, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.6855783462524414  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8630752563476562  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 6289, 128])
m.shape torch.Size([5252, 5, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8725981712341309  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8725981712341309  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 5252, 128]), torch.Size([1, 5252, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8781013488769531  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.059126853942871  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 5252, 128])
m.shape torch.Size([4396, 6, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.069199562072754  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.069199562072754  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 4396, 128]), torch.Size([1, 4396, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.0738000869750977  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.254084587097168  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 4396, 128])
m.shape torch.Size([3716, 7, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.2643918991088867  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.2643918991088867  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 3716, 128]), torch.Size([1, 3716, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.2679357528686523  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.4451284408569336  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 3716, 128])
m.shape torch.Size([3255, 8, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.4557733535766602  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.4557733535766602  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 3255, 128]), torch.Size([1, 3255, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.458897590637207  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.6376447677612305  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 3255, 128])
m.shape torch.Size([2727, 9, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.6476712226867676  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.6476712226867676  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 2727, 128]), torch.Size([1, 2727, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.6510491371154785  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.831495761871338  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 2727, 128])
m.shape torch.Size([20541, 10, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.927474021911621  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.927474021911621  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 10270, 128]), torch.Size([1, 10270, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.9372682571411133  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 2.6396656036376953  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst 0 shape torch.Size([1, 10270, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 2.6396656036376953  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 2.6396656036376953  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 10271, 128]), torch.Size([1, 10271, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 2.649460792541504  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.340022087097168  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst 1 shape torch.Size([1, 10271, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.1718339920043945  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.2401933670043945  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.308137893676758  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.2392473220825195  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

torch.Size([71245, 256])
first layer input nodes number: 91762
first layer output nodes number: 71245
edges number: 408721
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.308823585510254  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.377182960510254  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.394346237182617  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.394346237182617  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

m.shape torch.Size([6810, 1, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.735225200653076  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.735225200653076  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 6810, 256]), torch.Size([1, 6810, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.7482142448425293  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.8521265983581543  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 6810, 256])
m.shape torch.Size([6131, 2, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.857417583465576  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.857417583465576  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 6131, 256]), torch.Size([1, 6131, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.8691115379333496  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.044520854949951  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 6131, 256])
m.shape torch.Size([5061, 3, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.053267002105713  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.053267002105713  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 5061, 256]), torch.Size([1, 5061, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.062920093536377  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.277313709259033  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 5061, 256])
m.shape torch.Size([4050, 4, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.288233280181885  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.288233280181885  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 4050, 256]), torch.Size([1, 4050, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.2961201667785645  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.5230584144592285  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 4050, 256])
m.shape torch.Size([3323, 5, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.534945964813232  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.534945964813232  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 3323, 256]), torch.Size([1, 3323, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.541484355926514  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.771259784698486  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 3323, 256])
m.shape torch.Size([2692, 6, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.783098220825195  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.783098220825195  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 2692, 256]), torch.Size([1, 2692, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.788809776306152  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.013635635375977  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 2692, 256])
m.shape torch.Size([2266, 7, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.026025295257568  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.026025295257568  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 2266, 256]), torch.Size([1, 2266, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.030947208404541  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.268699645996094  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 2266, 256])
m.shape torch.Size([1958, 8, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.2808966636657715  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.2808966636657715  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 1958, 256]), torch.Size([1, 1958, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.284688472747803  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.4996137619018555  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 1958, 256])
m.shape torch.Size([1642, 9, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.511688709259033  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.511688709259033  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 1642, 256]), torch.Size([1, 1642, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.515945911407471  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.7324395179748535  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 1642, 256])
m.shape torch.Size([1443, 10, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.7447428703308105  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.7447428703308105  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 1443, 256]), torch.Size([1, 1443, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.747637748718262  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.945696830749512  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 1443, 256])
m.shape torch.Size([1215, 11, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.9571661949157715  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.9571661949157715  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 1215, 256]), torch.Size([1, 1215, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.9595112800598145  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.1427106857299805  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 1215, 256])
m.shape torch.Size([1039, 12, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.153439044952393  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.153439044952393  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 1039, 256]), torch.Size([1, 1039, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.155422687530518  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.338803768157959  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 1039, 256])
m.shape torch.Size([892, 13, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.348656177520752  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.348656177520752  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 892, 256]), torch.Size([1, 892, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.350357532501221  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.509300708770752  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 892, 256])
m.shape torch.Size([777, 14, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.518905162811279  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.518905162811279  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 777, 256]), torch.Size([1, 777, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.520387172698975  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.667636394500732  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 777, 256])
m.shape torch.Size([708, 15, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.677102565765381  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.677102565765381  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 708, 256]), torch.Size([1, 708, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.678452968597412  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.824723720550537  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 708, 256])
m.shape torch.Size([565, 16, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.832737445831299  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.832737445831299  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 565, 256]), torch.Size([1, 565, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.833815097808838  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.95841646194458  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 565, 256])
m.shape torch.Size([552, 17, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.966897010803223  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.966897010803223  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 552, 256]), torch.Size([1, 552, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.967949867248535  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.096942901611328  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 552, 256])
m.shape torch.Size([447, 18, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.10414981842041  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.10414981842041  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 447, 256]), torch.Size([1, 447, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.105002403259277  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.215825080871582  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 447, 256])
m.shape torch.Size([384, 19, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.223048210144043  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.223048210144043  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 384, 256]), torch.Size([1, 384, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.223780632019043  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.32424259185791  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 384, 256])
m.shape torch.Size([393, 20, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.331430912017822  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.331430912017822  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 393, 256]), torch.Size([1, 393, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.332180500030518  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.438185214996338  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 393, 256])
m.shape torch.Size([342, 21, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.444713592529297  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.444713592529297  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 342, 256]), torch.Size([1, 342, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.445365905761719  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.542654037475586  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 342, 256])
m.shape torch.Size([272, 22, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.548079490661621  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.548079490661621  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.548598289489746  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.63278865814209  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([250, 23, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.638055801391602  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.638055801391602  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.638532638549805  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.715780258178711  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([233, 24, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.720916748046875  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.720916748046875  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.72136116027832  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.796466827392578  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([3038, 25, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.869242191314697  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.869242191314697  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 3038, 256]), torch.Size([1, 3038, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.87566614151001  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.89550256729126  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 3038, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.605497360229492  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.61242389678955  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.61935043334961  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.612077236175537  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

torch.Size([46483, 40])
input nodes number: 71245
output nodes number: 46483
edges number: 344967
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.613266468048096  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.613267421722412  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.08166646957397461  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

pseudo mini batch 1 input nodes size: 122578
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.062132835388183594  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.062132835388183594  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.12058258056640625  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.12091398239135742  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.0768117904663086  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.0849008560180664  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.0849008560180664  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.0849008560180664  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

torch.Size([122578, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.0849008560180664  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

m.shape torch.Size([8840, 1, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.4251728057861328  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.4251728057861328  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 8840, 128]), torch.Size([1, 8840, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.43360328674316406  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.5031986236572266  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 8840, 128])
m.shape torch.Size([8719, 2, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.507298469543457  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.507298469543457  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 8719, 128]), torch.Size([1, 8719, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.5156135559082031  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.6460275650024414  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 8719, 128])
m.shape torch.Size([7407, 3, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.6524658203125  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.6524658203125  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 7407, 128]), torch.Size([1, 7407, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.660027027130127  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8159294128417969  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 7407, 128])
m.shape torch.Size([6350, 4, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8245091438293457  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8245091438293457  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 6350, 128]), torch.Size([1, 6350, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8311433792114258  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.0088205337524414  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 6350, 128])
m.shape torch.Size([5689, 5, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.0194644927978516  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.0194644927978516  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 5689, 128]), torch.Size([1, 5689, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.025205135345459  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.2355122566223145  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 5689, 128])
m.shape torch.Size([4799, 6, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.2465295791625977  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.2465295791625977  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 4799, 128]), torch.Size([1, 4799, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.2518773078918457  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.4525532722473145  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 4799, 128])
m.shape torch.Size([4310, 7, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.46437406539917  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.46437406539917  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 4310, 128]), torch.Size([1, 4310, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.469193458557129  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.6767511367797852  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 4310, 128])
m.shape torch.Size([3819, 8, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.6892642974853516  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.6892642974853516  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 3819, 128]), torch.Size([1, 3819, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.6929802894592285  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.9037489891052246  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 3819, 128])
m.shape torch.Size([3519, 9, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.9175529479980469  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.9175529479980469  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 3519, 128]), torch.Size([1, 3519, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.9211335182189941  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 2.1416430473327637  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 3519, 128])
m.shape torch.Size([46270, 10, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 2.359799385070801  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 2.359799385070801  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 23135, 128]), torch.Size([1, 23135, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 2.3818626403808594  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.972214698791504  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst 0 shape torch.Size([1, 23135, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.972214698791504  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.972214698791504  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 23135, 128]), torch.Size([1, 23135, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.9942779541015625  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.550532817840576  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst 1 shape torch.Size([1, 23135, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.256898403167725  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.352000713348389  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.447103023529053  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.35125732421875  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

torch.Size([99722, 256])
first layer input nodes number: 122578
first layer output nodes number: 99722
edges number: 686231
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.448018550872803  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.543120861053467  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.56735372543335  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.56735372543335  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

m.shape torch.Size([6618, 1, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.95924186706543  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.95924186706543  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 6618, 256]), torch.Size([1, 6618, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.972017288208008  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.074216365814209  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 6618, 256])
m.shape torch.Size([5575, 2, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.078619480133057  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.078619480133057  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 5575, 256]), torch.Size([1, 5575, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.089433193206787  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.250239849090576  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 5575, 256])
m.shape torch.Size([4216, 3, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.257079601287842  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.257079601287842  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 4216, 256]), torch.Size([1, 4216, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.265388011932373  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.445113182067871  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 4216, 256])
m.shape torch.Size([3270, 4, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.453250408172607  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.453250408172607  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 3270, 256]), torch.Size([1, 3270, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.460147380828857  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.643710613250732  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 3270, 256])
m.shape torch.Size([2899, 5, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.654523849487305  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.654523849487305  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 2899, 256]), torch.Size([1, 2899, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.660316467285156  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.859731674194336  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 2899, 256])
m.shape torch.Size([2176, 6, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.869515419006348  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.869515419006348  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 2176, 256]), torch.Size([1, 2176, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.873997211456299  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.060311317443848  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 2176, 256])
m.shape torch.Size([1779, 7, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.070205211639404  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.070205211639404  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 1779, 256]), torch.Size([1, 1779, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.074010848999023  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.248793125152588  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 1779, 256])
m.shape torch.Size([1514, 8, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.258721351623535  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.258721351623535  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 1514, 256]), torch.Size([1, 1514, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.261715888977051  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.428032875061035  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 1514, 256])
m.shape torch.Size([1334, 9, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.43801212310791  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.43801212310791  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 1334, 256]), torch.Size([1, 1334, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.440683364868164  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.609004974365234  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 1334, 256])
m.shape torch.Size([1156, 10, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.618438720703125  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.618438720703125  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 1156, 256]), torch.Size([1, 1156, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.620684623718262  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.787664413452148  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 1156, 256])
m.shape torch.Size([988, 11, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.796217918395996  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.796217918395996  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 988, 256]), torch.Size([1, 988, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.798102378845215  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.952922821044922  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 988, 256])
m.shape torch.Size([898, 12, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.962337970733643  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.962337970733643  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 898, 256]), torch.Size([1, 898, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.964050769805908  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.109638690948486  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 898, 256])
m.shape torch.Size([764, 13, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.11832857131958  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.11832857131958  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 764, 256]), torch.Size([1, 764, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.119785785675049  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.253849506378174  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 764, 256])
m.shape torch.Size([657, 14, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.261961460113525  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.261961460113525  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 657, 256]), torch.Size([1, 657, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.263214588165283  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.392584800720215  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 657, 256])
m.shape torch.Size([581, 15, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.40033483505249  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.40033483505249  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 581, 256]), torch.Size([1, 581, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.401443004608154  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.520307064056396  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 581, 256])
m.shape torch.Size([546, 16, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.528149604797363  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.528149604797363  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 546, 256]), torch.Size([1, 546, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.529191017150879  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.65117359161377  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 546, 256])
m.shape torch.Size([478, 17, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.65846300125122  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.65846300125122  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 478, 256]), torch.Size([1, 478, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.659374713897705  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.77167272567749  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 478, 256])
m.shape torch.Size([501, 18, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.779884338378906  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.779884338378906  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 501, 256]), torch.Size([1, 501, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.780839920043945  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.904296875  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 501, 256])
m.shape torch.Size([452, 19, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.912073612213135  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.912073612213135  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 452, 256]), torch.Size([1, 452, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.912935733795166  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.031832218170166  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 452, 256])
m.shape torch.Size([414, 20, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.03935956954956  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.03935956954956  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 414, 256]), torch.Size([1, 414, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.040149211883545  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.153808116912842  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 414, 256])
m.shape torch.Size([375, 21, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.160982608795166  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.160982608795166  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 375, 256]), torch.Size([1, 375, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.16169786453247  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.271111011505127  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 375, 256])
m.shape torch.Size([284, 22, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.276758670806885  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.276758670806885  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.277300357818604  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.363314151763916  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 284, 256])
m.shape torch.Size([269, 23, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.368989944458008  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.368989944458008  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.369503021240234  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.453704833984375  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([292, 24, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.460184097290039  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.460184097290039  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.46074104309082  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.557596206665039  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([6422, 25, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.711626529693604  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.711626529693604  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 6422, 256]), torch.Size([1, 6422, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.723875522613525  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.883436679840088  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 6422, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.536493301391602  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.543118476867676  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.54974365234375  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.542787075042725  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

torch.Size([44458, 40])
input nodes number: 99722
output nodes number: 44458
edges number: 399283
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.54356050491333  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.543560981750488  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.09933853149414062  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.09933853149414062  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.09933853149414062  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.050858139991760254 |0.00567173957824707 |0.1708393096923828 |0.00011205673217773438 |0.15105676651000977 |0.00926518440246582 |
----------------------------------------------------------pseudo_mini_loss sum 4.311037540435791
Total (block generation + training)time/epoch 23.794373035430908
* Pure training time/epoch 0.7663412094116211
Training time/epoch 0.8314666748046875
Training time without block to device /epoch 0.8201231956481934
Training time without total dataloading part /epoch 0.6532814502716064
load block tensor time/epoch 0.10171627998352051
block to device time/epoch 0.01134347915649414
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  385307
Number of first layer input nodes during this epoch:  214340
Number of first layer output nodes during this epoch:  170967
----------------------------------------before generate dataloader block 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.09933805465698242  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0203554630279541
global_2_local spend time (sec) 0.04693293571472168
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004886150360107422
A = g.adjacency_matrix() spent  0.011757135391235352
auxiliary_graph
Graph(num_nodes=154614, num_edges=29048813,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08037185668945312
remove nodes length
63673
auxiliary_graph.remove_nodes spent  1.2850511074066162
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29048813,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1658506393432617

the counter of shared neighbor distribution
Counter({1.0: 23402436, 2.0: 4027368, 3.0: 1011142, 4.0: 307344, 5.0: 112146, 6.0: 48448, 7.0: 22696, 8.0: 11506, 9.0: 6294, 10.0: 3494, 11.0: 1966, 12.0: 1128, 13.0: 656, 14.0: 434, 15.0: 300, 16.0: 212, 17.0: 164, 18.0: 68, 19.0: 54, 20.0: 10, 21.0: 6})[04:42:27] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28957872 edges into 2 parts and get 216820 edge cuts

28957872
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28957869, 28957870, 28957871])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23402436, 2.0: 4027368, 3.0: 1011142, 4.0: 307344, 5.0: 112146, 6.0: 48448, 7.0: 22696, 8.0: 11506, 9.0: 6294, 10.0: 3494, 11.0: 1966, 12.0: 1128, 13.0: 656, 14.0: 434, 15.0: 300, 16.0: 212, 17.0: 164, 18.0: 68, 19.0: 54, 20.0: 10, 21.0: 6})
Convert a graph into a bidirected graph: 1.339 seconds
Metis partitioning: 4.652 seconds
Split the graph: 4.149 seconds
Construct subgraphs: 0.087 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  10.239925146102905
46531
44410
total k batches seeds list generation spend  20.126856803894043
after graph partition
graph partition algorithm spend time 20.242310762405396
46531
44410
partition_len_list
[70981, 101862]
shared_neighbor_graph_partition_s0 selection method  spend 20.3418972492218
time for parepare:  0.01736164093017578
local_output_nid generation:  0.005287885665893555
local_in_edges_tensor generation:  0.005995273590087891
mini_batch_src_global generation:  0.013167858123779297
r_  generation:  0.12493062019348145
local_output_nid generation:  0.007053852081298828
local_in_edges_tensor generation:  0.009230375289916992
mini_batch_src_global generation:  0.018228530883789062
r_  generation:  0.1503748893737793
----------------------check_connections_block total spend ----------------------------- 0.41521215438842773
generate_one_block  0.16557669639587402
generate_one_block  0.18660402297973633
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0435488224029541
gen group dst list time:  0.007851839065551758
time for parepare:  0.02814316749572754
local_output_nid generation:  0.009171724319458008
local_in_edges_tensor generation:  0.0299680233001709
mini_batch_src_global generation:  0.016283512115478516
r_  generation:  0.17081689834594727
local_output_nid generation:  0.015273332595825195
local_in_edges_tensor generation:  0.026894807815551758
mini_batch_src_global generation:  0.03454089164733887
r_  generation:  0.2582411766052246
----------------------check_connections_block total spend ----------------------------- 0.6876578330993652
generate_one_block  0.19986295700073242
generate_one_block  0.34091711044311523
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.09933805465698242  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

connection checking time:  1.102869987487793
block generation total time  0.892960786819458
average batch blocks generation time:  0.446480393409729
block dataloader generation time/epoch 22.733076333999634
pseudo mini batch 0 input nodes size: 91648
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.07650947570800781  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.07650947570800781  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.12021064758300781  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.12055778503417969  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.06177663803100586  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.0674281120300293  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.0674281120300293  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.0674281120300293  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

torch.Size([91648, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.0674281120300293  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

m.shape torch.Size([8586, 1, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.27286815643310547  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.27286815643310547  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 8586, 128]), torch.Size([1, 8586, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.28105640411376953  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.34656238555908203  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 8586, 128])
m.shape torch.Size([8571, 2, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.35064220428466797  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.35064220428466797  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 8571, 128]), torch.Size([1, 8571, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.358823299407959  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.4814324378967285  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 8571, 128])
m.shape torch.Size([7443, 3, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.4879927635192871  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.4879927635192871  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 7443, 128]), torch.Size([1, 7443, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.49562883377075195  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.6517891883850098  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 7443, 128])
m.shape torch.Size([6224, 4, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.6601114273071289  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.6601114273071289  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 6224, 128]), torch.Size([1, 6224, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.666651725769043  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8433704376220703  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 6224, 128])
m.shape torch.Size([5295, 5, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8530268669128418  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8530268669128418  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 5295, 128]), torch.Size([1, 5295, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8585195541381836  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.0410423278808594  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 5295, 128])
m.shape torch.Size([4364, 6, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.0510029792785645  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.0510029792785645  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 4364, 128]), torch.Size([1, 4364, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.0556087493896484  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.234567642211914  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 4364, 128])
m.shape torch.Size([3694, 7, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.244816780090332  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.244816780090332  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 3694, 128]), torch.Size([1, 3694, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.248417854309082  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.4252543449401855  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 3694, 128])
m.shape torch.Size([3233, 8, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.4358258247375488  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.4358258247375488  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 3233, 128]), torch.Size([1, 3233, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.4390645027160645  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.6162505149841309  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 3233, 128])
m.shape torch.Size([2768, 9, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.6264958381652832  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.6264958381652832  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 2768, 128]), torch.Size([1, 2768, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.629173755645752  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.8072733879089355  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 2768, 128])
m.shape torch.Size([20803, 10, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.904676914215088  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.904676914215088  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 10401, 128]), torch.Size([1, 10401, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.9145960807800293  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 2.623905658721924  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst 0 shape torch.Size([1, 10401, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 2.623905658721924  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 2.623905658721924  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 10402, 128]), torch.Size([1, 10402, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 2.6338257789611816  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.3331947326660156  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst 1 shape torch.Size([1, 10402, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.1650238037109375  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.2333831787109375  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.3010759353637695  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.232187271118164  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

torch.Size([70981, 256])
first layer input nodes number: 91648
first layer output nodes number: 70981
edges number: 410276
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.301760673522949  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.370120048522949  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.3870315551757812  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.3870315551757812  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

m.shape torch.Size([6727, 1, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.7299060821533203  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.7299060821533203  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 6727, 256]), torch.Size([1, 6727, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.74273681640625  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.845778465270996  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 6727, 256])
m.shape torch.Size([6069, 2, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.851029396057129  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.851029396057129  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 6069, 256]), torch.Size([1, 6069, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.862605094909668  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.036240577697754  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 6069, 256])
m.shape torch.Size([5007, 3, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.0448899269104  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.0448899269104  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 5007, 256]), torch.Size([1, 5007, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.054440021514893  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.268421649932861  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 5007, 256])
m.shape torch.Size([4031, 4, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.279143810272217  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.279143810272217  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 4031, 256]), torch.Size([1, 4031, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.287280082702637  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.5137200355529785  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 4031, 256])
m.shape torch.Size([3352, 5, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.525674343109131  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.525674343109131  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 3352, 256]), torch.Size([1, 3352, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.532464504241943  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.763566017150879  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 3352, 256])
m.shape torch.Size([2703, 6, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.775606155395508  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.775606155395508  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 2703, 256]), torch.Size([1, 2703, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.78106689453125  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.003833770751953  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 2703, 256])
m.shape torch.Size([2290, 7, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.016663074493408  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.016663074493408  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 2290, 256]), torch.Size([1, 2290, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.0210652351379395  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.250144958496094  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 2290, 256])
m.shape torch.Size([1969, 8, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.262741565704346  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.262741565704346  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 1969, 256]), torch.Size([1, 1969, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.266896724700928  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.489360332489014  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 1969, 256])
m.shape torch.Size([1655, 9, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.501132965087891  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.501132965087891  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 1655, 256]), torch.Size([1, 1655, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.504412651062012  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.7177581787109375  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 1655, 256])
m.shape torch.Size([1431, 10, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.729719161987305  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.729719161987305  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 1431, 256]), torch.Size([1, 1431, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.732619285583496  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.928493499755859  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 1431, 256])
m.shape torch.Size([1236, 11, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.940196514129639  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.940196514129639  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 1236, 256]), torch.Size([1, 1236, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.942553997039795  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.1327433586120605  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 1236, 256])
m.shape torch.Size([1059, 12, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.143657684326172  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.143657684326172  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 1059, 256]), torch.Size([1, 1059, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.145740032196045  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.331151485443115  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 1059, 256])
m.shape torch.Size([903, 13, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.340898513793945  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.340898513793945  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 903, 256]), torch.Size([1, 903, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.342620849609375  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.501075744628906  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 903, 256])
m.shape torch.Size([807, 14, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.511073589324951  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.511073589324951  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 807, 256]), torch.Size([1, 807, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.512612819671631  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.667357921600342  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 807, 256])
m.shape torch.Size([724, 15, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.677026271820068  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.677026271820068  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 724, 256]), torch.Size([1, 724, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.678407192230225  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.82666540145874  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 724, 256])
m.shape torch.Size([579, 16, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.834878921508789  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.834878921508789  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 579, 256]), torch.Size([1, 579, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.8359832763671875  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.9624810218811035  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 579, 256])
m.shape torch.Size([558, 17, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.971046447753906  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.971046447753906  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 558, 256]), torch.Size([1, 558, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.972110748291016  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.101696014404297  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 558, 256])
m.shape torch.Size([461, 18, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.109139442443848  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.109139442443848  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 461, 256]), torch.Size([1, 461, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.110018730163574  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.224211692810059  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 461, 256])
m.shape torch.Size([395, 19, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.231049537658691  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.231049537658691  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 395, 256]), torch.Size([1, 395, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.231802940368652  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.332817077636719  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 395, 256])
m.shape torch.Size([407, 20, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.340264320373535  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.340264320373535  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 407, 256]), torch.Size([1, 407, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.34104061126709  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.454998970031738  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 407, 256])
m.shape torch.Size([347, 21, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.461614608764648  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.461614608764648  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 347, 256]), torch.Size([1, 347, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.462276458740234  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.561525344848633  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 347, 256])
m.shape torch.Size([274, 22, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.566988468170166  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.566988468170166  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.567511081695557  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.65123987197876  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([255, 23, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.656615734100342  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.656615734100342  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.657102108001709  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.735894680023193  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([239, 24, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.741164684295654  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.741164684295654  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.7416205406188965  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.818660259246826  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([3053, 25, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.891790390014648  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.891790390014648  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 3053, 256]), torch.Size([1, 3053, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.897613525390625  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.9224853515625  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 3053, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.629496574401855  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.637381553649902  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.64526653289795  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.63703441619873  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

torch.Size([46531, 40])
input nodes number: 70981
output nodes number: 46531
edges number: 348110
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.63917064666748  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.639171600341797  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.07979011535644531  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

pseudo mini batch 1 input nodes size: 126308
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.06303739547729492  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.06303739547729492  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.12326574325561523  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.1235966682434082  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.07954835891723633  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.08867788314819336  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.08867788314819336  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.08867788314819336  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

torch.Size([126308, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.08867788314819336  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

m.shape torch.Size([9026, 1, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.435518741607666  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.435518741607666  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 9026, 128]), torch.Size([1, 9026, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.44412660598754883  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.5140767097473145  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 9026, 128])
m.shape torch.Size([8941, 2, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.5182995796203613  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.5182995796203613  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 8941, 128]), torch.Size([1, 8941, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.5268669128417969  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.6579160690307617  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 8941, 128])
m.shape torch.Size([7670, 3, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.6653714179992676  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.6653714179992676  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 7670, 128]), torch.Size([1, 7670, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.6732921600341797  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8364553451538086  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 7670, 128])
m.shape torch.Size([6520, 4, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8452339172363281  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8452339172363281  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 6520, 128]), torch.Size([1, 6520, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8514556884765625  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.0330748558044434  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 6520, 128])
m.shape torch.Size([5810, 5, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.0438179969787598  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.0438179969787598  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 5810, 128]), torch.Size([1, 5810, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.0496973991394043  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.2606348991394043  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 5810, 128])
m.shape torch.Size([4927, 6, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.271960735321045  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.271960735321045  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 4927, 128]), torch.Size([1, 4927, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.2774615287780762  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.4795079231262207  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 4927, 128])
m.shape torch.Size([4434, 7, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.492783546447754  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.492783546447754  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 4434, 128]), torch.Size([1, 4434, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.4974260330200195  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.7121667861938477  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 4434, 128])
m.shape torch.Size([3960, 8, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.7254705429077148  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.7254705429077148  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 3960, 128]), torch.Size([1, 3960, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.7301130294799805  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.9467034339904785  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 3960, 128])
m.shape torch.Size([3615, 9, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.9604401588439941  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.9604401588439941  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 3615, 128]), torch.Size([1, 3615, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.9639368057250977  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 2.1871981620788574  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 3615, 128])
m.shape torch.Size([46959, 10, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 2.4090518951416016  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 2.4090518951416016  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 23479, 128]), torch.Size([1, 23479, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 2.431443214416504  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.02540397644043  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst 0 shape torch.Size([1, 23479, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.02540397644043  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.02540397644043  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 23480, 128]), torch.Size([1, 23480, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.047796249389648  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.626589298248291  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst 1 shape torch.Size([1, 23480, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.326606273651123  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.4237494468688965  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.52089262008667  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.422990322113037  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

torch.Size([101862, 256])
first layer input nodes number: 126308
first layer output nodes number: 101862
edges number: 699453
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.521835803985596  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.618978977203369  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.6432647705078125  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.6432647705078125  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

m.shape torch.Size([6701, 1, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.032618999481201  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.032618999481201  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 6701, 256]), torch.Size([1, 6701, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.046172618865967  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.148902416229248  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 6701, 256])
m.shape torch.Size([5637, 2, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.153347969055176  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.153347969055176  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 5637, 256]), torch.Size([1, 5637, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.165585517883301  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.331437110900879  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 5637, 256])
m.shape torch.Size([4270, 3, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.337630748748779  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.337630748748779  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 4270, 256]), torch.Size([1, 4270, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.345962047576904  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.525886058807373  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 4270, 256])
m.shape torch.Size([3289, 4, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.534365177154541  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.534365177154541  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 3289, 256]), torch.Size([1, 3289, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.5408501625061035  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.724563121795654  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 3289, 256])
m.shape torch.Size([2870, 5, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.73494815826416  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.73494815826416  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 2870, 256]), torch.Size([1, 2870, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.741464614868164  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.938531875610352  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 2870, 256])
m.shape torch.Size([2165, 6, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.948279857635498  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.948279857635498  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 2165, 256]), torch.Size([1, 2165, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.952422618865967  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.132483005523682  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 2165, 256])
m.shape torch.Size([1755, 7, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.142091751098633  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.142091751098633  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 1755, 256]), torch.Size([1, 1755, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.145817756652832  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.3208723068237305  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 1755, 256])
m.shape torch.Size([1503, 8, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.330755233764648  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.330755233764648  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 1503, 256]), torch.Size([1, 1503, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.333830833435059  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.501774787902832  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 1503, 256])
m.shape torch.Size([1321, 9, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.511768341064453  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.511768341064453  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 1321, 256]), torch.Size([1, 1321, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.514448165893555  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.679001331329346  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 1321, 256])
m.shape torch.Size([1168, 10, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.688967704772949  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.688967704772949  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 1168, 256]), torch.Size([1, 1168, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.691207408905029  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.8520731925964355  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 1168, 256])
m.shape torch.Size([967, 11, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.861037254333496  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.861037254333496  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 967, 256]), torch.Size([1, 967, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.862881660461426  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.009943008422852  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 967, 256])
m.shape torch.Size([878, 12, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.019147396087646  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.019147396087646  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 878, 256]), torch.Size([1, 878, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.020822048187256  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.164918422698975  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 878, 256])
m.shape torch.Size([753, 13, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.173489570617676  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.173489570617676  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 753, 256]), torch.Size([1, 753, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.174925804138184  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.307340621948242  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 753, 256])
m.shape torch.Size([627, 14, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.315059661865234  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.315059661865234  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 627, 256]), torch.Size([1, 627, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.316255569458008  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.441680431365967  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 627, 256])
m.shape torch.Size([565, 15, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.449228286743164  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.449228286743164  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 565, 256]), torch.Size([1, 565, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.450305938720703  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.56591796875  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 565, 256])
m.shape torch.Size([532, 16, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.573560237884521  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.573560237884521  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 532, 256]), torch.Size([1, 532, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.574574947357178  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.68932580947876  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 532, 256])
m.shape torch.Size([472, 17, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.696530818939209  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.696530818939209  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 472, 256]), torch.Size([1, 472, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.697431087493896  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.805463314056396  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 472, 256])
m.shape torch.Size([487, 18, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.813438415527344  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.813438415527344  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 487, 256]), torch.Size([1, 487, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.814367294311523  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.937356948852539  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 487, 256])
m.shape torch.Size([441, 19, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.944945812225342  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.944945812225342  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 441, 256]), torch.Size([1, 441, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.945786952972412  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.05866003036499  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 441, 256])
m.shape torch.Size([400, 20, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.06592845916748  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.06592845916748  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 400, 256]), torch.Size([1, 400, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.066691398620605  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.175084114074707  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 400, 256])
m.shape torch.Size([370, 21, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.182170867919922  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.182170867919922  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 370, 256]), torch.Size([1, 370, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.182876586914062  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.287893295288086  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 370, 256])
m.shape torch.Size([282, 22, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.293503284454346  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.293503284454346  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.294041156768799  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.37999439239502  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([264, 23, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.385561466217041  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.385561466217041  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.386065006256104  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.469582080841064  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([286, 24, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.475927829742432  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.475927829742432  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.476473331451416  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.569227695465088  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([6407, 25, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.72290325164795  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.72290325164795  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

 h.shape torch.Size([1, 6407, 256]), torch.Size([1, 6407, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.735123634338379  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.890200138092041  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

rst.shape  torch.Size([1, 6407, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.545446395874023  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.552064418792725  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.558682441711426  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.551733493804932  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

torch.Size([44410, 40])
input nodes number: 101862
output nodes number: 44410
edges number: 396140
Using backend: pytorch
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.551556587219238  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.551557064056396  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.4197998046875 GB
    Memory Allocated: 0.10247993469238281  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.4197998046875 GB
    Memory Allocated: 0.10247993469238281  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.4197998046875 GB
    Memory Allocated: 0.10247993469238281  GigaBytes
Max Memory Allocated: 12.176261901855469  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05547678470611572 |0.00886070728302002 |0.16685199737548828 |0.00011467933654785156 |0.1505793333053589 |0.009150505065917969 |
----------------------------------------------------------pseudo_mini_loss sum 3.3232123851776123
Total (block generation + training)time/epoch 23.56968355178833
* Pure training time/epoch 0.7729175090789795
Training time/epoch 0.8411505222320557
Training time without block to device /epoch 0.8234291076660156
Training time without total dataloading part /epoch 0.644242525100708
load block tensor time/epoch 0.11095356941223145
block to device time/epoch 0.01772141456604004
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  390799
Number of first layer input nodes during this epoch:  217956
Number of first layer output nodes during this epoch:  172843
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
