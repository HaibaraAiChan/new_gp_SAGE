[04:44:20] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28871986 edges into 8 parts and get 4652081 edge cuts
main start at this time 1652849039.7047143
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

<class 'int'>
<class 'int'>
----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02132415771484375
global_2_local spend time (sec) 0.03456878662109375
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004273414611816406
A = g.adjacency_matrix() spent  0.01217508316040039
auxiliary_graph
Graph(num_nodes=154611, num_edges=28962927,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0850226879119873
remove nodes length
63670
auxiliary_graph.remove_nodes spent  1.2834138870239258
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28962927,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1790721416473389

the counter of shared neighbor distribution
Counter({1.0: 23350590, 2.0: 4010844, 3.0: 1004314, 4.0: 300894, 5.0: 109354, 6.0: 47662, 7.0: 22182, 8.0: 11490, 9.0: 6150, 10.0: 3490, 11.0: 2010, 12.0: 1100, 13.0: 704, 14.0: 414, 15.0: 272, 16.0: 202, 17.0: 172, 18.0: 78, 19.0: 52, 21.0: 8, 20.0: 4})
28871986
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28871983, 28871984, 28871985])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23350590, 2.0: 4010844, 3.0: 1004314, 4.0: 300894, 5.0: 109354, 6.0: 47662, 7.0: 22182, 8.0: 11490, 9.0: 6150, 10.0: 3490, 11.0: 2010, 12.0: 1100, 13.0: 704, 14.0: 414, 15.0: 272, 16.0: 202, 17.0: 172, 18.0: 78, 19.0: 52, 21.0: 8, 20.0: 4})
Convert a graph into a bidirected graph: 1.224 seconds
Metis partitioning: 5.003 seconds
Split the graph: 1.820 seconds
Construct subgraphs: 0.188 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  8.24738097190857
11513
11487
11532
11524
11197
11218
11035
11435
total k batches seeds list generation spend  18.170875787734985
after graph partition
graph partition algorithm spend time 18.27151918411255
11513
11487
11532
11524
11197
11218
11035
11435
partition_len_list
[20388, 20137, 19943, 22926, 34856, 26082, 45942, 42324]
shared_neighbor_graph_partition_s0 selection method  spend 18.35318160057068
time for parepare:  0.01695537567138672
local_output_nid generation:  0.0019316673278808594
local_in_edges_tensor generation:  0.0030281543731689453
mini_batch_src_global generation:  0.003137826919555664
r_  generation:  0.03096151351928711
local_output_nid generation:  0.002237558364868164
local_in_edges_tensor generation:  0.002346515655517578
mini_batch_src_global generation:  0.0035254955291748047
r_  generation:  0.030011415481567383
local_output_nid generation:  0.002332925796508789
local_in_edges_tensor generation:  0.002151012420654297
mini_batch_src_global generation:  0.002440929412841797
r_  generation:  0.024674654006958008
local_output_nid generation:  0.0023283958435058594
local_in_edges_tensor generation:  0.002130746841430664
mini_batch_src_global generation:  0.0023763179779052734
r_  generation:  0.0253598690032959
local_output_nid generation:  0.0022706985473632812
local_in_edges_tensor generation:  0.0025026798248291016
mini_batch_src_global generation:  0.002912759780883789
r_  generation:  0.0299222469329834
local_output_nid generation:  0.002415895462036133
local_in_edges_tensor generation:  0.0023834705352783203
mini_batch_src_global generation:  0.002686738967895508
r_  generation:  0.02712392807006836
local_output_nid generation:  0.002405881881713867
local_in_edges_tensor generation:  0.0025277137756347656
mini_batch_src_global generation:  0.004026174545288086
r_  generation:  0.03375554084777832
local_output_nid generation:  0.002499103546142578
local_in_edges_tensor generation:  0.003766775131225586
mini_batch_src_global generation:  0.004909038543701172
r_  generation:  0.04459953308105469
----------------------check_connections_block total spend ----------------------------- 0.3930079936981201
generate_one_block  0.05208778381347656
generate_one_block  0.041585683822631836
generate_one_block  0.032472848892211914
generate_one_block  0.03430366516113281
generate_one_block  0.049082040786743164
generate_one_block  0.03586411476135254
generate_one_block  0.05169868469238281
generate_one_block  0.07075858116149902
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.06851387023925781
gen group dst list time:  0.006507158279418945
time for parepare:  0.021795988082885742
local_output_nid generation:  0.0034210681915283203
local_in_edges_tensor generation:  0.01963067054748535
mini_batch_src_global generation:  0.0040740966796875
r_  generation:  0.04352998733520508
local_output_nid generation:  0.004956245422363281
local_in_edges_tensor generation:  0.005637168884277344
mini_batch_src_global generation:  0.005245685577392578
r_  generation:  0.04393339157104492
local_output_nid generation:  0.00494837760925293
local_in_edges_tensor generation:  0.0039479732513427734
mini_batch_src_global generation:  0.0037186145782470703
r_  generation:  0.03924870491027832
local_output_nid generation:  0.0056836605072021484
local_in_edges_tensor generation:  0.004400730133056641
mini_batch_src_global generation:  0.004149436950683594
r_  generation:  0.04686403274536133
local_output_nid generation:  0.008328437805175781
local_in_edges_tensor generation:  0.007413148880004883
mini_batch_src_global generation:  0.008408546447753906
r_  generation:  0.08698201179504395
local_output_nid generation:  0.0067026615142822266
local_in_edges_tensor generation:  0.0063250064849853516
mini_batch_src_global generation:  0.00692439079284668
r_  generation:  0.05979156494140625
local_output_nid generation:  0.010848760604858398
local_in_edges_tensor generation:  0.014457225799560547
mini_batch_src_global generation:  0.01289057731628418
r_  generation:  0.12592172622680664
local_output_nid generation:  0.009176969528198242
local_in_edges_tensor generation:  0.012603521347045898
mini_batch_src_global generation:  0.01410818099975586
r_  generation:  0.11821436882019043
----------------------check_connections_block total spend ----------------------------- 0.9201643466949463
generate_one_block  0.05512189865112305
generate_one_block  0.05791783332824707
generate_one_block  0.04878401756286621
generate_one_block  0.05902385711669922
generate_one_block  0.11694693565368652
generate_one_block  0.07361555099487305
generate_one_block  0.1681506633758545
generate_one_block  0.16465187072753906
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  1.3131723403930664
block generation total time  1.1120660305023193
average batch blocks generation time:  0.13900825381278992
pseudo mini batch 0 input nodes size: 31671
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0350341796875 GB
    Memory Allocated: 0.018402576446533203  GigaBytes
Max Memory Allocated: 0.018402576446533203  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0350341796875 GB
    Memory Allocated: 0.018488407135009766  GigaBytes
Max Memory Allocated: 0.018488407135009766  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0350341796875 GB
    Memory Allocated: 0.018488407135009766  GigaBytes
Max Memory Allocated: 0.018488407135009766  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.020144939422607422  GigaBytes
Max Memory Allocated: 0.020144939422607422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.020144939422607422  GigaBytes
Max Memory Allocated: 0.020144939422607422  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.020144939422607422  GigaBytes
Max Memory Allocated: 0.020144939422607422  GigaBytes

torch.Size([31671, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.020144939422607422  GigaBytes
Max Memory Allocated: 0.020144939422607422  GigaBytes

m.shape torch.Size([2118, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.08436107635498047  GigaBytes
Max Memory Allocated: 0.08438539505004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.08436107635498047  GigaBytes
Max Memory Allocated: 0.08438539505004883  GigaBytes

 h.shape torch.Size([1, 2118, 128]), torch.Size([1, 2118, 128])
----------------------------------------3
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.0863809585571289  GigaBytes
Max Memory Allocated: 0.0863809585571289  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.10288238525390625  GigaBytes
Max Memory Allocated: 0.10389232635498047  GigaBytes

rst.shape  torch.Size([1, 2118, 128])
m.shape torch.Size([2090, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.10389232635498047  GigaBytes
Max Memory Allocated: 0.10393953323364258  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.10389232635498047  GigaBytes
Max Memory Allocated: 0.10393953323364258  GigaBytes

 h.shape torch.Size([1, 2090, 128]), torch.Size([1, 2090, 128])
----------------------------------------3
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.10588550567626953  GigaBytes
Max Memory Allocated: 0.10588550567626953  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.13637924194335938  GigaBytes
Max Memory Allocated: 0.13837242126464844  GigaBytes

rst.shape  torch.Size([1, 2090, 128])
m.shape torch.Size([1930, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.13754749298095703  GigaBytes
Max Memory Allocated: 0.13837242126464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.13754749298095703  GigaBytes
Max Memory Allocated: 0.13837242126464844  GigaBytes

 h.shape torch.Size([1, 1930, 128]), torch.Size([1, 1930, 128])
----------------------------------------3
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.1393880844116211  GigaBytes
Max Memory Allocated: 0.1393880844116211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.17988109588623047  GigaBytes
Max Memory Allocated: 0.18264198303222656  GigaBytes

rst.shape  torch.Size([1, 1930, 128])
m.shape torch.Size([1594, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.18200111389160156  GigaBytes
Max Memory Allocated: 0.18264198303222656  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.18200111389160156  GigaBytes
Max Memory Allocated: 0.18264198303222656  GigaBytes

 h.shape torch.Size([1, 1594, 128]), torch.Size([1, 1594, 128])
----------------------------------------3
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.18352127075195312  GigaBytes
Max Memory Allocated: 0.18352127075195312  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.22760581970214844  GigaBytes
Max Memory Allocated: 0.23064613342285156  GigaBytes

rst.shape  torch.Size([1, 1594, 128])
m.shape torch.Size([1474, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.2303600311279297  GigaBytes
Max Memory Allocated: 0.23064613342285156  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.2303600311279297  GigaBytes
Max Memory Allocated: 0.23064613342285156  GigaBytes

 h.shape torch.Size([1, 1474, 128]), torch.Size([1, 1474, 128])
----------------------------------------3
 Nvidia-smi: 1.4451904296875 GB
    Memory Allocated: 0.2317657470703125  GigaBytes
Max Memory Allocated: 0.2317657470703125  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4959716796875 GB
    Memory Allocated: 0.28237152099609375  GigaBytes
Max Memory Allocated: 0.2858858108520508  GigaBytes

rst.shape  torch.Size([1, 1474, 128])
m.shape torch.Size([1204, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4959716796875 GB
    Memory Allocated: 0.2851133346557617  GigaBytes
Max Memory Allocated: 0.2858858108520508  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4959716796875 GB
    Memory Allocated: 0.2851133346557617  GigaBytes
Max Memory Allocated: 0.2858858108520508  GigaBytes

 h.shape torch.Size([1, 1204, 128]), torch.Size([1, 1204, 128])
----------------------------------------3
 Nvidia-smi: 1.4959716796875 GB
    Memory Allocated: 0.28626155853271484  GigaBytes
Max Memory Allocated: 0.28626155853271484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.33624935150146484  GigaBytes
Max Memory Allocated: 0.3397054672241211  GigaBytes

rst.shape  torch.Size([1, 1204, 128])
m.shape torch.Size([1053, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5623779296875 GB
    Memory Allocated: 0.3391900062561035  GigaBytes
Max Memory Allocated: 0.3397054672241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5623779296875 GB
    Memory Allocated: 0.3391900062561035  GigaBytes
Max Memory Allocated: 0.3397054672241211  GigaBytes

 h.shape torch.Size([1, 1053, 128]), torch.Size([1, 1053, 128])
----------------------------------------3
 Nvidia-smi: 1.5623779296875 GB
    Memory Allocated: 0.3401942253112793  GigaBytes
Max Memory Allocated: 0.3401942253112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.39040517807006836  GigaBytes
Max Memory Allocated: 0.3939199447631836  GigaBytes

rst.shape  torch.Size([1, 1053, 128])
m.shape torch.Size([932, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.39345836639404297  GigaBytes
Max Memory Allocated: 0.3939199447631836  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.39345836639404297  GigaBytes
Max Memory Allocated: 0.3939199447631836  GigaBytes

 h.shape torch.Size([1, 932, 128]), torch.Size([1, 932, 128])
----------------------------------------3
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.3943471908569336  GigaBytes
Max Memory Allocated: 0.3943471908569336  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6561279296875 GB
    Memory Allocated: 0.44646310806274414  GigaBytes
Max Memory Allocated: 0.45001840591430664  GigaBytes

rst.shape  torch.Size([1, 932, 128])
m.shape torch.Size([793, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.6561279296875 GB
    Memory Allocated: 0.44942188262939453  GigaBytes
Max Memory Allocated: 0.45001840591430664  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6561279296875 GB
    Memory Allocated: 0.44942188262939453  GigaBytes
Max Memory Allocated: 0.45001840591430664  GigaBytes

 h.shape torch.Size([1, 793, 128]), torch.Size([1, 793, 128])
----------------------------------------3
 Nvidia-smi: 1.6561279296875 GB
    Memory Allocated: 0.4501781463623047  GigaBytes
Max Memory Allocated: 0.4501781463623047  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7010498046875 GB
    Memory Allocated: 0.5000796318054199  GigaBytes
Max Memory Allocated: 0.5034828186035156  GigaBytes

rst.shape  torch.Size([1, 793, 128])
m.shape torch.Size([7200, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.5348577499389648  GigaBytes
Max Memory Allocated: 0.5356626510620117  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.5348577499389648  GigaBytes
Max Memory Allocated: 0.5356626510620117  GigaBytes

 h.shape torch.Size([1, 3600, 128]), torch.Size([1, 3600, 128])
----------------------------------------3
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.5382909774780273  GigaBytes
Max Memory Allocated: 0.5382909774780273  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.787358283996582  GigaBytes
Max Memory Allocated: 0.804936408996582  GigaBytes

rst 0 shape torch.Size([1, 3600, 128])
----------------------------------------1
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.787358283996582  GigaBytes
Max Memory Allocated: 0.804936408996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.787358283996582  GigaBytes
Max Memory Allocated: 0.804936408996582  GigaBytes

 h.shape torch.Size([1, 3600, 128]), torch.Size([1, 3600, 128])
----------------------------------------3
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.7907915115356445  GigaBytes
Max Memory Allocated: 0.804936408996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3397216796875 GB
    Memory Allocated: 1.037785530090332  GigaBytes
Max Memory Allocated: 1.0570802688598633  GigaBytes

rst 1 shape torch.Size([1, 3600, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.9832816123962402  GigaBytes
Max Memory Allocated: 1.0648012161254883  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 1.0027251243591309  GigaBytes
Max Memory Allocated: 1.0648012161254883  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 1.0221686363220215  GigaBytes
Max Memory Allocated: 1.0648012161254883  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 1.002573013305664  GigaBytes
Max Memory Allocated: 1.0648012161254883  GigaBytes

torch.Size([20388, 256])
first layer input nodes number: 31671
first layer output nodes number: 20388
edges number: 127022
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 1.0224065780639648  GigaBytes
Max Memory Allocated: 1.0648012161254883  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 1.0418500900268555  GigaBytes
Max Memory Allocated: 1.0648012161254883  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.3787841796875 GB
    Memory Allocated: 1.0477361679077148  GigaBytes
Max Memory Allocated: 1.0671796798706055  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.3787841796875 GB
    Memory Allocated: 1.0477361679077148  GigaBytes
Max Memory Allocated: 1.0671796798706055  GigaBytes

m.shape torch.Size([1593, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 1.14186429977417  GigaBytes
Max Memory Allocated: 1.1418704986572266  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 1.14186429977417  GigaBytes
Max Memory Allocated: 1.1418704986572266  GigaBytes

 h.shape torch.Size([1, 1593, 256]), torch.Size([1, 1593, 256])
----------------------------------------3
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 1.1457486152648926  GigaBytes
Max Memory Allocated: 1.1457486152648926  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 1.1709227561950684  GigaBytes
Max Memory Allocated: 1.1724419593811035  GigaBytes

rst.shape  torch.Size([1, 1593, 256])
m.shape torch.Size([1372, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 1.1714344024658203  GigaBytes
Max Memory Allocated: 1.1724419593811035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 1.1714344024658203  GigaBytes
Max Memory Allocated: 1.1724419593811035  GigaBytes

 h.shape torch.Size([1, 1372, 256]), torch.Size([1, 1372, 256])
----------------------------------------3
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 1.1741676330566406  GigaBytes
Max Memory Allocated: 1.1741676330566406  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 1.2174482345581055  GigaBytes
Max Memory Allocated: 1.2200651168823242  GigaBytes

rst.shape  torch.Size([1, 1372, 256])
m.shape torch.Size([1182, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 1.2191944122314453  GigaBytes
Max Memory Allocated: 1.2200651168823242  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 1.2191944122314453  GigaBytes
Max Memory Allocated: 1.2200651168823242  GigaBytes

 h.shape torch.Size([1, 1182, 256]), torch.Size([1, 1182, 256])
----------------------------------------3
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 1.2216434478759766  GigaBytes
Max Memory Allocated: 1.2216434478759766  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4901123046875 GB
    Memory Allocated: 1.2734956741333008  GigaBytes
Max Memory Allocated: 1.2778444290161133  GigaBytes

rst.shape  torch.Size([1, 1182, 256])
m.shape torch.Size([913, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.4901123046875 GB
    Memory Allocated: 1.276209831237793  GigaBytes
Max Memory Allocated: 1.2778444290161133  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4901123046875 GB
    Memory Allocated: 1.276209831237793  GigaBytes
Max Memory Allocated: 1.2778444290161133  GigaBytes

 h.shape torch.Size([1, 913, 256]), torch.Size([1, 913, 256])
----------------------------------------3
 Nvidia-smi: 2.4901123046875 GB
    Memory Allocated: 1.2779512405395508  GigaBytes
Max Memory Allocated: 1.2779512405395508  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5369873046875 GB
    Memory Allocated: 1.328516960144043  GigaBytes
Max Memory Allocated: 1.3319997787475586  GigaBytes

rst.shape  torch.Size([1, 913, 256])
m.shape torch.Size([776, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.5369873046875 GB
    Memory Allocated: 1.3313755989074707  GigaBytes
Max Memory Allocated: 1.3319997787475586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5369873046875 GB
    Memory Allocated: 1.3313755989074707  GigaBytes
Max Memory Allocated: 1.3319997787475586  GigaBytes

 h.shape torch.Size([1, 776, 256]), torch.Size([1, 776, 256])
----------------------------------------3
 Nvidia-smi: 2.5369873046875 GB
    Memory Allocated: 1.3328557014465332  GigaBytes
Max Memory Allocated: 1.3328557014465332  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.3861393928527832  GigaBytes
Max Memory Allocated: 1.3898396492004395  GigaBytes

rst.shape  torch.Size([1, 776, 256])
m.shape torch.Size([624, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.388998031616211  GigaBytes
Max Memory Allocated: 1.3898396492004395  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.388998031616211  GigaBytes
Max Memory Allocated: 1.3898396492004395  GigaBytes

 h.shape torch.Size([1, 624, 256]), torch.Size([1, 624, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.390188217163086  GigaBytes
Max Memory Allocated: 1.390188217163086  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6541748046875 GB
    Memory Allocated: 1.4421272277832031  GigaBytes
Max Memory Allocated: 1.4456977844238281  GigaBytes

rst.shape  torch.Size([1, 624, 256])
m.shape torch.Size([543, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.6541748046875 GB
    Memory Allocated: 1.445185661315918  GigaBytes
Max Memory Allocated: 1.4456977844238281  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6541748046875 GB
    Memory Allocated: 1.445185661315918  GigaBytes
Max Memory Allocated: 1.4456977844238281  GigaBytes

 h.shape torch.Size([1, 543, 256]), torch.Size([1, 543, 256])
----------------------------------------3
 Nvidia-smi: 2.6541748046875 GB
    Memory Allocated: 1.4462213516235352  GigaBytes
Max Memory Allocated: 1.4462213516235352  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7225341796875 GB
    Memory Allocated: 1.500077247619629  GigaBytes
Max Memory Allocated: 1.503702163696289  GigaBytes

rst.shape  torch.Size([1, 543, 256])
m.shape torch.Size([476, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.7225341796875 GB
    Memory Allocated: 1.5032196044921875  GigaBytes
Max Memory Allocated: 1.503702163696289  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7225341796875 GB
    Memory Allocated: 1.5032196044921875  GigaBytes
Max Memory Allocated: 1.503702163696289  GigaBytes

 h.shape torch.Size([1, 476, 256]), torch.Size([1, 476, 256])
----------------------------------------3
 Nvidia-smi: 2.7225341796875 GB
    Memory Allocated: 1.5041275024414062  GigaBytes
Max Memory Allocated: 1.5041275024414062  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7694091796875 GB
    Memory Allocated: 1.5559616088867188  GigaBytes
Max Memory Allocated: 1.5595932006835938  GigaBytes

rst.shape  torch.Size([1, 476, 256])
m.shape torch.Size([398, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.7694091796875 GB
    Memory Allocated: 1.558950424194336  GigaBytes
Max Memory Allocated: 1.5595932006835938  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7694091796875 GB
    Memory Allocated: 1.558950424194336  GigaBytes
Max Memory Allocated: 1.5595932006835938  GigaBytes

 h.shape torch.Size([1, 398, 256]), torch.Size([1, 398, 256])
----------------------------------------3
 Nvidia-smi: 2.7694091796875 GB
    Memory Allocated: 1.5597095489501953  GigaBytes
Max Memory Allocated: 1.5597095489501953  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.6097126007080078  GigaBytes
Max Memory Allocated: 1.613128662109375  GigaBytes

rst.shape  torch.Size([1, 398, 256])
m.shape torch.Size([362, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.6128125190734863  GigaBytes
Max Memory Allocated: 1.613128662109375  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 1.6128125190734863  GigaBytes
Max Memory Allocated: 1.613128662109375  GigaBytes

 h.shape torch.Size([1, 362, 256]), torch.Size([1, 362, 256])
----------------------------------------3
 Nvidia-smi: 2.8162841796875 GB
    Memory Allocated: 1.6135029792785645  GigaBytes
Max Memory Allocated: 1.6135029792785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8826904296875 GB
    Memory Allocated: 1.6629223823547363  GigaBytes
Max Memory Allocated: 1.666374683380127  GigaBytes

rst.shape  torch.Size([1, 362, 256])
m.shape torch.Size([315, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.8826904296875 GB
    Memory Allocated: 1.665907859802246  GigaBytes
Max Memory Allocated: 1.666374683380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8826904296875 GB
    Memory Allocated: 1.665907859802246  GigaBytes
Max Memory Allocated: 1.666374683380127  GigaBytes

 h.shape torch.Size([1, 315, 256]), torch.Size([1, 315, 256])
----------------------------------------3
 Nvidia-smi: 2.8826904296875 GB
    Memory Allocated: 1.666508674621582  GigaBytes
Max Memory Allocated: 1.666508674621582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9295654296875 GB
    Memory Allocated: 1.7145652770996094  GigaBytes
Max Memory Allocated: 1.717869758605957  GigaBytes

rst.shape  torch.Size([1, 315, 256])
m.shape torch.Size([263, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.9295654296875 GB
    Memory Allocated: 1.7172985076904297  GigaBytes
Max Memory Allocated: 1.717869758605957  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9295654296875 GB
    Memory Allocated: 1.7172985076904297  GigaBytes
Max Memory Allocated: 1.717869758605957  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 2.9295654296875 GB
    Memory Allocated: 1.7178001403808594  GigaBytes
Max Memory Allocated: 1.717869758605957  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9549560546875 GB
    Memory Allocated: 1.761052131652832  GigaBytes
Max Memory Allocated: 1.764531135559082  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([232, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.9549560546875 GB
    Memory Allocated: 1.764303207397461  GigaBytes
Max Memory Allocated: 1.764531135559082  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9549560546875 GB
    Memory Allocated: 1.764303207397461  GigaBytes
Max Memory Allocated: 1.764531135559082  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 2.9549560546875 GB
    Memory Allocated: 1.7647457122802734  GigaBytes
Max Memory Allocated: 1.7647457122802734  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0174560546875 GB
    Memory Allocated: 1.8054561614990234  GigaBytes
Max Memory Allocated: 1.8083324432373047  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([210, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.0174560546875 GB
    Memory Allocated: 1.808060646057129  GigaBytes
Max Memory Allocated: 1.8083324432373047  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0174560546875 GB
    Memory Allocated: 1.808060646057129  GigaBytes
Max Memory Allocated: 1.8083324432373047  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 3.0174560546875 GB
    Memory Allocated: 1.8084611892700195  GigaBytes
Max Memory Allocated: 1.8084611892700195  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0604248046875 GB
    Memory Allocated: 1.8481149673461914  GigaBytes
Max Memory Allocated: 1.8509187698364258  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([196, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.0604248046875 GB
    Memory Allocated: 1.8507404327392578  GigaBytes
Max Memory Allocated: 1.8509187698364258  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0604248046875 GB
    Memory Allocated: 1.8507404327392578  GigaBytes
Max Memory Allocated: 1.8509187698364258  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 3.0604248046875 GB
    Memory Allocated: 1.851114273071289  GigaBytes
Max Memory Allocated: 1.851114273071289  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1033935546875 GB
    Memory Allocated: 1.8907413482666016  GigaBytes
Max Memory Allocated: 1.893545150756836  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([154, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.1033935546875 GB
    Memory Allocated: 1.8929228782653809  GigaBytes
Max Memory Allocated: 1.893545150756836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1033935546875 GB
    Memory Allocated: 1.8929228782653809  GigaBytes
Max Memory Allocated: 1.893545150756836  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 3.1033935546875 GB
    Memory Allocated: 1.893216609954834  GigaBytes
Max Memory Allocated: 1.893545150756836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1346435546875 GB
    Memory Allocated: 1.926408290863037  GigaBytes
Max Memory Allocated: 1.928758144378662  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([172, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.1346435546875 GB
    Memory Allocated: 1.9290719032287598  GigaBytes
Max Memory Allocated: 1.9290828704833984  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1346435546875 GB
    Memory Allocated: 1.9290719032287598  GigaBytes
Max Memory Allocated: 1.9290828704833984  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 3.1346435546875 GB
    Memory Allocated: 1.9293999671936035  GigaBytes
Max Memory Allocated: 1.9293999671936035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.9687676429748535  GigaBytes
Max Memory Allocated: 1.9715561866760254  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([123, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.9707317352294922  GigaBytes
Max Memory Allocated: 1.9715561866760254  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.9707317352294922  GigaBytes
Max Memory Allocated: 1.9715561866760254  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.9709663391113281  GigaBytes
Max Memory Allocated: 1.9715561866760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1971435546875 GB
    Memory Allocated: 2.000761032104492  GigaBytes
Max Memory Allocated: 2.0028724670410156  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([111, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.1971435546875 GB
    Memory Allocated: 2.0026707649230957  GigaBytes
Max Memory Allocated: 2.0028724670410156  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1971435546875 GB
    Memory Allocated: 2.0026707649230957  GigaBytes
Max Memory Allocated: 2.0028724670410156  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 3.1971435546875 GB
    Memory Allocated: 2.002882480621338  GigaBytes
Max Memory Allocated: 2.002882480621338  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2264404296875 GB
    Memory Allocated: 2.031252384185791  GigaBytes
Max Memory Allocated: 2.033263683319092  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([128, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2264404296875 GB
    Memory Allocated: 2.033607006072998  GigaBytes
Max Memory Allocated: 2.033616542816162  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2264404296875 GB
    Memory Allocated: 2.033607006072998  GigaBytes
Max Memory Allocated: 2.033616542816162  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 3.2264404296875 GB
    Memory Allocated: 2.033851146697998  GigaBytes
Max Memory Allocated: 2.033851146697998  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2791748046875 GB
    Memory Allocated: 2.068274974822998  GigaBytes
Max Memory Allocated: 2.070716381072998  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([115, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2791748046875 GB
    Memory Allocated: 2.070474147796631  GigaBytes
Max Memory Allocated: 2.070716381072998  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2791748046875 GB
    Memory Allocated: 2.070474147796631  GigaBytes
Max Memory Allocated: 2.070716381072998  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.2811279296875 GB
    Memory Allocated: 2.0706934928894043  GigaBytes
Max Memory Allocated: 2.070716381072998  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3143310546875 GB
    Memory Allocated: 2.103156566619873  GigaBytes
Max Memory Allocated: 2.105459690093994  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([64, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.3143310546875 GB
    Memory Allocated: 2.105278491973877  GigaBytes
Max Memory Allocated: 2.105459690093994  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3143310546875 GB
    Memory Allocated: 2.105278491973877  GigaBytes
Max Memory Allocated: 2.105459690093994  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.3143310546875 GB
    Memory Allocated: 2.105400562286377  GigaBytes
Max Memory Allocated: 2.105459690093994  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3299560546875 GB
    Memory Allocated: 2.124321460723877  GigaBytes
Max Memory Allocated: 2.125664234161377  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([77, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.3299560546875 GB
    Memory Allocated: 2.125962734222412  GigaBytes
Max Memory Allocated: 2.125969409942627  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3299560546875 GB
    Memory Allocated: 2.125962734222412  GigaBytes
Max Memory Allocated: 2.125969409942627  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.3299560546875 GB
    Memory Allocated: 2.1261096000671387  GigaBytes
Max Memory Allocated: 2.1261096000671387  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 2.149901866912842  GigaBytes
Max Memory Allocated: 2.1515908241271973  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([73, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 2.151512622833252  GigaBytes
Max Memory Allocated: 2.1515908241271973  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 2.151512622833252  GigaBytes
Max Memory Allocated: 2.1515908241271973  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 2.1516518592834473  GigaBytes
Max Memory Allocated: 2.1516518592834473  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3787841796875 GB
    Memory Allocated: 2.175182819366455  GigaBytes
Max Memory Allocated: 2.176853656768799  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([1041, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 2.200697898864746  GigaBytes
Max Memory Allocated: 2.2007951736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 2.200697898864746  GigaBytes
Max Memory Allocated: 2.2007951736450195  GigaBytes

 h.shape torch.Size([1, 1041, 256]), torch.Size([1, 1041, 256])
----------------------------------------3
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 2.2026872634887695  GigaBytes
Max Memory Allocated: 2.2026872634887695  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 2.563802719116211  GigaBytes
Max Memory Allocated: 2.589193344116211  GigaBytes

rst.shape  torch.Size([1, 1041, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 2.48142147064209  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 2.4840755462646484  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 2.4857912063598633  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 2.483051300048828  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

torch.Size([11513, 40])
input nodes number: 20388
output nodes number: 11513
edges number: 95129
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 2.4850049018859863  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 2.4850058555603027  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.02782440185546875  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

pseudo mini batch 1 input nodes size: 35559
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.022980213165283203  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.022980213165283203  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.0405583381652832  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.040644168853759766  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.024933338165283203  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.026623249053955078  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.026623249053955078  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.026623249053955078  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

torch.Size([35559, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.026623249053955078  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

m.shape torch.Size([1650, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.09173011779785156  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.09173011779785156  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

 h.shape torch.Size([1, 1650, 128]), torch.Size([1, 1650, 128])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.09330368041992188  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.10589218139648438  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

rst.shape  torch.Size([1, 1650, 128])
m.shape torch.Size([1948, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.1069631576538086  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.1069631576538086  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

 h.shape torch.Size([1, 1948, 128]), torch.Size([1, 1948, 128])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.10882091522216797  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.1372976303100586  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

rst.shape  torch.Size([1, 1948, 128])
m.shape torch.Size([1774, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.1390848159790039  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.1390848159790039  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

 h.shape torch.Size([1, 1774, 128]), torch.Size([1, 1774, 128])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.1407766342163086  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.17799663543701172  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

rst.shape  torch.Size([1, 1774, 128])
m.shape torch.Size([1584, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.18017196655273438  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.18017196655273438  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

 h.shape torch.Size([1, 1584, 128]), torch.Size([1, 1584, 128])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.18168258666992188  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.22549057006835938  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

rst.shape  torch.Size([1, 1584, 128])
m.shape torch.Size([1352, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.22795867919921875  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.22795867919921875  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

 h.shape torch.Size([1, 1352, 128]), torch.Size([1, 1352, 128])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.229248046875  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.276092529296875  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

rst.shape  torch.Size([1, 1352, 128])
m.shape torch.Size([1235, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.27898120880126953  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.27898120880126953  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

 h.shape torch.Size([1, 1235, 128]), torch.Size([1, 1235, 128])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.28015899658203125  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.33149051666259766  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

rst.shape  torch.Size([1, 1235, 128])
m.shape torch.Size([1093, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.3345499038696289  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.3345499038696289  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

 h.shape torch.Size([1, 1093, 128]), torch.Size([1, 1093, 128])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.33559226989746094  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.38944435119628906  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

rst.shape  torch.Size([1, 1093, 128])
m.shape torch.Size([982, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.3926692008972168  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.3926692008972168  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

 h.shape torch.Size([1, 982, 128]), torch.Size([1, 982, 128])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.39360570907592773  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.4481654167175293  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

rst.shape  torch.Size([1, 982, 128])
m.shape torch.Size([825, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.45123767852783203  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.45123767852783203  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

 h.shape torch.Size([1, 825, 128]), torch.Size([1, 825, 128])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.4520244598388672  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.5038514137268066  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

rst.shape  torch.Size([1, 825, 128])
m.shape torch.Size([7694, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.5401458740234375  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.5401458740234375  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

 h.shape torch.Size([1, 3847, 128]), torch.Size([1, 3847, 128])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.5438146591186523  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.8042984008789062  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

rst 0 shape torch.Size([1, 3847, 128])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.8042984008789062  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.8042984008789062  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

 h.shape torch.Size([1, 3847, 128]), torch.Size([1, 3847, 128])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 0.8079671859741211  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.0666165351867676  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

rst 1 shape torch.Size([1, 3847, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.0117454528808594  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.0312767028808594  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.0508079528808594  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.0311264991760254  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

torch.Size([20137, 256])
first layer input nodes number: 35559
first layer output nodes number: 20137
edges number: 131246
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.0510749816894531  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.0706062316894531  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.0754623413085938  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.0754623413085938  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

m.shape torch.Size([1291, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.1698293685913086  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.1698293685913086  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

 h.shape torch.Size([1, 1291, 256]), torch.Size([1, 1291, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.1726512908935547  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.1930522918701172  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

rst.shape  torch.Size([1, 1291, 256])
m.shape torch.Size([1341, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.1943988800048828  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.1943988800048828  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

 h.shape torch.Size([1, 1341, 256]), torch.Size([1, 1341, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.1979742050170898  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.237227439880371  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

rst.shape  torch.Size([1, 1341, 256])
m.shape torch.Size([1131, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.2392034530639648  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.2392034530639648  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

 h.shape torch.Size([1, 1131, 256]), torch.Size([1, 1131, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.2415781021118164  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.2926149368286133  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

rst.shape  torch.Size([1, 1131, 256])
m.shape torch.Size([977, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.2956418991088867  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.2956418991088867  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

 h.shape torch.Size([1, 977, 256]), torch.Size([1, 977, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.2975053787231445  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.3527517318725586  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

rst.shape  torch.Size([1, 977, 256])
m.shape torch.Size([795, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.3556408882141113  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.3556408882141113  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

 h.shape torch.Size([1, 795, 256]), torch.Size([1, 795, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.3571572303771973  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.411745548248291  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

rst.shape  torch.Size([1, 795, 256])
m.shape torch.Size([695, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.4149956703186035  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.4149956703186035  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

 h.shape torch.Size([1, 695, 256]), torch.Size([1, 695, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.4163212776184082  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.4752678871154785  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

rst.shape  torch.Size([1, 695, 256])
m.shape torch.Size([591, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.478581428527832  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.478581428527832  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

 h.shape torch.Size([1, 591, 256]), torch.Size([1, 591, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.4797086715698242  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.5360708236694336  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

rst.shape  torch.Size([1, 591, 256])
m.shape torch.Size([492, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.539290428161621  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.539290428161621  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

 h.shape torch.Size([1, 492, 256]), torch.Size([1, 492, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.5402288436889648  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.5952444076538086  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

rst.shape  torch.Size([1, 492, 256])
m.shape torch.Size([455, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.5987110137939453  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.5987110137939453  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

 h.shape torch.Size([1, 455, 256]), torch.Size([1, 455, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.599578857421875  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.6568918228149414  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

rst.shape  torch.Size([1, 455, 256])
m.shape torch.Size([422, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.6605138778686523  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.6605138778686523  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

 h.shape torch.Size([1, 422, 256]), torch.Size([1, 422, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.6613187789916992  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.7193737030029297  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

rst.shape  torch.Size([1, 422, 256])
m.shape torch.Size([372, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.7229042053222656  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.7229042053222656  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

 h.shape torch.Size([1, 372, 256]), torch.Size([1, 372, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.7236137390136719  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.779810905456543  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

rst.shape  torch.Size([1, 372, 256])
m.shape torch.Size([306, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.7829856872558594  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.7829856872558594  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.7835693359375  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.833918571472168  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([277, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.8370881080627441  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.8370881080627441  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.8376164436340332  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.886847972869873  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

rst.shape  torch.Size([1, 277, 256])
m.shape torch.Size([232, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.8897056579589844  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.8897056579589844  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.8901481628417969  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.9339561462402344  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([183, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.936373233795166  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.936373233795166  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.9367222785949707  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.9737210273742676  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([157, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.9759612083435059  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.9759612083435059  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 1.9762606620788574  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.010098934173584  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([161, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.012579917907715  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.012579917907715  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.0128870010375977  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.049736976623535  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([147, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.052126884460449  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.052126884460449  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.0524072647094727  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.088015556335449  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([108, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.089848041534424  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.089848041534424  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.0900540351867676  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.11765718460083  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([123, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.1199188232421875  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.1199188232421875  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.1201534271240234  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.1532325744628906  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([106, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.15525484085083  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.15525484085083  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.155457019805908  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.1853795051574707  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([98, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.1873507499694824  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.1873507499694824  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.187537670135498  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.21651029586792  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([67, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.217996597290039  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.217996597290039  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.2181243896484375  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.2388267517089844  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([72, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.2407593727111816  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.2407593727111816  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.240896701812744  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.2641053199768066  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([888, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.2853736877441406  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.2853736877441406  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

 h.shape torch.Size([1, 888, 256]), torch.Size([1, 888, 256])
----------------------------------------3
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.287067413330078  GigaBytes
Max Memory Allocated: 2.595794200897217  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 2.585163116455078  GigaBytes
Max Memory Allocated: 2.606334686279297  GigaBytes

rst.shape  torch.Size([1, 888, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 2.5031352043151855  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 2.5049376487731934  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 2.5074410438537598  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 2.5055527687072754  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

torch.Size([11487, 40])
input nodes number: 20137
output nodes number: 11487
edges number: 95423
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 2.505875587463379  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 2.505876064300537  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.029956340789794922  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

pseudo mini batch 2 input nodes size: 32958
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.025020122528076172  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.025020122528076172  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.040735721588134766  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.04082202911376953  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.02315807342529297  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.024498939514160156  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.024498939514160156  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.024498939514160156  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

torch.Size([32958, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.024498939514160156  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

m.shape torch.Size([2658, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.0791935920715332  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.0791935920715332  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 2658, 128]), torch.Size([1, 2658, 128])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.08172845840454102  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.10200738906860352  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 2658, 128])
m.shape torch.Size([2587, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.10327482223510742  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.10327482223510742  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 2587, 128]), torch.Size([1, 2587, 128])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.10619163513183594  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.1439657211303711  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 2587, 128])
m.shape torch.Size([2330, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.14643287658691406  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.14643287658691406  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 2330, 128]), torch.Size([1, 2330, 128])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.14865493774414062  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.19885873794555664  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 2330, 128])
m.shape torch.Size([1950, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.20146703720092773  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.20146703720092773  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 1950, 128]), torch.Size([1, 1950, 128])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.20332670211791992  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.2591261863708496  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 1950, 128])
m.shape torch.Size([1636, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.2620968818664551  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.2620968818664551  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 1636, 128]), torch.Size([1, 1636, 128])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.2636570930480957  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.3214421272277832  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 1636, 128])
m.shape torch.Size([1284, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.32433557510375977  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.32433557510375977  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 1284, 128]), torch.Size([1, 1284, 128])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.3255600929260254  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.37821435928344727  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 1284, 128])
m.shape torch.Size([1078, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.38120031356811523  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.38120031356811523  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 1078, 128]), torch.Size([1, 1078, 128])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.38222837448120117  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.4345088005065918  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 1078, 128])
m.shape torch.Size([970, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.4376950263977051  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.4376950263977051  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 970, 128]), torch.Size([1, 970, 128])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.43862009048461914  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.4917607307434082  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 970, 128])
m.shape torch.Size([775, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.49462413787841797  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.49462413787841797  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 775, 128]), torch.Size([1, 775, 128])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.4953632354736328  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.5429801940917969  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 775, 128])
m.shape torch.Size([4675, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.5649027824401855  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.5649027824401855  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 2337, 128]), torch.Size([1, 2337, 128])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.5674023628234863  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.7318277359008789  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst 0 shape torch.Size([1, 2337, 128])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.7318277359008789  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.7318277359008789  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 2338, 128]), torch.Size([1, 2338, 128])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.7346439361572266  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.8958897590637207  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst 1 shape torch.Size([1, 2338, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.851982593536377  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.871513843536377  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.891045093536377  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.8713650703430176  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

torch.Size([19943, 256])
first layer input nodes number: 32958
first layer output nodes number: 19943
edges number: 107537
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.8912925720214844  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.9108238220214844  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.9158620834350586  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.9158620834350586  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

m.shape torch.Size([1948, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.9876565933227539  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.9876565933227539  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 1948, 256]), torch.Size([1, 1948, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.9913721084594727  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.022562026977539  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 1948, 256])
m.shape torch.Size([1680, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.0244450569152832  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.0244450569152832  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 1680, 256]), torch.Size([1, 1680, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.0276494026184082  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.0763249397277832  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 1680, 256])
m.shape torch.Size([1364, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.0795598030090332  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.0795598030090332  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 1364, 256]), torch.Size([1, 1364, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.082505702972412  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.1399893760681152  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 1364, 256])
m.shape torch.Size([1090, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.1428604125976562  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.1428604125976562  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 1090, 256]), torch.Size([1, 1090, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.145176887512207  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.2084369659423828  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 1090, 256])
m.shape torch.Size([881, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.2116312980651855  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.2116312980651855  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 881, 256]), torch.Size([1, 881, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.2133116722106934  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.2743659019470215  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 881, 256])
m.shape torch.Size([690, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.2775049209594727  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.2775049209594727  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 690, 256]), torch.Size([1, 690, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.2788209915161133  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.3356027603149414  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 690, 256])
m.shape torch.Size([580, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.3388471603393555  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.3388471603393555  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 580, 256]), torch.Size([1, 580, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.3399534225463867  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.395552635192871  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 580, 256])
m.shape torch.Size([488, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.3987517356872559  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.3987517356872559  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 488, 256]), torch.Size([1, 488, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.3996825218200684  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.4545683860778809  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 488, 256])
m.shape torch.Size([419, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.4577274322509766  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.4577274322509766  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 419, 256]), torch.Size([1, 419, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.458526611328125  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.5108108520507812  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 419, 256])
m.shape torch.Size([329, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.5135736465454102  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.5135736465454102  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 329, 256]), torch.Size([1, 329, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.5142011642456055  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.5599136352539062  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 329, 256])
m.shape torch.Size([300, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.5627717971801758  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.5627717971801758  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.5633440017700195  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.6080522537231445  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([238, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.610511302947998  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.610511302947998  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.6109652519226074  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.6495509147644043  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([202, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.651848316192627  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.651848316192627  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.652233600616455  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.6876797676086426  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([158, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.6896133422851562  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.6896133422851562  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.6899147033691406  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.7197494506835938  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([139, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.7216029167175293  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.7216029167175293  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.7218680381774902  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.7499709129333496  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([122, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.7520475387573242  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.7520475387573242  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.7522802352905273  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.7785749435424805  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([100, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.780092716217041  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.780092716217041  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.7802834510803223  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.8031716346740723  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([76, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.8043913841247559  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.8043913841247559  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.8045363426208496  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.8229460716247559  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([85, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.8244261741638184  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.8244261741638184  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.8245882987976074  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.8463129997253418  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([68, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.8475394248962402  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.8475394248962402  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.8476691246032715  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.8659567832946777  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([55, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.8670072555541992  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.8670072555541992  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.867112159729004  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.8826379776000977  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([49, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.8836236000061035  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.8836236000061035  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.8837170600891113  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.8982033729553223  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([47, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.8992042541503906  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.8992042541503906  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.8992938995361328  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.9138164520263672  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([37, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.9146251678466797  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.9146251678466797  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.9146957397460938  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.9266223907470703  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([387, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.9358863830566406  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.9358863830566406  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 387, 256]), torch.Size([1, 387, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.936624526977539  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 2.068347930908203  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 387, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 2.0098094940185547  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 2.011667251586914  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 2.013385772705078  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 2.011441707611084  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

torch.Size([11532, 40])
input nodes number: 19943
output nodes number: 11532
edges number: 72281
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 2.0115928649902344  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 2.0115933418273926  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.02711629867553711  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

pseudo mini batch 3 input nodes size: 41160
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.02307415008544922  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.02307415008544922  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.042700767517089844  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.04278707504272461  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.02698516845703125  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.028494834899902344  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.028494834899902344  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.028494834899902344  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

torch.Size([41160, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.028494834899902344  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

m.shape torch.Size([2816, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.09295320510864258  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.09295320510864258  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 2816, 128]), torch.Size([1, 2816, 128])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.09563875198364258  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.11787271499633789  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 2816, 128])
m.shape torch.Size([2989, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.11938047409057617  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.11938047409057617  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 2989, 128]), torch.Size([1, 2989, 128])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.12223100662231445  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.16613340377807617  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 2989, 128])
m.shape torch.Size([2540, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.16786670684814453  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.16786670684814453  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 2540, 128]), torch.Size([1, 2540, 128])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.17102718353271484  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.22577333450317383  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 2540, 128])
m.shape torch.Size([2121, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.2284550666809082  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.2284550666809082  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 2121, 128]), torch.Size([1, 2121, 128])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.23102426528930664  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.2911257743835449  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 2121, 128])
m.shape torch.Size([1756, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.29430103302001953  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.29430103302001953  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 1756, 128]), torch.Size([1, 1756, 128])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.2959756851196289  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.35681819915771484  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 1756, 128])
m.shape torch.Size([1395, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.3599720001220703  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.3599720001220703  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 1395, 128]), torch.Size([1, 1395, 128])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.36130237579345703  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.42073917388916016  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 1395, 128])
m.shape torch.Size([1195, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.42406272888183594  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.42406272888183594  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 1195, 128]), torch.Size([1, 1195, 128])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.4252023696899414  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.48218441009521484  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 1195, 128])
m.shape torch.Size([1051, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.485623836517334  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.485623836517334  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 1051, 128]), torch.Size([1, 1051, 128])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.48662614822387695  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.5437579154968262  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 1051, 128])
m.shape torch.Size([907, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.5471491813659668  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.5471491813659668  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 907, 128]), torch.Size([1, 907, 128])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.5480141639709473  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.6045131683349609  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 907, 128])
m.shape torch.Size([6156, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.6334347724914551  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.6334347724914551  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 3078, 128]), torch.Size([1, 3078, 128])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.6364140510559082  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.8500003814697266  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst 0 shape torch.Size([1, 3078, 128])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.8500003814697266  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.8500003814697266  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 3078, 128]), torch.Size([1, 3078, 128])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.8533868789672852  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.0652952194213867  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst 1 shape torch.Size([1, 3078, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.0125794410705566  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.0344433784484863  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.056307315826416  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.0342721939086914  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

torch.Size([22926, 256])
first layer input nodes number: 41160
first layer output nodes number: 22926
edges number: 128544
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.0566163063049316  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.0784802436828613  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.084144115447998  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.084144115447998  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

m.shape torch.Size([1975, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.1575899124145508  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.1575899124145508  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 1975, 256]), torch.Size([1, 1975, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.1613569259643555  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.192108154296875  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 1975, 256])
m.shape torch.Size([1784, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.1940183639526367  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.1940183639526367  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 1784, 256]), torch.Size([1, 1784, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.1974210739135742  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.2503643035888672  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 1784, 256])
m.shape torch.Size([1374, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.2518086433410645  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.2518086433410645  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 1374, 256]), torch.Size([1, 1374, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.2545504570007324  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.3143835067749023  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 1374, 256])
m.shape torch.Size([1084, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.3172407150268555  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.3172407150268555  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 1084, 256]), torch.Size([1, 1084, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.3193445205688477  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.3828506469726562  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 1084, 256])
m.shape torch.Size([876, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.385103702545166  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.385103702545166  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 876, 256]), torch.Size([1, 876, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.3867745399475098  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.4486489295959473  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 876, 256])
m.shape torch.Size([647, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.4515447616577148  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.4515447616577148  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 647, 256]), torch.Size([1, 647, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.4527788162231445  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.507065773010254  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 647, 256])
m.shape torch.Size([514, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.5099072456359863  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.5099072456359863  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 514, 256]), torch.Size([1, 514, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.510887622833252  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.5605206489562988  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 514, 256])
m.shape torch.Size([460, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.5635676383972168  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.5635676383972168  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.5644450187683105  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.6153311729431152  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([368, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.6180758476257324  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.6180758476257324  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 368, 256]), torch.Size([1, 368, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.6187777519226074  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.66463041305542  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 368, 256])
m.shape torch.Size([320, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.6673550605773926  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.6673550605773926  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 320, 256]), torch.Size([1, 320, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.6679654121398926  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.7118725776672363  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 320, 256])
m.shape torch.Size([219, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.7138829231262207  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.7138829231262207  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.7143006324768066  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.7468819618225098  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([210, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.7490954399108887  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.7490954399108887  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.7494959831237793  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.7835421562194824  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([172, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.7854909896850586  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.7854909896850586  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.7858190536499023  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.8160009384155273  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([166, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.8187870979309082  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.8187870979309082  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.819103717803955  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.8504490852355957  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([152, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.8524823188781738  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.8524823188781738  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.8527722358703613  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.8835034370422363  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([109, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.8850350379943848  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.8850350379943848  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.8852429389953613  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.908735752105713  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([100, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.9102659225463867  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.9102659225463867  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.910456657409668  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.933344841003418  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([103, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.9350314140319824  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.9350314140319824  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.935227870941162  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.9601778984069824  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([85, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.961632251739502  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.961632251739502  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.961794376373291  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.9835190773010254  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([67, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.9847259521484375  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.9847259521484375  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 1.984853744506836  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 2.0028724670410156  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([65, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 2.0041208267211914  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 2.0041208267211914  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 2.004244804382324  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 2.0225934982299805  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([53, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 2.0236525535583496  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 2.0236525535583496  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 2.0237536430358887  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 2.0394225120544434  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([54, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 2.0405659675598145  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 2.0405659675598145  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 2.0406689643859863  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 2.05735445022583  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([48, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 2.058410167694092  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 2.058410167694092  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 2.058501720428467  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 2.073974132537842  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([519, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 2.0863990783691406  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 2.0863990783691406  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 519, 256]), torch.Size([1, 519, 256])
----------------------------------------3
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 2.0873889923095703  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 2.2624435424804688  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 519, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 2.200409412384033  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 2.2022929191589355  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 2.204810619354248  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 2.202840805053711  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

torch.Size([11524, 40])
input nodes number: 22926
output nodes number: 11524
edges number: 73975
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 2.203263282775879  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 2.203263759613037  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.03167152404785156  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

pseudo mini batch 4 input nodes size: 67115
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.02715015411376953  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.02715015411376953  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.059153079986572266  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.05923652648925781  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.03952360153198242  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.0420536994934082  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.0420536994934082  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.0420536994934082  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

torch.Size([67115, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 0.0420536994934082  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

m.shape torch.Size([2714, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.16631698608398438  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.16631698608398438  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 2714, 128]), torch.Size([1, 2714, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.16947031021118164  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.1911158561706543  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 2714, 128])
m.shape torch.Size([2721, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.19241666793823242  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.19241666793823242  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 2721, 128]), torch.Size([1, 2721, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.19501161575317383  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.2354297637939453  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 2721, 128])
m.shape torch.Size([2304, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.23671722412109375  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.23671722412109375  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 2304, 128]), torch.Size([1, 2304, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.23919677734375  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.2890467643737793  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 2304, 128])
m.shape torch.Size([2043, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.2920985221862793  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.2920985221862793  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 2043, 128]), torch.Size([1, 2043, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.29404687881469727  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.35114240646362305  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 2043, 128])
m.shape torch.Size([1866, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.3546171188354492  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.3546171188354492  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 1866, 128]), torch.Size([1, 1866, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.3563966751098633  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.42096900939941406  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 1866, 128])
m.shape torch.Size([1566, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.4245595932006836  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.4245595932006836  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 1566, 128]), torch.Size([1, 1566, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.4260530471801758  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.49027156829833984  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 1566, 128])
m.shape torch.Size([1452, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.4943714141845703  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.4943714141845703  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 1452, 128]), torch.Size([1, 1452, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.4957561492919922  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.5654277801513672  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 1452, 128])
m.shape torch.Size([1377, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.5699882507324219  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.5699882507324219  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 1377, 128]), torch.Size([1, 1377, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.5713014602661133  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.6462650299072266  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 1377, 128])
m.shape torch.Size([1205, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.6507797241210938  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.6507797241210938  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 1205, 128]), torch.Size([1, 1205, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.6519289016723633  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.7254762649536133  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 1205, 128])
m.shape torch.Size([17608, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.8088631629943848  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.8088631629943848  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 8804, 128]), torch.Size([1, 8804, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 0.8172593116760254  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.4133858680725098  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst 0 shape torch.Size([1, 8804, 128])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.4133858680725098  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.4133858680725098  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 8804, 128]), torch.Size([1, 8804, 128])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.4217820167541504  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.0141148567199707  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst 1 shape torch.Size([1, 8804, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9064359664916992  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9396772384643555  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9729185104370117  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9394173622131348  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

torch.Size([34856, 256])
first layer input nodes number: 67115
first layer output nodes number: 34856
edges number: 250071
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 1.9734206199645996  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.006661891937256  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.0150580406188965  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.0150580406188965  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

m.shape torch.Size([1879, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.103426933288574  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.103426933288574  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 1879, 256]), torch.Size([1, 1879, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.108506202697754  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.140965461730957  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 1879, 256])
m.shape torch.Size([1561, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.1418871879577637  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.1418871879577637  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 1561, 256]), torch.Size([1, 1561, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.145052909851074  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.1908817291259766  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 1561, 256])
m.shape torch.Size([1136, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.1929168701171875  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.1929168701171875  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 1136, 256]), torch.Size([1, 1136, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.195159912109375  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.2437310218811035  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 1136, 256])
m.shape torch.Size([865, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.246109962463379  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.246109962463379  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 865, 256]), torch.Size([1, 865, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.2477598190307617  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.297215461730957  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 865, 256])
m.shape torch.Size([767, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.300076484680176  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.300076484680176  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 767, 256]), torch.Size([1, 767, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.301539421081543  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.3542051315307617  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 767, 256])
m.shape torch.Size([582, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.35683012008667  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.35683012008667  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 582, 256]), torch.Size([1, 582, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.357940196990967  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.4149813652038574  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 582, 256])
m.shape torch.Size([444, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.4174137115478516  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.4174137115478516  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 444, 256]), torch.Size([1, 444, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.4182605743408203  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.460603713989258  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 444, 256])
m.shape torch.Size([410, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.4633331298828125  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.4633331298828125  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 410, 256]), torch.Size([1, 410, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.4641151428222656  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.5086898803710938  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 410, 256])
m.shape torch.Size([326, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.5111188888549805  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.5111188888549805  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 326, 256]), torch.Size([1, 326, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.5117406845092773  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.5517730712890625  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 326, 256])
m.shape torch.Size([290, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.5542497634887695  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.5542497634887695  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 4.2479248046875 GB
    Memory Allocated: 2.554802894592285  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2674560546875 GB
    Memory Allocated: 2.596015453338623  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

rst.shape  torch.Size([1, 290, 256])
m.shape torch.Size([258, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.2674560546875 GB
    Memory Allocated: 2.5984668731689453  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2674560546875 GB
    Memory Allocated: 2.5984668731689453  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 4.2674560546875 GB
    Memory Allocated: 2.598958969116211  GigaBytes
Max Memory Allocated: 2.617225170135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2674560546875 GB
    Memory Allocated: 2.6386241912841797  GigaBytes
Max Memory Allocated: 2.6413307189941406  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([201, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.2674560546875 GB
    Memory Allocated: 2.6406965255737305  GigaBytes
Max Memory Allocated: 2.6413307189941406  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2674560546875 GB
    Memory Allocated: 2.6406965255737305  GigaBytes
Max Memory Allocated: 2.6413307189941406  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 4.2674560546875 GB
    Memory Allocated: 2.641079902648926  GigaBytes
Max Memory Allocated: 2.6413307189941406  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.6736669540405273  GigaBytes
Max Memory Allocated: 2.675967216491699  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([164, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.6755247116088867  GigaBytes
Max Memory Allocated: 2.675967216491699  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.6755247116088867  GigaBytes
Max Memory Allocated: 2.675967216491699  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.675837516784668  GigaBytes
Max Memory Allocated: 2.675967216491699  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.704615592956543  GigaBytes
Max Memory Allocated: 2.706648826599121  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([145, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.7064104080200195  GigaBytes
Max Memory Allocated: 2.706648826599121  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.7064104080200195  GigaBytes
Max Memory Allocated: 2.706648826599121  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.7066869735717773  GigaBytes
Max Memory Allocated: 2.7066869735717773  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.734066963195801  GigaBytes
Max Memory Allocated: 2.7360029220581055  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([125, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.7357311248779297  GigaBytes
Max Memory Allocated: 2.7360029220581055  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.7357311248779297  GigaBytes
Max Memory Allocated: 2.7360029220581055  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.7359695434570312  GigaBytes
Max Memory Allocated: 2.7360029220581055  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.761241912841797  GigaBytes
Max Memory Allocated: 2.7630300521850586  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([118, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.762937545776367  GigaBytes
Max Memory Allocated: 2.7630300521850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.762937545776367  GigaBytes
Max Memory Allocated: 2.7630300521850586  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.763162612915039  GigaBytes
Max Memory Allocated: 2.763162612915039  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.788595199584961  GigaBytes
Max Memory Allocated: 2.790395736694336  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([102, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.790149688720703  GigaBytes
Max Memory Allocated: 2.790395736694336  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.790149688720703  GigaBytes
Max Memory Allocated: 2.790395736694336  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.79034423828125  GigaBytes
Max Memory Allocated: 2.790395736694336  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.813690185546875  GigaBytes
Max Memory Allocated: 2.8153438568115234  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([109, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.815478801727295  GigaBytes
Max Memory Allocated: 2.815486431121826  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.815478801727295  GigaBytes
Max Memory Allocated: 2.815486431121826  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.8156867027282715  GigaBytes
Max Memory Allocated: 2.8156867027282715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.842090129852295  GigaBytes
Max Memory Allocated: 2.843961238861084  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([104, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.8438854217529297  GigaBytes
Max Memory Allocated: 2.843961238861084  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.8438854217529297  GigaBytes
Max Memory Allocated: 2.843961238861084  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.844083786010742  GigaBytes
Max Memory Allocated: 2.844083786010742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.870664596557617  GigaBytes
Max Memory Allocated: 2.872549057006836  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([97, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.8724303245544434  GigaBytes
Max Memory Allocated: 2.872549057006836  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.8724303245544434  GigaBytes
Max Memory Allocated: 2.872549057006836  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.872615337371826  GigaBytes
Max Memory Allocated: 2.872615337371826  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.8987021446228027  GigaBytes
Max Memory Allocated: 2.900552272796631  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([64, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.9002275466918945  GigaBytes
Max Memory Allocated: 2.900552272796631  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.9002275466918945  GigaBytes
Max Memory Allocated: 2.900552272796631  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.9003496170043945  GigaBytes
Max Memory Allocated: 2.900552272796631  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.9184160232543945  GigaBytes
Max Memory Allocated: 2.9196977615356445  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([62, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.919666290283203  GigaBytes
Max Memory Allocated: 2.9196977615356445  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.919666290283203  GigaBytes
Max Memory Allocated: 2.9196977615356445  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.9197845458984375  GigaBytes
Max Memory Allocated: 2.9197845458984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.9381141662597656  GigaBytes
Max Memory Allocated: 2.9394149780273438  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([53, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.9392271041870117  GigaBytes
Max Memory Allocated: 2.9394149780273438  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.9392271041870117  GigaBytes
Max Memory Allocated: 2.9394149780273438  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.939328193664551  GigaBytes
Max Memory Allocated: 2.9394149780273438  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.955704689025879  GigaBytes
Max Memory Allocated: 2.956867218017578  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([68, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.9579172134399414  GigaBytes
Max Memory Allocated: 2.957923412322998  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.9579172134399414  GigaBytes
Max Memory Allocated: 2.957923412322998  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.9580469131469727  GigaBytes
Max Memory Allocated: 2.9580469131469727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3065185546875 GB
    Memory Allocated: 2.979966163635254  GigaBytes
Max Memory Allocated: 2.981522560119629  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([1267, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.3377685546875 GB
    Memory Allocated: 3.010344982147217  GigaBytes
Max Memory Allocated: 3.010463237762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3377685546875 GB
    Memory Allocated: 3.010344982147217  GigaBytes
Max Memory Allocated: 3.010463237762451  GigaBytes

 h.shape torch.Size([1, 1267, 256]), torch.Size([1, 1267, 256])
----------------------------------------3
 Nvidia-smi: 4.3377685546875 GB
    Memory Allocated: 3.0127615928649902  GigaBytes
Max Memory Allocated: 3.0127615928649902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7987060546875 GB
    Memory Allocated: 3.4424490928649902  GigaBytes
Max Memory Allocated: 3.472656726837158  GigaBytes

rst.shape  torch.Size([1, 1267, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.7987060546875 GB
    Memory Allocated: 3.3652377128601074  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.7987060546875 GB
    Memory Allocated: 3.367654323577881  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7987060546875 GB
    Memory Allocated: 3.369323253631592  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.7987060546875 GB
    Memory Allocated: 3.366823196411133  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

torch.Size([11197, 40])
input nodes number: 34856
output nodes number: 11197
edges number: 89439
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7987060546875 GB
    Memory Allocated: 3.36769962310791  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.7987060546875 GB
    Memory Allocated: 3.3677000999450684  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.04718923568725586  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

pseudo mini batch 5 input nodes size: 53314
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.040056705474853516  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.040056705474853516  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.06547880172729492  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.06556272506713867  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03347635269165039  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03523588180541992  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03523588180541992  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03523588180541992  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

torch.Size([53314, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03523588180541992  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

m.shape torch.Size([2726, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11489677429199219  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11489677429199219  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 2726, 128]), torch.Size([1, 2726, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11749649047851562  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1395726203918457  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 2726, 128])
m.shape torch.Size([2850, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14087247848510742  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14087247848510742  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 2850, 128]), torch.Size([1, 2850, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14359045028686523  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1851668357849121  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 2850, 128])
m.shape torch.Size([2466, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.18788480758666992  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.18788480758666992  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 2466, 128]), torch.Size([1, 2466, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.19036340713500977  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.24436330795288086  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 2466, 128])
m.shape torch.Size([2115, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.24789094924926758  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.24789094924926758  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 2115, 128]), torch.Size([1, 2115, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2499079704284668  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3102231025695801  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 2115, 128])
m.shape torch.Size([1992, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3142571449279785  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3142571449279785  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 1992, 128]), torch.Size([1, 1992, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.31615686416625977  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.38614892959594727  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 1992, 128])
m.shape torch.Size([1546, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.38962221145629883  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.38962221145629883  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 1546, 128]), torch.Size([1, 1546, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3910965919494629  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.45485925674438477  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 1546, 128])
m.shape torch.Size([1365, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4586782455444336  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4586782455444336  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 1365, 128]), torch.Size([1, 1365, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4599800109863281  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5250682830810547  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 1365, 128])
m.shape torch.Size([1244, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5291628837585449  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5291628837585449  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 1244, 128]), torch.Size([1, 1244, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5303492546081543  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5990710258483887  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 1244, 128])
m.shape torch.Size([1028, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6037726402282715  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6037726402282715  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 1028, 128]), torch.Size([1, 1028, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6047530174255371  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6677660942077637  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 1028, 128])
m.shape torch.Size([8750, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7089991569519043  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7089991569519043  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 4375, 128]), torch.Size([1, 4375, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7131714820861816  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.0211000442504883  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst 0 shape torch.Size([1, 4375, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.0211000442504883  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.0211000442504883  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 4375, 128]), torch.Size([1, 4375, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.0252723693847656  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3315138816833496  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst 1 shape torch.Size([1, 4375, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2644548416137695  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2898454666137695  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3147192001342773  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2891340255737305  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

torch.Size([26082, 256])
first layer input nodes number: 53314
first layer output nodes number: 26082
edges number: 159779
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3151187896728516  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3405094146728516  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3463687896728516  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3463687896728516  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

m.shape torch.Size([1918, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4219279289245605  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4219279289245605  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 1918, 256]), torch.Size([1, 1918, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4256510734558105  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4551844596862793  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 1918, 256])
m.shape torch.Size([1608, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4568657875061035  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4568657875061035  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 1608, 256]), torch.Size([1, 1608, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4602370262145996  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5084586143493652  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 1608, 256])
m.shape torch.Size([1244, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.510512351989746  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.510512351989746  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 1244, 256]), torch.Size([1, 1244, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5131187438964844  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5675430297851562  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 1244, 256])
m.shape torch.Size([951, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5696659088134766  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5696659088134766  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 951, 256]), torch.Size([1, 951, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5714797973632812  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.6240825653076172  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 951, 256])
m.shape torch.Size([891, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.627457618713379  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.627457618713379  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 891, 256]), torch.Size([1, 891, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.6291570663452148  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.6904973983764648  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 891, 256])
m.shape torch.Size([637, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.6933212280273438  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.6933212280273438  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 637, 256]), torch.Size([1, 637, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.6945362091064453  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.747915267944336  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 637, 256])
m.shape torch.Size([541, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.7509479522705078  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.7509479522705078  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 541, 256]), torch.Size([1, 541, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.7519798278808594  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.8054885864257812  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 541, 256])
m.shape torch.Size([474, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.8086175918579102  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.8086175918579102  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 474, 256]), torch.Size([1, 474, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.8095216751098633  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.8617372512817383  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 474, 256])
m.shape torch.Size([362, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.8645672798156738  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.8645672798156738  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 362, 256]), torch.Size([1, 362, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.865257740020752  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.9098896980285645  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 362, 256])
m.shape torch.Size([302, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.912447452545166  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.912447452545166  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.9130234718322754  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.9548993110656738  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 302, 256])
m.shape torch.Size([235, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.9570960998535156  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.9570960998535156  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.9575443267822266  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.9925060272216797  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([220, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.9948196411132812  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.9948196411132812  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.9952392578125  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.0309066772460938  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([195, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.0331335067749023  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.0331335067749023  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.033505439758301  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.067723274230957  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([179, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.0699462890625  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.0699462890625  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.0702877044677734  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.1040878295898438  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([147, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.10603666305542  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.10603666305542  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.1063170433044434  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.1360373497009277  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([132, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.1379270553588867  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.1379270553588867  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.138178825378418  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.166628837585449  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([101, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.168278217315674  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.168278217315674  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.168470859527588  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.1915879249572754  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([82, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.192910671234131  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.192910671234131  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.1930670738220215  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.212930202484131  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([76, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.214240074157715  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.214240074157715  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.2143850326538086  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.233809471130371  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([78, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.235236644744873  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.235236644744873  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.2353854179382324  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.2563624382019043  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([50, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.2573375701904297  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.2573375701904297  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.2574329376220703  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.271547317504883  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([51, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.27260684967041  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.27260684967041  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.2727041244506836  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.2877817153930664  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([38, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.2885732650756836  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.2885732650756836  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.2886457443237305  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.300387382507324  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([46, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.3014888763427734  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.3014888763427734  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.301576614379883  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.316404342651367  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([660, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.332219123840332  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.332219123840332  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 660, 256]), torch.Size([1, 660, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.3334779739379883  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.5550355911254883  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 660, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.491415500640869  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.4931511878967285  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.495058536529541  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.493238925933838  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

torch.Size([11218, 40])
input nodes number: 26082
output nodes number: 11218
edges number: 76234
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.4928364753723145  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 2.4928369522094727  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03799009323120117  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

pseudo mini batch 6 input nodes size: 84816
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03279542922973633  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03279542922973633  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.07323884963989258  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.07332134246826172  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.04781532287597656  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.051227569580078125  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.051227569580078125  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.051227569580078125  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

torch.Size([84816, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.051227569580078125  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

m.shape torch.Size([2507, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 0.2267165184020996  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 0.2267165184020996  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 2507, 128]), torch.Size([1, 2507, 128])
----------------------------------------3
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 0.22910737991333008  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 0.24914884567260742  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 2507, 128])
m.shape torch.Size([2733, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 0.25055980682373047  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 0.25055980682373047  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 2733, 128]), torch.Size([1, 2733, 128])
----------------------------------------3
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 0.25390052795410156  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 0.29448699951171875  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 2733, 128])
m.shape torch.Size([2456, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 0.29709339141845703  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 0.29709339141845703  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 2456, 128]), torch.Size([1, 2456, 128])
----------------------------------------3
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 0.2994356155395508  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 0.35345935821533203  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 2456, 128])
m.shape torch.Size([2223, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 0.35697269439697266  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 0.35697269439697266  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 2223, 128]), torch.Size([1, 2223, 128])
----------------------------------------3
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 0.35912036895751953  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 0.421903133392334  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 2223, 128])
m.shape torch.Size([2117, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 0.4258904457092285  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 0.4258904457092285  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 2117, 128]), torch.Size([1, 2117, 128])
----------------------------------------3
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 0.42798852920532227  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 0.5022764205932617  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 2117, 128])
m.shape torch.Size([1895, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 0.5066885948181152  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 0.5066885948181152  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 1895, 128]), torch.Size([1, 1895, 128])
----------------------------------------3
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 0.5084958076477051  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 0.5862059593200684  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 1895, 128])
m.shape torch.Size([1818, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 0.5913705825805664  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 0.5913705825805664  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 1818, 128]), torch.Size([1, 1818, 128])
----------------------------------------3
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 0.593104362487793  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 0.6797933578491211  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 1818, 128])
m.shape torch.Size([1675, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 0.6853160858154297  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 0.6853160858154297  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 1675, 128]), torch.Size([1, 1675, 128])
----------------------------------------3
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 0.6869134902954102  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 0.7791242599487305  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 1675, 128])
m.shape torch.Size([1579, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 0.7851018905639648  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 0.7851018905639648  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 1579, 128]), torch.Size([1, 1579, 128])
----------------------------------------3
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 0.7866077423095703  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 0.884284496307373  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 1579, 128])
m.shape torch.Size([26939, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.2713623046875 GB
    Memory Allocated: 1.0124378204345703  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2713623046875 GB
    Memory Allocated: 1.0124378204345703  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 13469, 128]), torch.Size([1, 13469, 128])
----------------------------------------3
 Nvidia-smi: 5.2713623046875 GB
    Memory Allocated: 1.025282859802246  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4725341796875 GB
    Memory Allocated: 1.9380717277526855  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst 0 shape torch.Size([1, 13469, 128])
----------------------------------------1
 Nvidia-smi: 5.4725341796875 GB
    Memory Allocated: 1.9380717277526855  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4725341796875 GB
    Memory Allocated: 1.9380717277526855  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 13470, 128]), torch.Size([1, 13470, 128])
----------------------------------------3
 Nvidia-smi: 5.4725341796875 GB
    Memory Allocated: 1.9511804580688477  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3026123046875 GB
    Memory Allocated: 2.858356475830078  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst 1 shape torch.Size([1, 13470, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.3026123046875 GB
    Memory Allocated: 2.70320463180542  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.3026123046875 GB
    Memory Allocated: 2.747018337249756  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.3026123046875 GB
    Memory Allocated: 2.790832042694092  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.3026123046875 GB
    Memory Allocated: 2.746675968170166  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

torch.Size([45942, 256])
first layer input nodes number: 84816
first layer output nodes number: 45942
edges number: 355915
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.3026123046875 GB
    Memory Allocated: 2.791466236114502  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.3026123046875 GB
    Memory Allocated: 2.835279941558838  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.3026123046875 GB
    Memory Allocated: 2.846233367919922  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.3026123046875 GB
    Memory Allocated: 2.846233367919922  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

m.shape torch.Size([1595, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 2.9467458724975586  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 2.9467458724975586  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 1595, 256]), torch.Size([1, 1595, 256])
----------------------------------------3
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 2.95004940032959  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 2.9758496284484863  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 1595, 256])
m.shape torch.Size([1382, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 2.9769577980041504  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 2.9769577980041504  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 1382, 256]), torch.Size([1, 1382, 256])
----------------------------------------3
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 2.9798760414123535  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.0214457511901855  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 1382, 256])
m.shape torch.Size([1018, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.022860527038574  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.022860527038574  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 1018, 256]), torch.Size([1, 1018, 256])
----------------------------------------3
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.0248022079467773  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.067823886871338  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 1018, 256])
m.shape torch.Size([791, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.0702567100524902  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.0702567100524902  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 791, 256]), torch.Size([1, 791, 256])
----------------------------------------3
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.071765422821045  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.116682529449463  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 791, 256])
m.shape torch.Size([688, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.119234561920166  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.119234561920166  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 688, 256]), torch.Size([1, 688, 256])
----------------------------------------3
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.120546817779541  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.167788028717041  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 688, 256])
m.shape torch.Size([523, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.1701483726501465  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.1701483726501465  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 523, 256]), torch.Size([1, 523, 256])
----------------------------------------3
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.1711459159851074  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.2163801193237305  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 523, 256])
m.shape torch.Size([469, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.2190370559692383  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.2190370559692383  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 469, 256]), torch.Size([1, 469, 256])
----------------------------------------3
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.2199316024780273  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.265178680419922  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 469, 256])
m.shape torch.Size([358, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.267484188079834  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.267484188079834  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.268167018890381  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.313422679901123  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([326, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.315901279449463  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.315901279449463  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 326, 256]), torch.Size([1, 326, 256])
----------------------------------------3
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.3165230751037598  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.358994483947754  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 326, 256])
m.shape torch.Size([279, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.36136531829834  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.36136531829834  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.3618974685668945  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.4012818336486816  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([230, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.4034476280212402  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.4034476280212402  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.403886318206787  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.4381041526794434  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([227, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.4405031204223633  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.4405031204223633  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.4409360885620117  GigaBytes
Max Memory Allocated: 3.4733219146728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.477738380432129  GigaBytes
Max Memory Allocated: 3.4803361892700195  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([207, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.4801087379455566  GigaBytes
Max Memory Allocated: 3.4803361892700195  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.4801087379455566  GigaBytes
Max Memory Allocated: 3.4803361892700195  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.480503559112549  GigaBytes
Max Memory Allocated: 3.480503559112549  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.51682710647583  GigaBytes
Max Memory Allocated: 3.5193934440612793  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([145, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.518580913543701  GigaBytes
Max Memory Allocated: 3.5193934440612793  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.518580913543701  GigaBytes
Max Memory Allocated: 3.5193934440612793  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.518857479095459  GigaBytes
Max Memory Allocated: 3.5193934440612793  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.5462374687194824  GigaBytes
Max Memory Allocated: 3.548173427581787  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([162, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.5484347343444824  GigaBytes
Max Memory Allocated: 3.5484437942504883  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.5484347343444824  GigaBytes
Max Memory Allocated: 3.5484437942504883  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.548743724822998  GigaBytes
Max Memory Allocated: 3.548743724822998  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.5814967155456543  GigaBytes
Max Memory Allocated: 3.5838141441345215  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([138, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.5834646224975586  GigaBytes
Max Memory Allocated: 3.5838141441345215  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.5834646224975586  GigaBytes
Max Memory Allocated: 3.5838141441345215  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.5837278366088867  GigaBytes
Max Memory Allocated: 3.5838141441345215  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.613471031188965  GigaBytes
Max Memory Allocated: 3.61557674407959  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([137, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.6155781745910645  GigaBytes
Max Memory Allocated: 3.6155872344970703  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.6155781745910645  GigaBytes
Max Memory Allocated: 3.6155872344970703  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.6158394813537598  GigaBytes
Max Memory Allocated: 3.6158394813537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.6471962928771973  GigaBytes
Max Memory Allocated: 3.649506092071533  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([135, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.6494011878967285  GigaBytes
Max Memory Allocated: 3.649506092071533  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.6494011878967285  GigaBytes
Max Memory Allocated: 3.649506092071533  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.649658679962158  GigaBytes
Max Memory Allocated: 3.649658679962158  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.6823601722717285  GigaBytes
Max Memory Allocated: 3.6846776008605957  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([117, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.6845579147338867  GigaBytes
Max Memory Allocated: 3.6846776008605957  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.6845579147338867  GigaBytes
Max Memory Allocated: 3.6846776008605957  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.684781074523926  GigaBytes
Max Memory Allocated: 3.684781074523926  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.71468448638916  GigaBytes
Max Memory Allocated: 3.7168045043945312  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([91, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.716322422027588  GigaBytes
Max Memory Allocated: 3.7168045043945312  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.716322422027588  GigaBytes
Max Memory Allocated: 3.7168045043945312  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.716495990753174  GigaBytes
Max Memory Allocated: 3.7168045043945312  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.740969181060791  GigaBytes
Max Memory Allocated: 3.7427048683166504  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([112, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.743143081665039  GigaBytes
Max Memory Allocated: 3.743152141571045  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.743143081665039  GigaBytes
Max Memory Allocated: 3.743152141571045  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.743356704711914  GigaBytes
Max Memory Allocated: 3.743356704711914  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.774972915649414  GigaBytes
Max Memory Allocated: 3.7772159576416016  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([78, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.776515483856201  GigaBytes
Max Memory Allocated: 3.7772159576416016  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.776515483856201  GigaBytes
Max Memory Allocated: 3.7772159576416016  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.7766642570495605  GigaBytes
Max Memory Allocated: 3.7772159576416016  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.7997241020202637  GigaBytes
Max Memory Allocated: 3.801360607147217  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([71, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.8012194633483887  GigaBytes
Max Memory Allocated: 3.801360607147217  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.8012194633483887  GigaBytes
Max Memory Allocated: 3.801360607147217  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.8013548851013184  GigaBytes
Max Memory Allocated: 3.801360607147217  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.8232932090759277  GigaBytes
Max Memory Allocated: 3.824850559234619  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([74, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.82493257522583  GigaBytes
Max Memory Allocated: 3.824939250946045  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.82493257522583  GigaBytes
Max Memory Allocated: 3.824939250946045  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.825073719024658  GigaBytes
Max Memory Allocated: 3.825073719024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.8489270210266113  GigaBytes
Max Memory Allocated: 3.850620746612549  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([1682, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.8892722129821777  GigaBytes
Max Memory Allocated: 3.8894290924072266  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.8892722129821777  GigaBytes
Max Memory Allocated: 3.8894290924072266  GigaBytes

 h.shape torch.Size([1, 1682, 256]), torch.Size([1, 1682, 256])
----------------------------------------3
 Nvidia-smi: 6.4002685546875 GB
    Memory Allocated: 3.8924803733825684  GigaBytes
Max Memory Allocated: 3.8924803733825684  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4412841796875 GB
    Memory Allocated: 4.465630054473877  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

rst.shape  torch.Size([1, 1682, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.4412841796875 GB
    Memory Allocated: 4.37592077255249  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.4412841796875 GB
    Memory Allocated: 4.377572536468506  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.4412841796875 GB
    Memory Allocated: 4.379458904266357  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.4412841796875 GB
    Memory Allocated: 4.377724647521973  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

torch.Size([11035, 40])
input nodes number: 45942
output nodes number: 11035
edges number: 101968
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.4412841796875 GB
    Memory Allocated: 4.378065586090088  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.4412841796875 GB
    Memory Allocated: 4.378066062927246  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.057099342346191406  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

pseudo mini batch 7 input nodes size: 68325
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.04773139953613281  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.04773139953613281  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.08031129837036133  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.08039665222167969  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.0398707389831543  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.043497562408447266  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.043497562408447266  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.043497562408447266  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

torch.Size([68325, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.043497562408447266  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

m.shape torch.Size([1828, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.21393585205078125  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.21393585205078125  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

 h.shape torch.Size([1, 1828, 128]), torch.Size([1, 1828, 128])
----------------------------------------3
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.21567916870117188  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.22962570190429688  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

rst.shape  torch.Size([1, 1828, 128])
m.shape torch.Size([1866, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.2306962013244629  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.2306962013244629  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

 h.shape torch.Size([1, 1866, 128]), torch.Size([1, 1866, 128])
----------------------------------------3
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.23247575759887695  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.25948286056518555  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

rst.shape  torch.Size([1, 1866, 128])
m.shape torch.Size([1795, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.261934757232666  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.261934757232666  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

 h.shape torch.Size([1, 1795, 128]), torch.Size([1, 1795, 128])
----------------------------------------3
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.26364660263061523  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.30163145065307617  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

rst.shape  torch.Size([1, 1795, 128])
m.shape torch.Size([1665, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.3039512634277344  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.3039512634277344  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

 h.shape torch.Size([1, 1665, 128]), torch.Size([1, 1665, 128])
----------------------------------------3
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.3055391311645508  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.3525409698486328  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

rst.shape  torch.Size([1, 1665, 128])
m.shape torch.Size([1556, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.3554568290710449  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.3554568290710449  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

 h.shape torch.Size([1, 1556, 128]), torch.Size([1, 1556, 128])
----------------------------------------3
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.35694074630737305  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.4111361503601074  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

rst.shape  torch.Size([1, 1556, 128])
m.shape torch.Size([1552, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.4150862693786621  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.4150862693786621  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

 h.shape torch.Size([1, 1552, 128]), torch.Size([1, 1552, 128])
----------------------------------------3
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.4165663719177246  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.4802107810974121  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

rst.shape  torch.Size([1, 1552, 128])
m.shape torch.Size([1440, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.48427724838256836  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.48427724838256836  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

 h.shape torch.Size([1, 1440, 128]), torch.Size([1, 1440, 128])
----------------------------------------3
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.48565053939819336  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.5549254417419434  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

rst.shape  torch.Size([1, 1440, 128])
m.shape torch.Size([1385, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.5595221519470215  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.5595221519470215  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

 h.shape torch.Size([1, 1385, 128]), torch.Size([1, 1385, 128])
----------------------------------------3
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.5608429908752441  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.636960506439209  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

rst.shape  torch.Size([1, 1385, 128])
m.shape torch.Size([1368, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.6421709060668945  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.6421709060668945  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

 h.shape torch.Size([1, 1368, 128]), torch.Size([1, 1368, 128])
----------------------------------------3
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.6434755325317383  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6365966796875 GB
    Memory Allocated: 0.7275857925415039  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

rst.shape  torch.Size([1, 1368, 128])
m.shape torch.Size([27869, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 0.8598232269287109  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 0.8598232269287109  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

 h.shape torch.Size([1, 13934, 128]), torch.Size([1, 13934, 128])
----------------------------------------3
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 0.8731117248535156  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 1.8395977020263672  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

rst 0 shape torch.Size([1, 13934, 128])
----------------------------------------1
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 1.8395977020263672  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 1.8395977020263672  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

 h.shape torch.Size([1, 13935, 128]), torch.Size([1, 13935, 128])
----------------------------------------3
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 1.8528871536254883  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 2.791323661804199  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

rst 1 shape torch.Size([1, 13935, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 2.638667583465576  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 2.6790308952331543  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 2.7193942070007324  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 2.678715229034424  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

torch.Size([42324, 256])
first layer input nodes number: 68325
first layer output nodes number: 42324
edges number: 346859
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 2.719905376434326  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 2.7602686882019043  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 2.770359516143799  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 2.770359516143799  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

m.shape torch.Size([1229, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 2.9064488410949707  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 2.9064488410949707  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

 h.shape torch.Size([1, 1229, 256]), torch.Size([1, 1229, 256])
----------------------------------------3
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 2.9089818000793457  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 2.931570053100586  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

rst.shape  torch.Size([1, 1229, 256])
m.shape torch.Size([978, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 2.9316906929016113  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 2.9316906929016113  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

 h.shape torch.Size([1, 978, 256]), torch.Size([1, 978, 256])
----------------------------------------3
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 2.933556079864502  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 2.965257167816162  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

rst.shape  torch.Size([1, 978, 256])
m.shape torch.Size([828, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 2.9667558670043945  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 2.9667558670043945  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

 h.shape torch.Size([1, 828, 256]), torch.Size([1, 828, 256])
----------------------------------------3
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 2.9683351516723633  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.003554344177246  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

rst.shape  torch.Size([1, 828, 256])
m.shape torch.Size([649, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.005481719970703  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.005481719970703  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

 h.shape torch.Size([1, 649, 256]), torch.Size([1, 649, 256])
----------------------------------------3
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.0067195892333984  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.0468292236328125  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

rst.shape  torch.Size([1, 649, 256])
m.shape torch.Size([548, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.0488438606262207  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.0488438606262207  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

 h.shape torch.Size([1, 548, 256]), torch.Size([1, 548, 256])
----------------------------------------3
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.049889087677002  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.0877785682678223  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

rst.shape  torch.Size([1, 548, 256])
m.shape torch.Size([470, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.0899667739868164  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.0899667739868164  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

 h.shape torch.Size([1, 470, 256]), torch.Size([1, 470, 256])
----------------------------------------3
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.0908632278442383  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.131856918334961  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

rst.shape  torch.Size([1, 470, 256])
m.shape torch.Size([363, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.1348228454589844  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.1348228454589844  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

 h.shape torch.Size([1, 363, 256]), torch.Size([1, 363, 256])
----------------------------------------3
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.1355152130126953  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.1716489791870117  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

rst.shape  torch.Size([1, 363, 256])
m.shape torch.Size([314, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.173717498779297  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.173717498779297  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.17431640625  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.2086410522460938  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

rst.shape  torch.Size([1, 314, 256])
m.shape torch.Size([322, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.211127281188965  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.211127281188965  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

 h.shape torch.Size([1, 322, 256]), torch.Size([1, 322, 256])
----------------------------------------3
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.2117414474487305  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.2510480880737305  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

rst.shape  torch.Size([1, 322, 256])
m.shape torch.Size([295, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.2535767555236816  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.2535767555236816  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.2541394233703613  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.2955355644226074  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([274, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.2981514930725098  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.2981514930725098  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.2986741065979004  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.3405537605285645  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([272, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.3434295654296875  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.3434295654296875  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.3439483642578125  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.389707565307617  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([207, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.3920350074768066  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.3920350074768066  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.392429828643799  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.42875337600708  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([199, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.4312338829040527  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.4312338829040527  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.4316134452819824  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.4691901206970215  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([185, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.471667766571045  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.471667766571045  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.4720206260681152  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.5094237327575684  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([181, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.512031078338623  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.512031078338623  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.512376308441162  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.551387310028076  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([157, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.5537800788879395  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.5537800788879395  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.554079532623291  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.5900139808654785  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([173, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.5928573608398438  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.5928573608398438  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.5931873321533203  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.6350936889648438  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([150, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.6376681327819824  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.6376681327819824  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.6379542350769043  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.6762919425964355  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([155, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.679128646850586  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.679128646850586  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.679424285888672  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.721109390258789  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([150, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.723989486694336  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.723989486694336  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.724275588989258  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.7666187286376953  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([101, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.768611431121826  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.768611431121826  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.7688040733337402  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.79866361618042  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([112, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.8018054962158203  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.8018054962158203  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 6.7713623046875 GB
    Memory Allocated: 3.8020191192626953  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7830810546875 GB
    Memory Allocated: 3.8366260528564453  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([107, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.7830810546875 GB
    Memory Allocated: 3.8389878273010254  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7830810546875 GB
    Memory Allocated: 3.8389878273010254  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 6.7830810546875 GB
    Memory Allocated: 3.8391919136047363  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8182373046875 GB
    Memory Allocated: 3.8736824989318848  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([3016, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.8201904296875 GB
    Memory Allocated: 3.946049690246582  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8201904296875 GB
    Memory Allocated: 3.946049690246582  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

 h.shape torch.Size([1, 3016, 256]), torch.Size([1, 3016, 256])
----------------------------------------3
 Nvidia-smi: 6.8201904296875 GB
    Memory Allocated: 3.9518022537231445  GigaBytes
Max Memory Allocated: 4.506645679473877  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8201904296875 GB
    Memory Allocated: 4.964501857757568  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 3016, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.8201904296875 GB
    Memory Allocated: 4.838799953460693  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.8201904296875 GB
    Memory Allocated: 4.840569972991943  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.8201904296875 GB
    Memory Allocated: 4.842843532562256  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.8201904296875 GB
    Memory Allocated: 4.8409881591796875  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

torch.Size([11435, 40])
input nodes number: 42324
output nodes number: 11435
edges number: 139801
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.8201904296875 GB
    Memory Allocated: 4.841507434844971  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.8201904296875 GB
    Memory Allocated: 4.841507911682129  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.049869537353515625  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.055419921875  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.055419921875  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.021071642637252808 |0.04514005780220032 |0.18759018182754517 |0.00010293722152709961 |0.07920810580253601 |0.006478309631347656 |
----------------------------------------------------------pseudo_mini_loss sum 5.332828521728516
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  647516
Number of first layer input nodes during this epoch:  414918
Number of first layer output nodes during this epoch:  232598
----------------------------------------before generate dataloader block 
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.0554194450378418  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.018644332885742188
global_2_local spend time (sec) 0.04495978355407715
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.00479435920715332
A = g.adjacency_matrix() spent  0.007208108901977539
auxiliary_graph
Graph(num_nodes=154728, num_edges=28937465,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08423852920532227
remove nodes length
63787
auxiliary_graph.remove_nodes spent  1.4238886833190918
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28937465,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1891505718231201

the counter of shared neighbor distribution
Counter({1.0: 23292734, 2.0: 4025850, 3.0: 1012928, 4.0: 306592, 5.0: 111950, 6.0: 47874, 7.0: 22518, 8.0: 11474, 9.0: 6096, 10.0: 3464, 11.0: 1990, 12.0: 1176, 13.0: 670, 14.0: 384, 15.0: 282, 16.0: 210, 17.0: 182, 18.0: 86, 19.0: 48, 21.0: 8, 20.0: 8})
28846524
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28846521, 28846522, 28846523])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution[04:44:44] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28846524 edges into 8 parts and get 4595164 edge cuts

Counter({1.0: 23292734, 2.0: 4025850, 3.0: 1012928, 4.0: 306592, 5.0: 111950, 6.0: 47874, 7.0: 22518, 8.0: 11474, 9.0: 6096, 10.0: 3464, 11.0: 1990, 12.0: 1176, 13.0: 670, 14.0: 384, 15.0: 282, 16.0: 210, 17.0: 182, 18.0: 86, 19.0: 48, 21.0: 8, 20.0: 8})
Convert a graph into a bidirected graph: 1.312 seconds
Metis partitioning: 5.109 seconds
Split the graph: 1.944 seconds
Construct subgraphs: 0.106 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  8.484485864639282
11568
11630
11360
11344
11216
11144
11035
11644
total k batches seeds list generation spend  18.57971715927124
after graph partition
graph partition algorithm spend time 18.688855409622192
11568
11630
11360
11344
11216
11144
11035
11644
partition_len_list
[20121, 25616, 19662, 21200, 25421, 33797, 46714, 42960]
shared_neighbor_graph_partition_s0 selection method  spend 18.785809755325317
time for parepare:  0.01757216453552246
local_output_nid generation:  0.0022935867309570312
local_in_edges_tensor generation:  0.002412557601928711
mini_batch_src_global generation:  0.003167867660522461
r_  generation:  0.027120351791381836
local_output_nid generation:  0.0031158924102783203
local_in_edges_tensor generation:  0.0026216506958007812
mini_batch_src_global generation:  0.0040128231048583984
r_  generation:  0.033014535903930664
local_output_nid generation:  0.0029964447021484375
local_in_edges_tensor generation:  0.002305269241333008
mini_batch_src_global generation:  0.0037369728088378906
r_  generation:  0.029242753982543945
local_output_nid generation:  0.003076314926147461
local_in_edges_tensor generation:  0.0023779869079589844
mini_batch_src_global generation:  0.0030546188354492188
r_  generation:  0.030668973922729492
local_output_nid generation:  0.0031015872955322266
local_in_edges_tensor generation:  0.0022001266479492188
mini_batch_src_global generation:  0.0024139881134033203
r_  generation:  0.025624752044677734
local_output_nid generation:  0.003065824508666992
local_in_edges_tensor generation:  0.0026581287384033203
mini_batch_src_global generation:  0.0030918121337890625
r_  generation:  0.031398773193359375
local_output_nid generation:  0.0032050609588623047
local_in_edges_tensor generation:  0.002673625946044922
mini_batch_src_global generation:  0.003663778305053711
r_  generation:  0.03442955017089844
local_output_nid generation:  0.003368854522705078
local_in_edges_tensor generation:  0.003080129623413086
mini_batch_src_global generation:  0.005188941955566406
r_  generation:  0.047791242599487305
----------------------check_connections_block total spend ----------------------------- 0.4169576168060303
generate_one_block  0.05075979232788086
generate_one_block  0.04713845252990723
generate_one_block  0.03909039497375488
generate_one_block  0.04078865051269531
generate_one_block  0.03303885459899902
generate_one_block  0.04773998260498047
generate_one_block  0.055989742279052734
generate_one_block  0.07005143165588379
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03990578651428223
gen group dst list time:  0.006751298904418945
time for parepare:  0.02349400520324707
local_output_nid generation:  0.003687620162963867
local_in_edges_tensor generation:  0.014124393463134766
mini_batch_src_global generation:  0.0035524368286132812
r_  generation:  0.043024301528930664
local_output_nid generation:  0.008755207061767578
local_in_edges_tensor generation:  0.00736236572265625
mini_batch_src_global generation:  0.008048057556152344
r_  generation:  0.08151054382324219
local_output_nid generation:  0.00794076919555664
local_in_edges_tensor generation:  0.004439115524291992
mini_batch_src_global generation:  0.005841732025146484
r_  generation:  0.043599605560302734
local_output_nid generation:  0.0071642398834228516
local_in_edges_tensor generation:  0.007465362548828125
mini_batch_src_global generation:  0.004951953887939453
r_  generation:  0.0480804443359375
local_output_nid generation:  0.008450984954833984
local_in_edges_tensor generation:  0.006123781204223633
mini_batch_src_global generation:  0.006060123443603516
r_  generation:  0.05778217315673828
local_output_nid generation:  0.010487556457519531
local_in_edges_tensor generation:  0.009157419204711914
mini_batch_src_global generation:  0.010226249694824219
r_  generation:  0.08987188339233398
local_output_nid generation:  0.016971588134765625
local_in_edges_tensor generation:  0.015043020248413086
mini_batch_src_global generation:  0.015557289123535156
r_  generation:  0.13652849197387695
local_output_nid generation:  0.013637781143188477
local_in_edges_tensor generation:  0.011178970336914062
mini_batch_src_global generation:  0.018278121948242188
r_  generation:  0.1289536952972412
----------------------check_connections_block total spend ----------------------------- 1.0377204418182373
generate_one_block  0.05753803253173828
generate_one_block  0.08412718772888184
generate_one_block  0.05766606330871582
generate_one_block  0.0623629093170166
generate_one_block  0.07252764701843262
generate_one_block  0.12331295013427734
generate_one_block  0.1853635311126709
generate_one_block  0.18493318557739258
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.0554194450378418  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

connection checking time:  1.4546780586242676
block generation total time  1.2124288082122803
average batch blocks generation time:  0.15155360102653503
block dataloader generation time/epoch 21.63569736480713
pseudo mini batch 0 input nodes size: 31817
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.04553842544555664  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.04553842544555664  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.06116342544555664  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.061249732971191406  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.02858448028564453  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.02993011474609375  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.02993011474609375  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.02993011474609375  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

torch.Size([31817, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.02993011474609375  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

m.shape torch.Size([2631, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.08442306518554688  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.08442306518554688  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 2631, 128]), torch.Size([1, 2631, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.08693218231201172  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.10779619216918945  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 2631, 128])
m.shape torch.Size([2725, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.10914039611816406  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.10914039611816406  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 2725, 128]), torch.Size([1, 2725, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.1117391586303711  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.15227603912353516  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 2725, 128])
m.shape torch.Size([2326, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.1548748016357422  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.1548748016357422  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 2326, 128]), torch.Size([1, 2326, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.15730857849121094  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.20772552490234375  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 2326, 128])
m.shape torch.Size([1936, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.21105289459228516  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.21105289459228516  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1936, 128]), torch.Size([1, 1936, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.21289920806884766  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.26644229888916016  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1936, 128])
m.shape torch.Size([1645, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.2702798843383789  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.2702798843383789  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1645, 128]), torch.Size([1, 1645, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.2718486785888672  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.32973670959472656  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1645, 128])
m.shape torch.Size([1331, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.3327603340148926  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.3327603340148926  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1331, 128]), torch.Size([1, 1331, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.3340296745300293  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.3889803886413574  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1331, 128])
m.shape torch.Size([1087, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.39197397232055664  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.39197397232055664  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1087, 128]), torch.Size([1, 1087, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.39301061630249023  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.4466390609741211  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1087, 128])
m.shape torch.Size([938, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.44969892501831055  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.44969892501831055  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 938, 128]), torch.Size([1, 938, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.4505934715270996  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.5015826225280762  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 938, 128])
m.shape torch.Size([782, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.5044913291931152  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.5044913291931152  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 782, 128]), torch.Size([1, 782, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.5052371025085449  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.5545430183410645  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 782, 128])
m.shape torch.Size([4720, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.5766768455505371  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.5766768455505371  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 2360, 128]), torch.Size([1, 2360, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.5790352821350098  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.7434639930725098  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst 0 shape torch.Size([1, 2360, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.7434639930725098  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.7434639930725098  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 2360, 128]), torch.Size([1, 2360, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.7457146644592285  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.9067902565002441  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst 1 shape torch.Size([1, 2360, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.8635468482971191  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.8830780982971191  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.9026093482971191  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.8829278945922852  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

torch.Size([20121, 256])
first layer input nodes number: 31817
first layer output nodes number: 20121
edges number: 108365
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.9028487205505371  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.9223799705505371  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.9271774291992188  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.9271774291992188  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

m.shape torch.Size([1889, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.9992227554321289  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.9992227554321289  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1889, 256]), torch.Size([1, 1889, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.0028257369995117  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.0324101448059082  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1889, 256])
m.shape torch.Size([1735, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.0339441299438477  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.0339441299438477  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1735, 256]), torch.Size([1, 1735, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.037400245666504  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.0870389938354492  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1735, 256])
m.shape torch.Size([1365, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.0900545120239258  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.0900545120239258  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1365, 256]), torch.Size([1, 1365, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.0932350158691406  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.1508989334106445  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1365, 256])
m.shape torch.Size([1091, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.153791904449463  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.153791904449463  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1091, 256]), torch.Size([1, 1091, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.1559386253356934  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.2181792259216309  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1091, 256])
m.shape torch.Size([920, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.220757007598877  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.220757007598877  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 920, 256]), torch.Size([1, 920, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.2225117683410645  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.286083698272705  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 920, 256])
m.shape torch.Size([704, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.2892661094665527  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.2892661094665527  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 704, 256]), torch.Size([1, 704, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.2906088829040527  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.3505244255065918  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 704, 256])
m.shape torch.Size([598, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.3538765907287598  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.3538765907287598  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 598, 256]), torch.Size([1, 598, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.3550171852111816  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.4130635261535645  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 598, 256])
m.shape torch.Size([490, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.4162611961364746  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.4162611961364746  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 490, 256]), torch.Size([1, 490, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.4171957969665527  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.4719634056091309  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 490, 256])
m.shape torch.Size([394, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.4749045372009277  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.4749045372009277  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 394, 256]), torch.Size([1, 394, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.4756560325622559  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.525224208831787  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 394, 256])
m.shape torch.Size([353, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.5282416343688965  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.5282416343688965  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 353, 256]), torch.Size([1, 353, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.5289149284362793  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.577664852142334  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 353, 256])
m.shape torch.Size([286, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.5803523063659668  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.5803523063659668  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.5808978080749512  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.625129222869873  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([237, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.6275901794433594  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.6275901794433594  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.628042221069336  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.6664657592773438  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([202, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.6687641143798828  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.6687641143798828  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.669149398803711  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.7045955657958984  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([159, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.7065424919128418  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.7065424919128418  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.706845760345459  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.7368693351745605  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([154, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.738938331604004  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.738938331604004  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.739232063293457  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.7703676223754883  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([125, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.7721433639526367  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.7721433639526367  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.7723817825317383  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.7993230819702148  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([87, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.800760269165039  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.800760269165039  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8009262084960938  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8208389282226562  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([79, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8221230506896973  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8221230506896973  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8222737312316895  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8414101600646973  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([76, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8427228927612305  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8427228927612305  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8428678512573242  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8622922897338867  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([65, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8634696006774902  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8634696006774902  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.863593578338623  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8810744285583496  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([51, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8820571899414062  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8820571899414062  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8821544647216797  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8965511322021484  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([48, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8975176811218262  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8975176811218262  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8976092338562012  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9117999076843262  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([37, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9125723838806152  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9125723838806152  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9126429557800293  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9240756034851074  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([40, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9249629974365234  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9249629974365234  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.925039291381836  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9379329681396484  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([383, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9470977783203125  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9470977783203125  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 383, 256]), torch.Size([1, 383, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9478282928466797  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.07926082611084  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 383, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0209012031555176  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.022702693939209  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0244264602661133  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.022538661956787  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

torch.Size([11568, 40])
input nodes number: 20121
output nodes number: 11568
edges number: 72134
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.02272891998291  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0227298736572266  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.03258657455444336  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

pseudo mini batch 1 input nodes size: 50063
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.028539180755615234  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.028539180755615234  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.05241107940673828  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.05249786376953125  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.036786556243896484  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.038686275482177734  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.038686275482177734  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.038686275482177734  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

torch.Size([50063, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.038686275482177734  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

m.shape torch.Size([2316, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.12038135528564453  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.12038135528564453  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 2316, 128]), torch.Size([1, 2316, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.1225900650024414  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.14040899276733398  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 2316, 128])
m.shape torch.Size([2566, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.14175176620483398  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.14175176620483398  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 2566, 128]), torch.Size([1, 2566, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.14503002166748047  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.18312740325927734  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 2566, 128])
m.shape torch.Size([2335, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.18557453155517578  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.18557453155517578  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 2335, 128]), torch.Size([1, 2335, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.18780136108398438  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.23821401596069336  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 2335, 128])
m.shape torch.Size([2004, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.24155426025390625  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.24155426025390625  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 2004, 128]), torch.Size([1, 2004, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.24346542358398438  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.29930877685546875  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 2004, 128])
m.shape torch.Size([1815, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.30268049240112305  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.30268049240112305  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1815, 128]), torch.Size([1, 1815, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.3044114112854004  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.3675045967102051  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1815, 128])
m.shape torch.Size([1542, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.3710508346557617  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.3710508346557617  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1542, 128]), torch.Size([1, 1542, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.37252140045166016  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.4361696243286133  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1542, 128])
m.shape torch.Size([1361, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.43997716903686523  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.43997716903686523  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1361, 128]), torch.Size([1, 1361, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.44127511978149414  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.5061726570129395  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1361, 128])
m.shape torch.Size([1243, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.5102653503417969  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.5102653503417969  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1243, 128]), torch.Size([1, 1243, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.5114507675170898  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.5801486968994141  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1243, 128])
m.shape torch.Size([1046, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.584862232208252  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.584862232208252  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1046, 128]), torch.Size([1, 1046, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.5858597755432129  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.6504216194152832  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1046, 128])
m.shape torch.Size([9388, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.6946883201599121  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.6946883201599121  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 4694, 128]), torch.Size([1, 4694, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.699164867401123  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.0186152458190918  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst 0 shape torch.Size([1, 4694, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.0186152458190918  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.0186152458190918  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 4694, 128]), torch.Size([1, 4694, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.0230917930603027  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.337918758392334  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst 1 shape torch.Size([1, 4694, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.2694158554077148  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.2948064804077148  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.3192358016967773  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.293653964996338  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

torch.Size([25616, 256])
first layer input nodes number: 50063
first layer output nodes number: 25616
edges number: 163561
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.3196110725402832  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.3440403938293457  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.3501477241516113  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.3501477241516113  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

m.shape torch.Size([1608, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.4399371147155762  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.4399371147155762  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1608, 256]), torch.Size([1, 1608, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.4431376457214355  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.4680399894714355  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1608, 256])
m.shape torch.Size([1485, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.4693517684936523  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.4693517684936523  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1485, 256]), torch.Size([1, 1485, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.4726018905639648  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.516341209411621  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1485, 256])
m.shape torch.Size([1197, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.5186066627502441  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.5186066627502441  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1197, 256]), torch.Size([1, 1197, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.520998477935791  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.5736255645751953  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1197, 256])
m.shape torch.Size([978, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.5764741897583008  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.5764741897583008  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 978, 256]), torch.Size([1, 978, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.5783395767211914  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.6333551406860352  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 978, 256])
m.shape torch.Size([837, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.6364450454711914  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.6364450454711914  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 837, 256]), torch.Size([1, 837, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.6380414962768555  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.6962614059448242  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 837, 256])
m.shape torch.Size([664, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.6992926597595215  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.6992926597595215  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 664, 256]), torch.Size([1, 664, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.700559139251709  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.7554030418395996  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 664, 256])
m.shape torch.Size([557, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.7591323852539062  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.7591323852539062  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 557, 256]), torch.Size([1, 557, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.7601947784423828  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8143281936645508  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 557, 256])
m.shape torch.Size([502, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8176569938659668  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8176569938659668  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 502, 256]), torch.Size([1, 502, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8186144828796387  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8740487098693848  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 502, 256])
m.shape torch.Size([407, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8770909309387207  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8770909309387207  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 407, 256]), torch.Size([1, 407, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8778672218322754  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9302892684936523  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 407, 256])
m.shape torch.Size([379, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9335441589355469  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9335441589355469  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9342670440673828  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9870643615722656  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([276, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9896211624145508  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9896211624145508  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.990147590637207  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0325188636779785  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([274, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0354161262512207  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0354161262512207  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0359387397766113  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.081779956817627  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([236, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0844674110412598  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0844674110412598  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0849175453186035  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1263298988342285  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([205, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1288633346557617  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1288633346557617  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1292543411254883  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.167963981628418  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([198, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.170623302459717  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.170623302459717  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1710009574890137  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.2110323905944824  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([150, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.2131505012512207  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.2131505012512207  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.2134366035461426  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.2457661628723145  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([137, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.247861862182617  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.247861862182617  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.2481231689453125  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.27947998046875  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([127, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.2815465927124023  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.2815465927124023  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.2817888259887695  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.3125524520874023  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([102, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.3142943382263184  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.3142943382263184  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.3144888877868652  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.3405585289001465  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([101, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.342402935028076  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.342402935028076  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.3425955772399902  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.369758129119873  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([83, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.371337413787842  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.371337413787842  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.3714957237243652  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.394925594329834  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([81, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.396559238433838  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.396559238433838  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.3967137336730957  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.4206604957580566  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([70, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.422131061553955  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.422131061553955  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.422264575958252  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.4438939094543457  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([61, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.4452342987060547  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.4452342987060547  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.4453506469726562  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.4650135040283203  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([915, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.486941337585449  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.486941337585449  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 915, 256]), torch.Size([1, 915, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.4886865615844727  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.7961483001708984  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 915, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.7182793617248535  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.7203173637390137  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.7223963737487793  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.720271587371826  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

torch.Size([11630, 40])
input nodes number: 25616
output nodes number: 11630
edges number: 91297
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.7208638191223145  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.7208642959594727  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.04265880584716797  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

pseudo mini batch 2 input nodes size: 33270
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.037100791931152344  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.037100791931152344  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.05296516418457031  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.05305004119873047  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.029091358184814453  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.030651569366455078  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.030651569366455078  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.030651569366455078  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

torch.Size([33270, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.030651569366455078  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

m.shape torch.Size([1977, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.09083032608032227  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.09083032608032227  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1977, 128]), torch.Size([1, 1977, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.09271574020385742  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.10779905319213867  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1977, 128])
m.shape torch.Size([2124, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.10888195037841797  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.10888195037841797  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 2124, 128]), torch.Size([1, 2124, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.11172866821289062  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.1424732208251953  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 2124, 128])
m.shape torch.Size([1920, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.1444988250732422  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.1444988250732422  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1920, 128]), torch.Size([1, 1920, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.1463298797607422  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.1866130828857422  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1920, 128])
m.shape torch.Size([1694, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.18892860412597656  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.18892860412597656  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1694, 128]), torch.Size([1, 1694, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.19054412841796875  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.23753929138183594  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1694, 128])
m.shape torch.Size([1327, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.23989534378051758  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.23989534378051758  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1327, 128]), torch.Size([1, 1327, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.24116086959838867  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.2876319885253906  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1327, 128])
m.shape torch.Size([1233, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.2905268669128418  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.2905268669128418  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1233, 128]), torch.Size([1, 1233, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.2917027473449707  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.34314489364624023  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1233, 128])
m.shape torch.Size([1056, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.3460817337036133  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.3460817337036133  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1056, 128]), torch.Size([1, 1056, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.3470888137817383  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.39840221405029297  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1056, 128])
m.shape torch.Size([951, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.40152645111083984  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.40152645111083984  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 951, 128]), torch.Size([1, 951, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.4024333953857422  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.4542083740234375  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 951, 128])
m.shape torch.Size([806, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.4572138786315918  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.4572138786315918  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 806, 128]), torch.Size([1, 806, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.45798254013061523  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.507866382598877  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 806, 128])
m.shape torch.Size([6574, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.5388293266296387  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.5388293266296387  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 3287, 128]), torch.Size([1, 3287, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.5426383018493652  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.7747516632080078  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst 0 shape torch.Size([1, 3287, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.7747516632080078  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.7747516632080078  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 3287, 128]), torch.Size([1, 3287, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.7778863906860352  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.0068364143371582  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst 1 shape torch.Size([1, 3287, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.956733226776123  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.976264476776123  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.995795726776123  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.9761176109313965  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

torch.Size([19662, 256])
first layer input nodes number: 33270
first layer output nodes number: 19662
edges number: 120788
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.9960455894470215  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.0155768394470215  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.0210304260253906  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.0210304260253906  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

m.shape torch.Size([1506, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.1080818176269531  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.1080818176269531  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1506, 256]), torch.Size([1, 1506, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.1119394302368164  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.135939598083496  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1506, 256])
m.shape torch.Size([1417, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.137397289276123  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.137397289276123  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1417, 256]), torch.Size([1, 1417, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.1401820182800293  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.1813874244689941  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1417, 256])
m.shape torch.Size([1169, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.1841163635253906  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.1841163635253906  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1169, 256]), torch.Size([1, 1169, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.1865367889404297  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.2375965118408203  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1169, 256])
m.shape torch.Size([989, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.2397050857543945  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.2397050857543945  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 989, 256]), torch.Size([1, 989, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.241591453552246  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.2976312637329102  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 989, 256])
m.shape torch.Size([777, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.300422191619873  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.300422191619873  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 777, 256]), torch.Size([1, 777, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.3019042015075684  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.3556370735168457  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 777, 256])
m.shape torch.Size([676, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.3587946891784668  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.3587946891784668  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 676, 256]), torch.Size([1, 676, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.360084056854248  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.415717601776123  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 676, 256])
m.shape torch.Size([559, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.4188342094421387  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.4188342094421387  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 559, 256]), torch.Size([1, 559, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.4199004173278809  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.4751315116882324  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 559, 256])
m.shape torch.Size([490, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.4783663749694824  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.4783663749694824  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 490, 256]), torch.Size([1, 490, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.4793009757995605  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.5342516899108887  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 490, 256])
m.shape torch.Size([432, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.5375213623046875  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.5375213623046875  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 432, 256]), torch.Size([1, 432, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.5383453369140625  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.5913238525390625  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 432, 256])
m.shape torch.Size([369, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.5944585800170898  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.5944585800170898  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 369, 256]), torch.Size([1, 369, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.5951623916625977  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.6457338333129883  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 369, 256])
m.shape torch.Size([349, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.6490716934204102  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.6490716934204102  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 349, 256]), torch.Size([1, 349, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.6497373580932617  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.7035408020019531  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 349, 256])
m.shape torch.Size([294, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.706599235534668  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.706599235534668  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.7071599960327148  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.7559919357299805  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([246, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.7587852478027344  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.7587852478027344  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.7592544555664062  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8024215698242188  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([205, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.804945468902588  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.804945468902588  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8053364753723145  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8440461158752441  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([153, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8460564613342285  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8460564613342285  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8463482856750488  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.877281665802002  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([156, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8795347213745117  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8795347213745117  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8798322677612305  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9134550094604492  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([159, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9159045219421387  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9159045219421387  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9162077903747559  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9526000022888184  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([134, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9547667503356934  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9547667503356934  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9550223350524902  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9874815940856934  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([102, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9892168045043945  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9892168045043945  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9894113540649414  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0154809951782227  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([117, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.017850399017334  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.017850399017334  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.018073558807373  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.049539089202881  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([95, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0513453483581543  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0513453483581543  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0515265464782715  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0783438682556152  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([79, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0799241065979004  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0799241065979004  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0800747871398926  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1034302711486816  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([73, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.104969024658203  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.104969024658203  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1051082611083984  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.127664566040039  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([65, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1291937828063965  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1291937828063965  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1293177604675293  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1502699851989746  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([749, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1682052612304688  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1682052612304688  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 749, 256]), torch.Size([1, 749, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1696338653564453  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.421152114868164  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 749, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.3466687202453613  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.3490567207336426  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.351444721221924  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.3489718437194824  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

torch.Size([11360, 40])
input nodes number: 19662
output nodes number: 11360
edges number: 88471
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.3495535850524902  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.3495540618896484  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.03403759002685547  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

pseudo mini batch 3 input nodes size: 34464
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.029441356658935547  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.029441356658935547  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.0465846061706543  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.04666948318481445  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.030720233917236328  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.03238821029663086  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.03238821029663086  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.03238821029663086  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

torch.Size([34464, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.03238821029663086  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

m.shape torch.Size([2197, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.09862232208251953  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.09862232208251953  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 2197, 128]), torch.Size([1, 2197, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.10071754455566406  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.1184377670288086  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 2197, 128])
m.shape torch.Size([2179, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.11948537826538086  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.11948537826538086  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 2179, 128]), torch.Size([1, 2179, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.12156343460083008  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.15459871292114258  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 2179, 128])
m.shape torch.Size([2015, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.1554884910583496  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.1554884910583496  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 2015, 128]), torch.Size([1, 2015, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.1574101448059082  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.20000123977661133  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 2015, 128])
m.shape torch.Size([1659, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.20220470428466797  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.20220470428466797  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1659, 128]), torch.Size([1, 1659, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.20378684997558594  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.2502145767211914  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1659, 128])
m.shape torch.Size([1546, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.2531094551086426  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.2531094551086426  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1546, 128]), torch.Size([1, 1546, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.25458383560180664  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.30790090560913086  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1546, 128])
m.shape torch.Size([1272, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.3108029365539551  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.3108029365539551  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1272, 128]), torch.Size([1, 1272, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.31201601028442383  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.3645901679992676  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1272, 128])
m.shape torch.Size([1085, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.36760520935058594  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.36760520935058594  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1085, 128]), torch.Size([1, 1085, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.3686399459838867  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.42247962951660156  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1085, 128])
m.shape torch.Size([968, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.42565488815307617  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.42565488815307617  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 968, 128]), torch.Size([1, 968, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.4265780448913574  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.48018932342529297  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 968, 128])
m.shape torch.Size([816, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.4832296371459961  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.4832296371459961  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 816, 128]), torch.Size([1, 816, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.4840078353881836  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.5356464385986328  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 816, 128])
m.shape torch.Size([7463, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.5708436965942383  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.5708436965942383  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 3731, 128]), torch.Size([1, 3731, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.57440185546875  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.8271231651306152  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst 0 shape torch.Size([1, 3731, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.8271231651306152  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.8271231651306152  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 3732, 128]), torch.Size([1, 3732, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.8306822776794434  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.0816001892089844  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst 1 shape torch.Size([1, 3732, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.026627540588379  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.0468454360961914  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.067063331604004  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.046687126159668  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

torch.Size([21200, 256])
first layer input nodes number: 34464
first layer output nodes number: 21200
edges number: 131911
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.0673222541809082  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.0875401496887207  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.0927128791809082  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.0927128791809082  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

m.shape torch.Size([1626, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.1831941604614258  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.1831941604614258  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1626, 256]), torch.Size([1, 1626, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.1866655349731445  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.2140626907348633  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1626, 256])
m.shape torch.Size([1355, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.2155671119689941  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.2155671119689941  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1355, 256]), torch.Size([1, 1355, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.2186555862426758  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.2608599662780762  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1355, 256])
m.shape torch.Size([1189, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.2626614570617676  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.2626614570617676  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1189, 256]), torch.Size([1, 1189, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.2661423683166504  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.3224506378173828  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1189, 256])
m.shape torch.Size([913, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.3242573738098145  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.3242573738098145  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 913, 256]), torch.Size([1, 913, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.3259987831115723  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.3772072792053223  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 913, 256])
m.shape torch.Size([781, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.3800902366638184  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.3800902366638184  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 781, 256]), torch.Size([1, 781, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.381579875946045  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.4356141090393066  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 781, 256])
m.shape torch.Size([627, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.4384851455688477  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.4384851455688477  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 627, 256]), torch.Size([1, 627, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.439681053161621  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.491898536682129  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 627, 256])
m.shape torch.Size([527, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.4948463439941406  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.4948463439941406  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 527, 256]), torch.Size([1, 527, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.4958515167236328  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.5463237762451172  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 527, 256])
m.shape torch.Size([460, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.5493583679199219  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.5493583679199219  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.5502357482910156  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.6011810302734375  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([397, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.6041765213012695  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.6041765213012695  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 397, 256]), torch.Size([1, 397, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.604933738708496  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.6542320251464844  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 397, 256])
m.shape torch.Size([352, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.6572365760803223  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.6572365760803223  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 352, 256]), torch.Size([1, 352, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.6579079627990723  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.7064194679260254  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 352, 256])
m.shape torch.Size([303, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.7092876434326172  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.7092876434326172  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.7098655700683594  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.7553577423095703  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([254, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.7579984664916992  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.7579984664916992  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.7584829330444336  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.7996625900268555  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([213, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8020820617675781  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8020820617675781  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8024883270263672  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.839864730834961  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([209, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8424739837646484  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8424739837646484  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8428726196289062  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8823375701904297  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([185, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.884805679321289  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.884805679321289  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8851585388183594  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9225616455078125  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([145, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9246153831481934  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9246153831481934  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9248919486999512  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.956143856048584  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([162, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9586529731750488  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9586529731750488  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9589619636535645  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9960408210754395  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([115, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9978761672973633  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9978761672973633  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9980955123901367  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0259523391723633  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([108, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.027815341949463  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.027815341949463  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0280213356018066  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.055624485015869  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([116, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0577516555786133  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0577516555786133  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0579729080200195  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.089169502258301  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([113, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0913400650024414  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0913400650024414  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.091555595397949  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1234540939331055  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([66, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1253037452697754  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1253037452697754  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.125429630279541  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.144941806793213  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([73, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1464929580688477  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1464929580688477  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.146632194519043  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1691884994506836  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([68, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1711692810058594  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1711692810058594  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1712989807128906  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.193218231201172  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([987, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.216869354248047  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.216869354248047  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 987, 256]), torch.Size([1, 987, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.218751907348633  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.560667037963867  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 987, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.4814295768737793  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.4831652641296387  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.4849443435668945  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.483123779296875  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

torch.Size([11344, 40])
input nodes number: 21200
output nodes number: 11344
edges number: 91862
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.4827146530151367  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.482715129852295  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.034947872161865234  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

pseudo mini batch 4 input nodes size: 52583
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.030067920684814453  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.030067920684814453  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.05545854568481445  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.0555424690246582  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.0383143424987793  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.03992033004760742  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.03992033004760742  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.03992033004760742  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

torch.Size([52583, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.03992033004760742  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

m.shape torch.Size([2939, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.11402559280395508  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.11402559280395508  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 2939, 128]), torch.Size([1, 2939, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.11682844161987305  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.1392512321472168  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 2939, 128])
m.shape torch.Size([3066, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.14077377319335938  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.14077377319335938  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 3066, 128]), torch.Size([1, 3066, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.1438465118408203  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.187774658203125  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 3066, 128])
m.shape torch.Size([2673, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.19069862365722656  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.19069862365722656  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 2673, 128]), torch.Size([1, 2673, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.1933746337890625  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.25090789794921875  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 2673, 128])
m.shape torch.Size([2216, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.25345706939697266  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.25345706939697266  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 2216, 128]), torch.Size([1, 2216, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.2563605308532715  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.31896305084228516  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 2216, 128])
m.shape torch.Size([1910, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.3219490051269531  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.3219490051269531  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1910, 128]), torch.Size([1, 1910, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.32377052307128906  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.38992881774902344  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1910, 128])
m.shape torch.Size([1549, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.3934497833251953  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.3934497833251953  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1549, 128]), torch.Size([1, 1549, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.3949270248413086  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.4584484100341797  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1549, 128])
m.shape torch.Size([1359, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.46246862411499023  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.46246862411499023  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1359, 128]), torch.Size([1, 1359, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.46376466751098633  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.528566837310791  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1359, 128])
m.shape torch.Size([1127, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.5322179794311523  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.5322179794311523  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1127, 128]), torch.Size([1, 1127, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.5332927703857422  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.5949258804321289  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1127, 128])
m.shape torch.Size([991, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.5986413955688477  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.5986413955688477  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 991, 128]), torch.Size([1, 991, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.5995864868164062  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.6613030433654785  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 991, 128])
m.shape torch.Size([7591, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.6970272064208984  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.6970272064208984  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 3795, 128]), torch.Size([1, 3795, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.7006611824035645  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.9584145545959473  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst 0 shape torch.Size([1, 3795, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.9584145545959473  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.9584145545959473  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 3796, 128]), torch.Size([1, 3796, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.9620347023010254  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.2172555923461914  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst 1 shape torch.Size([1, 3796, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.1564421653747559  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.1806855201721191  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.2049288749694824  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.1804957389831543  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

torch.Size([25421, 256])
first layer input nodes number: 52583
first layer output nodes number: 25421
edges number: 148156
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.2053227424621582  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.2295660972595215  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.2356271743774414  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.2356271743774414  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

m.shape torch.Size([2059, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.30299711227417  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.30299711227417  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 2059, 256]), torch.Size([1, 2059, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.3069243431091309  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.3383421897888184  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 2059, 256])
m.shape torch.Size([1784, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.3398079872131348  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.3398079872131348  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1784, 256]), torch.Size([1, 1784, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.343416690826416  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.395327091217041  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1784, 256])
m.shape torch.Size([1370, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.3975763320922852  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.3975763320922852  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1370, 256]), torch.Size([1, 1370, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.4002084732055664  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.4597887992858887  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1370, 256])
m.shape torch.Size([1066, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.4624567031860352  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.4624567031860352  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1066, 256]), torch.Size([1, 1066, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.464644432067871  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.5259723663330078  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1066, 256])
m.shape torch.Size([877, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.5287566184997559  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.5287566184997559  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 877, 256]), torch.Size([1, 877, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.5304293632507324  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.5916666984558105  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 877, 256])
m.shape torch.Size([628, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.594451904296875  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.594451904296875  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 628, 256]), torch.Size([1, 628, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.5956497192382812  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.6497344970703125  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 628, 256])
m.shape torch.Size([536, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.6527419090270996  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.6527419090270996  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 536, 256]), torch.Size([1, 536, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.653764247894287  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.704942226409912  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 536, 256])
m.shape torch.Size([436, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.7077836990356445  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.7077836990356445  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 436, 256]), torch.Size([1, 436, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.7086153030395508  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.7564897537231445  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 436, 256])
m.shape torch.Size([357, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.759162425994873  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.759162425994873  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 357, 256]), torch.Size([1, 357, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.759843349456787  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.805445671081543  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 357, 256])
m.shape torch.Size([272, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8077197074890137  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8077197074890137  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8082385063171387  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.846391201019287  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([211, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.848362922668457  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.848362922668457  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8487653732299805  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8801565170288086  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([195, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.882204532623291  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.882204532623291  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8825764656066895  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9141907691955566  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([172, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.916656494140625  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.916656494140625  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9169845581054688  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9471664428710938  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([163, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9491958618164062  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9491958618164062  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9495067596435547  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.98028564453125  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([120, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.981860637664795  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.981860637664795  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9820895195007324  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0063509941101074  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([102, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.007805347442627  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.007805347442627  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.007999897003174  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0299839973449707  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([86, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.031291961669922  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.031291961669922  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0314559936523438  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0511398315429688  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([82, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0524768829345703  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0524768829345703  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.052633285522461  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0724964141845703  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([70, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0736966133117676  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0736966133117676  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0738301277160645  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0917210578918457  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([63, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.092865467071533  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.092865467071533  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0929856300354004  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.109928607940674  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([45, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.110776901245117  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.110776901245117  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1108627319335938  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.123565673828125  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([39, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.124347686767578  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.124347686767578  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.124422073364258  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1359519958496094  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([36, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1367106437683105  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1367106437683105  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.136779308319092  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1479029655456543  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([36, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1486992835998535  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1486992835998535  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1487679481506348  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.160372257232666  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([411, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1702136993408203  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1702136993408203  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 411, 256]), torch.Size([1, 411, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1709976196289062  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.313849449157715  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 411, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.258936882019043  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.2606382369995117  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.2632017135620117  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.261416435241699  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

torch.Size([11216, 40])
input nodes number: 25421
output nodes number: 11216
edges number: 67236
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.261655807495117  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.2616562843322754  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.043080806732177734  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

pseudo mini batch 5 input nodes size: 64721
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.03828001022338867  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.03828001022338867  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.06953001022338867  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.06961345672607422  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.04413890838623047  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.04659080505371094  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.04659080505371094  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.04659080505371094  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

torch.Size([64721, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.04659080505371094  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

m.shape torch.Size([2733, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.1654801368713379  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.1654801368713379  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 2733, 128]), torch.Size([1, 2733, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.16882944107055664  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.1897292137145996  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 2733, 128])
m.shape torch.Size([2714, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.19101428985595703  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.19101428985595703  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 2714, 128]), torch.Size([1, 2714, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.19376611709594727  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.23342180252075195  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 2714, 128])
m.shape torch.Size([2264, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.23471593856811523  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.23471593856811523  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 2264, 128]), torch.Size([1, 2264, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.23784399032592773  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.28597211837768555  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 2264, 128])
m.shape torch.Size([2002, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.28921079635620117  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.28921079635620117  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 2002, 128]), torch.Size([1, 2002, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.2911200523376465  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.3473658561706543  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 2002, 128])
m.shape torch.Size([1845, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.35081005096435547  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.35081005096435547  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1845, 128]), torch.Size([1, 1845, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.352569580078125  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.4159126281738281  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1845, 128])
m.shape torch.Size([1591, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.4195847511291504  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.4195847511291504  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1591, 128]), torch.Size([1, 1591, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.42110204696655273  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.4863457679748535  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1591, 128])
m.shape torch.Size([1393, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.490236759185791  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.490236759185791  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1393, 128]), torch.Size([1, 1393, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.4915652275085449  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.5603179931640625  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1393, 128])
m.shape torch.Size([1329, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.5647234916687012  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.5647234916687012  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1329, 128]), torch.Size([1, 1329, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.5659909248352051  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.6382346153259277  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1329, 128])
m.shape torch.Size([1190, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.6427078247070312  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.6427078247070312  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1190, 128]), torch.Size([1, 1190, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.6438426971435547  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.7165718078613281  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1190, 128])
m.shape torch.Size([16736, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.7958078384399414  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.7958078384399414  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 8368, 128]), torch.Size([1, 8368, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.8037881851196289  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.3703927993774414  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst 0 shape torch.Size([1, 8368, 128])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.3703927993774414  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.3703927993774414  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 8368, 128]), torch.Size([1, 8368, 128])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.378373146057129  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9409875869750977  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst 1 shape torch.Size([1, 8368, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8379478454589844  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.8701791763305664  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9024105072021484  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.869926929473877  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

torch.Size([33797, 256])
first layer input nodes number: 64721
first layer output nodes number: 33797
edges number: 240185
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9028949737548828  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9351263046264648  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9439105987548828  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 1.9439105987548828  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

m.shape torch.Size([1909, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0316414833068848  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0316414833068848  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1909, 256]), torch.Size([1, 1909, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0357213020324707  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.0665249824523926  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1909, 256])
m.shape torch.Size([1542, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.068143367767334  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.068143367767334  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1542, 256]), torch.Size([1, 1542, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.071488380432129  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1173830032348633  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1542, 256])
m.shape torch.Size([1144, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1190948486328125  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1190948486328125  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1144, 256]), torch.Size([1, 1144, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.121297836303711  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.170994281768799  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1144, 256])
m.shape torch.Size([828, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1732163429260254  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.1732163429260254  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 828, 256]), torch.Size([1, 828, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.174795627593994  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.225538730621338  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 828, 256])
m.shape torch.Size([758, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.2284207344055176  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.2284207344055176  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 758, 256]), torch.Size([1, 758, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.2298665046691895  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.2920994758605957  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 758, 256])
m.shape torch.Size([581, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.294973373413086  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.294973373413086  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 581, 256]), torch.Size([1, 581, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.29608154296875  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.3437328338623047  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 581, 256])
m.shape torch.Size([441, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.3467726707458496  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.3467726707458496  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 441, 256]), torch.Size([1, 441, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.34761381149292  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.3927245140075684  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 441, 256])
m.shape torch.Size([403, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.3958988189697266  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.3958988189697266  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 403, 256]), torch.Size([1, 403, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.39666748046875  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.445791244506836  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 403, 256])
m.shape torch.Size([328, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.448244571685791  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.448244571685791  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 328, 256]), torch.Size([1, 328, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.4488701820373535  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.4911179542541504  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 328, 256])
m.shape torch.Size([282, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.493515968322754  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.493515968322754  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.494053840637207  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.5326013565063477  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([262, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.5351028442382812  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.5351028442382812  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.535602569580078  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.5757498741149902  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([204, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.577853202819824  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.577853202819824  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.578242301940918  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.6113157272338867  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([168, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.613220691680908  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.613220691680908  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.6135411262512207  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.6430211067199707  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([144, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.644798755645752  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.644798755645752  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.645073413848877  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.672264575958252  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([122, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.673886299133301  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.673886299133301  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.674118995666504  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.698784828186035  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([114, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.7004218101501465  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.7004218101501465  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.700639247894287  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.7252097129821777  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([110, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.726898670196533  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.726898670196533  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.7271084785461426  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.7522854804992676  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([108, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.754049301147461  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.754049301147461  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.7542552947998047  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.780416488647461  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([106, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.7822494506835938  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.7822494506835938  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.782451629638672  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.8095436096191406  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([81, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.810999870300293  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.810999870300293  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.811154365539551  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.8329381942749023  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([74, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.834354877471924  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.834354877471924  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.834496021270752  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.8553853034973145  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([63, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.85664701461792  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.85664701461792  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.856767177581787  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.875392436981201  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([52, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.8764820098876953  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.8764820098876953  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.8765811920166016  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.892648696899414  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([65, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.8940987586975098  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.8940987586975098  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.8942227363586426  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.915174961090088  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([1255, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.945615768432617  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.945615768432617  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1255, 256]), torch.Size([1, 1255, 256])
----------------------------------------3
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 2.94840145111084  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 3.3741559982299805  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1255, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 3.2982630729675293  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 3.300083637237549  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 3.3017444610595703  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 3.2998404502868652  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

torch.Size([11144, 40])
input nodes number: 33797
output nodes number: 11144
edges number: 88799
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 3.300135612487793  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 3.300136089324951  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.051029205322265625  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

pseudo mini batch 6 input nodes size: 87226
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.0440983772277832  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.0440983772277832  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.08569097518920898  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.08577346801757812  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.05444002151489258  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.05787229537963867  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.05787229537963867  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.05787229537963867  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

torch.Size([87226, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.05787229537963867  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

m.shape torch.Size([2580, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.2354888916015625  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.2354888916015625  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 2580, 128]), torch.Size([1, 2580, 128])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.23794937133789062  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.25838327407836914  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 2580, 128])
m.shape torch.Size([2764, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.25978899002075195  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.25978899002075195  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 2764, 128]), torch.Size([1, 2764, 128])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.26242494583129883  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.30240869522094727  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 2764, 128])
m.shape torch.Size([2527, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.3047056198120117  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.3047056198120117  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 2527, 128]), torch.Size([1, 2527, 128])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.3071155548095703  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.36086368560791016  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 2527, 128])
m.shape torch.Size([2331, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.36447858810424805  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.36447858810424805  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 2331, 128]), torch.Size([1, 2331, 128])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.36673879623413086  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.43276166915893555  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 2331, 128])
m.shape torch.Size([2282, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.4372076988220215  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.4372076988220215  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 2282, 128]), torch.Size([1, 2282, 128])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.43938398361206055  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.5184359550476074  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 2282, 128])
m.shape torch.Size([1945, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.5238766670227051  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.5238766670227051  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1945, 128]), torch.Size([1, 1945, 128])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.5257315635681152  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.605492115020752  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1945, 128])
m.shape torch.Size([1855, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.6107563972473145  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.6107563972473145  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1855, 128]), torch.Size([1, 1855, 128])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.612525463104248  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.7009787559509277  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1855, 128])
m.shape torch.Size([1760, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.7068080902099609  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.7068080902099609  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1760, 128]), torch.Size([1, 1760, 128])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.7084865570068359  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.8042087554931641  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1760, 128])
m.shape torch.Size([1655, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.8104720115661621  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.8104720115661621  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1655, 128]), torch.Size([1, 1655, 128])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.8120503425598145  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.9148373603820801  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1655, 128])
m.shape torch.Size([27015, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 1.042954444885254  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 1.042954444885254  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 13507, 128]), torch.Size([1, 13507, 128])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 1.0558357238769531  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 1.972081184387207  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst 0 shape torch.Size([1, 13507, 128])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 1.972081184387207  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 1.972081184387207  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 13508, 128]), torch.Size([1, 13508, 128])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 1.9849634170532227  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 2.8936610221862793  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst 1 shape torch.Size([1, 13508, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 2.7365331649780273  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 2.781083106994629  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 2.8256330490112305  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 2.7807350158691406  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

torch.Size([46714, 256])
first layer input nodes number: 87226
first layer output nodes number: 46714
edges number: 360203
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 2.826284885406494  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 2.8708348274230957  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 2.881972312927246  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 2.881972312927246  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

m.shape torch.Size([1634, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 2.9803290367126465  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 2.9803290367126465  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1634, 256]), torch.Size([1, 1634, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 2.983489513397217  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.008513927459717  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1634, 256])
m.shape torch.Size([1402, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.009700298309326  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.009700298309326  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1402, 256]), torch.Size([1, 1402, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.0128626823425293  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.054713726043701  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1402, 256])
m.shape torch.Size([1057, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.056272029876709  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.056272029876709  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1057, 256]), torch.Size([1, 1057, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.058337688446045  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.104226589202881  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1057, 256])
m.shape torch.Size([805, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.1063356399536133  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.1063356399536133  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 805, 256]), torch.Size([1, 805, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.1078710556030273  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.1534910202026367  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 805, 256])
m.shape torch.Size([718, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.1561741828918457  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.1561741828918457  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 718, 256]), torch.Size([1, 718, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.157543659210205  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.2075071334838867  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 718, 256])
m.shape torch.Size([515, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.2097926139831543  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.2097926139831543  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 515, 256]), torch.Size([1, 515, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.2107748985290527  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.256711006164551  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 515, 256])
m.shape torch.Size([426, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.2590861320495605  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.2590861320495605  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 426, 256]), torch.Size([1, 426, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.2598986625671387  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.301734447479248  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 426, 256])
m.shape torch.Size([350, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.3040194511413574  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.3040194511413574  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 350, 256]), torch.Size([1, 350, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.304687023162842  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.3480257987976074  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 350, 256])
m.shape torch.Size([334, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.350581169128418  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.350581169128418  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 334, 256]), torch.Size([1, 334, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.3512182235717773  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.3925065994262695  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 334, 256])
m.shape torch.Size([278, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.39486026763916  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.39486026763916  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.395390510559082  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.4342775344848633  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([246, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.4366135597229004  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.4366135597229004  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.4370827674865723  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.4736809730529785  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([213, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.475903034210205  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.475903034210205  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.476309299468994  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.5108418464660645  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([184, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.5129380226135254  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.5129380226135254  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.513288974761963  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.545576572418213  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([145, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.5473523139953613  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.5473523139953613  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.547628879547119  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.5750088691711426  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([168, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.5772929191589355  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.5772929191589355  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.577613353729248  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.611579418182373  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([127, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.613372325897217  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.613372325897217  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.613614559173584  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.640986919403076  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([120, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.6436543464660645  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.6436543464660645  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.643883228302002  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.671349048614502  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([131, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.6735010147094727  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.6735010147094727  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.673750877380371  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.7054834365844727  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([113, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.7074222564697266  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.7074222564697266  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.7076377868652344  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.7365188598632812  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([102, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.7383718490600586  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.7383718490600586  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.7385663986206055  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.765997886657715  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([105, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.7680201530456543  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.7680201530456543  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.7682204246520996  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.797860622406006  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([73, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.799304485321045  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.799304485321045  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.7994437217712402  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.8210253715515137  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([65, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.8223929405212402  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.8223929405212402  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.822516918182373  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.8426012992858887  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([73, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.8442234992980957  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.8442234992980957  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.844362735748291  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.867893695831299  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([1651, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.90749454498291  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.90749454498291  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1651, 256]), torch.Size([1, 1651, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.9106435775756836  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 4.483434677124023  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1651, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 4.395732879638672  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 4.3973774909973145  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 4.399448871612549  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 4.397721767425537  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

torch.Size([11035, 40])
input nodes number: 46714
output nodes number: 11035
edges number: 100231
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 4.398136138916016  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 4.398136615753174  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.06385421752929688  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

pseudo mini batch 7 input nodes size: 69095
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.05442380905151367  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.05442380905151367  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.0873708724975586  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.08745765686035156  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.04578256607055664  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.05037498474121094  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.05037498474121094  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.05037498474121094  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

torch.Size([69095, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.05037498474121094  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

m.shape torch.Size([1854, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.22293472290039062  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.22293472290039062  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1854, 128]), torch.Size([1, 1854, 128])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.2247028350830078  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.2388477325439453  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1854, 128])
m.shape torch.Size([1912, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.23978710174560547  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.23978710174560547  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1912, 128]), torch.Size([1, 1912, 128])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.24161052703857422  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.26896190643310547  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1912, 128])
m.shape torch.Size([1823, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.270658016204834  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.270658016204834  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1823, 128]), torch.Size([1, 1823, 128])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.2723965644836426  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.31155967712402344  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1823, 128])
m.shape torch.Size([1730, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.31399011611938477  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.31399011611938477  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1730, 128]), torch.Size([1, 1730, 128])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.3156399726867676  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.36348581314086914  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1730, 128])
m.shape torch.Size([1617, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.36651611328125  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.36651611328125  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1617, 128]), torch.Size([1, 1617, 128])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.3680582046508789  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.4238286018371582  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1617, 128])
m.shape torch.Size([1622, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.42769813537597656  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.42769813537597656  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1622, 128]), torch.Size([1, 1622, 128])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.4292449951171875  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.49866676330566406  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1622, 128])
m.shape torch.Size([1494, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.5028800964355469  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.5028800964355469  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1494, 128]), torch.Size([1, 1494, 128])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.5043048858642578  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.576207160949707  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1494, 128])
m.shape torch.Size([1433, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.5809612274169922  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.5809612274169922  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1433, 128]), torch.Size([1, 1433, 128])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.5823278427124023  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.6615867614746094  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1433, 128])
m.shape torch.Size([1386, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.6668515205383301  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.6668515205383301  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1386, 128]), torch.Size([1, 1386, 128])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.6681733131408691  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.7531676292419434  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1386, 128])
m.shape torch.Size([28089, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.8872723579406738  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.8872723579406738  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 14044, 128]), torch.Size([1, 14044, 128])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 0.9006657600402832  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 1.8683056831359863  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst 0 shape torch.Size([1, 14044, 128])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 1.8683056831359863  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 1.8683056831359863  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 14045, 128]), torch.Size([1, 14045, 128])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 1.881700038909912  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 2.828500270843506  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst 1 shape torch.Size([1, 14045, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 2.674030303955078  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 2.7150001525878906  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 2.755970001220703  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 2.714679718017578  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

torch.Size([42960, 256])
first layer input nodes number: 69095
first layer output nodes number: 42960
edges number: 351170
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 2.7564868927001953  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 2.797456741333008  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 2.807699203491211  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 2.807699203491211  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

m.shape torch.Size([1197, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 2.947936534881592  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 2.947936534881592  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 1197, 256]), torch.Size([1, 1197, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 2.9508166313171387  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 2.9698848724365234  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 1197, 256])
m.shape torch.Size([986, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 2.971041202545166  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 2.971041202545166  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 986, 256]), torch.Size([1, 986, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 2.972921848297119  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.004338264465332  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 986, 256])
m.shape torch.Size([786, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.005664348602295  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.005664348602295  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 786, 256]), torch.Size([1, 786, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.0071635246276855  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.0405659675598145  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 786, 256])
m.shape torch.Size([650, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.0424089431762695  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.0424089431762695  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 650, 256]), torch.Size([1, 650, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.0436487197875977  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.0807108879089355  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 650, 256])
m.shape torch.Size([554, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.0827536582946777  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.0827536582946777  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 554, 256]), torch.Size([1, 554, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.083810329437256  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.1222128868103027  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 554, 256])
m.shape torch.Size([473, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.1244125366210938  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.1244125366210938  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 473, 256]), torch.Size([1, 473, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.125314712524414  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.1647491455078125  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 473, 256])
m.shape torch.Size([401, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.1669960021972656  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.1669960021972656  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 401, 256]), torch.Size([1, 401, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.1677608489990234  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.206003189086914  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 401, 256])
m.shape torch.Size([341, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.208242893218994  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.208242893218994  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 341, 256]), torch.Size([1, 341, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.208893299102783  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.246364116668701  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 341, 256])
m.shape torch.Size([327, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.2488675117492676  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.2488675117492676  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 327, 256]), torch.Size([1, 327, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.2494912147521973  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.2902560234069824  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 327, 256])
m.shape torch.Size([314, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.2929625511169434  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.2929625511169434  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.2935614585876465  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.3370184898376465  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 314, 256])
m.shape torch.Size([270, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.339573860168457  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.339573860168457  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.3400888442993164  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.3822193145751953  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([266, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.3850297927856445  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.3850297927856445  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.3855371475219727  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.428959846496582  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([235, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.431642532348633  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.431642532348633  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.4320907592773438  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.47332763671875  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([204, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.47584867477417  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.47584867477417  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.4762377738952637  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.514758586883545  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([189, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.517289161682129  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.517289161682129  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.5176496505737305  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.555861473083496  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([192, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.558633804321289  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.558633804321289  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.559000015258789  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.600381851196289  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([169, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.6029601097106934  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.6029601097106934  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.6032824516296387  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.641963481903076  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([172, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.644778251647949  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.644778251647949  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.645106315612793  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.686770439147949  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([159, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.6895103454589844  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.6895103454589844  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.6898136138916016  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.7304515838623047  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([162, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.7334141731262207  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.7334141731262207  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.7337231636047363  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.7772908210754395  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([151, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.780184268951416  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.780184268951416  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.7804722785949707  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.8230977058410645  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([107, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.8255720138549805  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.8255720138549805  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.8257761001586914  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.8574094772338867  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([113, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.8598055839538574  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.8598055839538574  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.8600211143493652  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.894937038421631  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([117, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.8975281715393066  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.8975281715393066  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 7.2674560546875 GB
    Memory Allocated: 3.8977513313293457  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2928466796875 GB
    Memory Allocated: 3.9354653358459473  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([3109, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.2947998046875 GB
    Memory Allocated: 4.01005744934082  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2947998046875 GB
    Memory Allocated: 4.01005744934082  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

 h.shape torch.Size([1, 3109, 256]), torch.Size([1, 3109, 256])
----------------------------------------3
 Nvidia-smi: 7.2947998046875 GB
    Memory Allocated: 4.015987396240234  GigaBytes
Max Memory Allocated: 5.0364089012146  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2947998046875 GB
    Memory Allocated: 5.059920310974121  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 3109, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.2947998046875 GB
    Memory Allocated: 4.93057107925415  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.2947998046875 GB
    Memory Allocated: 4.932312488555908  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.2947998046875 GB
    Memory Allocated: 4.934053897857666  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.2947998046875 GB
    Memory Allocated: 4.932225704193115  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

torch.Size([11644, 40])
input nodes number: 42960
output nodes number: 11644
edges number: 144220
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.2947998046875 GB
    Memory Allocated: 4.932729721069336  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.2947998046875 GB
    Memory Allocated: 4.932730197906494  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.05684471130371094  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.05684471130371094  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.05684471130371094  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.021199673414230347 |0.0045233070850372314 |0.1256275475025177 |9.34600830078125e-05 |0.07798111438751221 |0.004809856414794922 |
----------------------------------------------------------pseudo_mini_loss sum 4.680707931518555
Total (block generation + training)time/epoch 23.52583932876587[04:45:07] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28957872 edges into 8 parts and get 4736181 edge cuts

* Pure training time/epoch 1.8402106761932373
Training time/epoch 1.889847993850708
Training time without block to device /epoch 1.8536615371704102
Training time without total dataloading part /epoch 1.6344268321990967
load block tensor time/epoch 0.16959738731384277
block to device time/epoch 0.03618645668029785
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  658730
Number of first layer input nodes during this epoch:  423239
Number of first layer output nodes during this epoch:  235491
----------------------------------------before generate dataloader block 
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.056844234466552734  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.018546342849731445
global_2_local spend time (sec) 0.052702903747558594
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004920005798339844
A = g.adjacency_matrix() spent  0.013480424880981445
auxiliary_graph
Graph(num_nodes=154614, num_edges=29048813,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0845346450805664
remove nodes length
63673
auxiliary_graph.remove_nodes spent  1.325244665145874
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29048813,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1641619205474854

the counter of shared neighbor distribution
Counter({1.0: 23402436, 2.0: 4027368, 3.0: 1011142, 4.0: 307344, 5.0: 112146, 6.0: 48448, 7.0: 22696, 8.0: 11506, 9.0: 6294, 10.0: 3494, 11.0: 1966, 12.0: 1128, 13.0: 656, 14.0: 434, 15.0: 300, 16.0: 212, 17.0: 164, 18.0: 68, 19.0: 54, 20.0: 10, 21.0: 6})
28957872
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28957869, 28957870, 28957871])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23402436, 2.0: 4027368, 3.0: 1011142, 4.0: 307344, 5.0: 112146, 6.0: 48448, 7.0: 22696, 8.0: 11506, 9.0: 6294, 10.0: 3494, 11.0: 1966, 12.0: 1128, 13.0: 656, 14.0: 434, 15.0: 300, 16.0: 212, 17.0: 164, 18.0: 68, 19.0: 54, 20.0: 10, 21.0: 6})
Convert a graph into a bidirected graph: 1.331 seconds
Metis partitioning: 5.136 seconds
Split the graph: 1.791 seconds
Construct subgraphs: 0.062 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  8.33332371711731
11177
11136
11035
11285
11479
11567
11620
11642
total k batches seeds list generation spend  18.215291500091553
after graph partition
graph partition algorithm spend time 18.303940534591675
11177
11136
11035
11285
11479
11567
11620
11642
partition_len_list
[33135, 25828, 46763, 41553, 21082, 19963, 21225, 25079]
shared_neighbor_graph_partition_s0 selection method  spend 18.410824060440063
time for parepare:  0.0176084041595459
local_output_nid generation:  0.002156496047973633
local_in_edges_tensor generation:  0.0024042129516601562
mini_batch_src_global generation:  0.0032193660736083984
r_  generation:  0.02977752685546875
local_output_nid generation:  0.003201007843017578
local_in_edges_tensor generation:  0.0024118423461914062
mini_batch_src_global generation:  0.0027315616607666016
r_  generation:  0.02674698829650879
local_output_nid generation:  0.003947257995605469
local_in_edges_tensor generation:  0.002568483352661133
mini_batch_src_global generation:  0.0032613277435302734
r_  generation:  0.035887718200683594
local_output_nid generation:  0.0036945343017578125
local_in_edges_tensor generation:  0.003000497817993164
mini_batch_src_global generation:  0.005223989486694336
r_  generation:  0.04484272003173828
local_output_nid generation:  0.0038187503814697266
local_in_edges_tensor generation:  0.0027360916137695312
mini_batch_src_global generation:  0.003269195556640625
r_  generation:  0.03173661231994629
local_output_nid generation:  0.0036253929138183594
local_in_edges_tensor generation:  0.002494335174560547
mini_batch_src_global generation:  0.0030412673950195312
r_  generation:  0.030678272247314453
local_output_nid generation:  0.0035924911499023438
local_in_edges_tensor generation:  0.0023031234741210938
mini_batch_src_global generation:  0.002366304397583008
r_  generation:  0.026337385177612305
local_output_nid generation:  0.0034668445587158203
local_in_edges_tensor generation:  0.0023317337036132812
mini_batch_src_global generation:  0.0028035640716552734
r_  generation:  0.03296041488647461
----------------------check_connections_block total spend ----------------------------- 0.41422033309936523
generate_one_block  0.04951167106628418
generate_one_block  0.03180432319641113
generate_one_block  0.051687002182006836
generate_one_block  0.06427693367004395
generate_one_block  0.041283369064331055
generate_one_block  0.03966927528381348
generate_one_block  0.03331780433654785
generate_one_block  0.04090094566345215
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0462031364440918
gen group dst list time:  0.006564140319824219
time for parepare:  0.024933815002441406
local_output_nid generation:  0.005835533142089844
local_in_edges_tensor generation:  0.012569189071655273
mini_batch_src_global generation:  0.00818490982055664
r_  generation:  0.08096885681152344
local_output_nid generation:  0.006905555725097656
local_in_edges_tensor generation:  0.00682377815246582
mini_batch_src_global generation:  0.0070722103118896484
r_  generation:  0.05943155288696289
local_output_nid generation:  0.011765480041503906
local_in_edges_tensor generation:  0.013405084609985352
mini_batch_src_global generation:  0.012299776077270508
r_  generation:  0.12965035438537598
local_output_nid generation:  0.009307622909545898
local_in_edges_tensor generation:  0.010350227355957031
mini_batch_src_global generation:  0.013797998428344727
r_  generation:  0.11762166023254395
local_output_nid generation:  0.00541996955871582
local_in_edges_tensor generation:  0.0048160552978515625
mini_batch_src_global generation:  0.0070514678955078125
r_  generation:  0.0477294921875
local_output_nid generation:  0.004920244216918945
local_in_edges_tensor generation:  0.004122257232666016
mini_batch_src_global generation:  0.0047245025634765625
r_  generation:  0.04429006576538086
local_output_nid generation:  0.005166292190551758
local_in_edges_tensor generation:  0.00420379638671875
mini_batch_src_global generation:  0.004470109939575195
r_  generation:  0.04332566261291504
local_output_nid generation:  0.006150722503662109
local_in_edges_tensor generation:  0.004960775375366211
mini_batch_src_global generation:  0.005682229995727539
r_  generation:  0.06131124496459961
----------------------check_connections_block total spend ----------------------------- 0.9284687042236328
generate_one_block  0.11774539947509766
generate_one_block  0.07346177101135254
generate_one_block  0.17143917083740234
generate_one_block  0.15225696563720703
generate_one_block  0.06053352355957031
generate_one_block  0.056325435638427734
generate_one_block  0.05481576919555664
generate_one_block  0.09407711029052734
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.056844234466552734  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

connection checking time:  1.342689037322998
block generation total time  1.1331064701080322
average batch blocks generation time:  0.14163830876350403
block dataloader generation time/epoch 21.340031266212463
pseudo mini batch 0 input nodes size: 63695
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.04587841033935547  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.04587841033935547  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.07712841033935547  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.07721185684204102  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.044178009033203125  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.046586036682128906  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.046586036682128906  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.046586036682128906  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

torch.Size([63695, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.046586036682128906  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

m.shape torch.Size([2671, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.16322088241577148  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.16322088241577148  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 2671, 128]), torch.Size([1, 2671, 128])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.16576814651489258  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.18648767471313477  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 2671, 128])
m.shape torch.Size([2687, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.1877765655517578  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.1877765655517578  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 2687, 128]), torch.Size([1, 2687, 128])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.1903390884399414  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.2306356430053711  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 2687, 128])
m.shape torch.Size([2250, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.23212862014770508  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.23212862014770508  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 2250, 128]), torch.Size([1, 2250, 128])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.2344813346862793  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.28260087966918945  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 2250, 128])
m.shape torch.Size([1938, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.28522443771362305  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.28522443771362305  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1938, 128]), torch.Size([1, 1938, 128])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.28707265853881836  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.3411250114440918  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1938, 128])
m.shape torch.Size([1770, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.34494638442993164  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.34494638442993164  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1770, 128]), torch.Size([1, 1770, 128])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.3466343879699707  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.40740251541137695  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1770, 128])
m.shape torch.Size([1520, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.4109072685241699  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.4109072685241699  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1520, 128]), torch.Size([1, 1520, 128])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.4123568534851074  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.4753756523132324  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1520, 128])
m.shape torch.Size([1383, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.4792671203613281  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.4792671203613281  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1383, 128]), torch.Size([1, 1383, 128])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.48058605194091797  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.5465726852416992  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1383, 128])
m.shape torch.Size([1277, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.5507845878601074  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.5507845878601074  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1277, 128]), torch.Size([1, 1277, 128])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.5520024299621582  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.6215567588806152  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1277, 128])
m.shape torch.Size([1157, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.625913143157959  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.625913143157959  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1157, 128]), torch.Size([1, 1157, 128])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.627016544342041  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.6985015869140625  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1157, 128])
m.shape torch.Size([16482, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.7765421867370605  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.7765421867370605  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 8241, 128]), torch.Size([1, 8241, 128])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.7845554351806641  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.3425607681274414  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst 0 shape torch.Size([1, 8241, 128])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.3425607681274414  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.3425607681274414  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 8241, 128]), torch.Size([1, 8241, 128])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.3504199981689453  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.9044957160949707  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst 1 shape torch.Size([1, 8241, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.8029613494873047  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.8345613479614258  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.8661613464355469  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.8343143463134766  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

torch.Size([33135, 256])
first layer input nodes number: 63695
first layer output nodes number: 33135
edges number: 235647
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.86663818359375  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.898238182067871  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.9061384201049805  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.9061384201049805  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

m.shape torch.Size([1920, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.9925870895385742  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.9925870895385742  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1920, 256]), torch.Size([1, 1920, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.9966001510620117  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.027374267578125  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1920, 256])
m.shape torch.Size([1561, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.028982162475586  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.028982162475586  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1561, 256]), torch.Size([1, 1561, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.032397747039795  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.078829288482666  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1561, 256])
m.shape torch.Size([1176, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.0810985565185547  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.0810985565185547  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1176, 256]), torch.Size([1, 1176, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.083836555480957  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.135326385498047  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1176, 256])
m.shape torch.Size([855, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.1380434036254883  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.1380434036254883  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 855, 256]), torch.Size([1, 855, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.139674186706543  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.1935815811157227  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 855, 256])
m.shape torch.Size([735, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.1966066360473633  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.1966066360473633  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 735, 256]), torch.Size([1, 735, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.1980085372924805  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.248476982116699  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 735, 256])
m.shape torch.Size([587, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.251615524291992  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.251615524291992  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 587, 256]), torch.Size([1, 587, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.252735137939453  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.3008785247802734  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 587, 256])
m.shape torch.Size([468, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.3041563034057617  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.3041563034057617  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 468, 256]), torch.Size([1, 468, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.305048942565918  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.3521032333374023  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 468, 256])
m.shape torch.Size([410, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.355494499206543  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.355494499206543  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 410, 256]), torch.Size([1, 410, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.356276512145996  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.4028615951538086  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 410, 256])
m.shape torch.Size([323, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.4052648544311523  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.4052648544311523  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 323, 256]), torch.Size([1, 323, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.405880928039551  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.445922374725342  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 323, 256])
m.shape torch.Size([284, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.4483442306518555  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.4483442306518555  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.448885917663574  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.488368034362793  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 284, 256])
m.shape torch.Size([262, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.4908676147460938  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.4908676147460938  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.4913673400878906  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.5316648483276367  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([222, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.533975601196289  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.533975601196289  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.5343990325927734  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.5703907012939453  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([149, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.5720410346984863  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.5720410346984863  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.5723252296447754  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.598471164703369  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([133, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.600119113922119  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.600119113922119  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.600372791290283  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.6254868507385254  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([122, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.6271190643310547  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.6271190643310547  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.627351760864258  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.652017593383789  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([114, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.6545424461364746  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.6545424461364746  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.6547598838806152  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.679330348968506  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([110, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.6810193061828613  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.6810193061828613  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.6812291145324707  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.7064061164855957  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([108, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.708169937133789  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.708169937133789  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.708375930786133  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.734537124633789  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([99, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.7362422943115234  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.7362422943115234  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.736431121826172  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.7617340087890625  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([94, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.763446807861328  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.763446807861328  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.7636260986328125  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.7889060974121094  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([76, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.7903504371643066  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.7903504371643066  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.7904953956604004  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.8119492530822754  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([69, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.81333589553833  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.81333589553833  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.813467502593994  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.833866596221924  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([47, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.8348398208618164  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.8348398208618164  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.8349294662475586  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.849452018737793  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([60, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.8507914543151855  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.8507914543151855  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.8509058952331543  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.870246410369873  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([1193, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.898855209350586  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.898855209350586  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1193, 256]), torch.Size([1, 1193, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.9013118743896484  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 3.3055830001831055  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1193, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 3.23004150390625  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 3.23187255859375  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 3.2335381507873535  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 3.231623649597168  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

torch.Size([11177, 40])
input nodes number: 33135
output nodes number: 11177
edges number: 87524
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 3.232043743133545  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 3.2320446968078613  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.05107831954956055  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

pseudo mini batch 1 input nodes size: 55646
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.04426860809326172  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.04426860809326172  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.07161235809326172  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.07169532775878906  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.040361881256103516  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.0419764518737793  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.0419764518737793  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.0419764518737793  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

torch.Size([55646, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.0419764518737793  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

m.shape torch.Size([3027, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.11830711364746094  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.11830711364746094  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 3027, 128]), torch.Size([1, 3027, 128])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.12119388580322266  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.14490509033203125  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 3027, 128])
m.shape torch.Size([3007, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.1463484764099121  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.1463484764099121  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 3007, 128]), torch.Size([1, 3007, 128])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.1492161750793457  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.19263124465942383  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 3007, 128])
m.shape torch.Size([2657, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.1946263313293457  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.1946263313293457  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 2657, 128]), torch.Size([1, 2657, 128])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.19823789596557617  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.25589847564697266  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 2657, 128])
m.shape torch.Size([2266, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.2589535713195801  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.2589535713195801  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 2266, 128]), torch.Size([1, 2266, 128])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.2614116668701172  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.3243274688720703  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 2266, 128])
m.shape torch.Size([1927, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.32864952087402344  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.32864952087402344  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1927, 128]), torch.Size([1, 1927, 128])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.3304872512817383  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.39664554595947266  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1927, 128])
m.shape torch.Size([1582, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.4005560874938965  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.4005560874938965  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1582, 128]), torch.Size([1, 1582, 128])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.40206480026245117  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.46693944931030273  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1582, 128])
m.shape torch.Size([1300, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.47052431106567383  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.47052431106567383  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1300, 128]), torch.Size([1, 1300, 128])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.47176408767700195  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.534477710723877  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1300, 128])
m.shape torch.Size([1149, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.538240909576416  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.538240909576416  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1149, 128]), torch.Size([1, 1149, 128])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.5393366813659668  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.6017956733703613  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1149, 128])
m.shape torch.Size([938, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.6052732467651367  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.6052732467651367  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 938, 128]), torch.Size([1, 938, 128])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.6061677932739258  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.6652069091796875  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 938, 128])
m.shape torch.Size([7975, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.7027873992919922  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.7027873992919922  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 3987, 128]), torch.Size([1, 3987, 128])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.7065896987915039  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.9822702407836914  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst 0 shape torch.Size([1, 3987, 128])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.9822702407836914  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.9822702407836914  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 3988, 128]), torch.Size([1, 3988, 128])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.9865922927856445  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.2603869438171387  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst 1 shape torch.Size([1, 3988, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.1958045959472656  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.2211952209472656  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.2458267211914062  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.2202434539794922  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

torch.Size([25828, 256])
first layer input nodes number: 55646
first layer output nodes number: 25828
edges number: 151687
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.2462434768676758  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.2716341018676758  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.2777705192565918  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.2777705192565918  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

m.shape torch.Size([2179, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.3439159393310547  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.3439159393310547  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 2179, 256]), torch.Size([1, 2179, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.3487062454223633  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.383108139038086  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 2179, 256])
m.shape torch.Size([1722, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.3841781616210938  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.3841781616210938  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1722, 256]), torch.Size([1, 1722, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.3880324363708496  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.43919038772583  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1722, 256])
m.shape torch.Size([1364, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.4419007301330566  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.4419007301330566  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1364, 256]), torch.Size([1, 1364, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.4447541236877441  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.5027408599853516  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1364, 256])
m.shape torch.Size([1083, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.5057945251464844  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.5057945251464844  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1083, 256]), torch.Size([1, 1083, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.5078620910644531  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.5704073905944824  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1083, 256])
m.shape torch.Size([871, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.5726203918457031  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.5726203918457031  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 871, 256]), torch.Size([1, 871, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.5742816925048828  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.635756492614746  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 871, 256])
m.shape torch.Size([640, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.6386165618896484  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.6386165618896484  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 640, 256]), torch.Size([1, 640, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.6398372650146484  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.6936206817626953  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 640, 256])
m.shape torch.Size([491, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.6963138580322266  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.6963138580322266  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 491, 256]), torch.Size([1, 491, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.6972503662109375  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.745077133178711  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 491, 256])
m.shape torch.Size([431, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.7479228973388672  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.7479228973388672  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 431, 256]), torch.Size([1, 431, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.7487449645996094  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.7959041595458984  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 431, 256])
m.shape torch.Size([352, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.7985382080078125  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.7985382080078125  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 352, 256]), torch.Size([1, 352, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.7992095947265625  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.8434782028198242  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 352, 256])
m.shape torch.Size([299, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.8460164070129395  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.8460164070129395  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.8465867042541504  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.8881897926330566  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 299, 256])
m.shape torch.Size([209, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.8901143074035645  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.8901143074035645  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.8905129432678223  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.9216065406799316  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([169, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.923356533050537  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.923356533050537  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.9236788749694824  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.951077938079834  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([189, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.9537935256958008  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.9537935256958008  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.9541540145874023  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.987318992614746  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([137, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.9889822006225586  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.9889822006225586  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 1.989243507385254  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.01511287689209  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([108, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.0165395736694336  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.0165395736694336  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.0167455673217773  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.038580894470215  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([94, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.039923667907715  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.039923667907715  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.040102958679199  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.0603628158569336  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([77, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.0615315437316895  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.0615315437316895  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.061678409576416  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.0793023109436035  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([78, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.080578327178955  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.080578327178955  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.0807271003723145  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.099621295928955  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([66, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.100752353668213  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.100752353668213  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.1008782386779785  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.1177468299865723  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([53, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.1187028884887695  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.1187028884887695  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.1188039779663086  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.1330575942993164  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([44, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.1338953971862793  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.1338953971862793  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.133979320526123  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.146399974822998  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.1469292640686035  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.1469292640686035  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.1469807624816895  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.1549630165100098  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([28, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.1555566787719727  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.1555566787719727  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.1556100845336914  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.164261817932129  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([34, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.1650195121765137  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.1650195121765137  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.1650843620300293  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.17604398727417  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([391, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.1860132217407227  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.1860132217407227  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 391, 256]), torch.Size([1, 391, 256])
----------------------------------------3
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.1867589950561523  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.318720817565918  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 391, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.266164779663086  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.268242835998535  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.269902229309082  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.2677412033081055  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

torch.Size([11136, 40])
input nodes number: 25828
output nodes number: 11136
edges number: 64891
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.2678451538085938  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 2.267845630645752  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.04502058029174805  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

pseudo mini batch 2 input nodes size: 85047
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.04019021987915039  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.04019021987915039  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.08120584487915039  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.08128833770751953  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.05386161804199219  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.057613372802734375  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.057613372802734375  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.057613372802734375  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

torch.Size([85047, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.057613372802734375  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

m.shape torch.Size([2382, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.23787355422973633  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.23787355422973633  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 2382, 128]), torch.Size([1, 2382, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.24014520645141602  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.25915002822875977  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 2382, 128])
m.shape torch.Size([2702, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.2605910301208496  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.2605910301208496  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 2702, 128]), torch.Size([1, 2702, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.2631678581237793  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.3037266731262207  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 2702, 128])
m.shape torch.Size([2437, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.3063035011291504  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.3063035011291504  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 2437, 128]), torch.Size([1, 2437, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.3086276054382324  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.3619413375854492  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 2437, 128])
m.shape torch.Size([2185, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.36542749404907227  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.36542749404907227  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 2185, 128]), torch.Size([1, 2185, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.3675112724304199  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.4295516014099121  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 2185, 128])
m.shape torch.Size([2118, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.4337191581726074  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.4337191581726074  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 2118, 128]), torch.Size([1, 2118, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.43658018112182617  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.5106654167175293  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 2118, 128])
m.shape torch.Size([1899, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.5157151222229004  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.5157151222229004  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1899, 128]), torch.Size([1, 1899, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.5175261497497559  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.5958113670349121  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1899, 128])
m.shape torch.Size([1795, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.6008973121643066  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.6008973121643066  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1795, 128]), torch.Size([1, 1795, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.6026091575622559  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.6882014274597168  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1795, 128])
m.shape torch.Size([1705, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.6938495635986328  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.6938495635986328  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1705, 128]), torch.Size([1, 1705, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.6954755783081055  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.7882156372070312  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1705, 128])
m.shape torch.Size([1629, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.7943935394287109  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.7943935394287109  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1629, 128]), torch.Size([1, 1629, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.7959470748901367  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.898460865020752  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1629, 128])
m.shape torch.Size([27911, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.0307741165161133  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.0307741165161133  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 13955, 128]), torch.Size([1, 13955, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.0440826416015625  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.010788917541504  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst 0 shape torch.Size([1, 13955, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.010788917541504  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.010788917541504  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 13956, 128]), torch.Size([1, 13956, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.0240983963012695  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.9645915031433105  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst 1 shape torch.Size([1, 13956, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.8049278259277344  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.84952449798584  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.8941211700439453  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.8491759300231934  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

torch.Size([46763, 256])
first layer input nodes number: 85047
first layer output nodes number: 46763
edges number: 365797
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.89475679397583  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.9393534660339355  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.950502872467041  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.950502872467041  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

m.shape torch.Size([1498, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.0552115440368652  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.0552115440368652  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1498, 256]), torch.Size([1, 1498, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.058821678161621  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.0836148262023926  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1498, 256])
m.shape torch.Size([1365, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.0848140716552734  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.0848140716552734  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1365, 256]), torch.Size([1, 1365, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.087656021118164  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.1275877952575684  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1365, 256])
m.shape torch.Size([990, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.1294007301330566  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.1294007301330566  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 990, 256]), torch.Size([1, 990, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.131289005279541  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.176107883453369  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 990, 256])
m.shape torch.Size([748, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.178741931915283  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.178741931915283  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 748, 256]), torch.Size([1, 748, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.180168628692627  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.2246384620666504  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 748, 256])
m.shape torch.Size([709, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.227332592010498  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.227332592010498  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 709, 256]), torch.Size([1, 709, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.228684902191162  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.27866792678833  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 709, 256])
m.shape torch.Size([521, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.280996322631836  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.280996322631836  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 521, 256]), torch.Size([1, 521, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.2819900512695312  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.3283162117004395  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 521, 256])
m.shape torch.Size([415, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.3306117057800293  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.3306117057800293  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 415, 256]), torch.Size([1, 415, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.3314032554626465  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.371696949005127  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 415, 256])
m.shape torch.Size([334, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.3738694190979004  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.3738694190979004  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 334, 256]), torch.Size([1, 334, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.3745064735412598  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.4112801551818848  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 334, 256])
m.shape torch.Size([308, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.413626194000244  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.413626194000244  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 308, 256]), torch.Size([1, 308, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.4142136573791504  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.4532647132873535  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 308, 256])
m.shape torch.Size([304, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.455893039703369  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.455893039703369  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.456472873687744  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.4989099502563477  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([245, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.5012106895446777  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.5012106895446777  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.501677989959717  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.5381274223327637  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([225, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.5404891967773438  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.5404891967773438  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.5409183502197266  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.5773963928222656  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([200, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.579680919647217  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.579680919647217  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.5800623893737793  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.6151576042175293  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([157, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.617079734802246  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.617079734802246  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.6173791885375977  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.6470251083374023  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([166, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.6497464179992676  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.6497464179992676  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.6500630378723145  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.683624744415283  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([144, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.685680866241455  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.685680866241455  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.68595552444458  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.716991901397705  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([130, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.7189788818359375  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.7189788818359375  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.719226837158203  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.748981475830078  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([132, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.7511415481567383  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.7511415481567383  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.7513933181762695  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.7833681106567383  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([120, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.785433769226074  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.785433769226074  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.7856626510620117  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.8163328170776367  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([106, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.818256378173828  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.818256378173828  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.8184585571289062  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.846965789794922  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([115, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.8491859436035156  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.8491859436035156  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.849405288696289  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.881868362426758  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([90, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.8836617469787598  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.8836617469787598  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.883833408355713  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.9104409217834473  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([64, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.9117698669433594  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.9117698669433594  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.9118919372558594  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.9316673278808594  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([75, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.9333367347717285  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.9333367347717285  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.9334797859191895  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.957655429840088  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([1874, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 4.002613067626953  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 4.002613067626953  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1874, 256]), torch.Size([1, 1874, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 4.006672382354736  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 4.635761737823486  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1874, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 4.541982650756836  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 4.543642044067383  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 4.54530143737793  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 4.543559551239014  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

torch.Size([11035, 40])
input nodes number: 46763
output nodes number: 11035
edges number: 106740
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 4.543990612030029  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 4.5439910888671875  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.06373357772827148  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

pseudo mini batch 3 input nodes size: 67544
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.05386161804199219  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.05386161804199219  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.08606910705566406  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.08615350723266602  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.045055389404296875  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.04902935028076172  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.04902935028076172  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.04902935028076172  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

torch.Size([67544, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.04902935028076172  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

m.shape torch.Size([1808, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.21631431579589844  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.21631431579589844  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1808, 128]), torch.Size([1, 1808, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.21803855895996094  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.23183250427246094  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1808, 128])
m.shape torch.Size([1882, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.23276519775390625  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.23276519775390625  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1882, 128]), torch.Size([1, 1882, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.2345600128173828  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.26148223876953125  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1882, 128])
m.shape torch.Size([1754, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.26380443572998047  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.26380443572998047  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1754, 128]), torch.Size([1, 1754, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.26547718048095703  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.3028841018676758  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1754, 128])
m.shape torch.Size([1671, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.3053913116455078  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.3053913116455078  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1671, 128]), torch.Size([1, 1671, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.30698490142822266  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.3540153503417969  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1671, 128])
m.shape torch.Size([1603, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.3570404052734375  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.3570404052734375  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1603, 128]), torch.Size([1, 1603, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.3585691452026367  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.41402578353881836  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1603, 128])
m.shape torch.Size([1544, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.4176788330078125  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.4176788330078125  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1544, 128]), torch.Size([1, 1544, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.41915130615234375  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.4824676513671875  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1544, 128])
m.shape torch.Size([1466, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.48662471771240234  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.48662471771240234  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1466, 128]), torch.Size([1, 1466, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.4880228042602539  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.5586719512939453  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1466, 128])
m.shape torch.Size([1331, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.5630502700805664  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.5630502700805664  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1331, 128]), torch.Size([1, 1331, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.5643196105957031  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.6371030807495117  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1331, 128])
m.shape torch.Size([1327, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.6421632766723633  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.6421632766723633  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1327, 128]), torch.Size([1, 1327, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.6434288024902344  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.7244224548339844  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1327, 128])
m.shape torch.Size([27167, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.8533320426940918  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.8533320426940918  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 13583, 128]), torch.Size([1, 13583, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.8662858009338379  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.7868075370788574  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst 0 shape torch.Size([1, 13583, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.7868075370788574  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.7868075370788574  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 13584, 128]), torch.Size([1, 13584, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.79976224899292  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.713367462158203  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst 1 shape torch.Size([1, 13584, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.5640206336975098  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.6036486625671387  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.6432766914367676  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.6033387184143066  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

torch.Size([41553, 256])
first layer input nodes number: 67544
first layer output nodes number: 41553
edges number: 339320
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.643782138824463  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.683410167694092  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.693317413330078  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.693317413330078  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

m.shape torch.Size([1195, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.827084541320801  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.827084541320801  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1195, 256]), torch.Size([1, 1195, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.8294520378112793  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.851097583770752  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1195, 256])
m.shape torch.Size([969, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.8515377044677734  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.8515377044677734  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 969, 256]), torch.Size([1, 969, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.8533859252929688  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.8816165924072266  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 969, 256])
m.shape torch.Size([796, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.8831710815429688  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.8831710815429688  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 796, 256]), torch.Size([1, 796, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.8846893310546875  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.9193878173828125  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 796, 256])
m.shape torch.Size([643, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.9211087226867676  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.9211087226867676  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 643, 256]), torch.Size([1, 643, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.922335147857666  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.9586663246154785  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 643, 256])
m.shape torch.Size([554, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.9607157707214355  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.9607157707214355  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 554, 256]), torch.Size([1, 554, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.9617724418640137  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.0013480186462402  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 554, 256])
m.shape torch.Size([462, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.0034842491149902  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.0034842491149902  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 462, 256]), torch.Size([1, 462, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.0043654441833496  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.0434083938598633  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 462, 256])
m.shape torch.Size([389, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.0455851554870605  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.0455851554870605  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 389, 256]), torch.Size([1, 389, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.0463271141052246  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.0845980644226074  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 389, 256])
m.shape torch.Size([327, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.0867414474487305  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.0867414474487305  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 327, 256]), torch.Size([1, 327, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.08736515045166  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.127269744873047  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 327, 256])
m.shape torch.Size([324, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.1306610107421875  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.1306610107421875  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 324, 256]), torch.Size([1, 324, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.1312789916992188  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.172231674194336  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 324, 256])
m.shape torch.Size([287, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.1746811866760254  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.1746811866760254  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.1752285957336426  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.215832233428955  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([260, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.2183074951171875  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.2183074951171875  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 260, 256]), torch.Size([1, 260, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.2188034057617188  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.2583160400390625  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 260, 256])
m.shape torch.Size([265, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.261124610900879  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.261124610900879  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.261630058288574  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.30556583404541  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([227, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.308149814605713  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.308149814605713  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.3085827827453613  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.3484158515930176  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([201, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.3509039878845215  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.3509039878845215  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.351287364959717  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.3892416954040527  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([178, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.3916163444519043  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.3916163444519043  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.391955852508545  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.427943706512451  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([174, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.430449962615967  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.430449962615967  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.430781841278076  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.4682841300964355  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([156, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.4706673622131348  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.4706673622131348  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.4709649085998535  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.5066704750061035  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([173, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.509514808654785  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.509514808654785  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.5098447799682617  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.551751136779785  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([155, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.5549416542053223  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.5549416542053223  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.555237293243408  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.594852924346924  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([153, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.5976462364196777  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.5976462364196777  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.597938060760498  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.639085292816162  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([141, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.6417856216430664  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.6417856216430664  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.642054557800293  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.681857109069824  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([93, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.6836891174316406  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.6836891174316406  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.683866500854492  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.7113609313964844  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([121, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.713947296142578  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.713947296142578  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.7141780853271484  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.751565933227539  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([114, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.754080295562744  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.754080295562744  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.7542977333068848  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.7910447120666504  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([2928, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.861290454864502  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.861290454864502  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 2928, 256]), torch.Size([1, 2928, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 3.866875171661377  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 4.8500447273254395  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 2928, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 4.7263407707214355  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 4.728789329528809  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 4.730471134185791  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 4.727938175201416  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

torch.Size([11285, 40])
input nodes number: 41553
output nodes number: 11285
edges number: 137516
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 4.729121685028076  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 4.729122161865234  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.05649423599243164  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

pseudo mini batch 4 input nodes size: 33943
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.04584455490112305  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.04584455490112305  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.06202983856201172  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.06211566925048828  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.029823780059814453  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.0314784049987793  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.0314784049987793  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.0314784049987793  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

torch.Size([33943, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.0314784049987793  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

m.shape torch.Size([2205, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.0971364974975586  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.0971364974975586  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 2205, 128]), torch.Size([1, 2205, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.09923934936523438  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.11696720123291016  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 2205, 128])
m.shape torch.Size([2242, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.11805391311645508  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.11805391311645508  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 2242, 128]), torch.Size([1, 2242, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.12019205093383789  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.15311336517333984  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 2242, 128])
m.shape torch.Size([1991, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.15525150299072266  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.15525150299072266  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1991, 128]), torch.Size([1, 1991, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.1571502685546875  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.19946670532226562  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1991, 128])
m.shape torch.Size([1645, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.20165491104125977  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.20165491104125977  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1645, 128]), torch.Size([1, 1645, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.20322370529174805  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.24947023391723633  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1645, 128])
m.shape torch.Size([1527, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.25232648849487305  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.25232648849487305  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1527, 128]), torch.Size([1, 1527, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.2537827491760254  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.3070859909057617  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1527, 128])
m.shape torch.Size([1267, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.3099827766418457  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.3099827766418457  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1267, 128]), torch.Size([1, 1267, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.3111910820007324  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.36334657669067383  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1267, 128])
m.shape torch.Size([1089, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.3663773536682129  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.3663773536682129  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1089, 128]), torch.Size([1, 1089, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.3674159049987793  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.421018123626709  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1089, 128])
m.shape torch.Size([955, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.42414188385009766  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.42414188385009766  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 955, 128]), torch.Size([1, 955, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.4250526428222656  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.477689266204834  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 955, 128])
m.shape torch.Size([815, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.4807314872741699  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.4807314872741699  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 815, 128]), torch.Size([1, 815, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.481508731842041  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.5332746505737305  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 815, 128])
m.shape torch.Size([7346, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.5680422782897949  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.5680422782897949  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 3673, 128]), torch.Size([1, 3673, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.5715451240539551  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.8223929405212402  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst 0 shape torch.Size([1, 3673, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.8223929405212402  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.8223929405212402  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 3673, 128]), torch.Size([1, 3673, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.8261613845825195  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.0747056007385254  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst 1 shape torch.Size([1, 3673, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.0198421478271484  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.039947509765625  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.0600528717041016  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.039790153503418  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

torch.Size([21082, 256])
first layer input nodes number: 33943
first layer output nodes number: 21082
edges number: 130537
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.0603079795837402  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.0804133415222168  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.0856986045837402  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.0856986045837402  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

m.shape torch.Size([1647, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.1757550239562988  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.1757550239562988  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1647, 256]), torch.Size([1, 1647, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.1798572540283203  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.2075810432434082  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1647, 256])
m.shape torch.Size([1441, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.208465576171875  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.208465576171875  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1441, 256]), torch.Size([1, 1441, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.2112464904785156  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.252634048461914  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1441, 256])
m.shape torch.Size([1208, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.2547202110290527  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.2547202110290527  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1208, 256]), torch.Size([1, 1208, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.2574334144592285  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.3154568672180176  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1208, 256])
m.shape torch.Size([936, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.3179035186767578  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.3179035186767578  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 936, 256]), torch.Size([1, 936, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.3196887969970703  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.3714618682861328  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 936, 256])
m.shape torch.Size([804, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.3744330406188965  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.3744330406188965  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 804, 256]), torch.Size([1, 804, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.3759665489196777  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.431394100189209  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 804, 256])
m.shape torch.Size([636, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.434852123260498  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.434852123260498  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 636, 256]), torch.Size([1, 636, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.4360651969909668  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.48897123336792  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 636, 256])
m.shape torch.Size([538, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.4919843673706055  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.4919843673706055  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 538, 256]), torch.Size([1, 538, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.4930105209350586  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.5443181991577148  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 538, 256])
m.shape torch.Size([460, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.547342300415039  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.547342300415039  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.5482196807861328  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.598886489868164  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([399, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.6018996238708496  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.6018996238708496  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 399, 256]), torch.Size([1, 399, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.6026606559753418  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.6525654792785645  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 399, 256])
m.shape torch.Size([351, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.6555585861206055  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.6555585861206055  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 351, 256]), torch.Size([1, 351, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.6562280654907227  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.7054529190063477  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 351, 256])
m.shape torch.Size([308, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.7083745002746582  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.7083745002746582  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 308, 256]), torch.Size([1, 308, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.7089619636535645  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.7565217018127441  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 308, 256])
m.shape torch.Size([241, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.7590079307556152  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.7590079307556152  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.759467601776123  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.798539638519287  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([214, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.8009839057922363  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.8009839057922363  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.8013920783996582  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.8389439582824707  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([204, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.8414850234985352  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.8414850234985352  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.841874122619629  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.8803949356079102  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([180, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.882795810699463  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.882795810699463  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.8831391334533691  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9195313453674316  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([139, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9214973449707031  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9214973449707031  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.921762466430664  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.95172119140625  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([156, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9541378021240234  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9541378021240234  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9544353485107422  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9901409149169922  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([110, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9918951988220215  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9918951988220215  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9921050071716309  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.0187506675720215  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([105, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.0205636024475098  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.0205636024475098  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.020763874053955  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.047600269317627  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([116, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.0497303009033203  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.0497303009033203  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.0499515533447266  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.081148147583008  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([106, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.083177089691162  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.083177089691162  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.0833792686462402  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.1133017539978027  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([61, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.1146669387817383  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.1146669387817383  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.11478328704834  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.132817268371582  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([71, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.134328842163086  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.134328842163086  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.1344642639160156  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.156402587890625  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([70, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.157949924468994  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.157949924468994  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.158083438873291  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.180647373199463  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([978, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.204080581665039  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.204080581665039  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 978, 256]), torch.Size([1, 978, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.2059459686279297  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.546537399291992  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 978, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.469155788421631  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.471229076385498  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.472939968109131  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.470780849456787  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

torch.Size([11479, 40])
input nodes number: 21082
output nodes number: 11479
edges number: 91400
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.470648765563965  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.470649242401123  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.03429365158081055  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

pseudo mini batch 5 input nodes size: 33694
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.029448509216308594  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.029448509216308594  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.04551506042480469  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.04560136795043945  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.02933025360107422  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.03092670440673828  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.03092670440673828  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.03092670440673828  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

torch.Size([33694, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.03092670440673828  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

m.shape torch.Size([1922, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.09217214584350586  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.09217214584350586  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1922, 128]), torch.Size([1, 1922, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.09400510787963867  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.10884284973144531  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1922, 128])
m.shape torch.Size([2153, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.10997962951660156  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.10997962951660156  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 2153, 128]), torch.Size([1, 2153, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.1125178337097168  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.1435222625732422  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 2153, 128])
m.shape torch.Size([1958, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.14557552337646484  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.14557552337646484  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1958, 128]), torch.Size([1, 1958, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.14744281768798828  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.18938159942626953  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1958, 128])
m.shape torch.Size([1716, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.19172096252441406  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.19172096252441406  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1716, 128]), torch.Size([1, 1716, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.1933574676513672  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.2408161163330078  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1716, 128])
m.shape torch.Size([1387, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.24330472946166992  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.24330472946166992  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1387, 128]), torch.Size([1, 1387, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.2446274757385254  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.2936391830444336  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1387, 128])
m.shape torch.Size([1283, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.2966485023498535  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.2966485023498535  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1283, 128]), torch.Size([1, 1283, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.29787206649780273  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.35048532485961914  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1283, 128])
m.shape torch.Size([1083, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.3534884452819824  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.3534884452819824  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1083, 128]), torch.Size([1, 1083, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.3545212745666504  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.4085564613342285  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1083, 128])
m.shape torch.Size([970, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.4117403030395508  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.4117403030395508  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 970, 128]), torch.Size([1, 970, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.41266536712646484  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.4653940200805664  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 970, 128])
m.shape torch.Size([831, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.46849775314331055  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.46849775314331055  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 831, 128]), torch.Size([1, 831, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.46929025650024414  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.520871639251709  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 831, 128])
m.shape torch.Size([6660, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.5522327423095703  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.5522327423095703  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 3330, 128]), torch.Size([1, 3330, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.5556316375732422  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.7873363494873047  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst 0 shape torch.Size([1, 3330, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.7873363494873047  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.7873363494873047  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 3330, 128]), torch.Size([1, 3330, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.7905120849609375  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.0201234817504883  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst 1 shape torch.Size([1, 3330, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.9680614471435547  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.9875926971435547  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.0071239471435547  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.9874439239501953  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

torch.Size([19963, 256])
first layer input nodes number: 33694
first layer output nodes number: 19963
edges number: 123019
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.0073771476745605  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.0269083976745605  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.0316681861877441  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.0316681861877441  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

m.shape torch.Size([1430, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.1209983825683594  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.1209983825683594  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1430, 256]), torch.Size([1, 1430, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.1246509552001953  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.147815227508545  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1430, 256])
m.shape torch.Size([1420, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.149200439453125  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.149200439453125  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1420, 256]), torch.Size([1, 1420, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.1519088745117188  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.194136142730713  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1420, 256])
m.shape torch.Size([1193, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.1956496238708496  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.1956496238708496  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1193, 256]), torch.Size([1, 1193, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.1980090141296387  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.2501320838928223  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1193, 256])
m.shape torch.Size([1006, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.253575325012207  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.253575325012207  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1006, 256]), torch.Size([1, 1006, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.2554941177368164  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.3114824295043945  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1006, 256])
m.shape torch.Size([819, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.3144588470458984  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.3144588470458984  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 819, 256]), torch.Size([1, 819, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.3160209655761719  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.3738288879394531  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 819, 256])
m.shape torch.Size([707, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.3771252632141113  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.3771252632141113  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 707, 256]), torch.Size([1, 707, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.3784737586975098  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.4381098747253418  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 707, 256])
m.shape torch.Size([583, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.4413580894470215  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.4413580894470215  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 583, 256]), torch.Size([1, 583, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.4424700736999512  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.498140811920166  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 583, 256])
m.shape torch.Size([504, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.501460075378418  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.501460075378418  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 504, 256]), torch.Size([1, 504, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.5024213790893555  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.5582456588745117  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 504, 256])
m.shape torch.Size([448, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.5616402626037598  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.5616402626037598  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 448, 256]), torch.Size([1, 448, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.5624947547912598  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.6179451942443848  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 448, 256])
m.shape torch.Size([383, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.621199131011963  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.621199131011963  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 383, 256]), torch.Size([1, 383, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.62192964553833  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.6743340492248535  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 383, 256])
m.shape torch.Size([369, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.677870273590088  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.677870273590088  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 369, 256]), torch.Size([1, 369, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.6785740852355957  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.733471393585205  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 369, 256])
m.shape torch.Size([289, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.7364530563354492  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.7364530563354492  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.737004280090332  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.7865257263183594  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 289, 256])
m.shape torch.Size([257, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.789461612701416  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.789461612701416  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.7899518013000488  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.8364324569702148  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([221, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.8391613960266113  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.8391613960266113  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.839582920074463  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.8813138008117676  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([173, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.8835973739624023  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.8835973739624023  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.883927345275879  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9189043045043945  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([168, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9213228225708008  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9213228225708008  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9216432571411133  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9578523635864258  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([159, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9602904319763184  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9602904319763184  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9605937004089355  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.996985912322998  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([140, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9992566108703613  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9992566108703613  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.999523639678955  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.0334362983703613  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([99, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.0351109504699707  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.0351109504699707  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.035299777984619  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.0606026649475098  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([119, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.062796115875244  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.062796115875244  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.063023090362549  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.0950264930725098  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([103, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.096992015838623  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.096992015838623  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.0971884727478027  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.1262640953063965  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([82, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.1279001235961914  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.1279001235961914  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.128056526184082  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.152298927307129  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([72, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.1538124084472656  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.1538124084472656  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.153949737548828  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.176197052001953  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([67, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.1776742935180664  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.1776742935180664  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.177802085876465  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.199398994445801  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([756, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.217500686645508  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.217500686645508  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 756, 256]), torch.Size([1, 756, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.218942642211914  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.472726821899414  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 756, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.395510673522949  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.3973402976989746  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.3995680809020996  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.3976521492004395  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

torch.Size([11567, 40])
input nodes number: 19963
output nodes number: 11567
edges number: 91045
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.397643566131592  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.39764404296875  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.03378582000732422  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

pseudo mini batch 6 input nodes size: 35705
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.029086589813232422  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.029086589813232422  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.04666471481323242  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.04675149917602539  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.03059864044189453  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.031998634338378906  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.031998634338378906  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.031998634338378906  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

torch.Size([35705, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.031998634338378906  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

m.shape torch.Size([2793, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.09010744094848633  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.09010744094848633  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 2793, 128]), torch.Size([1, 2793, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.09277105331420898  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.11577844619750977  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 2793, 128])
m.shape torch.Size([2849, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.11716365814208984  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.11716365814208984  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 2849, 128]), torch.Size([1, 2849, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.11988067626953125  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.16070127487182617  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 2849, 128])
m.shape torch.Size([2371, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.16341829299926758  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.16341829299926758  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 2371, 128]), torch.Size([1, 2371, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.1665940284729004  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.21696233749389648  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 2371, 128])
m.shape torch.Size([1967, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.2203540802001953  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.2203540802001953  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1967, 128]), torch.Size([1, 1967, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.2222299575805664  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.27817535400390625  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1967, 128])
m.shape torch.Size([1707, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.2813072204589844  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.2813072204589844  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1707, 128]), torch.Size([1, 1707, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.28293514251708984  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.3415403366088867  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1707, 128])
m.shape torch.Size([1395, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.34471750259399414  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.34471750259399414  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1395, 128]), torch.Size([1, 1395, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.34604787826538086  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.40534257888793945  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1395, 128])
m.shape torch.Size([1150, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.40851593017578125  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.40851593017578125  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1150, 128]), torch.Size([1, 1150, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.40961265563964844  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.46478748321533203  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1150, 128])
m.shape torch.Size([968, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.46793174743652344  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.46793174743652344  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 968, 128]), torch.Size([1, 968, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.4688549041748047  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.5217080116271973  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 968, 128])
m.shape torch.Size([831, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.5248126983642578  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.5248126983642578  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 831, 128]), torch.Size([1, 831, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.5256052017211914  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.5769515037536621  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 831, 128])
m.shape torch.Size([5194, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.6019458770751953  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.6019458770751953  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 2597, 128]), torch.Size([1, 2597, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.6045575141906738  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.7885122299194336  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst 0 shape torch.Size([1, 2597, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.7885122299194336  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.7885122299194336  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 2597, 128]), torch.Size([1, 2597, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.7909889221191406  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.9722881317138672  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst 1 shape torch.Size([1, 2597, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.9218082427978516  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.9420499801635742  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.9622917175292969  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.9418916702270508  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

torch.Size([21225, 256])
first layer input nodes number: 35705
first layer output nodes number: 21225
edges number: 115590
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.962559700012207  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.9828014373779297  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.987950325012207  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.987950325012207  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

m.shape torch.Size([1987, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.059950351715088  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.059950351715088  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1987, 256]), torch.Size([1, 1987, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.0643391609191895  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.0958175659179688  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1987, 256])
m.shape torch.Size([1773, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.0966639518737793  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.0966639518737793  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1773, 256]), torch.Size([1, 1773, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.1001853942871094  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.1515884399414062  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1773, 256])
m.shape torch.Size([1344, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.1545987129211426  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.1545987129211426  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1344, 256]), torch.Size([1, 1344, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.157177448272705  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.215301513671875  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1344, 256])
m.shape torch.Size([1053, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.2178964614868164  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.2178964614868164  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1053, 256]), torch.Size([1, 1053, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.220010757446289  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.279883861541748  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1053, 256])
m.shape torch.Size([898, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.2831954956054688  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.2831954956054688  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 898, 256]), torch.Size([1, 898, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.2849082946777344  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.3471603393554688  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 898, 256])
m.shape torch.Size([717, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.3504390716552734  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.3504390716552734  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 717, 256]), torch.Size([1, 717, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.351806640625  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.4118461608886719  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 717, 256])
m.shape torch.Size([613, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.4152870178222656  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.4152870178222656  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 613, 256]), torch.Size([1, 613, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.4164562225341797  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.4765634536743164  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 613, 256])
m.shape torch.Size([478, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.479654312133789  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.479654312133789  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 478, 256]), torch.Size([1, 478, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.4805660247802734  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.5325641632080078  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 478, 256])
m.shape torch.Size([401, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.5355772972106934  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.5355772972106934  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 401, 256]), torch.Size([1, 401, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.5363421440124512  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.5852923393249512  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 401, 256])
m.shape torch.Size([343, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.5882067680358887  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.5882067680358887  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 343, 256]), torch.Size([1, 343, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.5888609886169434  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.6354432106018066  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 343, 256])
m.shape torch.Size([247, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.6377277374267578  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.6377277374267578  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.6381988525390625  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.6749458312988281  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 247, 256])
m.shape torch.Size([232, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.6773862838745117  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.6773862838745117  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.6778287887573242  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.7154417037963867  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([195, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.7176570892333984  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.7176570892333984  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.7180290222167969  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.7522468566894531  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([170, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.7543487548828125  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.7543487548828125  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.7546730041503906  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.786773681640625  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([158, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.7888898849487305  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.7888898849487305  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.7891912460327148  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.8211355209350586  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([105, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.8225998878479004  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.8225998878479004  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.8228001594543457  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.845430850982666  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([104, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.8470301628112793  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.8470301628112793  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.8472285270690918  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.8710322380065918  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([87, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.8724384307861328  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.8724384307861328  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.8726043701171875  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.8936786651611328  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([70, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.8949027061462402  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.8949027061462402  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.895036220550537  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9129271507263184  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([64, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9141669273376465  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9141669273376465  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9142889976501465  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9315009117126465  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([53, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9326233863830566  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9326233863830566  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9327244758605957  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.947685718536377  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([50, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9488282203674316  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9488282203674316  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9489235877990723  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9637055397033691  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([53, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9648804664611816  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9648804664611816  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9649815559387207  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9813580513000488  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([45, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9825286865234375  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9825286865234375  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.982614517211914  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9971199035644531  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([380, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.0062079429626465  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.0062079429626465  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 380, 256]), torch.Size([1, 380, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.0069327354431152  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.138253688812256  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 380, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.07948637008667  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.081381320953369  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.083113193511963  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.0811314582824707  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

torch.Size([11620, 40])
input nodes number: 21225
output nodes number: 11620
edges number: 72145
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.081441879272461  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.081442356109619  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.034873008728027344  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

pseudo mini batch 7 input nodes size: 47456
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.03066396713256836  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.03066396713256836  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.05329275131225586  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.05337953567504883  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.03571462631225586  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.03760957717895508  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.03760957717895508  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.03760957717895508  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

torch.Size([47456, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.03760957717895508  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

m.shape torch.Size([2223, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.11771154403686523  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.11771154403686523  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 2223, 128]), torch.Size([1, 2223, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.12047338485717773  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.13864707946777344  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 2223, 128])
m.shape torch.Size([2397, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.13987302780151367  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.13987302780151367  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 2397, 128]), torch.Size([1, 2397, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.14215898513793945  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.17787981033325195  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 2397, 128])
m.shape torch.Size([2278, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.17999553680419922  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.17999553680419922  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 2278, 128]), torch.Size([1, 2278, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.18222475051879883  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.2306509017944336  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 2278, 128])
m.shape torch.Size([2023, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.23342323303222656  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.23342323303222656  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 2023, 128]), torch.Size([1, 2023, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.2353525161743164  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.29154014587402344  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 2023, 128])
m.shape torch.Size([1788, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.29483842849731445  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.29483842849731445  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1788, 128]), torch.Size([1, 1788, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.29654359817504883  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.3582119941711426  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1788, 128])
m.shape torch.Size([1443, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.36148786544799805  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.36148786544799805  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1443, 128]), torch.Size([1, 1443, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.36286401748657227  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.42282724380493164  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1443, 128])
m.shape torch.Size([1318, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.42653846740722656  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.42653846740722656  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1318, 128]), torch.Size([1, 1318, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.42779541015625  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.4906425476074219  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1318, 128])
m.shape torch.Size([1266, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.4948434829711914  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.4948434829711914  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1266, 128]), torch.Size([1, 1266, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.4960508346557617  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.5654268264770508  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1266, 128])
m.shape torch.Size([1054, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.5698661804199219  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.5698661804199219  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1054, 128]), torch.Size([1, 1054, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.5708713531494141  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.6353244781494141  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1054, 128])
m.shape torch.Size([9289, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.6791152954101562  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.6791152954101562  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 4644, 128]), torch.Size([1, 4644, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.6835441589355469  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.9984846115112305  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst 0 shape torch.Size([1, 4644, 128])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.9984846115112305  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.9984846115112305  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 4645, 128]), torch.Size([1, 4645, 128])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.0029144287109375  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.3159818649291992  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst 1 shape torch.Size([1, 4645, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.2475876808166504  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.2715048789978027  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.295422077178955  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.271317958831787  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

torch.Size([25079, 256])
first layer input nodes number: 47456
first layer output nodes number: 25079
edges number: 161271
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.2957777976989746  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.319694995880127  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.3256745338439941  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.3256745338439941  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

m.shape torch.Size([1572, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.4170618057250977  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.4170618057250977  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1572, 256]), torch.Size([1, 1572, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.4204163551330566  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.445418357849121  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1572, 256])
m.shape torch.Size([1455, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.4467439651489258  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.4467439651489258  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1455, 256]), torch.Size([1, 1455, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.449620246887207  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.4934558868408203  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1455, 256])
m.shape torch.Size([1206, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.4951214790344238  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.4951214790344238  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 1206, 256]), torch.Size([1, 1206, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.4975800514221191  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.5536599159240723  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 1206, 256])
m.shape torch.Size([996, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.5556774139404297  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.5556774139404297  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 996, 256]), torch.Size([1, 996, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.557577133178711  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.6137371063232422  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 996, 256])
m.shape torch.Size([832, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.6167855262756348  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.6167855262756348  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 832, 256]), torch.Size([1, 832, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.6183724403381348  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.67649507522583  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 832, 256])
m.shape torch.Size([598, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.6791505813598633  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.6791505813598633  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 598, 256]), torch.Size([1, 598, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.6802911758422852  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.7305383682250977  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 598, 256])
m.shape torch.Size([548, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.7336549758911133  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.7336549758911133  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 548, 256]), torch.Size([1, 548, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.7347002029418945  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.7887678146362305  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 548, 256])
m.shape torch.Size([528, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.7923049926757812  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.7923049926757812  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 528, 256]), torch.Size([1, 528, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.7933120727539062  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.850738525390625  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 528, 256])
m.shape torch.Size([421, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.853877067565918  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.853877067565918  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 421, 256]), torch.Size([1, 421, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.854680061340332  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9115715026855469  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 421, 256])
m.shape torch.Size([348, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9145150184631348  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9145150184631348  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 348, 256]), torch.Size([1, 348, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9151787757873535  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9634041786193848  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 348, 256])
m.shape torch.Size([303, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9662761688232422  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9662761688232422  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 1.9668540954589844  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.012526512145996  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([294, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.0156288146972656  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.0156288146972656  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.0161895751953125  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.0645508766174316  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([225, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.067081928253174  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.067081928253174  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.0675110816955566  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.1069931983947754  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([211, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.1096181869506836  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.1096181869506836  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.110020637512207  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.1498632431030273  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([204, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.1526031494140625  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.1526031494140625  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.1529922485351562  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.1942367553710938  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([173, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.196772575378418  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.196772575378418  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.1971025466918945  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.234389305114746  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([138, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.2364792823791504  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.2364792823791504  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.2367424964904785  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.2683281898498535  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([120, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.270272731781006  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.270272731781006  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.2705016136169434  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.299569606781006  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([122, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.3016834259033203  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.3016834259033203  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.3019161224365234  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.333097457885742  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([102, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.334941864013672  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.334941864013672  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.3351364135742188  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.362567901611328  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([79, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.364065170288086  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.364065170288086  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.364215850830078  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.386516571044922  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([84, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.3882174491882324  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes
Using backend: pytorch

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.3882174491882324  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.3883776664733887  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.4132113456726074  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([63, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.4145240783691406  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.4145240783691406  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.414644241333008  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.434110641479492  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([60, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.4354348182678223  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.4354348182678223  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.435549259185791  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.4548897743225098  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([960, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.4778995513916016  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.4778995513916016  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

 h.shape torch.Size([1, 960, 256]), torch.Size([1, 960, 256])
----------------------------------------3
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.4797306060791016  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.8027896881103516  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

rst.shape  torch.Size([1, 960, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.7226643562316895  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.7244763374328613  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.726288318634033  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.7243895530700684  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

torch.Size([11642, 40])
input nodes number: 25079
output nodes number: 11642
edges number: 92989
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.7245802879333496  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 2.724580764770508  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.041159629821777344  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.041159629821777344  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 7.6112060546875 GB
    Memory Allocated: 0.041159629821777344  GigaBytes
Max Memory Allocated: 5.134044647216797  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.022040992975234985 |0.0022190511226654053 |0.12308898568153381 |9.185075759887695e-05 |0.07611802220344543 |0.004812955856323242 |
----------------------------------------------------------pseudo_mini_loss sum 3.6695799827575684
Total (block generation + training)time/epoch 23.205891251564026
* Pure training time/epoch 1.7932841777801514
Training time/epoch 1.841163158416748
Training time without block to device /epoch 1.8234107494354248
Training time without total dataloading part /epoch 1.5992038249969482
load block tensor time/epoch 0.17632794380187988
block to device time/epoch 0.017752408981323242
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  657358
Number of first layer input nodes during this epoch:  422730
Number of first layer output nodes during this epoch:  234628
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
