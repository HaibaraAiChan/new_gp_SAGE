[23:38:44] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28961398 edges into 32 parts and get 9130784 edge cuts
main start at this time 1652225898.7331371
-----------------------------------------before load data 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.8232421875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.8232421875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.060424089431762695
global_2_local spend time (sec) 0.043548583984375
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004477500915527344
A = g.adjacency_matrix() spent  0.006145477294921875
auxiliary_graph
Graph(num_nodes=154710, num_edges=29052339,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0984487533569336
remove nodes length
63769
auxiliary_graph.remove_nodes spent  1.4166603088378906
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29052339,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.320554256439209

the counter of shared neighbor distribution
Counter({1.0: 23396418, 2.0: 4042542, 3.0: 1009392, 4.0: 305652, 5.0: 111008, 6.0: 48054, 7.0: 22158, 8.0: 11680, 9.0: 5998, 10.0: 3494, 11.0: 1958, 12.0: 1128, 13.0: 668, 14.0: 442, 15.0: 276, 16.0: 212, 17.0: 174, 18.0: 66, 19.0: 58, 20.0: 10, 21.0: 6, 22.0: 4})
28961398
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28961395, 28961396, 28961397])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23396418, 2.0: 4042542, 3.0: 1009392, 4.0: 305652, 5.0: 111008, 6.0: 48054, 7.0: 22158, 8.0: 11680, 9.0: 5998, 10.0: 3494, 11.0: 1958, 12.0: 1128, 13.0: 668, 14.0: 442, 15.0: 276, 16.0: 212, 17.0: 174, 18.0: 66, 19.0: 58, 20.0: 10, 21.0: 6, 22.0: 4})
Convert a graph into a bidirected graph: 2.137 seconds
Metis partitioning: 6.752 seconds
Split the graph: 1.282 seconds
Construct subgraphs: 0.125 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  10.31182861328125
2805
2839
2899
2878
2819
2759
2907
2927
2889
2911
2899
2771
2879
2901
2922
2885
2779
2759
2918
2773
2764
2874
2910
2927
2765
2758
2867
2758
2760
2758
2923
2758
total k batches seeds list generation spend  22.409504890441895
after graph partition
graph partition algorithm spend time 22.51434350013733
2805
2839
2899
2878
2819
2759
2907
2927
2889
2911
2899
2771
2879
2901
2922
2885
2779
2759
2918
2773
2764
2874
2910
2927
2765
2758
2867
2758
2760
2758
2923
2758
partition_len_list
[6469, 6259, 5900, 6223, 6314, 8310, 7655, 7704, 5535, 5240, 6645, 6950, 5858, 6947, 7101, 5240, 11577, 10054, 8619, 10689, 10189, 6787, 7980, 9306, 15732, 15451, 18377, 16990, 16283, 16526, 17386, 19184]
shared_neighbor_graph_partition_s0 selection method  spend 22.613606691360474
time for parepare:  0.019232511520385742
local_output_nid generation:  0.0005085468292236328
local_in_edges_tensor generation:  0.0008716583251953125
mini_batch_src_global generation:  0.0010151863098144531
r_  generation:  0.008255481719970703
local_output_nid generation:  0.0006515979766845703
local_in_edges_tensor generation:  0.0007007122039794922
mini_batch_src_global generation:  0.0009443759918212891
r_  generation:  0.007961034774780273
local_output_nid generation:  0.0006842613220214844
local_in_edges_tensor generation:  0.0007104873657226562
mini_batch_src_global generation:  0.0009601116180419922
r_  generation:  0.009525537490844727
local_output_nid generation:  0.0006911754608154297
local_in_edges_tensor generation:  0.0007040500640869141
mini_batch_src_global generation:  0.0008435249328613281
r_  generation:  0.009873390197753906
local_output_nid generation:  0.0006670951843261719
local_in_edges_tensor generation:  0.0006716251373291016
mini_batch_src_global generation:  0.0007462501525878906
r_  generation:  0.008428573608398438
local_output_nid generation:  0.0006499290466308594
local_in_edges_tensor generation:  0.0006589889526367188
mini_batch_src_global generation:  0.0007102489471435547
r_  generation:  0.008076906204223633
local_output_nid generation:  0.0006544589996337891
local_in_edges_tensor generation:  0.0007181167602539062
mini_batch_src_global generation:  0.00092315673828125
r_  generation:  0.009297847747802734
local_output_nid generation:  0.0006382465362548828
local_in_edges_tensor generation:  0.0007109642028808594
mini_batch_src_global generation:  0.0009331703186035156
r_  generation:  0.010149002075195312
local_output_nid generation:  0.0006172657012939453
local_in_edges_tensor generation:  0.0006453990936279297
mini_batch_src_global generation:  0.0006814002990722656
r_  generation:  0.006794452667236328
local_output_nid generation:  0.0006060600280761719
local_in_edges_tensor generation:  0.00064849853515625
mini_batch_src_global generation:  0.0005502700805664062
r_  generation:  0.00620269775390625
local_output_nid generation:  0.0005834102630615234
local_in_edges_tensor generation:  0.0006754398345947266
mini_batch_src_global generation:  0.0007622241973876953
r_  generation:  0.00886845588684082
local_output_nid generation:  0.0005593299865722656
local_in_edges_tensor generation:  0.0006561279296875
mini_batch_src_global generation:  0.0006933212280273438
r_  generation:  0.007176399230957031
local_output_nid generation:  0.0005671977996826172
local_in_edges_tensor generation:  0.000667572021484375
mini_batch_src_global generation:  0.0008418560028076172
r_  generation:  0.008148193359375
local_output_nid generation:  0.0005826950073242188
local_in_edges_tensor generation:  0.0006766319274902344
mini_batch_src_global generation:  0.0009241104125976562
r_  generation:  0.008658170700073242
local_output_nid generation:  0.0005753040313720703
local_in_edges_tensor generation:  0.0006756782531738281
mini_batch_src_global generation:  0.0007843971252441406
r_  generation:  0.008653640747070312
local_output_nid generation:  0.0005578994750976562
local_in_edges_tensor generation:  0.0006799697875976562
mini_batch_src_global generation:  0.0006923675537109375
r_  generation:  0.007575035095214844
local_output_nid generation:  0.0005297660827636719
local_in_edges_tensor generation:  0.0006558895111083984
mini_batch_src_global generation:  0.0008132457733154297
r_  generation:  0.009994745254516602
local_output_nid generation:  0.0005815029144287109
local_in_edges_tensor generation:  0.0010223388671875
mini_batch_src_global generation:  0.0007202625274658203
r_  generation:  0.006813764572143555
local_output_nid generation:  0.000606536865234375
local_in_edges_tensor generation:  0.0006587505340576172
mini_batch_src_global generation:  0.0008752346038818359
r_  generation:  0.0076258182525634766
local_output_nid generation:  0.0005717277526855469
local_in_edges_tensor generation:  0.0006935596466064453
mini_batch_src_global generation:  0.0006737709045410156
r_  generation:  0.006858348846435547
local_output_nid generation:  0.0005526542663574219
local_in_edges_tensor generation:  0.0007953643798828125
mini_batch_src_global generation:  0.0009272098541259766
r_  generation:  0.007949352264404297
local_output_nid generation:  0.0005877017974853516
local_in_edges_tensor generation:  0.0007185935974121094
mini_batch_src_global generation:  0.0006692409515380859
r_  generation:  0.007311582565307617
local_output_nid generation:  0.0005793571472167969
local_in_edges_tensor generation:  0.0006561279296875
mini_batch_src_global generation:  0.0009021759033203125
r_  generation:  0.007634162902832031
local_output_nid generation:  0.000579833984375
local_in_edges_tensor generation:  0.0009546279907226562
mini_batch_src_global generation:  0.00112152099609375
r_  generation:  0.00944972038269043
local_output_nid generation:  0.0005497932434082031
local_in_edges_tensor generation:  0.0007505416870117188
mini_batch_src_global generation:  0.0009174346923828125
r_  generation:  0.009701013565063477
local_output_nid generation:  0.0005588531494140625
local_in_edges_tensor generation:  0.0050907135009765625
mini_batch_src_global generation:  0.002052783966064453
r_  generation:  0.014081478118896484
local_output_nid generation:  0.0006020069122314453
local_in_edges_tensor generation:  0.0007967948913574219
mini_batch_src_global generation:  0.0019817352294921875
r_  generation:  0.014048099517822266
local_output_nid generation:  0.0005805492401123047
local_in_edges_tensor generation:  0.0007190704345703125
mini_batch_src_global generation:  0.0011982917785644531
r_  generation:  0.01134943962097168
local_output_nid generation:  0.0005972385406494141
local_in_edges_tensor generation:  0.0007016658782958984
mini_batch_src_global generation:  0.0011110305786132812
r_  generation:  0.010968685150146484
local_output_nid generation:  0.000591278076171875
local_in_edges_tensor generation:  0.0007748603820800781
mini_batch_src_global generation:  0.001435995101928711
r_  generation:  0.011579036712646484
local_output_nid generation:  0.0006551742553710938
local_in_edges_tensor generation:  0.0009546279907226562
mini_batch_src_global generation:  0.002317190170288086
r_  generation:  0.01627206802368164
local_output_nid generation:  0.0006279945373535156
local_in_edges_tensor generation:  0.0008375644683837891
mini_batch_src_global generation:  0.0013287067413330078
r_  generation:  0.012261152267456055
----------------------check_connections_block total spend ----------------------------- 0.467710018157959
generate_one_block  0.017896175384521484
generate_one_block  0.012630462646484375
generate_one_block  0.013603687286376953
generate_one_block  0.013047456741333008
generate_one_block  0.011196374893188477
generate_one_block  0.01136922836303711
generate_one_block  0.013497591018676758
generate_one_block  0.014656782150268555
generate_one_block  0.009335756301879883
generate_one_block  0.008898735046386719
generate_one_block  0.012401580810546875
generate_one_block  0.010436773300170898
generate_one_block  0.011220693588256836
generate_one_block  0.012306690216064453
generate_one_block  0.012241840362548828
generate_one_block  0.010351419448852539
generate_one_block  0.014728546142578125
generate_one_block  0.010489940643310547
generate_one_block  0.01099395751953125
generate_one_block  0.010615825653076172
generate_one_block  0.011730194091796875
generate_one_block  0.009901762008666992
generate_one_block  0.011209964752197266
generate_one_block  0.014912605285644531
generate_one_block  0.015076160430908203
generate_one_block  0.019534587860107422
generate_one_block  0.021524667739868164
generate_one_block  0.017969369888305664
generate_one_block  0.01696467399597168
generate_one_block  0.01754903793334961
generate_one_block  0.023804426193237305
generate_one_block  0.019864320755004883
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04607868194580078
gen group dst list time:  0.01039576530456543
time for parepare:  0.026225805282592773
local_output_nid generation:  0.0010819435119628906
local_in_edges_tensor generation:  0.013029336929321289
mini_batch_src_global generation:  0.0018978118896484375
r_  generation:  0.018407583236694336
local_output_nid generation:  0.002113819122314453
local_in_edges_tensor generation:  0.0016765594482421875
mini_batch_src_global generation:  0.0018422603607177734
r_  generation:  0.016980409622192383
local_output_nid generation:  0.0017027854919433594
local_in_edges_tensor generation:  0.0013172626495361328
mini_batch_src_global generation:  0.0014967918395996094
r_  generation:  0.017285585403442383
local_output_nid generation:  0.0015833377838134766
local_in_edges_tensor generation:  0.0013282299041748047
mini_batch_src_global generation:  0.001399993896484375
r_  generation:  0.0174405574798584
local_output_nid generation:  0.001695871353149414
local_in_edges_tensor generation:  0.001346588134765625
mini_batch_src_global generation:  0.0013463497161865234
r_  generation:  0.016578197479248047
local_output_nid generation:  0.002101898193359375
local_in_edges_tensor generation:  0.0016775131225585938
mini_batch_src_global generation:  0.0019469261169433594
r_  generation:  0.022736787796020508
local_output_nid generation:  0.0018146038055419922
local_in_edges_tensor generation:  0.0018792152404785156
mini_batch_src_global generation:  0.0027761459350585938
r_  generation:  0.022549152374267578
local_output_nid generation:  0.0013914108276367188
local_in_edges_tensor generation:  0.001512765884399414
mini_batch_src_global generation:  0.0027341842651367188
r_  generation:  0.02386474609375
local_output_nid generation:  0.0012073516845703125
local_in_edges_tensor generation:  0.0012514591217041016
mini_batch_src_global generation:  0.0013308525085449219
r_  generation:  0.013235330581665039
local_output_nid generation:  0.0011782646179199219
local_in_edges_tensor generation:  0.00110626220703125
mini_batch_src_global generation:  0.0009510517120361328
r_  generation:  0.01093292236328125
local_output_nid generation:  0.0015523433685302734
local_in_edges_tensor generation:  0.001379251480102539
mini_batch_src_global generation:  0.0021402835845947266
r_  generation:  0.01950359344482422
local_output_nid generation:  0.0016131401062011719
local_in_edges_tensor generation:  0.001455545425415039
mini_batch_src_global generation:  0.002482175827026367
r_  generation:  0.0190126895904541
local_output_nid generation:  0.0013647079467773438
local_in_edges_tensor generation:  0.001188516616821289
mini_batch_src_global generation:  0.0019631385803222656
r_  generation:  0.016263484954833984
local_output_nid generation:  0.001508474349975586
local_in_edges_tensor generation:  0.0013425350189208984
mini_batch_src_global generation:  0.002201080322265625
r_  generation:  0.019298076629638672
local_output_nid generation:  0.001458883285522461
local_in_edges_tensor generation:  0.0015325546264648438
mini_batch_src_global generation:  0.002488851547241211
r_  generation:  0.020020723342895508
local_output_nid generation:  0.0010628700256347656
local_in_edges_tensor generation:  0.0010857582092285156
mini_batch_src_global generation:  0.0011539459228515625
r_  generation:  0.012250661849975586
local_output_nid generation:  0.0023577213287353516
local_in_edges_tensor generation:  0.002708911895751953
mini_batch_src_global generation:  0.0033240318298339844
r_  generation:  0.036468505859375
local_output_nid generation:  0.002111673355102539
local_in_edges_tensor generation:  0.0022492408752441406
mini_batch_src_global generation:  0.0030045509338378906
r_  generation:  0.029917001724243164
local_output_nid generation:  0.0018761157989501953
local_in_edges_tensor generation:  0.0017330646514892578
mini_batch_src_global generation:  0.0020134449005126953
r_  generation:  0.02457594871520996
local_output_nid generation:  0.002307415008544922
local_in_edges_tensor generation:  0.0021386146545410156
mini_batch_src_global generation:  0.0025177001953125
r_  generation:  0.03205060958862305
local_output_nid generation:  0.002165555953979492
local_in_edges_tensor generation:  0.0020346641540527344
mini_batch_src_global generation:  0.0026330947875976562
r_  generation:  0.03168892860412598
local_output_nid generation:  0.0015072822570800781
local_in_edges_tensor generation:  0.0014195442199707031
mini_batch_src_global generation:  0.0017404556274414062[23:38:50] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 2758 nodes and 750480 edges into 2 parts and get 147004 edge cuts
[23:38:50] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 2867 nodes and 1234346 edges into 2 parts and get 156581 edge cuts

r_  generation:  0.018413305282592773
local_output_nid generation:  0.0017409324645996094
local_in_edges_tensor generation:  0.0015747547149658203
mini_batch_src_global generation:  0.0016455650329589844
r_  generation:  0.02131366729736328
local_output_nid generation:  0.0018889904022216797
local_in_edges_tensor generation:  0.0018444061279296875
mini_batch_src_global generation:  0.0020873546600341797
r_  generation:  0.028362512588500977
local_output_nid generation:  0.0032660961151123047
local_in_edges_tensor generation:  0.005222797393798828
mini_batch_src_global generation:  0.007582664489746094
r_  generation:  0.05706000328063965
local_output_nid generation:  0.0035467147827148438
local_in_edges_tensor generation:  0.006021976470947266
mini_batch_src_global generation:  0.0055348873138427734
r_  generation:  0.05343937873840332
local_output_nid generation:  0.0042307376861572266
local_in_edges_tensor generation:  0.004553556442260742
mini_batch_src_global generation:  0.008104085922241211
r_  generation:  0.06459283828735352
local_output_nid generation:  0.004117727279663086
local_in_edges_tensor generation:  0.0049860477447509766
mini_batch_src_global generation:  0.005977153778076172
r_  generation:  0.06456899642944336
local_output_nid generation:  0.0040323734283447266
local_in_edges_tensor generation:  0.0039348602294921875
mini_batch_src_global generation:  0.005403995513916016
r_  generation:  0.056226491928100586
local_output_nid generation:  0.003954410552978516
local_in_edges_tensor generation:  0.0046427249908447266
mini_batch_src_global generation:  0.008011817932128906
r_  generation:  0.05728459358215332
local_output_nid generation:  0.003999948501586914
local_in_edges_tensor generation:  0.004587888717651367
mini_batch_src_global generation:  0.006795406341552734
r_  generation:  0.06587338447570801
local_output_nid generation:  0.0044858455657958984
local_in_edges_tensor generation:  0.008350849151611328
mini_batch_src_global generation:  0.006670475006103516
r_  generation:  0.07083916664123535
----------------------check_connections_block total spend ----------------------------- 1.4940211772918701
generate_one_block  0.024914026260375977
generate_one_block  0.022471189498901367
generate_one_block  0.022536039352416992
generate_one_block  0.02259373664855957
generate_one_block  0.021452665328979492
generate_one_block  0.030101299285888672
generate_one_block  0.02843022346496582
generate_one_block  0.02986741065979004
generate_one_block  0.016546249389648438
generate_one_block  0.013610124588012695
generate_one_block  0.02434062957763672
generate_one_block  0.031188488006591797
generate_one_block  0.019959211349487305
generate_one_block  0.024349212646484375
generate_one_block  0.025032520294189453
generate_one_block  0.016187429428100586
generate_one_block  0.049805641174316406
generate_one_block  0.03979349136352539
generate_one_block  0.03144073486328125
generate_one_block  0.0452268123626709
generate_one_block  0.04111027717590332
generate_one_block  0.02341485023498535
generate_one_block  0.027780771255493164
generate_one_block  0.036217689514160156
generate_one_block  0.07056927680969238
generate_one_block  0.07295465469360352
generate_one_block  0.08680129051208496
generate_one_block  0.07820391654968262
generate_one_block  0.07463884353637695
generate_one_block  0.07582569122314453
generate_one_block  0.08177709579467773
generate_one_block  0.10662722587585449
global_2_local spend time (sec) 0.0037751197814941406
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0007069110870361328
A = g.adjacency_matrix() spent  0.0005674362182617188
auxiliary_graph
Graph(num_nodes=19184, num_edges=753238,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.012614011764526367
remove nodes length
16426
auxiliary_graph.remove_nodes spent  0.02586221694946289
after remove non output nodes the auxiliary_graph
Graph(num_nodes=2758, num_edges=753238,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.024157285690307617

the counter of shared neighbor distribution
Counter({1.0: 607630, 2.0: 109890, 3.0: 24154, 4.0: 5978, 5.0: 1794, 6.0: 658, 7.0: 228, 8.0: 90, 9.0: 26, 10.0: 16, 11.0: 8, 15.0: 2, 14.0: 2, 16.0: 2, 13.0: 2})
750480
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------
Convert a graph into a bidirected graph: 0.022 seconds
Metis partitioning: 0.059 seconds
Split the graph: 0.044 seconds
Construct subgraphs: 0.023 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.14892792701721191
1379
1379
total k batches seeds list generation spend  0.3765676021575928
after graph partition
graph partition algorithm spend time 0.3835880756378174
1379
1379
time for parepare:  0.021783113479614258
local_output_nid generation:  0.000232696533203125
local_in_edges_tensor generation:  0.0005555152893066406
mini_batch_src_global generation:  0.0007567405700683594
r_  generation:  0.005297183990478516
local_output_nid generation:  0.00022673606872558594
local_in_edges_tensor generation:  0.0005147457122802734
mini_batch_src_global generation:  0.0009295940399169922
r_  generation:  0.00634765625
----------------------check_connections_block total spend ----------------------------- 0.0433197021484375
generate_one_block  0.010164260864257812
generate_one_block  0.010967254638671875
time for parepare:  0.020473241806030273
local_output_nid generation:  0.0016188621520996094
local_in_edges_tensor generation:  0.002766132354736328
mini_batch_src_global generation:  0.0034630298614501953
r_  generation:  0.0357513427734375
local_output_nid generation:  0.002727508544921875
local_in_edges_tensor generation:  0.0033943653106689453
mini_batch_src_global generation:  0.004449367523193359
r_  generation:  0.042899131774902344
----------------------check_connections_block total spend ----------------------------- 0.139068603515625
generate_one_block  0.05390119552612305
generate_one_block  0.05910205841064453
global_2_local spend time (sec) 0.0037152767181396484
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0006325244903564453
A = g.adjacency_matrix() spent  0.0006430149078369141
auxiliary_graph
Graph(num_nodes=18377, num_edges=1237213,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0117645263671875
remove nodes length
15510
auxiliary_graph.remove_nodes spent  0.04852128028869629
after remove non output nodes the auxiliary_graph
Graph(num_nodes=2867, num_edges=1237213,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.03510546684265137

the counter of shared neighbor distribution
Counter({1.0: 1105152, 2.0: 107706, 3.0: 16606, 4.0: 3360, 5.0: 982, 6.0: 328, 7.0: 110, 8.0: 62, 10.0: 14, 9.0: 14, 11.0: 10, 12.0: 2})
1234346
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------
Convert a graph into a bidirected graph: 0.037 seconds
Metis partitioning: 0.071 seconds
Split the graph: 0.164 seconds
Construct subgraphs: 0.023 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.2959728240966797
1410
1457
total k batches seeds list generation spend  0.6544246673583984
after graph partition
graph partition algorithm spend time 0.6907923221588135
1410
1457
time for parepare:  0.044333457946777344
local_output_nid generation:  0.00038695335388183594
local_in_edges_tensor generation:  0.005824089050292969
mini_batch_src_global generation:  0.0014348030090332031
r_  generation:  0.010874509811401367
local_output_nid generation:  0.000377655029296875
local_in_edges_tensor generation:  0.0024225711822509766
mini_batch_src_global generation:  0.0013422966003417969
r_  generation:  0.009416341781616211
----------------------check_connections_block total spend ----------------------------- 0.08855795860290527
generate_one_block  0.01772284507751465
generate_one_block  0.013539791107177734
time for parepare:  0.022736549377441406
local_output_nid generation:  0.002010345458984375
local_in_edges_tensor generation:  0.010459423065185547
mini_batch_src_global generation:  0.010782957077026367
r_  generation:  0.07499551773071289
local_output_nid generation:  0.004536628723144531
local_in_edges_tensor generation:  0.0030298233032226562
mini_batch_src_global generation:  0.004221677780151367
r_  generation:  0.036933183670043945
----------------------check_connections_block total spend ----------------------------- 0.20359396934509277
generate_one_block  0.06634926795959473
generate_one_block  0.04276847839355469
----------===============-------------===============-------------the number of batches *****---- 34

original number of batches:  32
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.8232421875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  1.4940211772918701
block generation total time  1.3157687187194824
average batch blocks generation time:  0.041117772459983826
pseudo mini batch 0 input nodes size: 16561
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.8232421875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.8232421875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.8427734375 GB
    Memory Allocated: 0.010674476623535156  GigaBytes
Max Memory Allocated: 0.010674476623535156  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.8427734375 GB
    Memory Allocated: 0.010695457458496094  GigaBytes
Max Memory Allocated: 0.010695457458496094  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.8427734375 GB
    Memory Allocated: 0.010695457458496094  GigaBytes
Max Memory Allocated: 0.010695457458496094  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 0.8916015625 GB
    Memory Allocated: 0.011180877685546875  GigaBytes
Max Memory Allocated: 0.011180877685546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.8916015625 GB
    Memory Allocated: 0.011180877685546875  GigaBytes
Max Memory Allocated: 0.011180877685546875  GigaBytes

first layer input nodes number: 16561
first layer output nodes number: 6469
edges number: 43439
input nodes number: 6469
output nodes number: 2805
edges number: 21581
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6689453125 GB
    Memory Allocated: 0.6801838874816895  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6689453125 GB
    Memory Allocated: 0.6801848411560059  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.015322685241699219  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

pseudo mini batch 1 input nodes size: 15659
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.013889789581298828  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.013889789581298828  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.021356582641601562  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.021378040313720703  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.013460159301757812  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.013909339904785156  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.013909339904785156  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

first layer input nodes number: 15659
first layer output nodes number: 6259
edges number: 39631
input nodes number: 6259
output nodes number: 2839
edges number: 20584
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.6394400596618652  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.6394405364990234  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.014806747436523438  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

pseudo mini batch 2 input nodes size: 12510
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.013465404510498047  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.013465404510498047  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.01943063735961914  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.019452571868896484  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.01196432113647461  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.012466907501220703  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.012466907501220703  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

first layer input nodes number: 12510
first layer output nodes number: 5900
edges number: 41738
input nodes number: 5900
output nodes number: 2899
edges number: 25575
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7978515625 GB
    Memory Allocated: 0.7262825965881348  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7978515625 GB
    Memory Allocated: 0.726283073425293  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.013428688049316406  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

pseudo mini batch 3 input nodes size: 13679
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.011972904205322266  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.011972904205322266  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.018495559692382812  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.018517017364501953  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.012529850006103516  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.013020992279052734  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.013020992279052734  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

first layer input nodes number: 13679
first layer output nodes number: 6223
edges number: 41476
input nodes number: 6223
output nodes number: 2878
edges number: 24297
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.7064943313598633  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.7064948081970215  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.013965129852294922  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

pseudo mini batch 4 input nodes size: 14079
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.012526988983154297  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.012526988983154297  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.019570350646972656  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.019591808319091797  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.01304769515991211  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.013483524322509766  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.013483524322509766  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

first layer input nodes number: 14079
first layer output nodes number: 6314
edges number: 38437
input nodes number: 6314
output nodes number: 2819
edges number: 19916
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.6279087066650391  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.6279091835021973  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.014338493347167969  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

pseudo mini batch 5 input nodes size: 21204
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.01303863525390625  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.01303863525390625  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.023149490356445312  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.02317047119140625  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.01610565185546875  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.0166473388671875  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.0166473388671875  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

first layer input nodes number: 21204
first layer output nodes number: 8310
edges number: 53430
input nodes number: 8310
output nodes number: 2759
edges number: 19130
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8779296875 GB
    Memory Allocated: 0.7304835319519043  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8779296875 GB
    Memory Allocated: 0.7304840087890625  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8779296875 GB
    Memory Allocated: 0.017699241638183594  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

pseudo mini batch 6 input nodes size: 15529
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8779296875 GB
    Memory Allocated: 0.016097068786621094  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8779296875 GB
    Memory Allocated: 0.016097068786621094  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8779296875 GB
    Memory Allocated: 0.023501873016357422  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8779296875 GB
    Memory Allocated: 0.023523807525634766  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8779296875 GB
    Memory Allocated: 0.013391971588134766  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8779296875 GB
    Memory Allocated: 0.013967037200927734  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8779296875 GB
    Memory Allocated: 0.013967037200927734  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

first layer input nodes number: 15529
first layer output nodes number: 7655
edges number: 52493
input nodes number: 7655
output nodes number: 2907
edges number: 24506
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9169921875 GB
    Memory Allocated: 0.7975063323974609  GigaBytes
Max Memory Allocated: 0.8259906768798828  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9169921875 GB
    Memory Allocated: 0.7975068092346191  GigaBytes
Max Memory Allocated: 0.8259906768798828  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9169921875 GB
    Memory Allocated: 0.015067577362060547  GigaBytes
Max Memory Allocated: 0.8259906768798828  GigaBytes

pseudo mini batch 7 input nodes size: 15838
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9169921875 GB
    Memory Allocated: 0.01341390609741211  GigaBytes
Max Memory Allocated: 0.8259906768798828  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9169921875 GB
    Memory Allocated: 0.01341390609741211  GigaBytes
Max Memory Allocated: 0.8259906768798828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9169921875 GB
    Memory Allocated: 0.020966053009033203  GigaBytes
Max Memory Allocated: 0.8259906768798828  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9169921875 GB
    Memory Allocated: 0.020987987518310547  GigaBytes
Max Memory Allocated: 0.8259906768798828  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9169921875 GB
    Memory Allocated: 0.013561248779296875  GigaBytes
Max Memory Allocated: 0.8259906768798828  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9169921875 GB
    Memory Allocated: 0.014185905456542969  GigaBytes
Max Memory Allocated: 0.8259906768798828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9169921875 GB
    Memory Allocated: 0.014185905456542969  GigaBytes
Max Memory Allocated: 0.8259906768798828  GigaBytes

first layer input nodes number: 15838
first layer output nodes number: 7704
edges number: 56645
input nodes number: 7704
output nodes number: 2927
edges number: 27115
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9169921875 GB
    Memory Allocated: 0.864346981048584  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9169921875 GB
    Memory Allocated: 0.8643474578857422  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.015340328216552734  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

pseudo mini batch 8 input nodes size: 11298
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.013564109802246094  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.013564109802246094  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.018951416015625  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.018973350524902344  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.011399269104003906  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.011734962463378906  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.011734962463378906  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

first layer input nodes number: 11298
first layer output nodes number: 5535
edges number: 28789
input nodes number: 5535
output nodes number: 2889
edges number: 16216
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.49480724334716797  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.49480772018432617  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.01242828369140625  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

pseudo mini batch 9 input nodes size: 9176
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.011393547058105469  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.011393547058105469  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.015769004821777344  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.015790939331054688  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.010381698608398438  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.010671615600585938  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.010671615600585938  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

first layer input nodes number: 9176
first layer output nodes number: 5240
edges number: 24369
input nodes number: 5240
output nodes number: 2911
edges number: 14374
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.4329051971435547  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.4329056739807129  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.01129150390625  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

pseudo mini batch 10 input nodes size: 16213
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.01038503646850586  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.01038503646850586  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.018115997314453125  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.01813793182373047  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.01374053955078125  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.014247894287109375  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.014247894287109375  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

first layer input nodes number: 16213
first layer output nodes number: 6645
edges number: 44877
input nodes number: 6645
output nodes number: 2899
edges number: 23163
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.720606803894043  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.7206072807312012  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.015228748321533203  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

pseudo mini batch 11 input nodes size: 17788
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.013738632202148438  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.013738632202148438  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.022220611572265625  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.022241592407226562  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.014488697052001953  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.01493692398071289  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.01493692398071289  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

first layer input nodes number: 17788
first layer output nodes number: 6950
edges number: 42131
input nodes number: 6950
output nodes number: 2771
edges number: 17890
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.6288037300109863  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.6288042068481445  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.015820026397705078  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

pseudo mini batch 12 input nodes size: 11722
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.014469623565673828  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.014469623565673828  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.02005910873413086  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.02008056640625  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.011577606201171875  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.011993408203125  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.011993408203125  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

first layer input nodes number: 11722
first layer output nodes number: 5858
edges number: 35246
input nodes number: 5858
output nodes number: 2879
edges number: 20396
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.6017436981201172  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.6017441749572754  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.012829780578613281  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

pseudo mini batch 13 input nodes size: 15873
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.011593818664550781  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.011593818664550781  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.019162654876708984  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.019184589385986328  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.013573646545410156  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.014063835144042969  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.014063835144042969  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

first layer input nodes number: 15873
first layer output nodes number: 6947
edges number: 43630
input nodes number: 6947
output nodes number: 2901
edges number: 22143
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.6966118812561035  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.6966123580932617  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.015030384063720703  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

pseudo mini batch 14 input nodes size: 15944
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.013576984405517578  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.013576984405517578  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.021179676055908203  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.021201610565185547  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.01361083984375  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.0141143798828125  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.0141143798828125  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

first layer input nodes number: 15944
first layer output nodes number: 7101
edges number: 45506
input nodes number: 7101
output nodes number: 2922
edges number: 21999
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.7063660621643066  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.7063665390014648  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.015096664428710938  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

pseudo mini batch 15 input nodes size: 10316
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.013614177703857422  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.013614177703857422  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.01853322982788086  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.018555164337158203  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.010930538177490234  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.01128530502319336  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.01128530502319336  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

first layer input nodes number: 10316
first layer output nodes number: 5240
edges number: 28668
input nodes number: 5240
output nodes number: 2885
edges number: 18851
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.5271744728088379  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.5271749496459961  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.012002944946289062  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

pseudo mini batch 16 input nodes size: 30634
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.010924816131591797  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.010924816131591797  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.025532245635986328  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.025553226470947266  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.020612239837646484  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.021445751190185547  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.021445751190185547  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

first layer input nodes number: 30634
first layer output nodes number: 11577
edges number: 89201
input nodes number: 11577
output nodes number: 2779
edges number: 22573
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2001953125 GB
    Memory Allocated: 1.0678153038024902  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2001953125 GB
    Memory Allocated: 1.0678157806396484  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.022951602935791016  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

pseudo mini batch 17 input nodes size: 31373
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.02059650421142578  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.02059650421142578  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.03555631637573242  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.03557729721069336  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.02094888687133789  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.021593570709228516  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.021593570709228516  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

first layer input nodes number: 31373
first layer output nodes number: 10054
edges number: 69544
input nodes number: 10054
output nodes number: 2759
edges number: 16816
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.8363094329833984  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.8363099098205566  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.02285289764404297  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

pseudo mini batch 18 input nodes size: 24855
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.020946025848388672  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.020946025848388672  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.032797813415527344  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.03281974792480469  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.01783895492553711  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.01839303970336914  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.01839303970336914  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

first layer input nodes number: 24855
first layer output nodes number: 8619
edges number: 55706
input nodes number: 8619
output nodes number: 2918
edges number: 18484
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.7460761070251465  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.7460765838623047  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.01952075958251953  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

pseudo mini batch 19 input nodes size: 36375
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.017862319946289062  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.017862319946289062  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.035207271575927734  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.03522825241088867  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.023354530334472656  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.024039268493652344  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.024039268493652344  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

first layer input nodes number: 36375
first layer output nodes number: 10689
edges number: 74816
input nodes number: 10689
output nodes number: 2773
edges number: 16964
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.874547004699707  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.8745474815368652  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.02537250518798828  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

pseudo mini batch 20 input nodes size: 31511
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.023333072662353516  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.023333072662353516  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.03835868835449219  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.038379669189453125  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.021013736724853516  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.021692752838134766  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.021692752838134766  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

first layer input nodes number: 31511
first layer output nodes number: 10189
edges number: 71342
input nodes number: 10189
output nodes number: 2764
edges number: 19611
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.8822736740112305  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.8822741508483887  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.023012638092041016  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

pseudo mini batch 21 input nodes size: 17552
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.021012306213378906  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.021012306213378906  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.029381752014160156  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.029403209686279297  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.014356613159179688  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.014787673950195312  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.014787673950195312  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

first layer input nodes number: 17552
first layer output nodes number: 6787
edges number: 40472
input nodes number: 6787
output nodes number: 2874
edges number: 17189
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.6029801368713379  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.6029806137084961  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.01568126678466797  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

pseudo mini batch 22 input nodes size: 20538
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.014373302459716797  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.014373302459716797  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.024166584014892578  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.024188518524169922  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.01579761505126953  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.01630878448486328  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.01630878448486328  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

first layer input nodes number: 20538
first layer output nodes number: 7980
edges number: 49486
input nodes number: 7980
output nodes number: 2910
edges number: 18953
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.6984906196594238  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.698491096496582  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.01733255386352539  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

pseudo mini batch 23 input nodes size: 25001
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.015802860260009766  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.015802860260009766  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.027724266052246094  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.027746200561523438  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.017930984497070312  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.018609046936035156  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.018609046936035156  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

first layer input nodes number: 25001
first layer output nodes number: 9306
edges number: 66277
input nodes number: 9306
output nodes number: 2927
edges number: 24657
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.9246153831481934  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.9246158599853516  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.019901752471923828  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

pseudo mini batch 24 input nodes size: 47069
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.017933368682861328  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.017933368682861328  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.04037761688232422  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.040398597717285156  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.028455257415771484  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.02958059310913086  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.02958059310913086  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

first layer input nodes number: 47069
first layer output nodes number: 15732
edges number: 126548
input nodes number: 15732
output nodes number: 2765
edges number: 24413
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5615234375 GB
    Memory Allocated: 1.3943395614624023  GigaBytes
Max Memory Allocated: 1.4243192672729492  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.5615234375 GB
    Memory Allocated: 1.3943400382995605  GigaBytes
Max Memory Allocated: 1.4243192672729492  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.5849609375 GB
    Memory Allocated: 0.031598567962646484  GigaBytes
Max Memory Allocated: 1.4243192672729492  GigaBytes

pseudo mini batch 25 input nodes size: 38514
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.5849609375 GB
    Memory Allocated: 0.028431415557861328  GigaBytes
Max Memory Allocated: 1.4243192672729492  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.5849609375 GB
    Memory Allocated: 0.028431415557861328  GigaBytes
Max Memory Allocated: 1.4243192672729492  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.5849609375 GB
    Memory Allocated: 0.046796321868896484  GigaBytes
Max Memory Allocated: 1.4243192672729492  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.5849609375 GB
    Memory Allocated: 0.04681730270385742  GigaBytes
Max Memory Allocated: 1.4243192672729492  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.5849609375 GB
    Memory Allocated: 0.024352073669433594  GigaBytes
Max Memory Allocated: 1.4243192672729492  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.5849609375 GB
    Memory Allocated: 0.025583267211914062  GigaBytes
Max Memory Allocated: 1.4243192672729492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5849609375 GB
    Memory Allocated: 0.025583267211914062  GigaBytes
Max Memory Allocated: 1.4243192672729492  GigaBytes

first layer input nodes number: 38514
first layer output nodes number: 15451
edges number: 131734
input nodes number: 15451
output nodes number: 2758
edges number: 33286
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8955078125 GB
    Memory Allocated: 1.5514216423034668  GigaBytes
Max Memory Allocated: 1.5986342430114746  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.8955078125 GB
    Memory Allocated: 1.551422119140625  GigaBytes
Max Memory Allocated: 1.5986342430114746  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.9287109375 GB
    Memory Allocated: 0.02772665023803711  GigaBytes
Max Memory Allocated: 1.5986342430114746  GigaBytes

pseudo mini batch 26 input nodes size: 46552
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.9287109375 GB
    Memory Allocated: 0.024350643157958984  GigaBytes
Max Memory Allocated: 1.5986342430114746  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.9287109375 GB
    Memory Allocated: 0.024350643157958984  GigaBytes
Max Memory Allocated: 1.5986342430114746  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.9287109375 GB
    Memory Allocated: 0.04654836654663086  GigaBytes
Max Memory Allocated: 1.5986342430114746  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.9287109375 GB
    Memory Allocated: 0.0465693473815918  GigaBytes
Max Memory Allocated: 1.5986342430114746  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.9287109375 GB
    Memory Allocated: 0.028183460235595703  GigaBytes
Max Memory Allocated: 1.5986342430114746  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.9287109375 GB
    Memory Allocated: 0.029464244842529297  GigaBytes
Max Memory Allocated: 1.5986342430114746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9287109375 GB
    Memory Allocated: 0.029464244842529297  GigaBytes
Max Memory Allocated: 1.5986342430114746  GigaBytes

first layer input nodes number: 46552
first layer output nodes number: 16990
edges number: 142989
input nodes number: 16990
output nodes number: 2758
edges number: 28687
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2900390625 GB
    Memory Allocated: 1.577122688293457  GigaBytes
Max Memory Allocated: 1.615664005279541  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2900390625 GB
    Memory Allocated: 1.5771231651306152  GigaBytes
Max Memory Allocated: 1.615664005279541  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2900390625 GB
    Memory Allocated: 0.03171873092651367  GigaBytes
Max Memory Allocated: 1.615664005279541  GigaBytes

pseudo mini batch 27 input nodes size: 43098
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2900390625 GB
    Memory Allocated: 0.028183460235595703  GigaBytes
Max Memory Allocated: 1.615664005279541  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2900390625 GB
    Memory Allocated: 0.028183460235595703  GigaBytes
Max Memory Allocated: 1.615664005279541  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2900390625 GB
    Memory Allocated: 0.0496678352355957  GigaBytes
Max Memory Allocated: 1.615664005279541  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2900390625 GB
    Memory Allocated: 0.04968881607055664  GigaBytes
Max Memory Allocated: 1.615664005279541  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2900390625 GB
    Memory Allocated: 0.027470111846923828  GigaBytes
Max Memory Allocated: 1.615664005279541  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2900390625 GB
    Memory Allocated: 0.028707027435302734  GigaBytes
Max Memory Allocated: 1.615664005279541  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2900390625 GB
    Memory Allocated: 0.028707027435302734  GigaBytes
Max Memory Allocated: 1.615664005279541  GigaBytes

first layer input nodes number: 43098
first layer output nodes number: 16283
edges number: 137201
input nodes number: 16283
output nodes number: 2760
edges number: 28692
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2900390625 GB
    Memory Allocated: 1.5271625518798828  GigaBytes
Max Memory Allocated: 1.615664005279541  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2900390625 GB
    Memory Allocated: 1.527163028717041  GigaBytes
Max Memory Allocated: 1.615664005279541  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2900390625 GB
    Memory Allocated: 0.030877113342285156  GigaBytes
Max Memory Allocated: 1.615664005279541  GigaBytes

pseudo mini batch 28 input nodes size: 42852
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2900390625 GB
    Memory Allocated: 0.02747058868408203  GigaBytes
Max Memory Allocated: 1.615664005279541  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2900390625 GB
    Memory Allocated: 0.02747058868408203  GigaBytes
Max Memory Allocated: 1.615664005279541  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2900390625 GB
    Memory Allocated: 0.047904014587402344  GigaBytes
Max Memory Allocated: 1.615664005279541  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2900390625 GB
    Memory Allocated: 0.04792499542236328  GigaBytes
Max Memory Allocated: 1.615664005279541  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2900390625 GB
    Memory Allocated: 0.026419639587402344  GigaBytes
Max Memory Allocated: 1.615664005279541  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2900390625 GB
    Memory Allocated: 0.027681350708007812  GigaBytes
Max Memory Allocated: 1.615664005279541  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2900390625 GB
    Memory Allocated: 0.027681350708007812  GigaBytes
Max Memory Allocated: 1.615664005279541  GigaBytes

first layer input nodes number: 42852
first layer output nodes number: 16526
edges number: 139956
input nodes number: 16526
output nodes number: 2758
edges number: 29296
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2900390625 GB
    Memory Allocated: 1.5568742752075195  GigaBytes
Max Memory Allocated: 1.615664005279541  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2900390625 GB
    Memory Allocated: 1.5568747520446777  GigaBytes
Max Memory Allocated: 1.615664005279541  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2900390625 GB
    Memory Allocated: 0.02988290786743164  GigaBytes
Max Memory Allocated: 1.615664005279541  GigaBytes

pseudo mini batch 29 input nodes size: 38575
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2900390625 GB
    Memory Allocated: 0.02641916275024414  GigaBytes
Max Memory Allocated: 1.615664005279541  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2900390625 GB
    Memory Allocated: 0.02641916275024414  GigaBytes
Max Memory Allocated: 1.615664005279541  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2900390625 GB
    Memory Allocated: 0.04481315612792969  GigaBytes
Max Memory Allocated: 1.615664005279541  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2900390625 GB
    Memory Allocated: 0.04483509063720703  GigaBytes
Max Memory Allocated: 1.615664005279541  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2900390625 GB
    Memory Allocated: 0.02438068389892578  GigaBytes
Max Memory Allocated: 1.615664005279541  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2900390625 GB
    Memory Allocated: 0.0258331298828125  GigaBytes
Max Memory Allocated: 1.615664005279541  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2900390625 GB
    Memory Allocated: 0.0258331298828125  GigaBytes
Max Memory Allocated: 1.615664005279541  GigaBytes

first layer input nodes number: 38575
first layer output nodes number: 17386
edges number: 154209
input nodes number: 17386
output nodes number: 2923
edges number: 40625
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7861328125 GB
    Memory Allocated: 1.8185863494873047  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7861328125 GB
    Memory Allocated: 1.818586826324463  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02832317352294922  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 30 input nodes size: 33078
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.024405479431152344  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.024405479431152344  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.04017829895019531  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.04018878936767578  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02177286148071289  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.022544384002685547  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.022544384002685547  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 33078
first layer output nodes number: 10270
edges number: 88326
input nodes number: 10270
output nodes number: 1379
edges number: 14996
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.9394245147705078  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.939424991607666  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.023691177368164062  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 31 input nodes size: 36808
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02154254913330078  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02154254913330078  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.039093971252441406  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.039104461669921875  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.023321151733398438  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.024239540100097656  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.024239540100097656  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 36808
first layer output nodes number: 11769
edges number: 105446
input nodes number: 11769
output nodes number: 1379
edges number: 17719
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 1.118849754333496  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 1.1188502311706543  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.025844097137451172  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 32 input nodes size: 36434
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.023321151733398438  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes
[23:39:23] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 29070896 edges into 32 parts and get 9244011 edge cuts

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.023321151733398438  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.040694236755371094  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.040705204010009766  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.023143291473388672  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.024024486541748047  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.024024486541748047  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 36434
first layer output nodes number: 11223
edges number: 100262
input nodes number: 11223
output nodes number: 1410
edges number: 17852
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 1.0723767280578613  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 1.0723772048950195  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02558422088623047  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 33 input nodes size: 26643
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.023148059844970703  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.023148059844970703  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.0368199348449707  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.036830902099609375  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.019446849822998047  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.020113468170166016  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.020113468170166016  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 26643
first layer output nodes number: 8876
edges number: 73606
input nodes number: 8876
output nodes number: 1457
edges number: 15701
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.8309249877929688  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.830925464630127  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02131938934326172  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.026869773864746094  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.026869773864746094  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00991986779605641 |0.014049242524539722 |0.1470563061097089 |0.00013307964100557214 |0.1257104943780338 |0.011437654495239258 |
----------------------------------------------------------pseudo_mini_loss sum 5.295938968658447
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1160908
Number of first layer input nodes during this epoch:  840851
Number of first layer output nodes during this epoch:  320057
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02686929702758789  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.023463010787963867
global_2_local spend time (sec) 0.0501556396484375
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004350185394287109
A = g.adjacency_matrix() spent  0.0065441131591796875
auxiliary_graph
Graph(num_nodes=154609, num_edges=29161837,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.10171937942504883
remove nodes length
63668
auxiliary_graph.remove_nodes spent  1.598968267440796
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29161837,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.4166922569274902

the counter of shared neighbor distribution
Counter({1.0: 23512832, 2.0: 4033528, 3.0: 1010720, 4.0: 307066, 5.0: 110996, 6.0: 47742, 7.0: 21964, 8.0: 11366, 9.0: 6212, 10.0: 3480, 11.0: 1996, 12.0: 1116, 13.0: 654, 14.0: 456, 15.0: 268, 16.0: 194, 17.0: 166, 18.0: 66, 19.0: 50, 20.0: 18, 21.0: 6})
29070896
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 29070893, 29070894, 29070895])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23512832, 2.0: 4033528, 3.0: 1010720, 4.0: 307066, 5.0: 110996, 6.0: 47742, 7.0: 21964, 8.0: 11366, 9.0: 6212, 10.0: 3480, 11.0: 1996, 12.0: 1116, 13.0: 654, 14.0: 456, 15.0: 268, 16.0: 194, 17.0: 166, 18.0: 66, 19.0: 50, 20.0: 18, 21.0: 6})
Convert a graph into a bidirected graph: 2.053 seconds
Metis partitioning: 6.784 seconds
Split the graph: 0.933 seconds
Construct subgraphs: 0.127 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  9.912542581558228
2760
2927
2871
2905
2827
2758
2874
2758
2760
2758
2879
2758
2762
2794
2774
2843
2846
2923
2916
2758
2823
2868
2814
2816
2927
2896
2894
2926
2891
2903
2842
2890
total k batches seeds list generation spend  22.461748361587524
after graph partition
graph partition algorithm spend time 22.563841342926025
2760
2927
2871
2905
2827
2758
2874
2758
2760
2758
2879
2758
2762
2794
2774
2843
2846
2923
2916
2758
2823
2868
2814
2816
2927
2896
2894
2926
2891
2903
2842
2890
partition_len_list
[8856, 9265, 6830, 8639, 11374, 15658, 7960, 11569, 16619, 16625, 17002, 17754, 14250, 13649, 18286, 18074, 6449, 7321, 7442, 8294, 6101, 5877, 5890, 6825, 5693, 5475, 6578, 8105, 5795, 6879, 6215, 4993]
shared_neighbor_graph_partition_s0 selection method  spend 22.673863410949707
time for parepare:  0.020561933517456055
local_output_nid generation:  0.0005745887756347656
local_in_edges_tensor generation:  0.0009222030639648438
mini_batch_src_global generation:  0.0009632110595703125
r_  generation:  0.0066874027252197266
local_output_nid generation:  0.0007083415985107422
local_in_edges_tensor generation:  0.0008060932159423828
mini_batch_src_global generation:  0.0012011528015136719
r_  generation:  0.009453296661376953
local_output_nid generation:  0.0007750988006591797
local_in_edges_tensor generation:  0.0006933212280273438
mini_batch_src_global generation:  0.0007631778717041016
r_  generation:  0.007056474685668945
local_output_nid generation:  0.0008184909820556641
local_in_edges_tensor generation:  0.0007596015930175781
mini_batch_src_global generation:  0.0007345676422119141
r_  generation:  0.007990598678588867
local_output_nid generation:  0.0007674694061279297
local_in_edges_tensor generation:  0.0007445812225341797
mini_batch_src_global generation:  0.0008957386016845703
r_  generation:  0.008655309677124023
local_output_nid generation:  0.0007388591766357422
local_in_edges_tensor generation:  0.0007987022399902344
mini_batch_src_global generation:  0.00138092041015625
r_  generation:  0.013427734375
local_output_nid generation:  0.0007855892181396484
local_in_edges_tensor generation:  0.0007047653198242188
mini_batch_src_global generation:  0.0008120536804199219
r_  generation:  0.007633686065673828
local_output_nid generation:  0.0007476806640625
local_in_edges_tensor generation:  0.0006775856018066406
mini_batch_src_global generation:  0.0008482933044433594
r_  generation:  0.009076356887817383
local_output_nid generation:  0.0007393360137939453
local_in_edges_tensor generation:  0.0007975101470947266
mini_batch_src_global generation:  0.0010924339294433594
r_  generation:  0.01057124137878418
local_output_nid generation:  0.0007216930389404297
local_in_edges_tensor generation:  0.0006871223449707031
mini_batch_src_global generation:  0.0011301040649414062
r_  generation:  0.011190652847290039
local_output_nid generation:  0.000782012939453125
local_in_edges_tensor generation:  0.000751495361328125
mini_batch_src_global generation:  0.00701904296875
r_  generation:  0.015133142471313477
local_output_nid generation:  0.0009312629699707031
local_in_edges_tensor generation:  0.0008158683776855469
mini_batch_src_global generation:  0.0013964176177978516
r_  generation:  0.01236104965209961
local_output_nid generation:  0.0008959770202636719
local_in_edges_tensor generation:  0.0007998943328857422
mini_batch_src_global generation:  0.0010230541229248047
r_  generation:  0.009232282638549805
local_output_nid generation:  0.0009162425994873047
local_in_edges_tensor generation:  0.0008025169372558594
mini_batch_src_global generation:  0.0008807182312011719
r_  generation:  0.008872270584106445
local_output_nid generation:  0.0008902549743652344
local_in_edges_tensor generation:  0.000759124755859375
mini_batch_src_global generation:  0.0010745525360107422
r_  generation:  0.011411666870117188
local_output_nid generation:  0.0009088516235351562
local_in_edges_tensor generation:  0.0007712841033935547
mini_batch_src_global generation:  0.0011773109436035156
r_  generation:  0.011843204498291016
local_output_nid generation:  0.0009355545043945312
local_in_edges_tensor generation:  0.0007679462432861328
mini_batch_src_global generation:  0.0009894371032714844
r_  generation:  0.00996541976928711
local_output_nid generation:  0.0009455680847167969
local_in_edges_tensor generation:  0.0007781982421875
mini_batch_src_global generation:  0.0010080337524414062
r_  generation:  0.010414361953735352
local_output_nid generation:  0.0009038448333740234
local_in_edges_tensor generation:  0.0007562637329101562
mini_batch_src_global generation:  0.0009856224060058594
r_  generation:  0.010035276412963867
local_output_nid generation:  0.0008347034454345703
local_in_edges_tensor generation:  0.0007212162017822266
mini_batch_src_global generation:  0.0008485317230224609
r_  generation:  0.008309125900268555
local_output_nid generation:  0.0008594989776611328
local_in_edges_tensor generation:  0.0007178783416748047
mini_batch_src_global generation:  0.0008637905120849609
r_  generation:  0.0091400146484375
local_output_nid generation:  0.0008640289306640625
local_in_edges_tensor generation:  0.0007123947143554688
mini_batch_src_global generation:  0.0006792545318603516
r_  generation:  0.0070531368255615234
local_output_nid generation:  0.0008332729339599609
local_in_edges_tensor generation:  0.0007300376892089844
mini_batch_src_global generation:  0.00081634521484375
r_  generation:  0.009397745132446289
local_output_nid generation:  0.0008096694946289062
local_in_edges_tensor generation:  0.0007317066192626953
mini_batch_src_global generation:  0.0008027553558349609
r_  generation:  0.008406877517700195
local_output_nid generation:  0.0008482933044433594
local_in_edges_tensor generation:  0.0007979869842529297
mini_batch_src_global generation:  0.0006549358367919922
r_  generation:  0.006646394729614258
local_output_nid generation:  0.0008199214935302734
local_in_edges_tensor generation:  0.0007545948028564453
mini_batch_src_global generation:  0.0005679130554199219
r_  generation:  0.006312847137451172
local_output_nid generation:  0.0008268356323242188
local_in_edges_tensor generation:  0.0007839202880859375
mini_batch_src_global generation:  0.00075531005859375
r_  generation:  0.00874018669128418
local_output_nid generation:  0.0008401870727539062
local_in_edges_tensor generation:  0.0007233619689941406
mini_batch_src_global generation:  0.0007970333099365234
r_  generation:  0.008559942245483398
local_output_nid generation:  0.0007967948913574219
local_in_edges_tensor generation:  0.0007014274597167969
mini_batch_src_global generation:  0.0007145404815673828
r_  generation:  0.009212017059326172
local_output_nid generation:  0.0008852481842041016
local_in_edges_tensor generation:  0.0007734298706054688
mini_batch_src_global generation:  0.000820159912109375
r_  generation:  0.008972644805908203
local_output_nid generation:  0.0008442401885986328
local_in_edges_tensor generation:  0.0007281303405761719
mini_batch_src_global generation:  0.000797271728515625
r_  generation:  0.008518218994140625
local_output_nid generation:  0.0008466243743896484
local_in_edges_tensor generation:  0.0007555484771728516
mini_batch_src_global generation:  0.0007219314575195312
r_  generation:  0.00786900520324707
----------------------check_connections_block total spend ----------------------------- 0.4830901622772217
generate_one_block  0.018734216690063477
generate_one_block  0.015472888946533203
generate_one_block  0.010429143905639648
generate_one_block  0.012140989303588867
generate_one_block  0.014050722122192383
generate_one_block  0.020878076553344727
generate_one_block  0.011805534362792969
generate_one_block  0.014206171035766602
generate_one_block  0.0176393985748291
generate_one_block  0.01792144775390625
generate_one_block  0.022311925888061523
generate_one_block  0.020224332809448242
generate_one_block  0.014141321182250977
generate_one_block  0.013607263565063477
generate_one_block  0.019073963165283203
generate_one_block  0.019551515579223633
generate_one_block  0.018052339553833008
generate_one_block  0.015416383743286133
generate_one_block  0.014776468276977539
generate_one_block  0.012326717376708984
generate_one_block  0.012836217880249023
generate_one_block  0.00988149642944336
generate_one_block  0.013077735900878906
generate_one_block  0.011922121047973633
generate_one_block  0.009355545043945312
generate_one_block  0.008911609649658203
generate_one_block  0.012425899505615234
generate_one_block  0.012745141983032227
generate_one_block  0.010621786117553711
generate_one_block  0.0128326416015625
generate_one_block  0.012629270553588867
generate_one_block  0.01084136962890625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.044956207275390625
gen group dst list time:  0.010974884033203125
time for parepare:  0.026966571807861328
local_output_nid generation:  0.001895904541015625
local_in_edges_tensor generation:  0.014827966690063477
mini_batch_src_global generation:  0.002474546432495117
r_  generation:  0.0264737606048584
local_output_nid generation:  0.003285646438598633
local_in_edges_tensor generation:  0.003484010696411133
mini_batch_src_global generation:  0.0029134750366210938
r_  generation:  0.02926349639892578
local_output_nid generation:  0.0020890235900878906
local_in_edges_tensor generation:  0.0020155906677246094
mini_batch_src_global generation:  0.001558542251586914
r_  generation:  0.017924785614013672
local_output_nid generation:  0.0025217533111572266
local_in_edges_tensor generation:  0.0019044876098632812
mini_batch_src_global generation:  0.0018224716186523438
r_  generation:  0.023809432983398438
local_output_nid generation:  0.0031783580780029297
local_in_edges_tensor generation:  0.0024688243865966797
mini_batch_src_global generation:  0.003070354461669922
r_  generation:  0.03720688819885254
local_output_nid generation:  0.006648063659667969
local_in_edges_tensor generation:  0.00529789924621582
mini_batch_src_global generation:  0.0059032440185546875
r_  generation:  0.0552670955657959
local_output_nid generation:  0.0026082992553710938
local_in_edges_tensor generation:  0.0019617080688476562
mini_batch_src_global generation:  0.002535104751586914
r_  generation:  0.0223848819732666
local_output_nid generation:  0.003271341323852539
local_in_edges_tensor generation:  0.0027039051055908203
mini_batch_src_global generation:  0.0029518604278564453
r_  generation:  0.03780055046081543
local_output_nid generation:  0.004822969436645508
local_in_edges_tensor generation:  0.0048902034759521484
mini_batch_src_global generation:  0.005911111831665039
r_  generation:  0.06036233901977539
local_output_nid generation:  0.005187511444091797
local_in_edges_tensor generation:  0.0049016475677490234
mini_batch_src_global generation:  0.00600886344909668
r_  generation:  0.060096025466918945
local_output_nid generation:  0.0051746368408203125
local_in_edges_tensor generation:  0.0045621395111083984
mini_batch_src_global generation:  0.006581544876098633
r_  generation:  0.06262707710266113
local_output_nid generation:  0.005397796630859375
local_in_edges_tensor generation:  0.005186557769775391
mini_batch_src_global generation:  0.006423234939575195
r_  generation:  0.06471705436706543
local_output_nid generation:  0.004518747329711914
local_in_edges_tensor generation:  0.0039942264556884766
mini_batch_src_global generation:  0.0052297115325927734
r_  generation:  0.048413991928100586
local_output_nid generation:  0.00439143180847168
local_in_edges_tensor generation:  0.003835916519165039
mini_batch_src_global generation:  0.004117727279663086
r_  generation:  0.04587078094482422
local_output_nid generation:  0.005603313446044922
local_in_edges_tensor generation:  0.005815982818603516
mini_batch_src_global generation:  0.006383657455444336
r_  generation:  0.072113037109375
local_output_nid generation:  0.005800008773803711
local_in_edges_tensor generation:  0.004414796829223633
mini_batch_src_global generation:  0.006425380706787109
r_  generation:  0.07191300392150879
local_output_nid generation:  0.0022966861724853516
local_in_edges_tensor generation:  0.0020401477813720703
mini_batch_src_global generation:  0.0027518272399902344
r_  generation:  0.019437313079833984
local_output_nid generation:  0.0024116039276123047
local_in_edges_tensor generation:  0.002050161361694336
mini_batch_src_global generation:  0.001753091812133789
r_  generation:  0.021752357482910156
local_output_nid generation:  0.002172231674194336
local_in_edges_tensor generation:  0.0016562938690185547
mini_batch_src_global generation:  0.0018799304962158203
r_  generation:  0.023760080337524414
local_output_nid generation:  0.0022246837615966797
local_in_edges_tensor generation:  0.0017502307891845703
mini_batch_src_global generation:  0.0019390583038330078
r_  generation:  0.024187326431274414
local_output_nid generation:  0.0018095970153808594
local_in_edges_tensor generation:  0.001470804214477539
mini_batch_src_global generation:  0.0016436576843261719
r_  generation:  0.017851591110229492
local_output_nid generation:  0.0017414093017578125
local_in_edges_tensor generation:  0.0013337135314941406
mini_batch_src_global generation:  0.0014643669128417969
r_  generation:  0.015087366104125977
local_output_nid generation:  0.0016021728515625
local_in_edges_tensor generation:  0.0013730525970458984
mini_batch_src_global generation:  0.0013937950134277344
r_  generation:  0.017467021942138672
local_output_nid generation:  0.001819610595703125
local_in_edges_tensor generation:  0.0015265941619873047
mini_batch_src_global generation:  0.001588582992553711
r_  generation:  0.019940614700317383
local_output_nid generation:  0.0017437934875488281
local_in_edges_tensor generation:  0.001455545425415039
mini_batch_src_global generation:  0.0013146400451660156
r_  generation:  0.013126850128173828
local_output_nid generation:  0.0016367435455322266
local_in_edges_tensor generation:  0.0012462139129638672
mini_batch_src_global generation:  0.0010607242584228516
r_  generation:  0.01190185546875
local_output_nid generation:  0.001955747604370117
local_in_edges_tensor generation:  0.0014033317565917969
mini_batch_src_global generation:  0.001367807388305664
r_  generation:  0.01782369613647461
local_output_nid generation:  0.0022306442260742188
local_in_edges_tensor generation:  0.001725912094116211
mini_batch_src_global generation:  0.0017418861389160156
r_  generation:  0.02218937873840332
local_output_nid generation:  0.001641988754272461
local_in_edges_tensor generation:  0.0013239383697509766
mini_batch_src_global generation:  0.0013914108276367188
r_  generation:  0.015054702758789062
local_output_nid generation:  0.001897573471069336
local_in_edges_tensor generation:  0.0014872550964355469
mini_batch_src_global generation:  0.001421213150024414
r_  generation:  0.019069194793701172
local_output_nid generation:  0.0017714500427246094
local_in_edges_tensor generation:  0.0014395713806152344
mini_batch_src_global generation:  0.0014562606811523438
r_  generation:  0.01752018928527832
local_output_nid generation:  0.0013837814331054688
local_in_edges_tensor generation:  0.0011563301086425781
mini_batch_src_global generation:  0.0011959075927734375
r_  generation:  0.011851310729980469
----------------------check_connections_block total spend ----------------------------- 1.5542974472045898
generate_one_block  0.036919355392456055
generate_one_block  0.051503658294677734
generate_one_block  0.02525615692138672
generate_one_block  0.0325930118560791
generate_one_block  0.0490572452545166
generate_one_block  0.07744240760803223
generate_one_block  0.030063390731811523
generate_one_block  0.05151844024658203
generate_one_block  0.08071613311767578
generate_one_block  0.08186984062194824
generate_one_block  0.0841832160949707
generate_one_block  0.08820796012878418
generate_one_block  0.06548166275024414
generate_one_block  0.06165909767150879
generate_one_block  0.08817243576049805
generate_one_block  0.0882875919342041
generate_one_block  0.024631738662719727
generate_one_block  0.02834486961364746
generate_one_block  0.029245376586914062
generate_one_block  0.03093695640563965
generate_one_block  0.02333521842956543
generate_one_block  0.019054412841796875
generate_one_block  0.02198052406311035
generate_one_block  0.026091337203979492
generate_one_block  0.04091191291809082
generate_one_block  0.03602337837219238
generate_one_block  0.04224133491516113
generate_one_block  0.043587684631347656
generate_one_block  0.023498058319091797
generate_one_block  0.025493621826171875
generate_one_block  0.024122953414916992
generate_one_block  0.016278743743896484
global_2_local spend time (sec) 0.0037016868591308594
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0008587837219238281
A = g.adjacency_matrix() spent  0.0005638599395751953
auxiliary_graph
Graph(num_nodes=18286, num_edges=307772,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.012682914733886719
remove nodes length[23:39:28] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 2774 nodes and 304998 edges into 2 parts and get 44381 edge cuts
[23:39:29] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 2843 nodes and 1533426 edges into 2 parts and get 322125 edge cuts

15512
auxiliary_graph.remove_nodes spent  0.011384010314941406
after remove non output nodes the auxiliary_graph
Graph(num_nodes=2774, num_edges=307772,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.013627767562866211

the counter of shared neighbor distribution
Counter({1.0: 248202, 2.0: 42300, 3.0: 10052, 4.0: 2754, 5.0: 988, 6.0: 382, 7.0: 176, 8.0: 90, 9.0: 30, 10.0: 12, 11.0: 6, 12.0: 2, 15.0: 2, 13.0: 2})
304998
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------
Convert a graph into a bidirected graph: 0.009 seconds
Metis partitioning: 0.029 seconds
Split the graph: 0.063 seconds
Construct subgraphs: 0.045 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.14586210250854492
1380
1394
total k batches seeds list generation spend  0.26572251319885254
after graph partition
graph partition algorithm spend time 0.27353453636169434
1380
1394
time for parepare:  0.0374140739440918
local_output_nid generation:  0.0003762245178222656
local_in_edges_tensor generation:  0.0023193359375
mini_batch_src_global generation:  0.0009396076202392578
r_  generation:  0.007172346115112305
local_output_nid generation:  0.0003528594970703125
local_in_edges_tensor generation:  0.0013766288757324219
mini_batch_src_global generation:  0.0016300678253173828
r_  generation:  0.012415409088134766
----------------------check_connections_block total spend ----------------------------- 0.07435750961303711
generate_one_block  0.01273202896118164
generate_one_block  0.017251968383789062
time for parepare:  0.025284290313720703
local_output_nid generation:  0.001483917236328125
local_in_edges_tensor generation:  0.00676417350769043
mini_batch_src_global generation:  0.0028579235076904297
r_  generation:  0.02895665168762207
local_output_nid generation:  0.0027801990509033203
local_in_edges_tensor generation:  0.003315448760986328
mini_batch_src_global generation:  0.004691600799560547
r_  generation:  0.044698238372802734
----------------------check_connections_block total spend ----------------------------- 0.14139962196350098
generate_one_block  0.044155120849609375
generate_one_block  0.058910369873046875
global_2_local spend time (sec) 0.003942012786865234
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0007021427154541016
A = g.adjacency_matrix() spent  0.00048041343688964844
auxiliary_graph
Graph(num_nodes=18074, num_edges=1536269,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.012211799621582031
remove nodes length
15231
auxiliary_graph.remove_nodes spent  0.04585099220275879
after remove non output nodes the auxiliary_graph
Graph(num_nodes=2843, num_edges=1536269,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.04832720756530762

the counter of shared neighbor distribution
Counter({1.0: 1365596, 2.0: 138974, 3.0: 21888, 4.0: 4658, 5.0: 1284, 6.0: 538, 7.0: 212, 8.0: 128, 9.0: 64, 10.0: 38, 11.0: 20, 12.0: 18, 13.0: 4, 15.0: 2, 14.0: 2})
1533426
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------
Convert a graph into a bidirected graph: 0.056 seconds
Metis partitioning: 0.083 seconds
Split the graph: 0.154 seconds
Construct subgraphs: 0.013 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.30841851234436035
1403
1440
total k batches seeds list generation spend  0.7244648933410645
after graph partition
graph partition algorithm spend time 0.7310774326324463
1403
1440
time for parepare:  0.0343477725982666
local_output_nid generation:  0.00034165382385253906
local_in_edges_tensor generation:  0.0009195804595947266
mini_batch_src_global generation:  0.0008878707885742188
r_  generation:  0.007004499435424805
local_output_nid generation:  0.000316619873046875
local_in_edges_tensor generation:  0.0008003711700439453
mini_batch_src_global generation:  0.0014433860778808594
r_  generation:  0.010166645050048828
----------------------check_connections_block total spend ----------------------------- 0.06533932685852051
generate_one_block  0.012166023254394531
generate_one_block  0.01563096046447754
time for parepare:  0.0200655460357666
local_output_nid generation:  0.0013880729675292969
local_in_edges_tensor generation:  0.002460956573486328
mini_batch_src_global generation:  0.0027837753295898438
r_  generation:  0.027825117111206055
local_output_nid generation:  0.002608060836791992
local_in_edges_tensor generation:  0.0031647682189941406
mini_batch_src_global generation:  0.00456547737121582
r_  generation:  0.04435276985168457
----------------------check_connections_block total spend ----------------------------- 0.1298999786376953
generate_one_block  0.04411959648132324
generate_one_block  0.06178855895996094
----------===============-------------===============-------------the number of batches *****---- 34

original number of batches:  32
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02686929702758789  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

connection checking time:  1.5542974472045898
block generation total time  1.4487097263336182
average batch blocks generation time:  0.04527217894792557
block dataloader generation time/epoch 28.62917971611023
pseudo mini batch 0 input nodes size: 26282
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.025003433227539062  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.025003433227539062  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.037535667419433594  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03755664825439453  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02387380599975586  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.024437427520751953  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.024437427520751953  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 26282
first layer output nodes number: 8856
edges number: 59006
input nodes number: 8856
output nodes number: 2760
edges number: 16634
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.747133731842041  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.7471346855163574  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.025746822357177734  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 1 input nodes size: 24607
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.024068832397460938  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.024068832397460938  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.035802364349365234  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03582429885864258  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02327108383178711  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02394723892211914  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02394723892211914  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 24607
first layer output nodes number: 9265
edges number: 65999
input nodes number: 9265
output nodes number: 2927
edges number: 24648
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.9295244216918945  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.9295248985290527  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.025256633758544922  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 2 input nodes size: 17467
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.023295879364013672  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.023295879364013672  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.031624794006347656  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.0316462516784668  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.019890785217285156  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.020308494567871094  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.020308494567871094  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 17467
first layer output nodes number: 6830
edges number: 39280
input nodes number: 6830
output nodes number: 2871
edges number: 16694
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.5899372100830078  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.589937686920166  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02115917205810547  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 3 input nodes size: 22323
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.019882678985595703  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.019882678985595703  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.030527114868164062  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.030549049377441406  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02219867706298828  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.022757530212402344  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.022757530212402344  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 22323
first layer output nodes number: 8639
edges number: 55127
input nodes number: 8639
output nodes number: 2905
edges number: 19780
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.7625460624694824  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.7625465393066406  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02386188507080078  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 4 input nodes size: 31956
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.022203445434570312  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.022203445434570312  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.037441253662109375  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.037462711334228516  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.026796340942382812  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.027578353881835938  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.027578353881835938  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 31956
first layer output nodes number: 11374
edges number: 82997
input nodes number: 11374
output nodes number: 2827
edges number: 21761
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 1.0149717330932617  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 1.01497220993042  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.0290374755859375  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 5 input nodes size: 39184
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.026784896850585938  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.026784896850585938  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.04631614685058594  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.046337127685546875  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.031077861785888672  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03232526779174805  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03232526779174805  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 39184
first layer output nodes number: 15658
edges number: 133305
input nodes number: 15658
output nodes number: 2758
edges number: 34018
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 1.5769901275634766  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 1.5769906044006348  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03449058532714844  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 6 input nodes size: 20193
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.031067371368408203  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.031067371368408203  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.040696144104003906  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.04071760177612305  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02116537094116211  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.021669864654541016  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.021669864654541016  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 20193
first layer output nodes number: 7960
edges number: 49734
input nodes number: 7960
output nodes number: 2874
edges number: 17800
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.6957135200500488  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.695713996887207  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.022687911987304688  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 7 input nodes size: 30581
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.021183013916015625  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.021183013916015625  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03576517105102539  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03578615188598633  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.026135921478271484  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02698373794555664  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02698373794555664  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 30581
first layer output nodes number: 11569
edges number: 90126
input nodes number: 11569
output nodes number: 2758
edges number: 23452
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 1.0916461944580078  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 1.091646671295166  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02850818634033203  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 8 input nodes size: 45965
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02611827850341797  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02611827850341797  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.04803609848022461  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.04805707931518555  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.033453941345214844  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03468894958496094  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03468894958496094  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 45965
first layer output nodes number: 16619
edges number: 137831
input nodes number: 16619
output nodes number: 2760
edges number: 27882
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 1.5297284126281738  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 1.529728889465332  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03687858581542969  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 9 input nodes size: 43247
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03345441818237305  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03345441818237305  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.05493879318237305  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.054959774017333984  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.033020973205566406  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03428936004638672  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03428936004638672  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 43247
first layer output nodes number: 16625
edges number: 141276
input nodes number: 16625
output nodes number: 2758
edges number: 28821
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 1.5814948081970215  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 1.5814952850341797  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.0364985466003418  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 10 input nodes size: 39359
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.0330204963684082  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.0330204963684082  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.0525517463684082  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.052573204040527344  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.031067848205566406  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.032462120056152344  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.032462120056152344  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 39359
first layer output nodes number: 17002
edges number: 149180
input nodes number: 17002
output nodes number: 2879
edges number: 37809
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 1.7458858489990234  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 1.7458863258361816  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03486299514770508  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 11 input nodes size: 44380
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.031085968017578125  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.031085968017578125  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.052570343017578125  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.05259132385253906  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03303861618041992  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03442716598510742  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03442716598510742  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 44380
first layer output nodes number: 17754
edges number: 153890
input nodes number: 17754
output nodes number: 2758
edges number: 32274
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 1.710057258605957  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 1.7100577354431152  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.036798954010009766  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 12 input nodes size: 44520
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.0330204963684082  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.0330204963684082  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.0545048713684082  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.05452585220336914  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.0330204963684082  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03402280807495117  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03402280807495117  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 44520
first layer output nodes number: 14250
edges number: 112079
input nodes number: 14250
output nodes number: 2762
edges number: 22381
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 1.2623167037963867  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 1.262317180633545  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.035875797271728516  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 13 input nodes size: 44163
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03302145004272461  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03302145004272461  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.05450582504272461  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.05452680587768555  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03302145004272461  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.033963680267333984  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.033963680267333984  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 44163
first layer output nodes number: 13649
edges number: 104938
input nodes number: 13649
output nodes number: 2794
edges number: 21383
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 1.192894458770752  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 1.1928949356079102  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03573799133300781  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 14 input nodes size: 14413
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03302621841430664  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03302621841430664  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03989887237548828  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03992033004760742  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.018414974212646484  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.018920421600341797  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.018920421600341797  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 14413
first layer output nodes number: 6449
edges number: 42561
input nodes number: 6449
output nodes number: 2846
edges number: 25164
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.7336974143981934  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.7336978912353516  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.01990652084350586  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 15 input nodes size: 14695
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.018422603607177734  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.018422603607177734  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.025429725646972656  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02545166015625  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.01855754852294922  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.019147872924804688  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.019147872924804688  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 14695
first layer output nodes number: 7321
edges number: 51614
input nodes number: 7321
output nodes number: 2923
edges number: 27461
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.8401460647583008  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.840146541595459  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02026224136352539  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 16 input nodes size: 15102
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.018568992614746094  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.018568992614746094  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.025770187377929688  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02579212188720703  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.018763065338134766  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.019356250762939453  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.019356250762939453  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 15102
first layer output nodes number: 7442
edges number: 53544
input nodes number: 7442
output nodes number: 2916
edges number: 25959
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.8345880508422852  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.8345885276794434  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.020455360412597656  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 17 input nodes size: 18099
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.01876211166381836  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.01876211166381836  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02739238739013672  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.027413368225097656  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02019023895263672  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.020769119262695312  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.020769119262695312  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 18099
first layer output nodes number: 8294
edges number: 56741
input nodes number: 8294
output nodes number: 2758
edges number: 20761
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.7883806228637695  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.7883810997009277  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.021831989288330078  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 18 input nodes size: 14749
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.020166397094726562  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.020166397094726562  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.027199268341064453  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.027220726013183594  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.018569469451904297  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.01904916763305664  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.01904916763305664  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 14749
first layer output nodes number: 6101
edges number: 41084
input nodes number: 6101
output nodes number: 2823
edges number: 23195
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.6985549926757812  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.6985554695129395  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.019992351531982422  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 19 input nodes size: 13338
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.018579483032226562  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.018579483032226562  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.025218486785888672  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.025239944458007812  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.01818561553955078  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.018545150756835938  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.018545150756835938  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 13338
first layer output nodes number: 5877
edges number: 31786
input nodes number: 5877
output nodes number: 2868
edges number: 16262
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.5250067710876465  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.5250072479248047  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.019297122955322266  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 20 input nodes size: 13138
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.018192291259765625  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.018192291259765625  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.025225162506103516  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.025246143341064453  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.018585681915283203  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.01907205581665039  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.01907205581665039  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 13138
first layer output nodes number: 5890
edges number: 41012
input nodes number: 5890
output nodes number: 2814
edges number: 24166
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.707615852355957  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.7076163291931152  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.01999378204345703  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 21 input nodes size: 17245
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.01857757568359375  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.01857757568359375  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02680063247680664  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.026821613311767578  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.01976776123046875  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.020264625549316406  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.020264625549316406  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 17245
first layer output nodes number: 6825
edges number: 45738
input nodes number: 6825
output nodes number: 2816
edges number: 20813
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.6972012519836426  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.6972017288208008  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02123117446899414  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 22 input nodes size: 11362
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.01976776123046875  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.01976776123046875  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02521657943725586  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.025238513946533203  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.016994476318359375  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.017324447631835938  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.017324447631835938  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 11362
first layer output nodes number: 5693
edges number: 28955
input nodes number: 5693
output nodes number: 2927
edges number: 15179
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.4891510009765625  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.4891514778137207  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.018030166625976562  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 23 input nodes size: 10757
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.017011165618896484  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.017011165618896484  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.0221405029296875  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.022162437438964844  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.01669168472290039  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.016998767852783203  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.016998767852783203  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 10757
first layer output nodes number: 5475
edges number: 26523
input nodes number: 5475
output nodes number: 2896
edges number: 14508
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.4596686363220215  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.4596691131591797  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.017646312713623047  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 24 input nodes size: 14988
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.01668691635131836  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.01668691635131836  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.023833751678466797  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02385568618774414  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.01870441436767578  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.01917552947998047  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.01917552947998047  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 14988
first layer output nodes number: 6578
edges number: 41138
input nodes number: 6578
output nodes number: 2894
edges number: 21950
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.6809191703796387  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.6809196472167969  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02010345458984375  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 25 input nodes size: 19944
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.01870441436767578  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.01870441436767578  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.028214454650878906  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02823638916015625  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02106761932373047  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.021610260009765625  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.021610260009765625  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 19944
first layer output nodes number: 8105
edges number: 51208
input nodes number: 8105
output nodes number: 2926
edges number: 21411
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.7511615753173828  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.751162052154541  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.022681713104248047  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 26 input nodes size: 11742
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.0210723876953125  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.0210723876953125  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.026671409606933594  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.026693344116210938  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.01716136932373047  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.01754474639892578  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.01754474639892578  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 11742
first layer output nodes number: 5795
edges number: 32813
input nodes number: 5795
output nodes number: 2891
edges number: 18447
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.5620608329772949  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.5620613098144531  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.018312454223632812  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 27 input nodes size: 15173
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.017156124114990234  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.017156124114990234  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02522897720336914  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.025250911712646484  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.019629955291748047  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.020125865936279297  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.020125865936279297  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 15173
first layer output nodes number: 6879
edges number: 43957
input nodes number: 6879
output nodes number: 2903
edges number: 22474
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.7155213356018066  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.7155218124389648  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02109241485595703  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 28 input nodes size: 15574
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.01963186264038086  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.01963186264038086  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.027058124542236328  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02707958221435547  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.01898479461669922  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.01944732666015625  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.01944732666015625  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 15574
first layer output nodes number: 6215
edges number: 40823
input nodes number: 6215
output nodes number: 2842
edges number: 21232
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.6667704582214355  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.6667709350585938  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.020348072052001953  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 29 input nodes size: 9261
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.01897573471069336  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.01897573471069336  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.0233917236328125  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.023413658142089844  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.015965938568115234  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.016315937042236328  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.016315937042236328  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 9261
first layer output nodes number: 4993
edges number: 27493
input nodes number: 4993
output nodes number: 2890
edges number: 19340
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.5295777320861816  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.5295782089233398  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.01703357696533203  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 30 input nodes size: 32101
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.01597309112548828  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.01597309112548828  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.0312800407409668  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.031290531158447266  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02685260772705078  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.027451515197753906  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.027451515197753906  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 32101
first layer output nodes number: 8520
edges number: 69216
input nodes number: 8520
output nodes number: 1380
edges number: 11079
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.7403664588928223  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.7403669357299805  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.028355121612548828  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 31 input nodes size: 35330
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.026627540588378906  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.026627540588378906  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.04347419738769531  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.04348468780517578  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.028167247772216797  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.029100894927978516  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.029100894927978516  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 35330
first layer output nodes number: 11737
edges number: 106175
input nodes number: 11737
output nodes number: 1394
edges number: 19001
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 1.1326560974121094  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 1.1326565742492676  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.030721187591552734  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 32 input nodes size: 29737
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02816915512084961  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02816915512084961  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.04234886169433594  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.042359352111816406  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02550220489501953  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.026083946228027344  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.026083946228027344  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 29737
first layer output nodes number: 8148
edges number: 66132
input nodes number: 8148
output nodes number: 1403
edges number: 11804
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.7215499877929688  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.721550464630127  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.027176380157470703  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 33 input nodes size: 37723
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02550363540649414  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02550363540649414  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.043491363525390625  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.0435023307800293  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.0293121337890625  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.030260086059570312  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.030260086059570312  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 37723
first layer output nodes number: 12025
edges number: 108296
input nodes number: 12025
output nodes number: 1440
edges number: 18707
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 1.147810459136963  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 1.147810935974121  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes
[23:40:00] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 29010640 edges into 32 parts and get 8897067 edge cuts

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.031920433044433594  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.031920433044433594  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.031920433044433594  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009353406289044549 |0.002281953306759105 |0.1181656893561868 |0.00013314976411707262 |0.12982468745287726 |0.00746917724609375 |
----------------------------------------------------------pseudo_mini_loss sum 5.233644008636475
Total (block generation + training)time/epoch 37.67578983306885
Training time/epoch 9.04628300666809
Training time without block to device /epoch 8.968696594238281
Training time without total dataloading part /epoch 8.443669080734253
load block tensor time/epoch 0.31801581382751465
block to device time/epoch 0.07758641242980957
input features size transfer per epoch 4.559755325317383e-06
blocks size to device per epoch 3.039836883544922e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1159110
Number of first layer input nodes during this epoch:  838698
Number of first layer output nodes during this epoch:  320412
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03191995620727539  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02295994758605957
global_2_local spend time (sec) 0.057192087173461914
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004617452621459961
A = g.adjacency_matrix() spent  0.010313987731933594
auxiliary_graph
Graph(num_nodes=154715, num_edges=29101581,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.1051931381225586
remove nodes length
63774
auxiliary_graph.remove_nodes spent  1.4270288944244385
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29101581,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.2358739376068115

the counter of shared neighbor distribution
Counter({1.0: 23486600, 2.0: 4015792, 3.0: 1001110, 4.0: 300986, 5.0: 109994, 6.0: 47458, 7.0: 22542, 8.0: 11416, 9.0: 6208, 10.0: 3562, 11.0: 1972, 12.0: 1148, 13.0: 654, 14.0: 388, 15.0: 284, 16.0: 206, 17.0: 180, 18.0: 72, 19.0: 50, 20.0: 10, 21.0: 8})
29010640
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 29010637, 29010638, 29010639])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23486600, 2.0: 4015792, 3.0: 1001110, 4.0: 300986, 5.0: 109994, 6.0: 47458, 7.0: 22542, 8.0: 11416, 9.0: 6208, 10.0: 3562, 11.0: 1972, 12.0: 1148, 13.0: 654, 14.0: 388, 15.0: 284, 16.0: 206, 17.0: 180, 18.0: 72, 19.0: 50, 20.0: 10, 21.0: 8})
Convert a graph into a bidirected graph: 2.194 seconds
Metis partitioning: 6.836 seconds
Split the graph: 1.120 seconds
Construct subgraphs: 0.115 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  10.280097961425781
2849
2870
2789
2813
2759
2785
2758
2881
2758
2809
2774
2925
2758
2758
2905
2758
2875
2891
2879
2891
2905
2893
2821
2873
2909
2886
2870
2875
2927
2770
2926
2801
total k batches seeds list generation spend  22.373711109161377
after graph partition
graph partition algorithm spend time 22.480103969573975
2849
2870
2789
2813
2759
2785
2758
2881
2758
2809
2774
2925
2758
2758
2905
2758
2875
2891
2879
2891
2905
2893
2821
2873
2909
2886
2870
2875
2927
2770
2926
2801
partition_len_list
[9065, 6798, 8375, 8883, 9781, 11438, 11075, 7670, 15123, 15126, 16700, 19738, 19088, 16424, 18187, 16284, 6775, 5448, 6062, 7641, 6727, 5225, 5371, 5622, 6449, 6222, 6916, 5987, 7921, 7440, 7722, 6928]
shared_neighbor_graph_partition_s0 selection method  spend 22.598920106887817
time for parepare:  0.02016425132751465
local_output_nid generation:  0.0005927085876464844
local_in_edges_tensor generation:  0.0009996891021728516
mini_batch_src_global generation:  0.0011420249938964844
r_  generation:  0.008786439895629883
local_output_nid generation:  0.0007314682006835938
local_in_edges_tensor generation:  0.000949859619140625
mini_batch_src_global generation:  0.0012021064758300781
r_  generation:  0.009396791458129883
local_output_nid generation:  0.0007631778717041016
local_in_edges_tensor generation:  0.0007534027099609375
mini_batch_src_global generation:  0.0008018016815185547
r_  generation:  0.007741689682006836
local_output_nid generation:  0.0008320808410644531
local_in_edges_tensor generation:  0.0007259845733642578
mini_batch_src_global generation:  0.0008623600006103516
r_  generation:  0.0086669921875
local_output_nid generation:  0.0009191036224365234
local_in_edges_tensor generation:  0.0008254051208496094
mini_batch_src_global generation:  0.0007851123809814453
r_  generation:  0.006951093673706055
local_output_nid generation:  0.0009009838104248047
local_in_edges_tensor generation:  0.0008063316345214844
mini_batch_src_global generation:  0.0009016990661621094
r_  generation:  0.009307146072387695
local_output_nid generation:  0.0008776187896728516
local_in_edges_tensor generation:  0.0007648468017578125
mini_batch_src_global generation:  0.000782012939453125
r_  generation:  0.007127046585083008
local_output_nid generation:  0.0009379386901855469
local_in_edges_tensor generation:  0.0007812976837158203
mini_batch_src_global generation:  0.0007092952728271484
r_  generation:  0.007718563079833984
local_output_nid generation:  0.0008456707000732422
local_in_edges_tensor generation:  0.0008270740509033203
mini_batch_src_global generation:  0.0011913776397705078
r_  generation:  0.012485742568969727
local_output_nid generation:  0.0008776187896728516
local_in_edges_tensor generation:  0.0008120536804199219
mini_batch_src_global generation:  0.0011572837829589844
r_  generation:  0.010056018829345703
local_output_nid generation:  0.0008530616760253906
local_in_edges_tensor generation:  0.0009143352508544922
mini_batch_src_global generation:  0.00106048583984375
r_  generation:  0.013949871063232422
local_output_nid generation:  0.0016982555389404297
local_in_edges_tensor generation:  0.0011887550354003906
mini_batch_src_global generation:  0.0013859272003173828
r_  generation:  0.01463627815246582
local_output_nid generation:  0.0008647441864013672
local_in_edges_tensor generation:  0.0007982254028320312
mini_batch_src_global generation:  0.0013659000396728516
r_  generation:  0.012406110763549805
local_output_nid generation:  0.0008504390716552734
local_in_edges_tensor generation:  0.0007719993591308594
mini_batch_src_global generation:  0.0010783672332763672
r_  generation:  0.010723352432250977
local_output_nid generation:  0.0008716583251953125
local_in_edges_tensor generation:  0.0008466243743896484
mini_batch_src_global generation:  0.0013310909271240234
r_  generation:  0.01563549041748047
local_output_nid generation:  0.0008087158203125
local_in_edges_tensor generation:  0.0008516311645507812
mini_batch_src_global generation:  0.0012714862823486328
r_  generation:  0.011724233627319336
local_output_nid generation:  0.0008351802825927734
local_in_edges_tensor generation:  0.0007648468017578125
mini_batch_src_global generation:  0.0009124279022216797
r_  generation:  0.008969306945800781
local_output_nid generation:  0.0008721351623535156
local_in_edges_tensor generation:  0.0007393360137939453
mini_batch_src_global generation:  0.0007908344268798828
r_  generation:  0.008226394653320312
local_output_nid generation:  0.0008351802825927734
local_in_edges_tensor generation:  0.0006792545318603516
mini_batch_src_global generation:  0.00072479248046875
r_  generation:  0.007686614990234375
local_output_nid generation:  0.0008032321929931641
local_in_edges_tensor generation:  0.0007102489471435547
mini_batch_src_global generation:  0.0008246898651123047
r_  generation:  0.008878231048583984
local_output_nid generation:  0.0007863044738769531
local_in_edges_tensor generation:  0.000713348388671875
mini_batch_src_global generation:  0.0007755756378173828
r_  generation:  0.008003950119018555
local_output_nid generation:  0.0007767677307128906
local_in_edges_tensor generation:  0.0007834434509277344
mini_batch_src_global generation:  0.0005996227264404297
r_  generation:  0.006068706512451172
local_output_nid generation:  0.0007281303405761719
local_in_edges_tensor generation:  0.0008106231689453125
mini_batch_src_global generation:  0.0006563663482666016
r_  generation:  0.006147146224975586
local_output_nid generation:  0.0007176399230957031
local_in_edges_tensor generation:  0.0007073879241943359
mini_batch_src_global generation:  0.0006196498870849609
r_  generation:  0.0069539546966552734
local_output_nid generation:  0.0007073879241943359
local_in_edges_tensor generation:  0.0007326602935791016
mini_batch_src_global generation:  0.0007576942443847656
r_  generation:  0.008610010147094727
local_output_nid generation:  0.0006997585296630859
local_in_edges_tensor generation:  0.0008821487426757812
mini_batch_src_global generation:  0.0008504390716552734
r_  generation:  0.009365558624267578
local_output_nid generation:  0.0008223056793212891
local_in_edges_tensor generation:  0.0007355213165283203
mini_batch_src_global generation:  0.0008068084716796875
r_  generation:  0.008454561233520508
local_output_nid generation:  0.0007381439208984375
local_in_edges_tensor generation:  0.0009076595306396484
mini_batch_src_global generation:  0.0009191036224365234
r_  generation:  0.009752511978149414
local_output_nid generation:  0.0007317066192626953
local_in_edges_tensor generation:  0.0008788108825683594
mini_batch_src_global generation:  0.0012502670288085938
r_  generation:  0.010304450988769531
local_output_nid generation:  0.0006816387176513672
local_in_edges_tensor generation:  0.0006935596466064453
mini_batch_src_global generation:  0.0007684230804443359
r_  generation:  0.007729053497314453
local_output_nid generation:  0.0007159709930419922
local_in_edges_tensor generation:  0.0007083415985107422
mini_batch_src_global generation:  0.0009098052978515625
r_  generation:  0.01029825210571289
local_output_nid generation:  0.0006773471832275391
local_in_edges_tensor generation:  0.0007083415985107422
mini_batch_src_global generation:  0.0007963180541992188
r_  generation:  0.00858306884765625
----------------------check_connections_block total spend ----------------------------- 0.48804450035095215
generate_one_block  0.023760318756103516
generate_one_block  0.014279603958129883
generate_one_block  0.012647867202758789
generate_one_block  0.012290239334106445
generate_one_block  0.011313915252685547
generate_one_block  0.014698028564453125
generate_one_block  0.01169896125793457
generate_one_block  0.011314153671264648
generate_one_block  0.02057790756225586
generate_one_block  0.015515565872192383
generate_one_block  0.017983436584472656
generate_one_block  0.02258133888244629
generate_one_block  0.020503759384155273
generate_one_block  0.019751548767089844
generate_one_block  0.023470640182495117
generate_one_block  0.019171714782714844
generate_one_block  0.017923831939697266
generate_one_block  0.01166844367980957
generate_one_block  0.010762929916381836
generate_one_block  0.013209819793701172
generate_one_block  0.011428117752075195
generate_one_block  0.008944272994995117
generate_one_block  0.008824348449707031
generate_one_block  0.009991884231567383
generate_one_block  0.012223243713378906
generate_one_block  0.013640403747558594
generate_one_block  0.012181997299194336
generate_one_block  0.013757705688476562
generate_one_block  0.015610694885253906
generate_one_block  0.011507034301757812
generate_one_block  0.015064477920532227
generate_one_block  0.011804580688476562
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.038036346435546875
gen group dst list time:  0.010284662246704102
time for parepare:  0.024286508560180664
local_output_nid generation:  0.002050161361694336
local_in_edges_tensor generation:  0.011748790740966797
mini_batch_src_global generation:  0.002651691436767578
r_  generation:  0.02819061279296875
local_output_nid generation:  0.002391815185546875
local_in_edges_tensor generation:  0.002036571502685547
mini_batch_src_global generation:  0.0023245811462402344
r_  generation:  0.020133495330810547
local_output_nid generation:  0.002652406692504883
local_in_edges_tensor generation:  0.001943349838256836
mini_batch_src_global generation:  0.0019116401672363281
r_  generation:  0.02469921112060547
local_output_nid generation:  0.0026040077209472656
local_in_edges_tensor generation:  0.002117156982421875
mini_batch_src_global generation:  0.0025207996368408203
r_  generation:  0.027731895446777344
local_output_nid generation:  0.002519369125366211
local_in_edges_tensor generation:  0.002465963363647461
mini_batch_src_global generation:  0.0035479068756103516
r_  generation:  0.030086994171142578
local_output_nid generation:  0.0027666091918945312
local_in_edges_tensor generation:  0.003150463104248047
mini_batch_src_global generation:  0.007906675338745117
r_  generation:  0.038732051849365234
local_output_nid generation:  0.0031785964965820312
local_in_edges_tensor generation:  0.0027968883514404297
mini_batch_src_global generation:  0.003875732421875
r_  generation:  0.03558969497680664
local_output_nid generation:  0.002140522003173828
local_in_edges_tensor generation:  0.00209808349609375
mini_batch_src_global generation:  0.0028274059295654297
r_  generation:  0.02142786979675293
local_output_nid generation:  0.0038604736328125
local_in_edges_tensor generation:  0.004580497741699219
mini_batch_src_global generation:  0.00539398193359375
r_  generation:  0.05368447303771973
local_output_nid generation:  0.0040471553802490234
local_in_edges_tensor generation:  0.005189657211303711
mini_batch_src_global generation:  0.020334482192993164
r_  generation:  0.056153297424316406
local_output_nid generation:  0.005265951156616211
local_in_edges_tensor generation:  0.008510828018188477
mini_batch_src_global generation:  0.008568048477172852
r_  generation:  0.06529951095581055
local_output_nid generation:  0.006206512451171875
local_in_edges_tensor generation:  0.007090091705322266
mini_batch_src_global generation:  0.007719993591308594
r_  generation:  0.0788872241973877
local_output_nid generation:  0.00491786003112793
local_in_edges_tensor generation:  0.006036043167114258
mini_batch_src_global generation:  0.009383916854858398
r_  generation:  0.07236504554748535
local_output_nid generation:  0.004536628723144531
local_in_edges_tensor generation:  0.0050928592681884766
mini_batch_src_global generation:  0.006243705749511719
r_  generation:  0.05846810340881348
local_output_nid generation:  0.004984855651855469
local_in_edges_tensor generation:  0.004964113235473633
mini_batch_src_global generation:  0.006729602813720703
r_  generation:  0.06753706932067871
local_output_nid generation:  0.005256175994873047
local_in_edges_tensor generation:  0.007868051528930664
mini_batch_src_global generation:  0.0061664581298828125
r_  generation:  0.059870004653930664
local_output_nid generation:  0.0019986629486083984
local_in_edges_tensor generation:  0.0018079280853271484
mini_batch_src_global generation:  0.0026640892028808594
r_  generation:  0.020111560821533203
local_output_nid generation:  0.0014660358428955078
local_in_edges_tensor generation:  0.0014190673828125
mini_batch_src_global generation:  0.001573801040649414
r_  generation:  0.013841867446899414
local_output_nid generation:  0.0015265941619873047
local_in_edges_tensor generation: [23:40:07] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 2925 nodes and 1849142 edges into 2 parts and get 315923 edge cuts
[23:40:07] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 2758 nodes and 604016 edges into 2 parts and get 100678 edge cuts
 0.001397848129272461
mini_batch_src_global generation:  0.001283407211303711
r_  generation:  0.015735387802124023
local_output_nid generation:  0.0018551349639892578
local_in_edges_tensor generation:  0.001783609390258789
mini_batch_src_global generation:  0.0016129016876220703
r_  generation:  0.021113872528076172
local_output_nid generation:  0.001596689224243164
local_in_edges_tensor generation:  0.0016758441925048828
mini_batch_src_global generation:  0.0014913082122802734
r_  generation:  0.017789602279663086
local_output_nid generation:  0.001184225082397461
local_in_edges_tensor generation:  0.0012137889862060547
mini_batch_src_global generation:  0.0010764598846435547
r_  generation:  0.010802745819091797
local_output_nid generation:  0.0012230873107910156
local_in_edges_tensor generation:  0.0012440681457519531
mini_batch_src_global generation:  0.00110626220703125
r_  generation:  0.012398481369018555
local_output_nid generation:  0.0012137889862060547
local_in_edges_tensor generation:  0.0012590885162353516
mini_batch_src_global generation:  0.0011281967163085938
r_  generation:  0.014462709426879883
local_output_nid generation:  0.0015215873718261719
local_in_edges_tensor generation:  0.0014734268188476562
mini_batch_src_global generation:  0.0013918876647949219
r_  generation:  0.017997264862060547
local_output_nid generation:  0.001402139663696289
local_in_edges_tensor generation:  0.0015735626220703125
mini_batch_src_global generation:  0.0014102458953857422
r_  generation:  0.016951560974121094
local_output_nid generation:  0.0015232563018798828
local_in_edges_tensor generation:  0.0015654563903808594
mini_batch_src_global generation:  0.001491546630859375
r_  generation:  0.01972508430480957
local_output_nid generation:  0.0012235641479492188
local_in_edges_tensor generation:  0.0013568401336669922
mini_batch_src_global generation:  0.0015132427215576172
r_  generation:  0.017763853073120117
local_output_nid generation:  0.001661062240600586
local_in_edges_tensor generation:  0.0017490386962890625
mini_batch_src_global generation:  0.0017673969268798828
r_  generation:  0.023693084716796875
local_output_nid generation:  0.001468658447265625
local_in_edges_tensor generation:  0.0016162395477294922
mini_batch_src_global generation:  0.0017516613006591797
r_  generation:  0.021090269088745117
local_output_nid generation:  0.0014941692352294922
local_in_edges_tensor generation:  0.0016715526580810547
mini_batch_src_global generation:  0.0017824172973632812
r_  generation:  0.023869991302490234
local_output_nid generation:  0.0015168190002441406
local_in_edges_tensor generation:  0.0015988349914550781
mini_batch_src_global generation:  0.0016314983367919922
r_  generation:  0.01906871795654297
----------------------check_connections_block total spend ----------------------------- 1.5715067386627197
generate_one_block  0.0473477840423584
generate_one_block  0.03609514236450195
generate_one_block  0.033359527587890625
generate_one_block  0.03564929962158203
generate_one_block  0.04124951362609863
generate_one_block  0.050363779067993164
generate_one_block  0.04739570617675781
generate_one_block  0.026649951934814453
generate_one_block  0.07522439956665039
generate_one_block  0.07239699363708496
generate_one_block  0.08156275749206543
generate_one_block  0.09743428230285645
generate_one_block  0.09203362464904785
generate_one_block  0.07737445831298828
generate_one_block  0.08806133270263672
generate_one_block  0.07781481742858887
generate_one_block  0.02527642250061035
generate_one_block  0.0184481143951416
generate_one_block  0.01958441734313965
generate_one_block  0.028146743774414062
generate_one_block  0.023456811904907227
generate_one_block  0.014329910278320312
generate_one_block  0.01631474494934082
generate_one_block  0.01706528663635254
generate_one_block  0.02336859703063965
generate_one_block  0.021831750869750977
generate_one_block  0.02763676643371582
generate_one_block  0.02317214012145996
generate_one_block  0.031053781509399414
generate_one_block  0.027749061584472656
generate_one_block  0.029370546340942383
generate_one_block  0.025064706802368164
global_2_local spend time (sec) 0.00407719612121582
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0008912086486816406
A = g.adjacency_matrix() spent  0.0007193088531494141
auxiliary_graph
Graph(num_nodes=19738, num_edges=1852067,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.013604164123535156
remove nodes length
16813
auxiliary_graph.remove_nodes spent  0.07297897338867188
after remove non output nodes the auxiliary_graph
Graph(num_nodes=2925, num_edges=1852067,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.06306076049804688

the counter of shared neighbor distribution
Counter({1.0: 1624972, 2.0: 185142, 3.0: 30656, 4.0: 5894, 5.0: 1614, 6.0: 478, 7.0: 216, 8.0: 82, 9.0: 38, 10.0: 22, 11.0: 10, 12.0: 6, 14.0: 4, 13.0: 4, 17.0: 2, 15.0: 2})
1849142
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------
Convert a graph into a bidirected graph: 0.066 seconds
Metis partitioning: 0.106 seconds
Split the graph: 0.151 seconds
Construct subgraphs: 0.013 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.33643651008605957
1463
1462
total k batches seeds list generation spend  0.8647372722625732
after graph partition
graph partition algorithm spend time 0.8800699710845947
1463
1462
time for parepare:  0.041066646575927734
local_output_nid generation:  0.0004534721374511719
local_in_edges_tensor generation:  0.004727602005004883
mini_batch_src_global generation:  0.00167083740234375
r_  generation:  0.012821674346923828
local_output_nid generation:  0.00040078163146972656
local_in_edges_tensor generation:  0.0017914772033691406
mini_batch_src_global generation:  0.0014684200286865234
r_  generation:  0.010459184646606445
----------------------check_connections_block total spend ----------------------------- 0.08723711967468262
generate_one_block  0.019583702087402344
generate_one_block  0.015278816223144531
time for parepare:  0.024144411087036133
local_output_nid generation:  0.0019197463989257812
local_in_edges_tensor generation:  0.0030279159545898438
mini_batch_src_global generation:  0.005003452301025391
r_  generation:  0.04392099380493164
local_output_nid generation:  0.0022346973419189453
local_in_edges_tensor generation:  0.003246307373046875
mini_batch_src_global generation:  0.004685163497924805
r_  generation:  0.03602027893066406
----------------------check_connections_block total spend ----------------------------- 0.1439189910888672
generate_one_block  0.061734676361083984
generate_one_block  0.04810476303100586
global_2_local spend time (sec) 0.004221200942993164
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0007917881011962891
A = g.adjacency_matrix() spent  0.0005352497100830078
auxiliary_graph
Graph(num_nodes=19088, num_edges=606774,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.012705802917480469
remove nodes length
16330
auxiliary_graph.remove_nodes spent  0.014827966690063477
after remove non output nodes the auxiliary_graph
Graph(num_nodes=2758, num_edges=606774,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.018778085708618164

the counter of shared neighbor distribution
Counter({1.0: 500276, 2.0: 79750, 3.0: 17112, 4.0: 4422, 5.0: 1410, 6.0: 502, 7.0: 222, 8.0: 94, 9.0: 68, 10.0: 46, 11.0: 34, 13.0: 20, 14.0: 18, 12.0: 16, 17.0: 6, 15.0: 6, 16.0: 4, 20.0: 4, 19.0: 4, 18.0: 2})
604016
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------
Convert a graph into a bidirected graph: 0.019 seconds
Metis partitioning: 0.051 seconds
Split the graph: 0.049 seconds
Construct subgraphs: 0.031 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.15105319023132324
1381
1377
total k batches seeds list generation spend  0.33107495307922363
after graph partition
graph partition algorithm spend time 0.33960866928100586
1381
1377
time for parepare:  0.03711843490600586
local_output_nid generation:  0.0003783702850341797
local_in_edges_tensor generation:  0.001275777816772461
mini_batch_src_global generation:  0.0012357234954833984
r_  generation:  0.009109258651733398
local_output_nid generation:  0.00034618377685546875
local_in_edges_tensor generation:  0.000919342041015625
mini_batch_src_global generation:  0.0015065670013427734
r_  generation:  0.01130819320678711
----------------------check_connections_block total spend ----------------------------- 0.07331728935241699
generate_one_block  0.015404462814331055
generate_one_block  0.017450332641601562
time for parepare:  0.026279926300048828
local_output_nid generation:  0.001909017562866211
local_in_edges_tensor generation:  0.0029358863830566406
mini_batch_src_global generation:  0.0033795833587646484
r_  generation:  0.03231525421142578
local_output_nid generation:  0.002518892288208008
local_in_edges_tensor generation:  0.0030927658081054688
mini_batch_src_global generation:  0.004661083221435547
r_  generation:  0.042597055435180664
----------------------check_connections_block total spend ----------------------------- 0.1397559642791748
generate_one_block  0.04692578315734863
generate_one_block  0.06028866767883301
----------===============-------------===============-------------the number of batches *****---- 34

original number of batches:  32
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03191995620727539  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

connection checking time:  1.5715067386627197
block generation total time  1.3518831729888916
average batch blocks generation time:  0.04224634915590286
block dataloader generation time/epoch 28.68492829799652
pseudo mini batch 0 input nodes size: 24922
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.029316425323486328  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.029316425323486328  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.04120016098022461  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.04122161865234375  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.023222923278808594  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.023866653442382812  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.023866653442382812  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 24922
first layer output nodes number: 9065
edges number: 63777
input nodes number: 9065
output nodes number: 2849
edges number: 22503
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.8696579933166504  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.8696589469909668  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.025310993194580078  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 1 input nodes size: 17838
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.023434162139892578  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.023434162139892578  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03193998336791992  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03196144104003906  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02005624771118164  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.020592212677001953  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.020592212677001953  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 17838
first layer output nodes number: 6798
edges number: 47465
input nodes number: 6798
output nodes number: 2870
edges number: 24412
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.7637906074523926  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.7637910842895508  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02163219451904297  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 2 input nodes size: 22487
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02005910873413086  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02005910873413086  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03078174591064453  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03080272674560547  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.022275447845458984  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02282857894897461  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02282857894897461  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 22487
first layer output nodes number: 8375
edges number: 55161
input nodes number: 8375
output nodes number: 2789
edges number: 18989
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.7524662017822266  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.7524666786193848  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.023899078369140625  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 3 input nodes size: 26394
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.022263526916503906  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.022263526916503906  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03484916687011719  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.034870147705078125  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.024126529693603516  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.024719715118408203  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.024719715118408203  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 26394
first layer output nodes number: 8883
edges number: 60067
input nodes number: 8883
output nodes number: 2813
edges number: 19340
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.7951769828796387  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.7951774597167969  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02588939666748047  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 4 input nodes size: 29921
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02413034439086914  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02413034439086914  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.038397789001464844  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03841876983642578  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.025812149047851562  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02644062042236328  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02644062042236328  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 29921
first layer output nodes number: 9781
edges number: 67575
input nodes number: 9781
output nodes number: 2759
edges number: 16768
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.8168749809265137  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.8168754577636719  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.027659893035888672  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 5 input nodes size: 29198
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02580404281616211  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02580404281616211  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03972673416137695  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03974771499633789  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02545928955078125  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.026297569274902344  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.026297569274902344  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 29198
first layer output nodes number: 11438
edges number: 88907
input nodes number: 11438
output nodes number: 2785
edges number: 23510
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 1.0865507125854492  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 1.0865511894226074  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.027821063995361328  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 6 input nodes size: 35838
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.025463104248046875  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.025463104248046875  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.04255199432373047  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.042572975158691406  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.028629302978515625  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.029341697692871094  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.029341697692871094  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 35838
first layer output nodes number: 11075
edges number: 78390
input nodes number: 11075
output nodes number: 2758
edges number: 17035
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.9127302169799805  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.9127306938171387  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03072500228881836  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 7 input nodes size: 17733
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.028625011444091797  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.028625011444091797  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03708076477050781  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.037102699279785156  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.019992828369140625  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.020465850830078125  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.020465850830078125  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 17733
first layer output nodes number: 7670
edges number: 45554
input nodes number: 7670
output nodes number: 2881
edges number: 17891
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.6646275520324707  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.6646280288696289  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02142810821533203  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 8 input nodes size: 37307
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.020011425018310547  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.020011425018310547  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03780078887939453  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03782176971435547  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.02934408187866211  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.030552387237548828  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.030552387237548828  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 37307
first layer output nodes number: 15123
edges number: 129317
input nodes number: 15123
output nodes number: 2758
edges number: 32669
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 1.5291872024536133  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 1.5291876792907715  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03263521194458008  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 9 input nodes size: 45750
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.029325485229492188  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.029325485229492188  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.051140785217285156  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.051161766052246094  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03335142135620117  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03444337844848633  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03444337844848633  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 45750
first layer output nodes number: 15126
edges number: 121979
input nodes number: 15126
output nodes number: 2809
edges number: 24499
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 1.3562970161437988  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 1.356297492980957  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03643798828125  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 10 input nodes size: 46316
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03335905075073242  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03335905075073242  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.05544424057006836  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.0554652214050293  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03362894058227539  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.0348973274230957  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.0348973274230957  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 46316
first layer output nodes number: 16700
edges number: 141488
input nodes number: 16700
output nodes number: 2774
edges number: 28555
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 1.5766491889953613  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 1.5766496658325195  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.0371246337890625  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 11 input nodes size: 43851
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.033623695373535156  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.033623695373535156  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.055108070373535156  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.055129051208496094  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03302288055419922  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03425121307373047  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03425121307373047  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 43851
first layer output nodes number: 16424
edges number: 137362
input nodes number: 16424
output nodes number: 2758
edges number: 27293
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 1.517857551574707  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 1.5178580284118652  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.0364079475402832  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

pseudo mini batch 12 input nodes size: 40315
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.0330204963684082  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.0330204963684082  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.0525517463684082  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.05257368087768555  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03106832504272461  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03257131576538086  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8251953125 GB
    Memory Allocated: 0.03257131576538086  GigaBytes
Max Memory Allocated: 1.876025676727295  GigaBytes

first layer input nodes number: 40315
first layer output nodes number: 18187
edges number: 161502
input nodes number: 18187
output nodes number: 2905
edges number: 40178
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9150390625 GB
    Memory Allocated: 1.8827247619628906  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9150390625 GB
    Memory Allocated: 1.8827252388000488  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.035137176513671875  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

pseudo mini batch 13 input nodes size: 40709
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.031090259552001953  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.031090259552001953  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.05062150955200195  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.05064249038696289  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.031089305877685547  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.03235197067260742  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.03235197067260742  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

first layer input nodes number: 40709
first layer output nodes number: 16284
edges number: 138881
input nodes number: 16284
output nodes number: 2758
edges number: 30402
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 1.5739164352416992  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 1.5739169120788574  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.03452014923095703  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

pseudo mini batch 14 input nodes size: 15832
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.031067371368408203  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.031067371368408203  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.03861665725708008  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.03863811492919922  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.01908588409423828  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.01957416534423828  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.01957416534423828  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

first layer input nodes number: 15832
first layer output nodes number: 6775
edges number: 43821
input nodes number: 6775
output nodes number: 2875
edges number: 21543
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.6963753700256348  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.696375846862793  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.020543575286865234  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

pseudo mini batch 15 input nodes size: 10833
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.019103527069091797  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.019103527069091797  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.025226116180419922  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.025248050689697266  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.01767730712890625  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.01806926727294922  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.01806926727294922  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

first layer input nodes number: 10833
first layer output nodes number: 5448
edges number: 32114
input nodes number: 5448
output nodes number: 2891
edges number: 20458
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.5848388671875  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.5848393440246582  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.018853187561035156  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

pseudo mini batch 16 input nodes size: 12992
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.017679691314697266  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.017679691314697266  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.023874759674072266  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.023896217346191406  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.017751693725585938  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.01814746856689453  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.01814746856689453  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

first layer input nodes number: 12992
first layer output nodes number: 6062
edges number: 34746
input nodes number: 6062
output nodes number: 2879
edges number: 18177
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.5769734382629395  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.5769739151000977  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.018943309783935547  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

pseudo mini batch 17 input nodes size: 17840
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.017749786376953125  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.017749786376953125  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.026256561279296875  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.02627849578857422  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.020061969757080078  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.020592212677001953  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.020592212677001953  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

first layer input nodes number: 17840
first layer output nodes number: 7641
edges number: 48754
input nodes number: 7641
output nodes number: 2891
edges number: 22354
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.7427873611450195  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.7427878379821777  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.021628856658935547  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

pseudo mini batch 18 input nodes size: 15285
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.02006387710571289  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.02006387710571289  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.027352333068847656  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.027374267578125  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.018845558166503906  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.019287109375  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.019287109375  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

first layer input nodes number: 15285
first layer output nodes number: 6727
edges number: 39885
input nodes number: 6727
output nodes number: 2905
edges number: 19266
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.6289291381835938  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.628929615020752  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.020173072814941406  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

pseudo mini batch 19 input nodes size: 9630
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.01884746551513672  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.01884746551513672  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.023439407348632812  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.023461341857910156  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.016150951385498047  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.016428470611572266  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.016428470611572266  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

first layer input nodes number: 9630
first layer output nodes number: 5225
edges number: 23452
input nodes number: 5225
output nodes number: 2893
edges number: 13594
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.4243602752685547  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.4243607521057129  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.01702880859375  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

pseudo mini batch 20 input nodes size: 11687
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.016149520874023438  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.016149520874023438  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.02172231674194336  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.0217437744140625  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.017129898071289062  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.0174407958984375  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.0174407958984375  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

first layer input nodes number: 11687
first layer output nodes number: 5371
edges number: 27471
input nodes number: 5371
output nodes number: 2821
edges number: 14169
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.46066999435424805  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.46067047119140625  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.01808643341064453  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

pseudo mini batch 21 input nodes size: 11891
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.01711893081665039  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.01711893081665039  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.02278900146484375  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.02281045913696289  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.017216205596923828  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.01756143569946289  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.01756143569946289  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

first layer input nodes number: 11891
first layer output nodes number: 5622
edges number: 29606
input nodes number: 5622
output nodes number: 2873
edges number: 16629
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.5129833221435547  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.5129837989807129  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.018285274505615234  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

pseudo mini batch 22 input nodes size: 16193
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.017223834991455078  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.017223834991455078  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.02494525909423828  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.024967193603515625  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.019275665283203125  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.019742965698242188  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.019742965698242188  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

first layer input nodes number: 16193
first layer output nodes number: 6449
edges number: 41039
input nodes number: 6449
output nodes number: 2909
edges number: 21541
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.6703853607177734  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.6703858375549316  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.020676136016845703  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

pseudo mini batch 23 input nodes size: 12866
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.019281387329101562  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.019281387329101562  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.02541637420654297  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.025438308715820312  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.017694950103759766  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.018160343170166016  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.018160343170166016  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

first layer input nodes number: 12866
first layer output nodes number: 6222
edges number: 38975
input nodes number: 6222
output nodes number: 2886
edges number: 23408
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.6794681549072266  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.6794686317443848  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.01906585693359375  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

pseudo mini batch 24 input nodes size: 17955
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.01769113540649414  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.01769113540649414  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.02625274658203125  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.02627420425415039  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.02011728286743164  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.020615100860595703  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.020615100860595703  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

first layer input nodes number: 17955
first layer output nodes number: 6916
edges number: 45646
input nodes number: 6916
output nodes number: 2870
edges number: 21001
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.7023639678955078  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.702364444732666  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.021590709686279297  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

pseudo mini batch 25 input nodes size: 12824
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.020114898681640625  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.020114898681640625  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.0262298583984375  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.02625131607055664  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.01766824722290039  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.018168926239013672  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.018168926239013672  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

first layer input nodes number: 12824
first layer output nodes number: 5987
edges number: 41838
input nodes number: 5987
output nodes number: 2875
edges number: 25267
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.7260575294494629  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.7260580062866211  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.01912212371826172  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

pseudo mini batch 26 input nodes size: 15673
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.017669200897216797  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.017669200897216797  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.025226116180419922  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.025248050689697266  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.01911163330078125  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.019741058349609375  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.019741058349609375  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

first layer input nodes number: 15673
first layer output nodes number: 7921
edges number: 57413
input nodes number: 7921
output nodes number: 2927
edges number: 26921
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.8787374496459961  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.8787379264831543  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.020906448364257812  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

pseudo mini batch 27 input nodes size: 16686
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.0191192626953125  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.0191192626953125  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.027075767517089844  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.02709674835205078  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.019517898559570312  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.020028114318847656  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.020028114318847656  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

first layer input nodes number: 16686
first layer output nodes number: 7440
edges number: 49372
input nodes number: 7440
output nodes number: 2770
edges number: 19070
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.7070083618164062  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.7070088386535645  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.0209808349609375  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

pseudo mini batch 28 input nodes size: 16051
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.01949453353881836  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.01949453353881836  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.02714824676513672  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.027170181274414062  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.01919269561767578  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.01979351043701172  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.01979351043701172  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

first layer input nodes number: 16051
first layer output nodes number: 7722
edges number: 53650
input nodes number: 7722
output nodes number: 2926
edges number: 26832
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.8525943756103516  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.8525948524475098  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.02094411849975586  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

pseudo mini batch 29 input nodes size: 16582
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.019216060638427734  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.019216060638427734  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.027122974395751953  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.02714395523071289  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.019468307495117188  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.019945144653320312  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.019945144653320312  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

first layer input nodes number: 16582
first layer output nodes number: 6928
edges number: 43638
input nodes number: 6928
output nodes number: 2801
edges number: 20347
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.6764764785766602  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.6764769554138184  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.020866870880126953  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

pseudo mini batch 30 input nodes size: 38060
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.019449710845947266  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.019449710845947266  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.0375981330871582  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.037609100341796875  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.02968120574951172  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.03064441680908203  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.03064441680908203  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

first layer input nodes number: 38060
first layer output nodes number: 12088
edges number: 109100
input nodes number: 12088
output nodes number: 1463
edges number: 20034
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 1.1724934577941895  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 1.1724939346313477  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.03212928771972656  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

pseudo mini batch 31 input nodes size: 30589
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.029481887817382812  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.029481887817382812  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.0440678596496582  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.044078826904296875  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.025919437408447266  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.026677608489990234  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.026677608489990234  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

first layer input nodes number: 30589
first layer output nodes number: 9911Using backend: pytorch

edges number: 84576
input nodes number: 9911
output nodes number: 1462
edges number: 17098
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.9427499771118164  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.9427504539489746  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.028029918670654297  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

pseudo mini batch 32 input nodes size: 30962
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.025918960571289062  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.025918960571289062  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.04068279266357422  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.04069328308105469  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.026096343994140625  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.02680206298828125  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.02680206298828125  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

first layer input nodes number: 30962
first layer output nodes number: 9573
edges number: 80450
input nodes number: 9573
output nodes number: 1381
edges number: 14164
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.8710131645202637  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.8710136413574219  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.028062820434570312  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

pseudo mini batch 33 input nodes size: 36043
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.026084423065185547  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.026084423065185547  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.04327106475830078  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.04328155517578125  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.028507232666015625  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.029450416564941406  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.029450416564941406  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

first layer input nodes number: 36043
first layer output nodes number: 11915
edges number: 108051
input nodes number: 11915
output nodes number: 1377
edges number: 18333
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 1.1348352432250977  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 1.1348357200622559  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.031083106994628906  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.031083106994628906  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.9169921875 GB
    Memory Allocated: 0.031083106994628906  GigaBytes
Max Memory Allocated: 1.9399147033691406  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009917679954977596 |0.0023072116515215706 |0.11820835926953484 |0.0001343558816348805 |0.1397834946127499 |0.006716728210449219 |
----------------------------------------------------------pseudo_mini_loss sum 4.010824680328369
Total (block generation + training)time/epoch 37.91008174419403
Training time/epoch 9.403405904769897
Training time without block to device /epoch 9.324960708618164
Training time without total dataloading part /epoch 8.783007860183716
load block tensor time/epoch 0.3372011184692383
block to device time/epoch 0.0784451961517334
input features size transfer per epoch 4.559755325317383e-06
blocks size to device per epoch 3.039836883544922e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  1143925
Number of first layer input nodes during this epoch:  825053
Number of first layer output nodes during this epoch:  318872
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
