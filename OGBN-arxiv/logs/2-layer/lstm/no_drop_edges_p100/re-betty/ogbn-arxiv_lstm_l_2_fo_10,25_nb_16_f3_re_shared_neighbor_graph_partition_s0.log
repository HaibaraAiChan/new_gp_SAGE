[23:23:06] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28961398 edges into 16 parts and get 6575000 edge cuts
main start at this time 1652224961.6438904
-----------------------------------------before load data 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.8232421875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.8232421875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02270674705505371
global_2_local spend time (sec) 0.039525747299194336
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004267454147338867
A = g.adjacency_matrix() spent  0.006428718566894531
auxiliary_graph
Graph(num_nodes=154710, num_edges=29052339,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.09905529022216797
remove nodes length
63769
auxiliary_graph.remove_nodes spent  1.4127657413482666
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29052339,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.2531886100769043

the counter of shared neighbor distribution
Counter({1.0: 23396418, 2.0: 4042542, 3.0: 1009392, 4.0: 305652, 5.0: 111008, 6.0: 48054, 7.0: 22158, 8.0: 11680, 9.0: 5998, 10.0: 3494, 11.0: 1958, 12.0: 1128, 13.0: 668, 14.0: 442, 15.0: 276, 16.0: 212, 17.0: 174, 18.0: 66, 19.0: 58, 20.0: 10, 21.0: 6, 22.0: 4})
28961398
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28961395, 28961396, 28961397])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23396418, 2.0: 4042542, 3.0: 1009392, 4.0: 305652, 5.0: 111008, 6.0: 48054, 7.0: 22158, 8.0: 11680, 9.0: 5998, 10.0: 3494, 11.0: 1958, 12.0: 1128, 13.0: 668, 14.0: 442, 15.0: 276, 16.0: 212, 17.0: 174, 18.0: 66, 19.0: 58, 20.0: 10, 21.0: 6, 22.0: 4})
Convert a graph into a bidirected graph: 2.089 seconds
Metis partitioning: 6.495 seconds
Split the graph: 1.713 seconds
Construct subgraphs: 0.116 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  10.427775382995605
5517
5784
5517
5517
5782
5517
5684
5517
5525
5853
5852
5578
5835
5816
5811
5836
total k batches seeds list generation spend  22.82984185218811
after graph partition
graph partition algorithm spend time 22.942497491836548
5517
5784
5517
5517
5782
5517
5684
5517
5525
5853
5852
5578
5835
5816
5811
5836
partition_len_list
[25528, 28656, 29708, 23799, 13388, 13250, 17611, 24427, 12725, 12439, 10768, 11501, 10917, 9520, 13303, 13388]
shared_neighbor_graph_partition_s0 selection method  spend 23.03534984588623
time for parepare:  0.020390033721923828
local_output_nid generation:  0.0010066032409667969
local_in_edges_tensor generation:  0.0014908313751220703
mini_batch_src_global generation:  0.0026581287384033203
r_  generation:  0.023669958114624023
local_output_nid generation:  0.0015687942504882812
local_in_edges_tensor generation:  0.0017206668853759766
mini_batch_src_global generation:  0.004033088684082031
r_  generation:  0.030710935592651367
local_output_nid generation:  0.001657724380493164
local_in_edges_tensor generation:  0.0013186931610107422
mini_batch_src_global generation:  0.002270936965942383
r_  generation:  0.023229598999023438
local_output_nid generation:  0.001646280288696289
local_in_edges_tensor generation:  0.0011756420135498047
mini_batch_src_global generation:  0.001703500747680664
r_  generation:  0.01695704460144043
local_output_nid generation:  0.0014231204986572266
local_in_edges_tensor generation:  0.001104593276977539
mini_batch_src_global generation:  0.0013697147369384766
r_  generation:  0.01565098762512207
local_output_nid generation:  0.0012094974517822266
local_in_edges_tensor generation:  0.0010335445404052734
mini_batch_src_global generation:  0.0012705326080322266
r_  generation:  0.01468968391418457
local_output_nid generation:  0.0011370182037353516
local_in_edges_tensor generation:  0.0010929107666015625
mini_batch_src_global generation:  0.001482248306274414
r_  generation:  0.017429828643798828
local_output_nid generation:  0.001096487045288086
local_in_edges_tensor generation:  0.0011043548583984375
mini_batch_src_global generation:  0.0016751289367675781
r_  generation:  0.020130395889282227
local_output_nid generation:  0.001131296157836914
local_in_edges_tensor generation:  0.0010671615600585938
mini_batch_src_global generation:  0.0015201568603515625
r_  generation:  0.0165555477142334
local_output_nid generation:  0.001165628433227539
local_in_edges_tensor generation:  0.0011394023895263672
mini_batch_src_global generation:  0.0016884803771972656
r_  generation:  0.02024102210998535
local_output_nid generation:  0.0011432170867919922
local_in_edges_tensor generation:  0.001337289810180664
mini_batch_src_global generation:  0.0016760826110839844
r_  generation:  0.020989179611206055
local_output_nid generation:  0.001195669174194336
local_in_edges_tensor generation:  0.0011060237884521484
mini_batch_src_global generation:  0.0016224384307861328
r_  generation:  0.017801284790039062
local_output_nid generation:  0.0011556148529052734
local_in_edges_tensor generation:  0.0011012554168701172
mini_batch_src_global generation:  0.0014300346374511719
r_  generation:  0.016422033309936523
local_output_nid generation:  0.0011057853698730469
local_in_edges_tensor generation:  0.0010716915130615234
mini_batch_src_global generation:  0.0012655258178710938
r_  generation:  0.014638423919677734
local_output_nid generation:  0.001070261001586914
local_in_edges_tensor generation:  0.0011093616485595703
mini_batch_src_global generation:  0.001764535903930664
r_  generation:  0.0202791690826416
local_output_nid generation:  0.0012748241424560547
local_in_edges_tensor generation:  0.0015079975128173828
mini_batch_src_global generation:  0.002315998077392578
r_  generation:  0.020084142684936523
----------------------check_connections_block total spend ----------------------------- 0.4737086296081543
generate_one_block  0.04215645790100098
generate_one_block  0.04512143135070801
generate_one_block  0.033655643463134766
generate_one_block  0.024402379989624023
generate_one_block  0.024622201919555664
generate_one_block  0.022031545639038086
generate_one_block  0.024588823318481445
generate_one_block  0.02802729606628418
generate_one_block  0.02159881591796875
generate_one_block  0.027085542678833008
generate_one_block  0.025624990463256836
generate_one_block  0.023386240005493164
generate_one_block  0.020754575729370117
generate_one_block  0.01816558837890625
generate_one_block  0.02396988868713379
generate_one_block  0.027212142944335938
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04730582237243652
gen group dst list time:  0.00870823860168457
time for parepare:  0.027884960174560547
local_output_nid generation:  0.004103899002075195
local_in_edges_tensor generation:  0.025449752807617188
mini_batch_src_global generation:  0.00795435905456543
r_  generation:  0.08472919464111328
local_output_nid generation:  0.006861448287963867
local_in_edges_tensor generation:  0.009854555130004883
mini_batch_src_global generation:  0.012419939041137695[23:23:13] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 5517 nodes and 2328712 edges into 2 parts and get 253150 edge cuts

r_  generation:  0.10315966606140137
local_output_nid generation:  0.007113933563232422
local_in_edges_tensor generation:  0.007680654525756836
mini_batch_src_global generation:  0.01053166389465332
r_  generation:  0.09981989860534668
local_output_nid generation:  0.005819559097290039
local_in_edges_tensor generation:  0.005869150161743164
mini_batch_src_global generation:  0.008336305618286133
r_  generation:  0.07561564445495605
local_output_nid generation:  0.0034401416778564453
local_in_edges_tensor generation:  0.0029451847076416016
mini_batch_src_global generation:  0.004240751266479492
r_  generation:  0.03600668907165527
local_output_nid generation:  0.003149747848510742
local_in_edges_tensor generation:  0.002795696258544922
mini_batch_src_global generation:  0.0029845237731933594
r_  generation:  0.03528904914855957
local_output_nid generation:  0.00404047966003418
local_in_edges_tensor generation:  0.003777027130126953
mini_batch_src_global generation:  0.004822731018066406
r_  generation:  0.051308393478393555
local_output_nid generation:  0.005255460739135742
local_in_edges_tensor generation:  0.0056378841400146484
mini_batch_src_global generation:  0.0076177120208740234
r_  generation:  0.07935261726379395
local_output_nid generation:  0.0034019947052001953
local_in_edges_tensor generation:  0.0027680397033691406
mini_batch_src_global generation:  0.004228115081787109
r_  generation:  0.03479576110839844
local_output_nid generation:  0.0032510757446289062
local_in_edges_tensor generation:  0.002878427505493164
mini_batch_src_global generation:  0.0031671524047851562
r_  generation:  0.03606462478637695
local_output_nid generation:  0.002370119094848633
local_in_edges_tensor generation:  0.0026183128356933594
mini_batch_src_global generation:  0.002640962600708008
r_  generation:  0.02981877326965332
local_output_nid generation:  0.0023653507232666016
local_in_edges_tensor generation:  0.0023648738861083984
mini_batch_src_global generation:  0.0026144981384277344
r_  generation:  0.032259225845336914
local_output_nid generation:  0.0025250911712646484
local_in_edges_tensor generation:  0.002148866653442383
mini_batch_src_global generation:  0.002374410629272461
r_  generation:  0.027374982833862305
local_output_nid generation:  0.002058744430541992
local_in_edges_tensor generation:  0.0018646717071533203
mini_batch_src_global generation:  0.0018451213836669922
r_  generation:  0.021460771560668945
local_output_nid generation:  0.002718210220336914
local_in_edges_tensor generation:  0.0025861263275146484
mini_batch_src_global generation:  0.002744913101196289
r_  generation:  0.03611278533935547
local_output_nid generation:  0.002732992172241211
local_in_edges_tensor generation:  0.002894163131713867
mini_batch_src_global generation:  0.003606557846069336
r_  generation:  0.03890848159790039
----------------------check_connections_block total spend ----------------------------- 1.2462506294250488
generate_one_block  0.11330938339233398
generate_one_block  0.1371772289276123
generate_one_block  0.13539552688598633
generate_one_block  0.0994253158569336
generate_one_block  0.04500865936279297
generate_one_block  0.04407143592834473
generate_one_block  0.0743722915649414
generate_one_block  0.10892057418823242
generate_one_block  0.04216480255126953
generate_one_block  0.04317140579223633
generate_one_block  0.050122976303100586
generate_one_block  0.04034852981567383
generate_one_block  0.03458833694458008
generate_one_block  0.027771711349487305
generate_one_block  0.05178213119506836
generate_one_block  0.0545048713684082
global_2_local spend time (sec) 0.0061664581298828125
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0010762214660644531
A = g.adjacency_matrix() spent  0.0009586811065673828
auxiliary_graph
Graph(num_nodes=29708, num_edges=2334229,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.01937079429626465
remove nodes length
24191
auxiliary_graph.remove_nodes spent  0.08464884757995605
after remove non output nodes the auxiliary_graph
Graph(num_nodes=5517, num_edges=2334229,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.08181381225585938

the counter of shared neighbor distribution
Counter({1.0: 2088666, 2.0: 198612, 3.0: 31174, 4.0: 6914, 5.0: 2060, 6.0: 756, 7.0: 278, 8.0: 142, 9.0: 54, 10.0: 36, 11.0: 12, 14.0: 4, 12.0: 2, 17.0: 2})
2328712
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([      0,       1,       2,  ..., 2328709, 2328710, 2328711])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 2088666, 2.0: 198612, 3.0: 31174, 4.0: 6914, 5.0: 2060, 6.0: 756, 7.0: 278, 8.0: 142, 9.0: 54, 10.0: 36, 11.0: 12, 14.0: 4, 12.0: 2, 17.0: 2})
Convert a graph into a bidirected graph: 0.093 seconds
Metis partitioning: 0.176 seconds
Split the graph: 0.208 seconds
Construct subgraphs: 0.033 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.5132689476013184
2729
2788
total k batches seeds list generation spend  1.506465196609497
after graph partition
graph partition algorithm spend time 1.5184152126312256
2729
2788
time for parepare:  0.03154420852661133
local_output_nid generation:  0.0005834102630615234
local_in_edges_tensor generation:  0.004765033721923828
mini_batch_src_global generation:  0.0016024112701416016
r_  generation:  0.012632131576538086
local_output_nid generation:  0.0006008148193359375
local_in_edges_tensor generation:  0.0014982223510742188
mini_batch_src_global generation:  0.0019102096557617188
r_  generation:  0.01589798927307129
----------------------check_connections_block total spend ----------------------------- 0.08330631256103516
generate_one_block  0.01846146583557129
generate_one_block  0.02027606964111328
time for parepare:  0.021408557891845703
local_output_nid generation:  0.0017826557159423828
local_in_edges_tensor generation:  0.009582281112670898
mini_batch_src_global generation:  0.00400233268737793
r_  generation:  0.04163718223571777
local_output_nid generation:  0.005388498306274414
local_in_edges_tensor generation:  0.005327701568603516
mini_batch_src_global generation:  0.0070972442626953125
r_  generation:  0.07098674774169922
----------------------check_connections_block total spend ----------------------------- 0.20003414154052734
generate_one_block  0.055139780044555664
generate_one_block  0.09042215347290039
----------===============-------------===============-------------the number of batches *****---- 17

original number of batches:  16
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.8232421875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  1.2462506294250488
block generation total time  1.102135181427002
average batch blocks generation time:  0.06888344883918762
pseudo mini batch 0 input nodes size: 51576
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.8232421875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.8232421875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.8486328125 GB
    Memory Allocated: 0.028168201446533203  GigaBytes
Max Memory Allocated: 0.028168201446533203  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.8486328125 GB
    Memory Allocated: 0.028209686279296875  GigaBytes
Max Memory Allocated: 0.028209686279296875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.8486328125 GB
    Memory Allocated: 0.028209686279296875  GigaBytes
Max Memory Allocated: 0.028209686279296875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 0.8994140625 GB
    Memory Allocated: 0.030221939086914062  GigaBytes
Max Memory Allocated: 0.030221939086914062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.8994140625 GB
    Memory Allocated: 0.030221939086914062  GigaBytes
Max Memory Allocated: 0.030221939086914062  GigaBytes

first layer input nodes number: 51576
first layer output nodes number: 25528
edges number: 209725
input nodes number: 25528
output nodes number: 5517
edges number: 60280
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6220703125 GB
    Memory Allocated: 2.5888328552246094  GigaBytes
Max Memory Allocated: 2.67059326171875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.6220703125 GB
    Memory Allocated: 2.588833808898926  GigaBytes
Max Memory Allocated: 2.67059326171875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7431640625 GB
    Memory Allocated: 0.03730010986328125  GigaBytes
Max Memory Allocated: 2.67059326171875  GigaBytes

pseudo mini batch 1 input nodes size: 54526
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7431640625 GB
    Memory Allocated: 0.03180837631225586  GigaBytes
Max Memory Allocated: 2.67059326171875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7431640625 GB
    Memory Allocated: 0.03180837631225586  GigaBytes
Max Memory Allocated: 2.67059326171875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7431640625 GB
    Memory Allocated: 0.05780839920043945  GigaBytes
Max Memory Allocated: 2.67059326171875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7431640625 GB
    Memory Allocated: 0.05785179138183594  GigaBytes
Max Memory Allocated: 2.67059326171875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7431640625 GB
    Memory Allocated: 0.032419681549072266  GigaBytes
Max Memory Allocated: 2.67059326171875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7431640625 GB
    Memory Allocated: 0.03485727310180664  GigaBytes
Max Memory Allocated: 2.67059326171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7431640625 GB
    Memory Allocated: 0.03485727310180664  GigaBytes
Max Memory Allocated: 2.67059326171875  GigaBytes

first layer input nodes number: 54526
first layer output nodes number: 28656
edges number: 248765
input nodes number: 28656
output nodes number: 5784
edges number: 78265
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0283203125 GB
    Memory Allocated: 3.1349496841430664  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0283203125 GB
    Memory Allocated: 3.1349501609802246  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03903055191040039  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 2 input nodes size: 61038
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.032459259033203125  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.032459259033203125  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.06156444549560547  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.06160593032836914  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03556251525878906  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.037194252014160156  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.037194252014160156  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 61038
first layer output nodes number: 23799
edges number: 178119
input nodes number: 23799
output nodes number: 5517
edges number: 40774
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 2.05397367477417  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 2.053974151611328  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.04014015197753906  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 3 input nodes size: 31924
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.0355229377746582  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.0355229377746582  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.050745487213134766  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.05078887939453125  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.021642208099365234  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.022502422332763672  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.022502422332763672  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 31924
first layer output nodes number: 13388
edges number: 79794
input nodes number: 13388
output nodes number: 5782
edges number: 35460
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.2055258750915527  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.205526351928711  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02427053451538086  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 4 input nodes size: 30073
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02168130874633789  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02168130874633789  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03602123260498047  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03606271743774414  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.020796775817871094  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.021627426147460938  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.021627426147460938  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 30073
first layer output nodes number: 13250
edges number: 77729
input nodes number: 13250
output nodes number: 5517
edges number: 33554
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.158975601196289  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.1589760780334473  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.023253917694091797  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 5 input nodes size: 39132
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.020757675170898438  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.020757675170898438  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.04028892517089844  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.040331363677978516  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.025949954986572266  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.027186870574951172  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.027186870574951172  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 39132
first layer output nodes number: 17611
edges number: 123971
input nodes number: 17611
output nodes number: 5684
edges number: 41891
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.6418561935424805  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.6418566703796387  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02951192855834961  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 6 input nodes size: 57746
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.025974750518798828  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.025974750518798828  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.053510189056396484  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.053551673889160156  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03397798538208008  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.035738468170166016  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.035738468170166016  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 57746
first layer output nodes number: 24427
edges number: 188215
input nodes number: 24427
output nodes number: 5517
edges number: 47961
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 2.2322745323181152  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 2.2322750091552734  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03887128829956055  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 7 input nodes size: 26224
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.033953189849853516  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.033953189849853516  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.046457767486572266  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.04649925231933594  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.01892232894897461  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.019782543182373047  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.019782543182373047  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 26224
first layer output nodes number: 12725
edges number: 76141
input nodes number: 12725
output nodes number: 5525
edges number: 39202
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.2230987548828125  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.2230992317199707  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02147960662841797  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 8 input nodes size: 21427
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.018923282623291016  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.018923282623291016  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.029140472412109375  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.029184341430664062  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.01663827896118164  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.01763296127319336  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.01763296127319336  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 21427
first layer output nodes number: 12439
edges number: 82537
input nodes number: 12439
output nodes number: 5853
edges number: 50824
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.4446334838867188  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.444633960723877  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.019561290740966797  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 9 input nodes size: 19599
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.016687393188476562  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.016687393188476562  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02603292465209961  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.026076793670654297  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.01581573486328125  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.01669788360595703  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.01669788360595703  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 19599
first layer output nodes number: 10768
edges number: 71028
input nodes number: 10768
output nodes number: 5852
edges number: 47272
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.2930965423583984  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.2930970191955566  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.0183868408203125  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 10 input nodes size: 23417
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.015815258026123047  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.015815258026123047  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.026981353759765625  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.0270233154296875  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.017633914947509766  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.018512248992919922  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.018512248992919922  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 23417
first layer output nodes number: 11501
edges number: 73555
input nodes number: 11501
output nodes number: 5578
edges number: 44275
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.2716331481933594  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.2716336250305176  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02017498016357422  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 11 input nodes size: 19703
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.0175933837890625  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.0175933837890625  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.026988506317138672  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02703237533569336  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.015824317932128906  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.016571044921875  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.016571044921875  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 19703
first layer output nodes number: 10917
edges number: 61774
input nodes number: 10917
output nodes number: 5835
edges number: 38400
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.1033263206481934  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.1033267974853516  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.01809978485107422  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 12 input nodes size: 14977
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.015862464904785156  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.015862464904785156  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02300405502319336  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.023047447204589844  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.013608455657958984  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.014206409454345703  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.014206409454345703  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 14977
first layer output nodes number: 9520
edges number: 47043
input nodes number: 9520
output nodes number: 5816
edges number: 33035
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.9034781455993652  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.9034786224365234  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.015439510345458984  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 13 input nodes size: 28221
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.013605594635009766  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.013605594635009766  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.027062416076660156  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02710580825805664  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.019920825958251953  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.020888805389404297  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.020888805389404297  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 28221
first layer output nodes number: 13303
edges number: 85046
input nodes number: 13303
output nodes number: 5811
edges number: 44730
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.3705615997314453  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.3705620765686035  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.022762775421142578  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 14 input nodes size: 31120
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.019919872283935547  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.019919872283935547  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.0347590446472168  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.034802913665771484  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02130270004272461  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.022361278533935547  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.022361278533935547  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 31120
first layer output nodes number: 13388
edges number: 91470
input nodes number: 13388
output nodes number: 5836
edges number: 50487
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.5102839469909668  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.510284423828125  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes
[23:23:43] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 29070896 edges into 16 parts and get 6655781 edge cuts

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.0243988037109375  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 15 input nodes size: 35872
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.021306514739990234  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.021306514739990234  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.038411617279052734  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03843212127685547  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02354907989501953  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02447032928466797  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02447032928466797  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 35872
first layer output nodes number: 13062
edges number: 99781
input nodes number: 13062
output nodes number: 2729
edges number: 23742
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.1730971336364746  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.1730976104736328  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.025698184967041016  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 16 input nodes size: 50361
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.023086071014404297  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.023086071014404297  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.047100067138671875  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.04712104797363281  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.029995441436767578  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.0315241813659668  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.0315241813659668  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 50361
first layer output nodes number: 19638
edges number: 170891
input nodes number: 19638
output nodes number: 2788
edges number: 34098
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.8760418891906738  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.876042366027832  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03416299819946289  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.039713382720947266  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.039713382720947266  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013778532252592198 |0.02566212766310748 |0.14698724185719209 |0.00013375282287597656 |0.14059518365299 |0.008536577224731445 |
----------------------------------------------------------pseudo_mini_loss sum 5.315825462341309
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  870856
Number of first layer input nodes during this epoch:  596936
Number of first layer output nodes during this epoch:  273920
----------------------------------------before generate dataloader block 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03971290588378906  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02521228790283203
global_2_local spend time (sec) 0.05185127258300781
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004326343536376953
A = g.adjacency_matrix() spent  0.006231069564819336
auxiliary_graph
Graph(num_nodes=154609, num_edges=29161837,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.10051631927490234
remove nodes length
63668
auxiliary_graph.remove_nodes spent  1.4210596084594727
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29161837,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.2627136707305908

the counter of shared neighbor distribution
Counter({1.0: 23512832, 2.0: 4033528, 3.0: 1010720, 4.0: 307066, 5.0: 110996, 6.0: 47742, 7.0: 21964, 8.0: 11366, 9.0: 6212, 10.0: 3480, 11.0: 1996, 12.0: 1116, 13.0: 654, 14.0: 456, 15.0: 268, 16.0: 194, 17.0: 166, 18.0: 66, 19.0: 50, 20.0: 18, 21.0: 6})
29070896
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 29070893, 29070894, 29070895])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23512832, 2.0: 4033528, 3.0: 1010720, 4.0: 307066, 5.0: 110996, 6.0: 47742, 7.0: 21964, 8.0: 11366, 9.0: 6212, 10.0: 3480, 11.0: 1996, 12.0: 1116, 13.0: 654, 14.0: 456, 15.0: 268, 16.0: 194, 17.0: 166, 18.0: 66, 19.0: 50, 20.0: 18, 21.0: 6})
Convert a graph into a bidirected graph: 2.042 seconds
Metis partitioning: 6.807 seconds
Split the graph: 1.873 seconds
Construct subgraphs: 0.127 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  10.863315343856812
5854
5553
5690
5854
5713
5549
5639
5801
5650
5854
5849
5517
5518
5529
5517
5854
total k batches seeds list generation spend  25.182870388031006
after graph partition
graph partition algorithm spend time 25.30073595046997
5854
5553
5690
5854
5713
5549
5639
5801
5650
5854
5849
5517
5518
5529
5517
5854
partition_len_list
[11415, 11652, 11148, 11408, 12392, 12450, 10704, 10996, 13196, 16210, 18195, 24821, 24582, 28291, 27425, 27220]
shared_neighbor_graph_partition_s0 selection method  spend 25.415690183639526
time for parepare:  0.022785663604736328
local_output_nid generation:  0.0013039112091064453
local_in_edges_tensor generation:  0.0017590522766113281
mini_batch_src_global generation:  0.001886606216430664
r_  generation:  0.016216516494750977
local_output_nid generation:  0.0013561248779296875
local_in_edges_tensor generation:  0.0011799335479736328
mini_batch_src_global generation:  0.0018429756164550781
r_  generation:  0.016106128692626953
local_output_nid generation:  0.001363515853881836
local_in_edges_tensor generation:  0.001199483871459961
mini_batch_src_global generation:  0.0014731884002685547
r_  generation:  0.016030073165893555
local_output_nid generation:  0.0012927055358886719
local_in_edges_tensor generation:  0.0012242794036865234
mini_batch_src_global generation:  0.0015571117401123047
r_  generation:  0.017128944396972656
local_output_nid generation:  0.0012247562408447266
local_in_edges_tensor generation:  0.0012671947479248047
mini_batch_src_global generation:  0.0018410682678222656
r_  generation:  0.01949763298034668
local_output_nid generation:  0.0012171268463134766
local_in_edges_tensor generation:  0.0011370182037353516
mini_batch_src_global generation:  0.0016624927520751953
r_  generation:  0.017514705657958984
local_output_nid generation:  0.0012326240539550781
local_in_edges_tensor generation:  0.0011641979217529297
mini_batch_src_global generation:  0.0014510154724121094
r_  generation:  0.01707768440246582
local_output_nid generation:  0.0012729167938232422
local_in_edges_tensor generation:  0.0013127326965332031
mini_batch_src_global generation:  0.0017321109771728516
r_  generation:  0.019207477569580078
local_output_nid generation:  0.0012896060943603516
local_in_edges_tensor generation:  0.0011203289031982422
mini_batch_src_global generation:  0.00139617919921875
r_  generation:  0.015771150588989258
local_output_nid generation:  0.0015485286712646484
local_in_edges_tensor generation:  0.0013501644134521484
mini_batch_src_global generation:  0.0016202926635742188
r_  generation:  0.018961668014526367
local_output_nid generation:  0.0014612674713134766
local_in_edges_tensor generation:  0.001291513442993164
mini_batch_src_global generation:  0.0016634464263916016
r_  generation:  0.018819332122802734
local_output_nid generation:  0.0013620853424072266
local_in_edges_tensor generation:  0.0012159347534179688
mini_batch_src_global generation:  0.0017764568328857422
r_  generation:  0.020466327667236328
local_output_nid generation:  0.001359701156616211
local_in_edges_tensor generation:  0.0011477470397949219
mini_batch_src_global generation:  0.0016469955444335938
r_  generation:  0.018437862396240234
local_output_nid generation:  0.001384735107421875
local_in_edges_tensor generation:  0.0013535022735595703
mini_batch_src_global generation:  0.0020563602447509766
r_  generation:  0.023972272872924805
local_output_nid generation:  0.001443624496459961
local_in_edges_tensor generation:  0.0012559890747070312
mini_batch_src_global generation:  0.0023353099822998047
r_  generation:  0.024069547653198242
local_output_nid generation:  0.0015232563018798828
local_in_edges_tensor generation:  0.0014393329620361328
mini_batch_src_global generation:  0.002864360809326172
r_  generation:  0.03193163871765137
----------------------check_connections_block total spend ----------------------------- 0.4827404022216797
generate_one_block  0.029265880584716797
generate_one_block  0.02289557456970215
generate_one_block  0.021516084671020508
generate_one_block  0.022622346878051758
generate_one_block  0.027574777603149414
generate_one_block  0.0234372615814209
generate_one_block  0.02227187156677246
generate_one_block  0.025608539581298828
generate_one_block  0.02054762840270996
generate_one_block  0.027801036834716797
generate_one_block  0.026235103607177734
generate_one_block  0.029831409454345703
generate_one_block  0.025736331939697266
generate_one_block  0.03487896919250488
generate_one_block  0.03413081169128418
generate_one_block  0.044618844985961914
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0498814582824707
gen group dst list time:  0.009162425994873047
time for parepare:  0.028375864028930664
local_output_nid generation:  0.0021491050720214844
local_in_edges_tensor generation:  0.01024770736694336
mini_batch_src_global generation:  0.0027875900268554688
r_  generation:  0.029274940490722656
local_output_nid generation:  0.003731250762939453
local_in_edges_tensor generation:  0.003169536590576172
mini_batch_src_global generation:  0.003308534622192383
r_  generation:  0.031452178955078125
local_output_nid generation:  0.0031843185424804688
local_in_edges_tensor generation:  0.002481698989868164
mini_batch_src_global generation:  0.0023040771484375
r_  generation:  0.027989864349365234
local_output_nid generation:  0.0030100345611572266
local_in_edges_tensor generation:  0.0024352073669433594
mini_batch_src_global generation:  0.0023436546325683594
r_  generation:  0.02901935577392578
local_output_nid generation:  0.0033757686614990234
local_in_edges_tensor generation:  0.002706766128540039
mini_batch_src_global generation:  0.0029785633087158203
r_  generation:  0.03470277786254883
local_output_nid generation:  0.0026917457580566406
local_in_edges_tensor generation:  0.0031070709228515625
mini_batch_src_global generation:  0.002958059310913086
r_  generation:  0.035884857177734375
local_output_nid generation:  0.002552509307861328
local_in_edges_tensor generation:  0.0022230148315429688
mini_batch_src_global generation:  0.0024454593658447266
r_  generation:  0.026956796646118164
local_output_nid generation:  0.0024063587188720703
local_in_edges_tensor generation:  0.0023276805877685547
mini_batch_src_global generation:  0.002439737319946289
r_  generation:  0.030623435974121094
local_output_nid generation:  0.0028769969940185547
local_in_edges_tensor generation:  0.00473475456237793
mini_batch_src_global generation:  0.0029561519622802734
r_  generation:  0.036397695541381836
local_output_nid generation:  0.003698587417602539
local_in_edges_tensor generation:  0.0041811466217041016
mini_batch_src_global generation:  0.004705667495727539
r_  generation:  0.045877695083618164
local_output_nid generation:  0.004101276397705078
local_in_edges_tensor generation:  0.004780292510986328
mini_batch_src_global generation:  0.005701303482055664
r_  generation:  0.053818702697753906
local_output_nid generation:  0.0055065155029296875
local_in_edges_tensor generation:  0.007834911346435547
mini_batch_src_global generation:  0.008507728576660156
r_  generation:  0.08184528350830078
local_output_nid generation:  0.006074190139770508
local_in_edges_tensor generation:  0.006164073944091797
mini_batch_src_global generation:  0.008556604385375977
r_  generation:  0.07907629013061523
local_output_nid generation:  0.00640869140625
local_in_edges_tensor generation:  0.007842540740966797
mini_batch_src_global generation:  0.010335445404052734
r_  generation:  0.09952378273010254
local_output_nid generation:  0.006605625152587891
local_in_edges_tensor generation:  0.009446859359741211
mini_batch_src_global generation:  0.010695934295654297
r_  generation:  0.09697484970092773
local_output_nid generation:  0.0063326358795166016
local_in_edges_tensor generation:  0.0073392391204833984
mini_batch_src_global generation:  0.01090383529663086
r_  generation:  0.1003568172454834
----------------------check_connections_block total spend ----------------------------- 1.2721378803253174
generate_one_block  0.04721331596374512
generate_one_block  0.0430140495300293
generate_one_block  0.03645634651184082
generate_one_block  0.037432193756103516
generate_one_block  0.04518270492553711
generate_one_block  0.043941497802734375
generate_one_block  0.03444719314575195
generate_one_block  0.03970050811767578
generate_one_block  0.0472569465637207
generate_one_block [23:23:49] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 5518 nodes and 218578 edges into 2 parts and get 3698 edge cuts
 0.061940908432006836
generate_one_block  0.07253098487854004
generate_one_block  0.11288571357727051
generate_one_block  0.11170697212219238
generate_one_block  0.1340193748474121
generate_one_block  0.12395977973937988
generate_one_block  0.12915372848510742
global_2_local spend time (sec) 0.00574040412902832
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0008029937744140625
A = g.adjacency_matrix() spent  0.0007421970367431641
auxiliary_graph
Graph(num_nodes=24582, num_edges=224096,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.01678633689880371
remove nodes length
19064
auxiliary_graph.remove_nodes spent  0.008023977279663086
after remove non output nodes the auxiliary_graph
Graph(num_nodes=5518, num_edges=224096,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.006486415863037109

the counter of shared neighbor distribution
Counter({1.0: 195372, 2.0: 15936, 3.0: 3990, 4.0: 1576, 5.0: 666, 6.0: 426, 7.0: 194, 8.0: 136, 9.0: 80, 10.0: 56, 11.0: 48, 12.0: 26, 13.0: 26, 14.0: 18, 16.0: 10, 17.0: 8, 15.0: 6, 20.0: 4})
218578
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([     0,      1,      2,  ..., 218575, 218576, 218577])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 195372, 2.0: 15936, 3.0: 3990, 4.0: 1576, 5.0: 666, 6.0: 426, 7.0: 194, 8.0: 136, 9.0: 80, 10.0: 56, 11.0: 48, 12.0: 26, 13.0: 26, 14.0: 18, 16.0: 10, 17.0: 8, 15.0: 6, 20.0: 4})
Convert a graph into a bidirected graph: 0.007 seconds
Metis partitioning: 0.021 seconds
Split the graph: 0.050 seconds
Construct subgraphs: 0.022 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.1003715991973877
2759
2759
total k batches seeds list generation spend  0.22368240356445312
after graph partition
graph partition algorithm spend time 0.22970104217529297
2759
2759
time for parepare:  0.019395112991333008
local_output_nid generation:  0.0005059242248535156
local_in_edges_tensor generation:  0.0008456707000732422
mini_batch_src_global generation:  0.0008368492126464844
r_  generation:  0.006474971771240234
local_output_nid generation:  0.0005004405975341797
local_in_edges_tensor generation:  0.0008940696716308594
mini_batch_src_global generation:  0.0014102458953857422
r_  generation:  0.009526252746582031
----------------------check_connections_block total spend ----------------------------- 0.0477910041809082
generate_one_block  0.01136922836303711
generate_one_block  0.015960693359375
time for parepare:  0.020720958709716797
local_output_nid generation:  0.001626729965209961
local_in_edges_tensor generation:  0.002345561981201172
mini_batch_src_global generation:  0.003246307373046875
r_  generation:  0.02683424949645996
local_output_nid generation:  0.003751039505004883
local_in_edges_tensor generation:  0.004608869552612305
mini_batch_src_global generation:  0.008440017700195312
r_  generation:  0.07212400436401367
----------------------check_connections_block total spend ----------------------------- 0.16737842559814453
generate_one_block  0.0368499755859375
generate_one_block  0.08008694648742676
----------===============-------------===============-------------the number of batches *****---- 17

original number of batches:  16
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03971290588378906  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

connection checking time:  1.2721378803253174
block generation total time  1.1208422183990479
average batch blocks generation time:  0.07005263864994049
block dataloader generation time/epoch 29.58184552192688
pseudo mini batch 0 input nodes size: 22524
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.035553932189941406  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.035553932189941406  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.046294212341308594  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.04633808135986328  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.022303104400634766  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.023063182830810547  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.023063182830810547  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 22524
first layer output nodes number: 11415
edges number: 64203
input nodes number: 11415
output nodes number: 5854
edges number: 37754
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.1189446449279785  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.118945598602295  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.025052547454833984  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 1 input nodes size: 27040
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.022760868072509766  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.022760868072509766  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.035654544830322266  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03569602966308594  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.024911880493164062  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.025737762451171875  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.025737762451171875  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 27040
first layer output nodes number: 11652
edges number: 71526
input nodes number: 11652
output nodes number: 5553
edges number: 39226
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.1939325332641602  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.1939330101013184  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.027338027954101562  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 2 input nodes size: 20786
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02486705780029297  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02486705780029297  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.034778594970703125  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.0348210334777832  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02188587188720703  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.022645950317382812  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.022645950317382812  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 20786
first layer output nodes number: 11148
edges number: 64055
input nodes number: 11148
output nodes number: 5690
edges number: 37821
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.1152381896972656  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.1152386665344238  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.024178504943847656  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 3 input nodes size: 21827
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.021906375885009766  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.021906375885009766  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.032314300537109375  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03235816955566406  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.022404193878173828  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02320718765258789  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02320718765258789  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 21827
first layer output nodes number: 11408
edges number: 67114
input nodes number: 11408
output nodes number: 5854
edges number: 40496
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.1854910850524902  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.1854915618896484  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.024822235107421875  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 4 input nodes size: 22191
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.022428512573242188  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.022428512573242188  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.033010005950927734  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.033052921295166016  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02260112762451172  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.023581504821777344  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.023581504821777344  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 22191
first layer output nodes number: 12392
edges number: 82440
input nodes number: 12392
output nodes number: 5713
edges number: 48940
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.4154930114746094  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.4154934883117676  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02541351318359375  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 5 input nodes size: 23576
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02258014678955078  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02258014678955078  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.033822059631347656  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03386354446411133  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.0232391357421875  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.024147987365722656  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.024147987365722656  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 23576
first layer output nodes number: 12450
edges number: 79978
input nodes number: 12450
output nodes number: 5549
edges number: 41954
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.2938075065612793  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.2938079833984375  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.025863170623779297  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 6 input nodes size: 19677
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02321481704711914  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02321481704711914  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03259754180908203  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03263998031616211  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.021356582641601562  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.022124290466308594  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.022124290466308594  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 19677
first layer output nodes number: 10704
edges number: 62252
input nodes number: 10704
output nodes number: 5639
edges number: 40643
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.1372227668762207  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.137223243713379  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.023659706115722656  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 7 input nodes size: 21800
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02136993408203125  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02136993408203125  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.031764984130859375  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03180837631225586  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02238321304321289  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.023282527923583984  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.023282527923583984  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 21800
first layer output nodes number: 10996
edges number: 72679
input nodes number: 10996
output nodes number: 5801
edges number: 47881
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.3181872367858887  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.3181877136230469  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.025037288665771484  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 8 input nodes size: 31525
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.022407054901123047  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.022407054901123047  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03743934631347656  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03748178482055664  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02704334259033203  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.027896881103515625  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.027896881103515625  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 31525
first layer output nodes number: 13196
edges number: 79743
input nodes number: 13196
output nodes number: 5650
edges number: 34729
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.1971549987792969  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.197155475616455  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.029582977294921875  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 9 input nodes size: 38171
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.027020931243896484  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.027020931243896484  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.04522228240966797  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.045266151428222656  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.030191421508789062  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03133869171142578  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03133869171142578  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 38171
first layer output nodes number: 16210
edges number: 107933
input nodes number: 16210
output nodes number: 5854
edges number: 45909
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.594594955444336  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.5945954322814941  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03357267379760742  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 10 input nodes size: 40281
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.030221939086914062  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.030221939086914062  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.04975318908691406  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.04979705810546875  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03155183792114258  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03284025192260742  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03284025192260742  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 40281
first layer output nodes number: 18195
edges number: 128871
input nodes number: 18195
output nodes number: 5849
edges number: 44012
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.7166180610656738  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.716618537902832  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.035230159759521484  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 11 input nodes size: 58054
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03155088424682617  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03155088424682617  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.05923318862915039  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.05927467346191406  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.039699554443359375  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.04149818420410156  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.04149818420410156  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 58054
first layer output nodes number: 24821
edges number: 191874
input nodes number: 24821
output nodes number: 5517
edges number: 49381
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 2.288630962371826  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 2.2886314392089844  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.044666290283203125  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 12 input nodes size: 60012
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03965044021606445  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03965044021606445  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.06826639175415039  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.06830787658691406  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.04058408737182617  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.04274797439575195  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.04274797439575195  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 60012
first layer output nodes number: 28291
edges number: 232177
input nodes number: 28291
output nodes number: 5529
edges number: 58173
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 2.727642059326172  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 2.72764253616333  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.046491146087646484  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 13 input nodes size: 56611
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.04058551788330078  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.04058551788330078  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.06757974624633789  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.06762123107910156  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03896379470825195  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.04107522964477539  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.04107522964477539  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 56611
first layer output nodes number: 27425
edges number: 225956
input nodes number: 27425
output nodes number: 5517
edges number: 57221
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 2.665116786956787  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 2.6651172637939453  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.04471111297607422  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 14 input nodes size: 50379
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.038962364196777344  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.038962364196777344  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.06298494338989258  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.06302881240844727  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.035993099212646484  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03833150863647461  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03833150863647461  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 50379
first layer output nodes number: 27220
edges number: 234432
input nodes number: 27220
output nodes number: 5854
edges number: 79285
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 3.037264347076416  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 3.037264823913574  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.042362213134765625  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 15 input nodes size: 27301
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03604316711425781  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03604316711425781  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.04906129837036133  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.049082279205322266  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.025015830993652344  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02558422088623047  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02558422088623047  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 27301
first layer output nodes number: 9262
edges number: 60129
input nodes number: 9262
output nodes number: 2759
edges number: 16120
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.7537736892700195  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.7537741661071777  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.026254653930664062  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 16 input nodes size: 48699
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.024554729461669922  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.024554729461669922  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.047776222229003906  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes
[23:24:15] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 29010640 edges into 16 parts and get 7263564 edge cuts

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.047797203063964844  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03475809097290039  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03594255447387695  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03594255447387695  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 48699
first layer output nodes number: 16368
edges number: 134127
input nodes number: 16368
output nodes number: 2759
edges number: 24705
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.4619855880737305  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.4619860649108887  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03807258605957031  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03807258605957031  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03807258605957031  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01464369717766257 |0.0031891289879294005 |0.11618182238410502 |0.00013065338134765625 |0.13834640559028177 |0.0070781707763671875 |
----------------------------------------------------------pseudo_mini_loss sum 5.1266045570373535
Total (block generation + training)time/epoch 34.31957244873047
Training time/epoch 4.737448215484619
Training time without block to device /epoch 4.683233022689819
Training time without total dataloading part /epoch 4.3362791538238525
load block tensor time/epoch 0.24894285202026367
block to device time/epoch 0.054215192794799805
input features size transfer per epoch 2.2798776626586914e-06
blocks size to device per epoch 1.519918441772461e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  863607
Number of first layer input nodes during this epoch:  590454
Number of first layer output nodes during this epoch:  273153
----------------------------------------before generate dataloader block 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03807210922241211  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0281832218170166
global_2_local spend time (sec) 0.0527346134185791
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004192829132080078
A = g.adjacency_matrix() spent  0.01396036148071289
auxiliary_graph
Graph(num_nodes=154715, num_edges=29101581,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.10352277755737305
remove nodes length
63774
auxiliary_graph.remove_nodes spent  1.5514447689056396
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29101581,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.2573740482330322

the counter of shared neighbor distribution
Counter({1.0: 23486600, 2.0: 4015792, 3.0: 1001110, 4.0: 300986, 5.0: 109994, 6.0: 47458, 7.0: 22542, 8.0: 11416, 9.0: 6208, 10.0: 3562, 11.0: 1972, 12.0: 1148, 13.0: 654, 14.0: 388, 15.0: 284, 16.0: 206, 17.0: 180, 18.0: 72, 19.0: 50, 20.0: 10, 21.0: 8})
29010640
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 29010637, 29010638, 29010639])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23486600, 2.0: 4015792, 3.0: 1001110, 4.0: 300986, 5.0: 109994, 6.0: 47458, 7.0: 22542, 8.0: 11416, 9.0: 6208, 10.0: 3562, 11.0: 1972, 12.0: 1148, 13.0: 654, 14.0: 388, 15.0: 284, 16.0: 206, 17.0: 180, 18.0: 72, 19.0: 50, 20.0: 10, 21.0: 8})
Convert a graph into a bidirected graph: 2.011 seconds
Metis partitioning: 6.387 seconds
Split the graph: 1.525 seconds
Construct subgraphs: 0.120 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  10.057555437088013
5789
5770
5779
5797
5764
5782
5731
5574
5517
5854
5518
5608
5517
5782
5599
5560
total k batches seeds list generation spend  22.811558723449707
after graph partition
graph partition algorithm spend time 22.914153337478638
5789
5770
5779
5797
5764
5782
5731
5574
5517
5854
5518
5608
5517
5782
5599
5560
partition_len_list
[10240, 11588, 13882, 12792, 11823, 11256, 12878, 12237, 25430, 29258, 26933, 31403, 16880, 15925, 17170, 19778]
shared_neighbor_graph_partition_s0 selection method  spend 23.02833342552185
time for parepare:  0.020773887634277344
local_output_nid generation:  0.0011441707611083984
local_in_edges_tensor generation:  0.0013751983642578125
mini_batch_src_global generation:  0.0016903877258300781
r_  generation:  0.013224363327026367
local_output_nid generation:  0.0014770030975341797
local_in_edges_tensor generation:  0.0013277530670166016
mini_batch_src_global generation:  0.001978158950805664
r_  generation:  0.017427921295166016
local_output_nid generation:  0.0016121864318847656
local_in_edges_tensor generation:  0.001338958740234375
mini_batch_src_global generation:  0.001844167709350586
r_  generation:  0.019224166870117188
local_output_nid generation:  0.0024094581604003906
local_in_edges_tensor generation:  0.0015659332275390625
mini_batch_src_global generation:  0.0017709732055664062
r_  generation:  0.017051219940185547
local_output_nid generation:  0.00162506103515625
local_in_edges_tensor generation:  0.001560211181640625
mini_batch_src_global generation:  0.001987457275390625
r_  generation:  0.020063161849975586
local_output_nid generation:  0.0016624927520751953
local_in_edges_tensor generation:  0.0014090538024902344
mini_batch_src_global generation:  0.001837015151977539
r_  generation:  0.01905035972595215
local_output_nid generation:  0.0016264915466308594
local_in_edges_tensor generation:  0.0014698505401611328
mini_batch_src_global generation:  0.001772165298461914
r_  generation:  0.019139766693115234
local_output_nid generation:  0.0015969276428222656
local_in_edges_tensor generation:  0.0013988018035888672
mini_batch_src_global generation:  0.00164794921875
r_  generation:  0.01768040657043457
local_output_nid generation:  0.0017445087432861328
local_in_edges_tensor generation:  0.0013360977172851562
mini_batch_src_global generation:  0.0018870830535888672
r_  generation:  0.02225971221923828
local_output_nid generation:  0.0017924308776855469
local_in_edges_tensor generation:  0.0016100406646728516
mini_batch_src_global generation:  0.0032165050506591797
r_  generation:  0.03178215026855469
local_output_nid generation:  0.001825571060180664
local_in_edges_tensor generation:  0.0013976097106933594
mini_batch_src_global generation:  0.0022728443145751953
r_  generation:  0.024303197860717773
local_output_nid generation:  0.002011537551879883
local_in_edges_tensor generation:  0.0014138221740722656
mini_batch_src_global generation:  0.002440214157104492
r_  generation: [23:24:22] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 5608 nodes and 2521874 edges into 2 parts and get 426575 edge cuts
 0.025791645050048828
local_output_nid generation:  0.001886606216430664
local_in_edges_tensor generation:  0.0012903213500976562
mini_batch_src_global generation:  0.0018105506896972656
r_  generation:  0.017065048217773438
local_output_nid generation:  0.001867532730102539
local_in_edges_tensor generation:  0.0013768672943115234
mini_batch_src_global generation:  0.0016617774963378906
r_  generation:  0.01954197883605957
local_output_nid generation:  0.0018033981323242188
local_in_edges_tensor generation:  0.0012602806091308594
mini_batch_src_global generation:  0.001470327377319336
r_  generation:  0.017580032348632812
local_output_nid generation:  0.0018246173858642578
local_in_edges_tensor generation:  0.0012598037719726562
mini_batch_src_global generation:  0.001523733139038086
r_  generation:  0.017349720001220703
----------------------check_connections_block total spend ----------------------------- 0.5022850036621094
generate_one_block  0.026009798049926758
generate_one_block  0.024119853973388672
generate_one_block  0.02653646469116211
generate_one_block  0.023180484771728516
generate_one_block  0.02710413932800293
generate_one_block  0.025440454483032227
generate_one_block  0.02569866180419922
generate_one_block  0.025945663452148438
generate_one_block  0.0341794490814209
generate_one_block  0.04598045349121094
generate_one_block  0.03330397605895996
generate_one_block  0.03784632682800293
generate_one_block  0.022906780242919922
generate_one_block  0.02658700942993164
generate_one_block  0.02137899398803711
generate_one_block  0.02610015869140625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.036553144454956055
gen group dst list time:  0.00917196273803711
time for parepare:  0.02747941017150879
local_output_nid generation:  0.0018515586853027344
local_in_edges_tensor generation:  0.012546300888061523
mini_batch_src_global generation:  0.002225160598754883
r_  generation:  0.023551464080810547
local_output_nid generation:  0.0037603378295898438
local_in_edges_tensor generation:  0.002737760543823242
mini_batch_src_global generation:  0.003080129623413086
r_  generation:  0.029732704162597656
local_output_nid generation:  0.003884553909301758
local_in_edges_tensor generation:  0.0035812854766845703
mini_batch_src_global generation:  0.0038089752197265625
r_  generation:  0.040808916091918945
local_output_nid generation:  0.0039212703704833984
local_in_edges_tensor generation:  0.0030972957611083984
mini_batch_src_global generation:  0.0032176971435546875
r_  generation:  0.03522610664367676
local_output_nid generation:  0.003398418426513672
local_in_edges_tensor generation:  0.0028159618377685547
mini_batch_src_global generation:  0.003010988235473633
r_  generation:  0.033829450607299805
local_output_nid generation:  0.003077268600463867
local_in_edges_tensor generation:  0.0029664039611816406
mini_batch_src_global generation:  0.0025975704193115234
r_  generation:  0.03194689750671387
local_output_nid generation:  0.003665447235107422
local_in_edges_tensor generation:  0.002973318099975586
mini_batch_src_global generation:  0.003545045852661133
r_  generation:  0.03738760948181152
local_output_nid generation:  0.0033342838287353516
local_in_edges_tensor generation:  0.002847909927368164
mini_batch_src_global generation:  0.0031511783599853516
r_  generation:  0.034475088119506836
local_output_nid generation:  0.007448673248291016
local_in_edges_tensor generation:  0.010374069213867188
mini_batch_src_global generation:  0.008949041366577148
r_  generation:  0.09269523620605469
local_output_nid generation:  0.009012222290039062
local_in_edges_tensor generation:  0.009044647216796875
mini_batch_src_global generation:  0.02520155906677246
r_  generation:  0.10479331016540527
local_output_nid generation:  0.00676274299621582
local_in_edges_tensor generation:  0.010394573211669922
mini_batch_src_global generation:  0.010337591171264648
r_  generation:  0.0920097827911377
local_output_nid generation:  0.007673978805541992
local_in_edges_tensor generation:  0.008725881576538086
mini_batch_src_global generation:  0.01261448860168457
r_  generation:  0.10817480087280273
local_output_nid generation:  0.0064945220947265625
local_in_edges_tensor generation:  0.007609367370605469
mini_batch_src_global generation:  0.006809234619140625
r_  generation:  0.05154132843017578
local_output_nid generation:  0.004202127456665039
local_in_edges_tensor generation:  0.005394935607910156
mini_batch_src_global generation:  0.0046803951263427734
r_  generation:  0.04732394218444824
local_output_nid generation:  0.004429817199707031
local_in_edges_tensor generation:  0.004446983337402344
mini_batch_src_global generation:  0.005005598068237305
r_  generation:  0.05245065689086914
local_output_nid generation:  0.0048296451568603516
local_in_edges_tensor generation:  0.005060434341430664
mini_batch_src_global generation:  0.0060825347900390625
r_  generation:  0.06660342216491699
----------------------check_connections_block total spend ----------------------------- 1.3707706928253174
generate_one_block  0.04333925247192383
generate_one_block  0.0398411750793457
generate_one_block  0.05158686637878418
generate_one_block  0.04578900337219238
generate_one_block  0.043503761291503906
generate_one_block  0.04210519790649414
generate_one_block  0.05416417121887207
generate_one_block  0.0429844856262207
generate_one_block  0.11662840843200684
generate_one_block  0.14243507385253906
generate_one_block  0.1260051727294922
generate_one_block  0.1495974063873291
generate_one_block  0.06652402877807617
generate_one_block  0.06187272071838379
generate_one_block  0.06628584861755371
generate_one_block  0.08331799507141113
global_2_local spend time (sec) 0.0070111751556396484
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.00113677978515625
A = g.adjacency_matrix() spent  0.0009322166442871094
auxiliary_graph
Graph(num_nodes=31403, num_edges=2527482,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.021488666534423828
remove nodes length
25795
auxiliary_graph.remove_nodes spent  0.09919118881225586
after remove non output nodes the auxiliary_graph
Graph(num_nodes=5608, num_edges=2527482,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.09288382530212402

the counter of shared neighbor distribution
Counter({1.0: 2237324, 2.0: 231180, 3.0: 39038, 4.0: 9074, 5.0: 3070, 6.0: 1142, 7.0: 520, 8.0: 228, 9.0: 126, 10.0: 48, 11.0: 40, 13.0: 22, 12.0: 20, 14.0: 14, 17.0: 8, 15.0: 8, 16.0: 4, 19.0: 4, 20.0: 4})
2521874
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([      0,       1,       2,  ..., 2521871, 2521872, 2521873])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 2237324, 2.0: 231180, 3.0: 39038, 4.0: 9074, 5.0: 3070, 6.0: 1142, 7.0: 520, 8.0: 228, 9.0: 126, 10.0: 48, 11.0: 40, 13.0: 22, 12.0: 20, 14.0: 14, 17.0: 8, 15.0: 8, 16.0: 4, 19.0: 4, 20.0: 4})
Convert a graph into a bidirected graph: 0.095 seconds
Metis partitioning: 0.227 seconds
Split the graph: 0.240 seconds
Construct subgraphs: 0.007 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.5700104236602783
2809
2799
total k batches seeds list generation spend  1.6251351833343506
after graph partition
graph partition algorithm spend time 1.6324644088745117
2809
2799
time for parepare:  0.02109050750732422
local_output_nid generation:  0.0004684925079345703
local_in_edges_tensor generation:  0.0035681724548339844
mini_batch_src_global generation:  0.0015735626220703125
r_  generation:  0.012918710708618164
local_output_nid generation:  0.0005085468292236328
local_in_edges_tensor generation:  0.0011444091796875
mini_batch_src_global generation:  0.0016674995422363281
r_  generation:  0.010701417922973633
----------------------check_connections_block total spend ----------------------------- 0.06676673889160156
generate_one_block  0.023221254348754883
generate_one_block  0.017602205276489258
time for parepare:  0.02271246910095215
local_output_nid generation:  0.0036232471466064453
local_in_edges_tensor generation:  0.0051686763763427734
mini_batch_src_global generation:  0.006620883941650391
r_  generation:  0.0744009017944336
local_output_nid generation:  0.005025148391723633
local_in_edges_tensor generation:  0.004669904708862305
mini_batch_src_global generation:  0.006192207336425781
r_  generation:  0.05950522422790527
----------------------check_connections_block total spend ----------------------------- 0.21955013275146484
generate_one_block  0.10351920127868652
generate_one_block  0.08163762092590332
----------===============-------------===============-------------the number of batches *****---- 17

original number of batches:  16
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03807210922241211  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

connection checking time:  1.3707706928253174
block generation total time  1.175980567932129
average batch blocks generation time:  0.07349878549575806
block dataloader generation time/epoch 29.25264048576355
pseudo mini batch 0 input nodes size: 17395
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.034757137298583984  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.034757137298583984  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.043051719665527344  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.04309511184692383  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.019852638244628906  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02045726776123047  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02045726776123047  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 17395
first layer output nodes number: 10240
edges number: 50519
input nodes number: 10240
output nodes number: 5789
edges number: 30537
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.9043617248535156  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.904362678527832  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.022167205810546875  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 1 input nodes size: 20981
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.020305156707763672  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.020305156707763672  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.030309677124023438  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.030353069305419922  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.022015094757080078  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02283334732055664  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02283334732055664  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 20981
first layer output nodes number: 11588
edges number: 68727
input nodes number: 11588
output nodes number: 5770
edges number: 40999
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.1957883834838867  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.195788860321045  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02443695068359375  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 2 input nodes size: 29680
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02201223373413086  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02201223373413086  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03616476058959961  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.036208152770996094  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.026160240173339844  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.027153968811035156  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.027153968811035156  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 29680
first layer output nodes number: 13882
edges number: 89277
input nodes number: 13882
output nodes number: 5779
edges number: 43999
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.3990898132324219  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.39909029006958  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02907419204711914  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 3 input nodes size: 30103
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02616119384765625  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02616119384765625  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.04051542282104492  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.040558815002441406  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.026362895965576172  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.027236461639404297  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.027236461639404297  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 30103
first layer output nodes number: 12792
edges number: 78206
input nodes number: 12792
output nodes number: 5797
edges number: 39015
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.2577300071716309  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.257730484008789  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.028979778289794922  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 4 input nodes size: 22803
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02636575698852539  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02636575698852539  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03723907470703125  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.037282466888427734  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.022884845733642578  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.023823261260986328  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.023823261260986328  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 22803
first layer output nodes number: 11823
edges number: 76605
input nodes number: 11823
output nodes number: 5764
edges number: 49195
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.37605619430542  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.3760566711425781  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.025624752044677734  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 5 input nodes size: 22773
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.022880077362060547  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.022880077362060547  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03373908996582031  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.0337824821472168  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.022865772247314453  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.023755550384521484  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.023755550384521484  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 22773
first layer output nodes number: 11256
edges number: 73038
input nodes number: 11256
output nodes number: 5782
edges number: 46290
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.301180362701416  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.3011808395385742  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.025479793548583984  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 6 input nodes size: 23259
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02286815643310547  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02286815643310547  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03395891189575195  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.034001827239990234  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.023099422454833984  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.024077892303466797  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.024077892303466797  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 23259
first layer output nodes number: 12878
edges number: 85176
input nodes number: 12878
output nodes number: 5731
edges number: 45966
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.3989543914794922  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.3989548683166504  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.025918960571289062  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 7 input nodes size: 23804
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.023091793060302734  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.023091793060302734  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03444242477416992  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.0344843864440918  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.02335071563720703  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.024236679077148438  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.024236679077148438  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 23804
first layer output nodes number: 12237
edges number: 76759
input nodes number: 12237
output nodes number: 5574
edges number: 42014
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.2823114395141602  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 1.2823119163513184  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.025928020477294922  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 8 input nodes size: 55238
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.023327350616455078  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.023327350616455078  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.0496668815612793  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.04970836639404297  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.038315773010253906  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.040261268615722656  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.040261268615722656  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 55238
first layer output nodes number: 25430
edges number: 206989
input nodes number: 25430
output nodes number: 5517
edges number: 53889
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 2.467346668243408  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 2.4673471450805664  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.04364490509033203  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

pseudo mini batch 9 input nodes size: 54091
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03830766677856445  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.03830766677856445  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.06410026550292969  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.06414413452148438  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.037763118743896484  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.040212154388427734  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1064453125 GB
    Memory Allocated: 0.040212154388427734  GigaBytes
Max Memory Allocated: 3.2452335357666016  GigaBytes

first layer input nodes number: 54091
first layer output nodes number: 29258
edges number: 251490
input nodes number: 29258
output nodes number: 5854
edges number: 77118
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 3.144754409790039  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 3.1447548866271973  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.04441070556640625  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

pseudo mini batch 10 input nodes size: 60338
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.03781318664550781  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.03781318664550781  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.06658458709716797  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.06662607192993164  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.04078960418701172  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.042822837829589844  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.042822837829589844  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

first layer input nodes number: 60338
first layer output nodes number: 26933
edges number: 217614
input nodes number: 26933
output nodes number: 5518
edges number: 55143
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 2.5732736587524414  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 2.5732741355895996  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.04633188247680664  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

pseudo mini batch 11 input nodes size: 42194
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.04073953628540039  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.04073953628540039  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.06085920333862305  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.06090068817138672  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.03208780288696289  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.03321504592895508  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.03321504592895508  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

first layer input nodes number: 42194
first layer output nodes number: 16880
edges number: 113582
input nodes number: 16880
output nodes number: 5517
edges number: 37584
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 1.5096569061279297  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 1.509657382965088  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.03537750244140625  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

pseudo mini batch 12 input nodes size: 36710
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.03208780288696289  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.03208780288696289  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.04959249496459961  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.049635887145996094  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.029474735260009766  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.030608654022216797  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.030608654022216797  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

first layer input nodes number: 36710
first layer output nodes number: 15925
edges number: 106506
input nodes number: 15925
output nodes number: 5782
edges number: 45487
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 1.5665040016174316  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 1.5665044784545898  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.03281688690185547  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

pseudo mini batch 13 input nodes size: 45942
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.029513835906982422  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.029513835906982422  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.05142068862915039  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.051462650299072266  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.03391456604003906  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.03502082824707031  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.03502082824707031  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

first layer input nodes number: 45942
first layer output nodes number: 17170
edges number: 113936
input nodes number: 17170
output nodes number: 5599
edges number: 34422
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 1.4718613624572754  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 1.4718618392944336  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.03714704513549805  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

pseudo mini batch 14 input nodes size: 46436
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.033887386322021484  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.033887386322021484  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.0560297966003418  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.05607128143310547  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.034122467041015625  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.03549003601074219  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.03549003601074219  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

first layer input nodes number: 46436
first layer output nodes number: 19778
edges number: 143080
input nodes number: 19778
output nodes number: 5560
edges number: 40388
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 1.7843708992004395  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 1.7843713760375977  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.03800535202026367  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

pseudo mini batch 15 input nodes size: 51654
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.03411674499511719  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.03411674499511719  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.05950736999511719  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.059528350830078125  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.03734445571899414  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.038907527923583984  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.038907527923583984  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

first layer input nodes number: 51654
first layer output nodes number: 20042
edges number: 174650
input nodes number: 20042
output nodes number: 2809
edges number: 35064
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 1.9106512069702148  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 1.910651683807373  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.04118776321411133  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

pseudo mini batch 16 input nodes size: 45051
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.03693437576293945  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.03693437576293945  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.05841636657714844  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.058437347412109375  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.03302574157714844  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.03423023223876953  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.03423023223876953  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

first layer input nodes number: 45051
first layer output nodes number: 16427
edges number: 134398
input nodes number: 16427
output nodes number: 2799
edges number: 27140
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 1.4874138832092285  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 1.4874143600463867  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.036371707916259766  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.036371707916259766  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.2275390625 GB
    Memory Allocated: 0.036371707916259766  GigaBytes
Max Memory Allocated: 3.2538504600524902  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013860015308155733 |0.0026550573461196 |0.11907325071447036 |0.00012529597562902113 |0.13983906016630285 |0.0046732425689697266 |
----------------------------------------------------------pseudo_mini_loss sum 3.8613431453704834
Total (block generation + training)time/epoch 34.014902234077454
Training time/epoch 4.786507844924927
Training time without block to device /epoch 4.7413718700408936
Training time without total dataloading part /epoch 4.408312559127808
load block tensor time/epoch 0.23562026023864746
block to device time/epoch 0.0451359748840332
input features size transfer per epoch 2.2798776626586914e-06Using backend: pytorch

blocks size to device per epoch 1.519918441772461e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  912991
Number of first layer input nodes during this epoch:  628452
Number of first layer output nodes during this epoch:  284539
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
